"use strict";var dla=dla||{};dla.resources=dla.resources||{},dla.messages=dla.messages||{},dla.noFbMessages=dla.noFbMessages||{};var llMobile={handlePostPurchase:function(e){if(e.startsWith("lottoland://")&&e.length>"lottoland://".length+"lottoland".length){var s=e.substring("lottoland://".length+"lottoland".length);jsf.ajax.get(s)}},handleDeepLinkPush:function(e){if(e.match(/lottoland:\/\/page\/[^\/]+/)){var s=e.replace(/^lottoland:\/\/page\//,""),a=dla.resources.localePrefix||"";s=s.replace("game-ticket-","").toLowerCase(),jsf.ajax.get(a+"/api/lotteries/"+s+"/url?silent=true")}}};if($.extend(dla.messages,{timeouts:[],suppress:!1,suppressConfirm:$("body").hasClass("suppressConfirm"),personalMessagesNotifications:[],personalMessagesElementsToShow:[],blackListPersonalMessages:dla.messages.blackListPersonalMessages||[],externalMessageConsumer:null,notifyMessageClosed:function(e){var s=dla.helper.cookie.get("growlsToBeClosed");s||(s=""),s+="/"+e,dla.helper.cookie.set("growlsToBeClosed",s)},addExternalMessageConsumer:function(e){dla.messages.externalMessageConsumer=e},growlReset:function(){if(this.timeouts.length)for(var e;e=this.timeouts.shift();)window.clearTimeout(e)},growl:function(e){if(dla.messages.externalMessageConsumer)dla.messages.externalMessageConsumer.call(this,e);else{e.title="",e.useFallback=!0,e.hasOwnProperty("timeout")||(e.timeout=1e4);var s=function(e,s,a){dla.messages.notifyMessageClosed(a)};if(!e.hasOwnProperty("delay")){var a=$.notify(e,s);return e.personalMessageId&&this.personalMessagesNotifications.push(a),a}this.timeouts.push(window.setTimeout(function(){var a=$.notify(e,s);e.personalMessageId&&this.personalMessagesNotifications.push(a)}.bind(this),e.delay))}},growlOne:function(e,s){null==dla.helper.storage.get(e)&&(dla.helper.storage.set(e,!0),dla.messages.growl(s))},suppressGrowls:function(){this.suppress=!0},growlFromUL:function(e){var s,a,t,n,o,i,r;if(!1===this.suppress){this.canShowPersonalMessage()&&(this.personalMessagesElementsToShow.forEach((function(s){this.canShowPersonalMessage()&&$(e).append(s)}),this),this.personalMessagesElementsToShow=[]);var l=$(e).find("li");l.length>0&&dla.payment.unblockView(),l.each(function(e,l){l=$(l),a=l.find(".title").html(),t=l.find(".message").html(),n=l.find(".timeout").html(),i=l.find(".delay").html(),r=l.find(".personalMessageId").html(),s=l.find(".id").html(),!r||this.canShowPersonalMessage()?(setTimeout((function(){dla.messages.notifyMessageClosed(s)}),3e3),o={id:s},l.hasClass("INFO")?(o.message=t,o.title=a,n&&(o.timeout=n),i&&(o.delay=i),r&&(o.personalMessageId=r,o.className="personal-message t-personal-message"),dla.messages.growl(o)):(o.detail=t,o.title=a,dla.messages.showConfirm(o)),l.remove()):this.personalMessagesElementsToShow.push(l)}.bind(this))}else this.suppress=!1},growlMessages:function(e){void 0!==e&&"success"!==e.status||($("div#growlMessages>ul").each((function(e,s){dla.messages.growlFromUL(s)})),this.canShowPersonalMessage()?this.personalMessagesNotifications.forEach((function(e){e.setVisibility(!0)})):this.personalMessagesNotifications.forEach((function(e){e.setVisibility(!1)})))},showErrorMessage:function(e,s,a){dla.messages.showConfirm(e,s,a,"error")},showPromoMessage:function(e,s,a){dla.messages.showConfirm(e,s,a,"promo")},showConfirm:function(e,s,a,t){var n={},o={},i={},r=!1;if(!dla.messages.suppressConfirm&&(e||s||a)){"string"==typeof e?i.detail=e:i=e,s?"function"==typeof s?(n.callback=s,n.text=dla.messages.get("common_ok")||"OK"):n=s:(n.callback=!1,n.text=dla.messages.get("common_ok")||"OK"),a&&("function"==typeof a?(o.callback=a,o.text=dla.messages.get("common_cancel")):o=a),"string"==typeof t?r=t:"object"==typeof t&&(r=t.join(" ")),$(".js-messageContainer").find(".js-modalMessage").empty();var l=$(".js-messageFade"),d=n.id?'id="'+n.id+'" ':"",c=$("<button "+d+'class="btn btn-primary t-ok">'+n.text+"</button>");if(c.bind("click",(function(){$("body").removeClass("modal-open"),l.hide(),n.callback&&n.callback()})),a){var u=o.id?'id="'+o.id+'" ':"",g=$("<button "+u+'class="btn btn-secondary t-cancel">'+o.text+"</button>");g.bind("click",(function(){$("body").removeClass("modal-open"),l.hide(),o.callback&&o.callback()}))}var f=$(".js-messageContainer .modal");f.find(".close").one("click",(function(){$("body").removeClass("modal-open"),l.hide()})),f.removeClass().addClass("modal"),r&&f.addClass(r),f.find(".js-modalMessage").empty().html(i.detail),f.find(".js-modalFooter").empty().append(g,c),$(".js-messageContainer .modal").modal({backdrop:"static"}),l.show(0,(function(){dla.messages.showConfirmAfter&&dla.messages.showConfirmAfter()}))}},canShowPersonalMessage:function(){var e=new RegExp(dla.resources.localePrefix+"/","gi");return-1===this.blackListPersonalMessages.indexOf(location.pathname.replace(e,"/"))}}),$(window).trigger("available","growlMessageLoaded"),$(window).trigger("available","dlaMessages"),dla.heartBeat={doHeartBeat:!1,frontContent:null,warn:84e4,close:9e5,interval:45e3,lastAccess:0,isHeartBeatPending:!1,listener:[],refresh:function(){var e=(new Date).getTime();if(!(this.doHeartBeat&&!dla.heartBeat.isListening()&&e-this.lastAccess>=this.warn||dla.heartBeat.isHeartBeatPending)){var s=window.History.getState().url.replace(dla.navigate.rootUrl,""),a=dla.heartBeat.frontContent?"&fc="+dla.heartBeat.frontContent:"",t=dla.heartBeat.isListening()?"&events=true":"",n={url:"/api/heartbeat?source="+encodeURIComponent(s)+a+t,dataType:"text",success:function(e,s,a){dla.heartBeat.isHeartBeatPending=!1;var t=$.parseJSON(a.getResponseHeader("X-HEARTBEAT-JSON"));switch(t.keep){case"START":dla.heartBeat.invokeListener(t),dla.heartBeat.start();break;case"STOP":dla.heartBeat.stop();break;case"GAMSTOP_LOGOUT":dla.messages.growl({message:dla.messages.get("de_dla_lotto_logoutBecauseGamstopBan")}),window.location.reload()}},error:function(e){dla.heartBeat.isHeartBeatPending=!1,"timeout"===e.statusText&&dla.heartBeat.isListening()&&dla.heartBeat.restart()},timeout:45e3};dla.heartBeat.isHeartBeatPending=!0,$.ajax(n)}},setTimeout:function(){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(dla.heartBeat.refresh,dla.heartBeat.isListening()?100:this.interval)},start:function(){this.doHeartBeat=!0,this.lastAccess||(this.lastAccess=(new Date).getTime()),this.setTimeout()},restart:function(){this.doHeartBeat?(this.setTimeout(),this.lastAccess=(new Date).getTime()):this.lastAccess=0},stop:function(){this.doHeartBeat=!1,this.lastAccess=0,this.timeoutId&&window.clearTimeout(this.timeoutId)},registerEvent:function(e,s){this.listener.push([e,s]),this.setTimeout()},unregisterEvents:function(){this.listener=[]},isListening:function(){return this.listener.length>0},invokeListener:function(e){e.events&&e.events.forEach((function(e){dla.heartBeat.listener.forEach((function(s){s[0]===e.name&&s[1](e.value)}))}))},idle:function(){this.doHeartBeat&&this.setTimeout()},access:function(){this.doHeartBeat?(this.lastAccess=(new Date).getTime(),this.setTimeout()):this.lastAccess=0},checkCookies:function(e){var s="/api/heartbeat/checkCookies?cookieEnabled="+navigator.cookieEnabled;e&&(s+="&sessionOnly=true");var a={url:s,dataType:"text",success:function(e){"NOK"===e&&dla.messages.showConfirm(dla.messages.get("common_mobile_cookie_not_enabled"))}};$.ajax(a)}},$((function(){dla.resources.lastPageId=$("#trackingInfo").data("pageId"),$(window).trigger("page:enter",dla.resources.lastPageId)})),$(window).on("page:leave",dla.messages.growlReset.bind(dla.messages)),window.jsf&&window.jsf.ajax){jsf.ajax.addOnEvent((function(e){if("begin"===e.status&&$(e.source).data("showLoader")&&dla.spinner.show(),"success"===e.status){var s,a,t,n=$("#trackingInfo").data("pageId");dla.resources.lastPageId!==n?(window.dispatchEvent(new window.CustomEvent("page:enter",{detail:{page:n,url:window.location.href.split("?")[0]}})),$(window).trigger("page:leave",dla.resources.lastPageId).trigger("page:enter",n),dla.resources.lastPageId=n):$(window).trigger("page:refresh",n),dla.spinner.hide();for(var o=$(e.responseXML).find("update"),i=function(){t.addClass("success")},r=0;r<o.length;r++)s=o[r].getAttribute("id"),(a=$("#"+s).parent()).hasClass("loader")&&(a.removeClass("begin"),t=a,window.setTimeout(i,1))}}));var preventAjaxRequest=function(e,s){if("click"!==s.type)return!1;var a=(e=$(e)).data("lastClick"),t=(new Date).getTime();return!!(a&&t-a<200)||(e.data("lastClick",t),!1)};dla.jsf={request:jsf.ajax.request,response:jsf.ajax.response},jsf.ajax.request=function(e,s,a){if("string"==typeof e&&(e=document.getElementById(e)),!preventAjaxRequest(e,s)){var t=$(e).closest("form");if(!window.magnolia){var n=window.History.getState().url.replace(dla.navigate.rootUrl,"");t.attr("action",n)}if(a.render)for(var o=a.render.split(" "),i=0;i<o.length;i++){var r,l=o[i];"@form"===l?r=$(e).parent("form").parent():"@this"===l?r=$(e).parent():0!==l.indexOf("@")&&(r=$("#"+l).parent()),r&&r.hasClass("loader")&&r.removeClass("success").addClass("begin")}dla.helper.onAvailability(["universalTracking"],(function(){"action"===a["javax.faces.behavior.event"]&&dla.universalTracking&&dla.universalTracking.trackEvent(t.attr("id"),e.id)})),a["Body-Version"]=dla.version,dla.skin&&(a["X-Skin"]=dla.skin.name),dla.jsf.request(e,s,a)}},jsf.ajax.response=function(e,s){dla.jsf.response(e,s)},jsf.ajax.get=function(e,s,a){e||(e=window.History.getState().url.replace(dla.navigate.rootUrl,""),window.magnolia&&(e=e.replace(window.dla.resources.magnoliaPrefix,window.dla.resources.monolithPrefix)));var t=$.extend({url:e,headers:{"Faces-Request":"partial/ajax","Body-Version":dla.version},cache:!1,error:function(e,s,t){jsf.ajax.response(t,{formid:"none",sourceid:{id:a}})},beforeSend:function(){void 0!==dla.spinner&&dla.spinner.show(),dla.lastMinute.lotteries[dla.resources.lastPageId]&&dla.lastMinute.destroy(dla.resources.lastPageId)},success:function(e,s,t){void 0!==dla.spinner&&dla.spinner.hide(),$("#partialFront").removeClass("on"),jsf.ajax.response(t,{formid:"none",sourceid:{id:a}})}},s);return dla.skin&&(t.headers["X-Skin"]=dla.skin.name),$.ajax(t)},jsf.ajax.render=function(e,s){return(s=s||{})["javax.faces.partial.render"]=e,s["javax.faces.partial.ajax"]=!0,jsf.ajax.get("",{type:"POST",async:!1,data:s})},jsf.ajax.renderAsync=function(e,s){return(s=s||{})["javax.faces.partial.render"]=e,s["javax.faces.partial.ajax"]=!0,jsf.ajax.get("",{type:"POST",data:s})},jsf.ajax.reloadComponents=function(e){var s=[];$(e).each((function(){s.push(this.getAttribute("id"))})),jsf.ajax.render(s.join(" "))},jsf.ajax.navigate=function(e){var s={hasAttribute:$.noop,form:{action:e,elements:[],length:0}};jsf.ajax.request(s,{type:"navigate"},{execute:"@none",render:"main"})}}dla.resources.apiKey=$("meta[name=apiKey]").attr("content"),dla.resources.requestPrefix=$("meta[name=requestPrefix]").attr("content")||"",dla.isTouch=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),$(document).ready((function(){dla.messages.growlMessages(),$("body").addClass(dla.isTouch?"touch":"no-touch")}));