function LastMinute(t){var e=this;this.id=t,this.lastMinuteElement=$("#lastMinute_"+this.id),this.lastMinuteForm=this.lastMinuteElement.find(".lastMinuteForm"),this.pageElement=this.lastMinuteElement.closest(".page"),this.modal=this.lastMinuteElement.closest(".js-modal"),this.isShown=!1,this.closed=!1,this.priceLabel=this.lastMinuteElement.find(".moneyValue"),this.jackpotElement=this.lastMinuteElement.find(".jackpot"),this.data=this.lastMinuteElement.data(),this.dyjEnabled=this.data.dyjEnabled,dla.helper.onAvailability("flipclockJs",(function(){e.init()})),dla.lastMinute.lotteries[this.id]=this}LastMinute.interval=0,LastMinute.timeDiff=0,LastMinute.create=function(t){var e=dla.lastMinute.lotteries[t];return e||new LastMinute(t)},LastMinute.prototype.init=function(){this.lastMinuteElement.find(".close, .lastMinuteToRegularTicket").on("click",this.close.bind(this)),this.lastMinuteElement.find(".dyjCheckbox").on("click",this.toggleDyj.bind(this));var t=this;this.clock=this.lastMinuteElement.find(".flipClock").FlipClock({countdown:!0,autoStart:!1,callbacks:{stop:function(){0===this.factory.time.time&&t.close()}}}),this.update(),$(window).on("page:enter page:refresh",function(t,e,i){e!==this.id||this.isShown||this.closed||($(".tipEngine",i).hide(),this.open())}.bind(this)).on("page:leave",function(t,e){e===this.id&&dla.lastMinute.destroy(this.id,this)}.bind(this)),llMobile.router&&(llMobile.router.enterCurrentPage(),0===LastMinute.interval&&(LastMinute.interval=window.setInterval((function(){LastMinute.timeDiff+=1e3}),1e3)))},LastMinute.prototype.open=function(){this.lastMinuteElement.closest(".js-modal").show(),this.pageElement.addClass("lastMinute"),$("#partialFront").addClass("on"),this.isShown=!0;var t=this.lastMinuteElement.data("timeToDrawing")-LastMinute.timeDiff;this.clock.setTime(Math.round(t/1e3)),this.clock.stop(),this.clock.start()},LastMinute.prototype.close=function(t){t&&(t.preventDefault(),t.stopPropagation()),this.pageElement.removeClass("lastMinute"),this.modal.hide(),this.isShown=!1,this.closed=!0,$(".tipEngine",this.pageElement).show(),$("#partialFront").removeClass("on"),window.scrollTo(0,0)},LastMinute.prototype.update=function(){var t=this.data.priceNormal,e=this.data.jackpot;this.dyjEnabled&&(t=this.data.priceDouble,e=2*this.data.jackpot),this.priceLabel.html(dla.helper.formatPrice(t,this.data.accountCurrency)),this.jackpotElement.html(dla.helper.formatJackpot(e,this.data.displayCurrency)),this.lastMinuteForm.toggleClass("dyj",this.dyjEnabled),this.lastMinuteForm.find(".soldOut").toggleClass("show",!this.dyjEnabled&&!this.data.ticketsAvailable),this.lastMinuteForm.find(".soldOutDYJ").toggleClass("show",this.dyjEnabled&&!this.data.dyjTicketsAvailable)},LastMinute.prototype.toggleDyj=function(t){this.dyjEnabled=$(t.currentTarget).prop("checked"),this.lastMinuteElement.data("dyjEnabled",this.dyjEnabled),this.update()},dla.lastMinute={lotteries:{},destroy:function(t,e){e&&(e.id=""),delete dla.lastMinute.lotteries[t]},afterPurchase:function(t){if("success"===t.status&&!validationFailed){var e=$(t.source).closest(".lastMinute").data("lotteryId");dla.lastMinute.lotteries[e].close()}}},$(window).trigger("available","lastMinuteJs");