"use strict";var dla=window.dla||{};dla.apiLogin=function(e,t){const n=()=>dla.skin.isMobile;let o,i,a;const r=(e,t)=>{window.dla&&window.dla.isMobileContainer&&window.dla.helper.onAvailability&&window.dla.helper.onAvailability("nativeAppJsLoaded",(function(){window.dla.nativeApp.sendLoginAttemptEvent(e,t)}))},l=o=>{dla.helper.onAvailability("universalTracking",(function(){dla.universalTracking.trackLogin(dla.universalTracking.action.LOGIN_SUCCESS),dla.universalTracking.pseudoPageView(dla.universalTracking.LOGIN_SUCCESS)}));const i=null==o?void 0:o.detail.redirectUrl;if(i){const e=o.detail.token;window.dla.navigateByForm.redirectTo(i,e)}else dla.authentication.resolve(),n()||dla.authentication.close(!1),n()?(null==o?void 0:o.detail.mustUpdatePassword)?window.location.href=location.href+"?fc=requestPasswordUpdate":dla.authentication.deferred()||window.location.reload():((null==o?void 0:o.detail.mustUpdatePassword)&&(window.location.href=location.href+"?fc=requestPasswordUpdate"),t.ajax.render("playerFrontendConfig panicButtonContainer topNavigationSection jsClientScripts cmsFooterContent-linkList-footerLinksContainer winnerHeader lotteryNavigation page sessionTimer growlMessages").then(()=>{if(window.dispatchEvent(new CustomEvent("logged")),!dla.skin.isMobile){const e=document.querySelector(".js-show-personal-messages");e&&e.click()}}),e("#lotteryNavigationSection").load("".concat(location.href," #lotteryNavigationSection")))},d=()=>{var e;return null===(e=document.querySelector("ll-auth-login"))||void 0===e?void 0:e.closest(".l-overlay-animation-delay")},s=()=>{const e=d(),{opened:t="false",login:n="false"}=e?e.dataset:{};e&&"true"===t&&"true"===n&&e.classList.add("l-overlay-animation-delay-show")},c=()=>{const e=d();e&&(e.dataset.opened=!0,e.dataset.register=!1,e.dataset.login=n(),e.classList.remove("l-overlay-animation-delay-show")),s()},u=()=>{const e=d();e&&(e.dataset.opened=!1,e.dataset.register=!1,e.dataset.login=!1),s()},v=()=>{const e=d();e&&(e.dataset.login=!0),s()},w=()=>{var e;window.addEventListener("login-open",c),window.addEventListener("login-close",u),null===(e=document.querySelector("ll-auth-login"))||void 0===e||e.addEventListener("ll-login-form-loaded",v)},g=(e=!0)=>{o=document.querySelector("ll-auth-login"),i=document.querySelector("ll-terms-update-journey"),a=document.querySelector("ll-rekyc-journey"),e&&w(),o&&(o.nativeLogin=r,o.addEventListener("ll-login-form-success",e=>{l(e)}),o.addEventListener("ll-login-form-error",()=>{dla.helper.onAvailability("universalTracking",(function(){dla.universalTracking.trackLogin(dla.universalTracking.action.LOGIN_FAIL),dla.universalTracking.pseudoPageView(dla.universalTracking.LOGIN_FAIL)}))}),o.addEventListener("ll-login-form-redirect",e=>{const t=e.detail.url,n=e.detail.token;window.dla.navigateByForm.redirectTo(t,n)}),o.addEventListener("ll-login-form-openPopup",e=>{sessionStorage.setItem("bankIdLoginData",btoa(JSON.stringify({username:e.detail.username,password:e.detail.password}))),window.dla.bankIdRegistration.createLegislationUpdatePopup()}),o.addEventListener("ll-login-form-forgotPassword",()=>{n()?(llMobile.dialogs.hide(),dla.frontContent.show("passwordRequest")):dla.authentication.openForgotPassword()}),o.addEventListener("ll-login-form-azure-flow",e=>{const{token:t,country:n,redirectUrl:o}=e.detail;p({token:t,country:n,redirectUrl:o},i)}),o.addEventListener("ll-login-form-rekyc-flow",e=>{const{token:t,country:n,redirectUrl:o}=e.detail;p({token:t,country:n,redirectUrl:o},a)}),o.addEventListener("ll-login-auth-access-denied-market-restricted",()=>{window.dla.helper.onAvailability("nativeAppJsLoaded",(function(){window.dla.nativeApp.sendLoginErrorMarketRestricted()}))})),i&&(i.addEventListener("ll-terms-update-journey-accept",e=>{var t;if(i.removeAttribute("visible"),null===(t=e.detail)||void 0===t?void 0:t.reKycFlowNeeded){const{token:t,country:n,redirectUrl:o}=e.detail;p({token:t,country:n,redirectUrl:o},a)}else l(e)}),i.addEventListener("ll-terms-update-journey-not-accept",()=>{i.removeAttribute("visible"),window.location.reload()}),i.addEventListener("ll-terms-update-journey-account-closure-accept",()=>{i.removeAttribute("visible"),window.location.reload()})),a&&(a.addEventListener("ll-rekyc-journey-confirm",e=>{a.removeAttribute("visible"),l(e)}),a.addEventListener("ll-rekyc-journey-address-update",e=>{a.removeAttribute("visible"),l(e)}),a.addEventListener("ll-rekyc-journey-logout",e=>{a.removeAttribute("visible"),window.location.reload()}))},p=(e,t)=>{y(t),m(e,t)},y=e=>{dla.frontContent.hide(),e.setAttribute("visible",!0)},m=(e,t)=>{for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return w(),!n()&&g(!1),(n()||document.querySelector("#frontContent .js-login-api"))&&c(),{addEventListeners:g,login:(e,t)=>{o.dispatchEvent(new CustomEvent("ll-login-form-login",{detail:{username:e,password:t}}))}}}(window.jQuery,window.jsf),$(window).trigger("available","apiLoginJs");