function getInstanceByLastPaymentProcessId(){try{return dla.payment.getInstance(dla.helper.cookie.get("lastPaymentProcessId"))}catch(e){return null}}function forwardToProvider(e,t){if("begin"===e.status)e.paymentType=dla.payment.getInstance(t).getPaymentType();else if("success"===e.status){var a=function(){var t=$(e.source).data("paymentUrl"),a=document.getElementById(e.source.id).dataset.paymentUrl;return["merchantReference","txId"].forEach((function(e){dla.helper.getUrlParameter(t)[e]!==dla.helper.getUrlParameter(a)[e]&&(t=a)})),t}();dla.payment.getInstance(t)?dla.payment.getInstance(t).forwardToProvider(a):dla.payment.createForId("addFunds","payIn")}else e.responseCode>=500&&top.postMessage({type:"paymentError"},"*")}dla.helper.createNamespace("dla.payment"),dla.payment.avsPayButton=null,dla.payment.createForId=function(e,t){dla.payment.instances=dla.payment.instances||{},void 0===dla.payment.instances[e]&&(dla.payment.instances[e]=new dla.payment.view),dla.payment.instances[e].init(e,t)},dla.payment.forward=function(e){forwardToProvider(e,e.source)},dla.payment.forwardWithLastPaymentId=function(e){forwardToProvider(e,dla.helper.cookie.get("lastPaymentProcessId"))},dla.payment.handleCreditCardAjaxEvent=function(e){e&&dla.payment.getInstance(e.source)?dla.payment.getInstance(e.source).handleCreditCardAjaxEvent(e):dla.payment.createForId("addFunds","payIn")},dla.payment.handleRecurringCreditCardAjaxEvent=function(e){e&&dla.payment.getInstance(e.source)?dla.payment.getInstance(e.source).handleRecurringCreditCardAjaxEvent(e):dla.payment.createForId("addFunds","payIn")},dla.payment.getInstance=function(e){if(!e)for(var t in dla.payment.instances)if(dla.payment.instances.hasOwnProperty(t)){e=t;break}return"string"==typeof e?dla.payment.instances[e]:dla.payment.instances[function(e){var t=$(e).closest('[data-type="initPayment"]');if(t.length)return t.attr("id");return $(e).closest(".js-payment-wrapper").find('[data-type="initPayment"]').attr("id")}(e)]},dla.payment.getLastInstance=function(){if(void 0===dla.payment.instances)return!1;const e=Object.keys(dla.payment.instances),t=e[e.length-1];return dla.payment.instances[t]},dla.payment.paymentFailed=function(e){getInstanceByLastPaymentProcessId().paymentFailed(e.data())},dla.payment.finished=function(e,t){var a=dla.helper.cookie.getAndRemove("lastPaymentProcessId");dla.payment.getInstance(a).finished(e,t)},dla.payment.check=function(e){var t=dla.helper.cookie.getAndRemove("lastPaymentProcessId");dla.payment.getInstance(t).check(e)},dla.payment.disablePaymentInstrument=function(e,t){dla.messages.showConfirm(t,(function(){jsf.ajax.request(e.id,"action",{"javax.faces.behavior.event":"action","javax.faces.partial.event":"click",execute:"@this",render:"payInModule topNavigation paymentInstruments"})}),(function(){}))},dla.payment.renderPageContent=function(){getInstanceByLastPaymentProcessId().renderPageContent()},dla.payment.unblockView=function(){var e=getInstanceByLastPaymentProcessId();e&&e.unblockView()},dla.payment.forwardToFallback=function(e){getInstanceByLastPaymentProcessId().openPaymentWindowWithoutChecks(e)},dla.payment.keepPayment={init:function(e){this.parent=$("#"+e),this.paymentMethods=this.parent.find('[data-payment-group="methods"]')},save:function(e){this.init(e),this.savedData={},this.savedData.selected=this.paymentMethods.find(".paymentSelector.selected, .js-paymentSelector.selected").attr("data-show-payment"),this.savedData.values=[],this.paymentMethods.find('[data-show-payment="'+this.savedData.selected+'"].js-payment-gateway').find('input[type="tel"], input[type="text"]').each(function(e,t){this.savedData.values.push({name:t.getAttribute("name"),value:t.value})}.bind(this))},restore:function(e){var t,a;if(this.init(e),t=this.paymentMethods.find('[data-show-payment="'+this.savedData.selected+'"].paymentSelector, [data-show-payment="'+this.savedData.selected+'"].js-paymentSelector'),a=this.paymentMethods.find('[data-show-payment="'+this.savedData.selected+'"].js-payment-gateway'),0!==t.length&&(t.is(":visible")||dla.payment.getInstance(this.paymentMethods.find('[data-type="paymentGroupSwitch"]')[0]).showNewPayments(),t.is(":visible"))){t.click();for(var n=this.savedData.values,s=(n?n.length:0)-1;s>=0;s--)a.find('[name="'+n[s].name+'"]').val(n[s].value).trigger("change").trigger("blur")}}},$(window).trigger("available","factoryJS");