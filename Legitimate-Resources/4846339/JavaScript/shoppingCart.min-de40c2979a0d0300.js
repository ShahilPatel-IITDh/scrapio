dla.helper.createNamespace("dla.shoppingCart"),dla.shoppingCart=function(){var e=null;function t(e,t){const n=document.querySelector(".js-view-details-link.hide");return n&&(document.querySelectorAll(".jsTicketHeader").forEach(e=>e.setAttribute("click-name","showDetails")),window.setTimeout(()=>{n.classList.remove("hide"),n.parentElement.querySelector(".js-hide-details-link").classList.add("hide")},500)),"bundle"===t.data("entryType")?function(e,t){var n={callbacks:{open:a},stateHolder:"all",multiple:!0};return dla.ui.createAccordion(t.attr("id"),"jsTicketBundleHeader","jsTicketBundleBody",n),!0}(0,t):a(e,t)}function a(e,t){var a=t.find(".jsTicketBox").children("div").eq(0);return dla.ticket.render(a),$(".switchingContainer").css("left",0),!0}function n(e){var t=e.split("/");return t[t.length-1]}function i(e,t){if($("#shoppingCartForm-ticketIdx").val(t),$("#shoppingCartForm-action").val(e),window.magnolia)if(document.querySelector("#shoppingCartForm").querySelectorAll("input[name='javax.faces.ViewState']").forEach((function(e,t){t>0&&$(e).remove()})),dla.spinner.show(),"remove"===e){var a=$(".ticketIds").eq(t).val();fetch("/api/client/v1/cart/items/remove/"+a,{method:"DELETE"}).then((function(){window.location.reload()}))}else{jsf.ajax.request("shoppingCartForm","click",{execute:"shoppingCartForm",render:"pageDynamicContent"});var i=!1;jsf.ajax.addOnEvent(e=>{if("complete"===e.status){if(i)return;var a,r=$(".js-ticket-data").eq(t).parent().data("lotteryid");e.responseXML.getElementById("trackingInfo")&&(i=!0,a=e.responseXML.getElementById("trackingInfo").innerHTML.split('data-content-id="')[1].split('"')[0]),window.messageBus&&window.messageBus.subscribe("NewNavigationTippengineLoaded",(function(e,t){t.payload.ticket&&localStorage.setItem("tejs_"+r,t.payload.ticket),window.location.href=window.location.pathname.replace(n(window.location.pathname),n(a))}))}})}else dla.spinner.show(),jsf.ajax.request("shoppingCartForm","click",{execute:"shoppingCartForm",render:"lotteryNavigation -navItemUserControl pageDynamicContent"})}return{editTicket:function(e){i("edit",e)},removeTicket:function(e){window.messageBus&&window.messageBus.publish("CartUpdated",{payload:{}}),i("remove",e)},showTicket:function(t,a,n){if($(t.target).hasClass("cartContentRemoveItem")||"SCRATCHCARD"===$(t.currentTarget).data("productType"))return!1;function i(){window.setTimeout((function(){e.select(a,null,null,(function(e){dla.helper.scrollTo($(e).prev(".jsTicketHeader"),400)}))}),200)}dla.universalTracking.trackEvent("cartOverlayItem","show"),"shoppingCart"===dla.resources.lastPageId?i():(dla.navigate.onClick(t,n),$(window).one("page:enter",(function(e,t){"shoppingCart"===t&&i()})))},removeCartItem:function(e){dla.universalTracking.trackEvent("cartOverlayItem","remove"),$("#cartOverlayForm-ticketIdx").val(e),$("#cartOverlayForm-action").val("remove");var t="lotteryNavigation naviShoppingCart cartOverlayContent historyListShoppingCartHint";"shoppingCart"===dla.resources.lastPageId&&(t+=" pageDynamicContent"),dla.messages.growlReset(),dla.spinner.show(),jsf.ajax.request("cartOverlayForm","click",{execute:"cartOverlayForm",render:t})},init:function(){e=dla.ui.createAccordion("shoppingCartForm-largeTicketAccordion","jsTicketHeader","jsTicketBody",{callbacks:{open:t,opened:e=>{e[0].parentElement.querySelector(".js-view-details-link").classList.add("hide"),e[0].parentElement.querySelector(".js-hide-details-link").classList.remove("hide"),e[0].parentElement.querySelector(".jsTicketHeader").setAttribute("click-name","hideDetails")},closed:e=>{e[0].parentElement.querySelector(".js-view-details-link").classList.remove("hide"),e[0].parentElement.querySelector(".js-hide-details-link").classList.add("hide"),e[0].parentElement.querySelector(".jsTicketHeader").setAttribute("click-name","showDetails")}}}),window.messageBus.subscribe("NewNavigationTicketSubmitted",(function(){window.location.href=$("#trackingInfo").data("contentId")}))}}}(),$(window).trigger("available","shoppingCartJs");