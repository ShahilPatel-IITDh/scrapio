import{css as t,property as e,object as i,array as s,customElement as n,LitElement as a,dispatchShadowEvent as l,html as o,unsafeHTML as c}from"/de_DE/skins/lottoland/js/core/@lottoland/core/lit-element-c16c867bd604ce25.js";import{resources as r,messages as p}from"/de_DE/skins/lottoland/js/core/@lottoland/lsl-89f9ba0900100572.js";import"/de_DE/skins/lottoland/js/core/@lottoland/one-styleguide-8c4d78c467d1e167.js";function g(t,e){return e||(e=t.slice(0)),t.raw=e,t}function h(t,e,i,s){var n,a=arguments.length,l=a<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(l=(a<3?n(l):a>3?n(e,i,l):n(e,i))||l);return a>3&&l&&Object.defineProperty(e,i,l),l}const d="/api/client/v1/players/me/accounting/statistics/last30days",y="/api/client/v1/players/me/accounting/statistics/last30days/confirmation",u="/api/client/v1/players/me",f={apiKey:"",init(t){this.apiKey=t},getRequestOptions(){return{credentials:"include",headers:{"X-API-KEY":this.apiKey}}},getResponse:(t,e=!0)=>t.then(t=>e?t.json():t.text()),composeRequestUrl:t=>""+r.requestPrefix+t,getStatistics(){return this.getResponse(fetch(d,Object.assign({},this.getRequestOptions(),{method:"GET"})),!0)},acceptStatistics(){return this.getResponse(fetch(y,Object.assign({},this.getRequestOptions(),{method:"POST"})),!1)},getPlayer(){return this.getResponse(fetch(u,Object.assign({},this.getRequestOptions(),{method:"GET"})),!0)}};var v,m,b,L,w,_,x,S=t`:host{padding-bottom:calc(var(--ll-base-unit)*3)}.modal-content{display:flex;flex-direction:column;padding-top:8px}.modal-content #statistics-container{margin-top:24px;margin-bottom:16px;display:flex;flex-direction:column}.modal-content #statistics-container .statistic-line{display:flex;justify-content:space-between}.modal-content #statistics-container .statistic-line:first-child{padding-bottom:16px}.modal-content #statistics-container .statistic-line:last-child{padding-top:16px}.modal-content #lastLogin{display:flex;justify-content:space-between;padding:0 14px}ll-button{align-self:center;margin-top:48px}`;let O=class extends a{constructor(){super(...arguments),this.apiKey="",this.visible=!1,this.eventsToListen=["page:refresh","page:enter","logged"],this.player={isLogged:!1}}connectedCallback(){super.connectedCallback(),f.init(this.apiKey),this.eventsToListen.forEach(t=>window.addEventListener(t,this.handleShow.bind(this),!1))}disconnectedCallback(){this.eventsToListen.forEach(t=>window.removeEventListener(t,this.handleShow.bind(this),!1)),super.disconnectedCallback()}handleShow(t){"logged"===t.type&&(this.player.isLogged=!0),!this.visible&&this.player.isLogged&&f.getPlayer().then(t=>{this.visible=t.flags&&t.flags.includes("FINANCIAL_STATISTICS_FLAG")&&!t.spTier,this.lastLogin=t.oldestLastLogin,this.visible&&f.getStatistics().then(t=>this.statistics=t)})}getMessage(t){return p.getMessage(this.translations,t)}onClickAccept(){f.acceptStatistics().then(()=>{this.visible=!1,l(this,"financial-statistics-close")})}showStatistics(){return this.statistics?o(v||(v=g(['\n          <ll-container id="statistics-container">\n            <div class="statistic-line">\n              <ll-typography class="title" size="p"><strong>','</strong></ll-typography>\n              <ll-typography size="p"><ll-price amount='," currency=",'></ll-price></ll-typography>\n            </div>\n            <div class="statistic-line">\n              <ll-typography size="p"><strong>','</strong></ll-typography>\n              <ll-typography size="p"><ll-price amount='," currency=",'></ll-price></ll-typography>\n            </div>\n            <div class="statistic-line">\n              <ll-typography size="p"><strong>','</strong></ll-typography>\n              <ll-typography size="p"><ll-price amount='," currency=","></ll-price></ll-typography>\n            </div>\n          </ll-container>\n        "])),this.getMessage("financial_statistics_stakes"),this.statistics.stakes,r.currency,this.getMessage("financial_statistics_winnings"),this.statistics.winnings,r.currency,this.getMessage("financial_statistics_losses"),this.statistics.losses,r.currency):o(m||(m=g(['<ll-spinner size="49" strokeWidth="1"></ll-spinner>'])))}getDate(t){return new Date(t).toLocaleString()}showLastLogin(){return o(b||(b=g([""," "])),this.lastLogin?o(L||(L=g(['<div id="lastLogin">\n          <ll-typography size="p"><strong>','</strong></ll-typography>\n          <ll-typography size="p">',"</ll-typography>\n        </div>"])),this.getMessage("financial_statistics_lastLogin"),this.getDate(this.lastLogin)):null)}showConfirmation(){return o(w||(w=g([' <ll-button @click="','">',"</ll-button> "])),this.onClickAccept,this.getMessage("financial_statistics_accept_btn"))}renderModalContent(){return o(_||(_=g(['\n      <div id="financial-modal-content" class="modal-content">\n        <ll-typography id="infoMsg">',"</ll-typography>\n        "," "," ","\n      </div>\n    "])),c(this.getMessage("financial_statistics_msg")),this.showStatistics(),this.showLastLogin(),this.showConfirmation())}render(){return o(x||(x=g(["\n      <ll-modal hideClose="," ?visible=",'>\n        <div slot="title">',"</div>\n        ","\n      </ll-modal>\n    "])),!0,this.visible,this.getMessage("financial_statistics_modal_title"),this.renderModalContent())}};O.styles=S,h([e({type:Object,converter:i})],O.prototype,"translations",void 0),h([e({type:String})],O.prototype,"apiKey",void 0),h([e({type:Number})],O.prototype,"lastLogin",void 0),h([e({type:Boolean})],O.prototype,"visible",void 0),h([e({type:Object,converter:i})],O.prototype,"statistics",void 0),h([e({type:Array,converter:s})],O.prototype,"eventsToListen",void 0),h([e({type:Object,converter:i})],O.prototype,"player",void 0),O=h([n("ll-financial-statistics")],O);
