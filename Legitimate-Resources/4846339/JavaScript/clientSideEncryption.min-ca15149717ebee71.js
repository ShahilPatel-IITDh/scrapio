"use strict";dla.payment.clientSideEncryption=function(){function e(e,n){let t=n.find('input[name$="-cardHolderName-input"]').val(),a=n.find('input[name$="-cardNumber-input"]').val(),r=n.find('input[name$="-cvcCode-input"]').val(),d=i(".expiryMonthInput",n),p=i(".expiryYearInput",n);const o=n.find("input[data-encrypted-name]").val();return dla.payment.helper.initClientInfo(),opEncrypt({holderName:t,number:a,verificationCode:r,expiryMonth:d,expiryYear:p},JSON.parse(e),o).then(e=>{n.find('input[name$="-encryptedCardData"]').val(e),n.find('input[name$="-cardHolderName-input"]').removeAttr("name"),n.find('input[name$="-cardNumber-input"]').removeAttr("name"),n.find('input[name$="-cvcCode-input"]').removeAttr("name"),n.find('input[name$="-expiryMonth-input"]').removeAttr("name"),n.find('select[name$="-expiryMonth"]').removeAttr("name"),n.find('input[name$="-expiryYear-input"]').removeAttr("name"),n.find('select[name$="-expiryYear"]').removeAttr("name");let t=n.attr("id")+(dla.skin.isMobile?"-pay":"-pay-button");jsf.ajax.request(t,{type:"click"},{execute:"@form",render:"-paymentChecker -bonuspromotionTermsAndConditions",onevent:dla.payment.handleCreditCardAjaxEvent,"javax.faces.behavior.event":"action"})}).catch(e=>{dla.helper.log("WARNING","error creating encrypted payment data",e)})}function n(e){return["OptilePaymentProvider"].includes(e)}function t(e,n,t,i,a){let r=n.val();return opEncrypt({verificationCode:r},e,i).then(e=>{!function(e,n,t,i){e.val(n),t.removeAttr("name"),i()}(t,e,n,a)}).catch(e=>{dla.helper.log("WARNING","error creating encrypted payment data",e)})}function i(e,n){let t=$(e,n),i=t[0];return(t.is("select")?i.options[i.selectedIndex].value:t.val()).toInt()}return{encryptCreditCard:function(n,t){let i=t.find('input[name$="-publicKey"]').val();return"AdyenPaymentProvider"===n?(function(e,n){dla.payment.helper.initClientInfo();const t=e.find('input[name$="-encryptedCardData"]').attr("name");adyen.encrypt.createEncryptedForm(e[0],n,{name:t}).handleSubmit()}(t,i),!0):"OptilePaymentProvider"===n?(e(i,t),!1):"HexopayPaymentProvider"===n?(function(e,n){dla.payment.helper.initClientInfo(),new BeGatewayCSE(n).encrypt(e[0].id);let t={number:e.find('input[name$="number"]').val(),holder:e.find('input[name$="holderName"]').val(),exp_month:e.find('input[name$="expiryMonth"]').val(),exp_year:e.find('input[name$="expiryYear"]').val(),verification_value:e.find('input[name$="cvc"]').val()};e.find('input[name$="-encryptedCardData"]').val(JSON.stringify(t)),e.find('input[name$="cvc"]').remove(),e.find('input[name$="expiryMonth"]').remove(),e.find('input[name$="expiryYear"]').remove(),e.find('input[name$="number"]').remove(),e.find('input[name$="holderName"]').remove()}(t,i),!0):void 0},encryptVerificationCode:function(e,i,a){if(!n(e))return void a();const r=$(i).closest("section"),d=r.find('input[id$="-cvcCode-input"],input[id$="-quickdeposit-cvcCode-input"]'),p=$(i).closest("form"),o=p.find('input[name$="-encryptedCardData"]'),c=p.find("input[data-encrypted-name]").val(),m=r.find('input[name$="-publicKey"]').val();if("OptilePaymentProvider"===e){return t(JSON.parse(m),d,o,c,a)}return Promise.reject("Payment Provider not supported!")},encryptVerificationCodeMobile:function(e,i,a){if(!n(e))return void a();const r=$("li.selected.js-payment-gateway"),d=r.data("public-key"),p=r.find('input[name$="-cvcCode-input"]'),o=$(i).closest("form"),c=o.find('input[name$="-encryptedCardData"]'),m=o.find("input[data-encrypted-name]").val();return"OptilePaymentProvider"===e?t(d,p,c,m,a):Promise.reject("Payment Provider not supported!")},loadEncryptionLibrary:function(e){"AdyenPaymentProvider"===e&&dla.helper.loadScript("/js/lib/adyen/adyen.encrypt.min.js"),"OptilePaymentProvider"===e&&dla.helper.loadScript("/js/lib/optile/op-client-side-encryption1.1.0.min.js"),"HexopayPaymentProvider"===e&&dla.helper.loadScript("/js/lib/hexopay/begateway-cse.min.js")},encryptAndSubmitOptilePayment:e}}(),$(window).trigger("available","clientSideEncryptionLoaded");