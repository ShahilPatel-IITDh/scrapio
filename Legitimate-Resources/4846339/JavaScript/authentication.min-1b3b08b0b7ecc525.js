var validationFailed=validationFailed||!1;dla.authenticationFactory=function(n,e){"use strict";const t="AuthRequested",o="PlayerLoggedIn";var i,a,r,s=n("#authenticationForms"),c=n(".js-login"),l=n(".js-register"),u=n("#trackingInfo").data("playerReturning")?c:l,d=null,g=n.Deferred();if(n("#front").on("click",".social-text",(function(e){n(e.currentTarget).parents(".value").find("input").focus()})).on("click",".js-showRegister",f).on("click",".js-showLogin",h).on("click",".js-login-close:not(.js-forgotPassword-close)",m).on("click",".js-authentication-forgot",(function(){w()})).on("keypress",".js-form-pwd-alias",(function(n){if(13===n.keyCode)return v()})).on("click",".js-form-pwd-submit",(function(n){return v(n)})).on("click",".js-preventDoubleClick",(function(n){e.helper.preventDoubleClick(n)})).on("keyup",".js-authentication-input .js-form-control:not(.js-update-password)",(function(){e.passwordValidation.showPasswordErrors()})).on("keyup",".js-authentication-input .js-form-control.js-update-password",(function(){e.passwordValidation.showPasswordErrorsAndToggleSubmit(!0)})).on("keydown",".js-authentication-input .js-form-control.js-update-password",(function(n){e.passwordValidation.preventSubmitWhenPasswordIsNotMet(n)})).on("keyup",".js-email-container .js-form-control",(function(){e.passwordValidation.showPasswordErrors()})),!s.length)return!1;function p(){window.dispatchEvent(new CustomEvent("logout"))}function w(){d="forgotPasswordFrame",e.frontContent.show("passwordRequest")}function v(n){jsf.ajax.request("forgotPasswordFrame-requestPassword","click",{execute:"forgotPasswordFrame-requestPassword",render:"forgotPasswordFrame-requestPassword"}),n.preventDefault()}function f(){return window.magnolia&&window.messageBus?(window.messageBus.publish(t,{payload:{view:"register"}}),g):"registerOverlay"!==d&&(c.appendTo(s),u=l,k())}function h(){return window.magnolia&&window.messageBus?(window.messageBus.publish(t,{payload:{view:"login"}}),g):"loginOverlay"!==d&&(l.appendTo(s),u=c,k())}async function k(){if(window.magnolia&&window.messageBus){const e=n("#trackingInfo").data("playerReturning")?"login":"register";return window.messageBus.publish(t,{payload:{view:e}}),g}clearTimeout(r),r=setTimeout(m,828e5);var o=n("#frontContent"),i=u.attr("id");return"pending"!==g.state()&&(g=n.Deferred()),d=i,e.helper.onAvailability("universalTracking",(function(){e.universalTracking.trackUniversal([i,e.universalTracking.action.OPEN],!1,"USER")})),o.empty().show().append(u),e.layout.setBootstrapClassForContent(),e.helper.onAvailability("bootstrapJs",(function(){n(".js-front").addClass("dark").modal({backdrop:"static"}),n(window).trigger("authenticationOpen",[d.replace("Overlay","")])})),e.layout.customFocus(u.find(".email-input").attr("id")),document.querySelector(".js-frontContent .js-login-api")?window.dispatchEvent(new CustomEvent("login-open")):document.querySelector(".js-frontContent .js-register-api")?window.dispatchEvent(new CustomEvent("register-open")):document.querySelector(".js-login-form-bankid")&&window.dispatchEvent(new CustomEvent("bankid-open")),g}function m(n=!0){d=null,u.appendTo(s),g.then((function(){g.reject()})),window.dispatchEvent(new CustomEvent("login-close")),window.dispatchEvent(new CustomEvent("register-close")),!e.resources.playerNr&&e.resources.loginRequired&&n&&(e.layout.hideFront(),e.navigate.navigateTo(e.mappings.home)),"signup"!==e.frontContent.currentFrontContent()&&"none"!==e.frontContent.currentFrontContent()&&"login"!==e.frontContent.currentFrontContent()&&"passwordRequest"!==e.frontContent.currentFrontContent()&&"forcePasswordEnter"!==e.frontContent.currentFrontContent()&&"signupCompleteData"!==e.frontContent.currentFrontContent()&&"requestPasswordUpdate"!==e.frontContent.currentFrontContent()&&"twoFactor"!==e.frontContent.currentFrontContent()&&""!==e.frontContent.currentFrontContent()||e.layout.hideFront(),clearTimeout(r)}function j(){n(".js-register .js-modal-overlay").hide()}return n("#pageHeader, .js-header").on("click",".showLogin, .jsShowLoginOrRegister, .js-show-login-or-register",k).on("click",".jsShowRegister, .js-show-register",f).on("click",".jsShowLogin, .js-show-login",h),n(document.body).on("click",".js-logout",p),n("#content").on("click","#checkoutLogin",(function(n){n.preventDefault(),e.helper.onAvailability("universalTracking",(function(){e.universalTracking.trackEvent("checkOut","show_login")})),k()})),n("#content").on("click","#gratisTipLogin",(function(n){n.preventDefault(),e.helper.onAvailability("universalTracking",(function(){e.universalTracking.trackEvent("checkOut","show_login")})),f()})),{init:function(){window.magnolia&&window.messageBus&&window.messageBus.subscribe(o,(e,t)=>{t.payload.playerId&&(n("#trackingInfo").data("playerLoggedIn")||window.location.reload())})},showRegister:f,showLogin:h,open:k,close:m,handleAjaxRegister:function(t){e.helper.preventDoubleClick(t),t&&"begin"===t.status&&(n(".js-verification-spinner").data("show-verification-spinner")&&n(".js-register .js-modal-overlay").show(),n("#registerOverlay").on("keyup",".js-authentication-input .js-form-control",(function(){e.passwordValidation.showPasswordErrors()}))),t&&"complete"===t.status&&j(),t&&"success"===t.status&&(validationFailed?(n("#registerOverlay .js-authentication-input .js-form-control").val().length>0&&e.passwordValidation.showPasswordErrors(),e.helper.onAvailability("universalTracking",(function(){e.universalTracking.trackRegistration(e.universalTracking.action.REGISTRATION_FAILED),e.universalTracking.pseudoPageView(e.universalTracking.action.REGISTRATION_FAILED)}))):(n("#lotteryNavigationSection").load(location.href+" #lotteryNavigationSection"),e.helper.onAvailability("universalTracking",(function(){e.universalTracking.trackRegistration(e.universalTracking.action.REGISTRATION_SUCCESS),e.universalTracking.pseudoPageView(e.universalTracking.action.REGISTRATION_SUCCESS)})),g.resolve(),m()),window.dispatchEvent(new CustomEvent("logged")),localStorage.getItem("obs-bundle-to-assign")&&localStorage.setItem("obs-registered-user",!0))},hideVerificationOverlay:j,handleAjaxLogin:function(t){e.helper.preventDoubleClick(t),n(window).trigger("page:leave",e.resources.lastPageId),"success"===t.status&&(validationFailed?e.helper.onAvailability("universalTracking",(function(){e.universalTracking.trackLogin(e.universalTracking.action.LOGIN_FAIL)})):(e.helper.onAvailability("universalTracking",(function(){e.universalTracking.trackLogin(e.universalTracking.action.LOGIN_SUCCESS)})),n("#lotteryNavigationSection").load(location.href+" #lotteryNavigationSection"),g.resolve(),n("a.jsOptin").length>0&&e.optinpromotions.updateStatus(),window.dispatchEvent(new CustomEvent("logged")),localStorage.getItem("obs-bundle-to-assign")&&localStorage.setItem("obs-logged-user",!0)))},handleAjax2faLogin:function(t){e.helper.preventDoubleClick(t),n(window).trigger("page:leave",e.resources.lastPageId),"success"===t.status&&(validationFailed?e.helper.onAvailability("universalTracking",(function(){e.universalTracking.trackLogin(e.universalTracking.action.TWO_FACTOR_FAIL)})):(e.helper.onAvailability("universalTracking",(function(){e.universalTracking.trackLogin(e.universalTracking.action.TWO_FACTOR_SUCCESS)})),m()))},handleAjaxForgotPassword:function(n){n&&"success"===n.status&&e.helper.onAvailability("universalTracking",(function(){e.universalTracking.trackUniversal(e.universalTracking.action.FORGOTTEN_PASSWORD_POSSIBLY_SENT,!1,"SYSTEM")}))},switchButtonState:function(e){if(e&&e.status){var t=n(".jsRegisterButton");switch(e.status){case"begin":t.prop("disabled",!0);break;case"complete":t.prop("disabled",!1);break;case"success":n("#signUpForm-streetNr-input").focus()}}},showDepositLimit:function(){n(".js-depositLimit").removeClass("hidden"),n(".js-openDepositLimit").addClass("hidden"),n(".js-closeDepositLimit").removeClass("hidden"),n(".js-depositLimitSelect").length&&(i=n(".js-depositLimitSelect")[0].selectedIndex)},hideDepositLimit:function(){n(".js-depositLimit").addClass("hidden"),n(".js-openDepositLimit").removeClass("hidden"),n(".js-closeDepositLimit").addClass("hidden"),n(".js-depositLimitSelect").length&&(n(".js-depositLimitSelect")[0].selectedIndex=i,n(".js-depositLimitSelect select option:eq("+i+")").prop("selected",!0))},openForgotPassword:w,resolve:function(){g.resolve()},showLoginOrRegister:function(){n("#trackingInfo").data("playerReturning")?h():f()},cleanAuthToken:function(){window.localStorage.removeItem("authToken")},passwordUpdateShow:function(t){a=t;let o=n(".forcePasswordEnter");n(".close-dialog").trigger("click"),e.layout.showFront();const i=o.parents("#frontContent"),r=o.find(".back");i.show(),r.click(()=>location.href=t)},passwordUpdateSuccess:function(){let n=a;const e=document.querySelector("[data-content-id]");!n&&e&&(n=e.dataset.contentId),document.querySelector('[id$="successPageRedirection"]').value=n||window.location.pathname}}},dla.helper.onAvailability(["passwordValidationLoaded"],(function(){dla.authentication=dla.authenticationFactory(window.jQuery,window.dla),$(window).trigger("available","authenticationJsLoaded"),dla.authentication&&dla.authentication.init&&dla.authentication.init()}));