"use strict";dla.helper.createNamespace("dla.profile.image"),dla.profile.image=function(){var defaults={uploader:{validation:{allowedExtensions:["jpg","jpeg","gif","png"],sizeLimit:2097152,minSizeLimit:0},maxConnections:1,debug:!1,multiple:!1,showMessage:function(e){dla.messages.showConfirm(e)}},messageContainer:"#messageFade"};function init(e){if(e.uploader){var o=$.extend({},defaults.uploader,e.uploader);createUploader(o),$("#"+o.resetButtonId).on("click",(function(e){e.preventDefault(),resetUploadForm(o)}))}}function createUploader(options){function uploadSubmit(e){$(options.messageContainer).hide(),$(options.uploadButtonText).hide(),$(options.uploadButtonLoader).show(),$(options.uploadButtonInput).hide().prop("disabled",!0),$("."+options.uploadedItemsClass).hide(),$("#"+options.cancelButtonEl).prop("disabled",!0),$("#"+options.saveButtonEl).prop("disabled",!0)}function uploadComplete(xhr,id,name,responseJSON){if(responseJSON&&responseJSON.success){if($(options.uploadButtonText).show(),$(options.uploadButtonLoader).hide(),$(options.uploadButtonInput).show().prop("disabled",!1),"PLAYER"===options.contextType.replace(/\//g,"")&&(options.contextType=""),$("#"+options.cancelButtonEl).prop("disabled",!1),$("#"+options.saveButtonEl).prop("disabled",!1),void 0!==responseJSON.image){var imgSrc=options.contextPath+options.contextType+options.additionalPathFragments+responseJSON.image;getTargetImage(options).attr("src",imgSrc),$("#"+options.hiddenImageId).val(responseJSON.image)}eval(options.afterCompleteMethod)}else{var errorMessage=dla.messages.get("common_error")+": "+dla.messages.get("common_upload_error");options.showMessage(errorMessage)}}function uploadProgress(e){$(options.uploadButtonInput).prop("disabled",!0)}function uploadError(e,o,t,a){options.showMessage(a)}options.uploaderCallbacks={submit:uploadSubmit,complete:uploadComplete,progress:uploadProgress,error:uploadError},dla.helper.fineUploader.init(options)}function getTargetImage(e){var o;return e.target?(!$("."+e.target).find("img").size()>0&&$("."+e.target).append("<img />"),o=$("."+e.target).find("img")):o=$("."+e.imgClass).find("img"),o}function resetUploadForm(e){getTargetImage(e).attr("src",e.useRetina?e.retinaSrc:e.normSrc),$("#"+e.hiddenImageId).val("dummy"),$("#"+e.resetButtonId).hide()}return{init:init}}();