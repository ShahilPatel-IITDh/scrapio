(window.webpackJsonpDelete=window.webpackJsonpDelete||[]).push([[313],{1333:function(e,t,s){"use strict";s.r(t);var r=s(2),o=(s(39),s(4),s(20),s(215),s(46),s(5),s(125)),i=s(32);const n=Object.freeze({WINDOW:"window",POPUP:"popup"});var a=s(142),c=s(19),l=s.n(c);s(62),s(926);const h="script",d="styles";class u{constructor(e=[],t=!1){this._loadingResources={},this.dualApproach=t,this.setPreloadedResources(e);const s=document.createElement("script");this.isModuleSupported="noModule"in s}setPreloadedResources(e){this._preloadedResources=e.map(e=>this._getResolvedResourceUrl(e))}setDebug(e=!0){this._debug=e}load(e){return Promise.allSettled(e.map(this.loadResource.bind(this)))}loadResource(e){return this._getLoadingPromise(e)}isResourceLoaded(e){return 0!==this._preloadedResources.filter(t=>t===this._getResolvedResourceUrl(e)).length||0!==window.performance.getEntriesByName(this._getResolvedResourceUrl(e),"resource").length&&(this._log(e+" is already loaded"),!0)}_log(e){this._debug&&console.log(e)}_getLoadingPromise(e){const t=this._getResourceTypeByUrl(e)===h,s=this._isModule(e);if(this.dualApproach&&t)if(this.isModuleSupported){if(!s)return Promise.reject()}else if(s)return Promise.reject();try{if(this.isResourceLoaded(e))return Promise.resolve();const t=this._findResourceNodeByUrl(e);return t?(this._log(e+" is found as a node"),this._getLoadingPromiseFromNode(t,e)):this._loadResource(e)}catch(e){return Promise.reject(e)}}_findResourceNodeByUrl(e){let t=this._getQuerySelectorByUrl(e);const s=this._getResolvedResourceUrl(e);return e!==s&&(t+=","+this._getQuerySelectorByUrl(s)),document.querySelector(t)}_getQuerySelectorByUrl(e){switch(this._getResourceTypeByUrl(e)){case h:return""+this._getScriptSelector(e);case d:return""+this._getStyleLinkSelector(e)}}_getLoadingPromiseFromNode(e){return new Promise((t,s)=>{e.addEventListener("load",e=>{t()}),e.addEventListener("error",e=>{s(e)})})}_loadResource(e){this._log(e+" will be inserted");const t=this._getResolvedResourceUrl(e);if(!(t in this._loadingResources)){const e=this._getLoadingPromiseOfInsertion(t);this._loadingResources[t]=e;const s=()=>delete this._loadingResources[t];e.then(s,s)}return this._loadingResources[t]}_getLoadingPromiseOfInsertion(e){let t=null;switch(this._getResourceTypeByUrl(e)){case h:t=this._insertScript(e);break;case d:t=this._insertStyleLink(e)}return this._getLoadingPromiseFromNode(t)}_isModule(e){return!!e.match(/.\.mjs/)||!e.match(/.\.js/)&&void 0}_getResolvedResourceUrl(e){return this._resolvingAnchor||(this._resolvingAnchor=document.createElement("a")),this._resolvingAnchor.href=e,this._resolvingAnchor.href}_getResourceTypeByUrl(e){if(e.match(/.\.css/))return d;if(e.match(/.\.m?js/))return h;if(e.match(/.\.svg/))return!0;throw new Error(`The type of resource ${e} could not be recognized`)}_insertScript(e){const t=document.createElement("script"),s=this._isModule(e);t.async=!0,t.src=e,s?t.type="module":t.defer=!0;const r=document.getElementsByTagName("script")[0];return r.parentNode.insertBefore(t,r),t}_insertStyleLink(e){const t=document.createElement("link");return t.rel="stylesheet",t.href=e,document.head.insertAdjacentElement("beforeend",t),t}_getScriptSelector(e){return`script[src="${e}"]`}_getStyleLinkSelector(e){return`link[href="${e}"]`}}var p=s(128),g=s(10),m=s(15),_=s(21),y=s(115);function f(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function b(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?f(Object(s),!0).forEach((function(t){O(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):f(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function O(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const P="PageModal";class w{constructor(e={}){O(this,"open",(e,t)=>{e&&(this.state.chainStartUrl||this.options.stateless||(this.state.chainStartUrl=window.location.href),this.title=t,this._openModal(e),this.options.stateless||this._setHistoryState(e))}),O(this,"_onHistoryChange",(e,t,s)=>{s?this._cleanContent(e):this._updateContent(e,t)}),O(this,"_onClose",e=>{if(!this.options.stateless){g.a.setDefaultData();const t=a.a.getState();this.title&&(Object(m.a)(g.a.siteSection,"Close modal window",this.title),this.title=null),t&&t.url===e&&(a.a.pushState(P,null,this.state.chainStartUrl,{renderType:n.WINDOW,sessionId:this.state.sessionId}),this.state.chainStartUrl="")}}),O(this,"_resetCache",()=>{Object.keys(this.modalCache).forEach(e=>{this.modalCache[e].destroy(),delete this.modalCache[e]})}),this.defaultOptions={stateless:!1},this.options=b(b({},this.defaultOptions),e),this.state={sessionId:l()(10),chainStartUrl:null,isOpenning:!1,modal:null},this.modalCache={},this.resourceLoader=new u([],!0),this.options.stateless||(this.unsubscribeHistoryController=a.a.subscribeOnPopstate(P,this._onHistoryChange))}_openModal(e){this.state.isOpenning||(this.state.isOpenning=!0,this._getModal(e).then(e=>{try{e.open(),this.state.isOpenning=!1,this.state.modal=e}catch(e){console.log(e)}}).catch(e=>{this.state.isOpenning=!1,console.log(e)}))}_closeModal(){this.state.modal&&this.state.modal.close()}_getModal(e){return this.modalCache[e]?Promise.resolve(this.modalCache[e]):this._getTarget(e).then(t=>{try{var s;return this.modalCache[e]=o.a.create(t,{bemList:["article",...null!==(s=this.options.bemList)&&void 0!==s?s:[]],onOpen:()=>{var t,s;!this.options.stateless&&this.title&&(t=e,s=this.title,window.dataLayer&&!_.a.config.isInEditingMode&&window.dataLayer.push({event:"pageviewTrack",pageUrl:t,pageTitle:s}))},onClose:()=>{this._onClose(e)}}),this.modalCache[e]}catch(e){return Promise.reject(e)}}).catch(e=>(p.b.hide(),Promise.reject(e)))}_getAsyncUrl(e){return e+(this._getDelimeter(e)+"overlay=true")}_getDelimeter(e){return e.includes("?")?"&":"?"}_generateHtml(e){const t=Object(y.createFragment)(e),s=Object(y.createElement)("<div></div>");return s.appendChild(t),document.body.appendChild(s),s}_getPromiseWithTimeout(e,t){let s;const r=new Promise(e=>{s=setTimeout(()=>e(),t)});return Promise.race([e,r]).then(e=>(clearTimeout(s),e))}_getTarget(e){const t=this._getAsyncUrl(e);return p.b.show(),i.a.get(t).then(e=>{const t=this._generateHtml(e.data);this.jsonData=this._getJsonData(t),this.jsonData.pageData&&g.a.setModalData(this.jsonData.pageData);const s=this.resourceLoader.load(this.jsonData.resources);return this._getPromiseWithTimeout(s,500).then(()=>Promise.resolve(t.firstChild))}).catch(e=>Promise.reject(e)).finally(()=>{p.b.hide()})}_getJsonData(e){const t=e.querySelector("[data-dc-overlay-content]");let s=[];try{s=JSON.parse(t.getAttribute("data-dc-overlay-content"))}catch(e){console.error("Can not load resorces declared on "+t)}return s}_setHistoryState(e){a.a.pushState(P,null,e,{renderType:n.POPUP,sessionId:this.state.sessionId})}_updateContent(e,t){const{sessionId:s}=this.state;e&&e.sessionId===s&&t.sessionId!==s?this._closeModal():t.sessionId===s?t.renderType===n.POPUP?this._openModal(t.url):t.renderType===n.WINDOW&&this._closeModal():window.location.reload()}_cleanContent(e){e.sessionId===this.state.sessionId?this._closeModal():window.location.reload()}}var j=new w;function v(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function S(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?v(Object(s),!0).forEach((function(t){R(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):v(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function R(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class D extends r.a{constructor(e,t){super(e),R(this,"onClick",e=>{e.preventDefault();const t=this.options.url||this.element.href,s=this.options.title||this.element.textContent.trim();this.modal.open(t,s)}),this.options=S(S({},this.options),t),this.stateless=this.options.stateless,this.stateless?this.modal=new w(S(S({},this.options),{},{stateless:!0})):this.modal=j}static getNamespace(){return"page-modal-trigger"}onInit(){this.addListener(this.element,"click",this.onClick)}}r.b.register(D)}},[[1333,0,1,3,2,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,21,26,37,39,41,42,48,49,51,53,54,57,58,80,81,82,92,103,425,16,20,22,27,29,30,38,40,44,60,108,118]]]);