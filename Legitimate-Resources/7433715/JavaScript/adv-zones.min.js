var TI=TI||{};TI.adv=function($,window,googletag,tagTargeting){var adSlots=[];var currentBreakpoint;var nextSlotId=0;function generateNextSlotId(){return nextSlotId++;}
function moreContent(newContent){var newSlots=[];newContent.find('.adv-wrapper').each(function(){var ns=pushGridAdv(this);newSlots.push(ns);});googletag.pubads().refresh(newSlots);}
function pushGridAdv(el){var slotId=generateNextSlotId();var slotName='adslot'+slotId;var slotDiv=document.createElement('div');slotDiv.id=slotName;el.appendChild(slotDiv);googletag.cmd.push(function(){adSlots[slotId]=googletag.defineSlot('/20844071/wp-grid-300x250--global',[300,250],slotName).addService(googletag.pubads());googletag.display(slotName);});return adSlots[slotId];}
function leaderboards(){var newSlots=[];$('.leaderboard-wrapper').each(function(){var slot='';if($(this).hasClass('leaderboard-wrapper--header')){slot='/20844071/wp-leaderboard-header';}else{slot='/20844071/wp-leaderboard-footer';}
var ns=pushLeaderboardAdv(this,slot);newSlots.push(ns);});googletag.pubads().refresh(newSlots);}
function pushLeaderboardAdv(el,slot){var slotId=generateNextSlotId();var slotName='leaderboardadslot'+slotId;var slotDiv=document.createElement('div');slotDiv.id=slotName;el.appendChild(slotDiv);googletag.cmd.push(function(){var viewpot,adSize;if($('.magazine-single--portrait').length){viewport=[1340,0];adSize=[728,90];}else{viewport=[1340,0];adSize=[970,90];}
var mapping=googletag.sizeMapping().addSize(viewport,adSize).addSize([1025,0],[970,90]).addSize([768,0],[728,90]).addSize([480,0],[468,60]).addSize([0,0],[320,50]).build();adSlots[slotId]=googletag.defineSlot(slot,[970,90],slotName).defineSizeMapping(mapping).addService(googletag.pubads());googletag.display(slotName);});return adSlots[slotId];}
function resizeiFrame(adv,wrapper){var wrapperWidth=wrapper.outerWidth(),scale=1;if(wrapperWidth<300){scale=wrapperWidth/300;}else{scale=1;}
adv.css({"transform":"scale("+scale+")","transform-origin":"0 0"});}
function getBreakPoint(){var width=window.innerWidth;if(width<=320){return 0;}else if(width<=480){return 1;}else if(width<=768){return 2;}else if(width<=1025){return 3;}
return 4;}
function setup(){currentBreakPoint=getBreakPoint();googletag.pubads().enableSingleRequest();googletag.pubads().disableInitialLoad();if(tagTargeting){for(var key in tagTargeting){googletag.pubads().setTargeting(key,tagTargeting[key]);}}
googletag.enableServices();leaderboards();moreContent($('#content'));googletag.pubads().addEventListener('slotRenderEnded',function(event){var ele=$('#'+event.slot.getSlotElementId());var wrapper=ele.parent('.adv-wrapper');if(wrapper){var adv=wrapper.find('iframe');if(adv.length){resizeiFrame(adv,wrapper);}}});var resizeTimer;$(window).on('resize',function(e){clearTimeout(resizeTimer);resizeTimer=setTimeout(function(){var newBreakPoint=getBreakPoint();if(newBreakPoint!=currentBreakPoint){currentBreakPoint=newBreakPoint;googletag.pubads().refresh(adSlots);}},250);});}
$(document).ready(function(){var init=function(){if(window.googletag&&googletag.apiReady){setup();}else{setTimeout(init,250);}};init();});return{resizeiFrame:resizeiFrame,moreContent:moreContent};}(jQuery,window,googletag,tagTargeting);