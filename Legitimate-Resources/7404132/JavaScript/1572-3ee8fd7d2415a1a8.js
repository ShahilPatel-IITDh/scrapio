(this.webpackChunk_msteams_webinar_registration=this.webpackChunk_msteams_webinar_registration||[]).push([[1572],{88258:e=>{e.exports={kind:"Document",definitions:[{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"WindowStateEvent"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"isFocused"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"correlation"},type:{kind:"NamedType",name:{kind:"Name",value:"ServerCorrelation"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"shouldClose"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"ServerCorrelation"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"startTimestamp"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"source"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Subscription"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"windowStateEvent"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"windowId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"WindowStateEvent"}}}}]}]}},54621:e=>{e.exports={kind:"Document",definitions:[{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Query"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationUsers"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"filter"},type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserFilter"}}}],type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}}}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"authenticatedUser"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"allowAnon"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"correlationId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[{kind:"Directive",name:{kind:"Name",value:"deprecated"},arguments:[{kind:"Argument",name:{kind:"Name",value:"reason"},value:{kind:"StringValue",value:"Use correlation",block:!1}}]}]},{kind:"InputValueDefinition",name:{kind:"Name",value:"loginHint"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"tenantId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"userContextId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"resource"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"acquireTokenOptions"},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationToken"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"authConsent"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"resource"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"tenantId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"acquireTokenOptions"},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],type:{kind:"NamedType",name:{kind:"Name",value:"AuthConsent"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"hostMachineUsers"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"fetchAuthenticatedUsers"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"HostMachineUser"}}}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"tenantData"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"accountId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],type:{kind:"NamedType",name:{kind:"Name",value:"TenantData"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"userAuthState"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"userContextId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],type:{kind:"NamedType",name:{kind:"Name",value:"UserAuthStateData"}}}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Mutation"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"authenticateUser"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"correlationId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"loginHint"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"loginUser"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"correlationId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"loginHint"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationLogout"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"reason"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],type:{kind:"NamedType",name:{kind:"Name",value:"authenticationLogoutResponse"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"reauthenticateUser"},type:{kind:"NamedType",name:{kind:"Name",value:"ReauthenticateResponse"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"resolveThirdPartyOauthCode"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"code"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"state"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"initializeAccounts"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"switchAccount"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"userContextId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"refreshTenants"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"userContextId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TenantData"}}}}}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Subscription"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationUsersEvent"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationServiceEvent"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationStateChanged"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationStateChangedEvent"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationUser"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"profile"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserProfile"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"isAuthenticated"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"type"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationAccountType"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"role"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserRole"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"loginUserName"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"cloud"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationCloudType"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"homeAccountId"},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"subType"},type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserSubType"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"authenticationLogoutResponse"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"succeed"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"ReauthenticateResponse"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"success"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"AuthenticationAccountType"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"Anonymous"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Aad"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Msa"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"MsaLife"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"GFed"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Otp"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"AuthenticationCloudType"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"dod"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"gcch"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"life"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"prod"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"AuthenticationUserRole"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"Member"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Anonymous"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Guest"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"AuthenticationUserSubType"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"Default"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Mto"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"AuthenticationState"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"Up"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"InteractionRequired"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"AADReconnecting"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"SkypeReconnecting"}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationUserFilter"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"isAuthenticated"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"isPrimaryUser"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"AcquireTokenOptions"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"claim"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"silent"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"userIdentifier"},type:{kind:"NamedType",name:{kind:"Name",value:"UserIdentifier"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"tenantId"},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"UserIdentifier"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"tenantId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"oid"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"userName"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"accountType"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationAccountType"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationToken"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"token"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AuthConsent"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"consentAccepted"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationUserProfile"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"objectId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"tenantId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"upn"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"puid"},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationServiceEvent"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationUsers"},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}}}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationStateChangedEvent"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationState"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationState"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"HostMachineUser"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"accountType"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"displayName"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"emailPhone"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"picture"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"TenantData"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"tenantName"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"tenantId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"userId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"tenantType"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"userType"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"isInvitationRedeemed"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"cloudType"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"UserAuthStateData"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"state"},type:{kind:"NamedType",name:{kind:"Name",value:"UserAuthState"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"reason"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"customError"},type:{kind:"NamedType",name:{kind:"Name",value:"CustomError"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"CustomError"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"errorCode"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"message"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"context"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"isExpected"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"innerError"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"correlationId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"subContext"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"UserAuthState"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"Up"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"InteractionRequired"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"AADReconnecting"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"SkypeReconnecting"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"LicenseError"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"SignInRestriction"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"UnRedeemed"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"LoginError"}}]}]}},56023:e=>{e.exports={kind:"Document",definitions:[{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Query"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"allClientPreferences"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"clientPreferences"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"category"},type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferencesCategory"}}}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferenceCategoryTypes"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"userExperiencePreferences"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserExperiencePreferences"}}}}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Mutation"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"updateClientPreferences"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"value"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferencesInput"}}}}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"updateUserExperiencePreferences"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"value"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserExperiencePreferencesInput"}}}}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserExperiencePreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"clearUserExperiencePreferences"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"clearUserExperiencePreferencesByCategory"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"category"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserExperiencePreferencesCategory"}}}}],type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Subscription"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"clientPreferencesChangedEvent"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"category"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferencesCategory"}}}}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferenceCategoryTypes"}}}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"Density"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"comfy"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"compact"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"FlyoutCameraUserChoice"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"on"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"off"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"notSet"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"InfoPaneState"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"closed"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"hidden"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"open"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"UserTheme"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"light"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"dark"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"contrast"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"UserExperiencePreferencesCategory"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"tflGroupTemplatesHidden"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"tflMeetingChicletPrivacyNoticeSettings"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"prejoinSettings"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"coachSettings"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"streamingSettings"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"channelInfoPaneSettings"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"chatInfoPaneSettings"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"audienceViewSettings"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"newChatDraft"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"mtmaAppBannerSettings"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"ClientPreferencesCategory"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"animation"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"density"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"flyoutCamera"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"infoPane"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"performance"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"appSwitcher"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"theme"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"videoEffect"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"promo"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"avatar"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"teamLayout"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"diagnosticsLogs"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"PerformanceMode"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"normal"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"low"}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"ThemePreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"userTheme"},type:{kind:"NamedType",name:{kind:"Name",value:"UserTheme"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"followOsTheme"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AnimationPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"disableAnimations"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AppSwitcherPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"checkboxChecked"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"PromoBadgePreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"badgeActionComplete"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"labelActionComplete"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"DensityPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"chatDensity"},type:{kind:"NamedType",name:{kind:"Name",value:"Density"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"FlyoutCameraPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"cameraState"},type:{kind:"NamedType",name:{kind:"Name",value:"FlyoutCameraUserChoice"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"InfoPanePreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"chats"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"channels"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"chatContextualSearch"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"channelcontextualsearch"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"TeamLayoutPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"currentLayout"},type:{kind:"NamedType",name:{kind:"Name",value:"TeamLayoutPreferenceOptions"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"ClientPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"animation"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AnimationPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"density"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DensityPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"flyoutCamera"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FlyoutCameraPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"infoPane"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"InfoPanePreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"performance"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PerformancePreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"appSwitcher"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppSwitcherPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"theme"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ThemePreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"videoEffect"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VideoEffectPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"promo"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PromoBadgePreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"avatar"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AvatarPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"teamLayout"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TeamLayoutPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"diagnosticsLogs"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DiagnosticsLogsPreferences"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"TflGroupTemplateHidden"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"groupTemplate"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"isHidden"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"TflGroupTemplatesHidden"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"items"},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TflGroupTemplateHidden"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"TflMeetingChicletPrivacyNoticeSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"dismissedAt"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"noticeDismissCount"},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"PrejoinSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"prejoinScreenSelectedAudio"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"prejoinScreenVideoState"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"prejoinScreenMicState"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AudienceViewSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"coachmarksDisplayed"},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"CoachSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"isAutoStart"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"StreamingSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"uuid"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"ChatInfoPaneSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"shouldShow"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"ChannelInfoPaneSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"shouldShow"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"NewChatDraft"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"selectedUsers"},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"groupName"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"MtmaAppBannerSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"dismissedApps"},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"UserExperiencePreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"tflGroupTemplatesHidden"},type:{kind:"NamedType",name:{kind:"Name",value:"TflGroupTemplatesHidden"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"tflMeetingChicletPrivacyNoticeSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"TflMeetingChicletPrivacyNoticeSettings"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"prejoinSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"PrejoinSettings"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"coachSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"CoachSettings"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"streamingSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"StreamingSettings"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"channelInfoPaneSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"ChannelInfoPaneSettings"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"chatInfoPaneSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"ChatInfoPaneSettings"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"audienceViewSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"AudienceViewSettings"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"newChatDraft"},type:{kind:"NamedType",name:{kind:"Name",value:"NewChatDraft"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"mtmaAppBannerSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"MtmaAppBannerSettings"}}}]},{kind:"UnionTypeDefinition",name:{kind:"Name",value:"ClientPreferenceCategoryTypes"},types:[{kind:"NamedType",name:{kind:"Name",value:"AnimationPreferences"}},{kind:"NamedType",name:{kind:"Name",value:"DensityPreferences"}},{kind:"NamedType",name:{kind:"Name",value:"FlyoutCameraPreferences"}},{kind:"NamedType",name:{kind:"Name",value:"InfoPanePreferences"}},{kind:"NamedType",name:{kind:"Name",value:"PerformancePreferences"}},{kind:"NamedType",name:{kind:"Name",value:"AppSwitcherPreferences"}},{kind:"NamedType",name:{kind:"Name",value:"ThemePreferences"}},{kind:"NamedType",name:{kind:"Name",value:"VideoEffectPreferences"}},{kind:"NamedType",name:{kind:"Name",value:"AvatarPreferences"}},{kind:"NamedType",name:{kind:"Name",value:"PromoBadgePreferences"}},{kind:"NamedType",name:{kind:"Name",value:"TeamLayoutPreferences"}},{kind:"NamedType",name:{kind:"Name",value:"DiagnosticsLogsPreferences"}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"PerformancePreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"mode"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PerformanceMode"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AvatarPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"lastUsedAvatarFilter"},type:{kind:"NamedType",name:{kind:"Name",value:"AvatarFilter"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"VideoEffectPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"lastUsedVideoFilter"},type:{kind:"NamedType",name:{kind:"Name",value:"VideoFilter"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"lastUsedBackgroundImage"},type:{kind:"NamedType",name:{kind:"Name",value:"VideoCustomBackgroundImage"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"VideoFilter"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"appId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"filterId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"appName"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"VideoCustomBackgroundImage"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"imageId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"imagePath"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AvatarFilter"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"appId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"filterId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"imageId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"DiagnosticsLogsPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"shouldPersistLogsIntoIDB"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"TflGroupTemplatesHiddenInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"items"},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TflGroupTemplateHiddenInput"}}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"TflGroupTemplateHiddenInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"groupTemplate"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"isHidden"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"TflMeetingChicletPrivacyNoticeSettingsInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"dismissedAt"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"noticeDismissCount"},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"PrejoinSettingsInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"prejoinScreenSelectedAudio"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"prejoinScreenVideoState"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"prejoinScreenMicState"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"CoachSettingsInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"isAutoStart"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"StreamingSettingsInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"uuid"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"ChatInfoPaneSettingsInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"shouldShow"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"ChannelInfoPaneSettingsInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"shouldShow"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"AudienceViewSettingsInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"coachmarksDisplayed"},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"NewChatDraftInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"selectedUsers"},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"groupName"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"MtmaAppBannerSettingsInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"dismissedApps"},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"UserExperiencePreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"tflGroupTemplatesHidden"},type:{kind:"NamedType",name:{kind:"Name",value:"TflGroupTemplatesHiddenInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"tflMeetingChicletPrivacyNoticeSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"TflMeetingChicletPrivacyNoticeSettingsInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"prejoinSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"PrejoinSettingsInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"coachSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"CoachSettingsInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"streamingSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"StreamingSettingsInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"chatInfoPaneSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"ChatInfoPaneSettingsInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"channelInfoPaneSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"ChannelInfoPaneSettingsInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"audienceViewSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"AudienceViewSettingsInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"newChatDraft"},type:{kind:"NamedType",name:{kind:"Name",value:"NewChatDraftInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"mtmaAppBannerSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"MtmaAppBannerSettingsInput"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"AnimationPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"disableAnimations"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"CheckboxPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"checkboxChecked"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"PromoBadgePreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"badgeActionComplete"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"labelActionComplete"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"DensityPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"chatDensity"},type:{kind:"NamedType",name:{kind:"Name",value:"Density"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"FlyoutCameraPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"cameraState"},type:{kind:"NamedType",name:{kind:"Name",value:"FlyoutCameraUserChoice"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"InfoPanePreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"chats"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"channels"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"chatContextualSearch"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"channelcontextualsearch"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"PerformancePreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"mode"},type:{kind:"NamedType",name:{kind:"Name",value:"PerformanceMode"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"ThemePreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"userTheme"},type:{kind:"NamedType",name:{kind:"Name",value:"UserTheme"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"followOsTheme"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"VideoEffectPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"lastUsedVideoFilter"},type:{kind:"NamedType",name:{kind:"Name",value:"VideoFilterInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"lastUsedBackgroundImage"},type:{kind:"NamedType",name:{kind:"Name",value:"VideoCustomBackgroundImageInput"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"AvatarPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"lastUsedAvatarFilter"},type:{kind:"NamedType",name:{kind:"Name",value:"AvatarFilterInput"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"VideoFilterInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"appId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"filterId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"appName"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"VideoCustomBackgroundImageInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"imageId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"imagePath"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"AvatarFilterInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"appId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"filterId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"imageId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"TeamLayoutPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"currentLayout"},type:{kind:"NamedType",name:{kind:"Name",value:"TeamLayoutPreferenceOptions"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"DiagnosticsLogsPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"shouldPersistLogsIntoIDB"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"ClientPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"animation"},type:{kind:"NamedType",name:{kind:"Name",value:"AnimationPreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"density"},type:{kind:"NamedType",name:{kind:"Name",value:"DensityPreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"flyoutCamera"},type:{kind:"NamedType",name:{kind:"Name",value:"FlyoutCameraPreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"infoPane"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPanePreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"performance"},type:{kind:"NamedType",name:{kind:"Name",value:"PerformancePreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"appSwitcher"},type:{kind:"NamedType",name:{kind:"Name",value:"CheckboxPreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"theme"},type:{kind:"NamedType",name:{kind:"Name",value:"ThemePreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"videoEffect"},type:{kind:"NamedType",name:{kind:"Name",value:"VideoEffectPreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"promo"},type:{kind:"NamedType",name:{kind:"Name",value:"PromoBadgePreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"avatar"},type:{kind:"NamedType",name:{kind:"Name",value:"AvatarPreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"teamLayout"},type:{kind:"NamedType",name:{kind:"Name",value:"TeamLayoutPreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"diagnosticsLogs"},type:{kind:"NamedType",name:{kind:"Name",value:"DiagnosticsLogsPreferencesInput"}}}]}]}},80130:e=>{e.exports={kind:"Document",definitions:[{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Query"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"localizationSettings"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LocalizationSettings"}}}}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Mutation"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"updateCurrentLocale"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"newLocale"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LocalizationSettings"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"LocalizationSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"currentLocale"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}]}]}},72274:(e,t,n)=>{"use strict";n.d(t,{f:()=>s});var i=n(52122),a=n(24972),o=n(46426);class r extends i.Component{constructor(e){super(e),this.mounted=!1;const{i18n:t,namespace:n,namespaces:i}=e,a=(i||[]).filter((e=>!t.isNamespaceLoaded(e)));!n||t.isNamespaceLoaded(n)||a.includes(n)||a.push(n),this.state={namespacesToLoad:a}}componentDidMount(){const{i18n:e}=this.props;this.mounted=!0;const t=()=>{this.mounted&&this.setState((t=>({namespacesToLoad:t.namespacesToLoad.filter((t=>!e.isNamespaceLoaded(t)))})))};this.state.namespacesToLoad.length&&Promise.all(this.state.namespacesToLoad.map((t=>e.waitForNamespace(t)))).then(t).catch(t)}componentWillUnmount(){this.mounted=!1}render(){const{loaderRenderer:e,children:t}=this.props;return this.state.namespacesToLoad.length?e?e():null:t&&i.createElement(a.dE,null,t)||null}}const s=(0,o.G)(r);s.displayName="GenericNamespaceProvider"},91575:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(84038);const a=e=>{let t;const n=Object.create(e),i=Object.getPrototypeOf(e);for(const e of Object.getOwnPropertyNames(i))"stringTranslate"!==e&&Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e));return Object.defineProperty(n,"stringTranslate",{enumerable:!1,configurable:!0,value:(n,i,a)=>{t||(t=new Map);const r=o(t,i,a);if(r)return r;const s={value:e.stringTranslate(n,i,a),params:a};return t.set(i,s),s.value}}),n},o=(e,t,n)=>{const a=e.get(t),o=null==a?void 0:a.value,r=null==a?void 0:a.params;if(o&&(0,i.V)(n,r))return o}},40320:(e,t,n)=>{"use strict";n.d(t,{tL:()=>u,OO:()=>l,bd:()=>c,Cq:()=>d});var i=n(52122),a=n(70005),o=n(31225);class r{constructor(e){this.i18nextWrapper=e,this._i18n=new o.o(e)}get locale(){return this._i18n.locale}get originLocale(){return this._i18n.originLocale}get userLanguage(){return this._i18n.userLanguage}get isRtl(){return this._i18n.isRtl}setLocale(e){return this._i18n.setLocale(e)}get osDateTimeLocale(){return this._i18n.osDateTimeLocale}get osFirstDayOfWeek(){return this._i18n.osFirstDayOfWeek}get osLocaleInfo(){return this._i18n.osLocaleInfo}get firstDayOfWeek(){return this._i18n.firstDayOfWeek}translate(e,t,n){return this.stringTranslate(e,t,n)}stringTranslate(e,t,n){return this._i18n.stringTranslate(e,t,n)}getTransForNs(e){this.i18nextWrapper.latestTranslation.namespace=e;const t=this.i18nextWrapper.i18next.getFixedT(this.locale,e);return n=>i.createElement(a.cC,Object.assign({},n,{tOptions:(0,o.E)(n.i18nKey||"",n.tOptions),t,ns:e}))}waitForNamespace(e){return this._i18n.waitForNamespace(e)}getNamespaceState(e){return this._i18n.getNamespaceState(e)}isNamespaceLoaded(e){return this._i18n.isNamespaceLoaded(e)}formatDateTime(e,t,n){return this._i18n.formatDateTime(e,t,n)}formatNumber(e,t){return this._i18n.formatNumber(e,t)}formatNumberWithRegionalFormat(e,t){return this._i18n.formatNumberWithRegionalFormat(e,t)}getStringComparer(e){return this._i18n.getStringComparer(e)}sortStrings(e,t){return this._i18n.sortStrings(e,t)}getLocaleTimeSettings(){return this._i18n.getLocaleTimeSettings()}}var s=n(95774);const l=i.createContext({}),d=()=>i.useContext(l),c=({locale:e,i18NextWrapper:t,host:n,children:o})=>{const[d,c]=i.useState(null);return i.useEffect((()=>{let i=!0;return e?t.setLocale(e).then((()=>{var a;if(!i)return;c(new r(t));const o=null===(a=null==n?void 0:n.document)||void 0===a?void 0:a.documentElement;o&&(s.p0.setLangAttribute(o,e),s.p0.setDirAttribute(o,void 0,e))})):c(new r(t)),()=>{i=!1}}),[n,t,e]),d?i.createElement(l.Provider,{value:d},i.createElement(a.a3,{i18n:t.i18next},o)):null},u=(l.Consumer,({host:e,locale:t})=>{var n;const i=null===(n=e.document)||void 0===n?void 0:n.documentElement;return i&&(s.p0.setLangAttribute(i,t),s.p0.setDirAttribute(i,void 0,t)),null})},46426:(e,t,n)=>{"use strict";n.d(t,{G:()=>o});var i=n(52122),a=n(40320);const o=e=>t=>i.createElement(a.OO.Consumer,null,(n=>i.createElement(e,Object.assign({},Object.assign(Object.assign({},t),{i18n:n})))))},62676:(e,t,n)=>{"use strict";n.d(t,{Q:()=>o});var i=n(52122),a=n(84038);const o=(e,t=a.V)=>{const n=(0,i.useRef)(e);return t(n.current,e)||(n.current=e),n.current}},88802:(e,t,n)=>{"use strict";n.d(t,{z:()=>s,d:()=>l});var i=n(68602),a=n(16360),o=n(62990),r=n(60780);const s=(e,t)=>{var n;let s;if(e){const i=a.Jt.getAllOfType("User");if(s=null===(n=null==i?void 0:i.filter((t=>t.id===e)))||void 0===n?void 0:n[0],d(s,t))return s}if(t){const e=a.Jt.getAllOfType("User").filter((e=>e.profile.tid===t&&e.type!==i.Ch.Anonymous));if((null==e?void 0:e.length)>1){const t=a.Jt.getValue(o.Jl.globalUser);if(e.find((e=>e.id===t.id)))return t;throw{message:"Multiple users found in cache with same tenantId",errorCode:r.SM.MultipleUsersPresentWithSpecifiedIdentifier}}s=e[0]}else s=a.Jt.getValue(o.Jl.globalUser);return s},l=e=>{if(!e)return[];return a.Jt.getAllOfType("User").filter((t=>t.id!==e&&t.homeAccountId===e))},d=(e,t)=>{var n;return!e||!t||(null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.tid)===t}},16360:(e,t,n)=>{"use strict";n.d(t,{Jt:()=>u,ky:()=>f});var i=n(13637),a=n(60780),o=n(14209),r=n(12354),s=n(70101),l=n(62990);const d=[a.aw,a.ZU,a.Fz],c={KeyVersion:"v1",UseAccountIdKey:!1};let u;const m=e=>c.UseAccountIdKey?(null==e?void 0:e.id)||"":e?JSON.stringify({tenantId:e.tenantId,oid:e.oid,accountType:e.accountType,userName:e.userName}):JSON.stringify(void 0),g=(e,t,n)=>`tmp.auth.${c.KeyVersion}.${e}.${t}.${n}`,p=e=>{const{typeName:t,user:n}=e;return{user:e.user?m(n):"GLOBAL",typeName:t,key:e.key?e.key.toUpperCase():t}},h=(e,t)=>({storageKey:c.UseAccountIdKey?g(t.user,t.typeName,t.key):`$[${t.user}][${t.typeName}][${t.key}]`,loggingKey:g(e.user?`${e.user.id}`:t.user,t.typeName,t.key)});class v{constructor(e){this._expireOffsetSeconds=a.rF.SECONDS_FIVE_MINUTES,this._expireOffsetSecondsMin=a.rF.SECONDS_PER_MINUTE,this.internalCache={GLOBAL:{User:{},Token:{},MsalAccount:{}}},this._initializeCacheForCacheItem=(e,t)=>{void 0===this.internalCache[t]?(this.internalCache[t]={},this.internalCache[t][e]={}):void 0===this.internalCache[t][e]&&(this.internalCache[t][e]={})},this._addToExternalCache=(e,t)=>(0,i.mG)(this,void 0,void 0,(function*(){const n=p(e),{storageKey:i,loggingKey:a}=h(e,n);try{if(this._storage.setItem(i,(0,r.u4)(t)),"LogoutState"===e.typeName){const{storageKey:i}=((e,t)=>({storageKey:c.UseAccountIdKey?`$[${t.user}][${t.typeName}][${t.key}]`:g(t.user,t.typeName,t.key),loggingKey:g(e.user?`${e.user.id}`:t.user,t.typeName,t.key)}))(e,n);this._storage.setItem(i,(0,r.u4)(t))}}catch(e){o.q.error(`error in putting key [${a}] in storage, error - [${(0,r.VK)(e)}]`)}})),this._deleteFromExternalCache=e=>(0,i.mG)(this,void 0,void 0,(function*(){const t=p(e),{storageKey:n,loggingKey:i}=h(e,t);try{this._storage.removeItem(n)}catch(e){o.q.error(`error in deleting key [${i}] in storage, error - [${(0,r.VK)(e)}]`)}})),this._flushExternalCache=e=>(0,i.mG)(this,void 0,void 0,(function*(){try{const t={};Object.keys(this._storage).forEach((n=>{d.forEach((e=>{if(-1!==n.indexOf(e)){const e=this._storage.getItem(n);e&&(t[n]=e)}})),(!e&&0===n.indexOf("$[")||!e&&0===n.indexOf("tmp.auth")||e&&(-1!==n.indexOf(e.oid)||e.id&&-1!==n.indexOf(e.id)))&&this._storage.removeItem(n)})),Object.keys(t).forEach((e=>{this._storage.setItem(e,t[e])}))}catch(e){o.q.error(`error in clearing storage, error - [${(0,r.VK)(e)}]`)}})),this._isGlobalUser=e=>{var t,n;const i=null===(n=null===(t=this.internalCache.GLOBAL)||void 0===t?void 0:t.User)||void 0===n?void 0:n.User;return i&&(0,s.FG)((0,s.Xx)(i.item),e)},this._putGlobalUserInCache=(e,t)=>{var n,i;if((null===(i=null===(n=this.internalCache.GLOBAL)||void 0===n?void 0:n.User)||void 0===i?void 0:i.User)&&e.user&&!this._isGlobalUser(e.user))return;const a=e.user?"GLOBAL":m((0,s.Xx)(t.item));this._initializeCacheForCacheItem("User",a),this.internalCache[a].User.User=t;const o=c.UseAccountIdKey?g(a,"User","User"):`$[${a}][User][User]`;this._storage.setItem(o,JSON.stringify(t))},this._validateValue=(e,t)=>{var n,i;if(!("Token"!==e.typeName||"object"==typeof t&&t.token&&t.expires))throw new Error("Invalid value for Token.");if(!("Discover"!==e.typeName||e.key!==a.rz||"object"==typeof t&&t.skypeToken&&t.expiration))throw new Error("Invalid value for Skype token.");if("User"!==e.typeName)return;const o=t;if(!(o.userName&&o.type&&o.role&&o.profile&&void 0!==o.isAuthenticated))throw new Error(`Invalid value for user. userName exists: [${!!o.userName}], type: [${o.type}], role: [${o.role}], profile exists: [${!!o.profile}],isAuthenticated: [${o.isAuthenticated}]`);const r=null===(i=null===(n=this.internalCache.GLOBAL)||void 0===n?void 0:n.User)||void 0===i?void 0:i.User,l=(0,s.Xx)(o);if(r&&!e.user&&!this._isGlobalUser(l))throw new Error("there is already global user in auth cache")},this._storage=e.localStorage,o.q.info("auth_cache initialized")}updateSetting(e,t){o.q.log(`Updating authCache setting ${e} from ${c[e]} to ${t}.`),"KeyVersion"===e&&(t!==c.KeyVersion&&(this.internalCache={}),c.KeyVersion=t),"UseAccountIdKey"===e&&(t!==c.UseAccountIdKey&&(this.internalCache={}),c.UseAccountIdKey=t)}setExpiryOffset(e,t){e&&(this._expireOffsetSeconds=e),t&&(this._expireOffsetSecondsMin=t)}put(e,t){var n,i;S(e),this._validateValue(e,t);const{typeName:a,key:o,user:r}=p(e);("Token"===a||"Discover"===a&&"SKYPE-TOKEN"===o)&&(t.fromCache=!0);let s=null===(i=null===(n=this.internalCache[r])||void 0===n?void 0:n[a])||void 0===i?void 0:i[o];return s?(s.hitCount=0,s.item=t):s={item:t,shouldRefresh:!1,hitCount:0},"User"===a&&this._putGlobalUserInCache(e,s),this._initializeCacheForCacheItem(a,r),this.internalCache[r][a][o]=s,this._addToExternalCache(e,s),!0}updateGlobalUser(e){const t="GLOBAL",n={item:e,shouldRefresh:!1,hitCount:0};return this._initializeCacheForCacheItem("User",t),this.internalCache.GLOBAL.User.User=n,this._addToExternalCache(l.Jl.globalUser,n),!0}get(e){var t,n,i;S(e);const a=p(e),{storageKey:s,loggingKey:l}=h(e,a),{typeName:d,key:c,user:u}=a;let m=null===(n=null===(t=this.internalCache[u])||void 0===t?void 0:t[d])||void 0===n?void 0:n[c];const g=!!m;if(!m)try{const e=null===(i=this._storage)||void 0===i?void 0:i.getItem(s);e&&(m=JSON.parse(e))}catch(e){o.q.error(`value for key [${l}] throw error. ${(0,r.VK)(e)}`)}if(m)return this._initializeCacheForCacheItem(d,u),this.internalCache[u][d][c]=m,("Token"===d||"Discover"===d&&"SKYPE-TOKEN"===c)&&(m.shouldRefresh=this._shouldRefresh(m.item,d),m.hitCount++,this.internalCache[u][d][c]=m,this._addToExternalCache(e,m)),void 0===m.shouldRefresh?(o.q.info(`cacheItem '[${s}]' need to refresh`),void this.del(e)):(o.q.info(`returning cacheItem '[${s}]' from cache. In memory:${+g} found: [${+!!m}]`),m);o.q.info(`value for key [${l}] not found in memory or storgae`)}getValue(e){const t=this.get(e);return t?this._value(t):void 0}getAllOfType(e){const t=[],n=[];return Object.keys(this.internalCache).forEach((i=>{"GLOBAL"!==i&&Object.keys(this.internalCache[i][e]||{}).forEach((a=>{const{storageKey:o}=h({},{user:i,typeName:e,key:a});n.push(o),t.push(this.internalCache[i][e][a].item)}))})),Object.keys(this._storage).forEach((i=>{var a;if(-1===n.indexOf(i)&&-1===i.indexOf(".GLOBAL.")&&-1===i.indexOf("[GLOBAL]")&&(-1!==i.indexOf(`[${e}]`)||-1!==i.indexOf(`.${e}.`)))try{const e=this._storage.getItem(i);e&&t.push(null===(a=JSON.parse(e))||void 0===a?void 0:a.item)}catch(e){o.q.error(`value for key [${i}] throw error. ${(0,r.VK)(e)}`)}})),t}del(e){var t,n,i,a;if(!e)return o.q.error(`Invalid cacheKey: ${e}`),!1;if(!e.typeName)return o.q.error(`Invalid cacheKey type: ${e.typeName}`),!1;if("User"===e.typeName)return this.flush(e.user),!0;const r=p(e),{loggingKey:s}=h(e,r),{typeName:l,key:d,user:c}=r;(null===(n=null===(t=this.internalCache[c])||void 0===t?void 0:t[l])||void 0===n?void 0:n[d])&&o.q.info(`Value of key: [${s}] exists before deletion]`);const u=(null===(a=null===(i=this.internalCache[c])||void 0===i?void 0:i[l])||void 0===a?void 0:a[d])&&delete this.internalCache[c][l][d],m=this._deleteFromExternalCache(e);return o.q.info(`deleted from local auth-cache. key: [${s}], done - local: [${u}], storage: [${m}]`),u}delTokensWithError(e,t){var n,i,a,o;const{user:r,typeName:s}=p({user:e,typeName:"Token"});if(null===(n=this.internalCache[r])||void 0===n?void 0:n[s]){const n=this.internalCache[r][s];for(const r in n)(null===(o=null===(a=null===(i=n[r])||void 0===i?void 0:i.item)||void 0===a?void 0:a.error)||void 0===o?void 0:o.errorCode)===t&&this.del({user:e,typeName:s,key:r})}}deleteType(e,t){var n;const{user:i,typeName:a}=p({user:e,typeName:t});if(null===(n=this.internalCache[i])||void 0===n?void 0:n[a]){let t;if("Token"===a)t=this.internalCache[i][a];else{if("Discover"!==a)return;t=this.internalCache[i][a]}for(const n in t)n&&this.del({user:e,typeName:a,key:n})}}flush(e){var t,n;if(!e){o.q.info("no user provided, flushing global user from cache");const i=null===(n=null===(t=this.internalCache.GLOBAL)||void 0===t?void 0:t.User)||void 0===n?void 0:n.User;if(!i)return;e=(0,s.Xx)(i.item)}o.q.info("flushing user data from cache");const i=m(e);this.internalCache[i]={},this._flushExternalCache(e),this._isGlobalUser(e)&&(this.internalCache.GLOBAL={},this._storage.removeItem("$[GLOBAL][User][User]"),this._storage.removeItem("tmp.auth.v1.GLOBAL.User.User")),o.q.info("flushing completed")}_value(e){return e.item}_shouldRefresh(e,t){var n,i;const o="Token"===t?null===(n=e)||void 0===n?void 0:n.expires:null===(i=e)||void 0===i?void 0:i.expiration,r=Math.round(Date.now()/a.rF.MILLI_PER_SECOND);let s;if(s="Discover"===t?Math.round(o/a.rF.MILLI_PER_SECOND):"Token"===t?o:void 0,e&&s){const e=s-this._expireOffsetSeconds;if(r<=s-this._expireOffsetSecondsMin)return r>=e}}}const S=e=>{if(!(-1===["Token","Discover"].indexOf(e.typeName)||e.key&&e.user))throw new Error(`key/user cannot be empty for type [${e.typeName}]: key: ${e.key}, user: ${+!!e.user}`)},f=e=>{var t;u||(u=new v(e),(null===(t=e.localStorage)||void 0===t?void 0:t.getItem("localDebug"))&&e.loader&&(e.loader.authCache=u))}},62990:(e,t,n)=>{"use strict";n.d(t,{VF:()=>a,px:()=>o,Jl:()=>r});var i=n(60780);const a=e=>({userDetail:{user:e,typeName:"Discover",key:"discover-user-details"},regionGtm:{user:e,typeName:"Discover",key:"discover-region-gtm"},skypeToken:{user:e,typeName:"Discover",key:"skype-token"},user:{user:e,typeName:"User"},tenants:{user:e,typeName:"Tenants"},loginValidation:{user:e,typeName:"LoginValidation"},userAuthState:{user:e,typeName:"UserAuthState"}}),o=(e,t,n)=>({user:e,typeName:"Token",key:`${t}${n?`-external-${n}`:""}`}),r={logoutState:{typeName:i.ZU},authSessionId:{typeName:i.Fz},globalUser:{typeName:"User"},primaryUserId:{typeName:"PrimaryUserId"}}},70101:(e,t,n)=>{"use strict";n.d(t,{b6:()=>S,iZ:()=>f,B$:()=>y,QG:()=>k,nL:()=>C,Ig:()=>b,Xx:()=>w,qv:()=>_,nW:()=>A,aS:()=>N,Kv:()=>E,FG:()=>D,fM:()=>F,W1:()=>P,jV:()=>M,PU:()=>j,dW:()=>R,au:()=>x,S1:()=>O,ZW:()=>L,NL:()=>U,WD:()=>B,_Z:()=>W,ps:()=>G,Cq:()=>V,Fr:()=>H,N3:()=>$});var i,a=n(13637),o=n(34255),r=n(68602),s=n(41731),l=n(82250),d=n(14209),c=n(60780),u=n(16360),m=n(6554),g=n(12354),p=n(62990),h=n(90649),v=n(88802);!function(e){e.Otp="mail",e.GFed="google.com"}(i||(i={}));const S=e=>(d.q.info(`[returnTokenForAnonUser][${e}] empty token return for anonymous user`),{token:"",expires:Math.floor((new Date).setMinutes(c.uI.FIFTEEN)/c.rF.MILLI_PER_SECOND),fromCache:!0}),f=e=>e.tenantId&&e.isAnonEligible&&e.isAnonRestrictionSatisfied,y=(e,t,n,i)=>{var a;const o=(null==t?void 0:t.profile.tid)||n||e.tenantId;if(o&&(t||i||e.isAnonEligible&&e.isAnonRestrictionSatisfied)){d.q.info("Anon flow - anonymous user created");const n=e.tenantId===c.zP;return{id:I,isAuthenticated:!0,userName:(null==t?void 0:t.userName)||"anonymous",profile:{oid:_(o),tid:o,upn:(null===(a=null==t?void 0:t.profile)||void 0===a?void 0:a.upn)||"",puid:""},role:r.w4.Anonymous,type:r.Ch.Anonymous,cloud:(null==t?void 0:t.cloud)||(n?r.G7.life:r.G7.prod),subType:r.Yf.Default}}},k=e=>e===s.e0?r.Ch.MsaLife:r.Ch.Aad,C=e=>k(e.profile.tenantId)===r.Ch.MsaLife?r.G7.life:r.G7.prod,b=(e,t,n,a)=>{var l,u,m,g,p,h;if(!t||(0,o.isEmpty)(t.profile)||t.role===r.w4.Anonymous||t.userRole===c.uI.TWO||!t.isAuthenticated&&e.isAnonEligible||!t.isAuthenticated&&a)return d.q.info("checking anon flow"),y(e,t,n,a);t.role=1===(null===(l=t.profile)||void 0===l?void 0:l.acct)?r.w4.Guest:r.w4.Member;let v=0===(null===(m=null===(u=t.profile)||void 0===u?void 0:u.altsecid)||void 0===m?void 0:m.indexOf("1:"))?r.Ch.Msa:r.Ch.Aad;return(null===(g=t.profile)||void 0===g?void 0:g.idp)&&(null===(p=t.profile)||void 0===p?void 0:p.iss)!==t.profile.idp?(v=t.profile.idp===i.Otp?r.Ch.Otp:v,v=t.profile.idp===i.GFed?r.Ch.GFed:v):(null===(h=t.profile)||void 0===h?void 0:h.tid)===s.e0&&(v=r.Ch.MsaLife),T(t,v)},T=(e,t)=>(e.type=t,e.profile.oid=e.profile.oid||_(e.profile.tid),e.cloud||(e.cloud=e.type===r.Ch.MsaLife?r.G7.life:r.G7.prod),!e.profile.hasOwnProperty("upn")&&e.hasOwnProperty("userName")&&(e.profile.upn=e.userName||""),e.subType||(e.subType=r.Yf.Default),d.q.info(`User role = [${e.role}], type = [${t}]`),e),w=e=>{if(!e)throw new Error("getUserIdentifier: User cannot be null");return{tenantId:e.profile.tid,oid:e.profile.oid,accountType:e.type,userName:e.userName,id:e.id}},_=e=>`8:defaultOid:${e}`,I="anonAccountId",A=e=>{const t=[];for(const n in e)Object.hasOwnProperty.call(e,n)&&t.push({name:n,key:n,value:e[n]});return t},N=(e,t)=>{var n;t.addEventData(["update-global-user:t"]),t.addScenarioMark("auth_update_global_user_start");const i=(0,v.z)(e,void 0);if(i)return t.addScenarioMark("auth_update_global_user_foundUser"),u.Jt.updateGlobalUser(i);throw t.addScenarioMark("auth_update_global_user_noUserFound"),a=null===(n=t.correlation)||void 0===n?void 0:n.id,(0,m.Tr)({context:"core-auth-base",subContext:"getUserFromAccountId",correlationId:a,errorCode:c.SM.UserNotFoundError,message:"Cannot update global user ude to missing user"});var a},E=e=>e?(null==e?void 0:e.id)?null==e?void 0:e.id:`${null==e?void 0:e.oid}-${null==e?void 0:e.tenantId}`:"unknown user",D=(e,t)=>!!e&&!!t&&((e.id||t.id)&&e.id===t.id||e.tenantId===t.tenantId&&e.oid===t.oid&&e.userName===t.userName),F=(e,t,n)=>{var i;const a=new CustomEvent(t,{detail:n});null===(i=null==e?void 0:e.dispatchEvent)||void 0===i||i.call(e,a)},P=()=>!!u.Jt.get(p.Jl.globalUser),M=(e,t,n,i,a)=>{const o=b(e,t,i,a);return o&&(d.q.info(`[auth-helper][getMappedUserAndSetItToCache][${n}] put user in cache.`),u.Jt.put((0,p.VF)(w(o)).user,o)),o},j=(e,t,n,i)=>{if(c.s9(e))throw i.addEventData(["scope_invalid:1"]),d.q.warn(`[core-auth-base][acquireToken][${n.source}][${n.id}] invalid scope. resource: [${e}]`),(0,m.Tr)({context:"core-auth-base",subContext:"acquireToken",message:`request with [${null==t?void 0:t.id}-${null==t?void 0:t.oid}-${null==t?void 0:t.tenantId}] sent from invalid resource: ${e}`,errorCode:c.SM.InvalidScopeResource,isExpected:!0,correlationId:n.id})},R=(e,t,n,i,a)=>(i.push("user_missing"),(0,m.Tr)({context:"core-auth-base",subContext:e,errorCode:c.SM.UserNotFoundError,isExpected:n,message:`request sent with [${t}] failed as user not found`,innerError:new Error("User Null or empty"),correlationId:a})),x=(e,t,n,i)=>(0,m.Tr)({context:"core-auth-base",subContext:e,errorCode:c.SM.UnsupportedParameter,isExpected:n,message:`${t} parameter is not currently supported`,innerError:new Error(`${t} parameter is not currently supported`),correlationId:i});const O=(e,t,n,i,a,o)=>{var r,s;null==i||i.push(`errorCode:${(null==t?void 0:t.errorCode)||"undefined"},errorMessage:${(null==t?void 0:t.message)||"undefined"}`),i&&i.length>0&&i.push("$");const l=function(e,t,n="",i,a){return{contentType:n,context:"core-auth-base",correlationId:null==t?void 0:t.correlationId,endpointUrl:a||"unset",errorCode:(null==t?void 0:t.errorCode)||"AcquireToken Error",innerError:t,isExpected:null==t?void 0:t.isExpected,message:(0,g.VK)(t),reason:(null==i?void 0:i.join(";"))||"",subContext:e}}(e,t,a,i,o),u=l.errorCode.includes(c.SM.InvalidScopeResource)||(null===(r=l.message)||void 0===r?void 0:r.includes(c.SM.InvalidScopeResource))||l.isExpected||(null===(s=l.innerError)||void 0===s?void 0:s.isExpected);return u?d.q.warning(`Error found ${(0,g.VK)(t)}`):d.q.error(`Error found ${(0,g.VK)(t)}`),u?null==n||n.incomplete(l):null==n||n.fail(l),l},L={access_token:{xms_cc:{values:["CP1"]}}},U=JSON.stringify(L),B=e=>!(!e||e===U),W=(e,t,n,i)=>{var a,o;return t.tflClaim&&(t.accessTokenToRenew=t.tflClaim),void 0===t.prompt&&void 0===t.silent&&(!t.accessTokenToRenew&&!B(t.claim)||(null==n?void 0:n("disablePromptFor401"))?(t.prompt="none",t.silent=!0):(t.prompt="login",t.silent=!1)),e.addEventData(["cacheToken:"+ +!!i,"forceRenew:"+ +!!t.forceRenew,"tflClaim:"+ +!!t.tflClaim,"accessTokenToRenew:"+ +!!t.accessTokenToRenew,"claim:"+ +B(t.claim),`prompt: ${t.prompt}`,"silent:"+ +!!t.silent,`errorInToken:[${(null===(o=null===(a=null==i?void 0:i.item)||void 0===a?void 0:a.error)||void 0===o?void 0:o.errorCode)||""}]`]),i?(t.forceRenew&&(d.q.info("[core-auth-base][acquireToken] force renewing."),t.accessTokenToRenew=i.item.token),t):t},G=(e,t,n,i)=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=null==i?void 0:i("buildCloud");if(d.q.log(`starting cloud misMatch check. Env: ${n}, buildCloud: ${a}, user tid: ${e.profile.tid}, user cloud: ${e.cloud}`),!e.cloud||!a||e.cloud===a)return!0;throw u.Jt.del({user:w(e),typeName:"User"}),t.closeScenario({reason:`_checkForCloudMismatchAndReboot. Env: ${n}, buildCloud: ${a}, user tid: ${e.profile.tid}, user cloud: ${e.cloud}`}),new Error("cloud mis-match... reboot required")})),V=e=>{if(!(null==e?void 0:e("enableAuthCacheSchemaV1")))return!1;const t=null==e?void 0:e("authCacheSchemaVersion");t&&u.Jt.updateSetting("KeyVersion",t),d.q.log("[CoreAuth][_migrateAuthCache] Starting migration.");const n={id:(0,g.pW)(),scenarioName:l.RG.AuthWebMigrateCache,source:"core-auth::migrateAuthCache"},i=h.cv.create({correlation:n,subContext:"migrateAuthCache"}),a=u.Jt.getValue({typeName:"User"});if(!a)return d.q.log("[CoreAuth][_migrateAuthCache] Aborting migration. No existing user found"),i.closeScenario({reason:"no user found"},"abandoned"),u.Jt.updateSetting("UseAccountIdKey",!0),!0;if(!a.id)return d.q.log("[CoreAuth][_migrateAuthCache] Aborting migration. Existing user does not have id. Will try again next launch"),i.closeScenario({reason:"user has no id"},"incomplete"),u.Jt.updateSetting("UseAccountIdKey",!1),!1;u.Jt.updateSetting("UseAccountIdKey",!0);const o=u.Jt.getValue({typeName:"User"});return o?(d.q.log(`[CoreAuth][_migrateAuthCache] Aborting migration. Existing user found with new schema. Id: ${o.id}`),i.closeScenario({reason:"migration already complete"},"abandoned"),!1):(u.Jt.put((0,p.VF)(w(a)).user,a),d.q.log(`[CoreAuth][_migrateAuthCache] Successful migration for account ${a.id}.`),i.closeScenario({reason:"migration completed successfully"},"success"),!0)},H=(e,t,n)=>(0,a.mG)(void 0,void 0,void 0,(function*(){return new Promise((i=>(0,a.mG)(void 0,void 0,void 0,(function*(){if(e.length<=0)return i({count:0,failure:[]});let a=0;const o=[];for(const r of e){a++;try{const n=t(r);yield n,a>=e.length&&i({count:a,failure:o})}catch(t){o.push(a),null==n||n(t,a,r),a>=e.length&&i({count:a,failure:o})}}}))))})),$=(e,t,n,i)=>{B(n)&&e.addEventData([`isSameToken: ${i===t.token}`]);const a=(e=>{const t=(e-Math.floor((new Date).getTime()/c.rF.MILLI_PER_SECOND))*c.rF.MILLI_PER_SECOND/c.rF.ONE_HOUR;return Math.floor(t)})(t.expires);e.addEventData([`tokenLifeTime: ${a}`,`fromCache: ${t.fromCache}`])}},89251:(e,t,n)=>{"use strict";function i(e){const t={};return(n,...i)=>{try{let a=t[n];return a||(a=t[n]=e(...i).then((e=>(delete t[n],e))).catch((e=>{throw delete t[n],e}))),a}catch(e){throw e}}}n.d(t,{k:()=>i})},63660:(e,t,n)=>{"use strict";n.d(t,{g:()=>g});var i=n(68602),a=n(6554),o=n(12354),r=n(70101),s=n(60780),l=n(14209),d=n(66284);let c,u,m;function g(e,t,n,i){if(Object.getOwnPropertyDescriptor(Window,"mockApi")||Object.defineProperty(Window,"mockApi",{value:{enable:()=>{m=!0},disable:()=>{m=!1},setConfig:p}}),function(e,t){c||(c={});c[t]=e}(e,t),m=i,m){try{u="string"==typeof n?Object.assign(Object.assign({},u),JSON.parse(decodeURIComponent(n))):Object.assign(Object.assign({},u),n)}catch(e){l.q.warning(`[MOCK-API] cannot parse config: ${n}`)}h(e,t)}else u={}}function p(e,t={}){u||(u={}),u[e]=t;const n=e.split(".")[0];h(null==c?void 0:c[n],n)}function h(e,t){Object.getOwnPropertyNames(u).filter((e=>e.startsWith(`${t}.`))).map((e=>e.replace(`${t}.`,""))).forEach((n=>{var i,r;const s=(null===(i=Object.getOwnPropertyDescriptor(e,n))||void 0===i?void 0:i.value)||(null===(r=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),n))||void 0===r?void 0:r.value);Object.defineProperty(e,n,{configurable:!0,value:(...i)=>m?(l.q.warning(`[MOCK-API] returning mocked response for ${t}.${n}`),function(e,t){var n;const i=null==u?void 0:u[`${e}.${t}`];if(i&&i.error)throw function(e,t,n){return(0,a.Tr)({context:(null==e?void 0:e.context)||t,subContext:(null==e?void 0:e.subContext)||n,reason:null==e?void 0:e.reason,errorCode:(null==e?void 0:e.errorCode)||"ErrorCodeNotFound",correlationId:(null==e?void 0:e.correlationId)||(0,o.pW)(),isExpected:(null==e?void 0:e.isExpected)||!1,message:(null==e?void 0:e.message)||`[MockApi][${t}][${n}]`})}(i.error,e,t);if(i&&i.success){const e=function(e){switch(e){case"aquireToken":return S;case"user":return v();case"hostMachineUsers":return[f];case"users":return[v()];case"emptyList":return[]}return{}}(i.success.defaultValue);return Array.isArray(e)?i.success.returnValue?Array.isArray(i.success.returnValue)?[...e,...i.success.returnValue]:[...e,i.success.returnValue]:e:Object.assign(Object.assign({},e),null===(n=i.success)||void 0===n?void 0:n.returnValue)}return}(t,n)||s.apply(e,i)):s.apply(e,i)})}))}const v=()=>(0,r.Ig)(new d.N("https://test.msft.com"),{userName:"TestUserName@email.com",role:i.w4.Member,profile:{name:"Test",oid:(0,r.qv)("123456789"),tid:"123456789"}}),S={token:"TestToken",expires:Date.now()+s.rF.SECONDS_FIVE_MINUTES,fromCache:!1},f={accountType:"Aad",id:"TestHostMachineUserId",displayName:"Test User",emailPhone:"test@email.com",picture:""}},66284:(e,t,n)=>{"use strict";n.d(t,{N:()=>o,j:()=>d});var i=n(60780),a=n(14209);class o{constructor(e){this._hash="",this._search="",this._pathname="",this._isAnonEligible=!1,this._isAnonRestrictionSatisfied=!1,this._tid=void 0,this._queryStrings={},this._parse=e=>{let t=Object.create(null);return"string"!=typeof e?t:(e=e.trim().replace(/^[?#&]/,""))?(e.split("&").forEach((e=>{const n=e.replace(/\+/g," ").split("=");let i=n.shift();const o=n.length>0?decodeURIComponent(n.join("=")):null;if(i){if(i=decodeURIComponent(i),"context"===i&&0===(null==o?void 0:o.indexOf("{")))try{const e=JSON.parse(o);for(const t in e)!e.hasOwnProperty(t)||"tid"!==t.toLowerCase()&&"tenantid"!==t.toLowerCase()||(this._tid=e[t]);t=Object.assign(Object.assign({},t),e)}catch(e){a.q.error(e)}if(Object.prototype.hasOwnProperty.call(t,i))Array.isArray(t[i])?t[i].push(o):t[i]=[t[i],o];else{t[i]=o;const e=i.toLowerCase();!o||"tid"!==e&&"tenantid"!==e||(this._tid=o)}}})),t):t};try{this._currenttUrl=Object.freeze(new URL(e))}catch(t){throw new Error(`[TeamsUrl::ctor] - error - ${t} url ${e}`)}if(this._currenttUrl.hash&&-1!==this._currenttUrl.hash.indexOf("#/")){const e=this._currenttUrl.href.substring(this._currenttUrl.origin.length),t=e.indexOf("#");t>=0&&(this._hash=e.substr(t),this._pathname=e.substr(0,t));const n=this._hash.indexOf("?");n>=0&&(this._search=this._hash.substr(n))}this._queryStrings=this._parse(this._search||this._currenttUrl.search);const t=r(this._currenttUrl);this._isAnonEligible=t[0],this._isAnonRestrictionSatisfied=t[1]}get href(){return this._currenttUrl.href}get isLocal(){return 0===this._currenttUrl.host.indexOf("local.teams.office.com")}get hash(){return this._hash||this._currenttUrl.hash}get pathname(){return this._pathname||this._currenttUrl.pathname}get search(){return this._search||this._currenttUrl.search}get origin(){return this._currenttUrl.origin}get searchParams(){return{get:e=>this._queryStrings[e]}}get queryStrings(){return this._queryStrings}get tenantId(){return 0===this._currenttUrl.host.indexOf("teams.live.")?i.zP:this._tid}get isAnonEligible(){return this._isAnonEligible}get isAnonRestrictionSatisfied(){return this._isAnonRestrictionSatisfied}get alternateUrl(){const e=new URL(this._currenttUrl.href);return this.isLocal?(e.port?e.port="":e.port="8080",e.href):(0===e.host.indexOf("teams.live.")?e.host="teams.microsoft.com":e.host="teams.live.com",e.href)}}const r=e=>{if(!l)return[!1,!1];for(const t of l)if(t.anonUrlMatch&&e.href.indexOf(t.anonUrlMatch)>-1)return[!0,s(t,e.href)];return[!1,!1]},s=(e,t)=>{if(!e.restrictions||0===e.restrictions.length)return!0;for(const n of e.restrictions)if(t.indexOf(n)>-1)return!0;return!1};let l=[];const d=e=>{e&&(l=e)}},68602:(e,t,n)=>{"use strict";var i,a,o,r,s,l,d;n.d(t,{Ch:()=>i,w4:()=>a,Yf:()=>o,jh:()=>r,G7:()=>s,JE:()=>d}),function(e){e.Anonymous="Anonymous",e.Aad="Aad",e.Msa="Msa",e.MsaLife="MsaLife",e.GFed="GFed",e.Otp="Otp"}(i||(i={})),function(e){e.Member="Member",e.Anonymous="Anonymous",e.Guest="Guest"}(a||(a={})),function(e){e.Default="Default",e.Mto="Mto"}(o||(o={})),function(e){e[e.Member=0]="Member",e[e.Guest=1]="Guest",e[e.Anonymous=2]="Anonymous",e[e.CrossCloudMeeting=3]="CrossCloudMeeting"}(r||(r={})),function(e){e.prod="prod",e.life="life",e.dod="dod",e.gcch="gcch"}(s||(s={})),function(e){e.prod="WW",e.dod="DOD",e.gcch="GCCHigh",e.gcc="GCC",e.unknown="UNKNOWN",e.gallatin="Gallatin"}(l||(l={})),function(e){e.Up="Up",e.InteractionRequired="InteractionRequired",e.AADReconnecting="AADReconnecting",e.SkypeReconnecting="SkypeReconnecting",e.LicenseError="LicenseError",e.SignInRestriction="SignInRestriction",e.UnRedeemed="UnRedeemed",e.LoginError="LoginError"}(d||(d={}))},41731:(e,t,n)=>{"use strict";var i,a,o,r;n.d(t,{in:()=>a,s_:()=>o,O_:()=>r,e0:()=>s}),function(e){e.POP="pop",e.BEARER="Bearer"}(i||(i={})),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(a||(a={})),function(e){e.ag08="ag08",e.ag09="ag09",e.dod="dod",e.gcc="gcc",e.gcchigh="gcchigh",e.life="life",e.prod="prod"}(o||(o={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT="https://api.spaces.skype.com",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.UNIFIED_CONSENT_WEB_AUTH_URL="https://consentservice.microsoft.com/web/UnifiedUserConsent.ReadWrite",e.UNIFIED_CONSENT_CHECKIN_AUTH_URL="https://consentservice.microsoft.com/checkin/UnifiedUserConsent.Read"}(r||(r={}));const s="9188040d-6c67-4c5b-b112-36a304b66dad"},54405:(e,t,n)=>{"use strict";n.d(t,{Y:()=>a});let i=[];function a(e){i.push(e)}},63931:(e,t,n)=>{"use strict";n.d(t,{G:()=>r,X:()=>l});var i=n(78808),a=n(57078),o=n(89925);const r=(e,t)=>{let n,i=!1;for(let a=e.length-1;a>0;a--){const r=e[a],d=a>=1?e[a-1]:null;if(r.id===r.parentMessageId||(null==d?void 0:d.id)===r.parentMessageId)break;const c=r.isDeletedByAdmin||(null==d?void 0:d.isDeletedByAdmin),u=r.isDataSpillageHardDeleted||(null==d?void 0:d.isDataSpillageHardDeleted);if(c||u)continue;let m=!1;s(r,d)&&d&&(m=l(r,d)),m?n=o.MessageAttachedType.bottom:i&&(n=o.MessageAttachedType.top),t[a]=Object.assign(Object.assign({},t[a]),{attached:n}),i=m}return t},s=(e,t)=>{if(!t||t.isDeleted)return!1;if(e.creator!==t.creator)return!1;return!(e.creator&&e.isBotMessage&&e.onBehalfOf!==(null==t?void 0:t.onBehalfOf))},l=(e,t)=>{if(e.messageType&&d(e.messageType)||t.messageType&&d(t.messageType))return!1;const n=t.originalArrivalTime&&new Date(t.originalArrivalTime),i=e.originalArrivalTime&&new Date(e.originalArrivalTime);return!(!i||!n)&&i.getTime()-n.getTime()<=5*a.A_},d=e=>!!e&&(/^(Event|Control|ThreadActivity)/.test(e)||e===i.Cs.CallRecording)},62975:(e,t,n)=>{"use strict";var i;n.d(t,{k:()=>i}),function(e){e.auth="auth",e.appService="appService",e.appState="appState",e.control="control",e.database="database",e.diagnostics="diagnostics",e.endpointHealth="endpointHealth",e.graphql="graphql",e.networkState="networkState",e.supportedResolvers="supportedResolvers",e.syncEngine="syncEngine",e.tenantSwitch="tenantSwitch",e.telemetry="telemetry"}(i||(i={}))},33769:(e,t,n)=>{"use strict";n.d(t,{Q:()=>HP});var i,a,o,r,s,l,d,c=n(13637),u=n(88783),m=n(97905),g=n(49206),p=n(88262),h=n(70918),v=n(70838),S=n(40903),f=n(85560),y=n(27018);!function(e){e.toastFromWeb="toastFromWeb",e.toastFromHost="toastFromHost"}(i||(i={})),function(e){e.calls="calls",e.chats="chats",e.toasts="toasts",e.signout="signout",e.extensions="extensions",e.reminders="reminders",e.channels="channels",e.activity="activity",e.campaignnotifications="campaignnotifications",e.communities="communities"}(a||(a={})),function(e){e.hide="hide",e.show="show"}(o||(o={})),function(e){e.mutate="mutate",e.view="view",e.list="list"}(r||(r={})),function(e){e.success="success",e.critical="critical"}(s||(s={})),function(e){e.start="start",e.quit="quit",e.restart="restart"}(l||(l={})),function(e){e.DiagnosticsLogsMain="diagnostics-event-logs-main",e.DiagnosticsLogsWorker="diagnostics-event-logs-worker"}(d||(d={}));const k="core_life_cycle_start_",C="core_task_end_",b="core_init_complete";var T;!function(e){e.activity="activity",e.alarm="alarm",e.alert="alert",e.attention="attention",e.busy="busy",e.error="error"}(T||(T={}));var w,_=n(75068),I=n(6866),A=n(31821),N=n(7042),E=n(6766),D=n(3847);!function(e){e.DIAGNOSTICSSERVICE="DiagnosticsService"}(w||(w={}));const F=e=>{let t;const n=[];return{newScenario:i=>{if(t)return t.newScenario(i);if(e&&n.length<20){const e=j(i,n);return n.push(e),e}},setScenarioFactory:e=>{t=e,P(n,t)}}},P=(e,t)=>{if(e.length>0)for(let n=e.length-1;n>=0;n--)M(e[n],t)&&e.splice(n,1)},M=(e,t,n)=>{var i;if(e.status){const i=t.newScenario(e.name,{startTime:e.time});if("failed"===e.status&&i.fail(Object.assign({cached:!0,overrideTimestamp:e.endtime},e.result)),"stopped"===e.status&&i.stop(Object.assign({cached:!0,overrideTimestamp:e.endtime},e.result)),n){const t=n.indexOf(e);t>=0&&n.splice(t,1)}return!0}return null===(i=e.setFactory)||void 0===i||i.call(e,t),!1},j=(e,t)=>{let n,i,a,o;const r={name:e,time:Date.now(),fail:e=>{i="failed",a=Date.now(),n=e,o&&M(r,o,t)},stop:e=>{i="stopped",a=Date.now(),n=e,o&&M(r,o,t)},get result(){return n},get status(){return i},get endtime(){return a},setFactory:e=>o=e};return r};var R=n(51581);const x="=====",O=e=>{if(!e||0===e.length)return"";let t="";return e.forEach((e=>{var n,i,a;if(e)if((null===(n=e.message)||void 0===n?void 0:n.startsWith(x))&&(null===(i=e.message)||void 0===i?void 0:i.endsWith(x)))t+=`\n${e.message}\r\n`;else{const n="function"==typeof(null===(a=e.timeStamp)||void 0===a?void 0:a.toISOString)?e.timeStamp.toISOString():e.timeStamp,i="string"==typeof e.levelName?e.levelName.substring(0,3):"unknownLevelName";t+=`${n} ${i}\t${e.message}\r\n`}})),(0,R.LQ)(t)},L=(e,t,n,i)=>{if(!e)return;const a=JSON.stringify(void 0===i?t:{sessionId:i,logsArray:t});e.setItem(n,a)},U=(e,t,n,i)=>{if(!t)return;const a=t.getItem(n);if(a){const t=JSON.parse(a);if(Array.isArray(t)&&t.length>0){const n=t.map((e=>B(e))).sort(((e,t)=>e.timeStamp.getTime()-t.timeStamp.getTime()));e.addEvents(n)}}i&&t.removeItem(n)};function B(e){const t={message:`DiagnosticsService - Converting event from localStorage failed - ${e}`,isPiiFree:!0,level:D.i.Error,levelName:"error",timeStamp:new Date};try{const n=e;if("timeStamp"in n){if("string"==typeof n.timeStamp){if(isNaN(Date.parse(n.timeStamp)))return t;n.timeStamp=new Date(n.timeStamp)}return n}}catch(e){}return t}const W=e=>(null==e?void 0:e.length)?e.filter((e=>e.isPiiFree)):e,G=(e,t,n)=>{let i="";try{const a=V(e,t,!1);a&&a.logsArray.length>0&&(n&&(a.logsArray=W(a.logsArray)),i=O(a.logsArray))}catch(e){i="Previous session logs parsing failed"}return i},V=(e,t,n)=>{const i=null==e?void 0:e.getItem(t);if(i)try{const a=JSON.parse(i);if(a)return n&&e.removeItem(t),"logsArray"in a?{sessionId:a.sessionId,logsArray:a.logsArray.map((e=>B(e)))}:{sessionId:"",logsArray:a}}catch(e){}},H=(e,t=!1)=>`${t?"tmp.previousSessionErrorLogs":"tmp.previousSessionLogs"}${e?`-${e}`:""}`,$=(e,t=!1)=>`${t?"persistedErrorDiagnostics":"persistedDiagnostics"}${e?`-${e}`:""}`,z=(e,t,n,i)=>{const a=e.getBufferedEvents();if(a&&a.length>0){const o={message:`DiagnosticsService: The following logs were persisted from a previous session ${i}`,isPiiFree:!0,level:D.i.Info,levelName:"info",timeStamp:new Date};((e,t,n)=>{e&&e.setItem(t,(0,R.u4)(n))})(t,n,[{message:`DiagnosticsService: The above logs were persisted from a previous session ${i}`,isPiiFree:!0,level:D.i.Info,levelName:"info",timeStamp:a[0].timeStamp},...a,o]),e.addEvent({message:`DiagnosticsService: Persisting diagnostic events for next load. Key: ${n}`,isPiiFree:!0,level:D.i.Warn,levelName:"warn",timeStamp:new Date})}};class q{constructor(){this.eventsBufferArray=[],this.isForErrorLogs=!1}addEvents(e){e&&e.length>0&&e.forEach((e=>{this.addEvent(e)}))}getBufferedEvents(){return this.eventsBufferArray}fetchPersistedLogsFromLastSession(){var e;if(null===(e=this.host)||void 0===e?void 0:e.localStorage){const e=$(this.userId,this.isForErrorLogs);try{U(this,this.host.localStorage,e,!0)}catch(t){this.host.localStorage.removeItem(e);const n=`DiagnosticsService: Failed to load persisted logs from store with error: ${t}`;this.addEvent({message:n,isPiiFree:!0,level:D.i.Error,levelName:"error",timeStamp:new Date})}}}}class J extends q{constructor(e=!1,t,n){super(),this.isForErrorLogs=e,this.host=t,this.maxCapacity=n,this.queueCapacity=this.maxCapacity||J.DEFAULT_QUEUE_CAPACITY}setCapacity(e){const t=e.bufferSize||0;t<1||this.queueCapacity===t||(this.queueCapacity=t,this.eventsBufferArray.length>t&&(this.eventsBufferArray=this.eventsBufferArray.slice(this.eventsBufferArray.length-t)))}addEvent(e){this.eventsBufferArray.length<this.queueCapacity||this.eventsBufferArray.shift(),this.eventsBufferArray.push(e)}getAllEvents(e){return 0===e?Promise.resolve([]):e&&e<=this.eventsBufferArray.length?Promise.resolve(this.eventsBufferArray.slice(this.eventsBufferArray.length-e)):Promise.resolve(this.eventsBufferArray)}setScenarioFactory(e){}handleUserLogout(){var e;const t=$(this.userId);return null===(e=this.host)||void 0===e||e.localStorage.removeItem(t),Promise.resolve()}setDBInfo(e,t,n,i){this.sessionId||(this.sessionId=n),this.tId||(this.tId=e),this.oId||(this.oId=t),this.userId||(this.userId=i,this.fetchPersistedLogsFromLastSession())}persistLogs(){var e;if(this.eventsBufferArray.length>0&&(null===(e=this.host)||void 0===e?void 0:e.localStorage)){const e=$(this.userId,this.isForErrorLogs);z(this,this.host.localStorage,e,this.sessionId)}}}J.DEFAULT_QUEUE_CAPACITY=1e3;var Q=n(99342),K=n(9940);class Y{constructor(e,t,n,i){this.opener=e,this.setTimeout=t,this.clearTimeout=n,this.diagnosticsEventsBuffer=[],this.flush=()=>{if(this.diagnosticsEventsBuffer.length>0)try{this.opener.postMessage(K.rY.ActivityEvent,{action:"er:rendererDiagnosticsEvents",data:[...this.diagnosticsEventsBuffer]})}catch(e){console.error("DiagnosticsBackupService failed to send a message")}this.reset()},this.backupTimeoutMs=i&&i>0?i:Y.DefaultBackupTimeoutMs,this.reset()}pushDiagnosticsEvent(e){e&&(this.diagnosticsEventsBuffer.push(this.stringifyEvent(e)),this.diagnosticsEventsBuffer.length===Y.BufferCapacity&&this.flush(),!this.backupTimer&&this.diagnosticsEventsBuffer.length>0&&this.startTimer())}dispose(){this.flush()}reset(){this.diagnosticsEventsBuffer.length=0,this.stopTimer()}stopTimer(){this.backupTimer&&(this.clearTimeout(this.backupTimer),this.backupTimer=void 0)}startTimer(){this.backupTimer=this.setTimeout(this.flush,this.backupTimeoutMs)}stringifyEvent(e){return(0,R.Uw)("{0} {1}\t{2}\r\n",[e.timeStamp,e.levelName.slice(0,3),e.message])}}Y.BufferCapacity=50,Y.DefaultBackupTimeoutMs=100;var X,Z=n(34255),ee=n(82250);!function(e){e[e.ecsSetting=0]="ecsSetting",e[e.clientPreference=1]="clientPreference",e[e.error=2]="error",e[e.beforeDeletingDB=3]="beforeDeletingDB"}(X||(X={}));class te extends q{constructor(e,t,n){super(),this.host=e,this.experienceName=t,this.databaseName=n,this.indexedDBVersion=1,this.storeName="LogsStore",this.timeIndexName="timeIdx",this.currentIDBItemIndex=-1,this.IDBManagementArray=[],this.IDBErrorCount=0,this.allowedIDBErrorCount=10,this.defaultAllowedBufferLength=2e3,this.defaultCountOfIDBObjects=10,this.defaultWorkerAllowedBufferLength=1e3,this.defaultWorkerMaxCountOfIndexDBObject=10,this.minBufferLength=1e3,this.maxBufferLength=5e3,this.minWorkerBufferLength=500,this.maxWorkerBufferLength=3e3,this.minCountOfIDBObjects=10,this.maxCountofIDBObjects=1e3,this.minWorkerCountOfIDBObjects=10,this.maxWorkerCountofIDBObjects=1e3,this.timeThrottlingInterval=6e4,this.lastPersistTimestamp=0,this.skippedEventsCount=0,this.pushLogsOutOfOrdersFound=!1,this.disableIDBLogs=!1,this.ecsEnableIDBLogs=!1,this.isUserEnableIDBLogs=!1,this.databaseName===d.DiagnosticsLogsWorker?(this.allowedCountOfIndexDBObject=this.defaultWorkerMaxCountOfIndexDBObject,this.allowedBufferLength=this.defaultWorkerAllowedBufferLength):(this.allowedCountOfIndexDBObject=this.defaultCountOfIDBObjects,this.allowedBufferLength=this.defaultAllowedBufferLength),this.scenarioFactory=F(!0)}setDBInfo(e,t,n,i){this.getDBName()||(this.tId=e,this.oId=t,this.sessionId=n,this.userId=i,this.openIndexedDB(),this.fetchPersistedLogsFromLastSession())}setCapacity(e){if(void 0!==e.throttleTime&&e.throttleTime>=0&&(this.timeThrottlingInterval=1e3*e.throttleTime),e.bufferSize){const t=this.databaseName===d.DiagnosticsLogsMain?this.minBufferLength:this.minWorkerBufferLength,n=this.databaseName===d.DiagnosticsLogsMain?this.maxBufferLength:this.maxWorkerBufferLength;e.bufferSize>=t&&e.bufferSize<=n&&(this.allowedBufferLength=e.bufferSize)}const t=this.allowPersistIntoIDB;if(e.enableIndexedDB?this.ecsEnableIDBLogs=!0:!1===e.enableIndexedDB&&this.disablePersistIntoIDB(X.ecsSetting),e.clientEnableExtendedLogs?this.isUserEnableIDBLogs=!0:!1===e.clientEnableExtendedLogs&&this.disablePersistIntoIDB(X.clientPreference),e.IDBObjectCount){const n=this.databaseName===d.DiagnosticsLogsMain?this.minCountOfIDBObjects:this.minWorkerCountOfIDBObjects,i=this.databaseName===d.DiagnosticsLogsMain?this.maxCountofIDBObjects:this.maxWorkerCountofIDBObjects;if(e.IDBObjectCount>=n&&e.IDBObjectCount<=i){if(t&&this.allowPersistIntoIDB&&this.IDBManagementArray.length>e.IDBObjectCount){const t=this.getToBeDeletedIDs(e.IDBObjectCount);this.deleteIDBItems(t)}this.allowedCountOfIndexDBObject=e.IDBObjectCount}}!t&&this.allowPersistIntoIDB&&this.openIndexedDB()}addEvent(e){if(!this.pushLogsOutOfOrdersFound&&this.eventsBufferArray.length>0&&e.timeStamp<this.eventsBufferArray[this.eventsBufferArray.length-1].timeStamp){this.pushLogsOutOfOrdersFound=!0;const t=this.scenarioFactory.newScenario(ee.RG.DiagnosticsLogsAddOutOfOrder);null==t||t.fail({reason:`Add one log out of order: Current - ${e.timeStamp.getTime()}, Last - ${this.eventsBufferArray[this.eventsBufferArray.length-1].timeStamp.getTime()}`})}if(this.eventsBufferArray.push(e),this.eventsBufferArray.length>=this.allowedBufferLength)if(this.allowPersistIntoIDB&&this.db)if(this.shouldBeThrottled()){const e=this.eventsBufferArray.shift();this.skippedEventsCount++,void 0===this.firstSkippedEventTime&&(this.firstSkippedEventTime=null==e?void 0:e.timeStamp),this.lastSkippedEventTime=null==e?void 0:e.timeStamp}else this.flushBufferIntoIndexedDB();else this.eventsBufferArray.shift()}getAllEvents(e){return!this.db||e&&this.eventsBufferArray.length>=e?e&&this.eventsBufferArray.length>e?Promise.resolve(this.eventsBufferArray.slice(this.eventsBufferArray.length-e)):Promise.resolve(this.eventsBufferArray):new Promise((t=>{const n=this.getIDBStore(this.db,this.storeName,"readonly");if(n){const i=n.index(this.timeIndexName);if(!i)return t(this.eventsBufferArray);{const n=this.scenarioFactory.newScenario(ee.RG.DiagnosticsGetAllLogsFromIDB),a=i.getAll();let o="";a.onsuccess=()=>{let i=[],r="";a.result.forEach((e=>{""!==r&&e.logsArray.length>1&&e.logsArray[0].timeStamp>e.logsArray[e.logsArray.length-1].timeStamp&&(r=`Fetch from IDB out of order: First - ${e.logsArray[0].timeStamp.toString()}, Last - ${e.logsArray[e.logsArray.length-1].timeStamp.toString()}`),e.sessionId!==o&&""!==o&&this.addAnSeperateLogItem(i,o),o=e.sessionId,i=i.concat(e.logsArray)})),""===r?null==n||n.stop():null==n||n.fail({reason:r}),""!==o&&o!==this.sessionId&&this.addAnSeperateLogItem(i,o),i=i.concat(this.eventsBufferArray),e&&i.length>e&&(i=i.slice(i.length-e)),t(i)},a.onerror=()=>{null==n||n.fail({reason:a.error}),this.increaseIDBErrorCount(),t(this.eventsBufferArray)}}}}))}handleUserLogout(){const e=$(this.userId);return this.host.localStorage.removeItem(e),this.allowPersistIntoIDB&&this.db?this.createDeleteUserDBPromise():Promise.resolve()}setScenarioFactory(e){this.scenarioFactory.setScenarioFactory(e)}persistLogs(){var e;if(this.eventsBufferArray.length>0)if(this.allowPersistIntoIDB)this.flushBufferIntoIndexedDB();else if(null===(e=this.host)||void 0===e?void 0:e.localStorage){const e=$(this.userId);z(this,this.host.localStorage,e,this.sessionId)}}createDeleteUserDBPromise(){var e;const t=(null===(e=this.host)||void 0===e?void 0:e.indexedDB)||globalThis.indexedDB;if(t&&this.db){const e=this.getDBName();if(e)return this.disablePersistIntoIDB(X.beforeDeletingDB,"Deleting user IDB"),this.db.close(),new Promise((n=>{const i=this.scenarioFactory.newScenario(ee.RG.DiagnosticsDeleteIDB),a=t.deleteDatabase(e);a.onblocked=()=>{this.addEvent({message:"DiagnosticsService - Deleting user diagnostics logs IDB blocked",isPiiFree:!0,level:D.i.Error,levelName:"error",timeStamp:new Date}),null==i||i.fail({reason:`Deleting DB blocked for ${a.error}`}),n()},a.onsuccess=()=>{null==i||i.stop(),n()},a.onerror=()=>{this.addEvent({message:"DiagnosticsService - Deleting user diagnostics logs IDB error",isPiiFree:!0,level:D.i.Error,levelName:"error",timeStamp:new Date}),null==i||i.fail({reason:`Deleting DB failed for ${a.error}`}),this.increaseIDBErrorCount(),n()}}))}return Promise.resolve()}flushBufferIntoIndexedDB(){if(this.eventsBufferArray.length>0){const e=this.eventsBufferArray;this.eventsBufferArray=[];const t=this.skippedEventsCount;this.updateThrottleInfo(e);const n=this.scenarioFactory.newScenario(ee.RG.DiagnosticsSaveIDBItemMain);this.persistBufferIntoDB(this.getNextManagementItem(),e,!1),null==n||n.stop({skippedCount:t})}}updateThrottleInfo(e){var t;this.skippedEventsCount>0&&this.lastSkippedEventTime&&(e.unshift({message:`DiagnosticsService - skipped ${this.skippedEventsCount} event logs between ${null===(t=this.firstSkippedEventTime)||void 0===t?void 0:t.toISOString()} and ${this.lastSkippedEventTime.toISOString()} for logs throttle`,level:D.i.Info,levelName:"Info",isPiiFree:!0,timeStamp:this.lastSkippedEventTime}),this.skippedEventsCount=0,this.lastSkippedEventTime=void 0,this.firstSkippedEventTime=void 0),this.lastPersistTimestamp=Date.now()}openIndexedDB(){var e;if(this.allowPersistIntoIDB&&!this.db){const t=(null===(e=this.host)||void 0===e?void 0:e.indexedDB)||globalThis.indexedDB;if(!t)return;const n=this.getDBName();if(n){const e=this.scenarioFactory.newScenario(ee.RG.DiagnosticsOpenIDB),i=t.open(n,this.indexedDBVersion);i.onerror=()=>{this.addEvent({message:"DiagnosticsService - Open IndexedDB failed",isPiiFree:!0,level:D.i.Error,levelName:"error",timeStamp:new Date}),null==e||e.fail({reason:i.error}),this.increaseIDBErrorCount()},i.onupgradeneeded=()=>{this.createDataStores(i.result)},i.onsuccess=()=>{this.initializeManagementArray(i.result),null==e||e.stop()}}}}createDataStores(e){const t=this.scenarioFactory.newScenario(ee.RG.DiagnosticsCreateIDBStore);try{e.createObjectStore(this.storeName,{autoIncrement:!0}).createIndex(this.timeIndexName,"timeStamp",{unique:!0}),null==t||t.stop()}catch(e){null==t||t.fail({reason:e}),this.addEvent({message:"DiagnosticService - Create objectStore failed",isPiiFree:!0,level:D.i.Error,levelName:"error",timeStamp:new Date})}}getDBName(){return this.tId&&this.oId&&this.experienceName&&this.sessionId?`Teams:${this.databaseName}:${this.experienceName}:${this.tId}:${this.oId}`:""}getIDBStore(e,t,n){if(e)try{const i=e.transaction(t,n);return null==i?void 0:i.objectStore(t)}catch(e){this.disablePersistIntoIDB(X.error,"getIDBStore failed")}}persistBufferIntoDB(e,t,n=!1,i,a){if(0===t.length)return;if(e.isUpdating&&!n)return void this.disablePersistIntoIDB(X.error,"All diagnostics log indexedDB items are pending update");const o=this.getIDBStore(this.db,this.storeName,"readwrite");if(o){n||(e.isUpdating=!0,e.timeStamp=a||Date.now());const r={logsArray:t,sessionId:i||this.sessionId||"",timeStamp:e.timeStamp};let s,l;e.IDBId>0?(l=this.scenarioFactory.newScenario(ee.RG.DiagnosticsUpdateIDBItem),s=o.put(r,e.IDBId)):(l=this.scenarioFactory.newScenario(ee.RG.DiagnosticsAddLogsIntoIDB),s=o.add(r)),s.onsuccess=()=>{null==l||l.stop(),t.length=0,e.isUpdating=!1,e.IDBId=s.result},s.onerror=()=>{null==l||l.fail({reason:s.error,retryCount:n?1:0}),n?(this.addEvent({message:`DiagnosticService - Failed adding event buffer into IDB after retry, lost ${t.length} events`,isPiiFree:!0,level:D.i.Error,levelName:"error",timeStamp:new Date}),t.length=0,e.isUpdating=!1,this.increaseIDBErrorCount()):(this.addEvent({message:"DiagnosticService - Failed adding event buffer into IDB, start retry",isPiiFree:!0,level:D.i.Error,levelName:"error",timeStamp:new Date}),this.persistBufferIntoDB(e,t,!0,i,a))}}}deleteIDBItems(e){if(e.length>0){const t=this.getIDBStore(this.db,this.storeName,"readwrite");t&&e.forEach((e=>{const n=this.scenarioFactory.newScenario(ee.RG.DiagnosticsDeleteLogsInIDB),i=t.delete(e);i.onsuccess=()=>{null==n||n.stop()},i.onerror=()=>{null==n||n.fail({reason:i.error}),this.increaseIDBErrorCount()}}))}}clearDBStore(){const e=this.getIDBStore(this.db,this.storeName,"readwrite");if(e){const t=this.scenarioFactory.newScenario(ee.RG.DiagnosticsClearIDBStore),n=e.clear();n.onsuccess=()=>{this.IDBManagementArray=[],this.currentIDBItemIndex=-1,null==t||t.stop()},n.onerror=()=>{null==t||t.fail({reason:n.error}),this.addEvent({message:"DiagnosticsService - Clear IDB store failed",isPiiFree:!0,level:D.i.Error,levelName:"error",timeStamp:new Date}),this.increaseIDBErrorCount()}}}getToBeDeletedIDs(e){const t=[];if(this.db&&e<this.IDBManagementArray.length){const n=this.IDBManagementArray.length-e;for(let e=0;e<n;e++){let e=0;this.currentIDBItemIndex<this.IDBManagementArray.length-1&&(e=this.currentIDBItemIndex+1);const n=this.IDBManagementArray[e];t.push(n.IDBId),this.IDBManagementArray.splice(e,1),0===e&&this.currentIDBItemIndex--}}return t}getNextManagementItem(){return this.currentIDBItemIndex===this.IDBManagementArray.length-1?this.IDBManagementArray.length<this.allowedCountOfIndexDBObject?(this.addNewManagementItem(),this.currentIDBItemIndex++):this.currentIDBItemIndex=0:this.currentIDBItemIndex++,this.IDBManagementArray[this.currentIDBItemIndex]}initializeManagementArray(e){if(this.allowPersistIntoIDB&&e&&!this.db){const t=this.getIDBStore(e,this.storeName,"readwrite");if(t){const n=t.index(this.timeIndexName);if(n){const t=this.scenarioFactory.newScenario(ee.RG.DiagnosticsGetAllKeysFromIDB),i=n.getAllKeys();i.onsuccess=()=>{null==t||t.stop(),this.db=e,this.IDBManagementArray=[],i.result.forEach((e=>this.addNewManagementItem(e))),this.currentIDBItemIndex=this.IDBManagementArray.length-1,this.fetchAndPersistPreviuosSessionLogs()},i.onerror=()=>{null==t||t.fail({reason:i.error}),this.increaseIDBErrorCount()}}}}}addNewManagementItem(e=0){this.IDBManagementArray.push({timeStamp:0,isUpdating:!1,IDBId:e})}disablePersistIntoIDB(e,t){var n;const i=this.allowPersistIntoIDB;switch(e){case X.ecsSetting:if(!this.ecsEnableIDBLogs)return;this.ecsEnableIDBLogs=!1;break;case X.clientPreference:if(!this.isUserEnableIDBLogs)return;this.isUserEnableIDBLogs=!1;break;case X.error:case X.beforeDeletingDB:if(this.disableIDBLogs)return;this.disableIDBLogs=!0}const a=`DiagnosticService - writing logs into IDB settings changed for ${X[e]}`;this.addEvent({message:a,isPiiFree:!0,level:e===X.error?D.i.Error:D.i.Info,levelName:e===X.error?"error":"info",timeStamp:new Date}),i&&!this.allowPersistIntoIDB&&(e===X.error?null===(n=this.scenarioFactory.newScenario(ee.RG.DiagnosticsDisableIDB))||void 0===n||n.stop({errorReason:t}):e!==X.beforeDeletingDB&&this.clearDBStore())}increaseIDBErrorCount(){this.IDBErrorCount<this.allowedIDBErrorCount&&(this.IDBErrorCount++,this.IDBErrorCount===this.allowedIDBErrorCount&&this.disablePersistIntoIDB(X.error,"Allowed IDB error count reached"))}shouldBeThrottled(){return!!this.timeThrottleEnabled()&&Date.now()-this.lastPersistTimestamp<this.timeThrottlingInterval}timeThrottleEnabled(){return!this.isUserEnableIDBLogs&&this.timeThrottlingInterval>0&&this.lastPersistTimestamp>0}addAnSeperateLogItem(e,t){0!==e.length&&e.push({message:`===== The following logs are for previous session [${t}] =====`,isPiiFree:!0,level:D.i.Info,levelName:"Info",timeStamp:e[e.length-1].timeStamp})}get allowPersistIntoIDB(){return(this.ecsEnableIDBLogs||this.isUserEnableIDBLogs)&&!this.disableIDBLogs}fetchAndPersistPreviuosSessionLogs(){var e,t;const n=H(this.userId),i=V(this.host.localStorage,n,!0);i&&i.sessionId&&(null===(e=i.logsArray)||void 0===e?void 0:e.length)>0&&(this.persistBufferIntoDB(this.getNextManagementItem(),i.logsArray,!1,i.sessionId,i.logsArray[i.logsArray.length-1].timeStamp.getTime()),null===(t=this.host)||void 0===t||t.localStorage.removeItem(n))}}var ne=n(57078);class ie extends q{constructor(){super(),this.currentIDBItemIndex=-1,this.IDBManagementArray=[],this.defaultWorkerAllowedBufferLength=1e3,this.defaultWorkerMaxCountOfIndexDBObject=10,this.minWorkerBufferLength=500,this.maxWorkerBufferLength=3e3,this.minWorkerCountOfIDBObjects=5,this.maxWorkerCountOfIDBObjects=100,this.timeThrottlingInterval=6e4,this.lastPersistTimestamp=0,this.skippedEventsCount=0,this.pushLogsOutOfOrdersFound=!1,this.disableIDBLogs=!1,this.ecsEnableIDBLogs=!1,this.isUserEnableIDBLogs=!1,this.allowedCountOfIndexDBObject=this.defaultWorkerMaxCountOfIndexDBObject,this.allowedBufferLength=this.defaultWorkerAllowedBufferLength,this.scenarioFactory=F(!0)}setDBInfo(e,t,n,i){this.sessionId||(this.sessionId=n,this.addEvent({message:`DiagnosticsService - setDBInfo called for: tid ${e}, oid ${t}, sessionId ${n}, userid ${i}`,isPiiFree:!0,level:D.i.Info,levelName:"info",timeStamp:new Date}))}setCapacity(e){return(0,c.mG)(this,void 0,void 0,(function*(){void 0!==e.throttleTime&&e.throttleTime>=0&&(this.timeThrottlingInterval=e.throttleTime*ne.kg),e.bufferSize&&e.bufferSize>=this.minWorkerBufferLength&&e.bufferSize<=this.maxWorkerBufferLength&&(this.allowedBufferLength=e.bufferSize);const t=this.allowPersistIntoIDB;if(e.enableIndexedDB?this.ecsEnableIDBLogs=!0:!1===e.enableIndexedDB&&this.disablePersistIntoIDB(X.ecsSetting),e.clientEnableExtendedLogs?this.isUserEnableIDBLogs=!0:!1===e.clientEnableExtendedLogs&&this.disablePersistIntoIDB(X.clientPreference),e.IDBObjectCount&&e.IDBObjectCount>=this.minWorkerCountOfIDBObjects&&e.IDBObjectCount<=this.maxWorkerCountOfIDBObjects){if(t&&this.allowPersistIntoIDB&&this.IDBManagementArray.length>e.IDBObjectCount){const t=this.getToBeDeletedIDs(e.IDBObjectCount);yield this.deleteIDBItems(t)}this.allowedCountOfIndexDBObject=e.IDBObjectCount}}))}addEvent(e){if(!this.pushLogsOutOfOrdersFound&&this.eventsBufferArray.length>0&&e.timeStamp<this.eventsBufferArray[this.eventsBufferArray.length-1].timeStamp){this.pushLogsOutOfOrdersFound=!0;const t=this.scenarioFactory.newScenario(ee.RG.DiagnosticsLogsAddOutOfOrder);null==t||t.fail({reason:`Add one log out of order: Current - ${e.timeStamp.toString()}, Last - ${this.eventsBufferArray[this.eventsBufferArray.length-1].timeStamp.toString()}`})}if(this.eventsBufferArray.push(e),this.eventsBufferArray.length>=this.allowedBufferLength)if(this.allowPersistIntoIDB&&this.dataManager)if(this.shouldBeThrottled()){const e=this.eventsBufferArray.shift();this.skippedEventsCount++,void 0===this.firstSkippedEventTime&&(this.firstSkippedEventTime=null==e?void 0:e.timeStamp),this.lastSkippedEventTime=null==e?void 0:e.timeStamp}else this.flushBufferIntoIndexedDB();else this.eventsBufferArray.shift()}getAllEvents(e){return!this.dataManager||!this.allowPersistIntoIDB||e&&this.eventsBufferArray.length>=e?e&&this.eventsBufferArray.length>e?Promise.resolve(this.eventsBufferArray.slice(this.eventsBufferArray.length-e)):Promise.resolve(this.eventsBufferArray):new Promise((t=>{var n;null===(n=this.dataManager)||void 0===n||n.getAllLogs().then((n=>{let i=[],a="",o="";null==n||n.sort(((e,t)=>e.timeStamp-t.timeStamp)),null==n||n.forEach((e=>{""!==a&&e.logsArray.length>1&&e.logsArray[0].timeStamp>e.logsArray[e.logsArray.length-1].timeStamp&&(a=`Fetch from IDB out of order: First - ${e.logsArray[0].timeStamp.toString()}, Last - ${e.logsArray[e.logsArray.length-1].timeStamp.toString()}`),e.sessionId!==o&&""!==o&&this.addAnSeperateLogItem(i,o),o=e.sessionId,i=i.concat(e.logsArray)})),""!==o&&o!==this.sessionId&&this.addAnSeperateLogItem(i,o),i=i.concat(this.eventsBufferArray),e&&i.length>e&&(i=i.slice(i.length-e)),t(i)}))}))}setScenarioFactory(e){this.scenarioFactory.setScenarioFactory(e)}setWorkerLogsDataManager(e){this.dataManager=e}persistLogs(){this.allowPersistIntoIDB&&this.flushBufferIntoIndexedDB()}handleUserLogout(e){return Promise.resolve()}flushBufferIntoIndexedDB(){return(0,c.mG)(this,void 0,void 0,(function*(){if(this.eventsBufferArray.length>0){const e=this.eventsBufferArray;this.eventsBufferArray=[];const t=this.skippedEventsCount;this.updateThrottleInfo(e);const n=yield this.getNextManagementItem(),i=this.scenarioFactory.newScenario(ee.RG.DiagnosticsSaveIDBItemMain);this.persistBufferIntoDB(n,e),null==i||i.stop({skippedCount:t})}}))}updateThrottleInfo(e){var t;this.skippedEventsCount>0&&this.lastSkippedEventTime&&(e.unshift({message:`DiagnosticsService - skipped ${this.skippedEventsCount} event logs between ${null===(t=this.firstSkippedEventTime)||void 0===t?void 0:t.toISOString()} and ${this.lastSkippedEventTime.toISOString()} for logs throttle`,level:D.i.Info,levelName:"Info",isPiiFree:!0,timeStamp:this.lastSkippedEventTime}),this.skippedEventsCount=0,this.lastSkippedEventTime=void 0,this.firstSkippedEventTime=void 0),this.lastPersistTimestamp=Date.now()}persistBufferIntoDB(e,t){var n;if(0===t.length||!this.allowPersistIntoIDB)return;const i={id:e.IDBId,logsArray:t,sessionId:this.sessionId||"",timeStamp:Date.now()};null===(n=this.dataManager)||void 0===n||n.persistLogs(i),e.timeStamp=i.timeStamp}deleteIDBItems(e){return(0,c.mG)(this,void 0,void 0,(function*(){e.length>0&&this.dataManager&&e.forEach((e=>(0,c.mG)(this,void 0,void 0,(function*(){var t;if(yield null===(t=this.dataManager)||void 0===t?void 0:t.removeOneLogItem(e)){const t=this.IDBManagementArray.findIndex((t=>t.IDBId===e));t>=0&&this.IDBManagementArray.splice(t,1)}}))))}))}clearDBStore(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){return this.dataManager&&(yield null===(e=this.dataManager)||void 0===e?void 0:e.clearAllLogs())&&(this.IDBManagementArray=[],this.currentIDBItemIndex=-1),!0}))}getToBeDeletedIDs(e){const t=[];if(this.dataManager&&e<this.IDBManagementArray.length){const n=this.IDBManagementArray.length-e;for(let e=0;e<n;e++){let e=0;this.currentIDBItemIndex<this.IDBManagementArray.length-1&&(e=this.currentIDBItemIndex+1);const n=this.IDBManagementArray[e];t.push(n.IDBId),this.IDBManagementArray.splice(e,1),0===e&&this.currentIDBItemIndex--}}return t}getNextManagementItem(){return(0,c.mG)(this,void 0,void 0,(function*(){return 0===this.IDBManagementArray.length&&this.allowedCountOfIndexDBObject>0&&(yield this.initializeManagementArray()),this.currentIDBItemIndex===this.IDBManagementArray.length-1?this.IDBManagementArray.length<this.allowedCountOfIndexDBObject?(this.addNewManagementItem(),this.currentIDBItemIndex++):this.currentIDBItemIndex=0:this.currentIDBItemIndex++,this.IDBManagementArray[this.currentIDBItemIndex]}))}addNewManagementItem(){let e=0;for(this.IDBManagementArray.length>0&&(e=this.IDBManagementArray[this.IDBManagementArray.length-1].IDBId),e++;e>this.allowedCountOfIndexDBObject||this.idExists(e);)e>this.allowedCountOfIndexDBObject?e=1:e++;this.IDBManagementArray.push({IDBId:e,timeStamp:0,isUpdating:!1})}idExists(e){return this.IDBManagementArray.filter((t=>t.IDBId===e)).length>0}initializeManagementArray(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){if(this.allowPersistIntoIDB&&this.dataManager&&0===this.IDBManagementArray.length&&this.allowedCountOfIndexDBObject>0){const t=yield null===(e=this.dataManager)||void 0===e?void 0:e.getAllKeys();null==t||t.sort(((e,t)=>e.timeStamp-t.timeStamp)),null==t||t.forEach((e=>this.IDBManagementArray.push({IDBId:e.id,timeStamp:e.timeStamp,isUpdating:!1}))),this.currentIDBItemIndex=this.IDBManagementArray.length-1}}))}disablePersistIntoIDB(e,t){var n;const i=this.allowPersistIntoIDB;switch(e){case X.ecsSetting:if(!this.ecsEnableIDBLogs)return;this.ecsEnableIDBLogs=!1;break;case X.clientPreference:if(!this.isUserEnableIDBLogs)return;this.isUserEnableIDBLogs=!1;break;case X.error:case X.beforeDeletingDB:if(this.disableIDBLogs)return;this.disableIDBLogs=!0}const a=`DiagnosticService - writing logs into IDB settings changed for ${X[e]}`;this.addEvent({message:a,isPiiFree:!0,level:e===X.error?D.i.Error:D.i.Info,levelName:e===X.error?"error":"info",timeStamp:new Date}),i&&!this.allowPersistIntoIDB&&(e===X.error?null===(n=this.scenarioFactory.newScenario(ee.RG.DiagnosticsDisableIDB))||void 0===n||n.stop({errorReason:t}):e!==X.beforeDeletingDB&&this.clearDBStore())}shouldBeThrottled(){return!!this.timeThrottleEnabled()&&Date.now()-this.lastPersistTimestamp<this.timeThrottlingInterval}timeThrottleEnabled(){return!this.isUserEnableIDBLogs&&this.timeThrottlingInterval>0&&this.lastPersistTimestamp>0}addAnSeperateLogItem(e,t){0!==e.length&&e.push({message:`===== The following logs are for previous session [${t}] =====`,isPiiFree:!0,level:D.i.Info,levelName:"Info",timeStamp:e[e.length-1].timeStamp})}get allowPersistIntoIDB(){return(this.ecsEnableIDBLogs||this.isUserEnableIDBLogs)&&!this.disableIDBLogs}}const ae="Core";class oe{constructor(e,t,n,i){var a;this.experienceName=e,this.dbStoreName=t,this.userECSConsoleLogLevel=i,this.diagnosticsBackupEnabled=!1,this.userDiagnosticsMap=new Map,this.userID="",this.memoryBufferArraySize=0,this.sessionId="",this._minDurationForCountingLogLines=50,this._minThrottleWindowSize=1e4,this._minThrottleWindowCapacity=5,this.rwcExperienceName="react-web-client",this._loggerSettings={durationForCountingLogLines:0,diagnosticsLogsThrottling:E.gG.DryRunQuiet,isUserEnableIDBLogs:!1,throttleWindowSize:0,throttleCapacity:0,consoleLogLevel:D.i.Error},this._defaultLatestErrorCount=5,this.logsProviderName=w.DIAGNOSTICSSERVICE,this.updatedSettingsForMainThread=e=>{this.diagnosticsSettings=e;const{diagnosticsBackupSyncCycleMs:t,diagnosticsEventQueueMaxSize:n,diagnosticsLogBufferArraySize:i,diagnosticsLogsIDBObjectCount:a,diagnosticsLogsThrottling:o,enableDiagnosticsBackup:r,enableStoreDiagnosticsLogsInIDB:s,errorDiagnosticsEventQueueMaxSize:l,logsMarkInterval:d,savingLogsIntoIDBThrottleTime:c,throttleCapacity:u,throttleWindowSizeMs:m,clientExtendedDiagnosticsData:g,disableExtendedDiagnosticsDataToggle:p,consoleLogLevel:h}=e;this.updateSettingsForLogger({durationForCountingLogLines:d||0,throttleWindowSize:m||0,throttleCapacity:u||0,isUserEnableIDBLogs:!!g&&!p,diagnosticsLogsThrottling:o||E.gG.DryRunQuiet,consoleLogLevel:this.validateConsoleLogLevel(h||"")}),this.setDiagnosticsBackupEnabled(!!r,t||void 0);const v=(0,Z.isNumber)(c)?c:void 0,S=(0,Z.isNumber)(n)?n:0;if(void 0===s&&void 0===g)S&&this.diagnosticsEvents.setCapacity({bufferSize:S,throttleTime:v});else{const e=s?(0,Z.isNumber)(i)?i:0:S;this.diagnosticsEvents.setCapacity({enableIndexedDB:(0,Z.isUndefined)(s)?void 0:!!s,bufferSize:e,IDBObjectCount:(0,Z.isNumber)(a)?a:0,throttleTime:v,clientEnableExtendedLogs:(0,Z.isUndefined)(g)?void 0:!!g&&!p})}this.isErrorDiagnosticsEnabled=!!l,this.isErrorDiagnosticsEnabled?(0,Z.isNumber)(l)&&this.errorDiagnosticsEvents.setCapacity({bufferSize:l,throttleTime:v}):this.errorDiagnosticsEvents=new J(!0,this.host,this._defaultLatestErrorCount)},this.updatedSettingsForWorkerThread=e=>{const{enableWorkerStoreDiagnosticsLogsInIDB:t,workerDiagnosticsLogBufferArraySize:n,workerDiagnosticsLogsIDBObjectCount:i,logsMarkInterval:a,savingLogsIntoIDBThrottleTime:o,throttleCapacity:r,throttleWindowSizeMs:s,clientExtendedDiagnosticsData:l,disableExtendedDiagnosticsDataToggle:d,diagnosticsLogsThrottling:c,consoleLogLevel:u}=e;this.updateSettingsForLogger({durationForCountingLogLines:a||0,throttleWindowSize:s||0,throttleCapacity:r||0,isUserEnableIDBLogs:!!l&&!d,diagnosticsLogsThrottling:c||E.gG.DryRunQuiet,consoleLogLevel:this.validateConsoleLogLevel(u||"")});const m=(0,Z.isNumber)(o)?o:void 0;void 0===t&&void 0===l||(this.memoryBufferArraySize=t&&(0,Z.isNumber)(n)?n:0,this.diagnosticsEvents.setCapacity({bufferSize:this.memoryBufferArraySize,enableIndexedDB:(0,Z.isUndefined)(t)?void 0:!!t,IDBObjectCount:(0,Z.isNumber)(i)?i:0,throttleTime:m,clientEnableExtendedLogs:(0,Z.isUndefined)(l)?void 0:!!l&&!d}))},this.attemptToSetHost(),this.scenarioFactory=F(!1),void 0!==this.userECSConsoleLogLevel?this.loggerSettings.consoleLogLevel=this.userECSConsoleLogLevel:void 0!==n&&(this.loggerSettings.consoleLogLevel=n),e&&t===d.DiagnosticsLogsMain?this.diagnosticsEvents=new te(this.host,e,t):e&&t===d.DiagnosticsLogsWorker?this.diagnosticsEvents=new ie:this.diagnosticsEvents=new J(!1,this.host),this.isErrorDiagnosticsEnabled=!1,this.errorDiagnosticsEvents=new J(!0,this.host),this.diagnosticsBackupService=void 0,(null===(a=this.host)||void 0===a?void 0:a.addEventListener)&&this.host.addEventListener("unload",(()=>{this.persistDiagnosticsAsPreviousSessionLogs()})),e!==this.rwcExperienceName&&this.loadDiagnosticsFromLocalStorage(!0)}setScenarioFactory(e){this.coreScenarioFactory=e,this.scenarioFactory.setScenarioFactory(e),this.diagnosticsEvents.setScenarioFactory(e),this.userDiagnosticsMap.size>0&&Array.from(this.userDiagnosticsMap.values()).forEach((t=>{t.setScenarioFactory(e)}))}subscribeToCoreSettings(e){if(!e)return void this.pushDiagnosticsEvent(D.i.Error,"DiagnosticsService: Failed to subscribe to core settings",!0);e.getObservable(A.J.Diagnostics).subscribe((e=>{this.dbStoreName===d.DiagnosticsLogsWorker?this.updatedSettingsForWorkerThread(e):(this.updatedSettingsForMainThread(e),this.userDiagnosticsMap.size>0&&Array.from(this.userDiagnosticsMap.values()).forEach((t=>t.updatedSettingsForMainThread(e))))}))}updateDiagnosticInfo(e,t,n,i){i&&(this.userID=i),this.sessionId||(this.sessionId=n),this.diagnosticsEvents.setDBInfo(e,t,n,i),this.errorDiagnosticsEvents.setDBInfo(e,t,n,i)}handleUserLogout(e){if(e){const t=this.userDiagnosticsMap.get(e);if(t){this.userDiagnosticsMap.delete(e);let n=Promise.resolve();return 0===this.userDiagnosticsMap.size&&(n=this.cleanLogsStorage()),Promise.all([t.handleUserLogout(e),n]).then()}}return this.cleanLogsStorage()}createUserDiagnosticsService(e,t,n,i){if(this.dbStoreName===d.DiagnosticsLogsWorker||this.userID&&this.userID!==ae)this.pushDiagnosticsEvent(D.i.Error,"DiagnosticsService: createUserDiagnosticsService function should only be called from the coreDiagnosticsService in the main thread",!0);else if(e&&t&&n&&i){this.userID||this.updateDiagnosticInfo("Core","Logs",n,ae);let a=this.userDiagnosticsMap.get(i);return void 0===a&&(a=new oe(this.experienceName,this.dbStoreName),a.updateDiagnosticInfo(e,t,n,i),this.diagnosticsSettings&&a.updatedSettingsForMainThread(this.diagnosticsSettings),this.coreScenarioFactory&&a.setScenarioFactory(this.coreScenarioFactory),this.userDiagnosticsMap.set(i,a)),a}}pushDiagnosticsEvent(e,t,n){const i=((e,t,n,i)=>{n.length>512&&(n=n.substring(0,512)+"...");const a={message:n=(0,R.LQ)(n),level:t,levelName:D.i[t],timeStamp:new Date,isPiiFree:i};return e.addEvent(a),a})(this.diagnosticsEvents,e,t,n);e===D.i.Error&&this.errorDiagnosticsEvents.addEvent(i),this.diagnosticsBackupEnabled&&this.diagnosticsBackupService&&this.diagnosticsBackupService.pushDiagnosticsEvent(i)}getDiagnosticsEvents(e){return(0,c.mG)(this,void 0,void 0,(function*(){let t=[];const n=this.scenarioFactory.newScenario(ee.RG.DiagnosticsGetLogs);try{t=(yield this.diagnosticsEvents.getAllEvents(e))||[]}catch(e){const t=`DiagnosticsService: Failed to fetch diagnostic logs: ${e}`;this.pushDiagnosticsEvent(D.i.Error,t,!0),null==n||n.fail({reason:t})}try{t=t.reverse(),t.sort(((e,t)=>{const n="function"==typeof e.timeStamp.getTime?e.timeStamp:new Date(e.timeStamp);return("function"==typeof t.timeStamp.getTime?t.timeStamp:new Date(t.timeStamp)).getTime()-n.getTime()})),null==n||n.stop()}catch(e){null==n||n.fail({reason:"Logs events array failed on reverting and sorting"})}return t}))}persistDiagnostics(){this.diagnosticsEvents.persistLogs(),this.errorDiagnosticsEvents.persistLogs(),this.diagnosticsBackupEnabled&&this.diagnosticsBackupService&&this.diagnosticsBackupService.flush(),this.userDiagnosticsMap.size>0&&Array.from(this.userDiagnosticsMap.values()).forEach((e=>{e.persistDiagnostics()}))}getLogsFiles(e){var t,n;return(0,c.mG)(this,void 0,void 0,(function*(){let i=[];if(this.userDiagnosticsMap.size>0){const t=Array.from(this.userDiagnosticsMap.values()).map((t=>null==t?void 0:t.getLogsFiles(e)));i=(0,Z.flatten)(yield Promise.all(t))}const a="No logs found",o="Logging of this type is not enabled";let r="",s="",l=(yield this.errorDiagnosticsEvents.getAllEvents())||[];l=(e?W(l):l).reverse();let d=O(l.slice(0,this._defaultLatestErrorCount));d&&(d=`Latest errors for ${this.userID}\r\n${d}`),this.isErrorDiagnosticsEnabled?((null===(t=this.host)||void 0===t?void 0:t.localStorage)&&(s=G(this.host.localStorage,H(this.userID,!0),!!e)||a),r=O(l)):(s=o,r=o);let c="";(null===(n=this.host)||void 0===n?void 0:n.localStorage)&&(c=G(this.host.localStorage,H(this.userID),!!e)||a);const u=yield this.getDiagnosticsLogs(!!e),m=this.userID?`${this.userID}-`:"";return Promise.resolve([{isPiiFree:!1,fileName:`${m}diagnostics-error-logs-previous-session.txt`,content:s||a},{isPiiFree:!1,fileName:`${m}diagnostics-logs-previous-session.txt`,content:c||a},{isPiiFree:!1,fileName:`${m}diagnostics-error-logs.txt`,content:r||a},{isPiiFree:!1,fileName:`${m}diagnostics-logs.txt`,content:u||a},{isPiiFree:!1,fileName:"latestErrors",content:d},...i])}))}getSystemInfo(){return Promise.resolve(new Map)}get loggerSettings(){return this._loggerSettings}setWorkerLogsDataManager(e){"setWorkerLogsDataManager"in this.diagnosticsEvents&&this.diagnosticsEvents.setWorkerLogsDataManager(e)}setDiagnosticsBackupEnabled(e,t){var n,i,a;this.diagnosticsBackupEnabled=e,e?!this.diagnosticsBackupService&&(null===(n=this.host)||void 0===n?void 0:n.opener)&&(null===(i=this.host)||void 0===i?void 0:i.setTimeout)&&(null===(a=this.host)||void 0===a?void 0:a.clearTimeout)&&(this.diagnosticsBackupService=new Y(this.host.opener,this.host.setTimeout,this.host.clearTimeout,t)):this.diagnosticsBackupService&&(this.diagnosticsBackupService.dispose(),this.diagnosticsBackupService=void 0)}getDiagnosticsLogs(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=yield this.getDiagnosticsEvents(),n=O(e?W(t):t),i=`Note: only ${this.memoryBufferArraySize||2e3} most recent logs are guaranteed to be shown due to the way logs are stored. Previous logs may have been removed\n`;return n?i+n:n}))}attemptToSetHost(){try{this.host=(0,Q.J)()}catch(e){}}persistDiagnosticsAsPreviousSessionLogs(){var e;if(null===(e=this.host)||void 0===e?void 0:e.localStorage){const e=this.experienceName===this.rwcExperienceName?this.userID:void 0,t=this.experienceName===this.rwcExperienceName?this.sessionId:void 0,n=this.diagnosticsEvents.getBufferedEvents();n.length>0&&L(this.host.localStorage,n,H(e),t);const i=this.errorDiagnosticsEvents.getBufferedEvents();i.length>0&&L(this.host.localStorage,i,H(e,!0),t)}}loadDiagnosticsFromLocalStorage(e=!0){var t;if((null===(t=this.host)||void 0===t?void 0:t.localStorage)&&this.experienceName!==this.rwcExperienceName){const t=this.scenarioFactory.newScenario(ee.RG.DiagnosticsGetLogsFromLocalStorage);try{U(this.diagnosticsEvents,this.host.localStorage,$(),e),U(this.errorDiagnosticsEvents,this.host.localStorage,$(void 0,!0),e),null==t||t.stop()}catch(e){const n=`DiagnosticsService: Failed to load persisted logs from store with error: ${e}`;this.pushDiagnosticsEvent(D.i.Error,n,!0),null==t||t.fail({reason:n})}}}cleanLogsStorage(){return Promise.all([this.diagnosticsEvents.handleUserLogout(),this.errorDiagnosticsEvents.handleUserLogout()]).then()}updateSettingsForLogger(e){this._loggerSettings.durationForCountingLogLines=this.validateSettingValue(e.durationForCountingLogLines,this._minDurationForCountingLogLines,this._loggerSettings.durationForCountingLogLines),this._loggerSettings.throttleCapacity=this.validateSettingValue(e.throttleCapacity,this._minThrottleWindowCapacity,this._loggerSettings.throttleCapacity),this._loggerSettings.throttleWindowSize=this.validateSettingValue(e.throttleWindowSize,this._minThrottleWindowSize,this._loggerSettings.throttleWindowSize),this._loggerSettings.isUserEnableIDBLogs=e.isUserEnableIDBLogs,this._loggerSettings.diagnosticsLogsThrottling=e.diagnosticsLogsThrottling,void 0===this.userECSConsoleLogLevel&&void 0!==e.consoleLogLevel&&null!==e.consoleLogLevel&&(this._loggerSettings.consoleLogLevel=e.consoleLogLevel)}validateSettingValue(e,t,n){return 0===e||e>=t?e:n}validateConsoleLogLevel(e){if(Object.keys(D.i).includes(e))return D.i[e]}}var re;!function(e){e[e.None=0]="None",e[e.LoggedInConsole=1]="LoggedInConsole",e[e.AddedIntoDiagnostics=2]="AddedIntoDiagnostics",e[e.ThrottledForDiagnostics=4]="ThrottledForDiagnostics",e[e.SentToTelemetry=8]="SentToTelemetry"}(re||(re={}));var se=n(21826),le=n(95868),de=n(25686);class ce{constructor(){this.debugLogging=""}initialize(e){this.logger=e,this.logger.debug("Telemetry Utility-Service initialized")}static getInstance(){return this.instance}}function ue(){return ce.getInstance()}ce.instance=new ce;var me=n(5102);class ge{constructor(e,t,n="",i=""){var a;this.diagnosticsService=e,this.label=t,this.contextId=n,this.userContextId=i,this.enableDebugLogging=!1,this.cidLabel="",this.currentLogLinesCount=0,this.lastTimeMarkerSinceCountingLogLines=0,this.totalLogLinesCount=0,this.totalThrottledCount=0,this.throttleAllowance=0,this.currentWindow=0,this.throttledCount=0;try{const e=(0,Q.J)();ue().debugLogging||(ue().debugLogging=null!==(a=e.localStorage.getItem("localDebug"))&&void 0!==a?a:"default"),this.enableDebugLogging="true"===ue().debugLogging}catch(e){}this.cidLabel=n?n.concat(" ",t):t}log(e,...t){return this.invoke(console.log,e,D.i.Info,!1,...t)}warn(e,...t){return this.invoke(console.warn,e,D.i.Warn,!1,...t)}error(e,...t){return this.invoke(console.error,e,D.i.Error,!1,...t)}debug(e,...t){return this.enableDebugLogging||this.consoleLogLevel>=D.i.Debug?this.invoke(console.debug,e,D.i.Debug,!1,...t):re.None}logNoPii(e,...t){return this.invoke(console.log,e,D.i.Info,!0,...t)}warnNoPii(e,...t){return this.invoke(console.warn,e,D.i.Warn,!0,...t)}errorNoPii(e,...t){return this.invoke(console.error,e,D.i.Error,!0,...t)}debugNoPii(e,...t){return this.enableDebugLogging||this.consoleLogLevel>=D.i.Debug?this.invoke(console.debug,e,D.i.Debug,!0,...t):re.None}errorToTelemetry(e,t,n,i){return this.toTelemetry(console.error,e,t,D.i.Error,n,i)}warnToTelemetry(e,t,n,i){return this.toTelemetry(console.warn,e,t,D.i.Warn,n,i)}debugToTelemetry(e,t,n,i){return this.toTelemetry(console.debug,e,t,D.i.Debug,n,i)}infoToTelemetry(e,t,n,i){return this.toTelemetry(console.log,e,t,D.i.Info,n,i)}sendToConsoleAndDiagnosticLogs(e,t,n,i,a,o,...r){let s=re.None;if((n<=this.consoleLogLevel||this.enableDebugLogging)&&(e.call(console,o?`${o}: ${t}`:t,...r),s=(0,de.Kx)(s,re.LoggedInConsole)),i){if(this.increaseLogCount(),(null==r?void 0:r.length)>0){const e=r.map((e=>(0,R.XC)(e))).join(", ");t=(0,R.LQ)(`${t} ${e}`)}n===D.i.Error||this.diagnosticsService.loggerSettings.isUserEnableIDBLogs||!this.doThrottle()?(this.diagnosticsService.pushDiagnosticsEvent(n,t,a),s=(0,de.Kx)(s,re.AddedIntoDiagnostics)):(this.totalThrottledCount++,this.throttledCount++,[E.gG.Enabled,E.gG.EnabledQuiet].includes(this.diagnosticsService.loggerSettings.diagnosticsLogsThrottling)||this.diagnosticsService.pushDiagnosticsEvent(n,t,a),s=(0,de.Kx)(s,re.ThrottledForDiagnostics))}return s}toTelemetry(e,t,n,i,a,o=!1){t=(0,R.LQ)(`${t}`),(null==a?void 0:a.message)&&(t=(0,R.LQ)(`${t} ${a.message}`));const r=this.sendToConsoleAndDiagnosticLogs(e,t,i,o,!0,this.cidLabel);return(a=a||{}).message=t,a.logLevel=D.i[i],a.contextId=this.contextId,(0,le.MI)(this.label,a,n.toString(),void 0,void 0,this.userContextId),(0,de.Kx)(r,re.SentToTelemetry)}invoke(e,t,n,i,...a){t=(0,R.LQ)(`${this.cidLabel}: ${t}`);let o=this.sendToConsoleAndDiagnosticLogs(e,t,n,n<D.i.Debug||n<=this.consoleLogLevel,i,"",...a);if((null==a?void 0:a.length)>0){const e=a.map((e=>(0,R.XC)(e))).join(", ");t=(0,R.LQ)(`${t} ${e}`)}if(n===D.i.Error){const e={contextId:this.contextId,message:(0,me.A)(t)};(0,le.P3)(se.x.Logging,this.label,e,void 0,void 0,void 0,this.userContextId),o=(0,de.Kx)(o,re.SentToTelemetry)}return o}increaseLogCount(){if(0===this.lastTimeMarkerSinceCountingLogLines&&(this.lastTimeMarkerSinceCountingLogLines=Date.now()),this.currentLogLinesCount++,this.totalLogLinesCount++,this.diagnosticsService.loggerSettings.durationForCountingLogLines>0&&this.currentLogLinesCount>=this.diagnosticsService.loggerSettings.durationForCountingLogLines){if(0===this.currentLogLinesCount)return;const e=this.currentLogLinesCount;this.currentLogLinesCount=0;const t=Date.now(),n=this.generateEventName();(0,le.MI)(`${n} - ${this.diagnosticsService.loggerSettings.durationForCountingLogLines.toString()}`,{delta:t-this.lastTimeMarkerSinceCountingLogLines,actualItemCount:e,totalRequestTime:this.totalLogLinesCount},"webclient_framework_logs_statistics_event",void 0,void 0),this.lastTimeMarkerSinceCountingLogLines=t}}doThrottle(){const e=this.diagnosticsService.loggerSettings;if(e.diagnosticsLogsThrottling===E.gG.Disabled||0===e.throttleCapacity)return!1;const t=Date.now();return t-this.currentWindow>e.throttleWindowSize&&(this.sendThrottledCount(),this.currentWindow=t,this.throttleAllowance=e.throttleCapacity,this.throttledCount=0),this.throttleAllowance<1||(this.throttleAllowance-=1,!1)}sendThrottledCount(){if(this.throttledCount<1)return;if([E.gG.DryRun,E.gG.Enabled].includes(this.diagnosticsService.loggerSettings.diagnosticsLogsThrottling)){const e=this.diagnosticsService.loggerSettings.diagnosticsLogsThrottling===E.gG.DryRun?"would have been throttled":"were throttled",t=`${this.cidLabel}: ${this.throttledCount} logs ${e} from ${new Date(this.currentWindow).toISOString()}`;this.diagnosticsService.pushDiagnosticsEvent(D.i.Info,t,!0)}const e=this.generateEventName();(0,le.MI)(`${e} - ${this.diagnosticsService.loggerSettings.throttleWindowSize.toString()} - ${this.diagnosticsService.loggerSettings.throttleCapacity.toString()}`,{actualItemCount:this.throttledCount,dataBlockedTime:this.totalThrottledCount,totalRequestTime:this.totalLogLinesCount},"webclient_framework_logs_throttle_event",void 0,void 0)}generateEventName(){let e=this.label;return 0===e.indexOf("ScenarioFactory-")&&(e="ScenarioFactory_GUID"),e}get consoleLogLevel(){const e=this.diagnosticsService.loggerSettings.consoleLogLevel;return void 0===e?D.i.Warn:e}}class pe{constructor(e,t,n=""){this.diagnosticsService=e,this.contextId=t,this.userContextId=n,this.newLogger=e=>{e=(0,R.LQ)(`${e}`);return new ge(this.diagnosticsService,e,this._contextId,this.userContextId)},this._contextId=t&&"00000000-0000-0000-0000-000000000000"!==t?(0,R.LQ)(`CID[${t}]`):""}get cID(){return this.contextId}}var he=n(38923),ve=n(50103),Se=n(31064),fe=n(60782);const ye=(e,t,n,i)=>(0,g.z)((0,Se.fU)(((n,a)=>(0,c.mG)(void 0,void 0,void 0,(function*(){return function(e,t,n,i){return(0,c.mG)(this,void 0,void 0,(function*(){const a=e[Symbol.iterator](),o=t[Symbol.iterator]();let r=a.next(),s=o.next();const l=[];for(;!s.done||!r.done;)s.done||!r.done&&s.value.id>r.value[0].id?(yield i(r.value[1]),r=a.next()):r.done||s.value.id<r.value[0].id?(l.push([s.value,n(s.value)]),s=o.next()):(l.push([s.value,r.value[1]]),r=a.next(),s=o.next());return l}))}(n,Array.from(a).sort(((e,t)=>e.id.localeCompare(t.id))),(t=>ke(t,e,i)),(e=>Ce(e,t)))}))),[]),(0,h.U)((e=>be(e,n))),(0,fe.b)((e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const t=yield e;return Promise.all(t)}))))),ke=(e,t,n)=>(0,c.mG)(void 0,void 0,void 0,(function*(){try{return{type:"value",value:yield t(e)}}catch(t){return n&&n(e,t),{type:"error",error:t}}})),Ce=(e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const n=yield e;if("error"!==n.type)return t(Promise.resolve(n.value))})),be=(e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const n=[],i=yield Promise.all(e);for(const e of i){const i=yield e[1];"value"===i.type&&n.push(t(e[0],Promise.resolve(i.value)))}return n}));var Te=n(95808),we=n(82044);const _e=e=>e instanceof Te.xQ?e.asObservable():e instanceof we.y?e:new we.y((t=>e.subscribe(t)));var Ie=n(84361);var Ae=n(16552),Ne=n(37182);function Ee(e){return Object.keys(e).reduce(((t,n)=>(t[n]=function(e){const t=(0,Ne.QS)(e);return{update:e=>t(e),read:()=>t()}}(e[n]),t)),{})}const De=new Set([Ae.ab,Ae.Xt]);class Fe{constructor(e,t,n){this._logger=e.newLogger("ReactiveValuesService"),this._appViewStateForWindowMap=new Map,this._servicesAppsRegistry=t,this._config=n}getAppViewStateForWindow(e,t){var n;this._config.enableEmbedDataClient&&(e=_.ew);const i=null===(n=this._appViewStateForWindowMap.get(e))||void 0===n?void 0:n.get(t);if(!i){const n=this._servicesAppsRegistry.getAppByID(t);n&&"viewStateRegistration"in n&&n.viewStateRegistration&&this._logger.warn(`Unable to find appViewState for window ${e} app ${t}`)}return i}resetAllViewState(e){const t=this._appViewStateForWindowMap.get(e);t&&t.forEach(((e,t)=>{De.has(t)||this.resetViewStateForApp(t,e)}))}setReactiveValuesForApp(e,t,n){var i;const a=null===(i=this._appViewStateForWindowMap.get(e))||void 0===i?void 0:i.get(t);if(a){const{navigationalReactiveValues:e,nonNavigationalReactiveValues:t}=a;Object.keys(n).forEach((i=>{let a=e[i];a||(a=t[i]),a.update(n[i])}))}}getRegisteredAppsTypePolicies(e){const t={typePolicies:{},defaultTypeName:[]};return this._appViewStateForWindowMap.set(e,new Map),this._servicesAppsRegistry.registeredApps.forEach((n=>{const i=n.manifest.id,a=n;if(a.viewStateRegistration){const{computedValues:n,navigationalFieldDefaultValues:o,nonNavigationalFieldDefaultValues:r,gqlTypeName:s,queryFieldName:l}=a.viewStateRegistration,d=Ee(o),c=Ee(r),u=this._appViewStateForWindowMap.get(e);null==u||u.set(i,{navigationalReactiveValues:d,nonNavigationalReactiveValues:c});const m=function(...e){const[t,n,i]=e,a={};for(const e of Object.keys(n)){const t=e,i=()=>n[t].read();a[t]={read:i}}if(i)for(const e of Object.keys(i)){const t=e,o=(e,a)=>{const{args:o}=a||{};return i[t](n,o)};a[t]={read:o}}return{[t]:{fields:a}}}(s,Object.assign(Object.assign({},d),c),n);t.typePolicies=Object.assign(Object.assign({},t.typePolicies),m),t.defaultTypeName.push({gqlTypeName:s,queryFieldName:l})}})),t}removeWindowViewState(e){this._appViewStateForWindowMap.delete(e)}resetViewStateForApp(e,t,n){const i=this._servicesAppsRegistry.getAppByID(e);if(i&&t&&"viewStateRegistration"in i&&i.viewStateRegistration){const{navigationalFieldDefaultValues:e,nonNavigationalFieldDefaultValues:a}=i.viewStateRegistration;Object.keys(e||{}).forEach((i=>{(null==n?void 0:n.includes(i))||t.navigationalReactiveValues[i].update(e[i])})),Object.keys(a).forEach((e=>{(null==n?void 0:n.includes(e))||t.nonNavigationalReactiveValues[e].update(a[e])}))}}}const Pe={[Ie.p.meetings]:["com.microsoft.teams.calling","com.microsoft.teams.meeting-options"]};class Me{constructor(e,t,n){this._loadedTasksMap=new Map,this._appIdToAppMap=void 0,this._logger=e.newLogger("AppsRegistryService"),this._loadedApps=[],this._entityTypeToAppMap=new Map,this.initialize(n),this._reactiveValuesService=new Fe(e,this,t)}get registeredApps(){return this._loadedApps}get registeredAppManifests(){return this._loadedApps.map((e=>e.manifest))}get registeredTasks(){return Array.from(this._loadedTasksMap.values())}getApp({entityType:e,renderMode:t}){if(e||t)return this.registeredApps.find((n=>(!e||function({supportedEntities:e},t){return!(!e||-1===e.indexOf(t))}(n.manifest,e))&&(!t||function({supportedRenderModes:e},t){return!(!e||-1===e.indexOf(t))}(n.manifest,t))))}getAppViewStateForWindow(e,t){return this._reactiveValuesService.getAppViewStateForWindow(e,t)}getAppByID(e){var t;return null===(t=this._appIdToAppMap)||void 0===t?void 0:t.get(e)}getPlatformAppIdForEntity(e){const t=this._entityTypeToAppMap.get(e.type);if(void 0===t)return void this._logger.error("getPlatformAppIdForEntity: Platform id requested for entity which has no registered app in this experience.",{entityType:e.type});if(void 0===t.getPlatformAppIdForEntity)return void this._logger.debug("getPlatformAppIdForEntity: An app is registered for this entity but has no function for getPlatformAppIdForEntity.",{appName:t.manifest.name,entityType:e.type});let n;try{n=t.getPlatformAppIdForEntity(e)}catch(n){this._logger.error("getPlatformAppIdForEntity: Error caught from app handler while mapping the id for this entity.",{appName:t.manifest.name,entityType:e.type})}if(void 0!==n)return n;this._logger.debug("getPlatformAppIdForEntity: App mapped the id for this entity to undefined.",{appName:t.manifest.name,entityType:e.type})}getAppByActor(e){if(e)return this.registeredApps.find((t=>function({actors:e},t){return!(!e||-1===e.indexOf(t))}(t.manifest,e)))}getDefaultCommand(e){var t,n;const{coldBootAppId:i}=e.get(A.J.Edu),{coreColdBootAppId:a,enableEDUColdBootApp:o}=e.get(A.J.Core),r=o?i:a;if(r){this._logger.debug(`Using cold boot appId of ${r} with enableEDUColdBootApp ${o}`);const i=this.getAppByID(r),a=null===(n=null==i?void 0:(t=i.manifest).getDefaultCommand)||void 0===n?void 0:n.call(t,e);if(a)return a;this._logger.debug(`No default command found ${r}`)}for(const t of this.registeredAppManifests)if(t.getDefaultCommand){const n=t.getDefaultCommand(e);if(n)return this._logger.debug(`Found a default command in ${t.name}`),n}}resetAllViewState(e){this._reactiveValuesService.resetAllViewState(e)}setReactiveValuesForApp(e,t,n){this._reactiveValuesService.setReactiveValuesForApp(e,t,n)}getRegisteredAppsTypePolicies(e){return this._reactiveValuesService.getRegisteredAppsTypePolicies(e)}removeWindowViewState(e){this._reactiveValuesService.removeWindowViewState(e)}registerTask(e){this._loadedTasksMap.set(e.id,e)}initialize(e){const t=new Map;if(!(e&&e.length>0))throw new Error(`initialize::${_.jK.Empty} - No apps registered`);e.forEach((e=>{var n;if(t.has(e.manifest.id))throw new Error(`Multiple apps found for appId ${e.manifest.id}`);t.set(e.manifest.id,e),null===(n=e.manifest.supportedEntities)||void 0===n||n.forEach((t=>{const n=Pe[t];if(!n||!n.includes(e.manifest.id)){if(this._entityTypeToAppMap.has(t))throw new Error(`Multiple apps found for entity ${t}`);this._entityTypeToAppMap.set(t,e)}})),e.onRegister&&e.onRegister({registerTask:this.registerTask.bind(this)})})),this._loadedApps=Array.from(t.values()),this._appIdToAppMap=t}}var je=n(12345);class Re extends je.G{constructor({code:e,taskName:t,prevError:n,dependencies:i,message:a}){super({type:"TaskError",code:e,prevError:n,message:a}),this.taskName=t,this.missingDependencies=i}static fromExecutionError(e,t){return new Re({code:"EXECUTION_FAILURE",taskName:e,prevError:t})}static fromMissingDependencies(e,t){return new Re({code:"MISSING_DEPENDENCIES",taskName:e,dependencies:t,message:`${JSON.stringify(t)} are required, but not initialized.`})}getBoundaryProps(){return"EXECUTION_FAILURE"===this.code&&this.prevError instanceof je.G?this.prevError.getBoundaryProps():super.getBoundaryProps()}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{taskName:this.taskName,prevError:this.prevError,missingDependencies:JSON.stringify(this.missingDependencies)})}toTelemetryCode(){var e;return`[${this.type}::${this.taskName}::${this.code}::${null===(e=this.missingDependencies)||void 0===e?void 0:e.join()}]`}static fromSerialized(e){if("TaskError"!==(null==e?void 0:e.type))return null;const t=new Re({code:e.code,taskName:e.taskName,prevError:e.prevError,dependencies:e.dependencies});return t.deserialize(e),t}}class xe{constructor(e,t){this.id=e,this.name=_.Yg[e],this.dependencies=t}executeSafe(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){const n=[];for(const t of this.dependencies)null==e[t]&&n.push(t);if(n.length>0)throw Re.fromMissingDependencies(this.name,n);try{return yield this.execute(e,t)}catch(e){throw Re.fromExecutionError(this.name,e)}}))}}var Oe=n(25118);class Le{constructor(e,t,n,i,a,o,r,s,l,d,c,u){this._loggerFactory=e,this._appsRegistryService=t,this._config=n,this._configLoader=i,this._coreTasks=o,this._diagnosticsService=r,this._logsCollectorService=s,this._waitForRenderingContextReady=l,this._isEntityInView=d,this._criticalDynamicImports=c,this._getPlatformConfigurationOverrides=u,this._logger=e.newLogger("TaskManagerService"),this._appsRegistryService=t,this._taskContext=this.createNewContext(a)}notifyLifeCycleEvent(e,t={},n){var i,a;return(0,c.mG)(this,void 0,void 0,(function*(){const o=this.extractApplicableTasks(this._appsRegistryService.registeredTasks,e);this._logger.log(`notify::starting - lifeCycleEvent=${e}, taskCount=${o.length}`);const r=Object.assign(Object.assign({},this._taskContext),t);this.markCoreLifeCycleEventStart(r,e);const s={},l=null===(i=null===performance||void 0===performance?void 0:performance.timing)||void 0===i?void 0:i.navigationStart,d=new Map,c=[];let u=0;for(const t of o){const i=null===(a=null===performance||void 0===performance?void 0:performance.now)||void 0===a?void 0:a.call(performance),o=e=>{this._logger.error(`notify:: Task Execute Error - taskId ${_.Yg[t.id]}, code=${e.code} errorMsg=${(0,he.B9)((null==e?void 0:e.prevError)||e)}\n          .`),d.set(t.id,e)},m=()=>t instanceof xe?t.executeSafe(r,s):t.execute(r,s),g=e=>e?(0,Oe.E)(m(),e,`${_.Yg[t.id]} timed out.`):m(),p=yield g(this._config.coreTasksTimeoutMs).catch(o);p&&c.push({taskId:t.id,cleanupFn:p}),this.markCoreLifeCycleTaskCompleted(r,e,t,d,i,l,++u),null==n||n(t.id)}return this.handleErrors(e,d),this._logger.log(`notify::tasks complete - lifeCycleEvent=${e}, taskCount=${o.length}`),Object.assign(Object.assign(Object.assign({},s),r),{coreTaskErrors:Array.from(d.values()),cleanupFns:c})}))}destroyContext(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){const n=e.cleanupFns.length;let i,a=0;for(;i=e.cleanupFns.pop();)try{yield i.cleanupFn(t),a++}catch(e){this._logger.error(`Cleanup failed for task: ${_.Yg[i.taskId]}`)}this._logger.log(`destroyContext complete: ${a}/${n} tasks succeeded.`)}))}hasTasks(e){return this.extractApplicableTasks(this._appsRegistryService.registeredTasks,e).length>0}markCoreLifeCycleEventStart(e,t){var n,i,a;const o=null===(n=e.altScenarioService)||void 0===n?void 0:n.altScenario,r=null===(i=e.altScenarioService)||void 0===i?void 0:i.clientStartScenario,s=`${k}${t}`;o||r?(o&&o.mark(s),r&&r.mark(s)):null===(a=null===performance||void 0===performance?void 0:performance.mark)||void 0===a||a.call(performance,s)}markCoreLifeCycleTaskCompleted(e,t,n,i,a,o,r){var s,l,d;const c=null===(s=e.altScenarioService)||void 0===s?void 0:s.altScenario,u=null===(l=e.altScenarioService)||void 0===l?void 0:l.clientStartScenario,m=`${t}_${_.Yg[n.id]}`;c||u?(c&&c.mark(`core_task_${m}`),u&&u.mark(`core_task_${m}`)):null===(d=null===performance||void 0===performance?void 0:performance.mark)||void 0===d||d.call(performance,`${C}${m}`),this.addTaskDetailsToLocalStorage(i,a,o,m,n,r,e)}addTaskDetailsToLocalStorage(e,t,n,i,a,o,r){var s;try{const{windowProvider:l,config:d}=r;if(d.shouldTrackCoreInitTasks){const r=e.get(a.id)||{};null==l||l.localStorage.setItem(i,(0,R.u4)({index:o,startTime:new Date(n+t).toISOString(),duration:(null===(s=null===performance||void 0===performance?void 0:performance.now)||void 0===s?void 0:s.call(performance))-t,error:r}))}}catch(e){e.code===DOMException.QUOTA_EXCEEDED_ERR?this._logger.error("Error: Quota exceeded while writing core task details to local storage."):this._logger.warn(`Couldn't write core init task details to local storage: ${(0,he.B9)(e)}`)}}createNewContext(e){return{correlation:e,diagnosticsService:this._diagnosticsService,logsCollectorService:this._logsCollectorService,loggerFactory:this._loggerFactory,appsRegistryService:this._appsRegistryService,config:this._config,configLoader:this._configLoader,waitForRenderingContextReady:this._waitForRenderingContextReady,isEntityInView:this._isEntityInView,criticalDynamicImports:this._criticalDynamicImports,getPlatformConfigurationOverrides:this._getPlatformConfigurationOverrides}}extractApplicableTasks(e,t){var n,i;const a=[];if(e){const n=e.filter((e=>!e.lifeCycleSubscriptions&&t===_.sM.Initialization||e.lifeCycleSubscriptions&&-1!==e.lifeCycleSubscriptions.indexOf(t)));a.push(...n)}return((null===(i=(n=this._coreTasks)[t])||void 0===i?void 0:i.call(n))||[]).concat(a)}handleErrors(e,t){if(t.size>0){const n=(0,he.Tr)("TaskManagerService",_.jK.NotInitialized,`lifeCycleEvent=${e}`,{failedTaskErrors:t});this._logger.error(`Failed ${t.size} core tasks: ${Array.from(t.keys()).map((e=>_.Yg[e])).join()}, lifeCycleEvent=${e}: `,n)}}}const Ue={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"windowOptionsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowOptions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"left"}},{kind:"Field",name:{kind:"Name",value:"top"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]},Be={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subNavEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"headerEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"startEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"clientLaunchId"}}]}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}},{kind:"Field",name:{kind:"Name",value:"isInitialWindowStateHidden"}},{kind:"Field",name:{kind:"Name",value:"userContextId"}},{kind:"Field",name:{kind:"Name",value:"layoutConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"layoutMode"}}]}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"windowOptionsFields"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"entityFieldsForActiveWindows"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"windowOptionsFields"}}]}}]}},...Ue.definitions]}.definitions,...Ue.definitions]},We={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"authenticationUsersEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsersEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cloud"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"puid"}}]}},{kind:"Field",name:{kind:"Name",value:"subType"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"loginUserName"}}]}}]}}]}}]},Ge={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationUsers"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserFilter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cloud"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"puid"}}]}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"subType"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"loginUserName"}}]}}]}}]};var Ve=n(21580);const He={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindowForEntity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindowForEntity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindow"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindow"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"entityFieldsForActiveWindow"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}}]}}]};var $e=n(52138),ze=n(52058),qe=n(60025),Je=n(24211),Qe=n(40797),Ke=n(35228);const Ye={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"executeEntityCommand"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"executionContext"}},type:{kind:"NamedType",name:{kind:"Name",value:"ExecutionContextInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"command"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityCommandInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clientLaunchId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"WindowOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"executeEntityCommand"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}},{kind:"Argument",name:{kind:"Name",value:"executionContext"},value:{kind:"Variable",name:{kind:"Name",value:"executionContext"}}},{kind:"Argument",name:{kind:"Name",value:"command"},value:{kind:"Variable",name:{kind:"Name",value:"command"}}},{kind:"Argument",name:{kind:"Name",value:"clientLaunchId"},value:{kind:"Variable",name:{kind:"Name",value:"clientLaunchId"}}},{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"entityOptions"},value:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}}},{kind:"Argument",name:{kind:"Name",value:"windowOptions"},value:{kind:"Variable",name:{kind:"Name",value:"windowOptions"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};function Xe(e){return Object.assign(Object.assign({},e),{id:(t=e,t&&t.id||(0,Je.v4)()),startTimestamp:Ze(e),source:(null==e?void 0:e.source)||I.D.StandAlone});var t}function Ze(e){return e&&e.startTimestamp||Date.now()}function et({appName:e,commandChangeReportingService:t,entityCommand:n,getCommandScenarioName:i,logger:a,coreSettings:o}){const r=n.command.correlation,s=void 0===r.scenarioName||r.scenarioName===ee.RG.EntityCommand;if(i&&s){try{r.scenarioName=i(n,a,o)}catch(n){t.report({type:Qe.B.Failure,context:{errorInfo:Ke.y.GetCommandScenarioNameHookFailed,errorMessage:`App ${e} failed to execute entity command hook GetCommandScenarioName with ${n.name}`,target:"internal-command-handler"},correlationId:r.id})}a.log(`App ${e} is overwriting default scenario name to ${r.scenarioName} for command with entityType ${n.entity.type}`)}}function tt(e){return Object.assign(Object.assign({},e),{command:nt(e.command)})}function nt(e){return Object.assign(Object.assign({},e),{correlation:Xe(e.correlation)})}function it(e,t,n){var i;return(0,c.mG)(this,void 0,void 0,(function*(){try{const n=yield t.query({query:He,variables:{entity:e},fetchPolicy:"no-cache"});return null===(i=n.data.activeWindowForEntity)||void 0===i?void 0:i.id}catch(t){return void n.error(`query for entity failed. Entity: ${JSON.stringify(e)}, Error: ${t}`)}}))}function at(e,t,n){const i=t.getValue().find((t=>t.id===e)),a=!(!i||!i.window.document.hasFocus()),o=n.getState(),r=o===Ve.pk.LongInactive||o===Ve.pk.Inactive;return a&&!r}function ot(e){return t=e,n=function(e,t){return{ADD_ATTR:e,ADD_TAGS:t,RETURN_TRUSTED_TYPE:!0,WHOLE_DOCUMENT:!0}}(["content","focusable","nonce","onclick"],["link","meta","script","#comment","!doctype"]),(0,$e.sanitize)(t,n);var t,n}function rt(e){var t,n;return[null!==(t=null==e?void 0:e.findScenario(ee.RG.ClientStart))&&void 0!==t?t:null,null!==(n=null==e?void 0:e.findScenario(ee.RG.ExperienceReady))&&void 0!==n?n:null]}function st(e,t){return e instanceof je.G?e:new ze.G(ze.$.UNKNOWN,e,t)}function lt(e,t,n,i){return dt.bind(void 0,e,t,n,i)}function dt(e,t,n,i){var a,o;return(0,c.mG)(this,void 0,void 0,(function*(){let r="";const s=null==e?void 0:e.host;s&&(r=`SessionId:\t${s.sessionId}\r\nDeviceId:\t${s.deviceId}\r\nHostVersion:\t${s.hostAppVersion}\r\n`);const l=null==e?void 0:e.config;l&&(r=`${r}WebVersion:\t${null==l?void 0:l.clientVersion}\r\n`);const d=null==t?void 0:t.locale;d&&(r=`${r}Language:\t${d}\r\n`);const c=null==i?void 0:i.get(A.J.Metadata);(null===(a=null==c?void 0:c.ring)||void 0===a?void 0:a.id)&&(r=`${r}Ring:\t${c.ring.id}\r\n`);const u=yield null===(o=null==n?void 0:n.getCachedUsers)||void 0===o?void 0:o.call(n,Object.assign(Object.assign({},Xe({source:I.D.Core})),{scenarioName:ee.RG.AuthWebCachedUser}));if(null==u?void 0:u.length){r=`${r}Logged in users:\r\n`;for(const e of u)r=`${r}\t${e.userName}  ${e.profile.name}  TId:${e.profile.tid}  OId:${e.profile.oid}  UserId:${e.id}\r\n`}return r}))}var ct=n(42652);const ut=new Set([l.quit,l.restart]);function mt({hostCommunicationService:e,logger:t,reason:n,renderingContextManager:i}){return(0,c.mG)(this,void 0,void 0,(function*(){let a;const o=i.getDefaultRenderingContext();switch((null==o?void 0:o.scenarioFactory)&&(a=pt(n,o.scenarioFactory)),n){case"quit":try{yield i.removeAllRenderingContexts(n),null==a||a.mark(ee.ck.RemoveAllRenderingContexts),yield function(e,t,n){var i;return(0,c.mG)(this,void 0,void 0,(function*(){let a,o;try{a=yield t.loadModule("core")}catch(e){o="LoadModuleCoreFailed"}try{yield null===(i=null==a?void 0:a.reportReadyToQuit)||void 0===i?void 0:i.call(a)}catch(e){o="ReportReadyToQuitFailed"}o&&St(o,e,n)}))}(t,e,a),null==a||a.stop()}catch(e){vt(e,t,a)}break;case"restart":try{yield i.cleanupWithPriority(n),null==a||a.stop()}catch(e){vt(e,t,a)}break;default:return}}))}function gt({coreSettings:e,logger:t,reason:n,renderingContextManager:i,user:a}){return(0,c.mG)(this,void 0,void 0,(function*(){let o;try{const t=a&&(0,qe.b)(a);if(!t)throw new ze.G(ze.$.CLEANUP,new Error("signout::UserContextIdNotFound"));const r=yield i.getUserRenderingContext(t);(null==r?void 0:r.scenarioFactory)&&(o=pt(n,r.scenarioFactory)),yield i.removeUserRenderingContext(n,t),null==o||o.mark(ee.ck.RemoveUserRenderingContext);if(!e.get(A.J.Auth).isLegacyCleanupCodeFlag){const e=["TestCookie","ringFinder"];!function(e){try{(0,Q.J)().sessionStorage.clear()}catch(t){ht(e,"ClearSessionStorageFailed")}}(o),function(e,t){try{Object.keys(ct.getJSON()).forEach((t=>{e.includes(t)||ct.remove(t)}))}catch(e){ht(t,"DeleteCookiesFailed")}}(e,o)}null==o||o.stop()}catch(e){vt(e,t,o)}}))}function pt(e,t){const n=t.newScenario(ee.RG.CoreCleanup),i={reason:e};return n.appendEventData(i),n}function ht(e,t){const n={errorCode:t};e&&e.fail(n)}function vt(e,t,n){let i;i=e instanceof ze.G?e.toTelemetryEntry():e instanceof Error?`${ze.$.CLEANUP}::UnknownCleanupFailure::${null==e?void 0:e.name}::${null==e?void 0:e.message}`:`${ze.$.CLEANUP}::UnknownCleanupFailure::${(0,R.u4)(e)}`,St(i,t,n)}function St(e,t,n){var i;n&&ht(n,e),null===(i=t.errorToTelemetry)||void 0===i||i.call(t,e,"webclient_framework_foundation_core_services",void 0,!0)}var ft=n(41656),yt=n(67424),kt=n(1894),Ct=n(45092),bt=n(54808),Tt=n(43768);class wt{constructor(e,t,n){this.eventHandler=e,this.commandHandler=t,this.commandDelegator=n}bubble(e){return this.eventHandler(e,this.commandHandler,this.commandDelegator)}}var _t=n(14);const It=new Set([Ae.ab,Ae.Xt]),At=e=>"viewStateRegistration"in e,Nt=e=>It.has(e.manifest.id),Et=e=>{var t,n,i,a,o,r,s;return null!==(r=null!==(a=null!==(n=null===(t=e.current)||void 0===t?void 0:t.subNavEntity)&&void 0!==n?n:null===(i=e.current)||void 0===i?void 0:i.headerEntity)&&void 0!==a?a:null===(o=e.current)||void 0===o?void 0:o.startEntity)&&void 0!==r?r:null===(s=e.current)||void 0===s?void 0:s.mainEntity};const Dt="internal-event-handler",Ft=({commandChangeReportingService:e,correlation:t,type:n})=>{switch(n){case Qe.B.DelegatedCommandReceived:e.report({type:n,correlationId:t.id,context:{target:Dt,correlation:t}});break;default:e.report({type:n,correlationId:t.id,context:{target:Dt}})}},Pt=({commandChangeReportingService:e,correlation:t,errorInfo:n=Ke.y.DelegatedCommandError,errorMessage:i,logger:a})=>{var o;null===(o=a.errorToTelemetry)||void 0===o||o.call(a,i,"webclient_framework_foundation_core_services_internal_command_delegator",void 0,!0),e.report({correlationId:t.id,type:Qe.B.Failure,context:{target:Dt,errorMessage:i,errorInfo:n}})};var Mt=n(79729);const jt=({appsRegistryService:e,client:t,commandChangeReportingService:n,commandHandler:i,commandInput:a,coreSettings:o,executionContext:r,loggerFactory:s,scenarioFactory:l,windowId:d,host:u,userBiService:m})=>(0,c.mG)(void 0,void 0,void 0,(function*(){const g=s.newLogger("internalCommandDelegator"),p=a.correlation||Xe();Ft({commandChangeReportingService:n,correlation:p,type:Qe.B.DelegatedCommandReceived});const h=function(e,t){return e.getAppByActor(t.command.actor)}(e,a);if(!h){const e=`Command for actor ${a.command.actor} does not map to any registered app.`;return Pt({commandChangeReportingService:n,correlation:p,errorMessage:e,logger:g}),Promise.resolve(void 0)}if(!h.onCommandReceived){const e=`Command for actor ${a.command.actor} maps to app ${h.manifest.name}, but the app hasn't registered onCommandReceived handler.`;return Pt({commandChangeReportingService:n,correlation:p,errorMessage:e,logger:g}),Promise.resolve(void 0)}const{navigationalReactiveValues:v,nonNavigationalReactiveValues:S}=e.getAppViewStateForWindow(d||_.ew,h.manifest.id)||{};let f=!1,y={};v&&(y=Object.keys(v).reduce(((e,t)=>{const n=v[t];return Object.assign(Object.assign({},e),{[t]:{read:n.read,update:e=>{e!==n.read()&&(n.update(e),f=!0)}}})}),{}));const k=function(e,t,n,i,a,{viewEntitiesRef:o,viewEntity:r}={},s){var l,d,c;const u=o&&Et(o);return{client:e,coreSettings:t,loggerFactory:n,scenarioFactory:i,executionContext:{viewEntities:{endEntity:null===(l=null==o?void 0:o.current)||void 0===l?void 0:l.endEntity,mainEntity:null===(d=null==o?void 0:o.current)||void 0===d?void 0:d.mainEntity},viewEntity:r,isHandlingAppActiveApp:!!u&&(null===(c=a.getApp({entityType:u.type}))||void 0===c?void 0:c.manifest.id)===s}}}(t,o,s,l,e,r,h.manifest.id);let C;try{const e={commandInput:a,requestContext:k};Ft({commandChangeReportingService:n,correlation:p,type:Qe.B.BeforeOnCommandReceived});const i=Object.assign(Object.assign({},y),S);C=yield(({delegatedApp:e,reactiveValues:t,hookOptions:n,host:i,windowId:a,userBiService:o})=>(0,c.mG)(void 0,void 0,void 0,(function*(){if(!e.onCommandReceived)return Promise.resolve(void 0);if(At(e)&&Nt(e)){if(t){const r=Object.assign(Object.assign({},n),{appViewState:t,host:i,slotDimensionsOptions:_t.Vi,windowId:a,userBiService:o});return e.onCommandReceived(r)}}else{if(!At(e)){if(Nt(e)){const t=Object.assign(Object.assign({},n),{windowId:a,slotDimensionsOptions:_t.Vi});return e.onCommandReceived(t)}return e.onCommandReceived(n)}if(t){const i=Object.assign(Object.assign({},n),{appViewState:t});return e.onCommandReceived(i)}}return Promise.resolve(void 0)})))({delegatedApp:h,reactiveValues:i,hookOptions:e,host:u,windowId:d,userBiService:m}),f&&(t.mutate({mutation:Mt.E,variables:{windowId:d,appIds:[h.manifest.id]}}).catch((e=>{g.warn(`saveReactiveVarToHistory failed ${e.message}`)})),f=!1),Ft({commandChangeReportingService:n,correlation:p,type:Qe.B.AfterOnCommandReceived})}catch(e){const t=`Command for actor ${a.command.actor} encountered an error inside onCommandReceived of ${h.manifest.name}.`;return Pt({commandChangeReportingService:n,correlation:p,errorMessage:t,logger:g}),Promise.reject(e)}if(!C)return Ft({correlation:p,commandChangeReportingService:n,type:Qe.B.CommandHandledByOnCommandReceived}),Promise.resolve(void 0);const b=Object.assign(Object.assign({},C),{command:Object.assign(Object.assign({},C.command),{correlation:p})});i(b)}));var Rt=n(89925);const xt="internal-event-handler",Ot=({commandChangeReportingService:e,correlation:t,type:n})=>{switch(n){case Qe.B.EventBubbled:e.report({type:n,correlationId:t.id,context:{target:xt,correlation:t}});break;default:e.report({type:n,correlationId:t.id,context:{target:xt}})}},Lt=({commandChangeReportingService:e,correlation:t,errorMessage:n,logger:i})=>{var a;const o=Ke.y.EventError;null===(a=i.errorToTelemetry)||void 0===a||a.call(i,n,"webclient_framework_foundation_core_services_internal_event_handler",void 0,!0),e.report({correlationId:t.id,type:Qe.B.Failure,context:{target:xt,errorMessage:n,errorInfo:o}})},Ut=({appsRegistryService:e,client:t,commandChangeReportingService:n,commandDelegator:i,commandHandler:a,coreSettings:o,eventInput:r,executionContext:s,loggerFactory:l,scenarioFactory:d,userBiService:u,windowId:m})=>(0,c.mG)(void 0,void 0,void 0,(function*(){var g;const p=l.newLogger("internalEventHandler");let h=function(e,t){var n;return t?t&&e.getApp({entityType:null===(n=t.viewEntity)||void 0===n?void 0:n.type}):e.getAppByID(Ae.ab)}(e,s);const v=((e,t,n,i)=>{var a;const{scenarioName:o,id:r,source:s}=(null===(a=null==t?void 0:t.getEventScenarioData)||void 0===a?void 0:a.call(t,e,i))||{},l=Xe({id:r,scenarioName:o,source:s,startTimestamp:Date.now()});return Ot({commandChangeReportingService:n,correlation:l,type:Qe.B.EventBubbled}),l})(r,h,n,p);if("com.microsoft.teams.search"===(null==h?void 0:h.manifest.id)&&"MeControl"===r.event.originator&&(h=e.getApp({renderMode:Rt.AppRenderMode.TitleBar})),!h){return Lt({commandChangeReportingService:n,correlation:v,errorMessage:"Error mapping event to slot.",logger:p}),Promise.resolve(void 0)}if(!(null===(g=h.eventHandlers)||void 0===g?void 0:g.onEventReceived)){const e=`Event '${r.event.type}' was received for app ${h.manifest.name}, but it hasn't registered an event handler.`;return Lt({commandChangeReportingService:n,correlation:v,errorMessage:e,logger:p}),Promise.resolve(void 0)}const S=function(e,t,n,i,a,o,{viewEntitiesRef:r,viewEntity:s}={},l){var d,c,u;const m=r&&Et(r);return{client:e,coreSettings:t,loggerFactory:n,scenarioFactory:i,userBiService:a,executionContext:{viewEntities:{endEntity:null===(d=null==r?void 0:r.current)||void 0===d?void 0:d.endEntity,mainEntity:null===(c=null==r?void 0:r.current)||void 0===c?void 0:c.mainEntity},viewEntity:s,isHandlingAppActiveApp:!!m&&(null===(u=o.getApp({entityType:m.type}))||void 0===u?void 0:u.manifest.id)===l}}}(t,o,l,d,u,e,s,h.manifest.id);let f;try{const i={eventInput:r,requestContext:S};Ot({correlation:v,commandChangeReportingService:n,type:Qe.B.BeforeOnEventReceived});const{navigationalReactiveValues:a,nonNavigationalReactiveValues:o}=e.getAppViewStateForWindow(m||_.ew,h.manifest.id)||{};let s=!1,l={};a&&(l=Object.keys(a).reduce(((e,t)=>{const n=a[t];return Object.assign(Object.assign({},e),{[t]:{read:n.read,update:e=>{e!==n.read()&&(n.update(e),s=!0)}}})}),{}));const d=Object.assign(Object.assign({},l),o);f=yield(({sourceApp:e,reactiveValues:t,hookOptions:n,windowId:i})=>(0,c.mG)(void 0,void 0,void 0,(function*(){var a;let o;if(!(null===(a=e.eventHandlers)||void 0===a?void 0:a.onEventReceived))return Promise.resolve(void 0);if(At(e)&&Nt(e)){if(t){const a=Object.assign(Object.assign({},n),{appViewState:t,windowId:i});o=yield e.eventHandlers.onEventReceived(a)}}else if(At(e)){if(t){const i=Object.assign(Object.assign({},n),{appViewState:t});o=yield e.eventHandlers.onEventReceived(i)}}else if(Nt(e)){const t=Object.assign(Object.assign({},n),{windowId:i});o=yield e.eventHandlers.onEventReceived(t)}else o=yield e.eventHandlers.onEventReceived(n);return Promise.resolve(o)})))({sourceApp:h,reactiveValues:d,hookOptions:i,windowId:m}),s&&(t.mutate({mutation:Mt.E,variables:{windowId:m,appIds:[h.manifest.id]}}).catch((e=>{p.warn(`saveReactiveVarToHistory mutation failed ${e.message}`)})),s=!1),Ot({correlation:v,commandChangeReportingService:n,type:Qe.B.AfterOnEventReceived})}catch(e){const t=`Event '${r.event.type}' encountered an error inside onEventReceived of ${h.manifest.name}.`;return Lt({commandChangeReportingService:n,correlation:v,errorMessage:t,logger:p}),Promise.reject(e)}if(!f)return Ot({correlation:v,commandChangeReportingService:n,type:Qe.B.EventHandled}),Promise.resolve(void 0);const y=Object.assign(Object.assign({},f),{correlation:v});return i(y,a)}));var Bt=n(19635);const Wt="DeepLink:: ";var Gt,Vt,Ht,$t,zt,qt,Jt,Qt,Kt,Yt,Xt,Zt,en;!function(e){e.DecodeURIComponentFailed="DecodeURIComponentFailed",e.DeeplinkNotHandledByRegisteredApps="DeeplinkNotHandledByRegisteredApps",e.ExecuteFromUrlFailed="ExecuteFromUrlFailed",e.IntentServiceExecutionFailed="IntentServiceExecutionFailed",e.InvalidDeepLinkUrl="InvalidDeepLinkUrl",e.OnBeforeDeeplinkParsedFailed="OnBeforeDeeplinkParsedFailed",e.ToNavigationIntentFailed="ToNavigationIntentFailed"}(Gt||(Gt={})),function(e){e.NavigationIntentNotFound="NavigationIntentNotFound"}(Vt||(Vt={})),function(e){e[e.Card=0]="Card",e[e.MessageExtension=1]="MessageExtension",e[e.PlatformExtensionTab=2]="PlatformExtensionTab",e[e.DeepLink=3]="DeepLink",e[e.ShareToOutlook=4]="ShareToOutlook",e[e.ContentBubble=5]="ContentBubble",e[e.AdaptiveCardTab=6]="AdaptiveCardTab",e[e.BotConfig=7]="BotConfig"}(Ht||(Ht={})),function(e){e.contentBubble="contentBubble",e.targetedMeetingNotification="targetedMeetingNotification"}($t||($t={})),function(e){e.Small="small",e.Medium="medium",e.Large="large"}(zt||(zt={})),function(e){e.message="message",e.compose="compose",e.commandBox="commandBox"}(qt||(qt={})),function(e){e.normal="normal",e.high="high",e.urgent="urgent"}(Jt||(Jt={})),function(e){e.aadApplication="aadApplication",e.bot="bot",e.tenantBot="tenantBot",e.office365Connector="office365Connector",e.webhook="webhook"}(Qt||(Qt={})),function(e){e.team="team",e.channel="channel"}(Kt||(Kt={})),function(e){e.html="html",e.text="text"}(Yt||(Yt={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.sad="sad",e.angry="angry"}(Xt||(Xt={})),function(e){e.aadUser="aadUser",e.onPremiseAadUser="onPremiseAadUser",e.anonymousGuest="anonymousGuest",e.federatedUser="federatedUser"}(Zt||(Zt={})),function(e){e[e.chat=0]="chat",e[e.channel=1]="channel",e[e.tab=2]="tab"}(en||(en={}));const tn="https://teams.microsoft.com/l",nn="/task/",an="/stage/",on="/entity/",rn="context",sn="application/vnd.microsoft.card.adaptive",ln=(e,t,n)=>{const i=e=>null==n?void 0:n(e);return e.executeCommand(t.entity,{entityCommand:t.command,entityOptions:t.entityOptions}).subscribe({complete:i,error:i}),Promise.resolve()},dn=(e,t,n,i,a,o)=>{const r=e.executeCommand(t.entity,{entityCommand:t.command,entityOptions:t.entityOptions}),s=n.newScenario(ee.RG.ExtTaskModuleLaunch),l=Ht.DeepLink;return r.subscribe({complete:()=>{i.log(`task module complete for entrypoint ${l}`),s.stop(gn(a,l)),o&&o()},error:e=>{i.error(`error launching task module for entry point ${l}.  Error:`,e),s.fail(gn(a,l,e)),o&&o(e)},next:e=>{e.containerState===Ae.oq.Open&&s.stop(gn(a,l))}}),Promise.resolve()},cn=(e,t)=>{const n=new URL(e).pathname.split("/");if(n.length===t){const[,,e,t,i]=n;return!(!e||!t)}return!1},un=e=>(e=e.toLowerCase()).includes("replychainid")&&e.includes("messageid"),mn=e=>!(!e||!e.startsWith(tn)),gn=(e,t,n)=>{const i={};return e&&(i["App.Id"]=e),t&&(i["App.EntryPoint"]=Ht[t]),n&&(i.errors=n),i},pn=(e,t)=>{if(!t)throw new Error("Could not find app context");switch(e.type){case Ie.p.extensions:return Object.assign(Object.assign({},t),{type:en.tab});case Ie.p.channels:return Object.assign(Object.assign({},t),{type:en.channel});case Ie.p.chats:return Object.assign(Object.assign({},t),{type:en.chat});default:throw new Error("unsupported launch context")}},hn=e=>!!e&&"0"!==e,vn=e=>e?JSON.parse(e):{},Sn=(e,t)=>{switch(e&&e.type){case Ie.p.extensions:return kn(e);case Ie.p.chats:return{chatId:e.id||""};case Ie.p.channels:{const{channelId:n,replyChainId:i}=vn(e.id);return{channelId:n,parentMessageId:i,chatId:yn(i,n,t),meetingId:fn(n,i)}}default:return}},fn=(e,t)=>e?hn(t)?btoa(`0#${e}#${t}`):btoa(`0#${e}#0`):"",yn=(e,t,n)=>hn(e)&&n?t.includes("messageid")?t:`${t};messageid=${e}`:t,kn=e=>{if(e.linkedEntity)switch(e.linkedEntity.type){case Ie.p.chats:return{chatId:e.linkedEntity.id};case Ie.p.channels:{const{channelId:t,replyChainId:n}=vn(e.linkedEntity.id);return{channelId:t,parentMessageId:n}}case Ie.p.extensions:return e.linkedEntity.id?JSON.parse(e.linkedEntity.id):void 0}},Cn=(e,t)=>{const n=e.search.indexOf("=")+1,i=e.search.substring(n)||"",a=decodeURIComponent(i),{contentUrl:o,websiteUrl:r,removeUrl:s,name:l}=JSON.parse(a);return{type:"tab/tabInfoAction",tabInfo:{contentUrl:o,websiteUrl:r,removeUrl:s,name:l,entityId:t}}},bn=e=>{const t=e.search.indexOf("?")+1;return(e.search.substring(t)||"").split("&").reduce(((e,t)=>{const[n,i]=t.split("="),a=decodeURIComponent(i);return Object.assign(Object.assign({},e),{[n]:(0,Z.isString)(n)&&"card"===n.toLowerCase()?Tn(a):a})}),{})},Tn=e=>{try{const t=JSON.parse(e),n=(0,Z.isString)(t.contentType)&&t.contentType.toLowerCase()===sn.toLowerCase(),i=(0,Z.isString)(t.type)&&"adaptivecard"===t.type.toLowerCase();return n?{content:JSON.stringify(t.content),contentType:t.contentType}:i?{content:e,contentType:sn}:null}catch(e){return null}};class wn{constructor(e,t,n,i,a,o,r,s,l){this.host=e,this.commandHandler=t,this.extensionCommandingService=n,this.scenarioFactory=i,this.deeplinkService=o,this.coreSettings=r,this.userContextId=s,this.clientLaunchId=l,this.logger=a.newLogger("DeepLinkCommandingService")}checkForPendingDeeplink(e,t){return this.deeplinkService.checkForPendingIntent(e,this.clientLaunchId,null!=t?t:this.userContextId)}launchMainApp(e,t,n){return this.deeplinkService.launchMainApp(e,this.clientLaunchId,null!=t?t:this.userContextId,n)}prewarmFlyout(e){return this.deeplinkService.prewarmFlyout(e)}executeFromUrlV2(e,t,n){var i,a;return(0,c.mG)(this,void 0,void 0,(function*(){if(!this.allowV2Flow(e))return!1;try{return yield this.deeplinkService.executeFromUrlAsync(e,t,n,this.clientLaunchId,this.userContextId)}catch(e){const t=`DeepLinkCommanding:: ${Gt.ExecuteFromUrlFailed} ${(0,R.u4)(e)}`;throw null===(a=(i=this.logger).errorToTelemetry)||void 0===a||a.call(i,t,"webclient_framework_foundation_core_services_deeplink",void 0,!0),new Error(t)}}))}executeDeepLinkFromUrl(e,t,n,i){var a,o,r,s;return(0,c.mG)(this,void 0,void 0,(function*(){const l=!!(null===(a=this.coreSettings.get(A.J.Core))||void 0===a?void 0:a.handleInternalDeepLinks),d=!!(null===(o=this.coreSettings.get(A.J.Extensibility))||void 0===o?void 0:o.enableChatIdChangeInGetContextCall);try{if(yield this.executeFromUrlV2(e,n))return}catch(e){null===(s=(r=this.logger).errorToTelemetry)||void 0===s||s.call(r,null==e?void 0:e.message,"webclient_framework_foundation_core_services_deeplink",void 0,!0)}const c=this.createEntityCommandFromDeepLink(e,t,d);return c?((e,t,n,i,a,o,r)=>{switch(e.entity.type){case Ie.p.taskmodule:const s=new URL(t),[,,,l]=s.pathname.split("/");return dn(i,e,o,a,l,r);case Ie.p.platformStage:return ln(i,e,r);default:return n(e)}})(c,e,this.commandHandler,this.extensionCommandingService,this.logger,this.scenarioFactory,i):l?void this.host.open(e):this.host.opener.open(Bt.B.OpenOnMainRenderer,Bt._.DeepLink,{url:e})}))}executeIntent(e){return this.deeplinkService.executeIntent(e)}createEntityCommandFromDeepLink(e,t,n){return(e=>cn(e,4))(e)&&(e=>{if(mn(e))return e.substr(tn.length).toLowerCase().substring(0,nn.length)===nn;return!1})(e)?((e,t,n)=>{const i=(0,Je.v4)(),a=new URL(e),[,,,o]=a.pathname.split("/"),r={entryPoint:Ht.DeepLink,appId:o,taskInfo:bn(new URL(e))};return{entity:{id:i,type:Ie.p.taskmodule,action:Ie.u.create},command:{stateTransition:Ae.su.extend,visibilityState:Ae.fe.show,correlation:{source:I.D.ExtensionCommanding}},entityOptions:{input:r,launchContext:pn(t,Sn(t,n))}}})(e,t,n):(e=>cn(e,5))(e)&&(e=>!!mn(e)&&e.substr(tn.length).toLowerCase().substring(0,an.length)===an)(e)?(e=>{try{const t=new URL(e),[,,,n]=t.pathname.split("/"),i=(0,Je.v4)();return{entity:{id:i,type:Ie.p.platformStage,action:Ie.u.view},command:{stateTransition:Ae.su.extend,visibilityState:Ae.fe.show,correlation:{source:I.D.ExtensionCommanding}},entityOptions:{appId:n,tabInfo:JSON.stringify(Cn(t,i))}}}catch(e){return null}})(e):null}allowV2Flow(e){var t;return!!(this.coreSettings.get(A.J.Extensibility).handleDeepLinkToMeetingSidePanel&&(e=>{if(!cn(e,5))return!1;const{searchParams:t}=new URL(e),n=t.has(rn)&&t.get(rn);if(!n)return!1;try{const e=JSON.parse(decodeURIComponent(n));return!(!e||!e.chatId||e.channelId||un(`${e.chatId}`)||"chat"!==e.contextType||"false"===t.get("openInMeeting"))}catch(e){return!1}})(e)&&(e=>!!mn(e)&&e.substring(tn.length).toLowerCase().substring(0,on.length)===on)(e))||!!(null===(t=this.coreSettings.get(A.J.Core))||void 0===t?void 0:t.handleInternalDeepLinks)}}var _n=n(29601),In=n(95414),An=n(53351);const Nn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CoreServicesEntityCommandingActiveWindowContainerStateQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}}]}}]},En={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindowBlockingExtension"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"blockingEntityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]}}]},Dn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"addBlockingExtension"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"removeBlock"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addBlockingExtension"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}},{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"entityOptions"},value:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}}},{kind:"Argument",name:{kind:"Name",value:"removeBlock"},value:{kind:"Variable",name:{kind:"Name",value:"removeBlock"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};class Fn{constructor(e,t,n,i,a){this.commandHandler=e,this.client=t,this.windowId=n,this.scenarioFactory=i,this.onDestroy=new Te.xQ,this.logger=a.newLogger("ExtensionCommandingService")}destroy(){return(0,c.mG)(this,void 0,void 0,(function*(){try{this.onDestroy.next(),this.reset()}catch(e){this.logger.warn(`Unable to destroy, error ocurred in persisting delete of extension entity. e.name: ${e.name}, e.message: ${e.message}`)}}))}executeCommand(e,t){const n=(null==t?void 0:t.entityCommand)||{stateTransition:Ae.su.none,visibilityState:Ae.fe.show,correlation:{source:I.D.ExtensionCommanding}};n.stateTransition=Ae.su.extend;const i={entity:e,command:n,entityOptions:null==t?void 0:t.entityOptions};return this.processRequest(i)}addBlockingExtension(e,t,n=!1){return(0,c.mG)(this,void 0,void 0,(function*(){if(!n&&(yield this.isWindowBlocked()))return void this.logger.log("Window is currently blocked, addBlockingExtension no-op");this.logger.log(`addBlockingExtension, requesting an extension of type ${e.type} to block the window`);const i={entity:e,entityOptions:JSON.stringify(t),windowId:this.windowId,removeBlock:n};yield this.client.mutate({mutation:Dn,variables:i})}))}isWindowBlocked(){return(0,c.mG)(this,void 0,void 0,(function*(){const{data:e}=yield this.client.query({query:En,variables:{windowId:this.windowId}});return!!e.activeWindow.blockingEntityExtension}))}pipeWhileStateIsValid(e){return e.pipe((0,_n.R)(this.onDestroy),(0,In.o)((e=>e.hasEntityExtension),!0),(0,An.G)(),(0,In.o)((([e,t])=>{const n=t.containerState,i=t.hasEntityExtension,a=e.containerState,o=n===Ae.oq.Confirmed,r=n===Ae.oq.Cancelled,s=n===Ae.oq.Error,l=n===Ae.oq.Closed,d=a===Ae.oq.Open;return i&&!o&&!r&&!s&&!(d&&l)}),!0),(0,h.U)((([,e])=>({containerState:e.containerState}))))}processRequest(e){this.scenarioFactory.newScenario(ee.RG.ExtensionOpen);const t=this.observeContainerState(this.client,this.windowId),n=this.pipeWhileStateIsValid(t);this.commandHandler(e).then((()=>{n.subscribe({next:e=>{this.stopActiveScenario(e.containerState),this.nextSubscriber(e),e.containerState===Ae.oq.Error&&this.resetSubscriber((0,he.Tr)("ExtensionCommanding",_.jK.Unknown,`ExtendedContainerState ${e.containerState}`,void 0,"Error processing entity extension"))},complete:()=>{this.resetSubscriber()},error:e=>{this.resetSubscriber(e)}})})).catch((e=>{this.resetSubscriber(e)}));return new we.y((e=>{this.subscriber=e}))}nextSubscriber(e){this.subscriber&&this.subscriber.next(e)}resetSubscriber(e){const t=this.subscriber;this.reset(),e?(this.failActiveScenarios(),t&&t.error(e)):(this.stopActiveScenarios(),t&&t.complete())}reset(){this.subscriber=void 0}stopActiveScenarios(){var e,t;null===(e=this.scenarioFactory.findScenario(ee.RG.ExtensionClose))||void 0===e||e.stop(),null===(t=this.scenarioFactory.findScenario(ee.RG.ExtensionOpen))||void 0===t||t.stop()}failActiveScenarios(){var e,t;null===(e=this.scenarioFactory.findScenario(ee.RG.ExtensionClose))||void 0===e||e.fail(),null===(t=this.scenarioFactory.findScenario(ee.RG.ExtensionOpen))||void 0===t||t.fail()}stopActiveScenario(e){switch(e){case Ae.oq.Error:this.failActiveScenarios();break;case Ae.oq.Open:case Ae.oq.Closed:case Ae.oq.Cancelled:case Ae.oq.Confirmed:this.stopActiveScenarios();break;default:this.logger.errorToTelemetry&&this.logger.errorToTelemetry(`Unable to stop active scenario, no case mapped to container state provided: ${e}`,"webclient_framework_foundation_core_services_extension_commanding",void 0,!0)}}observeContainerState(e,t){return _e(this.watchActiveWindow(e,t)).pipe((0,h.U)((({data:e})=>{var t;return{containerState:e.activeWindow.extendedEntityContainerState.containerState,hasEntityExtension:!!(null===(t=e.activeWindow.activeEntities.entityExtension)||void 0===t?void 0:t.type)}})))}watchActiveWindow(e,t){return e.watchQuery({query:Nn,variables:{windowId:t}})}}const Pn=({appsRegistryService:e,client:t,commandChangeReportingService:n,coreSettings:i,entityCommandInput:a,executionContext:o,loggerFactory:r,platformService:s,scenarioFactory:l,windowId:d,clientLaunchId:u,windowProvider:m,userBiService:g})=>(0,c.mG)(void 0,void 0,void 0,(function*(){var p,h;const v=r.newLogger("internalCommandHandler"),S=null!==(h=null===(p=a.command)||void 0===p?void 0:p.__UNSAFE_windowId)&&void 0!==h?h:d;S!==d&&v.log(`window id overridden to ${S}`);let f=tt(function(e){const t=e.command||nt({stateTransition:Ae.su.none,visibilityState:Ae.fe.show,correlation:{source:I.D.Unknown}});return Object.assign(Object.assign({},e),{command:t})}(a));const y=function(e,t){var n;return t&&e.getApp({entityType:null===(n=t.viewEntity)||void 0===n?void 0:n.type})}(e,o),k=function(e,t){return e.getApp({entityType:t.entity.type})}(e,f);!function({commandChangeReportingService:e,entityCommand:t,logger:n,sourceApp:i,renderingApp:a,coreSettings:o}){t.entity.type===Ie.p.default&&(t.command.correlation.scenarioName=ee.RG.DefaultCommand),i&&et({appName:i.manifest.name,commandChangeReportingService:e,entityCommand:t,getCommandScenarioName:i.getCommandScenarioNameFromSource,logger:n,coreSettings:o}),a&&et({appName:a.manifest.name,commandChangeReportingService:e,entityCommand:t,getCommandScenarioName:a.getCommandScenarioName,logger:n,coreSettings:o})}({commandChangeReportingService:n,entityCommand:f,renderingApp:k,sourceApp:y,logger:v,coreSettings:i});const C=f.command.correlation.id;if(function({commandChangeReportingService:e,entityCommand:t,executionContextEntity:n}){const i=t.command.correlation.id;e.report({type:Qe.B.CommandStart,correlationId:i,context:{target:"internal-command-handler",entityCommand:t,executionContextEntity:n}})}({commandChangeReportingService:n,entityCommand:f,executionContextEntity:null==o?void 0:o.viewEntity}),k){const e=function(e,t,n,i,a,o){return{client:e,coreSettings:t,loggerFactory:n,platformService:i,scenarioFactory:a,userBiService:o}}(t,i,r,s,l,g),a=m||void 0;f=yield function({app:e,commandChangeReportingService:t,entityCommand:n,hookRequestContext:i,logger:a,windowProvider:o}){var r;return(0,c.mG)(this,void 0,void 0,(function*(){let s=n;if(e.onBeforeCommandHandled){const l=n.command.correlation,d=l.id,c="internal-command-handler-execute-before-command-handled-hook";t.report({type:Qe.B.ApplicationHookReceivedCommand,context:{target:c},correlationId:d});try{const t={entityCommand:n,requestContext:i,windowProvider:o||void 0};s=yield e.onBeforeCommandHandled(t)}catch(n){const i=`Command 'onBeforeCommandHandled' rejected. An attempt to handle the command was made by app:${e.manifest.name}, but failed. Error: ${(0,me.A)((0,he.VK)(n))}`;return null===(r=a.errorToTelemetry)||void 0===r||r.call(a,i,"webclient_framework_foundation_core_services_internal_command_handler",void 0,!0),t.report({type:Qe.B.Failure,context:{errorInfo:Ke.y.OnBeforeCommandHandledRejected,errorMessage:i,target:c},correlationId:d}),Promise.reject(n)}void 0!==s&&(t.report({type:Qe.B.ApplicationHookContinuedCommand,context:{target:c},correlationId:d}),s.command.correlation=l,t.report({type:Qe.B.CommandStart,correlationId:d,context:{target:c,entityCommand:s}}))}return Promise.resolve(s)}))}({app:k,commandChangeReportingService:n,entityCommand:f,hookRequestContext:e,logger:v,windowProvider:a})}return f?function({entityCommand:e,mutateContext:{client:t,executionContext:n,windowId:i,clientLaunchId:a}}){return t.mutate({mutation:Ye,variables:Object.assign(Object.assign({},e),{entityOptions:JSON.stringify(e.entityOptions),executionContext:n,windowId:i,clientLaunchId:a}),fetchPolicy:"no-cache"}).then((e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.executeEntityCommand)||void 0===n?void 0:n.id}))}({entityCommand:f,mutateContext:{client:t,executionContext:o,windowId:S,clientLaunchId:u}}):(n.report({type:Qe.B.CommandHandledPriorToResolution,context:{target:"internal-command-handler"},correlationId:C}),Promise.resolve(void 0))}));var Mn=n(41330);class jn{constructor(e){this.commandHandler=e}trigger(e){return this.commandHandler({entity:xn(e.entity),command:Bn(e.command)})}}const Rn=e=>{switch(e){case Mn.uk.view:return Ie.u.view;case Mn.uk.list:return Ie.u.list;case Mn.uk.default:return Ie.u.default;default:throw(0,he.Tr)(_.w5.Commanding,_.jK.NotImplemented,"Nova",void 0,`Mapping for Nova action type ${e} not implemented in Teams!`)}},xn=e=>{switch(e.type){case Mn.py.identity:return On(e);case Mn.py.teams_chat:return{type:Ie.p.chats,id:e.entityId,action:Rn(e.action)};case Mn.py.teams_channel:return{type:Ie.p.channels,id:e.entityId,action:Rn(e.action)};case Mn.py.office_home:return{type:Ie.p.communitiesonboarding,id:e.entityId,action:Rn(e.action)};case Mn.py.teams_activity:return{type:Ie.p.activity,id:e.entityId,action:Rn(e.action)};case Mn.py.teams_calendar:return{type:Ie.p.calendar,id:e.entityId,action:Rn(e.action)};case Mn.py.teams_meet:return{type:Ie.p.meet,id:e.entityId,action:Rn(e.action)};case Mn.py.m365_app:return{type:Ie.p.extensions,id:e.entityId,action:Rn(e.action)};case Mn.py.teams_calling:return{type:Ie.p.callsmain,id:e.entityId,action:Ie.u.view};default:throw(0,he.Tr)(_.w5.Commanding,_.jK.NotImplemented,"Nova",void 0,`Mapping for Nova entity type ${e.type} not implemented in Teams!`)}},On=e=>{switch(e.action){case Mn.uk.signout:return{type:Ie.p.signoutdialog,id:e.entityId,action:Ie.u.view};case Mn.uk.updateProfilePicture:return{type:Ie.p.updatemsaprofileavatardialog,id:e.entityId,action:Ie.u.view};case Mn.uk.updateDisplayName:return{type:Ie.p.updatemsaprofilenamedialog,id:e.entityId,action:Ie.u.view};default:throw(0,he.Tr)(_.w5.Commanding,_.jK.NotImplemented,"Nova",void 0,`Mapping for Nova identity entity with action type ${e.action} not implemented in Teams!`)}},Ln=e=>{switch(e){case Mn.fe.hide:return Ae.fe.hide;case Mn.fe.show:return Ae.fe.show;case Mn.fe.toggle:return Ae.fe.toggle}},Un=e=>{switch(e){case Mn.su.extend:return Ae.su.extend;case Mn.su.flush:return Ae.su.flush;case Mn.su.forceFlush:return Ae.su.forceFlush;case Mn.su.new:return Ae.su.new;case Mn.su.none:return Ae.su.none}},Bn=e=>({visibilityState:Ln(e.visibilityState),stateTransition:Un(e.stateTransition),correlation:{source:I.D.Nova}});var Wn,Gn,Vn;!function(e){e.NotInstalled="NotInstalled",e.InstalledNotActive="InstalledNotActive",e.InstalledActive="InstalledActive"}(Wn||(Wn={})),function(e){e.Teams1="Teams1",e.Teams2="Teams2"}(Gn||(Gn={})),function(e){e.DownloadedAndInstalled="DownloadedAndInstalled",e.FailedToDownload="FailedToDownload",e.FailedToInstall="FailedToInstall",e.DownloadPageOpened="DownloadPageOpened"}(Vn||(Vn={}));var Hn,$n,zn,qn=n(8343),Jn=n(89812);class Qn{constructor(e,t,n,i,a,o,r){this.commandHandler=e,this.extensionCommanding=t,this.hostCommunicationService=n,this.windowId=i,this.host=a,this.coreSettings=o,this._logger=r.newLogger("ShellCommandingService")}activeCallDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.activecalldialog,action:Ie.u.view},{entityCommand:e})}bringWindowToFront(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("osutils");return this._logger.log(`Performing action: bringWindowToFront on ${e}`),(null===(t=null==n?void 0:n.bringWindowToFront)||void 0===t?void 0:t.call(n,e))||Promise.resolve(!1)}))}desktopNotice(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("osutils");return this._logger.log("Performing action: desktopNotice"),null===(e=null==t?void 0:t.openThirdPartyNotice)||void 0===e?void 0:e.call(t)}))}dismissBanner(e,t=I.D.Unknown){return this.dismissNotification(e,Ie.p.bannerNotification,t)}dismissToast(e,t=I.D.Unknown){return this.dismissNotification(e,Ie.p.inAppToast,t)}executeNotificationAction(e,t,n,i,a){var o,r;let s;try{s=JSON.parse(i)}catch(e){return null===(r=(o=this._logger).errorNoPii)||void 0===r||r.call(o,`Notification command can't be parsed: ${i}`),Promise.resolve()}return a?this.dismissNotification(e,t,n):t===Ie.p.bannerNotification&&(s.entityOptions=Object.assign(Object.assign({},s.entityOptions),{bannerId:e})),this.commandHandler(s)}installAndLaunchT1(){var e,t,n,i,a,o,r;return(0,c.mG)(this,void 0,void 0,(function*(){const s=yield this.hostCommunicationService.loadModule("appswitcher"),l=yield null===(e=null==s?void 0:s.downloadAndInstallPearApp)||void 0===e?void 0:e.call(s,Gn.Teams1);switch(null==l?void 0:l.status){case Vn.DownloadedAndInstalled:yield this.launchT1AndQuitT2(!0),this._logger.log("T1 is downloaded and installed");break;case Vn.FailedToDownload:null===(n=(t=this._logger).errorNoPii)||void 0===n||n.call(t,`T1 failed to download: ${null==l?void 0:l.errorMessage}`);break;case Vn.FailedToInstall:null===(a=(i=this._logger).errorNoPii)||void 0===a||a.call(i,`T1 failed to install: ${null==l?void 0:l.errorMessage}`);break;default:null===(r=(o=this._logger).errorNoPii)||void 0===r||r.call(o,`T1 download and install failed: ${null==l?void 0:l.errorMessage}`)}}))}joinLinkDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.joinlinkdialog,action:Ie.u.view},{entityCommand:e})}launchT1AndQuitT2(e,t){var n,i,a;return(0,c.mG)(this,void 0,void 0,(function*(){const o=yield this.hostCommunicationService.loadModule("appswitcher");e&&(this._logger.log("launchT1AndQuitT2, Switcher default app to T1"),yield null===(n=null==o?void 0:o.switchDefaultAppTo)||void 0===n?void 0:n.call(o,Gn.Teams1)),this._logger.log("launchT1AndQuitT2, launch T1"),yield null===(i=null==o?void 0:o.launchPearApp)||void 0===i?void 0:i.call(o,Gn.Teams1,t),this._logger.log("Flushing T2 telemetry events"),yield(0,Jn.G)().flush(),this._logger.log("launchT1AndQuitT2, quit T2"),yield null===(a=null==o?void 0:o.quitApp)||void 0===a?void 0:a.call(o)}))}maximizeWindow(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(A.J.Core).routeWindowActionsThroughHostComms)return this.host.maximize();const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: maximizeWindow on ${this.windowId}`),null===(e=null==t?void 0:t.maximize)||void 0===e?void 0:e.call(t,this.windowId)}))}minimizeWindow(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(A.J.Core).routeWindowActionsThroughHostComms)return this.host.minimize();const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: maximizeWindow on ${this.windowId}`),null===(e=null==t?void 0:t.minimize)||void 0===e?void 0:e.call(t,this.windowId)}))}msaProfileAvatarUpdateDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.updatemsaprofileavatardialog,action:Ie.u.view},{entityCommand:e})}msaProfileNameUpdateDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.updatemsaprofilenamedialog,action:Ie.u.view},{entityCommand:e})}noticeDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.tpndialog,action:Ie.u.view},{entityCommand:e})}openFreDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.officeintegrationfredialog,action:Ie.u.info},{entityCommand:e})}removeTitleBarOverlay(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: setCustomFrameOptions on ${this.windowId}`),null===(e=null==t?void 0:t.setCustomFrameOptions)||void 0===e?void 0:e.call(t,this.windowId,{titleBarMode:qn.i$.ButtonsOnly})}))}restoreWindow(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: restoreWindow on ${this.windowId}`),null===(e=null==t?void 0:t.restore)||void 0===e?void 0:e.call(t,this.windowId)}))}setMinimumWindowSize(e,t){var n;return(0,c.mG)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(n=null==i?void 0:i.setMinimumWindowSize)||void 0===n?void 0:n.call(i,this.windowId,e,t)}))}setWindowBounds(e,t,n,i){var a;return(0,c.mG)(this,void 0,void 0,(function*(){const o=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(a=null==o?void 0:o.setWindowBounds)||void 0===a?void 0:a.call(o,this.windowId,e,t,n,i)}))}showContextMenu(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: showContextMenu on ${this.windowId} and position ${e}`),null===(t=null==n?void 0:n.showTitleBarContextMenu)||void 0===t?void 0:t.call(n,this.windowId,e)}))}showBanner(e){var{id:t,dismissable:n=!0,duration:i=4,source:a=I.D.Unknown}=e,o=(0,c._T)(e,["id","dismissable","duration","source"]);return this.commandHandler({command:{correlation:{source:a},stateTransition:Ae.su.none,visibilityState:Ae.fe.show},entity:{type:Ie.p.bannerNotification,action:Ie.u.create,id:t},entityOptions:Object.assign(Object.assign({},o),{dismissable:n,duration:i})})}showToast(e){var{id:t,duration:n=7e3,source:i=I.D.Unknown}=e,a=(0,c._T)(e,["id","duration","source"]);return this.commandHandler({command:{correlation:{source:i},stateTransition:Ae.su.none,visibilityState:Ae.fe.show},entity:{type:Ie.p.inAppToast,action:Ie.u.create,id:t},entityOptions:Object.assign(Object.assign({},a),{duration:n})})}signOutDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.signoutdialog,action:Ie.u.view},{entityCommand:e})}startWindowDragListener(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: startWindowDragListener on ${this.windowId}`),null===(e=null==t?void 0:t.startWindowDragListener)||void 0===e?void 0:e.call(t,this.windowId)}))}swapMeetingRoomFrontOfRoomWindows(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log("Performing action: swapMeetingRoomFrontOfRoomWindows"),null===(e=null==t?void 0:t.swapMeetingRoomFrontOfRoomWindows)||void 0===e?void 0:e.call(t)}))}switchDefaultAppTo(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("appswitcher");this._logger.log(`switchDefaultAppTo ${e}`),yield null===(t=null==n?void 0:n.switchDefaultAppTo)||void 0===t?void 0:t.call(n,e)}))}zoomInWindow(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: zoomInWindow on ${this.windowId}`),null===(e=null==t?void 0:t.zoomIn)||void 0===e?void 0:e.call(t,this.windowId)}))}zoomOutWindow(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: zoomOutWindow on ${this.windowId}`),null===(e=null==t?void 0:t.zoomOut)||void 0===e?void 0:e.call(t,this.windowId)}))}zoomResetWindow(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: zoomResetWindow on ${this.windowId}`),null===(e=null==t?void 0:t.zoomReset)||void 0===e?void 0:e.call(t,this.windowId)}))}getScreenshots(e,t){var n;return(0,c.mG)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: getScreenshots on ${this.windowId}`),null===(n=null==i?void 0:i.getScreenshots)||void 0===n?void 0:n.call(i,e,t)}))}dismissNotification(e,t,n=I.D.Unknown){return this.commandHandler({command:{correlation:{source:n},stateTransition:Ae.su.none,visibilityState:Ae.fe.hide},entity:{type:t,action:Ie.u.delete,id:e}})}}!function(e){e.quickReply="quickReply",e.unknown="unknown",e.view="view"}(Hn||(Hn={})),function(e){e.Compose="Compose",e.MessagePane="MessagePane",e.DeeplinkedMessage="DeeplinkedMessage",e.DoNotMove="DoNotMove"}($n||($n={})),function(e){e.LeftRailSelectedItem="LeftRailSelectedItem"}(zn||(zn={}));class Kn{constructor(e,t){this.commandHandler=e,this.userContextId=t}showMessage(e,{collectionId:t,conversationId:n,mainImage:i,discardDuringMeetingsAndCalls:o,messageId:s,quickReply:l,quickReplyButton:d,quickReplyPlaceholder:c,text:u,time:m,title:g,isUrgent:p}){const h={collectionId:t,isUrgent:p,mainImage:i,discardDuringMeetingsAndCalls:o,targetEntity:{action:r.view,dataOptions:{actionType:Hn.view,messageId:s,userContextId:this.userContextId},id:n,type:a.chats},textInput:l?Yn(n,d,c,this.userContextId):void 0,text:u,time:m,title:g},v={command:{correlation:{id:e,source:I.D.Notifications,startTimestamp:m.valueOf()},stateTransition:Ae.su.new,visibilityState:Ae.fe.show},entity:{action:Ie.u.view,type:Ie.p.toasts},entityOptions:h};return this.commandHandler(v)}showReminder(e,{collectionId:t,conversationId:n,mainImage:i,messageId:o,text:s,time:l,title:d,buttonText:c}){const u={collectionId:t,mainImage:i,targetEntity:{action:r.view,dataOptions:{actionType:Hn.view,messageId:o,userContextId:this.userContextId},id:n,type:a.reminders},textInput:void 0,text:s,time:l,title:d,buttons:[{targetEntity:{action:r.view,dataOptions:{actionType:Hn.view,messageId:o,userContextId:this.userContextId},id:n,type:a.reminders},text:c}]},m={command:{correlation:{id:e,source:I.D.Notifications,startTimestamp:l.valueOf()},stateTransition:Ae.su.new,visibilityState:Ae.fe.show},entity:{action:Ie.u.view,type:Ie.p.toasts},entityOptions:u};return this.commandHandler(m)}showChatTabEntityNotification(e,{collectionId:t,conversationId:n,mainImage:i,tabId:o,text:s,time:l,title:d}){const c={collectionId:t,mainImage:i,targetEntity:{id:o,type:a.extensions,action:r.view,dataOptions:{actionType:Hn.unknown,userContextId:this.userContextId},linkedEntity:{id:n,action:r.view,type:a.chats}},text:s,time:l,title:d},u={command:{correlation:{id:e,source:I.D.Notifications,startTimestamp:l.valueOf()},stateTransition:Ae.su.flush,visibilityState:Ae.fe.show},entity:{action:Ie.u.view,type:Ie.p.toasts},entityOptions:c};return this.commandHandler(u)}showChannelsNotification(e,{collectionId:t,conversationId:n,mainImage:i,discardDuringMeetingsAndCalls:o,messageId:s,text:l,time:d,title:c,replyChainId:u}){const m={collectionId:t,mainImage:i,discardDuringMeetingsAndCalls:o,targetEntity:{action:r.view,dataOptions:{actionType:Hn.view,messageId:s,userContextId:this.userContextId,focusOnLoad:$n.DoNotMove},id:JSON.stringify({channelId:n,replyChainId:u,deepLinkId:u}),type:a.channels},text:l,time:d,title:c},g={command:{correlation:{id:e,source:I.D.Notifications,startTimestamp:d.valueOf()},stateTransition:Ae.su.new,visibilityState:Ae.fe.show},entity:{action:Ie.u.view,type:Ie.p.toasts},entityOptions:m};return this.commandHandler(g)}showCommunitiesNotifications(e,{collectionId:t,conversationId:n,mainImage:i,messageId:o,text:s,time:l,title:d,replyChainId:c,type:u}){const m={collectionId:t,mainImage:i,targetEntity:{action:r.view,dataOptions:{actionType:Hn.view,messageId:o,userContextId:this.userContextId,toastType:u,teamId:n},id:JSON.stringify({channelId:n,replyChainId:c,deepLinkId:c}),type:a.communities},text:s,time:l,title:d},g={command:{correlation:{id:e,source:I.D.Notifications,startTimestamp:l.valueOf()},stateTransition:Ae.su.new,visibilityState:Ae.fe.show},entity:{action:Ie.u.view,type:Ie.p.toasts},entityOptions:m};return this.commandHandler(g)}showEspSyntheticNotification(e,{collectionId:t,mainImage:n,text:i,time:o,title:s,campaignType:l}){const d={collectionId:t,mainImage:n,targetEntity:{type:a.campaignnotifications,action:r.view,id:l,dataOptions:{actionType:"Unknown",userContextId:this.userContextId}},text:i,time:o,title:s},c={command:{correlation:{id:e,source:I.D.Notifications,startTimestamp:o.valueOf()},stateTransition:Ae.su.flush,visibilityState:Ae.fe.show},entity:{action:Ie.u.view,type:Ie.p.toasts},entityOptions:d};return this.commandHandler(c)}}const Yn=(e,t,n,i)=>({placeholderText:n||"Send a quick reply",sendButton:{text:t||"Send",targetEntity:{action:r.mutate,type:a.chats,dataOptions:{actionType:Hn.quickReply,convId:e,userContextId:i}}}});class Xn{constructor(e){this.commandHandler=e}showAccounts(){return this.commandHandler({entity:{type:Ie.p.accounts,action:Ie.u.list}})}}class Zn{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}default(e){return this.commandHandler({entity:{type:Ie.p.activity,action:Ie.u.default},command:e})}launchDeleteActivityFeedItemDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.activity,action:Ie.u.delete},{entityCommand:e})}launchActivityErrorDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.activity,action:Ie.u.error},{entityCommand:t})}}var ei=n(15053);class ti{constructor(e){this.commandHandler=e}openAIInsightsTab({entityCommand:e,messageId:t,threadId:n,transcriptId:i,meetingTitle:a,meetingTenantId:o,meetingOrganizerId:r},s){return this.commandHandler({entity:{type:Ie.p.aiinsightscontent,action:Ie.u.view},command:e,entityOptions:{messageId:t,threadId:n,transcriptId:i,eventId:(0,ei.cW)(s),meetingTitle:a,meetingTenantId:o,meetingOrganizerId:r}})}openAIInsightsTabInSchedulingForm({entityCommand:e,messageId:t,threadId:n,transcriptId:i,meetingTenantId:a,meetingOrganizerId:o},r,s){const l=(0,ei.cW)(r);return this.commandHandler({entity:{type:Ie.p.aiinsightscontent,action:Ie.u.view,linkedEntity:{type:Ie.p.schedulingform,action:Ie.u.view,id:JSON.stringify({eventId:l,providerType:s})}},command:e,entityOptions:{messageId:t,threadId:n,transcriptId:i,providerType:s,eventId:l,meetingTenantId:a,meetingOrganizerId:o}})}}var ni=n(60780);const ii={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataAuthUserAuthStateQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userAuthState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userContextId"},value:{kind:"Variable",name:{kind:"Name",value:"userContextId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"reason"}},{kind:"Field",name:{kind:"Name",value:"customError"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errorCode"}},{kind:"Field",name:{kind:"Name",value:"isExpected"}},{kind:"Field",name:{kind:"Name",value:"message"}},{kind:"Field",name:{kind:"Name",value:"context"}}]}}]}}]}}]};class ai{constructor(e,t,n,i){this.commandHandler=e,this.extensionCommanding=t,this.deeplinkCommandingService=n,this.client=i}signinPage(e){return this.commandHandler({entity:{type:Ie.p.identity,action:Ie.u.default},command:e})}accountList(e){return this.commandHandler({entity:{type:Ie.p.identity,action:Ie.u.list},command:e})}switchAccount({correlation:e,userContextId:t,targetEntity:n}){var i,a;return(0,c.mG)(this,void 0,void 0,(function*(){if(!this.client)throw new Error("client missing in switch account commanding");const{data:o}=(yield this.client.query({query:ii,variables:{userContextId:t},context:{correlation:e}}))||{};if((null==o?void 0:o.userAuthState)&&(null===(i=null==o?void 0:o.userAuthState)||void 0===i?void 0:i.state)!==Rt.UserAuthState.Up){const n=(null===(a=o.userAuthState.customError)||void 0===a?void 0:a.errorCode)===ni.SM.InteractionRequired?Ie.u.tenantLogin:Ie.u.error;return this.commandHandler({entity:{type:Ie.p.identitydialog,action:n},command:{visibilityState:Ae.fe.show,stateTransition:Ae.su.extend,correlation:e},entityOptions:{correlation:e,userContextId:t,userAuthState:null==o?void 0:o.userAuthState}})}return this.deeplinkCommandingService.launchMainApp(e,t,n)}))}signOutDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.signoutdialog,action:Ie.u.view},{entityCommand:e})}smartDeviceSignOutDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.smartdevicelogoutdialog,action:Ie.u.view},{entityCommand:e})}addAccountDialog(e){return this.commandHandler({entity:{type:Ie.p.identitydialog,action:Ie.u.create},command:{visibilityState:Ae.fe.show,stateTransition:Ae.su.extend,layoutMode:Ae.lO.focus,correlation:e},entityOptions:{correlation:e}})}addAccount(e){return this.commandHandler({entity:{type:Ie.p.identity,action:Ie.u.create},command:{visibilityState:Ae.fe.show,stateTransition:Ae.su.new,layoutMode:Ae.lO.focus,correlation:e},entityOptions:{correlation:e}})}closeAccountListDialog(e){return this.commandHandler({entity:{type:Ie.p.identitydialog,action:Ie.u.create},command:{visibilityState:Ae.fe.hide,stateTransition:Ae.su.flush,layoutMode:Ae.lO.focus,correlation:{source:e}}})}closeAccountLoginDialog(e){return this.commandHandler({entity:{type:Ie.p.identitydialog,action:Ie.u.tenantLogin},command:{visibilityState:Ae.fe.hide,stateTransition:Ae.su.flush,layoutMode:Ae.lO.focus,correlation:{source:e}}})}closeAddAccountListWindow(e){return this.commandHandler({entity:{type:Ie.p.identity,action:Ie.u.create},command:{visibilityState:Ae.fe.hide,stateTransition:Ae.su.flush,layoutMode:Ae.lO.focus,correlation:{source:e}}})}closeAccountListWindow(e){return this.commandHandler({entity:{id:Ae.lO.focus,type:Ie.p.identity,action:Ie.u.list},command:{visibilityState:Ae.fe.hide,stateTransition:Ae.su.flush,layoutMode:Ae.lO.focus,correlation:{source:e}}})}}class oi{constructor(e){this.commandHandler=e}viewAutoInstallNotification(e,t){return this.commandHandler({entity:{type:Ie.p.autoinstallnotification,action:Ie.u.view},command:t,entityOptions:e})}}class ri{constructor(e){this.commandHandler=e}navigateToFaceEnrollment(){return this.commandHandler({entity:{type:Ie.p.faceenrollment,action:Ie.u.view},command:{visibilityState:Ae.fe.show,stateTransition:Ae.su.flush,correlation:{startTimestamp:Date.now(),source:I.D.FaceEnrollmentGetStartedButton}}})}}class si{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}brbFeedbackDialogInMainWindow(e,t){return this.commandHandler({entity:{type:Ie.p.brbfeedbackdialog,action:Ie.u.view},command:e,entityOptions:t})}brbFeedbackDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.brbfeedbackdialog,action:Ie.u.view},{entityCommand:e})}autoBrbConfirmationDialog(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.autobrbconfirmationdialog,action:Ie.u.view},{entityCommand:e,entityOptions:t})}}class li{constructor(e){this.commandHandler=e}openBreakoutRooms(e,t){return this.commandHandler({entity:{type:Ie.p.breakoutrooms,action:Ie.u.view},entityOptions:t,command:e})}showAssignmentDialog(e){return this.showDialog(Ie.p.breakoutroomsassignment,e)}showAssignmentTypeDialog(e){return this.showDialog(Ie.p.breakoutroomsassignmenttype,e)}showCreateRoomsDialog(e){return this.showDialog(Ie.p.breakoutroomscreaterooms,e)}showDeleteRoomDialog(e){return this.showDialog(Ie.p.breakoutroomsdeleteroom,e)}showDeleteRoomsDialog(e){return this.showDialog(Ie.p.breakoutroomsdeleterooms,e)}showEditRoomDialog(e){return this.showDialog(Ie.p.breakoutroomseditroom,e)}showSettingsDialog(e){return this.showDialog(Ie.p.breakoutroomssettings,e)}showDialog(e,t){return this.commandHandler({entity:{type:e,action:Ie.u.view},command:{stateTransition:Ae.su.extend,correlation:{source:I.D.ExtensionCommanding},visibilityState:t}})}}class di{constructor(e){this.commandHandler=e}qnaPanelById(e,t){return this.commandHandler({entity:{type:Ie.p.broadcastqna,action:Ie.u.view,id:e,linkedEntity:{type:Ie.p.calls,id:e}},command:t})}infoPanelById(e,t){return this.commandHandler({entity:{type:Ie.p.broadcasts,action:Ie.u.info,id:e,linkedEntity:{type:Ie.p.calls,id:e}},command:t})}broadcastById(e,t,n){return this.commandHandler({entity:{type:Ie.p.broadcasts,action:Ie.u.view,id:e},command:t,entityOptions:n})}broadcastFeedbackById(e,t,n){return this.commandHandler({entity:{type:Ie.p.broadcastfeedback,action:Ie.u.view,id:e},command:t,entityOptions:n})}broadcastLeave(e,t,n){return this.commandHandler({entity:{type:Ie.p.broadcasts,action:Ie.u.leave,id:e},command:t,entityOptions:n})}}class ci{constructor(e,t){this.extensionCommanding=e,this.commandHandler=t}meetingDetails(e,t,n){return this.commandHandler({entity:{type:Ie.p.schedulingform,action:Ie.u.view,id:e},command:t,entityOptions:n})}openCalendarSurface(e,t,n,i){return this.commandHandler({entity:{type:Ie.p.calendar,action:Ie.u.view,id:e,linkedEntity:i},command:t,entityOptions:n})}openCalendarAgendaView(e,t,n){return this.commandHandler({entity:{type:Ie.p.calendar,action:Ie.u.list,linkedEntity:n},command:e,entityOptions:t})}openChannelCalendarSurface(e,t,n,i){const a={entity:{action:Ie.u.view,id:e,linkedEntity:i,type:Ie.p.channelcalendar},command:t,entityOptions:n};return this.commandHandler(a)}openSchedulingFormInMainWindow(e,t,n){return this.commandHandler({entity:{type:Ie.p.schedulingform,action:Ie.u.create,id:e},command:t,entityOptions:n})}openBroadcast(e,t,n,i){const a={type:Ie.p.broadcastliveevent,id:e,action:t};return this.extensionCommanding.executeCommand(a,{entityCommand:{visibilityState:Ae.fe.show,stateTransition:Ae.su.none,correlation:{source:n}},entityOptions:i})}closeSchedulingForm(e,t,n){return this.commandHandler({entity:e,command:t,entityOptions:n})}showCalendarErrorModal(e){return this.extensionCommanding.executeCommand({type:Ie.p.calendar,action:Ie.u.error},{entityCommand:{stateTransition:Ae.su.extend,visibilityState:Ae.fe.show,correlation:{source:I.D.CalendarEventAction}},entityOptions:e})}addBlockingConfirmationDialog(e,t){return this.extensionCommanding.addBlockingExtension({type:Ie.p.calendar,action:Ie.u.confirm},e,t)}showConfirmationDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.calendar,action:Ie.u.confirm},{entityCommand:{visibilityState:Ae.fe.show,stateTransition:Ae.su.extend,correlation:{source:I.D.CalendarEventAction}},entityOptions:e})}showShareDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.calendar,action:Ie.u.share},{entityCommand:{visibilityState:Ae.fe.show,stateTransition:Ae.su.extend,correlation:{source:I.D.CalendarEventAction}},entityOptions:e})}showEmbedDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.calendar,action:Ie.u.info},{entityCommand:{visibilityState:Ae.fe.show,stateTransition:Ae.su.extend,correlation:{source:I.D.CalendarEventAction}},entityOptions:e})}openConnectedCalendarDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.connectedcalendardialog,action:Ie.u.view},{entityCommand:{visibilityState:Ae.fe.show,stateTransition:Ae.su.extend,correlation:{source:I.D.CalendarSettings}},entityOptions:e})}}class ui{constructor(e,t,n){this.commandHandler=e,this.extensionCommanding=t,this.userContextId=n}call(e,t){return this.commandHandler({entity:{type:Ie.p.calls,action:Ie.u.list,id:e},command:t})}callDebug(e){return this.commandHandler({entity:{type:Ie.p.calls,action:Ie.u.info},command:e})}dialPad(e){return this.commandHandler({entity:{type:Ie.p.calls,action:Ie.u.join},command:e})}callById(e,t,n,i,a){let o;return n&&(o={type:Ie.p.chats,id:n}),a&&(o={type:Ie.p.callingdeeplink,id:a}),this.commandHandler({entity:{type:i||Ie.p.calls,action:Ie.u.view,id:e,linkedEntity:o},command:t})}callStageContentById(e,t){return this.commandHandler({entity:{type:Ie.p.stagecontent,action:Ie.u.view},entityOptions:t,command:e})}callList(e){return this.commandHandler({entity:{type:Ie.p.calls,action:Ie.u.list},command:e})}deviceSettingsById(e,t,n={useCall:!0}){return this.commandHandler({entity:{type:Ie.p.devicesettings,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e}},entityOptions:n,command:t})}callNotification(e,t,n,i){var a;const o=e.entityOptions;return o.targetEntity.dataOptions.userContextId=this.userContextId,null===(a=o.buttons)||void 0===a||a.forEach((e=>{e.targetEntity.dataOptions.userContextId=this.userContextId})),i===Rt.CallingContentActionVisibility.Hide?this.commandHandler({entity:{id:t,action:Ie.u.view,type:Ie.p.toasts},command:{correlation:{id:n,source:I.D.Calling},stateTransition:Ae.su.new,visibilityState:Ae.fe.hide},entityOptions:o}):this.commandHandler({entity:{action:Ie.u.view,type:Ie.p.toasts,id:t},command:e.command,entityOptions:o})}cameraEffectsSettingsById(e,t){return this.commandHandler({entity:{type:Ie.p.cameraeffects,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e}},entityOptions:{commandSource:null==t?void 0:t.correlation.source},command:t})}customVideoBackgroundSettingsById(e,t){return this.commandHandler({entity:{type:Ie.p.videobackgrounds,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e}},command:t})}callRosterById(e,t){return this.commandHandler({entity:{type:Ie.p.roster,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e}},command:t})}callDetailsById(e,t,n){return this.commandHandler({entity:{type:Ie.p.meetingdetails,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e},id:e},entityOptions:{didMeetingNotesAutoOpen:n},command:t})}callInfoById(e,t){return this.commandHandler({entity:{type:Ie.p.calls,action:Ie.u.info,linkedEntity:{type:Ie.p.calls,id:e}},command:t})}callNotesById(e,t){return this.commandHandler({entity:{type:Ie.p.notes,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e}},command:t})}transcriptPanelById(e,t){return this.commandHandler({entity:{type:Ie.p.transcript,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e}},command:t})}callHealthPanelById(e,t){return this.commandHandler({entity:{type:Ie.p.calls,action:Ie.u.health,linkedEntity:{type:Ie.p.calls,id:e}},command:t})}mediaStreamsPanelById(e,t){return this.commandHandler({entity:{type:Ie.p.mediastreams,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e}},command:t})}callBreakoutRoomById(e,t){return this.commandHandler({entity:{type:Ie.p.breakoutroomspanel,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e},id:e},command:t})}createById(e,t,n,i){return this.commandHandler({entity:{id:e,type:t,action:Ie.u.create},command:n,windowOptions:i})}callMonitorById(e,t,n){return this.commandHandler({entity:{type:Ie.p.callsmonitor,action:Ie.u.view},entityOptions:e&&{callingIntentId:e},command:t,windowOptions:n})}callShareMeetingInviteDialogById(e,t,n){return this.extensionCommanding.executeCommand(e,{entityOptions:t,entityCommand:{visibilityState:Ae.fe.show,stateTransition:Ae.su.extend,correlation:{source:n}}})}callsKeypad(e,t){return this.commandHandler({entity:{type:Ie.p.callskeypad,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e}},command:t})}callMeetingOptionsById(e,t){return this.commandHandler({entity:{type:Ie.p.meetings,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e}},command:t})}callsTransfer(e,t){return this.commandHandler({entity:{type:Ie.p.callstransfer,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e}},command:t})}contentCameraSetupDialog(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.contentcamerasetup,action:Ie.u.create},{entityOptions:t,entityCommand:{visibilityState:Ae.fe.show,stateTransition:Ae.su.none,correlation:{source:n}}})}startMeetingStream(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.meetingstream,action:Ie.u.create},{entityCommand:{visibilityState:Ae.fe.show,stateTransition:Ae.su.none,correlation:{source:e}},entityOptions:t})}stagingRoomStartMeetingConfirmationDialog(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.stagingroomstartmeetingconfirmationdialog,action:Ie.u.create},{entityCommand:{visibilityState:Ae.fe.show,stateTransition:Ae.su.extend,correlation:{source:t}},entityOptions:n})}openDialog(e,t,n){return this.extensionCommanding.executeCommand(e,{entityOptions:n,entityCommand:t})}callableChannelById(e,t,n){return this.commandHandler({entity:{id:t,type:Ie.p.callablechannels,action:Ie.u.list,linkedEntity:{id:e,type:Ie.p.channels,action:Ie.u.view}},command:n})}toggleRoomRemote(e,t,n){return this.commandHandler({entity:{type:Ie.p.roomremote,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e}},entityOptions:n,command:t})}accessibilityPanelById(e,t){return this.commandHandler({entity:{type:Ie.p.accessibilitypanel,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e}},command:t})}closedCaptionsSettingsPanelById(e,t){return this.commandHandler({entity:{type:Ie.p.closedcaptionssettings,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e}},command:t})}meetingCollab(e,t){return this.commandHandler({entity:{type:Ie.p.meetingcollaboration,action:Ie.u.view},entityOptions:e,command:t})}presenterToolbarById(e,t){return this.commandHandler({entity:{type:Ie.p.presentertoolbar,action:Ie.u.view},entityOptions:e&&{callingIntentId:e},command:t})}}class mi{constructor(e){this.commandHandler=e}navigateById(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){return this.commandHandler({entity:{type:Ie.p.campaignnotifications,action:Ie.u.view,id:e},entityOptions:null==t?void 0:t.entityOptions,command:null==t?void 0:t.entityCommand,scenarioEventData:null==t?void 0:t.scenarioEventData})}))}}class gi{constructor(e){this.commandHandler=e}default(e){return this.commandHandler({entity:{type:Ie.p.channels,action:Ie.u.default},command:e})}channelDeeplinkWithMessageId(e,t,n){return this.commandHandler({entity:{type:Ie.p.channels,action:Ie.u.view,id:e},command:t,entityOptions:n})}channelMessagesById(e,t,n,i,a,o){const r={channelId:e,replyChainId:t};return this.commandHandler({entity:{type:Ie.p.channels,action:Ie.u.view,id:JSON.stringify(r)},command:i,entityOptions:Object.assign(Object.assign({},a),{deepLinkId:n}),scenarioEventData:null==o?void 0:o.scenarioEventData})}toggleChannelInfoPane(e,t){const{channelId:n}=pi(e),i=JSON.stringify({channelId:n});return this.commandHandler({entity:{type:Ie.p.channels,action:Ie.u.info,id:i},command:t})}toggleChannelInfoPaneExpandedView(e,t,n){const{channelId:i,replyChainId:a}=pi(e),o=JSON.stringify({channelId:i,replyChainId:a});return this.commandHandler({entity:{type:n,action:Ie.u.info,id:o,linkedEntity:{id:e,type:Ie.p.channels}},command:t})}}const pi=e=>{if(!e)return{teamId:void 0,channelId:void 0,replyChainId:void 0};try{const{teamId:t,channelId:n,replyChainId:i}=JSON.parse(e);return{teamId:t,channelId:n,replyChainId:i}}catch(t){return{channelId:e}}};class hi{constructor(e,t,n,i){this.commandHandler=e,this.extensionCommanding=t,this.coreSettings=n,this._logger=i.newLogger("ChatCommandingService")}default(e){return this.handleCommandWithChecks({entity:{type:Ie.p.chats,action:Ie.u.default},command:e})}empty(e){return this.handleCommandWithChecks({entity:{type:Ie.p.chats,action:Ie.u.empty},command:e})}chatList(e,t){return this.handleCommandWithChecks({entity:{type:Ie.p.chats,action:Ie.u.list},entityOptions:null==t?void 0:t.entityOptions,command:e})}chatById(e,t){return this.handleCommandWithChecks({entity:{type:Ie.p.chats,action:Ie.u.view,id:e},entityOptions:null==t?void 0:t.entityOptions,command:null==t?void 0:t.entityCommand,scenarioEventData:null==t?void 0:t.scenarioEventData})}chatWithUsers(e){const t=(0,ei.Mf)((null==e?void 0:e.userIds)||[],null==e?void 0:e.entityCommand);return this.handleCommandWithChecks(Object.assign(Object.assign({},t),{entityOptions:null==e?void 0:e.entityOptions}))}chatWithGuardians(e,t,n,i,a,o){const r=(0,ei.Mf)(t||[],o),s={groupName:n,isGuardiansChat:!0,guardiansChatGroupId:e,guardiansChatStudentId:i,guardiansPreferredToAlternateMriMappings:a};return this.handleCommandWithChecks(Object.assign(Object.assign({},r),{entityOptions:s}))}orgChat(e,t){return this.handleCommandWithChecks({entity:{type:Ie.p.extensions,action:Ie.u.view,id:Ae.oz.organization,linkedEntity:{type:Ie.p.chats,id:(0,ei.f$)([e])}},command:t})}linkedIn(e,t){return this.handleCommandWithChecks({entity:{type:Ie.p.extensions,action:Ie.u.view,id:Ae.oz.linkedin,linkedEntity:{type:Ie.p.chats,id:(0,ei.f$)([e])}},command:t})}openLpcInMainWindow(e,t){return this.commandHandler({entity:{type:Ie.p.livepersonacard,action:Ie.u.view},command:t,entityOptions:e})}launchAltText(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.alttext,action:Ie.u.view},{entityCommand:t,entityOptions:{element:e}})}launchInsertHyperlink(e,t,n){return this.extensionCommanding.executeCommand({type:Ie.p.hyperlink,action:Ie.u.view},{entityCommand:n,entityOptions:{displayText:e,address:t}})}launchDiscardCodeSnippet(e){return this.extensionCommanding.executeCommand({type:Ie.p.codesnippet,action:Ie.u.delete},{entityCommand:e})}launchTranslationFeedbackDialog(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.translationfeedback,action:Ie.u.view},{entityCommand:t,entityOptions:e})}launchTwoWaySmsFriendlyNameDialog(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.twowaysmsfriendlyname,action:Ie.u.view},{entityCommand:t,entityOptions:e})}launchDeleteChat(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.deletechat,action:Ie.u.delete},{entityCommand:t,entityOptions:e})}launchDiscardFluid(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.fluid,action:Ie.u.delete},{entityCommand:t,entityOptions:{isCompose:e}})}launchUpdatePermissionsFluid(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.fluid,action:Ie.u.update},{entityCommand:t,entityOptions:{upns:e}})}launchUnpinMessageFromChat(e){return this.extensionCommanding.executeCommand({type:Ie.p.pinnedconversationitems,action:Ie.u.delete},{entityCommand:e})}launchReplaceMessageFromChat(e){return this.extensionCommanding.executeCommand({type:Ie.p.pinnedconversationitems,action:Ie.u.update},{entityCommand:e})}launchDiscardMessageDraft(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.messagedraft,action:Ie.u.delete},{entityCommand:t,entityOptions:{isBranded:e}})}launchGiphyConsent(e){return this.extensionCommanding.executeCommand({type:Ie.p.giphyconsent,action:Ie.u.view},{entityCommand:e})}launchLeaveChat(e){return this.extensionCommanding.executeCommand({type:Ie.p.leavechat,action:Ie.u.delete},{entityCommand:e})}launchMaxPinnedChatsReached(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.pinnedchatsmaxreached,action:Ie.u.view},{entityCommand:t,entityOptions:{maxPinnedChats:e}})}launchUpdateGroupChatAvatar(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.updategroupchatavatar,action:Ie.u.view},{entityCommand:t,entityOptions:{threadId:e}})}launchRemoveChatUser(e,t,n){return this.extensionCommanding.executeCommand({type:Ie.p.removechatuser,action:Ie.u.delete},{entityCommand:n,entityOptions:{userName:e,isRemoveTfwUserInTflChat:t}})}launchShareChatLink(e,t,n,i,a,o,r){return this.extensionCommanding.executeCommand({action:Ie.u.view,id:e,type:Ie.p.sharechatlink},{entityCommand:r,entityOptions:{chatTitle:t,hasError:n,sharedLink:i,cfet:a,panelType:o}})}launchChatError(e,t){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.chats,action:Ie.u.error},{entityCommand:t})}launchStreamCamera(e){return this.extensionCommanding.executeCommand({type:Ie.p.streamcamera,action:Ie.u.default,id:null==e?void 0:e.correlation.id},{entityCommand:e})}meetingRecapTab(e,t,n,i){return this.handleCommandWithChecks({entity:{type:Ie.p.meetingrecaptab,action:Ie.u.view,id:e},entityOptions:{threadId:e,callId:t,tenantId:n,organizerId:i}})}transcriptTab(e,t,n,i,a,o,r){return this.handleCommandWithChecks({entity:{type:Ie.p.transcripttab,action:Ie.u.view,id:t},entityOptions:{conversationId:e,storageId:n,teamsCallId:i,meetingOrganizerId:a,meetingTenantId:o,eventId:r}})}launchReportConcern(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.reportConcern,action:Ie.u.create},{entityCommand:t,entityOptions:e})}launchReportConcernV2(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.reportConcernForTFW,action:Ie.u.create},{entityCommand:t,entityOptions:e})}launchReportConcernTY(e){return this.extensionCommanding.executeCommand({type:Ie.p.reportConcern,action:Ie.u.info},{entityCommand:e})}launchReportConcernV2Confirmation(e){return this.extensionCommanding.executeCommand({type:Ie.p.reportConcernForTFW,action:Ie.u.info},{entityCommand:e})}launchDlpDialog(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.dlp,action:Ie.u.view},{entityCommand:t,entityOptions:e})}chatInfoPane(e,t,n){return this.handleCommandWithChecks({entity:{type:Ie.p.chatsInfoView,action:Ie.u.info,id:e},command:t,entityOptions:n})}chatContextualSearch(e,t,n){return this.handleCommandWithChecks({entity:{type:Ie.p.chatContextualSearch,action:Ie.u.info,id:e},command:t,entityOptions:n})}chatInfoPaneDetails(e,t,n){return this.handleCommandWithChecks({entity:{type:Ie.p.chatsInfo,action:Ie.u.infoDetails,id:e},command:t,entityOptions:n})}launchBlockChatDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.blockChat,action:Ie.u.view},{entityCommand:e})}launchLeaveGroupAndBlockUserDialog(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.leaveGroupAndBlockUser,action:Ie.u.view},{entityCommand:t,entityOptions:e})}handleCommandWithChecks(e){return this.checkPolicies(e),this.commandHandler(e)}checkPolicies(e){var t,n,i;if(this.coreSettings.get(A.J.Messaging).allowUserChat||(null===(t=e.entity.id)||void 0===t?void 0:t.startsWith("19:meeting")))return;const{type:a,action:o}=e.entity,r=`${_.w5.Commanding}::${_.jK.PolicyCheckFailed}::Chat command not allowed due to policy (allowUserChat=false)`;null===(i=(n=this._logger).errorToTelemetry)||void 0===i||i.call(n,r,"messaging_command_policy_violation",{mainEntityType:a,mainEntityAction:o})}}class vi{constructor(e){this.commandHandler=e}coachReport(e,t){return this.commandHandler({entity:{type:Ie.p.coachreport,action:Ie.u.view},command:e,entityOptions:t})}}class Si{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}showCommunityLinkDialog(e,t){return this.commandHandler({entity:{action:Ie.u.view,id:e,type:Ie.p.sharecommunitieslink},entityOptions:{},command:t})}showReportConcernDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.reportconcerncommunities,action:Ie.u.create},{entityCommand:t})}showReportConcernTY(e,t){return this.commandHandler({entity:{type:Ie.p.reportconcerncommunities,action:Ie.u.view,id:e},entityOptions:{},command:t})}communityMessagesById(e,t,n,i,a,o){const r={channelId:e,replyChainId:t};return this.commandHandler({entity:{type:Ie.p.communities,action:Ie.u.view,id:JSON.stringify(r)},command:i,entityOptions:Object.assign(Object.assign({},a),{deepLinkId:n}),scenarioEventData:null==o?void 0:o.scenarioEventData})}getCommunityView(){return this.getView(Ie.p.communities)}getOnboardingView(){return this.getView(Ie.p.communitiesonboarding,Ie.u.view)}navigateToCommunityId(e){const t={stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:I.D.ChannelListItem}};return this.communityMessagesById(e,void 0,void 0,t)}getView(e,t){return this.commandHandler({entity:{type:e,action:null!=t?t:Ie.u.default},command:{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:I.D.ChannelListItem}}})}}class fi{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}openContactsSyncPopout(e){return this.commandHandler({entity:{type:Ie.p.contactssync,action:Ie.u.default,id:"default"},command:(null==e?void 0:e.entityCommand)||{stateTransition:Ae.su.new,visibilityState:Ae.fe.show,correlation:{source:I.D.Flyout}},windowOptions:null==e?void 0:e.windowOptions})}openContactsSyncModal(){return this.extensionCommanding.executeCommand({type:Ie.p.contactssync,action:Ie.u.view,id:"default"})}launchContactsModal(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.contactssync,action:Ie.u.info,id:e},{entityCommand:{stateTransition:Ae.su.extend,visibilityState:Ae.fe.show,correlation:t}})}showHideContactsView(e,t,n){return this.commandHandler({entity:{type:Ie.p.contactssync,action:Ie.u.view,id:e},command:{stateTransition:Ae.su.flush,visibilityState:n?Ae.fe.show:Ae.fe.hide,correlation:t}})}}class yi{constructor(e){this.commandHandler=e}discoverApps(e,t){return this.commandHandler({entity:{type:Ie.p.discoverappsnotifications,action:Ie.u.view},command:t,entityOptions:e})}}class ki{constructor(e,t){this.commandHandler=e,this.loggerFactory=t,this.logger=this.loggerFactory.newLogger("DiscoverSurfaceCommandingService")}showDiscoverSurface(e){return this.logger.log(`showDiscoverSurface: called with - ${Ie.p.discoversurface}:${Ie.u.view}`),this.commandHandler({entity:{type:Ie.p.discoversurface,action:Ie.u.view},command:null==e?void 0:e.entityCommand,entityOptions:null==e?void 0:e.entityOptions})}}class Ci{constructor(e){this.commandHandler=e}launchErrorApp(e){return this.commandHandler({entity:{type:Ie.p.error,action:Ie.u.view},command:{stateTransition:Ae.su.forceFlush,visibilityState:Ae.fe.show,correlation:{source:I.D.LayoutError}},entityOptions:{errorReason:e.code}})}}class bi{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t,this.entityAllowList=[Ie.p.esp,Ie.p.help,Ie.p.storefre]}displaySurface(e,t){return this.commandHandler({entity:{type:Ie.p.esp,action:Ie.u.create,id:e},entityOptions:{forceShow:t}})}displayFollowUpSurface(e,t){const n=Rt.EspTrigger.FollowUp;return this.commandHandler({entity:{type:Ie.p.esp,action:Ie.u.create,id:e},entityOptions:{forceShow:t,espTrigger:n}})}launchDialog(e,t){let n=Ie.p.esp;if(t){if(!this.entityAllowList.includes(t))throw new Error("launchDialog must be called with Entity from the allow list.");n=t}return this.extensionCommanding.executeCommand({id:e,type:n,action:Ie.u.view})}navigate(e,t,n){return this.commandHandler({entity:e,command:t,entityOptions:n})}}class Ti{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}surveyDialogWithObserver(e,t){return this.extensionCommanding.executeCommand({action:Ie.u.view,type:Ie.p.survey,id:e},{entityCommand:t})}surveyDialog(e,t){return this.commandHandler({entity:{type:Ie.p.survey,action:Ie.u.view,id:e},command:t})}giveFeedbackDialog(e){return this.commandHandler({entity:{type:Ie.p.givefeedbackchoices,action:Ie.u.view},command:e})}}class wi{constructor(e,t){this.extensionCommanding=e,this.commandHandler=t}galleryImage(e,t){const n=e.galleryId,i={type:Ie.p.galleryImages,action:Ie.u.view,id:n};return this.commandHandler({entity:i,command:t,entityOptions:e})}galleryImageExtended(e,t){const n=e.galleryId,i={type:Ie.p.galleryImages,action:Ie.u.view,id:n};return this.extensionCommanding.executeCommand(i,{entityCommand:t,entityOptions:e})}fileById(e){const t=e.fileId;return this.commandHandler({entity:{type:Ie.p.file,action:Ie.u.view,id:t},entityOptions:e})}launchFileViewApp(e,t,n=I.D.FileViewer){const i={subEntityId:JSON.stringify(t)};return this.commandHandler({entity:{type:Ie.p.extensions,action:Ie.u.view,id:JSON.stringify({appId:e}),linkedEntity:{id:JSON.stringify(i),type:Ie.p.extensions}},command:{visibilityState:Ae.fe.show,stateTransition:Ae.su.flush,correlation:{source:n}}})}openInOneup(e,t=I.D.FileViewer){const n=e.fileId;let i,a;if("channelsPDFTab"===e.context){const t={channelId:e.threadId,replyChainId:void 0};a={type:Ie.p.filesoneupviewer,action:Ie.u.view,id:e.entityId,linkedEntity:{id:JSON.stringify(t),type:Ie.p.channels}},i=I.D.ChannelHeader}else a={type:Ie.p.filesoneupviewer,action:Ie.u.view,id:n},i=t;return this.commandHandler({entity:a,command:{visibilityState:Ae.fe.show,stateTransition:Ae.su.flush,correlation:{id:(0,Je.v4)(),source:i}},entityOptions:e})}closeOneup(e,t=I.D.FileViewer){return this.commandHandler({entity:{type:Ie.p.filesoneupviewer,action:Ie.u.view,id:e},command:{visibilityState:Ae.fe.hide,stateTransition:Ae.su.flush,correlation:{source:t}}})}fileOpenSettingsSuggestion(e){return this.commandHandler({entity:{type:Ie.p.fileopensettings,action:Ie.u.info},entityOptions:e})}fileOpenSettingsUpdate(e){return this.commandHandler({entity:{type:Ie.p.fileopensettings,action:Ie.u.update},entityOptions:e})}chatFilesList(e,t){return this.commandHandler({entity:{id:null,type:Ie.p.file,action:Ie.u.list,linkedEntity:{type:Ie.p.chats,id:e}},command:t})}photosList(e,t){return this.commandHandler({entity:{id:null,type:Ie.p.gallery,action:Ie.u.view,linkedEntity:{type:Ie.p.chats,id:e}},command:t})}launchFilePicker(e,t,n){return this.extensionCommanding.executeCommand({type:Ie.p.filepicker,action:Ie.u.view},{entityCommand:n,entityOptions:{fileContainerKey:e,filePickerContext:t}})}}class _i{constructor(e){this.commandHandler=e}launchFlyoutHomePage(){const e={id:(0,Je.v4)(),source:I.D.Flyout,startTimestamp:Date.now()};return this.commandHandler({entity:{type:Ie.p.flyout,action:Ie.u.default},command:{correlation:e,stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,layoutMode:Ae.lO.minimal}})}}class Ii{constructor(e){this.commandHandler=e}freemiumUpgrade(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){return this.commandHandler({entity:{type:Ie.p.freemiumupgrade,action:Ie.u.view},command:e,entityOptions:t})}))}}class Ai{constructor(e){this.commandHandler=e}guardiansTabInChannelById(e,t,n,i){const a={type:Ie.p.guardians,action:Ie.u.list,id:e,linkedEntity:n};return this.commandHandler({entity:a,command:t,entityOptions:i})}}class Ni{constructor(e){this.extensionCommanding=e}showCreatePostDialog(e,t,n,i){return this.extensionCommanding.executeCommand({type:Ie.p.classesintegrationcontent,action:Ie.u.create},{entityCommand:{stateTransition:Ae.su.extend,visibilityState:Ae.fe.show,correlation:{source:I.D.LmsCourseTeams}},entityOptions:{teamId:e,teamName:t,groupId:n,tenantId:i}})}}class Ei{constructor(e){this.commandHandler=e}viewLobNotifications(e,t){return this.commandHandler({entity:{type:Ie.p.lobnotifications,action:Ie.u.view},command:t,entityOptions:e})}}class Di{constructor(e){this.commandHandler=e}analytics(e,t){return this.commandHandler({entity:{type:Ie.p.meetinganalytics,action:Ie.u.view},command:e,entityOptions:t})}openAttendanceTabInSchedulingForm(e,t,n="",i=0){return this.commandHandler({entity:{type:Ie.p.attendancereport,action:Ie.u.view,linkedEntity:{type:Ie.p.schedulingform,action:Ie.u.view,id:JSON.stringify({eventId:(0,ei.cW)(n),providerType:i})}},command:e,entityOptions:Object.assign(Object.assign({},t),{eventId:(0,ei.cW)(n)})})}openAnalyticsInSchedulingForm(e,t,n="",i=0){return this.commandHandler({entity:{type:Ie.p.meetinganalytics,action:Ie.u.view,linkedEntity:{type:Ie.p.schedulingform,action:Ie.u.view,id:JSON.stringify({eventId:(0,ei.cW)(n),providerType:i})}},command:e,entityOptions:Object.assign(Object.assign({},t),{eventId:(0,ei.cW)(n)})})}openAttendanceTabInMeetingChat(e,t){return this.commandHandler({entity:{type:Ie.p.meetinganalytics,action:Ie.u.view},command:e,entityOptions:{threadId:t}})}openMeetingRecapTabInMeetingChat(e,t){return this.commandHandler({entity:{type:Ie.p.meetingrecap,action:Ie.u.view},command:e,entityOptions:t})}openMeetingRecapTabInSchedulingForm(e,t){return this.commandHandler({entity:{type:Ie.p.meetingrecap,action:Ie.u.view},command:e,entityOptions:t})}}class Fi{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}meetingOptionsFormView(e,t,n,i,a,o){return this.commandHandler({entity:{type:Ie.p.meetings,action:Ie.u.view,id:this.serializeMeetingCoordinates(e,t,n,i,a)},command:o})}meetingOptionsCreateViewDialog(e,t,n){const i={type:Ie.p.meetingoptionscreatedialog,id:e.id,action:e.action};return this.extensionCommanding.executeCommand(i,{entityCommand:t,entityOptions:n})}serializeMeetingCoordinates(e,t,n,i,a){return JSON.stringify({tenantId:e,organizerId:t,threadId:n,messageId:i,additionalMessageId:a})}}var Pi,Mi,ji,Ri,xi,Oi,Li,Ui,Bi,Wi,Gi;!function(e){e.Voicemail="voicemail",e.MissedCalls="missed-calls"}(Pi||(Pi={})),function(e){e.TranscriptionUFD="TranscriptionUFD",e.CatchUpUFD="CatchUpUFD",e.WrapUpUFD="WrapUpUFD",e.UBAR="UBAR"}(Mi||(Mi={})),function(e){e.Invite="Invite",e.Claim="Claim",e.FileShare="FileShare",e.Community="Community",e.PlatformExtension="PlatformExtension"}(ji||(ji={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(Ri||(Ri={})),function(e){e.Outlook="Outlook",e.Google="Google"}(xi||(xi={})),function(e){e.template="template",e.group="group",e.team="team"}(Oi||(Oi={})),function(e){e[e.MessageExtensionsFlyout=0]="MessageExtensionsFlyout",e[e.MeetingAppsFlyout=1]="MeetingAppsFlyout",e[e.ChannelMeetingAppsFlyout=2]="ChannelMeetingAppsFlyout"}(Li||(Li={})),function(e){e[e.Whiteboard=0]="Whiteboard",e[e.Document=1]="Document",e[e.Video=2]="Video"}(Ui||(Ui={})),function(e){e.JoinByCode="JoinByCode",e.Dialpad="Dialpad",e.Cortana="Cortana",e.SmartDeviceJoinByCode="SmartDeviceJoinByCode"}(Bi||(Bi={})),function(e){e.sideload="sideload",e.staging="staging",e.tenant="tenant"}(Wi||(Wi={})),function(e){e[e.AppDetailsDialog=1]="AppDetailsDialog"}(Gi||(Gi={}));class Vi{constructor(e){this.commandHandler=e}meetingRoomConsoleInCallById(e,t,n){return this.commandHandler({entity:{type:Ie.p.meetingroomconsolecall,action:Ie.u.view,id:e},entityOptions:t,command:n})}meetingRoomNewCall(){return this.commandHandler({entity:{type:Ie.p.meetingroomconsolecall,action:Ie.u.create},entityOptions:{stateParams:{isPstnCall:!0},createCallType:Bi.Dialpad},command:{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:I.D.Calling}}})}meetingRoomSmartDeviceJoinByCode(e){return this.commandHandler({entity:{type:Ie.p.meetingroomconsolecall,action:Ie.u.create},entityOptions:{createCallType:Bi.SmartDeviceJoinByCode},command:e})}meetingRoomJoinByCode(e){return this.commandHandler({entity:{type:Ie.p.meetingroomconsolecall,action:Ie.u.create},entityOptions:{createCallType:Bi.JoinByCode},command:e})}}class Hi{constructor(e){this.commandHandler=e}viewOnboardingNotifications(e,t){return this.commandHandler({entity:{type:Ie.p.onboardingnotifications,action:Ie.u.view},command:t,entityOptions:e})}}var $i,zi,qi,Ji,Qi,Ki,Yi,Xi,Zi;!function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}($i||($i={})),function(e){e.web="web",e.desktop="desktop",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows"}(zi||(zi={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.meetingStage="meetingStage"}(qi||(qi={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(Ji||(Ji={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(Qi||(Qi={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(Ki||(Ki={})),function(e){e.card="card",e.deepLink="deepLink",e.contentBubble="contentBubble",e.messageExtension="messageExtension",e.tab="tab",e.shareToOutlook="shareToOutlook",e.adaptiveCardTab="adaptiveCardTab",e.adaptiveCardCollabStage="adaptiveCardCollabStage",e.platformAppView="platformAppView",e.channelTab="channelTab",e.sidePanel="sidePanel",e.privateMeetingSchedulingForm="privateMeetingSchedulingForm",e.channelMeetingSchedulingForm="channelMeetingSchedulingForm",e.personalApp="personalApp",e.botConfig="botConfig"}(Yi||(Yi={})),function(e){e.teamsElectron="TEAMS-ELECTRON",e.teamsWeb="TEAMS-WEB"}(Xi||(Xi={}));class ea{constructor(e,t,n){this.commandHandler=e,this.extensionCommanding=t,this.coreSettings=n}launchTaskModule(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({id:e,type:Ie.p.taskmodule,action:Ie.u.create},{entityCommand:n,entityOptions:null==t?void 0:t.taskModuleOptions})}launchHWCTaskModule(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({id:e,type:Ie.p.hwctaskmodule,action:Ie.u.create},{entityCommand:n,entityOptions:null==t?void 0:t.taskModuleOptions})}launchStage(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultCommand();return t.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({type:Ie.p.platformStage,action:Ie.u.view},{entityCommand:t,entityOptions:null==e?void 0:e.stageOptions})}launchStageMW(e){return this.commandHandler({entity:{id:e.id,type:Ie.p.platformStage,action:Ie.u.create,linkedEntity:e.linkedEntity},command:{stateTransition:Ae.su.new,visibilityState:Ae.fe.show,correlation:{source:I.D.PlatformExtension}},entityOptions:e.stageOptions})}launchTabGallery(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultCommand();return t.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({type:Ie.p.platformTabGallery,action:Ie.u.view},{entityCommand:t,entityOptions:null==e?void 0:e.tabGalleryOptions})}launchAppDetails(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({id:e,type:Ie.p.platformapp,action:Ie.u.create},{entityCommand:n,entityOptions:null==t?void 0:t.platformAppDetailsOptions})}launchAppDetailsTutorial(e){const t=this.getDefaultCommand();return t.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({type:Ie.p.platformappdetails,action:Ie.u.info},{entityCommand:t,entityOptions:e})}launchAppRevokeConsent(e){const t=this.getDefaultCommand();return t.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({type:Ie.p.platformappconsent,action:Ie.u.delete},{entityCommand:t,entityOptions:e})}appDetailsPostInstall(e){const t=this.getDefaultCommand();return t.stateTransition=Ae.su.none,this.commandHandler({entity:{type:Ie.p.platformappdetails,action:Ie.u.config},command:t,entityOptions:e})}appDetailsOnDone(e,t){const n=this.getDefaultCommand();return n.stateTransition=Ae.su.none,this.commandHandler({entity:{id:e,type:Ie.p.platformappdetails,action:Ie.u.update},command:n,entityOptions:t})}launchInContextStore(e){const t=this.getDefaultCommand();return this.extensionCommanding.executeCommand({type:Ie.p.incontextstore,action:Ie.u.view},{entityCommand:t,entityOptions:e})}inContextStorePostInstall(e){const t=this.getDefaultCommand();return t.stateTransition=Ae.su.none,this.commandHandler({entity:{type:Ie.p.incontextstore,action:Ie.u.config},command:t,entityOptions:e})}inContextStoreOnDone(e,t){const n=this.getDefaultCommand();return n.stateTransition=Ae.su.none,this.commandHandler({entity:{id:e,type:Ie.p.incontextstore,action:Ie.u.update},command:n,entityOptions:t})}launchAppStore(e,t){return this.commandHandler({entity:{type:Ie.p.platformapps,action:Ie.u.list},command:t,entityOptions:e})}launchPersonalApp(e){const t=this.getDefaultCommand();return t.stateTransition=Ae.su.none,this.commandHandler({entity:{type:Ie.p.platformapp,action:Ie.u.view},command:t,entityOptions:e})}launchAppUninstall(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({id:e,type:Ie.p.platformapp,action:Ie.u.delete},{entityCommand:n,entityOptions:null==t?void 0:t.uninstallOptions})}launchAppError(e){const t=this.getDefaultCommand();return t.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({type:Ie.p.platformapp,action:Ie.u.error},{entityCommand:t,entityOptions:e})}launchUploadCustomApp(){const e=this.getDefaultCommand();return e.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({type:Ie.p.customapp,action:Ie.u.view},{entityCommand:e})}launchRequestSubmittedDialog(){const e=this.getDefaultCommand();return e.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({type:Ie.p.customapp,action:Ie.u.info},{entityCommand:e})}launchLocationDialog(e){const t=this.getDefaultCommand();return t.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({type:Ie.p.locationapi,action:Ie.u.create},{entityCommand:t,entityOptions:e})}launchSelectMediaDialog(e){const t=this.getDefaultCommand();return t.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({type:Ie.p.selectMediaApi,action:Ie.u.create},{entityCommand:t,entityOptions:e})}launchViewImagesDialog(e){const t=this.getDefaultCommand();return t.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({type:Ie.p.viewImagesApi,action:Ie.u.create},{entityCommand:t,entityOptions:e})}launchSelectPeoplePickerDialog(e){const t=this.getDefaultCommand();return t.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({type:Ie.p.selectpeoplepicker,action:Ie.u.view},{entityCommand:t,entityOptions:e})}launchAppConfig(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({id:e,type:Ie.p.platformapp,action:Ie.u.config},{entityCommand:n,entityOptions:null==t?void 0:t.launchAppConfigOptions})}launchTabInfo(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({id:e,type:Ie.p.platformtab,action:Ie.u.info},{entityCommand:n,entityOptions:null==t?void 0:t.launchTabInfoOptions})}launchStagedApps(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultCommand();return t.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({type:Ie.p.stagedapps,action:Ie.u.info},{entityCommand:t,entityOptions:null==e?void 0:e.launchStagedAppsOptions})}launchAppAuthConsent(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({id:e,type:Ie.p.platformauthconsentdialog,action:Ie.u.create},{entityCommand:n,entityOptions:null==t?void 0:t.launchAuthConsentOptions})}platformTabById(e,t,n,i){return this.commandHandler({entity:{id:e,type:Ie.p.extensions,action:Ie.u.view,linkedEntity:n},command:t,entityOptions:i})}launchPersonalPlatformApp(e,t,n,i,a){return this.commandHandler({entity:{id:JSON.stringify({appId:e,tabEntityId:n}),type:Ie.p.extensions,action:Ie.u.view,linkedEntity:a},command:{visibilityState:Ae.fe.show,stateTransition:t?Ae.su.new:Ae.su.flush,correlation:{source:null!=i?i:I.D.Nova,startTimestamp:Date.now()}},entityOptions:{isMultiWindow:t,entryPoint:Yi.personalApp}})}platformAppById(e,t,n){return this.commandHandler({entity:{id:e,type:Ie.p.extensions,action:Ie.u.view,linkedEntity:n},command:t})}navigateToManageApps(e){return this.commandHandler({entity:{type:Ie.p.platformapps,action:Ie.u.manage},entityOptions:e})}launchSubscriptionPlansDialog(e,t,n){const i=n||this.getDefaultCommand();return i.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({id:e,type:Ie.p.platformsubscriptionplans,action:Ie.u.info},{entityCommand:i,entityOptions:t})}launchAngularAppDetails(e,t,n){const{enableAppDetailsAngularFeatureParity:i}=this.coreSettings.get(A.J.Host);if(i)return this.launchAppDetails(e,{platformAppDetailsOptions:t,entityCommand:n});const a=n||this.getDefaultCommand();return a.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({id:e,type:Ie.p.platformapp,action:Ie.u.info},{entityCommand:a,entityOptions:t})}launchCustomAppFilePicker(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.customapp,action:Ie.u.create},{entityCommand:{visibilityState:Ae.fe.show,stateTransition:Ae.su.extend,correlation:{source:n||I.D.Store}},entityOptions:t})}launchWorkflowsDialog(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.workflows,action:Ie.u.create},{entityCommand:{visibilityState:Ae.fe.show,stateTransition:Ae.su.extend,correlation:{source:n||I.D.Store}},entityOptions:t})}launchManageWorkflows(e,t,n){return this.commandHandler({entity:{id:e,type:Ie.p.workflows,action:Ie.u.manage},entityOptions:t,command:{visibilityState:Ae.fe.show,stateTransition:Ae.su.none,correlation:{source:n||I.D.Store}}})}launchSettingsDialog(e,t,n){const i={visibilityState:Ae.fe.show,stateTransition:Ae.su.extend,correlation:{source:n||I.D.Card}};return this.extensionCommanding.executeCommand({id:e,type:Ie.p.settingsdialog,action:Ie.u.view},{entityCommand:i,entityOptions:t})}updatePlatformTabById(e,t,n,i){return this.commandHandler({entity:{id:e,type:Ie.p.extensions,action:Ie.u.update,linkedEntity:n},command:t,entityOptions:i})}videoEffectsCustomizationPanelById(e,t){return this.commandHandler({entity:{type:Ie.p.videoeffectscustomization,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e}},command:t})}videoEffectsMoreViewPanelById(e,t,n){return this.commandHandler({entity:{type:Ie.p.videoeffectsmoreview,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e}},command:t,entityOptions:n})}videoEffectsAndAvatarPanelById(e,t){return this.commandHandler({entity:{type:Ie.p.videoeffectsandavatar,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e}},command:t})}meshAvatarPanelById(e,t){return this.commandHandler({entity:{type:Ie.p.meshavatar,action:Ie.u.view,linkedEntity:{type:Ie.p.calls,id:e}},command:t})}launchManageAppsUninstall(e,t){const n=this.getDefaultCommand();return n.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({id:e,type:Ie.p.manageapps,action:Ie.u.delete},{entityCommand:n,entityOptions:t})}launchManageAppsWebhook(e,t){const n=this.getDefaultCommand();n.visibilityState=Ae.fe.show;const i=t.editMode?Ie.u.update:Ie.u.create;return this.extensionCommanding.executeCommand({id:e,type:Ie.p.manageappswebhook,action:i},{entityCommand:n,entityOptions:t})}launchManageAppsWebhookConfirmation(e){const t=this.getDefaultCommand(),n={webhookToken:e};return t.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({type:Ie.p.manageappswebhook,action:Ie.u.info},{entityCommand:t,entityOptions:n})}selectAppEntity(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultCommand();return t.visibilityState=Ae.fe.show,this.extensionCommanding.executeCommand({type:Ie.p.platformTabGallery,action:Ie.u.create},{entityCommand:t,entityOptions:null==e?void 0:e.selectAppEntityOptions})}launchAppDevicePermissions(e,t){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.platformappdevicepermissions,action:Ie.u.create},{entityCommand:this.getDefaultCommand(),entityOptions:t})}launchAppDevicePermissionsFirstRun(e,t){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.platformappdevicepermissions,action:Ie.u.update},{entityCommand:this.getDefaultCommand(),entityOptions:t})}launchRefreshConfirmationAfterAppDevicePermissionsUpdate(e,t){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.platformappdevicepermissions,action:Ie.u.confirm},{entityCommand:this.getDefaultCommand(),entityOptions:t})}getDefaultCommand(){return{stateTransition:Ae.su.extend,visibilityState:Ae.fe.show,correlation:{source:I.D.ExtensionCommanding}}}}class ta{constructor(e,t){this.commandHandler=e,this.coreSettings=t}registration(e){const{enableMultiWindowWebinarRegistration:t}=this.coreSettings.get(A.J.WebinarRegistration);return t?this.commandHandler({entity:{action:Ie.u.view,id:e,type:Ie.p.registration},command:{visibilityState:Ae.fe.show,stateTransition:Ae.su.new,correlation:{source:I.D.Calendar}}}):((0,Q.J)().open(`${(0,Q.J)().location.origin}/registration/${e}?mode=edit`,"_blank"),Promise.resolve())}}class na{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}showTeamsGrid(){return this.commandHandler({entity:{type:Ie.p.schoolteams,action:Ie.u.list},command:{visibilityState:Ae.fe.show,stateTransition:Ae.su.flush,correlation:{source:I.D.SchoolTeams}}})}gridTeamDiscover(){return this.commandHandler({entity:{type:Ie.p.schoolteams,action:Ie.u.join},command:{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:I.D.SchoolTeams}}})}showSingleTeam(e){return this.commandHandler({entity:{type:Ie.p.channels,action:Ie.u.view,id:e},command:{visibilityState:Ae.fe.show,stateTransition:Ae.su.flush,correlation:{source:I.D.SchoolTeams}}})}eduCreateTeam(){return this.extensionCommanding.executeCommand({type:Ie.p.eduteamcreate,action:Ie.u.view})}showUnlockDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.schoolteams,action:Ie.u.update,id:e},{entityCommand:{stateTransition:Ae.su.extend,visibilityState:Ae.fe.show,correlation:{source:I.D.UnlockTeam}}})}}class ia{constructor(e){this.commandHandler=e,this.updateSearchState=e=>this.commandHandler({entity:{type:Ie.p.search,action:Ie.u.view},command:{correlation:{id:(0,Je.v4)(),startTimestamp:Date.now(),source:I.D.Search},stateTransition:Ae.su.none,visibilityState:Ae.fe.show},entityOptions:e}),this.updateSearchStateRW=e=>this.commandHandler({entity:{id:e&&e.searchQuery,type:Ie.p.search,action:Ie.u.view},command:{correlation:{id:(0,Je.v4)(),startTimestamp:Date.now(),source:I.D.Search},stateTransition:Ae.su.flush,visibilityState:Ae.fe.show},entityOptions:e}),this.open3SFeedback=e=>this.commandHandler({entity:{type:Ie.p.open3sfeedback,action:Ie.u.view},command:{correlation:{source:I.D.Search},stateTransition:Ae.su.new,visibilityState:Ae.fe.show},entityOptions:e}),this.exitSearchState=()=>this.commandHandler({entity:{type:Ie.p.search,action:Ie.u.view,id:"search"},command:{correlation:{source:I.D.Search},stateTransition:Ae.su.forceFlush,visibilityState:Ae.fe.hide}})}}class aa{constructor(e){this.commandHandler=e}launch(e){return this.commandHandler({entity:{type:Ie.p.settingsstore,action:Ie.u.default},command:e})}launchSection(e,t,n){return this.commandHandler({entity:{type:Ie.p.settingsstore,action:Ie.u.view,id:e},command:t,entityOptions:Object.assign(Object.assign({},n),{commandSource:null==t?void 0:t.correlation.source})})}}class oa{constructor(e){this.extensionCommanding=e}launchShareFormDialog(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=Ae.fe.show,n.stateTransition=Ae.su.extend,this.extensionCommanding.executeCommand({id:e,type:Ie.p.shareformdialog,action:Ie.u.view},{entityCommand:n,entityOptions:null==t?void 0:t.entityOptions})}getDefaultCommand(){return{stateTransition:Ae.su.extend,visibilityState:Ae.fe.show,correlation:{source:I.D.ExtensionCommanding}}}}class ra{constructor(e){this.commandHandler=e}viewStore(e,t,n){return this.commandHandler({entity:{type:Ie.p.store,action:Ie.u.view,id:e},command:n,entityOptions:t})}showStoreFre(e,t){return this.commandHandler({entity:{type:Ie.p.storefre,action:Ie.u.view,id:t},command:{visibilityState:e?Ae.fe.show:Ae.fe.hide,stateTransition:Ae.su.extend,correlation:{source:I.D.ExtensionCommanding}}})}viewManageAppsTab(e,t){return this.commandHandler({entity:{type:Ie.p.store,action:Ie.u.manage},command:t,entityOptions:e})}}!function(e){e.User="user",e.Team="team",e.TeamOwned="teamowned"}(Zi||(Zi={}));class sa{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}editTeamPicture(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.teampicture,action:Ie.u.view})}viewTeamJoinCode(e,t){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.teamjoincode,action:Ie.u.view},{entityOptions:{teamJoinCode:t}})}viewTeamRenewal(e,t){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.teamrenewal,action:Ie.u.view},{entityOptions:{expiryTime:t}})}channelById(e,t){const n={channelId:e,parentTeamId:null==t?void 0:t.parentTeamId};return this.commandHandler({entity:{type:Ie.p.channels,action:Ie.u.view,id:JSON.stringify(n)},entityOptions:Object.assign(Object.assign({},null==t?void 0:t.entityOptions),{parentTeamId:null==t?void 0:t.parentTeamId,pinned:null==t?void 0:t.pinned}),command:null==t?void 0:t.entityCommand})}editTeam(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.teamedit,action:Ie.u.view})}addMember(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.addmember,action:Ie.u.view})}addMemberToNewTeam(e,t){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.addmembernewteam,action:Ie.u.view},{entityOptions:t})}addChannel(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.addchannel,action:Ie.u.view})}manageApps(e,t,n){return this.commandHandler({entity:{id:e,type:Ie.p.teammanageapps,action:Ie.u.view},command:(null==n?void 0:n.entityCommand)||{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:t}},scenarioEventData:null==n?void 0:n.scenarioEventData,entityOptions:null==n?void 0:n.entityOptions})}manageTags(e,t,n,i,a){return this.commandHandler({entity:{id:e,type:Ie.p.teammanagetags,action:Ie.u.view,linkedEntity:{id:i||"",type:Ie.p.channels,action:Ie.u.list}},entityOptions:Object.assign(Object.assign({},null==a?void 0:a.entityOptions),{tagId:n}),scenarioEventData:null==a?void 0:a.scenarioEventData,command:(null==a?void 0:a.entityCommand)||{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:null!=t?t:I.D.ChannelListItem}}})}leaveTeam(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.teamleave,action:Ie.u.view})}createTeam(){return this.extensionCommanding.executeCommand({type:Ie.p.teamcreate,action:Ie.u.view})}archiveTeam(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.teamarchive,action:Ie.u.view})}restoreTeam(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.teamrestore,action:Ie.u.view})}launchConfirmPinUnpinPost(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.pinunpinpost,action:Ie.u.view},{entityCommand:t,entityOptions:e})}createTeamOnMainView(e,t){return this.commandHandler({entity:{type:Ie.p.teams,action:Ie.u.create},entityOptions:e,command:{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:null!=t?t:I.D.ChannelList}}})}showListView(){return this.commandHandler({entity:{type:Ie.p.channels,action:Ie.u.view},command:{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:I.D.SchoolTeams}}})}teamDiscover(){return this.commandHandler({entity:{type:Ie.p.teamdiscover,action:Ie.u.view},command:{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:I.D.ChannelListItem}}})}manageTeam(e,t,n,i){return this.commandHandler({entity:{id:e,type:Ie.p.teammanage,action:Ie.u.view,linkedEntity:{id:n||"",type:Ie.p.channels,action:Ie.u.list}},command:(null==i?void 0:i.entityCommand)||{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:t}},scenarioEventData:null==i?void 0:i.scenarioEventData,entityOptions:null==i?void 0:i.entityOptions})}manageTeams(e){return this.commandHandler({entity:{type:Ie.p.teams,action:Ie.u.config},command:{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:e}}})}manageSharedChannelsPendingInvites(e,t){return this.commandHandler({entity:{type:Ie.p.sharedchannelspendinginvites,action:Ie.u.view},command:(null==t?void 0:t.entityCommand)||{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:e}},scenarioEventData:null==t?void 0:t.scenarioEventData,entityOptions:null==t?void 0:t.entityOptions})}manageTeamsList(e,t){return this.commandHandler({entity:{type:Ie.p.teamslist,action:Ie.u.view},command:(null==t?void 0:t.entityCommand)||{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:e}},scenarioEventData:null==t?void 0:t.scenarioEventData,entityOptions:null==t?void 0:t.entityOptions})}crossTeamAnalytics(e,t){return this.commandHandler({entity:{type:Ie.p.crossTeamAnalytics,action:Ie.u.view},command:(null==t?void 0:t.entityCommand)||{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:e}},scenarioEventData:null==t?void 0:t.scenarioEventData,entityOptions:null==t?void 0:t.entityOptions})}acceptInvitation(e,t){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.sharedchannelacceptinvitation,action:Ie.u.view},{entityOptions:t})}declineInvitation(e,t){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.sharedchanneldeclineinvitation,action:Ie.u.view},{entityOptions:t})}teamDeepLink(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.teamdeeplink,action:Ie.u.view})}channelDeepLink(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.channeldeeplink,action:Ie.u.view})}viewChannelEmail(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.channelemail,action:Ie.u.view})}viewChannelEmailV2(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.channelemailv2,action:Ie.u.view},{entityCommand:t,entityOptions:e})}removeChannelEmail(e,t){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.removechannelemail,action:Ie.u.view},{entityCommand:t})}manageChannelConnectors(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.channelconnectors,action:Ie.u.view})}deleteChannel(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.channeldelete,action:Ie.u.view})}editChannel(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.channeledit,action:Ie.u.view})}channelModerators(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.channelmoderators,action:Ie.u.view})}manageChannel(e,t,n,i){return this.commandHandler({entity:{id:e,type:Ie.p.channelmanage,action:Ie.u.view,linkedEntity:{id:t||e,type:Ie.p.channels,action:Ie.u.list}},entityOptions:{parentTeamId:null==n?void 0:n.parentTeamId},command:{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:i||I.D.ChannelListItem}}})}manageChannelAnalytics(e,t,n){return this.commandHandler({entity:{id:e,type:Ie.p.channelanalytics,action:Ie.u.view,linkedEntity:{id:e,type:Ie.p.channels,action:Ie.u.list}},entityOptions:Object.assign(Object.assign({},null==n?void 0:n.entityOptions),{parentTeamId:null==n?void 0:n.parentTeamId}),command:(null==n?void 0:n.entityCommand)||{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:t}},scenarioEventData:null==n?void 0:n.scenarioEventData})}manageChannelMembers(e,t,n){return this.commandHandler({entity:{id:e,type:Ie.p.channelmembers,action:Ie.u.view,linkedEntity:{id:e,type:Ie.p.channels,action:Ie.u.list}},entityOptions:Object.assign(Object.assign({},null==n?void 0:n.entityOptions),{parentTeamId:null==n?void 0:n.parentTeamId}),command:(null==n?void 0:n.entityCommand)||{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:t}},scenarioEventData:null==n?void 0:n.scenarioEventData})}manageChannelSettings(e,t,n){return this.commandHandler({entity:{id:e,type:Ie.p.channelsettings,action:Ie.u.view,linkedEntity:{id:e,type:Ie.p.channels,action:Ie.u.list}},entityOptions:Object.assign(Object.assign({},null==n?void 0:n.entityOptions),{parentTeamId:null==n?void 0:n.parentTeamId}),command:(null==n?void 0:n.entityCommand)||{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:t}},scenarioEventData:null==n?void 0:n.scenarioEventData})}manageChannelInvitations(e,t,n){return this.commandHandler({entity:{id:e,type:Ie.p.channelinvitations,action:Ie.u.view},entityOptions:Object.assign(Object.assign({},null==n?void 0:n.entityOptions),{parentTeamId:null==n?void 0:n.parentTeamId}),command:(null==n?void 0:n.entityCommand)||{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:t}},scenarioEventData:null==n?void 0:n.scenarioEventData})}manageChannelTags(e,t,n){return this.commandHandler({entity:{id:e,type:Ie.p.channeltags,action:Ie.u.view},entityOptions:{parentTeamId:null==n?void 0:n.parentTeamId,tagId:null==n?void 0:n.tagId},command:{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:t}}})}addChannelMember(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.channelroster,action:Ie.u.manage})}leaveChannel(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.channels,action:Ie.u.leave})}channelNotificationSettings(e,t){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.channelnotificationsettings,action:Ie.u.view},{entityCommand:{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:t||I.D.ChannelListItem}}})}shareChannelWithUser(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.channels,action:Ie.u.share},{entityOptions:{shareWith:Zi.User}})}shareChannelWithTeam(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.channels,action:Ie.u.share},{entityOptions:{shareWith:Zi.Team}})}shareChannelWithTeamOwned(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.channels,action:Ie.u.share},{entityOptions:{shareWith:Zi.TeamOwned}})}manageTeamSettings(e,t,n){return this.commandHandler({entity:{id:e,type:Ie.p.teamsettings,action:Ie.u.view},command:(null==n?void 0:n.entityCommand)||{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:t}},scenarioEventData:null==n?void 0:n.scenarioEventData,entityOptions:null==n?void 0:n.entityOptions})}manageTeamAnalytics(e,t,n){return this.commandHandler({entity:{id:e,type:Ie.p.teamanalytics,action:Ie.u.view},command:(null==n?void 0:n.entityCommand)||{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:t}},scenarioEventData:null==n?void 0:n.scenarioEventData,entityOptions:null==n?void 0:n.entityOptions})}manageTeamChannels(e,t,n){return this.commandHandler({entity:{id:e,type:Ie.p.teamchannels,action:Ie.u.view},command:(null==n?void 0:n.entityCommand)||{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:t}},scenarioEventData:null==n?void 0:n.scenarioEventData,entityOptions:null==n?void 0:n.entityOptions})}manageTeamPendingJoinRequest(e,t,n){return this.commandHandler({entity:{id:e,type:Ie.p.teampendingrequests,action:Ie.u.view},command:(null==n?void 0:n.entityCommand)||{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:t}},scenarioEventData:null==n?void 0:n.scenarioEventData,entityOptions:null==n?void 0:n.entityOptions})}deleteTeam(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.teams,action:Ie.u.delete})}launchCrossPostChannelSelectionDialog(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.crosspostchannelselectiondialog,action:Ie.u.view},{entityCommand:{stateTransition:Ae.su.extend,visibilityState:Ae.fe.show,correlation:{source:t}},entityOptions:{selectedChannelIds:e}})}launchCrossPostDeleteDialog(e,t){return this.extensionCommanding.executeCommand({type:Ie.p.crosspostdeletedialog,action:Ie.u.view},{entityCommand:{stateTransition:Ae.su.extend,visibilityState:Ae.fe.show,correlation:{source:t}},entityOptions:e})}restoreChannel(e,t){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.restorechannel,action:Ie.u.view},{entityOptions:null==t?void 0:t.entityOptions})}showForMemberDialog(e){return this.extensionCommanding.executeCommand({id:e,type:Ie.p.showformemberdialog,action:Ie.u.view})}}class la{constructor(e){this.commandHandler=e}openTranscriptTab({entityCommand:e,messageId:t,threadId:n,transcriptId:i,isOrganizer:a,meetingOrganizerId:o,meetingTenantId:r},s){return this.commandHandler({entity:{type:Ie.p.transcriptcontent,action:Ie.u.view},command:e,entityOptions:{messageId:t,threadId:n,transcriptId:i,isOrganizer:a,meetingOrganizerId:o,meetingTenantId:r,eventId:s}})}openTranscriptInSchedulingForm({entityCommand:e,messageId:t,threadId:n,transcriptId:i,isOrganizer:a,meetingOrganizerId:o,meetingTenantId:r},s,l){return this.commandHandler({entity:{type:Ie.p.transcriptcontent,action:Ie.u.view,linkedEntity:{type:Ie.p.schedulingform,action:Ie.u.view,id:JSON.stringify({eventId:(0,ei.cW)(s),providerType:l})}},command:e,entityOptions:{messageId:t,threadId:n,transcriptId:i,isOrganizer:a,eventId:(0,ei.cW)(s),meetingOrganizerId:o,meetingTenantId:r}})}openTranscriptInChatApp({entityCommand:e,messageId:t,threadId:n,transcriptId:i,isOrganizer:a,meetingOrganizerId:o,meetingTenantId:r},s){return this.commandHandler({entity:{type:Ie.p.transcriptcontent,action:Ie.u.view,linkedEntity:{type:Ie.p.chats,action:Ie.u.view,id:n||""}},command:e,entityOptions:{eventId:s?(0,ei.cW)(s):"",isOrganizer:a,meetingOrganizerId:o,meetingTenantId:r,messageId:t,threadId:n,transcriptId:i}})}}class da{constructor(e,t,n,i){this.extensionCommanding=e,this.commandHandler=t,this.host=n,this.coreSettings=i}virtualEventsList(e){return this.commandHandler({entity:{type:Ie.p.virtualevents,action:Ie.u.list},command:e})}virtualEventById(e,t){const{useMeetingExperienceForSchedulingVirtualEvents:n,virtualEventByIdLinkUrl:i}=this.coreSettings.get(A.J.VirtualEvents);return n&&(null==t?void 0:t.stateTransition)===Ae.su.new?(this.host.open(null==i?void 0:i.replace("{eventId}",e)),Promise.resolve()):this.commandHandler({entity:{type:Ie.p.virtualevents,action:Ie.u.view,id:e},command:t})}createVirtualEvent(e,t){const{eventType:n}=e,{useMeetingExperienceForSchedulingVirtualEvents:i,createVirtualEventsLinkUrl:a}=this.coreSettings.get(A.J.VirtualEvents);return i?(this.host.open(null==a?void 0:a.replace("{eventType}",n)),Promise.resolve()):this.commandHandler({entity:{type:Ie.p.virtualevents,action:Ie.u.create},command:t,entityOptions:e})}showConfirmationDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.virtualevents,action:Ie.u.confirm},{entityCommand:{visibilityState:Ae.fe.show,stateTransition:Ae.su.extend,correlation:{source:I.D.VirtualEventDetails}},entityOptions:e})}showShareDialog(e){return this.extensionCommanding.executeCommand({type:Ie.p.virtualevents,action:Ie.u.share},{entityCommand:{visibilityState:Ae.fe.show,stateTransition:Ae.su.extend,correlation:{source:I.D.VirtualEventDetails}},entityOptions:e})}}class ca{constructor(e){this.commandHandler=e}openWikiTab(e,t,n,i){const a={entity:{action:Ie.u.view,id:e,linkedEntity:i,type:Ie.p.wiki},command:t,entityOptions:n};return this.commandHandler(a)}}class ua{constructor(e){this.commandHandler=e}qnaById(e,t,n){return this.commandHandler({entity:{type:Ie.p.yammerqna,action:Ie.u.view,id:e},command:t,entityOptions:n})}}class ma{constructor(e){this.commandHandler=e}launch(e){return this.commandHandler({entity:{type:Ie.p.teamsgallery,action:Ie.u.view},command:e})}launchSection(e){return this.commandHandler({entity:{type:Ie.p.teamsgallery,action:Ie.u.view,id:e},command:{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:I.D.TeamsGallery}}})}launchTeamsGallery(){return this.commandHandler({entity:{type:Ie.p.teamsgallery,action:Ie.u.view,id:""},command:{stateTransition:Ae.su.flush,visibilityState:Ae.fe.show,correlation:{source:I.D.TeamsGallery}}})}}class ga{constructor(e){this.commandHandler=e}callList(e,t){return this.commandHandler({entity:{id:e,type:Ie.p.callsmain,action:Ie.u.view},command:t})}contactList(e,t){return this.commandHandler({entity:{type:Ie.p.callsmain,action:Ie.u.list},command:e,entityOptions:null==t?void 0:t.entityOptions,scenarioEventData:null==t?void 0:t.scenarioEventData})}}class pa{constructor(e){this.extensionCommanding=e}launchUnifiedConsent(e){this.extensionCommanding.executeCommand({type:Ie.p.unifiedconsentdialog,action:Ie.u.view},{entityOptions:Object.assign({},e)})}}const ha=(e,t,n,i,a,o,r,s,l,d,c,u=_.ew,m)=>{const g=new Fn(e,i,u,r,s),p=new wn(o,e,g,r,s,l,a,c,m);return{entityCommanding:{account:new Xn(e),activity:new Zn(e,g),aiInsights:new ti(e),authentication:new ai(e,g,p,i),autoinstallnotification:new oi(e),biometricEnrollment:new ri(e),brbFeedback:new si(e,g),breakoutRooms:new li(e),broadcast:new di(e),calendar:new ci(g,e),call:new ui(e,g,c),callsMain:new ga(e),campaignNotifications:new mi(e),channel:new gi(e),chat:new hi(e,g,a,s),coachReport:new vi(e),contacts:new fi(e,g),deepLink:p,destroy:()=>g.destroy(),discoverSurface:new ki(e,s),discoverappsnotifications:new yi(e),error:new Ci(e),esp:new bi(e,g),feedback:new Ti(e,g),file:new wi(g,e),flyout:new _i(e),freemiumUpgrade:new Ii(e),guardians:new Ai(e),meetingAnalytics:new Di(e),meetingRoom:new Vi(e),meetingOptions:new Fi(e,g),nova:new jn(e),platform:new ea(e,g,a),registration:new ta(e,a),school:new na(e,g),search:new ia(e),settings:new aa(e),shareForm:new oa(g),shell:new Qn(e,g,d,u,o,a,s),store:new ra(e),lobnotifications:new Ei(e),lms:new Ni(g),onboardingnotifications:new Hi(e),teamsAndChannels:new sa(e,g),teamsGallery:new ma(e),toasts:new Kn(e,c),transcript:new la(e),unifiedConsent:new pa(g),virtualEvents:new da(g,e,o,a),yammerQna:new ua(e),wiki:new ca(e),communities:new Si(e,g)},eventing:new wt(n,e,t)}},va=new Set(["com.microsoft.teams.activity","com.microsoft.teams.calling"]);class Sa{constructor(e,t,n,i,a,o,r,s){this._appsRegistry=e,this._client=t,this._commandResultChangeReportingService=n,this._coreSettings=i,this._entityCommanding=a,this._loggerFactory=o,this._scenarioFactory=r,this._userContextId=s}init(){this._changes&&this.destroy(),this._changes=this._commandResultChangeReportingService.observeChanges().pipe((0,S.h)((e=>e.userContextId===this._userContextId))).subscribe((e=>this.executeOnCommandResultAppHooks(e)))}destroy(){var e;null===(e=this._changes)||void 0===e||e.unsubscribe(),this._changes=void 0}executeOnCommandResultAppHooks({context:{entityCommand:e,error:t},type:n}){var i,a;if(!e)return;const o=e.command.correlation.scenarioName===ee.RG.ActivitySwitch,r=e.entity.type,s=r&&this._appsRegistry.getApp({entityType:o?Ie.p.activity:r}),l=null==s?void 0:s.onCommandResult;if(s&&va.has(s.manifest.id)&&l)try{l({requestContext:{client:this._client,coreSettings:this._coreSettings,entityCommanding:this._entityCommanding,error:t,loggerFactory:this._loggerFactory,scenarioFactory:this._scenarioFactory},entityCommand:e,result:n})}catch(e){null===(a=(i=this._loggerFactory.newLogger("command-result-hooks-service")).errorToTelemetry)||void 0===a||a.call(i,`App ${null==s?void 0:s.manifest.name} failed to execute entity command hook 'OnAfterCommandResolved' with ""${e.name}"" error`,"entity_command_hook",{errors:`${e.name}`},!0)}}}var fa=n(71503);function ya(e){return function(e){const t=Ca(e),n=1,i=2,a=3;if(!t)return e;if(t[a])return t[n].replace(t[i],t[a]);return t[n]}(e)}function ka(e){return e.message&&(e.message=ya(e.message)),e.stack&&(e.stack=function(e){if(Ca(e.message))return"Sanitized due to potential PII leaks.";return e.stack}(e)),e}function Ca(e){return new RegExp(/(Can't find field ((chat)\(.*\)|.*) on object)/).exec(e)}const ba=/-extension:\/\//;function Ta(e){return e===_.jK.TimedOut}class wa{constructor(e,t,n,i,a,o){this.host=e,this.scenarioFactory=t,this.platformService=n,this.networkStateProvider=i,this.diagnosticsService=a,this.coreSettings=o,this._onWindowError=e=>{if(function(e){return e&&("resizeobserver loop limit exceeded"===e.message.toLowerCase()||ba.test(e.filename))}(e))return!0;const{colno:t,filename:n,lineno:i,message:a}=e;let{error:o}=e;const r=!!o&&Ta(o.code);return o=o?ka(o):new Error(ya(a)),this._reportError(ee.RG.GlobalWindowError,Object.assign(o,{colno:t,filename:n,lineno:i}),_.jK.UndefinedWindowError,r),!0},this._onUnhandledPromiseRejection=e=>(0,c.mG)(this,void 0,void 0,(function*(){const{reason:t}=e,n=!!t&&Ta(t.code);return this._reportError(ee.RG.UnhandledRejection,t,_.jK.UnhandledPromiseRejection,n)})),e.addEventListener(K.cr.UnhandledRejection,this._onUnhandledPromiseRejection),e.addEventListener(K.cr.GlobalWindowError,this._onWindowError)}dispose(){this.host.removeEventListener(K.cr.UnhandledRejection,this._onUnhandledPromiseRejection),this.host.removeEventListener(K.cr.GlobalWindowError,this._onWindowError)}set error(e){this.persistDiagnostics(),void 0!==e&&(this._error=e,this._reportError(ee.RG.FatalError,e,_.jK.UndefinedGlobalError,!0))}get error(){return this._error}_reportError(e,t,n,i){return(0,c.mG)(this,void 0,void 0,(function*(){const{code:a=n,context:o=""}=t||{},r=""===o?`${a}`:`${o}:${a}`,s=(0,he._S)((0,me.A)((0,he.B9)(t)));let l="";try{l=this.extractError(t)}catch(e){l="Stringifying error failed"}const d=`[${l}]`;this.scenarioFactory.newScenario(e).fail({message:s,errorCode:r,errors:d,showOops:i,"AppInfo.NetworkState":this.networkStateProvider.isOnline()?"Online":"Offline"});let u=Promise.resolve();if(i){const e=1e3;u=(0,Oe.E)(le.ip.getInstance().flush(),e),this.persistDiagnostics()}const m=this.platformService.config.clientVersion;return u.catch((()=>this.diagnosticsService.pushDiagnosticsEvent(D.i.Warn,"Could not flush telemetry logs in time",!0))).then((()=>(0,c.mG)(this,void 0,void 0,(function*(){const{disableSendingLogsToHost:e}=this.coreSettings.get(A.J.Diagnostics);if(!e){const e=yield this.diagnosticsService.getDiagnosticsEvents(1e3);this.host.opener.postMessage(K.rY.WindowErrored,{errorCode:r,errorDescription:s,errorMsg:l,logs:e,showOops:i,clientVersion:m})}}))))}))}extractError(e){const{scrubStackTrace:t}=this.coreSettings.get(A.J.Core),n=t?[]:[fa.A4.SmtpAddress,fa.A4.IPV4Address,fa.A4.IPv6Address,fa.A4.PhoneNumber];return(0,me.A)(JSON.stringify(e,(0,he.cm)()),n)}persistDiagnostics(){this.diagnosticsService.persistDiagnostics()}}var _a,Ia=n(6137);!function(e){e.JobChange="job_change"}(_a||(_a={}));class Aa{constructor(e,t,n,i,a,o,r){this._jobHandle=e,this._changes=t,this._meta=n,this._job=i,this._windowId=o,this._correlationId=r,this._timing={received:0,started:0,completed:0,canceled:0},this._execution=Ia.Tf.None,this._logger=a.newLogger("Scheduled Job")}receive(){this._timing.received=Date.now(),this._execution=Ia.Tf.Received,this.reportJobChange()}execute(){if(this._execution===Ia.Tf.Canceled)return;if(this._execution!==Ia.Tf.Received)throw new Error("Unable to execute a job that has not been received");let e;this._timing.started=Date.now(),this._execution=Ia.Tf.Started;try{this.reportJobChange();const t=this._job();e=t instanceof Promise?t:Promise.resolve(t)}catch(t){this._logger.error(`Job with ID:${this._meta.id} failed to execute or rejected with error: ${t.message?t.message:t}`),e=Promise.reject(t)}this.complete(e)}equals(e){return this._jobHandle===e}cancel(){return this._timing.canceled=Date.now(),this._execution=Ia.Tf.Canceled,this.reportJobChange(),{meta:this._meta,job:this._job}}complete(e){const t=e=>{let t;return this._timing.completed=Date.now(),this._execution=Ia.Tf.Complete,this.isError(e)&&(t={message:e.message,code:e.code,context:e.context,name:e.name}),this.reportJobChange(t),e};e.then(t).catch(t)}isError(e){return!!e&&e instanceof Error}reportJobChange(e){this._changes.report({correlationId:this._correlationId,type:_a.JobChange,context:Object.assign(Object.assign({},this.toChangeState()),{target:"job",error:e}),windowId:this._windowId})}toChangeState(){return{handle:this._jobHandle,timing:this._timing,execution:this._execution,meta:this._meta}}}var Na=n(72249);class Ea extends Na.default{remove(e,t){const n=[];let i;return this.forEach((a=>{t(a,e)?i=a:n.push(a)})),i&&(this.clear(),n.forEach((e=>this.enqueue(e)))),i}}const Da=(e,t)=>e.equals(t),Fa=()=>0;class Pa{constructor(e,t,n,i){this._jobExecutor=e,this._supportedPriority=t,this._changes=n,this._loggerFactory=i,this._logger=i.newLogger("GreedyJobExecutionQueue"),this._queue=new Ea(Fa)}clearExecutionSchedule(){this._jobExecutor.clearExecutionSchedule(),this._queue.clear()}cancel(e){const t=this._queue.remove(e,Da);return t&&t.cancel()}enqueue(e,t,n,i,a){if(n.priority!==this._supportedPriority)return this._logger.errorToTelemetry&&this._logger.errorToTelemetry(`Job priroty [${Ia.vW[n.priority]}] not supported by this queue, this queue supports [${Ia.vW[this._supportedPriority]}]`,"webclient_framework_foundation_core_services_scheduling",void 0,!0),!1;const o=new Aa(e,this._changes,n,t,this._loggerFactory,i,a);return this._queue.enqueue(o)?(o.receive(),this._jobExecutor.scheduleExecution({getJob:()=>this._queue.dequeue()}),!0):(this._logger.errorToTelemetry&&this._logger.errorToTelemetry("PriorityQueue did not enqueue the job","webclient_framework_foundation_core_services_scheduling",void 0,!0),!1)}}class Ma{constructor(e,t,n){this._schedule=e,this._clearSchedule=t,this._logger=n}clearExecutionSchedule(){this._executionHandle&&this._clearSchedule(this._executionHandle)}scheduleExecution(e){this._executionHandle||(this._executionHandle=this._schedule((()=>{this._executionHandle=void 0,this.execute(e)})))}execute({getJob:e}){let t;for(;t=e();)try{t.execute()}catch(e){this._logger.errorToTelemetry&&this._logger.errorToTelemetry(`Job executor caught an exception executing a job. Continuing execution of remaining jobs. Error: ${e.message?e.message:e}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0)}}}class ja{constructor(e,t,n,i){this._changes=e,this._loggerFactory=n,this._windowId=i,this._logger=n.newLogger("Scheduler"),this._queues=new Map,this.createQueues(t)}destroy(){this._queues.forEach((e=>{e.clearExecutionSchedule()}))}schedule(e,t,n){const i=this._queues.get(t.priority);if(!i)return this._logger.errorToTelemetry&&this._logger.errorToTelemetry(`Job priority [${Ia.vW[t.priority]}] supplied by ${t.scheduledById} not supported by scheduling`,"webclient_framework_foundation_core_services_scheduling",void 0,!0),Ia.o_;const a=ja.nextJobHandle;return i.enqueue(a,e,t,this._windowId,n),a}cancel(e){let t;if(e===Ia.o_)return t;const n=Array.from(this._queues.values());for(const i of n)if(t=i.cancel(e),t)break;return t}createQueues(e){this.createQueue(Ia.vW.Macro,(t=>e.setTimeout(t)),(t=>e.clearTimeout(t))),this.createQueue(Ia.vW.RenderBlocking,(t=>e.requestAnimationFrame(t)),(t=>e.cancelAnimationFrame(t)))}createQueue(e,t,n){const i=new Ma(t,n,this._logger),a=new Pa(i,e,this._changes,this._loggerFactory);this._queues.set(e,a)}static get nextJobHandle(){return this._nextJobHandle===Number.MAX_SAFE_INTEGER&&(this._nextJobHandle=0),this._nextJobHandle++,this._nextJobHandle}}ja._nextJobHandle=0;const Ra=(e,t,n,i)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const[a,o]=yield Promise.all([t.getUser({correlation:n}),xa(t,n,i)]);if(o)for(const t of o)e.setContext("UserInfo.IsMRU",void 0,void 0,t.id);e.setContext("UserInfo.IsMRU",!0,void 0,a.id)})),xa=(e,t,n)=>{if(n)return Promise.resolve(n);const i=e.getCachedUsers;return i?i(t):void 0},Oa=(e,t,n,i,a)=>(0,c.mG)(void 0,void 0,void 0,(function*(){var o,r,s;const l={id:i.id,source:i.source,scenarioName:ee.RG.AuthWebUser};try{const[i,a]=yield Promise.all([null===(o=n.getCachedUsers)||void 0===o?void 0:o.call(n,l,{isAuthenticated:!0}),null===(r=n.getCachedUsers)||void 0===r?void 0:r.call(n,l,{isPrimaryUser:!0})]);if(Ra(t,n,l,i),Array.isArray(i)){for(const e of i)t.setContext("UserInfo.IsPrimary",void 0,void 0,e.id);const e=i.filter((e=>e.profile.isHomeAccount)).length;t.setCoreContext("uniqueCredentialCount",e),t.setCoreContext("mtmaAccounts",i.length)}if(Array.isArray(a)){const[n,i]=a;e?t.setContext("UserInfo.IsPrimary",!0,void 0,n.id):(t.setCoreContext("primaryUserInfoId",n.profile.oid),t.setCoreContext("primaryUserInfoTenantId",n.profile.tid))}}catch(e){null===(s=a.errorToTelemetry)||void 0===s||s.call(a,"Failed to update MRU or sync mtma context","telemetry_instrumentation_update_user_context")}})),La={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"performWindowHistoryNavigation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"navigationDirection"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"NavigationDirection"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"performWindowHistoryNavigation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"navigationDirection"},value:{kind:"Variable",name:{kind:"Name",value:"navigationDirection"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},Ua={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"navigateToWindowHistoryIndex"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowHistoryIndex"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"navigateToWindowHistoryIndex"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"windowHistoryIndex"},value:{kind:"Variable",name:{kind:"Name",value:"windowHistoryIndex"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};class Ba{constructor(e,t,n,i){this._client=e,this._host=t,this._coreSettings=n,this._windowId=i,this.onPopState=e=>(0,c.mG)(this,void 0,void 0,(function*(){var t;this.navigateTo((null===(t=e.state)||void 0===t?void 0:t.windowHistoryIndex)||0)}))}init(){return(0,c.mG)(this,void 0,void 0,(function*(){this.hostHistoryNavigationEnabled&&this._host.addEventListener("popstate",this.onPopState)}))}destroy(){return(0,c.mG)(this,void 0,void 0,(function*(){this.hostHistoryNavigationEnabled&&this._host.removeEventListener("popstate",this.onPopState)}))}navigate(e){return(0,c.mG)(this,void 0,void 0,(function*(){return this.mutate(La,{navigationDirection:e})}))}navigateTo(e){return(0,c.mG)(this,void 0,void 0,(function*(){return this.mutate(Ua,{windowHistoryIndex:e})}))}get hostHistoryNavigationEnabled(){var e;return(null===(e=this._coreSettings.get(A.J.Core))||void 0===e?void 0:e.enableHostHistoryNavigation)||!1}mutate(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){return this._client.mutate({mutation:e,variables:Object.assign(Object.assign({},t),{windowId:this._windowId}),fetchPolicy:"no-cache"})}))}}var Wa=n(99482);const Ga={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeWindow"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},Va={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"runGarbageCollection"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"runGarbageCollection"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},Ha={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"windowStateEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"windowStateEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isFocused"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"shouldClose"}}]}}]}}]};class $a{report(e){if(!this._changes||0===this._changes.observers.length)return;const t=e.changeCorrelationId||(0,Je.v4)();this.changes.next(Object.assign(Object.assign({},e),{changeCorrelationId:t}))}observeChanges(){return this.changes.asObservable()}get changes(){return this._changes||(this._changes=new Te.xQ),this._changes}}class za{constructor(e,t){this.parentContext=e,this.pulsarLibraryInstance=t}startSignal(e,t){return this.pulsarLibraryInstance.startSignal(e,t,this.parentContext)}}class qa{constructor(e,t,n,i){this.logger=e,this.span=t,this.pulsarLibraryInstance=i,this.pulsarLibraryInstance.otlDependencies?this.signalContext=this.pulsarLibraryInstance.otlDependencies.trace.setSpan(n,t):this.logger.error("PulsarSignal: otlDependencies is not defined")}stop(e){this.span.setStatus(e),this.span.end()}appendEventData(e,t){this.span.setAttributes(qa.eventDataToAttributes(e,t))}addEvent(e){this.span.addEvent(e)}getPulsarContext(){return new za(this.signalContext,this.pulsarLibraryInstance)}propagate(){if(!this.signalContext)return void this.logger.error("propagate: signalContext is not defined");const{W3CTraceContextPropagator:e,defaultTextMapSetter:t}=this.pulsarLibraryInstance.otlDependencies,n={};return(new e).inject(this.signalContext,n,t),n}static eventDataToAttributes(e,t){const n={};return Object.keys(t).forEach((i=>{n[`${e}.${i}`]=t[i]})),n}}var Ja,Qa,Ka;!function(e){e.TEAMS_CORE="Teams.Core",e.TEAMS_RENDERING="Teams.Rendering",e.TEAMS_RESOLVER="Teams.Resolver"}(Ja||(Ja={})),function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(Qa||(Qa={})),function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(Ka||(Ka={}));class Ya{constructor(e,t){this.exporter=e,this.otlDependencies=t,this._shutdownOnce=new this.otlDependencies.BindOnceFuture(this._shutdown,this)}forceFlush(){return Promise.resolve()}onStart(e){this.export(e,"onStart")}onEnd(e){this._shutdownOnce.isCalled||0!=(e.spanContext().traceFlags&Ka.SAMPLED)&&this.export(e,"onEnd")}shutdown(){return this._shutdownOnce.call()}export(e,t){const{context:n,suppressTracing:i,ExportResultCode:a,globalErrorHandler:o}=this.otlDependencies;n.with(i(n.active()),(()=>{this.exporter.export([e],(e=>{var t;e.code!==a.SUCCESS&&o(null!==(t=e.error)&&void 0!==t?t:new Error(`PulsarSpanProcessor: span export failed (status ${e})`))}),t)}))}_shutdown(){return this.exporter.shutdown()}}var Xa=n(87360);class Za{constructor(e,t){this.serviceName=e,this.config=t,this.consumerNotificationObserver=new Te.xQ,this.logger=t.loggerFactory.newLogger("PulsarLib"),this.sessionId=t.sessionId}initialize(){return(0,c.mG)(this,void 0,void 0,(function*(){yield this.importOTLDependencies(),this.initOTL()}))}shutdown(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){yield null===(e=this.provider)||void 0===e?void 0:e.shutdown()}))}startSignal(e,t,n){if(!this.tracer)return void this.logger.error("startSignal: tracer is not initialized");const i=n||this.otlDependencies.ROOT_CONTEXT,a=this.tracer.startSpan(e,t,i);return a.setAttribute("sessionId",this.sessionId),new qa(this.logger,a,i,this)}startSignalFromCarrier(e,t,n){if(!t)return;if(!this.otlDependencies)return void this.logger.error("startSignalFromCarrier: OTL dependencies are not initialized");const{W3CTraceContextPropagator:i,ROOT_CONTEXT:a,defaultTextMapGetter:o}=this.otlDependencies,r=(new i).extract(a,t,o);return this.startSignal(e,n,r)}observeConsumerNotifications(){return this.consumerNotificationObserver.asObservable()}initOTL(){if(!this.otlDependencies)return void this.logger.error("initOTL: OTL dependencies are not initialized");const{WebTracerProvider:e,Resource:t,SemanticResourceAttributes:n,SimpleSpanProcessor:i,OTLPTraceExporter:a}=this.otlDependencies;this.provider=new e({resource:new t({[n.SERVICE_NAME]:this.serviceName})}),this.config.spanExporter.registerConsumerNotificationCallback((e=>{this.consumerNotificationObserver.next(e)})),this.provider.addSpanProcessor(new Ya(this.config.spanExporter,this.otlDependencies)),this.config.logToOTLCollector&&this.provider.addSpanProcessor(new i(new a({url:"http://localhost:4318/v1/traces"}))),this.tracer=this.provider.getTracer("pulsar-tracer")}importOTLDependencies(){return(0,c.mG)(this,void 0,void 0,(function*(){this.otlDependencies=yield(0,Xa.m)()}))}}class eo{constructor(){this.hasShutdown=!1,this.telemetryProvider=(0,Jn.G)(),this.telemetryProvider.registerPulsarBackchannelListener(this.notify.bind(this))}export(e,t,n){this.hasShutdown||e.forEach((e=>{switch(n){case"onStart":this.telemetryProvider.sendPulsarSignal({type:"onStart",span:this.sanitizeSpan(e)});break;case"onEnd":this.telemetryProvider.sendPulsarSignal({type:"onEnd",span:this.sanitizeSpan(e)})}}))}registerConsumerNotificationCallback(e){this.consumerNotificationCallback=e}shutdown(){return this.hasShutdown=!0,Promise.resolve()}notify(e){var t;null===(t=this.consumerNotificationCallback)||void 0===t||t.call(this,e)}sanitizeSpan(e){return Object.assign(Object.assign({},e),{_spanProcessor:void 0,_clock:void 0})}}const to=(e,t,n)=>{const{enableThemePreferenceResolution:i}=t.get(A.J.Core),{environment:a}=t.get(A.J.Metadata);if(i){const t=(0,Wa.R6)(null!=a?a:bt.s.prod);return(0,Wa.u_)(e,n,t)}return t.get(A.J.Host).theme||"default"},no=(e,t)=>e.subscribe({query:Ha,variables:{windowId:t}}),io=(e,t,n,i,a,o,r)=>{const{isFocused:s,shouldClose:l,correlation:d}=e&&e.data&&e.data.windowStateEvent;let c;const u=null==d?void 0:d.id;l?(t.close(),r.log(`host.close() called through window state event with correlationId ${u}`),c=Qe.B.Close):s&&(t.isFocused()?(r.log(`host.isFocused() returns true with correlationId ${u}`),c=Qe.B.AlreadyFocused):(t.focus(),r.log(`host.focus() called through window state event with correlationId ${u}`),c=Qe.B.Focus,o.loadModule("windowcontrols").then((e=>{var t;null===(t=null==e?void 0:e.focus)||void 0===t||t.call(e,n),r.log(`HostComms focus() called through window state event with correlationId ${u}`)})))),c&&u&&(i.report({context:{target:"handle-window-state-event"},correlationId:u,type:c}),a.report({type:Tt.FV.WindowStateChange,context:{target:"context-providers-handle-window-event"},correlationId:u,windowId:n}))},ao=(e,t)=>(0,h.U)((n=>((e,t,n)=>(n&&(e._cleanupFns||(e._cleanupFns=[]),e._cleanupFns.push(n)),Object.assign(Object.assign({},e),t)))(n,e(n),t))),oo=e=>ao((t=>({regenerateEntityCommandingServices:(n,i,a)=>(({appsRegistryService:e,client:t,clientLaunchId:n,commandChangeReportingService:i,coreSettings:a,deeplinkService:o,hostCommunicationService:r,loggerFactory:s,platformService:l,scenarioFactory:d,userContextId:c,viewEntitiesRef:u,viewEntity:m,viewEntityName:g,windowId:p,windowProvider:h,userBiService:v})=>ha((o=>Pn({appsRegistryService:e,client:t,clientLaunchId:n,commandChangeReportingService:i,coreSettings:a,entityCommandInput:o,loggerFactory:s,platformService:l,scenarioFactory:d,windowId:p,executionContext:{userContextId:c,viewEntity:m,viewEntityName:g},windowProvider:h,userBiService:v})),((o,r)=>jt({appsRegistryService:e,client:t,clientLaunchId:n,commandChangeReportingService:i,coreSettings:a,commandInput:o,commandHandler:r,loggerFactory:s,scenarioFactory:d,windowId:p,executionContext:{userContextId:c,viewEntitiesRef:u,viewEntity:m,viewEntityName:g},host:h,userBiService:v})),((o,r,l)=>Ut({appsRegistryService:e,client:t,clientLaunchId:n,commandChangeReportingService:i,coreSettings:a,eventInput:o,commandDelegator:l,commandHandler:r,loggerFactory:s,scenarioFactory:d,userBiService:v,windowId:p,executionContext:{userContextId:c,viewEntitiesRef:u,viewEntity:m,viewEntityName:g}})),t,a,h,d,s,o,r,c,p,n))({appsRegistryService:t.appsRegistryService,client:t.client,clientLaunchId:t.correlation.clientLaunchId||void 0,commandChangeReportingService:t.commandChangeReportingService,coreSettings:t.coreSettings,deeplinkService:t.deeplinkService,hostCommunicationService:t.hostCommunicationService,loggerFactory:t.loggerFactory,platformService:t.platformService,scenarioFactory:t.scenarioFactory,userContextId:t.authenticationUser?(0,qe.b)(t.authenticationUser):void 0,viewEntitiesRef:n,viewEntity:i,viewEntityName:a,windowId:e,windowProvider:t.windowProvider,userBiService:t.userBiService})}))),ro=(e,t,n,i,a,o,r)=>e.pipe((e=>e.pipe((e=>ao((()=>({windowProvider:e}))))(a),(e=>ao((t=>({loggerFactory:new pe(t.diagnosticsService,e)}))))(n),((e,t)=>ao((({loggerFactory:n})=>({scheduler:new ja(new $a,t,n,e)})),(({scheduler:e})=>e.destroy())))(n,a),((e,t)=>ao((n=>{const i=n.windowProvider.viewportContext,a=t.type,o=n.coreSettingsContext.createContextForViewport({id:e,viewportContext:i,entityType:a}),r=o.getCoreSettings();return{coreSettingsContext:o,coreSettings:r}}),(({coreSettingsContext:e})=>e.cleanup())))(n,r),(e=>ao((()=>({scenarioFactory:e})),(({scenarioFactory:e})=>e.destroy())))(t),(e=>ao((t=>({userBiService:t.telemetryService.createUserBiService(t,e,{id:t.correlation.id,startTimestamp:+t.correlation.startTimestamp||0,source:t.correlation.source})})),(({userBiService:e})=>e.destroy())))(n),((e,t)=>ao((({experienceChangeReportingService:n,authenticationUser:i})=>({experienceChangeReportingService:Object.assign(Object.assign({},n),{report:a=>{n.report(Object.assign({windowId:e,isMainWindow:t,userContextId:i?(0,qe.b)(i):void 0},a))}})}))))(n,i),((e,t)=>ao((({appBarService:n,appsRegistryService:i,appStateService:a,authenticationService:o,authenticationUser:r,cacheStorage:s,cdlWorkerService:l,client:d,clientPreferences:c,clientState:u,commandChangeReportingService:m,coreSettings:g,dataCleanupService:p,discover:h,experienceChangeReportingService:v,hostCommunicationService:S,localStorage:f,loggerFactory:y,offlineCacheManager:k,platformService:C,rebootService:b,scenarioFactory:T,user:w,userBiService:_,windowProvider:I,i18n:N,brbServiceManager:E,entityCommanding:D,pulsar:F})=>{var P,M;const j=d,R={appBarService:n,appsRegistryService:i,appStateService:a,authenticationService:o,authenticationUser:r,cacheStorage:s,cdlWorkerService:l,clientPreferences:c,clientState:u,commandChangeReportingService:m,coreSettings:g,dataCleanupService:p,discover:h,entityType:t,experienceChangeReportingService:v,hostCommunicationService:S,localStorage:f,loggerFactory:y,offlineCacheManager:k,platformService:C,pubsub:j.getServices().pubsub,rebootService:b,scenarioFactory:T,user:w,userBiService:_,windowId:e,windowProvider:I,i18n:N,brbServiceManager:E,entityCommanding:D,pulsar:F},{enableViewSchema:x}=g.get(A.J.Core);return{client:j.clone(R),viewSchemaClient:x?null===(M=(P=j).cloneForViewSchema)||void 0===M?void 0:M.call(P,R):null}}),(({client:e,entityCommanding:t,viewSchemaClient:n,coreSettings:i})=>{var a,o;return null===(a=n)||void 0===a||a.destroy(),e.destroy(),i.get(A.J.Core).enableMTMA&&(null===(o=e)||void 0===o||o.clearCache()),t.destroy()})))(n,r.type))),(e=>e.pipe(((e,t)=>ao((n=>{var i;const{appsRegistryService:a,authenticationUser:o,client:r,commandResultChangeReportingService:s,coreSettings:l,correlation:{clientLaunchId:d},deeplinkService:c,hostCommunicationService:u,loggerFactory:m,scenarioFactory:g}=n,{entityCommanding:p,eventing:h}=ha((t=>Pn({appsRegistryService:n.appsRegistryService,client:n.client,clientLaunchId:n.correlation.clientLaunchId||void 0,commandChangeReportingService:n.commandChangeReportingService,coreSettings:n.coreSettings,entityCommandInput:t,loggerFactory:n.loggerFactory,platformService:n.platformService,scenarioFactory:n.scenarioFactory,executionContext:{userContextId:n.authenticationUser?(0,qe.b)(n.authenticationUser):void 0},windowId:e,userBiService:n.userBiService}).then()),((i,a)=>jt({appsRegistryService:n.appsRegistryService,client:n.client,commandChangeReportingService:n.commandChangeReportingService,coreSettings:n.coreSettings,commandInput:i,commandHandler:a,loggerFactory:n.loggerFactory,scenarioFactory:n.scenarioFactory,windowId:e,host:t,userBiService:n.userBiService})),((t,i,a)=>Ut({appsRegistryService:n.appsRegistryService,client:n.client,commandChangeReportingService:n.commandChangeReportingService,commandDelegator:a,commandHandler:i,coreSettings:n.coreSettings,eventInput:t,loggerFactory:n.loggerFactory,scenarioFactory:n.scenarioFactory,userBiService:n.userBiService,windowId:e})),r,l,t,g,m,c,u,o?(0,qe.b)(o):void 0,e,d||void 0);let v=n.commandResultHooksService;return v&&(null===(i=l.get(A.J.Core))||void 0===i?void 0:i.enableStandaloneCommandReportingService)&&(v=new Sa(a,r,s,l,p,m,g,n.authenticationUser&&(0,qe.b)(n.authenticationUser)),v.init()),{entityCommanding:p,eventing:h,commandResultHooksService:v}}),(({commandResultHooksService:e})=>null==e?void 0:e.destroy())))(n,a),ao((e=>({errorState:new wa(e.windowProvider,e.scenarioFactory,e.platformService,e.networkState,e.diagnosticsService,e.coreSettings)})),(({errorState:e})=>e.dispose())),(e=>ao((()=>({clientState:e}))))(o),oo(n),(e=>ao((t=>{const n=new Ba(t.client,t.windowProvider,t.coreSettings,e);return n.init(),{windowHistoryNavigationService:n}}),(({windowHistoryNavigationService:e})=>e.destroy())))(n),ao((e=>{const{enablePulsarTelemetry:t,logToOTLCollector:n}=e.coreSettings.get(A.J.Pulsar),i=new Za(Ja.TEAMS_RENDERING,{sessionId:e.platformService.host.sessionId,spanExporter:new eo,loggerFactory:e.loggerFactory,logToOTLCollector:!!n});return t&&i.initialize(),{pulsar:i}}),(({pulsar:e})=>e.shutdown()))))),so=(e,t,n,i,a,o,r,s)=>{const l=r.pipe((0,kt.g)("userContextId"),(0,Ct.w)((({userContextId:e,correlation:t})=>s(e||void 0).pipe((0,h.U)((e=>({context:e,correlation:t})))))),(0,kt.g)("context"),(0,y.b)((({context:e,correlation:t})=>o&&lo(e,t))),(0,h.U)((({context:e,correlation:t})=>Object.assign(Object.assign({},e),{correlation:t}))));return ro(l,e,t,o,n,i,a)},lo=(e,t)=>{var n,i,a,o;const r=null===(i=null===(n=e.coreSettings)||void 0===n?void 0:n.get(A.J.Core))||void 0===i?void 0:i.enableMTMA,s={id:t.id,source:t.source,scenarioName:t.scenarioName||"auth_switch_account"};r&&e.authenticationUser&&(null===(o=(a=e.authenticationService).updateMostRecentUser)||void 0===o||o.call(a,{accountId:(0,qe.b)(e.authenticationUser),correlation:s}).then((()=>{s.scenarioName=ee.RG.AuthWebUser,Ra(e.telemetryContextService,e.authenticationService,s)})))},co=(e,t,n)=>{n.log(`Removing window ${e} from apollo cache`),t.client.mutate({mutation:Ga,variables:{windowId:e}}).then((()=>{t.client.mutate({mutation:Va})})).catch((e=>n.error("Error in removing window: ",e)))},uo=(e,t,n,i,a="")=>{var o;return e.telemetryService.createScenarioFactory(e,t,{id:n.id,startTimestamp:parseInt(n.startTimestamp,10)||0,source:n.source},null!==(o=n.clientLaunchId)&&void 0!==o?o:void 0,i,a)},mo=(e,t)=>e.markStep(ee.RG.WindowLaunchTime,t);var go=n(98065);const po={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"setWindowFullscreen"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isFullscreen"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setWindowFullscreen"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"isFullscreen"},value:{kind:"Variable",name:{kind:"Name",value:"isFullscreen"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};const ho=(e,t)=>e.opener.postMessage(K.Gx.Destroy,{windowId:t});function vo(e,t,n,i,a,o,r,s){return(0,c.mG)(this,void 0,void 0,(function*(){mo(i,ee.ck.BeginWindowCreation);const l=e.windowProvider;if(t===_.ew)return l;const d=yield function(e,t,n,i){return new Promise(((a,o)=>{const r=e.setTimeout((()=>{o("New Frame did not report in 10000ms")}),1e4),s=e.self;return s.frameResolvers=s.frameResolvers||{},s.frameResolvers[t]=n=>{e.clearTimeout(r),wo(e,t),a(n)},e.opener.postMessage(K.Gx.Create,{windowId:t,correlation:n,activeEntities:i})}))}(l,t,a,s);if(!d)return l;const c=(0,go.dP)(d,e,t,o,r),u=c.getHostedWindowContext();return Object.assign(c,{getHostedWindowContext:()=>Object.assign(Object.assign({},u),{windowId:t}),viewportContext:ft.R.iFrame}),mo(i,ee.ck.EndWindowCreation),fo(c,e,t,n),c.close=()=>ho(l,t),c}))}function So(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const{window:n,subscription:i,clientState:a}=yield e,o=null===(t=n.location.hash)||void 0===t?void 0:t.slice(1);o?ho(n,o):n.close(),i&&i.unsubscribe(),a&&a.dispose()}))}const fo=(e,t,n,i,a)=>{const o="onpagehide"in e?"pagehide":"unload",r=e.onFullscreen().subscribe((e=>{t.client.mutate({mutation:po,variables:{isFullscreen:e,windowId:n}})})),s=()=>{co(n,t,i),a&&a(),e.removeEventListener(o,s),r.unsubscribe()};e.addEventListener(o,s)},yo=({id:e,activeEntities:t},n)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{window:i,context$:a}=yield n;return{id:e,window:i,context$:a,activeEntities:t}})),ko=(e,t,n)=>(0,g.z)(ye((i=>(0,c.mG)(void 0,void 0,void 0,(function*(){return bo(i,e,t,n)}))),So,yo,((e,n)=>((e,t,n)=>{const i=n.loggerFactory.newLogger("IframeStateManager");i.error(`Creation for window ${e.id} failed with ${t}. Removing window from cache`),n.commandChangeReportingService.report({context:{target:"iframe-state-manager",errorInfo:Ke.y.CreateWindowError},correlationId:e.correlation.id,type:Qe.B.Failure}),co(e.id,n,i)})(e,n,t)))),Co=(e,t,n,i,a,o,r,s,l,d,u)=>(0,c.mG)(void 0,void 0,void 0,(function*(){return e&&t?Promise.resolve(((e,t,n,i,a,o,r)=>{const s=t.windowProvider,l=s.open(void 0,e,"width=600px,height=500px,toolbar=no,menubar=no,location=no");if(r){const{clientPreferences:e,coreSettings:n}=t,i=r({theme:to(e,n,s),viewportContext:ft.R.iFrame});l.document.write(i),l.document.close()}const d=()=>{const e=new URL(s.location.href);e.searchParams.append("random",Date.now().toString()),e.hash=[s.location.pathname,i.mainEntity.type,encodeURIComponent(i.mainEntity.id)].join("/"),l.location.href=decodeURIComponent(e.href)};s.addEventListener("unload",d);let c=(0,go.dP)(l,t,e,a,o);return c=Object.assign(c,{getHostedWindowContext:()=>({startReason:yt.zF.userInitiated,panelContext:yt.QP.secondary})}),fo(c,t,e,n,(()=>{s.removeEventListener("unload",d)})),c})(i,n,a,s,l,d,u)):vo(n,i,a,o,r,l,d,s)})),bo=(e,t,n,i)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{id:a,correlation:o,activeEntities:r,isMainWindow:s,layoutConfig:{layoutMode:l}}=e,{coreSettings:d}=n,c=o.source===I.D.PopOutButton,{enablePopOutChats:u}=d.get(A.J.Messaging),m=new pe(n.diagnosticsService,a),g=m.newLogger("IframeStateManager"),p=Object.assign(Object.assign({},n),{loggerFactory:m}),h=uo(p,a,o,ft.R.iFrame);return To(t,p,g,a,o,r,c,u,h,s,l,i)})),To=(e,t,n,i,a,o,r,s,l,d,u,m)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const c=yield Co(s,r,t,i,n,l,a,o,d,u,m),g=no(t.client,i).subscribe((e=>io(e,c,i,t.commandChangeReportingService,t.experienceChangeReportingService,t.hostCommunicationService,n))),p=t.clientState.getChildWindowStateProvider(c,t.loggerFactory,t.coreSettings),{mainEntity:h}=o,v=_o(c,i,d,g,p,e,l,a,h);return mo(l,ee.ck.WindowContextProvider),v})),wo=(e,t)=>e.opener.postMessage(K.Gx.Acquired,{windowId:t}),_o=(e,t,n,i,a,o,r,s,l)=>({window:e,subscription:i,clientState:a,context$:ro(o(void 0).pipe((0,h.U)((e=>Object.assign(Object.assign({},e),{correlation:s})))),r,t,n,e,a,l)});var Io=n(13100),Ao=n(38704);const No=(e,t,n)=>{e.opener.postMessage(K.rY.ShouldShowChatNotification,{shouldShowChatNotification:t,windowId:n})};var Eo=n(53198),Do=n(64452),Fo=n(19898),Po=n(93355),Mo=n(18548),jo=n(15976);const Ro=(e,t)=>!!(e===t||!e&&!t||e&&t&&e.id===t.id&&e.type===t.type&&e.action===t.action);function xo(e,t){var n,i;if(!t||!t.activeEntities)return!1;const a=null===(n=t.activeEntities)||void 0===n?void 0:n.mainEntity,o=null===(i=e.activeEntities)||void 0===i?void 0:i.mainEntity;return!Ro(o,a)&&!function(e,t){const n=["subNavEntity","headerEntity","startEntity","mainEntity","endEntity"];for(const i of n)if(e[i]||t[i])return Ro(e[i],t[i]);return!1}(e.activeEntities,t.activeEntities)}const Oo=e=>({isChanged:Lo,execute:t=>{e.dataCleanupService.markDataForWindowAsInactive(t.id)}});function Lo(e,t){return function(e){var t;return!!e.isMainWindow&&(null===(t=e.layoutConfig)||void 0===t?void 0:t.layoutMode)===Ae.lO.standard}(e)&&function(e,t){var n,i;if(!t||!t.activeEntities)return!1;const a=null===(n=t.activeEntities)||void 0===n?void 0:n.mainEntity,o=null===(i=e.activeEntities)||void 0===i?void 0:i.mainEntity;return!Ro(o,a)}(e,t)}const Uo=e=>({isChanged:(e,t)=>!e.isMainWindow&&xo(e,t),execute:(t,n)=>function(e,t,n){var i;const a=t.activeEntities.mainEntity,o=null==n?void 0:n.activeEntities.mainEntity,r=e.appsRegistryService.getApp({entityType:a.type});if(!r)throw new Error("Entity does not match to an existing app");const s=null===(i=r.getAppWindowFeatures)||void 0===i?void 0:i.call(r,{coreServices:e,host:t.window,isResize:!0,prevEntityType:null==o?void 0:o.type,entityType:null==a?void 0:a.type});if(!s)return;const{width:l,height:d,minWidth:c,minHeight:u}=s,{window:m}=t;e.loggerFactory.newLogger("WindowResizeCommand").log(`From ${null==o?void 0:o.type} of height ${m.innerHeight} and width ${m.innerWidth}, to ${a.type} of height ${d} and width ${l}`),c&&u&&(m.setMinimumSize&&m.setMinimumSize(c,u),e.hostCommunicationService.loadModule("windowcontrols").then((e=>{var n;return null===(n=null==e?void 0:e.setMinimumWindowSize)||void 0===n?void 0:n.call(e,t.id,c,u)})));l&&d&&(m.setBounds&&m.setBounds({x:m.screenX,y:m.screenY,width:l,height:d}),e.hostCommunicationService.loadModule("windowcontrols").then((e=>{var n;return null===(n=null==e?void 0:e.setWindowBounds)||void 0===n?void 0:n.call(e,t.id,m.screenX,m.screenY,l,d)})))}(e,t,n)});const Bo=(e,t)=>{switch(t){case Rt.LayoutModes.standard:return(0,Mo.ZN)(e,"window",yt.d.main);case Rt.LayoutModes.minimal:return(0,Mo.ZN)(e,"window",yt.d.flyout);default:return e}},Wo=(e,t,n,i,a,o,r,s,l,d,u,m,g,p)=>{var h,v;let S="",f="about:blank";f=t.platformService.config.clientType!==Fo.Bh.Web?(0,Mo.ZN)(f,"entityType",r.type):f;const y={url:f,windowId:n,windowFeatures:S,globalWindow:e,coreServices:t,logger:i,scenarioFactory:a,windowState:o,isMainWindow:l,layoutMode:d,userContextId$:m,templateGenerator:p};if(t.platformService.config.clientType===Fo.Bh.Maglev){const{addWindowIdQsp:e,enableTitleBarOverlayDuringLaunch:i}=t.coreSettings.get(A.J.Core);if(e&&(f=(0,Mo.ZN)(f,"windowId",n)),i&&(f=(0,Mo.ZN)(f,"customframetitlebarmode","fullwidth")),f=((e,t)=>t?(0,Mo.ZN)(e,"show","false"):e)(f,u),l){if(d===Rt.LayoutModes.standard){const{flushViewSchemaClient:e}=t.coreSettings.get(A.J.Core);e&&(null===(v=null===(h=t.client)||void 0===h?void 0:h.viewSchemaClient)||void 0===v||v.clearStore()),f=(0,Mo.ZN)(f,"customframetheme","main")}return Go(Object.assign(Object.assign({},y),{url:Bo(f,d)}))}f=(0,Mo.ZN)(f,"customframetheme","default")}return({url:f,windowFeatures:S}=function(e,t,n,i,a,o,r){var s;const l=e.appsRegistryService.getApp({entityType:n});if(!l)throw new Error("Entity does not match to an existing app");const d=(null===(s=l.getAppWindowFeatures)||void 0===s?void 0:s.call(l,{coreServices:e,host:t,screenState:a,windowOptions:i,entityType:n}))||{},{additionalFeatures:u={}}=d,m=(0,c._T)(d,["additionalFeatures"]);let g=Object.keys(m).reduce(((e,t)=>`${e}${e?",":""}${t}=${m[t]}`),"");return g=e.platformService.config.clientType===Fo.Bh.Web?`${g},toolbar=no,menubar=no,location=no`:g,r=Object.keys(u).reduce(((e,t)=>u?(0,Mo.ZN)(e,t,u[t]):e),r),o.log(`windowFeatures: ${g}, url: ${r}`),{url:r,windowFeatures:g}}(t,e,r.type,null!=g?g:r.windowOptions,s,i,f)),Go(Object.assign(Object.assign({},y),{url:f,windowFeatures:S}))},Go=({url:e,windowId:t,windowFeatures:n,globalWindow:i,coreServices:a,logger:o,scenarioFactory:r,windowState:s,isMainWindow:l,layoutMode:d,userContextId$:c,templateGenerator:u})=>{const m=i.open(e,t,n||void 0);if(!m)throw new ze.G(ze.$.WINDOW_UNDEFINED);const g=(0,go.dP)(m,a,t,l,d);ir(g,t,e),o.log(`windowState: ${JSON.stringify(s)}`);const{minWidth:p=0,minHeight:h=0}=s;return g.setMinimumSize&&g.setMinimumSize(p,h),Vo(i,g,a,u),mo(r,ee.ck.EndWindowCreation),Ho(g,a,d,r,c,t,o),$o(a,g),g},Vo=(e,t,n,i)=>{if(!i)return;if(!!t.document.getElementById("app"))return;const{clientPreferences:a,coreSettings:o,platformService:r}=n,s=r.config.clientVersion.split("/").pop(),l=ot(i({theme:to(a,o,e),osPlatform:r.config.osPlatform,cspNonce:e.__webpack_nonce__,publicPathScript:`window.__webpack_public_path__="${r.config.publicPath}"`,containerVer:s,environment:o.get(A.J.Metadata).environment||"",viewportContext:t.viewportContext,shouldStubConsoleError:!0}));t.document.write(l),t.document.close()},Ho=(e,t,n,i,a,o,r)=>{const{disableMainWindowMouseListeners:s,enableActiveWindowsHistoryRecovery:l}=t.coreSettings.get(A.J.Core),d=()=>{e.opener.postMessage(K.rY.UnhandledMouseEvent,{type:"mousemove"})},c=()=>{e.opener.postMessage(K.rY.UnhandledMouseEvent,{type:"click"})},u=e=>{if(!(e=>{var t,n;const i=e.target,a=null===(t=i.nodeName)||void 0===t?void 0:t.toLowerCase(),o=null===(n=i.type)||void 0===n?void 0:n.toLowerCase();return!(!i||!(i.isContentEditable||"textarea"===a||"input"===a&&/^(?:text|email|number|search|tel|url|password)$/i.test(o)))})(e))return e.preventDefault(),!1},m="onpagehide"in e?"pagehide":"unload",g=(e=>{const{disableContextMenu:t}=e.coreSettings.get(A.J.Core);return!!t})(t),p=e.onFullscreen().subscribe((e=>{t.client.mutate({mutation:po,variables:{isFullscreen:e,windowId:o}})})),h=()=>{if(a.isStopped)return;const{correlation:{id:n},userContextId:i}=a.value;t.experienceChangeReportingService.report({correlationId:n,type:Tt.FV.WindowOptionsChange,userContextId:i||void 0,windowId:o,context:{target:"window-state-manager",height:e.innerHeight,left:e.screenX,top:e.screenY,width:e.innerWidth}})},v=l&&t.platformService.config.clientType===Fo.Bh.Maglev&&n===Rt.LayoutModes.focus&&o!==_.ew,S=v&&(0,Io.R)(e,"resize").pipe((0,Eo.b)(500)).subscribe(h),f=v&&a.pipe((0,Eo.b)(500)).subscribe(h),y=()=>{r.log(`${m} called for window ${o}`),ar(e),tr(i),co(o,t,r),e.document.removeEventListener("mouseenter",d),e.document.removeEventListener("click",c),g&&e.removeEventListener("contextmenu",u),e.removeEventListener(m,y),r.log(`blur/unload listeners removed for windowId: ${o}`),nr(t,e,r,o),p.unsubscribe(),S&&S.unsubscribe(),f&&f.unsubscribe()};o!==_.ew||s||(e.document.addEventListener("mouseenter",d),e.document.addEventListener("click",c)),e.addEventListener(m,y),g&&e.addEventListener("contextmenu",u)},$o=(e,t)=>{var n,i;null===(i=null===(n=e.leakDetectorService)||void 0===n?void 0:n.create())||void 0===i||i.track(Po.I.UnwrappedWindow,t)},zo=(e,t,n)=>{return(0,g.z)((0,jo.j)((i=>qo(i,e,t,n)),(e=>Ko(e,t)),Yo,((e,n)=>((e,t,n)=>{let i,a;const o=n.loggerFactory.newLogger("WindowStateManager");t instanceof ze.G?(i=t.code,a=t.toTelemetryEntry()):(i=Ke.y.CreateWindowError,a=(0,R.u4)(t)),o.error(`Creation for window ${e.id} failed with ${a}. Removing window from cache`),n.commandChangeReportingService.report({context:{target:"window-state-manager",errorInfo:i,errorMessage:a},correlationId:e.correlation.id,type:Qe.B.Failure}),co(e.id,n,o)})(e,n,t))),er([Uo(t),Oo(t)]),(i=t.platformService.config.clientType===Fo.Bh.Web,a=e=>Zo(e,t),e=>i?e.pipe((0,y.b)((e=>a(e)))):e));var i,a},qo=(e,t,n,i)=>{const{id:a,activeEntities:o,correlation:r,screenState:s,isMainWindow:l,layoutConfig:{layoutMode:d},isInitialWindowStateHidden:c,userContextId:u,windowOptions:m}=e,{mainEntity:g,endEntity:p}=o,h=new pe(n.diagnosticsService,a),v=h.newLogger("WindowStateManager"),S=Object.assign(Object.assign({},n),{loggerFactory:h}),f=uo(S,a,r,(0,go.YR)(l,d),u||""),y=f.findScenario(ee.RG.WindowLaunchTime);null==y||y.appendEventData({mainEntityType:g.type,endEntityType:null==p?void 0:p.type});const k=((e,t,n)=>{var i;const a=e.appsRegistryService.getApp({entityType:t.type});return(null===(i=null==a?void 0:a.getAppWindowFeatures)||void 0===i?void 0:i.call(a,{coreServices:e,isResize:!0,entityType:t.type,windowOptions:n}))||{}})(S,g,null!=m?m:g.windowOptions);return Jo(t,u,S,a,g,v,f,k,r,s,l,d,c,m,i)},Jo=(e,t,n,i,a,o,r,s,l,d,c,m,g,p,h)=>{const v=new u.X({userContextId:t,correlation:l}),S=((e,t,n,i,a,o,r,s,l,d,c,u,m)=>{mo(i,ee.ck.BeginWindowCreation),n.log(`mainEntityId: ${o.id}, mainEntityType: ${o.type}, mainEntityAction: ${o.action}`);const g=e.windowProvider;return t===_.ew?(Ho(g,e,l,i,c,t,n),g):Wo(g,e,t,n,i,a,o,r,s,l,d,c,u,m)})(n,i,o,r,s,a,d,c,m,g,v,p,h),f=((e,t,n,i)=>no(e.client,t).subscribe((a=>io(a,n,t,e.commandChangeReportingService,e.experienceChangeReportingService,e.hostCommunicationService,i))))(n,i,S,o),y=n.clientState.getChildWindowStateProvider(S,n.loggerFactory,n.coreSettings),k=Qo(S,i,v,f,y,e,r,a,c&&m===Rt.LayoutModes.standard,n.loggerFactory,n.leakDetectorService);return mo(r,ee.ck.WindowContextProvider),n.commandChangeReportingService.report({context:{target:"window-state-manager-create-window",layoutMode:m},correlationId:l.id,type:Qe.B.WindowCreated,isMainWindow:c,userContextId:t}),k},Qo=(e,t,n,i,a,o,r,s,l,d,c)=>({id:t,window:e,windowStateSubscription:i,clientState:a,leakDetectorService:c,loggerFactory:d,userContextId$:n,context$:so(r,t,e,a,s,l,n,o)}),Ko=({clientState:e,id:t,window:n,windowStateSubscription:i,loggerFactory:a,leakDetectorService:o},r)=>{const s=a.newLogger("WindowStateManager");s.log(`Destroy called on window ${t}`),t!==_.ew&&(n&&n.close(),s.log(`Window.close() called for window ${t}`)),null==i||i.unsubscribe(),null==o||o.cleanup(),e.dispose(),r.appsRegistryService.removeWindowViewState(t)},Yo=({activeEntities:e,id:t,isMainWindow:n,userContextId:i,correlation:a},{context$:o,window:r,userContextId$:s})=>(s.next({userContextId:i,correlation:a}),{activeEntities:e,context$:o,id:t,isMainWindow:n,window:r});let Xo;const Zo=(e,t)=>{const n=t.loggerFactory.newLogger("WindowStateManager"),{isChatHybridArchitectureEnabled:i}=t.coreSettings.get(A.J.Host);if(i){if(!e.find((e=>e.id===_.ew)))return}const a=t.windowProvider,o="onpagehide"in a?"pagehide":"unload";a.removeEventListener(o,Xo),Xo=()=>{n.log(`Global window unload handler called for ${e.length} windows`),e.forEach((e=>{e.id!==_.ew&&e.window.close()}))},a.addEventListener(o,Xo,{once:!0})},er=e=>(0,Do.R)(((t,n)=>(n.forEach((n=>{const i=t.find((e=>e.id===n.id));e.forEach((e=>{e.isChanged(n,i)&&e.execute(n,i)}))})),n)),[]),tr=e=>{e.stopScenarioIfActive(ee.RG.WindowLaunchTime,{},"abandoned")},nr=(e,t,n,i)=>{(e=>{const{enableCdlRegistration:t}=e.coreSettings.get(A.J.Core);return!!t})(e)&&(t.opener.postMessage(K.rY.CdlRegistration,{childWindowId:i,eventType:"unregister"}),n.log(`CdlRegistration: windowId: '${i}', eventType: unregister`))},ir=(e,t,n)=>{const i=new URL(n);e.windowLeakInfo={windowLeakInfoStartTime:(new Date).toUTCString(),windowLeakInfoEntityType:i.searchParams.get("entityType")||n,windowLeakInfoViewportContext:e.viewportContext,windowLeakInfoWindowId:t}},ar=e=>{e.windowLeakInfo||(e.windowLeakInfo={}),e.windowLeakInfo.windowLeakInfoEndTime=(new Date).toUTCString()};var or=n(98995);const rr=["/convene","/embed-client/chats","/l/auth/google","/l/channel-dashboard","/l/channel","/l/claim","/l/community","/l/entity","/l/fileshare","/l/invite/","/l/invitecommunity","/l/manage-teams/myinvites","/l/meeting/new","/l/meeting/details","/l/meetup-join","/l/message","/l/present","/l/team-dashboard","/l/team","/meet","/notdefaultapp"];var sr;!function(e){e.core="core",e.flyout="flyout",e.default="default"}(sr||(sr={}));var lr=n(96825),dr=n(85762),cr=n(39843);const ur=new Map,mr=/^\/|\/$/g;function gr(e){if(!e||0===e.length)return;const t=ur.get(e);if(t)return t;const n=e.replace(mr,"");if(0===n.length)return;const i=n.split("/");try{let t;if(i){let e=i.length-1;for(;e>=0;){const t=i[e].toLowerCase();if(Ie.p[t])break;e--}e>=0&&(t=function(e){let t;switch(e.length){case 3:t={type:hr(e[0]),id:e[1],action:pr(e[2])};break;case 2:{const n=e[1].toLowerCase();t=Ie.u[n]?{type:hr(e[0]),action:pr(e[1])}:{type:hr(e[0]),id:e[1],action:Ie.u.view};break}default:throw new Error("Invalid entity fragment format found. Valid type, id or action is required.")}return t}(i.splice(e)))}return ur.size<=1e3&&t&&ur.set(e,t),t}catch(e){throw new Error(`Unable to parse path into proper command. ${e.message}`)}}function pr(e){return e.toLowerCase()}function hr(e){return e.toLowerCase()}function vr(e,t,n,i,a=Ae.su.flush,o){return n?{shouldRenderContent:!0,scenarioCorrelation:e,entityCommand:tt({entity:n,command:{visibilityState:Ae.fe.show,stateTransition:a,layoutMode:i,correlation:e.correlation},entityOptions:o}),metadata:{allowAnonymous:!1,userContextId:t}}:{shouldRenderContent:!1,scenarioCorrelation:e,metadata:{allowAnonymous:!1,userContextId:t}}}function Sr({appsRegistryService:e,client:t,commandChangeReportingService:n,coreSettings:i,deepLink:a,hostCommunicationService:o,isInternalDeeplink:r,logger:s,loggerFactory:l,scenarioCorrelation:d,scenarioFactory:u,userBiService:m,userContextId:g,preferredCommandInput:p}){return(0,c.mG)(this,void 0,void 0,(function*(){const c=sr[a];if(c){let e;switch(s.log(`Static deeplink: ${c}`),a){case sr.flyout:e=vr(d,g,{type:Ie.p.flyout,action:Ie.u.default},Ae.lO.minimal);break;case sr.default:e=vr(d,g,Ar(),Ae.lO.standard);break;case sr.core:e=vr(d,g,void 0)}return Cr(n,d.correlation.id,c,(null==e?void 0:e.shouldRenderContent)?null==e?void 0:e.entityCommand.entity.type:void 0,(null==e?void 0:e.shouldRenderContent)?null==e?void 0:e.entityCommand.entity.action:void 0),e}return fr({decodedLink:function(e){return decodeURIComponent(e).replace(/[^A-Za-z0-9/.?&=#\+\-,_:@{}"]/g,"")}(a),scenarioCorrelation:d,scenarioFactory:u,coreSettings:i,hostCommunicationService:o,appsRegistryService:e,loggerFactory:l,logger:s,userBiService:m,isInternalDeeplink:r,commandChangeReportingService:n,userContextId:g,client:t,preferredCommandInput:p})}))}function fr({appsRegistryService:e,client:t,commandChangeReportingService:n,coreSettings:i,decodedLink:a,hostCommunicationService:o,isInternalDeeplink:r,logger:s,loggerFactory:l,scenarioCorrelation:d,scenarioFactory:u,userBiService:m,userContextId:g,preferredCommandInput:p}){var h;return(0,c.mG)(this,void 0,void 0,(function*(){const v=new URL(a,i.get(A.J.Host).deepLinkDomain||void 0);!function(e,t,n,i){const{pathname:a,search:o}=i,r="/"===a[0]?a.substr(1):a,s=rr.find((e=>{const t="/"===e[0]?e.substr(1):e;return r.startsWith(t)}));if(!s)return;const l={};l["DataBag.joinLinkType"]=s.toString();const d=new URLSearchParams(o);l["DataBag.deeplinkId"]=d.get("deeplinkId"),l["DataBag.joinLinkVariant"]=d.get("v"),e.recordPanelAction({actionGesture:dr.uS.open,actionOutcome:dr.$K.open,actionScenario:dr.Tk.deeplink,actionScenarioType:dr.Yu.deeplink,moduleType:dr.PO.deeplink,moduleName:dr.rA.deeplinkService,panelType:n?dr.wh.Internal:dr.wh.External,dataBag:{id:"",data:Object.assign({},l),dispose:()=>{}}},t)}(m,s,r,v);const{matchType:S,intent:f,errorCode:y,reason:k}=yield function(e,t,n,i,a,o,r,s,l,d){var u;return(0,c.mG)(this,void 0,void 0,(function*(){let c,m,g,p;try{let o;const{pathname:u}=n,p="/"===u[0]?u.substr(1):u,h=function(e){if(e.hash){const t=new URL(e.hash.substring(1),e.origin),n={pathname:t.pathname};return t.search&&(n.search=(0,cr.Qc)(t.search)),n}return}(n);for(const t of e.registeredApps){const{match:e,matchType:i,matchingCondition:a}=yr(t,p,n,h);if(e){o=a,c=i;break}}if(o){const e=yield o.execute({context:{client:r,coreSettings:t,loggerFactory:a,scenarioFactory:s},deeplinkUrl:n,preferredCommandInput:l,parsedDeeplinkHash:h});e&&(m=Object.assign(Object.assign({},e),{shouldRenderContent:!0,entityCommand:Object.assign(Object.assign({},e.entityCommand),{command:Object.assign(Object.assign({},e.entityCommand.command),{correlation:i.correlation})}),scenarioCorrelation:i,metadata:Object.assign({userContextId:d},e.metadata)}))}m||(g=Gt.DeeplinkNotHandledByRegisteredApps)}catch(e){g=Gt.OnBeforeDeeplinkParsedFailed,p=e.message;const t=e.reason,n=`DeepLink:: /${g}/${(0,me.A)(p)}/${t}`;null===(u=o.errorToTelemetry)||void 0===u||u.call(o,n,"webclient_framework_foundation_core_services_deeplink",void 0,!0)}return{matchType:c,intent:m,errorCode:g,reason:p}}))}(e,i,v,d,l,s,t,u,p,g);(null==f?void 0:f.shouldRenderContent)?s.log(`Deeplink parsed to intent: { type: ${f.entityCommand.entity.type}, action: ${f.entityCommand.entity.action} }`):s.log("Returning default entity to be executed as fallback");let C=f;const{enableUnsupportedDeeplinkDialog:b}=i.get(A.J.Core);if(s.log(`enableUnsupportedDeeplinkDialog: ${b}`),!C&&b){const e=yield o.loadModule("appswitcher"),t=yield null===(h=null==e?void 0:e.getPearInstallState)||void 0===h?void 0:h.call(e,Gn.Teams1);s.log(`t1InstallState: ${t}`),t!==Wn.InstalledNotActive&&t!==Wn.InstalledActive||(s.log("Returning unsupported deeplink command"),C=vr(d,g,{type:Ie.p.unsupporteddeeplinkdialog,action:Ie.u.view},Ae.lO.standard,Ae.su.extend,{originalDeeplink:v}))}return Cr(n,d.correlation.id,S,null==C?void 0:C.entityCommand.entity.type,null==C?void 0:C.entityCommand.entity.action,y,k),C}))}function yr(e,t,n,i){if(!e.onBeforeDeeplinkParsed)return{match:!1};for(const a of e.onBeforeDeeplinkParsed){const{filter:o}=a;if(kr(o)){if(o(n,i))return{match:!0,matchType:`${e.manifest.name}#filterFn`,matchingCondition:a}}else{const e="/"===o[0]?o.substr(1):o;if(t.startsWith(e))return{match:!0,matchType:e,matchingCondition:a}}}return{match:!1}}function kr(e){return(0,Z.isFunction)(e)}function Cr(e,t,n,i,a,o,r){const s="deeplink-parsing";e.report({correlationId:t,type:Qe.B.DeeplinkParsed,context:{target:s,eventData:{deeplinkType:n,mainEntityType:i,mainEntityAction:a,errorCode:o,reason:r}}}),e.report({type:Qe.B.ScenarioEventDataAppended,correlationId:t,context:{target:s,eventData:{deeplinkType:n,mainEntityType:i,mainEntityAction:a,errorCode:o,reason:r}}})}function br({appsRegistryService:e,coreSettings:t,hostCommunicationService:n,location:i,scenarioCorrelation:a,scenarioFactory:o,loggerFactory:r,userBiService:s,isInternalDeeplink:l,commandChangeReportingService:d,intentPersistenceService:u,userContextId:m,client:g,preferredCommandInput:p}){return(0,c.mG)(this,void 0,void 0,(function*(){const c=r.newLogger("DeeplinkUtilities"),h=function(e,t){var n,i;const{hash:a,href:o,pathname:r}=e;if(!a&&!o&&!r)return;if(a){const{deepLink:e,crash:t,relaunch:n,source:i}=wr(a);if(e)return{deepLink:e,crash:t,relaunch:n,relaunchSource:i,isDesktopDeeplink:!0}}if(o){let e;try{e=decodeURIComponent(o)}catch(e){const a=`${Gt.DecodeURIComponentFailed}::${null==e?void 0:e.name}`;return void(null===(i=(n=t.newLogger(Wt)).errorToTelemetry)||void 0===i||i.call(n,a,"webclient_framework_foundation_core_services_deeplink",void 0,!0))}return{deepLink:e,crash:!1,relaunch:!1,relaunchSource:void 0}}return}(i,r);let v;if(h&&h.isDesktopDeeplink){const i=function(e,t,n,i){const{deepLink:a}=e;let o=a;if(function(e,t){const{deepLink:n,crash:i,relaunch:a,relaunchSource:o}=e;if(i||a){const e=i?"crash":"relaunch";if(t.log(`Recovering from a ${e}: ${e} QSP present.`),!i&&o&&!function(e){switch(e){case lr.d.ReloadAppTask:case lr.d.RemoveAuthenticatedUserResolver:return!0;default:return!1}}(o))return t.log(`Recovering from a ${e}: Do not restore deeplink for reload source: ${o}`),!1;switch(sr[n]){case sr.default:case sr.core:return!0;case sr.flyout:return t.log(`Recovering from a ${e}: flyout requested, do not recover a persisted deeplink.`),!1;default:return t.log(`Recovering from a ${e}: new deeplink present, do not recover a persisted one.`),!1}}return!1}(e,i)){const e=function(e,t){const n=e.getAllStoredDeeplinks();let i;return t.registeredApps.forEach((e=>{n[e.manifest.id]&&(i=n[e.manifest.id])})),i}(t,n);e?(o=e,i.log("Found deeplink from the previous session.")):i.log("No deeplink found to restore.")}return t.clear(),o}(h,u,e,c);return v=yield Sr({appsRegistryService:e,coreSettings:t,deepLink:i,hostCommunicationService:n,scenarioCorrelation:a,scenarioFactory:o,loggerFactory:r,logger:c,userBiService:s,isInternalDeeplink:l,commandChangeReportingService:d,userContextId:m,client:g,preferredCommandInput:p}),v}return h&&(v=yield fr({decodedLink:h.deepLink,scenarioCorrelation:a,scenarioFactory:o,coreSettings:t,hostCommunicationService:n,appsRegistryService:e,loggerFactory:r,logger:c,userBiService:s,isInternalDeeplink:l,commandChangeReportingService:d,client:g,userContextId:m,preferredCommandInput:p})),v||(v=function(e,t,n){const{hash:i,pathname:a}=e;let o,r;if(i&&!(0,Z.isEmpty)(i)){const e=i.indexOf("?");o=e>=0?i.substr(0,e):i}else o=a;const s=gr(o);s&&(r=vr(t,n,s));return r}(i,a,m)),v}))}function Tr(e,t){let n=function(e){const{hash:t,search:n}=e;let i=n;if(t&&!(0,Z.isEmpty)(t)){const e=t.indexOf("?");e>=0&&(i=t.substr(e+1,t.length-1))}const a=function(e){return(0,cr.Qc)(e||"")}(i);let o;a.correlationId&&a.startTimestamp&&a.source&&(o={id:a.correlationId,startTimestamp:a.startTimestamp,source:a.source});return o}(e);return n=n||Xe({scenarioName:ee.RG.NavigationCommand,source:t}),n}function wr(e){const{deepLink:t,crash:n,relaunch:i,source:a,clientId:o,deeplinkId:r}=(0,cr.Qc)(e);return{deepLink:t,crash:"true"===n,relaunch:"true"===i,source:a&&lr.d[a],clientId:o,deeplinkId:r}}function _r({clientLaunchId:e,location:t}){var n;return null!==(n=null!=e?e:t&&Ir(t,"clientId"))&&void 0!==n?n:(0,Je.v4)()}function Ir(e,t){const{hash:n}=e;if(n){const e=wr(n);return e&&e[t]}}function Ar(){return{action:Ie.u.default,type:Ie.p.default}}var Nr=n(91477);const Er=new Set([Rt.EntityType.chats,Rt.EntityType.channels]),Dr="active_windows_history";class Fr{constructor(e,t,n,i,a,o,r,s){this._client=t,this._experienceChangeReportingService=n,this._localStorage=i,this._rebootService=a,this._scenarioFactory=o,this._userContextId=r,this._windowProvider=s,this.cleanup=e=>{switch(e){case"quit":case"restart":this.unsubscribe();break;case"signout":default:this.unsubscribe(),this.clearCache()}},this.unsubscribe=()=>{var e,t;null===(e=this._activeWindowsSubscription)||void 0===e||e.unsubscribe(),null===(t=this._windowOptionsSubscription)||void 0===t||t.unsubscribe()},this._logger=e.newLogger("ActiveWindowsHistoryService"),this._logger.log("ActiveWindowsHistoryService:: constructed")}initialize(){const e=this.cleanup;this._rebootService.registerCleanupCallback(e);const{crash:t,relaunch:n}=wr(this._windowProvider.location.hash);this._logger.log(`ActiveWindowsHistoryService:: crash: ${t} or relaunch: ${n}`),this.restoreWindows(t||n)&&this.subscribeWindows()}restoreWindows(e){if(!e)return this.clearCache(),!0;const t=this._scenarioFactory.newScenario(ee.RG.ActiveWindowsHistoryRestore),n=e=>{this.cleanup();const n={reason:e};t.fail(n)},i=(0,Nr.F$)(this._client);if(!i)return n("Failed to read activeWindows from Apollo."),!1;const a=this.filterWindows(i),o=this.readCache();if(!o)return n("Failed to read from localStorage."),!1;const r=o.filter((e=>!a.find((t=>t.activeEntities.mainEntity.id===e.activeEntities.mainEntity.id))));return r.length&&(r.forEach((e=>{e.activeEntities.entityExtension=null})),!(0,Nr.bF)(this._client,i.concat(r)))?(n("Failed to write activeWindows to Apollo."),!1):a.length&&!this.persistCache(a.concat(r))?(n("Failed to write to localStorage."),!1):(t.stop(),!0)}subscribeWindows(){this._activeWindowsSubscription=(0,Nr.OB)(this._client).subscribe((({errors:e,loading:t,data:n})=>(0,c.mG)(this,void 0,void 0,(function*(){var i,a,o,r;if(t)return;if(e)return void(null===(a=(i=this._logger).errorToTelemetry)||void 0===a||a.call(i,`subscribeWindows::watchActiveWindows::${(0,R.u4)(e)}`,"webclient_framework_foundation_core_services_active_windows_history",void 0,!0));const{activeWindows:s=[]}=n,l=this.filterWindows(s);this.persistCache(l)||(this.cleanup(),null===(r=(o=this._logger).errorToTelemetry)||void 0===r||r.call(o,`Failed to write ${l.length} windows to localStorage.`,"webclient_framework_foundation_core_services_active_windows_history",void 0,!0))})))),this._windowOptionsSubscription=this._experienceChangeReportingService.observeChanges().subscribe((e=>(0,c.mG)(this,void 0,void 0,(function*(){if(e.type!==Tt.FV.WindowOptionsChange||!e.windowId||this._userContextId&&e.userContextId!==this._userContextId)return;const t=e=>{var t,n;this.cleanup(),null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,e,"webclient_framework_foundation_core_services_active_windows_history",void 0,!0)},n=this.readCache();if(!n)return void t("subscribeWindows::windowOptions::Failed to read from localStorage.");const i=n.find((t=>t.id===e.windowId));if(!i)return;const{height:a,left:o,top:r,width:s}=e.context;i.windowOptions={__typename:"WindowOptions",height:a,left:o,top:r,width:s},this.persistCache(n)||t(`subscribeWindows::windowOptions::Failed to write ${n.length} windows to localStorage.`)}))))}filterWindows(e){return e.filter((e=>((e,t)=>e.layoutConfig.layoutMode===Rt.LayoutModes.focus&&!e.isMainWindow&&(!t||t===e.userContextId)&&Er.has(e.activeEntities.mainEntity.type))(e,this._userContextId)))}clearCache(){this._logger.log("ClearCache::ACTIVE_WINDOWS_HISTORY_STORAGE_KEY"),this._localStorage.remove(Dr,or.f.UserAndExperience)}persistCache(e){return this._logger.debug(`Persist ${e.length} windows to cache.`),this._localStorage.setSafe(Dr,JSON.stringify(e),or.f.UserAndExperience)}readCache(){try{const e=JSON.parse(this._localStorage.get(Dr,or.f.UserAndExperience)||"[]");return this._logger.debug(`Read ${e.length} windows from cache.`),e}catch(e){return}}}var Pr=n(68602);class Mr extends xe{constructor(){super(_.Yg.CreateActiveWindowsHistoryTask,["authenticationUser","coreSettings","client","experienceChangeReportingService","localStorage","loggerFactory","rebootService","scenarioFactory","windowProvider"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettings:n}=e,i=null==n?void 0:n.get(A.J.Core);if(!(null==i?void 0:i.enableActiveWindowsHistoryRecovery)||(null==t?void 0:t.role)!==Pr.w4.Member)return;const{client:a,experienceChangeReportingService:o,localStorage:r,loggerFactory:s,rebootService:l,scenarioFactory:d,windowProvider:c}=e;e.activeWindowsHistoryService=new Fr(s,a,o,r,l,d,i.enableMTMA?(0,qe.b)(t):void 0,c)}))}}var jr=n(28076);class Rr{constructor(e,t){this._experienceChangeReportingService=e,this._userContextId=t,this._appBarObservable=this._experienceChangeReportingService.observeChanges().pipe((0,S.h)((e=>e.userContextId===this._userContextId&&e.type===Tt.yU.AppSelectionChanged&&e.context.appId!==this._currentValue)),(0,h.U)((e=>{this._previousValue=this._currentValue;const t=e;return this._currentValue=t.context.appId,{previousApplicationSelection:this._previousValue,newApplicationSelection:this._currentValue}}))).pipe((0,jr.B)()),this._appBarSubscription=this._appBarObservable.subscribe()}cleanup(){var e;null===(e=this._appBarSubscription)||void 0===e||e.unsubscribe()}observe(){return this._appBarObservable}current(){return this._currentValue}}class xr extends xe{constructor(){super(_.Yg.CreateAppBarServiceTask,["authenticationUser","experienceChangeReportingService"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{authenticationUser:t}=e,{experienceChangeReportingService:n}=e,i=new Rr(n,(0,qe.b)(t));return e.appBarService=i,()=>{i.cleanup()}}))}}var Or,Lr,Ur=n(56962),Br=n(71068),Wr=n(66927);class Gr{constructor(e=_.eT.Interactive){this._appState$=new u.X(e),this._appServicesStateMap=new Map;for(const e of Wr.Q)this.initializeAppServiceState(e);(0,Q.J)().opener.addEventListener(K.rY.AppStateSyncMessage,(e=>{var t;const n=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.appState;this.setAppState(n)}))}notifyServiceUp(e,t){this.notifyAppServiceStateChange(e,Wr.l.ONLINE,t)}notifyServiceDown(e,t,n){this.notifyAppServiceStateChange(e,Wr.l.OFFLINE,t,n)}observe(){return this._appState$.asObservable().pipe((0,Br.x)())}observeAppServiceState(){const e=Array.from(this._appServicesStateMap.values()).map((e=>e.asObservable().pipe((0,Br.x)())));return(0,Ur.T)(...e)}getState(){return this._appState$.value}getAppServiceState(e){const t=this._appServicesStateMap.get(e);return t?t.value:{appService:e,currentState:Wr.l.UNKNOWN}}setAppState(e){void 0!==e&&e!==this.getState()&&this._appState$.next(e)}initializeAppServiceState(e){this._appServicesStateMap.set(e,new u.X({appService:e,currentState:Wr.l.UNKNOWN}))}notifyAppServiceStateChange(e,t,n,i){const a=this._appServicesStateMap.get(e);if(!a)return;const o={appService:e,previousState:a.getValue().currentState,currentState:t,currentStateChangeTimestamp:new Date,currentStateChangeReason:n,currentStateChangeCode:i};a.next(o)}}!function(e){e.Active="Active",e.Inactive="Inactive",e.LongInactive="LongInactive"}(Or||(Or={}));class Vr{constructor(e,t,n,i,a){this._host=e,this._activityCallback=i,this._trackDocumentVisibility=a,this.msUntilIdle=Vr.MsUntilIdleDefault,this.msUntilLongIdle=Vr.msUntilLongIdleDefault,this.handleMonitoredWindowEvent=(0,Z.debounce)((()=>{this._idleStateBehaviorSubject.value!==Or.Active&&this._idleStateBehaviorSubject.next(Or.Active),this.restartIdleTimer(),this._activityCallback&&this._activityCallback()}),Vr.msDelayTime,{maxWait:this.msUntilIdle-Vr.msDelayTime*Vr.msMaxWaitTimeFactor,leading:!0}),this.handleIdleTimerTimeout=()=>{this._idleStateBehaviorSubject.next(Or.Inactive),this._idleCountdownTimer=void 0,this.restartLongIdleTimer()},this.handleLongIdleTimerTimeout=()=>{this._idleStateBehaviorSubject.next(Or.LongInactive),this._longIdleCountdownTimer=void 0},this.handleDocumentVisibilityChange=()=>{this._host.document.hidden?this._idleStateBehaviorSubject.next(Or.Inactive):(this._idleStateBehaviorSubject.next(Or.Active),this.restartIdleTimer())},this._idleStateBehaviorSubject=new u.X(Or.Inactive),n&&this.setSettings(n),this.restartLongIdleTimer(),Vr.monitoredWindowEvents.forEach((t=>{e.addEventListener(t,this.handleMonitoredWindowEvent)})),a&&e.addEventListener("visibilitychange",this.handleDocumentVisibilityChange),t.newLogger("IdleTracker").log("Initialized")}observe(){return this._idleStateBehaviorSubject.asObservable()}getState(){return this._idleStateBehaviorSubject.value}createChildWindowIdleTracker(e,t,n){const i=this._activityCallback||this.handleMonitoredWindowEvent;return new Vr(e,t,n,i)}restartIdleTimer(){this.stopIdleTimers(),this._idleCountdownTimer=this._host.setTimeout(this.handleIdleTimerTimeout,this.msUntilIdle)}dispose(){this.stopIdleTimers(),Vr.monitoredWindowEvents.forEach((e=>{this._host.removeEventListener(e,this.handleMonitoredWindowEvent)})),this._trackDocumentVisibility&&this._host.removeEventListener("visibilitychange",this.handleDocumentVisibilityChange),this._idleStateBehaviorSubject.complete(),this.handleMonitoredWindowEvent.cancel()}setSettings(e){const{appIdleTimeoutInMs:t,appLongIdleTimeoutInMs:n}=e.get(A.J.Core);this.msUntilIdle=t||Vr.MsUntilIdleDefault,this.msUntilLongIdle=n||Vr.msUntilLongIdleDefault}restartLongIdleTimer(){void 0!==this._longIdleCountdownTimer&&(this._host.clearTimeout(this._longIdleCountdownTimer),this._longIdleCountdownTimer=void 0),this._longIdleCountdownTimer=this._host.setTimeout(this.handleLongIdleTimerTimeout,this.msUntilLongIdle)}stopIdleTimers(){void 0!==this._idleCountdownTimer&&(this._host.clearTimeout(this._idleCountdownTimer),this._idleCountdownTimer=void 0),void 0!==this._longIdleCountdownTimer&&(this._host.clearTimeout(this._longIdleCountdownTimer),this._longIdleCountdownTimer=void 0)}}function Hr(e){switch(e){case _.eT.InCall:case _.eT.InBroadcast:case _.eT.Presenting:return Ve.pk.VeryActive;case _.eT.Interactive:return Ve.pk.Active;case _.eT.Inactive:return Ve.pk.Inactive;case _.eT.LongInactive:return Ve.pk.LongInactive;case _.eT.Disabled:return Ve.pk.Unrecoverable;default:return}}Vr.monitoredWindowEvents=["scroll","DOMMouseScroll","mousewheel","touchstart","touchmove","mousemove","keydown"],Vr.msDelayTime=1e3,Vr.msMaxWaitTimeFactor=30,Vr.msUntilLongIdleDefault=12e5,Vr.MsUntilIdleDefault=3e5;class $r{constructor(e,t,n,i,a){this._host=t,this.timesToSendUntilIdle=2,this._logger=n.newLogger("ClientStateSender");const{appIdleTimeoutInMs:o}=i.get(A.J.Core);this.msUntilResend=o?Math.round(o/this.timesToSendUntilIdle):a,this._subscriptionToStateChange=e.pipe((0,Br.x)()).subscribe((e=>this.handleStateChange(e))),this._logger.log("Initialized")}dispose(){this.stopRecurringSending(),this._subscriptionToStateChange.unsubscribe()}handleStateChange(e){try{e===Ve.pk.Active||e===Ve.pk.VeryActive?this.sendStateRecurringly(e):(this.stopRecurringSending(),this.sendState(e))}catch(t){this._logger.error(`Failed to send client state update: ClientState=${e}, Error: ${t}`)}}sendStateRecurringly(e){this._logger.log(`Starting recurring sending of client state: ${e}`);try{this.sendStateAndStartTimer(e)}catch(t){this._logger.error(`Failed to start recurring sending of client state: ClientState=${e}, Error: ${t}`)}}stopRecurringSending(){this.stopTimer(),this._logger.log("Stopped recurring client state sending")}stopTimer(){if(void 0!==this._recurringSendCountdownTimer)try{this._host.clearInterval(this._recurringSendCountdownTimer),this._recurringSendCountdownTimer=void 0}catch(e){this._logger.error(`Failed to stop sending of client state: ${e}`)}}sendStateAndStartTimer(e){this.sendState(e),this.stopTimer(),this._recurringSendCountdownTimer=this._host.setInterval((()=>this.sendState(e)),this.msUntilResend)}sendState(e){const t=function(e){switch(e){case Ve.pk.Unrecoverable:return _.eT.Disabled;case Ve.pk.Inactive:return _.eT.Inactive;case Ve.pk.LongInactive:return _.eT.LongInactive;case Ve.pk.VeryActive:return _.eT.InCall;default:return _.eT.Interactive}}(e);this._logger.log(`Sending state to main window: ${t} (ClientState=${e})`),this._host.opener.postMessage(K.rY.UpdateWindowState,{childSettings:{appState:t}})}}class zr{constructor(e,t,n,i){this._coreClientStateObservable=e,this._idleTracker=n,this._initialClientState=i,this._coreClientStateSubscription=null,this._logger=t.newLogger("ChildClientStateProvider"),this._logger.log(`Initializing clientState with state=${this._initialClientState}`),this._childClientStateBehaviorSubject=new u.X(this._initialClientState),this._coreClientStateSubscription=this._coreClientStateObservable.subscribe((e=>{e!==this.getState()&&(this._logger.log(`Client state is ${e}.`),this._childClientStateBehaviorSubject.next(e))})),this._logger.log("Initialized")}observe(){return this._childClientStateBehaviorSubject.asObservable()}getState(){return this._childClientStateBehaviorSubject.value}getChildWindowStateProvider(e,t,n){const i=this._idleTracker.createChildWindowIdleTracker(e,t,n);return new zr(this._coreClientStateObservable,t,i,this.getState())}dispose(){var e;this._idleTracker.dispose(),null===(e=this._coreClientStateSubscription)||void 0===e||e.unsubscribe(),this._childClientStateBehaviorSubject.complete()}}class qr{constructor(e,t,n,i,a,o){this._host=e,this._idleTracker=n,this._defaultClientState=Ve.pk.Active,this._initializing=!0,this._clientStateSubscription=null,this._idleTrackerStateSubscription=null,this.handleAppStateSyncMessage=e=>{var t;const n=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.appState;void 0!==n&&(this._logger.log(`Handling pushed host appState update change to ${n}.`),this.handleMainWindowStateChange(n))},this._logger=t.newLogger("ClientStateProvider");let r=this._defaultClientState;if(void 0!==o){const e=Hr(o);void 0!==e&&(r=e)}this._logger.log(`Initializing clientState with state=${r}`),this._clientStateBehaviorSubject=new u.X(r),this._setupEventHandlers(t,i,a),this.restartIdleTimerWhenActiveState(),this._initializing=!1,this._logger.log("Initialized")}observe(){return this._clientStateBehaviorSubject.asObservable()}getState(){return this._clientStateBehaviorSubject.value}getChildWindowStateProvider(e,t,n){const i=this._idleTracker.createChildWindowIdleTracker(e,t,n);return new zr(this.observe(),t,i,this.getState())}dispose(){var e,t;this._host.opener.removeEventListener(K.rY.AppStateSyncMessage,this.handleAppStateSyncMessage),this._idleTracker.dispose(),this._stateSender&&this._stateSender.dispose(),this._clientStateBehaviorSubject.complete(),null===(e=this._clientStateSubscription)||void 0===e||e.unsubscribe(),null===(t=this._idleTrackerStateSubscription)||void 0===t||t.unsubscribe()}startVeryActive(e){this._logger.log(`startVeryActive(): Client state is set to very active by ${e}.`),this.setClientState(Ve.pk.VeryActive)}stopVeryActive(e){this._logger.log(`stopVeryActive(): Client state is set to active by ${e}.`),this.setClientState(Ve.pk.Active)}_setupEventHandlers(e,t,n){var i;this._clientStateSubscription=this.observe().subscribe((e=>{this._logger.log(`Client state is ${e}.`)})),this._host.opener.addEventListener(K.rY.AppStateSyncMessage,this.handleAppStateSyncMessage),this._idleTrackerStateSubscription=this._idleTracker.observe().subscribe((e=>this.handleIdleChange(e))),n&&t&&(null===(i=t.get(A.J.Core))||void 0===i?void 0:i.enableUpdateAngularOnClientStateChange)&&(this._stateSender=new $r(this.observe(),this._host,e,t,Vr.MsUntilIdleDefault))}handleIdleChange(e){this._logger.log(`Handling idleness change to ${e}.`),this._clientStateBehaviorSubject.value!==Ve.pk.VeryActive&&(this._initializing||this.setClientState(function(e){switch(e){case Or.Inactive:return Ve.pk.Inactive;case Or.LongInactive:return Ve.pk.LongInactive;default:return Ve.pk.Active}}(e),!1))}setClientState(e,t=!0){e!==Ve.pk.Active&&e!==Ve.pk.VeryActive||!t||this._idleTracker.restartIdleTimer(),e===Ve.pk.Inactive&&this._clientStateBehaviorSubject.value===Ve.pk.LongInactive||this._clientStateBehaviorSubject.value!==e&&(this._logger.log(`Updating client state from=${this._clientStateBehaviorSubject.value} to=${e}.`),this._clientStateBehaviorSubject.next(e))}handleMainWindowStateChange(e){const t=Hr(e);t!==Ve.pk.Active&&t!==Ve.pk.VeryActive||this.setClientState(t)}restartIdleTimerWhenActiveState(){this.getState()!==Ve.pk.Active&&this.getState()!==Ve.pk.VeryActive||this._idleTracker.restartIdleTimer()}}!function(e){e.Initializing="Initializing",e.Unrecoverable="Unrecoverable",e.LongInactive="LongInactive",e.Inactive="Inactive",e.Active="Active",e.VeryActive="VeryActive"}(Lr||(Lr={}));var Jr,Qr;!function(e){e.LoadModuleCoreFailed="LoadModuleCoreFailed",e.LoadModuleOsUtilsFailed="LoadModuleOsUtilsFailed",e.LoadModuleScenarioFailed="LoadModuleScenarioFailed",e.LoadModuleTelemetryFailed="LoadModuleTelemetryFailed",e.LoadModuleWebClientStatesFailed="LoadModuleWebClientStatesFailed",e.ExecuteCommandFailed="ExecuteCommandFailed",e.RegisterForAppStateChangedFailed="RegisterForAppStateChangedFailed",e.ReportReadyToQuitFailed="ReportReadyToQuitFailed"}(Jr||(Jr={})),function(e){e.LoadModuleCoreSuccess="LoadModuleCoreSuccess",e.ExecuteCommandSuccess="ExecuteCommandSuccess"}(Qr||(Qr={}));var Kr=n(18402);class Yr{constructor(e,t,n){this.handleMachineLockUpdate=e=>{var t;const n=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.isMachineLocked;void 0!==n&&(this._logger.log(`Handling pushed machineLock update change: isMachineLocked = ${n}.`),this.updateMachineLockState(n))},this._logger=t.newLogger("HostStateProvider"),this._hostStateSubject=new u.X({windowState:Ve.kZ.InFocus,machineLockState:Ve.UV.Active,suspendedState:Ve.V9.Resumed}),this.registerForStateChanges(e,n)}observe(){return this._hostStateSubject.asObservable()}getState(){return Object.assign({},this._hostStateSubject.value)}dispose(){var e;null===(e=this._machineStateChangedSubscription)||void 0===e||e.call(this)}registerForStateChanges(e,t){e.opener.addEventListener(K.rY.AppStateSyncMessage,this.handleMachineLockUpdate),t.loadModule("osutils").then((e=>{var t;this._machineStateChangedSubscription=null===(t=null==e?void 0:e.registerForSessionStateChanged)||void 0===t?void 0:t.call(e,(e=>{this._logger.log(`Handling pushed machineLock update change: machine SessionStatus= ${e.status}.`),e.status===Kr.$.Suspending||e.status===Kr.$.Resumed?this.updateSuspendedState(e.status===Kr.$.Suspending):this.updateMachineLockState(e.status===Kr.$.Locked)}))}))}updateMachineLockState(e){const t=e?Ve.UV.Locked:Ve.UV.Active,n=this.getState().machineLockState;if(t!==n){this._logger.log(`Updating machine lock state from=${n} to=${t}.`);const e=this.getState();e.machineLockState=t,this._hostStateSubject.next(e)}}updateSuspendedState(e){const t=e?Ve.V9.Suspending:Ve.V9.Resumed,n=this.getState().suspendedState;if(t!==n){this._logger.log(`Updating machine suspended state from=${n} to=${t}.`);const e=this.getState();e.suspendedState=t,this._hostStateSubject.next(e)}}}var Xr=n(39874);class Zr{constructor(e,t,n){this.scenarioFactory=n,this.observe=()=>this.networkStateBehaviorSubject.asObservable(),this.getState=()=>this.networkStateBehaviorSubject.getValue(),this.observeIsOnline=()=>this.isOnlineObservable,this.isOnline=()=>this.convertToIsOnline(this.getState()),this.observeDetailedNetworkState=()=>this.detailedNetworkStateBehaviorSubject.asObservable(),this.convertToIsOnline=e=>e===Xr.G.Online,this.getDetailedState=()=>this.detailedNetworkStateBehaviorSubject.getValue(),this.logger=e.newLogger(t);const i=Xr.G.Online,a=Xr.T.Unknown;this.networkStateBehaviorSubject=new u.X(i),this.isOnlineObservable=this.networkStateBehaviorSubject.asObservable().pipe((0,h.U)((e=>this.convertToIsOnline(e))),(0,Br.x)()),this.logger.log(`Network state is initialized as ${Xr.G[i]}`),this.sendStateChangeTelemetry(i),this.detailedNetworkStateBehaviorSubject=new u.X(a)}dispose(){this.networkStateBehaviorSubject.complete(),this.detailedNetworkStateBehaviorSubject.complete(),this.previousNetworkStateChangeTime=void 0}setNetworkState(e,t){this.logger.log(`Set network state to ${Xr.G[e]}${t?` due to ${t}`:""}`),this.setDetailedNetworkState(this.convertToIsOnline(e)?Xr.T.Online:Xr.T.Offline),this.getState()!==e&&(this.networkStateBehaviorSubject.next(e),this.logger.log(`Network is ${Xr.G[e]}`),this.sendStateChangeTelemetry(e,t))}setDetailedNetworkState(e){this.getDetailedState()!==e&&this.detailedNetworkStateBehaviorSubject.next(e)}sendStateChangeTelemetry(e,t){if(!this.scenarioFactory)return;let n=-1;const i=(new Date).getTime();if(this.previousNetworkStateChangeTime&&(n=i-this.previousNetworkStateChangeTime),this.previousNetworkStateChangeTime=i,-1===n)return;const a=e===Xr.G.Online?ee.RG.NetworkOnline:ee.RG.NetworkOffline;this.scenarioFactory.newScenario(a).stop({delta:n,reason:t})}}class es{constructor(e){this.logger=e,this.subscriptions=[],this.currentState=void 0}getLastState(){return this.currentState}subscribeToStateChange(e){const t=this;t.subscriptions.push(e);return()=>{const n=t.subscriptions.indexOf(e);n>=0&&t.subscriptions.splice(n,1)}}cleanUpSubscriptions(){this.subscriptions=[],this.currentState=void 0}notifyAboutStateChange(e){this.currentState=e,this.subscriptions.forEach((t=>t(e)))}doOverrideOfLastState(e){this.currentState=e}}class ts extends es{constructor(e,t,n){super(e),this.label=t,this.onOverrideLastState=n,this.handleNetworkStateNotification=e=>{this.logger.debug(`${this.label} received ${Xr.G[e]}`),this.getLastState()!==e&&(this.logger.log(`${this.label} network state is ${Xr.G[e]}`),this.notifyAboutStateChange(e))}}overrideLastState(e){const t=this.getLastState();this.logger.debug(`EndpointsNetworkStateListener state is overriden from ${void 0===t?"undefined":Xr.G[t]} to ${Xr.G[e]}`),this.doOverrideOfLastState(e),this.onOverrideLastState(e)}cleanUpSubscriptions(){super.cleanUpSubscriptions()}}class ns extends es{constructor(e,t){super(e),this.handleNetworkStateNotification=e=>{const t=e?Xr.G.Online:Xr.G.Offline;this.logger.debug("Endpoints network state is "+(e?"online":"offline")),this.getLastState()!==t&&(this.logger.log("Endpoints network state is "+(e?"online":"offline")),this.notifyAboutStateChange(t))};const n={next:this.handleNetworkStateNotification,complete:()=>{var e;return null===(e=this.subscription)||void 0===e?void 0:e.unsubscribe()}};this.subscription=t.observeIsOnline().subscribe(n)}overrideLastState(e){const t=this.getLastState();this.logger.debug(`EndpointsNetworkStateListener state is overriden from ${void 0===t?"undefined":Xr.G[t]} to ${Xr.G[e]}`),this.doOverrideOfLastState(e)}cleanUpSubscriptions(){var e;super.cleanUpSubscriptions(),this.subscription&&!this.subscription.closed&&(null===(e=this.subscription)||void 0===e||e.unsubscribe()),this.subscription=void 0}}var is=n(18541);class as extends es{constructor(e){super(e),this.failed_to_fetch_subContext="rejectHttpError",this.processResponse=e=>{void 0!==e.status&&this.handleNetworkStateNotification(Xr.G.Online)},this.processResponseError=e=>{e&&(e.serverResponse?this.handleNetworkStateNotification(Xr.G.Online):e.context===_.w5.RejectHttpError&&e.code===_.jK.RemoteOperationFailed&&e.subContext===this.failed_to_fetch_subContext?this.handleNetworkStateNotification(Xr.G.Offline):this.logger.log(`Not network related error: ${e.message||e}`))},this.handleNetworkStateNotification=e=>{this.logger.debug(`Send network state is ${Xr.G[e]}`),this.getLastState()!==e&&(this.logger.log(`Send network state listener is ${Xr.G[e]}`),this.notifyAboutStateChange(e))},this.unsubscribeFromSendTracking=(0,is.z)(this.processResponse,this.processResponseError)}overrideLastState(e){const t=this.getLastState();this.logger.debug(`Send state listener's state is overriden from ${void 0===t?"undefined":Xr.G[t]} to ${Xr.G[e]}`),this.doOverrideOfLastState(e)}cleanUpSubscriptions(){super.cleanUpSubscriptions(),this.unsubscribeFromSendTracking&&this.unsubscribeFromSendTracking(),this.unsubscribeFromSendTracking=void 0}}var os=n(20448);const rs=(e,t)=>Promise.resolve({apiName:t,constructRequest:n=>{const i=e();return i.searchParams.set("cb",Date.now().toString()),{apiName:t,url:i.href,method:"HEAD",timeout:1e4,headers:{"cache-control":"no-store"},cancellationToken:n.token}},transformResponse:()=>Promise.resolve()}),ss=e=>{const{coreSettings:t,platformService:n}=e;return{serviceName:os.EJ.NetworkPing,models:{getNetworkStatus:rs((()=>new URL(t.get(A.J.Core).networkPingUrl||"/diagnostics/network",n.config.currentUrl)),"networkPing"),getNetworkStatusFallback:rs((()=>new URL(t.get(A.J.Core).networkPingFallbackPingUrl||"/evergreen-assets/icons/1x1-000000ff.png",n.config.staticsPath)),"networkFallbackPing")}}};var ls=n(52397),ds=n(19249);function cs(e,t,n,i=ls.A.TimedOut){let a;const o=new Promise((e=>{a=t.setTimeout(e,n)}));return Promise.race([e,o.then((()=>{throw(0,ds.T)(i)}))]).then((e=>(t.clearTimeout(a),e)))}function us(e,t){return new Promise(((n,i)=>{if(e<0)i((0,ds.T)(ls.A.InvalidParameters));else{let i=0;i=t.setTimeout((()=>{t.clearTimeout(i),n()}),e)}}))}const ms=[5e3,1e4,3e4],gs="cancelled_ping";class ps{constructor(e,t,n,i,a){this.coreSettings=e,this.endpointsManager=t,this.scenarioFactory=n,this.host=i,this.ping=()=>{const e=this.coreSettings.get(A.J.Core).networkPingDisableFallback||!1,t=this.scenarioFactory.newScenario(ee.RG.NetworkPing);let n=this.endpointsManager.createCancelToken(),i=!1;const a=()=>i;return{promise:this.pingEndpoint("initial ping",(()=>this.endpoints.getNetworkStatus(n)),t,!e,a).then((i=>i||e?Promise.resolve(i):(n=this.endpointsManager.createCancelToken(),this.pingEndpoint("fallback ping",(()=>this.endpoints.getNetworkStatusFallback(n)),t,!1,a)))),cancel:()=>(n.cancel(),void(i=!0))}},this.pingEndpoint=(e,t,n,i,a)=>(0,c.mG)(this,void 0,void 0,(function*(){n.appendEventData({operation:e});try{return yield t(),a()?this.markPingScenarioCancelled(e,n):this.markPingScenarioSuccess(e,n)}catch(t){return a()?this.markPingScenarioCancelled(e,n):(null==t?void 0:t.serverResponse)?this.markPingScenarioSuccess(e,n):((null==t?void 0:t.reason)===ls.A.TimedOut?this.logger.log(`${e} timed out`):this.logger.log(`${e} failed`),!i&&this.markPingScenarioFailed(e,t,n))}})),this.getRetryIntervals=()=>{const e=this.coreSettings.get(A.J.Core).networkPingRetryIntervals||ms;return Object.assign([],e)},this.updatePingResult=e=>{this.latestPingResult={isOnline:e,timestamp:Date.now()}},this.logger=a.newLogger("NetworkPingService"),this.endpoints=t.createApi(ss),this.logger.log("Initialized")}detectCurrentNetworkStatus(){const e=this.coreSettings.get(A.J.Core).networkPingDebounceDelay||3e4;return!(this.coreSettings.get(A.J.Core).networkPingDisableDebounce||!1)&&this.latestPingResult&&this.latestPingResult.isOnline&&this.latestPingResult.timestamp&&Date.now()-this.latestPingResult.timestamp<e?(this.logger.log(`Skipping network detection as last online check succeeded less than ${e}ms ago.`),{promise:Promise.resolve(!0),cancel:()=>{}}):(this.logger.log("doing network ping"),this.ping())}whenNetworkOnline(){if(this.whenNetworkOnlinePromise)return this.whenNetworkOnlinePromise;const e=this.getRetryIntervals();let t=!1;const n=()=>{this.whenNetworkOnlinePromise=void 0,t=!0};let i;const a=new Promise(((a,o)=>(0,c.mG)(this,void 0,void 0,(function*(){let r;i=()=>{null==r||r(),n(),o(gs)};let s=e[0];for(let n=0;!t;n++){const{promise:i,cancel:a}=this.ping();r=()=>{null==a||a(),r=()=>{}};try{const a=yield i;if(r=()=>{},a||t)break;n<e.length&&(s=e[n]),yield us(s,this.host)}catch(e){this.logger.log("whenNetworkOnline ping rejected")}}n(),a()}))));return this.whenNetworkOnlinePromise={promise:a,cancel:()=>null==i?void 0:i()},this.whenNetworkOnlinePromise}markPingScenarioSuccess(e,t){return t.stop({message:`${e} successful!`},"success"),this.logger.log(`${e} successful!`),this.updatePingResult(!0),!0}markPingScenarioFailed(e,t,n){var i;const a=(null==t?void 0:t.reason)?t.reason:"undefined",o=null===(i=null==t?void 0:t.serverResponse)||void 0===i?void 0:i.status;return n.fail({errors:`${e} failed. error reason: ${a}. Response status: ${o}`}),this.updatePingResult(!1),!1}markPingScenarioCancelled(e,t){return t.stop({message:`${e} cancelled`},"abandoned"),this.logger.log(`${e} cancelled`),this.updatePingResult(!0),Promise.reject(gs)}}class hs extends Zr{constructor(e,t,n,i,a,o){super(e,"NetworkStateProvider",n),this.loggerFactory=e,this.coreSettings=t,this.host=i,this.clientStateProvider=a,this._defaultNetworkOnlineDetectionTimeoutInMs=15e3,this.coreContextID="",this._contextListeners=new Map,this._isFirstSignal=!0,this.createNetworkStateTracker=(e,t,n)=>{const i=new ts(this.logger,t,n),a={next:i.handleNetworkStateNotification,dispose:i.cleanUpSubscriptions};return this._addToContextListeners(e,i),i.subscribeToStateChange((e=>this._handleNetworkStateUpdate(e,`${t} network state is ${Xr.G[e]}`))),a},this._handleNetworkStateUpdate=(e,t)=>{if(this.logger.debug(`Update network to ${Xr.G[e]} due to ${t}`),e===Xr.G.Offline){if(this.getState()===Xr.G.Offline)return;this._suspectOffline()}else this._cancelNetworkOnlineDetection(t),this.getState()!==e&&this.setNetworkState(e,t),this.setDetailedNetworkState(Xr.T.Online);this._isFirstSignal&&(this._isFirstSignal=!1)},this._handleWindowOnline=()=>{this.logger.log("browser network online"),this.isOnline()||(this._updateAllListenersTo(Xr.G.Offline),this._kickOffNetworkOnlineDetection(Xr.G.Online))},this._handleWindowOffline=()=>{if(this.logger.log("browser network offline"),this.coreSettings.get(A.J.Core).disableWindowEventsNetworkDetectionV2){if(this.getState()===Xr.G.Offline)return;this.setNetworkState(Xr.G.Offline,"browser offline"),this._updateAllListenersTo(Xr.G.Offline),this._kickOffNetworkOnlineDetection(Xr.G.Offline)}else this._suspectOffline()},this._subscribeToSendNetworkState(),this.subscribeToEndpointsNetworkStateTracking(this.coreContextID,o.networkState),this._subscribeToWindowNetworkEvents();try{this._networkPingService=new ps(this.coreSettings,o,n,this.host,this.loggerFactory)}catch(e){this.logger.error("NetworkPingService initialization has failed",e)}}dispose(){super.dispose(),this._cancelNetworkOnlineDetection("dispose"),this.disposeAllContexts(),this._unsubscribeFromWindowNetworkEvents()}disposeContext(e){const t=this._contextListeners.get(e);t&&(t.forEach((e=>{e.cleanUpSubscriptions()})),this._contextListeners.delete(e))}subscribeToEndpointsNetworkStateTracking(e,t){const n=new ns(this.logger,t);return this._addToContextListeners(e,n),n.subscribeToStateChange((e=>this._handleNetworkStateUpdate(e,`Endpoints network state is ${Xr.G[e]}`)))}_subscribeToSendNetworkState(){const e=new as(this.logger);this._addToContextListeners(this.coreContextID,e),e.subscribeToStateChange((e=>this._handleNetworkStateUpdate(e,`Send network state is ${Xr.G[e]}`)))}_subscribeToWindowNetworkEvents(){this.host.addEventListener("online",this._handleWindowOnline),this.host.addEventListener("offline",this._handleWindowOffline)}_unsubscribeFromWindowNetworkEvents(){this.host.removeEventListener("online",this._handleWindowOnline),this.host.removeEventListener("offline",this._handleWindowOffline)}_updateAllListenersTo(e){this._contextListeners.forEach((t=>t.forEach((t=>{var n;return null===(n=t.overrideLastState)||void 0===n?void 0:n.call(t,e)}))))}_addToContextListeners(e,t){var n;this._contextListeners.has(e)?null===(n=this._contextListeners.get(e))||void 0===n||n.push(t):this._contextListeners.set(e,[t])}_suspectOffline(){const{enableSkipNetworkDetectionTimeoutOnOfflineStart:e,useVeryActiveForNetworkOnlineDetection:t,enableNetworkOnlineDetectionTimeout:n,networkOnlineDetectionTimeoutInMs:i}=this.coreSettings.get(A.J.Core);if(t&&this.clientStateProvider.getState()===Ve.pk.VeryActive)return this.logger.log("Network detection cancelled due to VeryActive client state."),void this.setDetailedNetworkState(Xr.T.Online);const a=this._isFirstSignal&&!!e;if(!(this._networkDetectionTimeout&&!a||this._detectCurrentNetworkStatusPromise||this._networkPing))if(this._updateAllListenersTo(Xr.G.Offline),this.setDetailedNetworkState(Xr.T.SuspectedOffline),n&&!a){const e=i||this._defaultNetworkOnlineDetectionTimeoutInMs;void 0!==this._networkDetectionTimeout||this._detectCurrentNetworkStatusPromise||(this.logger.log(`Starting ${e}ms timeout before kicking off network online detection.`),this._networkDetectionTimeout=this.host.setTimeout((()=>{this._networkDetectionTimeout=void 0,this.logger.log("Timeout expired."),this._kickOffNetworkOnlineDetection(Xr.G.Offline)}),e))}else this._kickOffNetworkOnlineDetection(Xr.G.Offline)}_kickOffNetworkOnlineDetection(e){if(!this._networkPingService||!this._canPerformPing())return void(this.getState()!==e&&this.setNetworkState(e));if(this._detectCurrentNetworkStatusPromise||this._networkPing)return;this.logger.log("Kicking off network status detection.");const t=this._networkPingService;this._detectCurrentNetworkStatusPromise=t.detectCurrentNetworkStatus(),this._detectCurrentNetworkStatusPromise.promise.then((e=>{void 0!==this._detectCurrentNetworkStatusPromise?(this._detectCurrentNetworkStatusPromise=void 0,e?(this.logger.log("Network status verified as online."),this.setNetworkState(Xr.G.Online,"http online")):(this.setNetworkState(Xr.G.Offline,"http offline"),this._startNetworkPing(t))):this.logger.log("Network detection cancelled, ignoring result.")})).catch((e=>{e===gs?this.logger.log("Network detection is cancelled"):this.logger.warn(`Network status verification error: ${e}`),this._detectCurrentNetworkStatusPromise=void 0}))}_canPerformPing(){const{enablePingService:e}=this.coreSettings.get(A.J.Core);return!!e||(this.logger.warn("Network detection is disabled."),!1)}_startNetworkPing(e){this.logger.log("Started recurring network ping."),this._networkPing=e.whenNetworkOnline(),this._networkPing.promise.then((()=>{this._networkPing?(this._networkPing=void 0,this.getState()!==Xr.G.Online&&this.setNetworkState(Xr.G.Online,"Network ping succeded")):this.logger.log("Network ping cancelled, ignoring result.")})).catch((e=>{this.logger.log(`network detection by ping terminated due to ${(null==e?void 0:e.message)?e.message:e}`)}))}_cancelNetworkPing(e){var t,n;this._networkPing&&(this.logger.log(`Cancelling network ping due to ${e}`),null===(n=(t=this._networkPing).cancel)||void 0===n||n.call(t),this._networkPing=void 0)}_cancelNetworkOnlineDetection(e){var t,n;void 0!==this._networkDetectionTimeout&&(this.logger.log(`Cancelling network detection timeout due to ${e}`),this.host.clearTimeout(this._networkDetectionTimeout),this._networkDetectionTimeout=void 0),this._detectCurrentNetworkStatusPromise&&(this.logger.log(`Cancelling network detection due to ${e}`),null===(n=(t=this._detectCurrentNetworkStatusPromise).cancel)||void 0===n||n.call(t),this._detectCurrentNetworkStatusPromise=void 0),this._cancelNetworkPing(e)}disposeAllContexts(){this._contextListeners.forEach((e=>{e.forEach((e=>{e.cleanUpSubscriptions()}))})),this._contextListeners.clear()}}class vs extends es{constructor(e,t){super(e),this.handleLegacyApplicationStateChange=e=>{const t=this.isOnlineAndConnectedInternal(e);this.logger.log(`LegacyApplicationState changed to ${_.eT[e]}`),this.notifyAboutStateChange(t)},this.isOnlineAndConnectedInternal=e=>{switch(e){case _.eT.Disabled:case _.eT.Offline:return Xr.G.Offline;default:return Xr.G.Online}},this.legacyApplicationStateSubscription=t.observe().pipe((0,Br.x)()).subscribe(this.handleLegacyApplicationStateChange)}cleanUpSubscriptions(){super.cleanUpSubscriptions(),this.legacyApplicationStateSubscription&&(this.legacyApplicationStateSubscription.unsubscribe(),this.legacyApplicationStateSubscription=void 0)}}class Ss extends Zr{constructor(e,t,n,i,a,o){super(t,"LegacyNetworkStateProvider",n),this.hostCommunicationService=o,this._legacyAppStateListener=void 0,this._suspectedStateListeners=[],this._handleNetworkListenerUpdate=(e,t)=>(0,c.mG)(this,void 0,void 0,(function*(){e!==this.getState()?(this.logger.debug(`Network suspected ${Xr.G[e]}${t?" due to ":""}${t}`),yield this._sendSuspectedNetworkStateThrottled(this._convertToIsOnline(e))):void 0!==this._suspectedIsOnline&&this.convertToIsOnline(e)!==this._suspectedIsOnline&&this._resetSuspectedState()})),this._sendSuspectedNetworkState=e=>(0,c.mG)(this,void 0,void 0,(function*(){this.logger.log(`Sending network state to main window: ${e}`);const t=yield this.hostCommunicationService.loadModule("core");(null==t?void 0:t.notifyCoreStateChanged)?t.notifyCoreStateChanged({isNetworkOnline:e}):this.logger.warn("notifyCoreStateChanged is missing in HostComms")})),this._initSuspectedThrottleFunc=()=>{this._throttledSuspectedIsOnline=(0,Z.throttle)(this._sendSuspectedNetworkState,2e3)},this._convertToIsOnline=e=>e!==Xr.G.Offline,this._updateSuspectedStateListenersTo=e=>this._suspectedStateListeners.forEach((t=>{var n;return null===(n=t.overrideLastState)||void 0===n?void 0:n.call(t,e)})),this._subscribeToLegacyAppStateTracking(e),this._subscribeToSuspectedNetworkState(a,i)}dispose(){var e;super.dispose(),null===(e=this._legacyAppStateListener)||void 0===e||e.cleanUpSubscriptions(),this._legacyAppStateListener=void 0,this._suspectedStateListeners.forEach((e=>e.cleanUpSubscriptions())),this._suspectedStateListeners=[],this._clearSuspectedState(),this._throttledSuspectedIsOnline=void 0}_subscribeToLegacyAppStateTracking(e){this._legacyAppStateListener=new vs(this.logger,e);const t=this;this._legacyAppStateListener.subscribeToStateChange((e=>t._updateNetworkState(e,`LegacyApplicationState changed to ${Xr.G[e]}`)));const n=this._legacyAppStateListener.getLastState();void 0!==n&&this._updateNetworkState(n,"initial LegacyApplicationState")}_subscribeToSuspectedNetworkState(e,t){const{enableNetworkTrackingForLegacyNetworkState:n}=t.get(A.J.Core);n&&(this._initSuspectedThrottleFunc(),this._subscribeToSendNetworkState(),this._subscribeToEndpointsNetworkStateTracking(e.networkState))}_subscribeToSendNetworkState(){const e=new as(this.logger);this._suspectedStateListeners.push(e),e.subscribeToStateChange((e=>this._handleNetworkListenerUpdate(e,`Send network state is ${Xr.G[e]}`)))}_subscribeToEndpointsNetworkStateTracking(e){const t=new ns(this.logger,e);this._suspectedStateListeners.push(t),t.subscribeToStateChange((e=>this._handleNetworkListenerUpdate(e,`Endpoints network state is ${Xr.G[e]}`)))}_updateNetworkState(e,t){this.logger.log(`Update network to ${Xr.G[e]}${t?" due to ":""}${t}`),this.getState()!==e&&(this.setNetworkState(e),this._resetSuspectedState())}_sendSuspectedNetworkStateThrottled(e){return(0,c.mG)(this,void 0,void 0,(function*(){e!==this._suspectedIsOnline?(this._resetSuspectedState(),this._suspectedIsOnline=e):this._updateSuspectedStateListenersTo(this.getState()),this._throttledSuspectedIsOnline&&(yield this._throttledSuspectedIsOnline(e))}))}_clearSuspectedState(){var e;void 0!==this._suspectedIsOnline&&(this._suspectedIsOnline=void 0),null===(e=this._throttledSuspectedIsOnline)||void 0===e||e.cancel(),this._updateSuspectedStateListenersTo(this.getState())}_resetSuspectedState(){this._clearSuspectedState(),this._initSuspectedThrottleFunc()}}class fs extends xe{constructor(){super(_.Yg.CreateAppState,[]),this.clientStateStorageKey="tmp.clientState",this._updateTelemetryOnClientStateChange=(e,t)=>{e.observe().subscribe((e=>{t.setCoreContext("AppInfo.ClientState",e)}))},this._updateTelemetryOnNetworkStateChange=(e,t)=>{e.observeIsOnline().subscribe((e=>{const n=e?"Online":"Offline";t.setCoreContext("AppInfo.NetworkState",n)}));e.observeDetailedNetworkState().subscribe((e=>{t.setCoreContext("AppInfo.DetailedNetworkState",e)}))},this._updateHostOnClientStateChange=(e,t,n)=>{const i=n.newLogger("updateHostOnClientStateChange");e.observe().subscribe((e=>t.loadModule("webclientstates").then((t=>{if(t&&t.notifyWebClientStateChange){const n=Lr[e];t.notifyWebClientStateChange(n),i.log(`messaged host new ClientState (${e}). WebClientState sent: ${n}`)}else i.warn(`${Jr.LoadModuleWebClientStatesFailed} or webclientstates.notifyWebClientStateChange is not loaded`)})).catch((e=>{i.errorToTelemetry&&i.errorToTelemetry(`Error happened: ${e.message||e}`,"webclient_framework_host_comms",void 0,!0)}))))},this._trackClientStateForGlassjar=(e,t)=>{e.observe().subscribe((e=>t.localStorage.setItem(this.clientStateStorageKey,e)))}}execute(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const{coreSettings:n,hostCommunicationService:i,hostSettings:a,loggerFactory:o,platformService:r,scenarioFactory:s,telemetryService:l,windowProvider:d}=e,c=null===(t=null==a?void 0:a.hostSettings)||void 0===t?void 0:t.appState,u=void 0!==c?c:_.eT.Inactive;e.appStateService=new Gr(u);const m=new Vr(d,o,n);e.hostState=new Yr(d,o,i),e.clientState=new qr(d,o,m,n,e.hostState,c);const g=this._createNetworkStateProvider(e,e.clientState,e.appStateService);e.networkState=g,e.errorState=new wa(d,s,r,g,e.diagnosticsService,n),this._updateTelemetryOnClientStateChange(e.clientState,l),this._updateTelemetryOnNetworkStateChange(g,l);const{enableUpdateHostOnClientStateChange:p}=n.get(A.J.Core);p&&this._updateHostOnClientStateChange(e.clientState,i,o);const{isRunningGlassjar:h}=n.get(A.J.Test);h&&this._trackClientStateForGlassjar(e.clientState,d)}))}_createNetworkStateProvider(e,t,n){const{coreSettings:i,loggerFactory:a,scenarioFactory:o,windowProvider:r,endpointsManager:s,hostCommunicationService:l}=e,{enableNetworkOnlineDetection:d}=i.get(A.J.Core);return d?new hs(a,i,o,r,t,s):new Ss(n,a,o,i,s,l)}}var ys=n(18838),ks=n(73297);class Cs extends xe{constructor(){super(_.Yg.CreateAsyncMediaAuth,["gtmRegistry","discover","loggerFactory","coreSettings","windowProvider","platformService","endpointsManager","localStorage","authenticationService","config","authenticationUser"]),this.lifeCycleSubscriptions=[_.sM.OnUserAuthenticated,_.sM.OnUserAuthenticated_MTMA]}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){e.mediaAuthService||(e.mediaAuthService=new ks.b(ys.l,e.gtmRegistry,e.discover,e.loggerFactory,e.coreSettings,e.windowProvider,e.platformService,e.endpointsManager,e.localStorage,e.authenticationService,e.config,e.authenticationUser))}))}}var bs=n(50112),Ts=n(55997),ws=n(52695);const _s=ws.string.pipe(new ws.Type("URL",(e=>e instanceof URL),((e,t)=>{try{return(0,ws.success)(new URL(e))}catch(n){return(0,ws.failure)(e,t)}}),(e=>e.href))),Is=(0,ws.union)([(0,ws.literal)("NA"),_s.pipe(new ws.Type("GTM URL",(e=>e instanceof URL&&e.pathname.endsWith("/")),(e=>(e.pathname.endsWith("/")||(e.pathname+="/"),(0,ws.success)(e))),ws.identity))]),As=(0,ws.partial)({isFreemium:ws.boolean,isBasicLiveEventsEnabled:ws.boolean,isAdvComms:ws.boolean,isTranscriptEnabled:ws.boolean,eduLicenseSkuAndCategory:(0,ws.union)([ws.string,ws.nullType]),isTPProtection:ws.boolean,isTPCustomization:ws.boolean,isTPManagement:ws.boolean,isTPWebinar:ws.boolean,isTPVirtualAppointments:ws.boolean,isInfoProtectionPremium:ws.boolean}),Ns=(0,ws.partial)({ams:Is,amsV2:Is,appMonetizationService:Is,appService:Is,chatService:Is,chatServiceAfd:Is,chatSvcAggAfd:Is,teamsPushServiceAfd:Is,cmdArtifactsService:Is,groupsServiceV2:Is,middleTier:Is,mtImageService:Is,powerPointStateService:Is,search:Is,teamsAndChannelsProvisioningService:Is,teamsEventsIntegration:Is,unifiedPresence:Is,urlp:Is,urlpV2:Is,userEntitlementService:Is,userProfileService:Is,calling_trouterUrl:Is,calling_registrarUrl:Is,consumerLicenses:Is,virtualEventsService:Is},"region Gtms");var Es=n(82372),Ds=n(66563),Fs=n(41731),Ps=n(12354),Ms=n(70101),js=n(6554),Rs=n(16360),xs=n(6181),Os=n(91178);const Ls="[Authentication][DiscoverV2]";var Us,Bs,Ws,Gs,Vs;!function(e){e.userLocale="X-Client-UI-Language",e.skypeTokenAuthzTypeHeader="ms-teams-authz-type",e.claimsChallengeCapable="claimsChallengeCapable",e.consistencyValue="ConsistencyLevel"}(Us||(Us={})),function(e){e.skypeTokenRefresh="TokenRefresh",e.skypeTokenExplicitLogin="ExplicitLogin",e.strongConsistencyMsInternalUserSignup="MS-Internal-UserSignup",e.strongConsistencyDefaultValue="Organization;ScenarioId={id}"}(Bs||(Bs={})),function(e){e[e.DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD=xs.gT.Two*xs.gT.SECONDS_PER_MINUTE*xs.gT.MILLI_PER_SECOND]="DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD"}(Ws||(Ws={})),function(e){e.skypeAuthAnonReloadJoinLocation="skypeAuthAnonReloadJoinLocation",e.skypeAuthForceAnonReload="skypeAuthForceAnonReload"}(Gs||(Gs={})),function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.SIXTEEN=16]="SIXTEEN",e[e.THIRTY=30]="THIRTY"}(Vs||(Vs={}));const Hs="skype_send_request",$s="skype_received_response",zs="skype_send_request_desktop",qs="skype_send_request_worker",Js="skype_token_received_worker",Qs="NA",Ks=[_.jK.NetworkOffline,_.jK.Forbidden,_.jK.ProxyAuthenticationRequired],Ys={context:Ls,subContext:"_getDiscoverResponse",errorCode:_.jK.NetworkOffline,message:"Network is offline, not making any call",isExpected:!0},Xs={context:Ls,subContext:"_getDiscoverResponse",errorCode:ni.SM.InteractionRequired,message:"Interaction is required to get a skype token, not making any call",isExpected:!0},Zs=e=>{if(void 0===e)return _.jK.InvalidResponse;switch(e){case Ts.qb.FORBIDDEN:return _.jK.Forbidden;case Ts.qb.NOT_AUTHORIZED:return _.jK.Unauthorized;case Ts.qb.PROXY_AUTHENTICATION_REQUIRED:return _.jK.ProxyAuthenticationRequired;default:return _.jK.FailedToFetch}},el=(0,ws.type)({skypeid:ws.string}),tl=((0,ws.type)({skypeTokenData:(0,ws.type)({regionGtms:Ns,token:(0,ws.type)({skypeToken:ws.string,expiration:ws.number,userDetails:(0,ws.partial)({region:ws.string})})})},"token"),(e,t)=>{if(!e)return t.error("Can not get userId due to skypeToken is undefined"),"";const{skypeid:n}=(0,Ds.as)(el,(0,Os.J)(e));return`8:${n}`}),nl=e=>{let t=e.findScenario(ee.RG.GetSkypeToken);return t||(t=e.newScenario(ee.RG.GetSkypeToken),t.mark("Non authz error scenario")),t},il=(e,t,n)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const i=(0,Ps.pW)();null==n||n.push("fn:getuid");const a=yield e.getUser({correlation:{id:i,source:"discover-helper::getUserIdentifierForDiscover",scenarioName:ee.RG.AuthWebUser}});if(null==n||n.push("user:"+ +!!a),null==a?void 0:a.isAuthenticated){t.log(`[_getUserIdentifier][${i}]user found by getUser call`);return(0,Ms.Xx)(a)}const o=`[_getUserIdentifier] ${a?`User is not authenticated. UserId: [${a.id}] tenantId: [${a.profile.tid}]`:"user missing"}. ${null==n?void 0:n.join(";")}`;throw(0,js.Tr)({context:Ls,subContext:"_getUserIdentifier",errorCode:a?ni.SM.UserNotAuthenticated:ni.SM.UserNotFoundError,isExpected:!0,message:o,correlationId:null!=i?i:(0,Ps.pW)()})})),al=e=>({user:e,typeName:"Discover",key:ni.op}),ol=e=>({user:e,typeName:"Discover",key:ni.rz}),rl=e=>({user:e,typeName:"Discover",key:ni.ru}),sl=(e,t)=>{var n;const i=tl(e.skypeToken,t);return t.log(`[convertResponseToISkypeToken] Skypeid received from discovery. Region: ${null==e?void 0:e.region}`),{skypeToken:null==e?void 0:e.skypeToken,expiration:null===(n=null==e?void 0:e.expires)||void 0===n?void 0:n.getTime(),regionGtms:null==e?void 0:e.regionGtms,userDetails:{id:i,licenseDetails:Object.assign(Object.assign({},null==e?void 0:e.licenseDetails),{consumerLicenseDetails:null==e?void 0:e.consumerLicenseDetails}),region:null==e?void 0:e.region,regionSettings:null==e?void 0:e.regionSettings}}},ll=(e,t,n,i,a)=>{const{skypeTokenValidationDisabled:o}=n.get(A.J.Auth),r=n.get(A.J.Host).skypeTokenValidationDisabled,s=o||r;return s&&dl(e,t,i,a),!!s},dl=(e,t,n,i)=>{if(t){n.log(`Skype token validation skipped. forceRenew:${e};isTokenSame:${t}`);const a=i.newScenario(ee.RG.SkypeTokenValidationSkipped);a.appendEventData({message:`forceRenew:${e};isTokenSame:${t}`}),a.stop()}},cl=(e,t,n,i,a,o)=>{const{authOverrides:r}=n.get(A.J.Host),{authzEndpointUrl:s,authzUrl:l,regionGtmsEnv:d}=n.get(A.J.Auth),c=((e,t,n,i)=>{const{environment:a}=(null==i?void 0:i.get(A.J.Metadata))||{};let o={method:"POST",url:n?`${e}?region_gtms_env=${n}`:`${e}`,serviceName:os.EJ.Auth,apiName:"acquireSkypeTokenWeb"};return t.role===Rt.AuthenticationUserRole.Anonymous&&(o=Object.assign(Object.assign({},o),{url:`${e}/visitor`,body:`{"tenantId": "${t.profile.tid}"}`})),a!==Fs.s_.life||t.role!==Rt.AuthenticationUserRole.Guest&&t.role!==Rt.AuthenticationUserRole.Anonymous||(o=Object.assign(Object.assign({},o),{url:`${e}/guest${n?`?region_gtms_env=${n}`:""}`})),o})((null==r?void 0:r.authzEndpointUrl)||s||l||ni.ej.AUTHZ_DEFAULT_BASE_URL,e,d,n);return i.log(`[_getFormatRequest][${t}] Request formatted. `),c.headers=((e,t,n,i)=>{const a={},o=null==t?void 0:t.locale,{disableClaimsChallenge:r}=n.get(A.J.Auth);return o&&(a[Us.userLocale]=o),r||(a[Us.claimsChallengeCapable]="true"),a.clientRequestId=e,a["x-ms-skip-phone"]="true",void 0!==i&&(a["ms-teams-authz-type"]=i?Bs.skypeTokenRefresh:Bs.skypeTokenExplicitLogin),a})(t,a,n,o),c},ul=(e,t,n)=>{"object"==typeof e&&(e.context=e.context||Ls,e.subContext=e.subContext||t,e.correlationId=e.correlationId||n)},ml=(e,t,n,i,a)=>{const o=`${null==e?void 0:e.subContext}: Failed to get skype token; correlationId:${e.correlationId}, status:${a}, message:${t}, eventData: ${null==n?void 0:n.join(";")}`;return e.isExpected?i.debug(o):i.error(o),e},gl=(e,t,n)=>{const i=null==e?void 0:e.join(";"),a=(null==n?void 0:n.get(A.J.Metadata))||{},o=n.get(A.J.Auth);return{message:`${i}::isOnline-${t}::environment:${null==a?void 0:a.environment}`,endpointUrl:null==o?void 0:o.authzUrl,resource:null==o?void 0:o.authzResource}},pl=(e,t,n,i,a,o)=>{var r,s;const{serverResponse:{status:l,body:d}={}}=e;let{message:c,errorCode:u}=e;const{reason:m,code:g}=e,p=n&&!(e.context===_.w5.RejectHttpError&&g===_.jK.RemoteOperationFailed),h=null==t?void 0:t.join(";");l&&(u=Zs(l),c=d.message);const v={reason:m,message:c,eventData:h},S=(0,me.A)((0,R.u4)(v)),f=e.correlationId,y=(null==o?void 0:o.get(A.J.Metadata))||{},k=o.get(A.J.Auth);void 0===e.isExpected&&(e.isExpected=!p||Ks.indexOf(u)>-1);const C={context:null!==(r=null==e?void 0:e.context)&&void 0!==r?r:Ls,subContext:null==e?void 0:e.subContext,message:`${c}::isOnline-${p}::env:${null==y?void 0:y.environment}`,errorCode:p?null!=u?u:g:_.jK.NetworkOffline,statusCode:l,correlationId:f,reason:S,endpointUrl:null==k?void 0:k.authzUrl,resource:null==k?void 0:k.authzResource,isExpected:!p||e.isExpected};if(!((null===(s=(0,R.u4)(e.reason))||void 0===s?void 0:s.indexOf("LoggedAlready"))>-1)&&i){switch(((e,t,n)=>{const{errorCode:i,code:a}=t;if(!e||t.isExpected||n===Ts.qb.FORBIDDEN||n===Ts.qb.PROXY_AUTHENTICATION_REQUIRED||i===_.jK.NetworkOffline||a===_.jK.NetworkOffline)return"cancel";if(i===_.jK.TimedOut||a===_.jK.TimedOut)return"incomplete";switch(n){case Ts.qb.NOT_AUTHORIZED:case-1:case Ts.qb.THROTTLED:return"incomplete";default:return"fail"}})(p,e,l)){case"stop":i.stop(C);break;case"incomplete":i.incomplete(C);break;case"cancel":i.cancel(C);break;case"fail":default:i.fail(C)}}return ml(e,c,t,a,l)};function hl(e){return Ks.indexOf(e.code)>-1||"Authentication::getUser"===e.subContext&&e.message.indexOf("User information is not available")>-1||e.message.indexOf("getUser: MSAL account not found")>-1||e.message.indexOf("Get skype token promise timed out, keep retrying. Is expected:true")>-1}function vl(e){const{isRunningGlassjar:t,mtAuthResourceOverride:n}=e.get(A.J.Test);if(t&&n)return n;const{authOverrides:i}=e.get(A.J.Host),{mtResource:a}=e.get(A.J.Auth);return(null==i?void 0:i.mtResource)||a||Fs.O_.MT}const Sl=(e,t,n,i)=>{var a,o,r,s,l,d,c;if(!e)return void i.log("Failed to obtain telemetry details from discovery.");if(!n)return void i.log("Failed to obtain telemetry provider from getTelemetryProviderInstance.");const u=null===(a=e.licenseDetails)||void 0===a?void 0:a.isFreemium,{environment:m}=t.get(A.J.Metadata),g=m===Fs.s_.life?Es.OV.Life:u?Es.OV.Freemium:Es.OV.Work;if(m===Fs.s_.life&&u&&i.warn("The Environment indicates TFL, but Freemium is true - defaulting telemetry to TFL Tenant.Model"),n.setContext("UserInfo.Region",e.region),n.setContext("Tenant.Model",g),null===(o=e.consumerLicenseDetails)||void 0===o?void 0:o.consumerLicenseDetails){const t=null===(l=null===(s=null===(r=e.consumerLicenseDetails)||void 0===r?void 0:r.consumerLicenseDetails)||void 0===s?void 0:s.licensedProducts)||void 0===l?void 0:l.map((e=>e.skuName)).sort().join(",");n.setContext("UserInfo.IsLicensed",!!(null===(c=null===(d=e.consumerLicenseDetails)||void 0===d?void 0:d.consumerLicenseDetails)||void 0===c?void 0:c.hasTeamsLicense)),n.setContext("UserInfo.Licenses",t)}};class fl{constructor(e,t,n){this.aad=e,this.discover=t,this.coreSettings=n,this.cmdMTAuthResource=e=>this._cmdMtAuthorize(e),this.mtAuthResource=e=>{const{requireSkypetokenForMT:t}=this.coreSettings.get(A.J.Auth);return this._mtAuthorize(e,t||!1)},this.skypeAuthResource=e=>this.skype.authorizeRequest(e),this.skypeAuthorizeAuthResource=e=>this.skype.authorizeRequest(e,"Authorization"),this.skypeXTokenAuthResource=e=>this.skype.authorizeRequest(e,"x-skypetoken"),this.mtAuthWithSkypeXTokenResource=e=>this._mtAuthorize(e,!0),this.authorizeByUrl=e=>{const t=new URL(e.url),n=`${t.protocol}//${t.host}`;return this.aad.authorizeRequest(e,n)},this._cmdMtAuthorize=e=>this.aad.getUser().then((()=>{const{cmdMeetingArtifactsServiceResource:t}=this.coreSettings.get(A.J.CMDMeetingArtifactsService);return(e=>this.aad.authorizeRequest(e,null!=t?t:""))(e)})),this._mtAuthorize=(e,t)=>this.aad.getUser().then((()=>{const n=vl(this.coreSettings),i=e=>this.aad.authorizeRequest(e,n);return(t?this.composeAuthResources(i,this.skypeXTokenAuthResource):i)(e)})),this.skype=new bs.q(this.discover)}composeAuthResources(e,t){return n=>(0,c.mG)(this,void 0,void 0,(function*(){return e(n).then((e=>t(e.request).then((t=>({request:t.request,resolver:(n,i)=>(0,c.mG)(this,void 0,void 0,(function*(){const a=yield t.resolver(n,i);return yield e.resolver(n,a||i)}))})))))}))}}class yl extends xe{constructor(){super(_.Yg.CreateAuthenticationResources,["authenticationService","discover","coreSettings"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){e.authenticationResources=new fl(e.authenticationService,e.discover,e.coreSettings)}))}}var kl=n(59270),Cl=n(90649);class bl{constructor(e,t){var n;this._coreSettings=t,this.skypeIsDown=!1,this._criticalResources=[],this.cleanup=new Te.xQ,this.currentAuthState=new u.X(kl.jq.Up),this.skypeTokenState=new u.X(kl.QI.Unknown),this.resourceTokenStates=new Map,this.logSubscriptions=[],this.stateChangeLogs=[],this.defaultAuthStateChangeTimeout=3e4,this._logger=e.newLogger("AuthStateProvider"),this._logger.log("[AuthState] Initializing auth state to Up.");const{criticalResources:i,authStateChangeTimeout:a}=(null===(n=this._coreSettings)||void 0===n?void 0:n.get(A.J.Auth))||{};this._criticalResources=i||[],this._authStateChangeTimeout=null!=a?a:this.defaultAuthStateChangeTimeout,this.badTokenStates=new Map,this.skypeLogSubscription=this.skypeTokenState.pipe((0,_n.R)(this.cleanup)).pipe((0,Br.x)()).subscribe((e=>{this._logger.log(`[AuthState] Skype token state changed to: ${e}`),this.recordStateChange("SkypeToken",e)})),this.telemetryInterval=globalThis.window.setInterval((()=>{this.publishAuthStateTelemetry()}),ni.rF.ONE_HOUR)}observe(){return this.currentAuthState}getState(){return this.currentAuthState.value}getInteractionRequiredResource(){const e=this.badTokenStates.entries();let t=e.next();for(;!t.done;){if(t.value[1]===kl.QI.InteractionRequired)return t.value[0];t=e.next()}}reportResourceTokenState(e,t){this._criticalResources.includes(e)&&(this.updateTokenStateMap(e,t),t===kl.QI.Success?this.badTokenStates.has(e)&&(this.badTokenStates.clear(),this.skypeIsDown=!1):this.badTokenStates.set(e,t),this.evaluateCurrentState())}observeResourceTokenState(e){if(!this._criticalResources.includes(e))throw new Error("Unsupported resource, contact Auth team if you need your resource added.");let t=this.resourceTokenStates.get(e);return t||(t=this.updateTokenStateMap(e,kl.QI.Unknown)),t.pipe((0,_n.R)(this.cleanup)).pipe((0,Br.x)())}reportSkypeTokenState(e){this.skypeTokenState.next(e);const t=e===kl.QI.Failure;t!==this.skypeIsDown&&(this.skypeIsDown=t,this.evaluateCurrentState())}observeSkypeTokenState(){return this.skypeTokenState.pipe((0,_n.R)(this.cleanup)).pipe((0,Br.x)())}getSkypeTokenState(){return this.skypeTokenState.value}cleanupObservables(){var e;this._logger.log("[AuthState] Cleanup function called."),this.publishAuthStateTelemetry(),null===(e=null===globalThis||void 0===globalThis?void 0:globalThis.window)||void 0===e||e.clearInterval(this.telemetryInterval),this.cleanup.next(!0),this.cleanup.complete(),this.skypeTokenState.complete(),this.resourceTokenStates.forEach((e=>e.complete())),this.resourceTokenStates.clear(),this.skypeLogSubscription.unsubscribe(),this.logSubscriptions.forEach((e=>e.unsubscribe())),this.logSubscriptions=[]}recordStateChange(e,t){t!==kl.QI.Unknown&&this.stateChangeLogs.push(`${Date.now()}|${e}->${t}`)}publishAuthStateTelemetry(){if(this.stateChangeLogs.length<1)return;const e=Cl.cv.create({subContext:"AuthState",correlation:{id:(0,Ps.pW)(),source:"auth-state-provider",scenarioName:ee.RG.AuthPublishState}});e.addEventData(this.stateChangeLogs),e.closeScenario(),this.stateChangeLogs=[]}updateTokenStateMap(e,t){let n=this.resourceTokenStates.get(e);return n?n.next(t):(n=new u.X(t),this.resourceTokenStates.set(e,n),this.logSubscriptions.push(n.pipe((0,_n.R)(this.cleanup)).pipe((0,Br.x)()).subscribe((t=>{this._logger.log(`[AuthState] ${e} token state changed to: ${t}`),this.recordStateChange(e,t)})))),n}evaluateCurrentState(){let e;if(0===this.badTokenStates.size)e=this.skypeIsDown?kl.jq.SkypeReconnecting:kl.jq.Up;else{const t=this.badTokenStates.values();let n=t.next();for(;!n.done;){if(n.value===kl.QI.InteractionRequired){e=kl.jq.InteractionRequired;break}e=kl.jq.AADReconnecting,n=t.next()}}e&&this.changeAuthState(e)}changeAuthState(e){if(e===kl.jq.Up||e===kl.jq.InteractionRequired)this.pendingStateClearTimeout&&(globalThis.window.clearTimeout(this.pendingStateClearTimeout),this.pendingState=void 0,this.pendingStateClearTimeout=void 0),this.changeTo(e);else if(this.pendingState)this.pendingState=e;else{if(e===this.currentAuthState.value)return;this.pendingState=e,this.pendingStateClearTimeout=globalThis.window.setTimeout((()=>{this.pendingState&&this.changeTo(this.pendingState),this.pendingState=void 0,this.pendingStateClearTimeout=void 0}),this._authStateChangeTimeout)}}changeTo(e){e!==this.currentAuthState.value&&(this._logger.warn(`[AuthState] Transition from ${this.currentAuthState.value} to ${e}`),this.recordStateChange("AuthState",e),this.currentAuthState.next(e))}}var Tl=n(31583),wl=n(73800),_l=n(29237);const Il=(e,t)=>e.decode(t).getOrElseL((e=>{throw new TypeError((0,_l.Rn)(e).join("\n"))})),Al=(0,ws.partial)({isNotificationEnabled:ws.boolean,isUnifiedPresenceEnabled:ws.boolean,isOutOfOfficeIntegrationEnabled:ws.boolean,isContactMigrationEnabled:ws.boolean,isAppsDiscoveryEnabled:ws.boolean,isFederationEnabled:ws.boolean}),Nl=(0,ws.partial)({licenseDetails:As}),El=(0,ws.partial)({regionSettings:Al}),Dl=(0,ws.intersection)([(0,ws.type)({region:ws.string,regionGtms:Ns,tokens:(0,ws.type)({skypeToken:ws.string,expiresIn:ws.number})}),El,Nl]),Fl=(0,ws.type)({skuId:ws.string,skuName:ws.string,maxMeetingDurationMinutes:ws.number,maxMeetingParticipants:ws.number}),Pl=(0,ws.intersection)([(0,ws.type)({hasTeamsLicense:ws.boolean}),(0,ws.partial)({teamsFree:(0,ws.type)({maxMeetingDurationMinutes:ws.number,maxMeetingParticipants:ws.number}),licensedProducts:(0,ws.array)(Fl)})]),Ml=(0,ws.partial)({consumerLicenseDetails:Pl}),jl=(0,ws.intersection)([(0,ws.type)({regionGtms:Ns,skypeToken:(0,ws.type)({skypetoken:ws.string,expiresIn:ws.number})}),Ml,Nl]),Rl=(0,ws.type)({skypeTokenData:(0,ws.type)({regionGtms:Ns,token:(0,ws.type)({skypeToken:ws.string,expiration:ws.number,userDetails:(0,ws.partial)({region:ws.string})})})},"token"),xl=(0,ws.type)({skypeid:ws.string}),Ol=1e3,Ll="Discover",Ul="https://api.spaces.skype.com";function Bl(e){return wl.getParser(e.navigator.userAgent).isBrowser("ie",!0)}class Wl{constructor(e,t,n,i,a,o,r,s,l,d,m,g=(0,Q.J)()){var p,h;this.aad=e,this.coreSettings=i,this.scenarioFactory=a,this.isOnline=o,this.shouldNotDecodeTokenForIE=r,this.onDiscoverSuccess=s,this.onDiscoverFail=l,this.isCDLWorker=d,this.cdlAuthClient=m,this.globalScope=g,this._localStorageKeys=[],this.licenseTypeToTenantType=e=>e?Es.OV.Freemium:Es.OV.Work,this._canGetSkypeTokenFromHost=()=>!!this.bootstrapData,this._acquireSkypeTokenWorker=(e=!1)=>(0,c.mG)(this,void 0,void 0,(function*(){var t,n;if(!this.cdlAuthClient)return Promise.reject("CDL worker auth client unavailable");try{const t=yield this.cdlAuthClient.getSkypeToken(e);return Object.assign(Object.assign({},t.userDetails),{skypeToken:t.skypeToken,regionGtms:Il(Ns,t.regionGtms),expires:new Date(t.expiration)})}catch(e){throw(null===(t=e.response)||void 0===t?void 0:t.serverResponse)&&(e.serverResponse=e.response.serverResponse),e.context=null!==(n=e.context)&&void 0!==n?n:Ll,e}})),this._acquireUserDetailsWorker=()=>(0,c.mG)(this,void 0,void 0,(function*(){var e,t,n,i,a,o,r,s,l,d,c,u,m,g;if(!this.cdlAuthClient)return Promise.reject("CDL worker auth client unavailable");const p=yield this.cdlAuthClient.getUserDetails();return{id:p.id,region:p.userDetails.region,tenant:{type:this.licenseTypeToTenantType(null===(e=p.userDetails.licenseDetails)||void 0===e?void 0:e.isFreemium)},isAdvComms:(null===(t=p.userDetails.licenseDetails)||void 0===t?void 0:t.isAdvComms)||!1,isTranscriptEnabled:(null===(n=p.userDetails.licenseDetails)||void 0===n?void 0:n.isTranscriptEnabled)||!1,isFreemium:(null===(i=p.userDetails.licenseDetails)||void 0===i?void 0:i.isFreemium)||!1,isTrial:(null===(a=p.userDetails.licenseDetails)||void 0===a?void 0:a.isTrial)||!1,isWebinarEnabled:(null===(o=p.userDetails.licenseDetails)||void 0===o?void 0:o.isWebinarEnabled)||!1,isBasicLiveEventsEnabled:(null===(r=p.userDetails.licenseDetails)||void 0===r?void 0:r.isBasicLiveEventsEnabled)||!1,eduLicenseSkuAndCategory:(null===(s=p.userDetails.licenseDetails)||void 0===s?void 0:s.eduLicenseSkuAndCategory)||void 0,isTPProtection:(null===(l=p.userDetails.licenseDetails)||void 0===l?void 0:l.isTPProtection)||!1,isTPCustomization:(null===(d=p.userDetails.licenseDetails)||void 0===d?void 0:d.isTPCustomization)||!1,isTPManagement:(null===(c=p.userDetails.licenseDetails)||void 0===c?void 0:c.isTPManagement)||!1,isTPWebinar:(null===(u=p.userDetails.licenseDetails)||void 0===u?void 0:u.isTPWebinar)||!1,isTPVirtualAppointments:(null===(m=p.userDetails.licenseDetails)||void 0===m?void 0:m.isTPVirtualAppointments)||!1,isInfoProtectionPremium:(null===(g=p.userDetails.licenseDetails)||void 0===g?void 0:g.isInfoProtectionPremium)||!1}})),this._acquireSkypeTokenDesktop=()=>this.globalScope.opener.requestMessage(K.rY.GetStateData,{requestType:"skypeToken",timeout:xs.lP.ACQUIRE_TOKEN_TIMEOUT}).then((e=>Il(Rl,e))).then((({skypeTokenData:{regionGtms:e,token:{skypeToken:t,expiration:n,userDetails:i}}})=>Object.assign(Object.assign({},i),{skypeToken:t,regionGtms:e,expires:new Date(n)}))),this._acquireSkypeTokenWeb=()=>{const e=Date.now(),{authOverrides:t}=this.coreSettings.get(A.J.Host),{authzEndpointUrl:n,authzUrl:i,regionGtmsEnv:a}=this.coreSettings.get(A.J.Auth),o=(null==t?void 0:t.authzEndpointUrl)||n||i||"https://authsvc.teams.microsoft.com/v1.0/authz";return this.aad.getUser().then((t=>{const n=this.getResponseFromLocalStorage(t.profile.oid,t.profile.tid);if(n)return n;let i={method:"POST",url:a?`${o}?region_gtms_env=${a}`:`${o}`,serviceName:os.EJ.Auth,apiName:"acquireSkypeTokenWeb"};if(t.role===Pr.w4.Anonymous&&(i=Object.assign(Object.assign({},i),{url:`${o}/visitor`,body:`{"tenantId": "${t.profile.tid}"}`})),Bl(this.globalScope)&&this.shouldNotDecodeTokenForIE)return this.send().then((t=>t(i).then((({body:e})=>e.json())).then((t=>Object.assign(Object.assign({},t),{tokens:Object.assign(Object.assign({},t.tokens),{expires:new Date(e+t.tokens.expiresIn*Ol)})})))));{const n=this.send().then((e=>e(i).then((({body:e})=>e.json())))),a=t.type===Pr.Ch.MsaLife;return this.parseAuthzResponse(n,a,e)}}))},this.logger=t.newLogger("Discover"),this.send=()=>function(e,t,n){return t.getUser().then((()=>{const{authzResource:i}=n.get(A.J.Auth);return t.authorize(e,i||Ul)}))}(n,e,this.coreSettings).then((e=>(0,Tl.B)(e,Ts.qb.OK))),this._skypeToken=new u.X(null),this.bootstrapData=this.coreSettings.get(A.J.Host).authBootstrapData,this.telemetryProvider=(0,Jn.G)(),null===(h=null===(p=e.observeMiddleTierToken)||void 0===p?void 0:p.call(e))||void 0===h||h.subscribe((e=>{void 0===e&&(this._discoveryResponse=void 0)}))}observeSkypeToken(){return this._skypeToken.pipe((0,S.h)((e=>null!==e)))}shouldThrowErrorIfSkypeTokenIsEmpty(){return!this.coreSettings.get(A.J.Auth).disableThrowingErrorIfSkypeTokenIsEmpty}getSettingToDisableSkypeTokenValidation(e,t){return ll(e,t,this.coreSettings,this.logger,this.scenarioFactory)}regionGtm(e){return Bl(this.globalScope)&&this.shouldNotDecodeTokenForIE?this.getDiscovery().then((t=>{let n=t.regionGtms[e];if(n)return n===Qs||n.endsWith("/")||(n+="/"),n;throw(0,he.Tr)(Ll,_.jK.InvalidResponse,"regionGtm")})):this.getDiscovery().catch((e=>{var t;if(this._canGetSkypeTokenFromHost()){return{regionGtms:Il(Ns,null===(t=this.bootstrapData)||void 0===t?void 0:t.regionGtms)}}throw e})).then((({regionGtms:{[e]:t}})=>{if(void 0===t)throw(0,he.Tr)(Ll,_.jK.InvalidResponse,"regionGtm",{},`Discover::regionGtm::${_.jK.InvalidResponse} - ${e} is missing in discover response`);return t===Qs?t:t.href}))}skypeid(){return(0,c.mG)(this,void 0,void 0,(function*(){const e=yield this.getUser();return new Promise((t=>t(e.id)))}))}getRegion(){return this.getDiscovery().then((({region:e})=>e)).catch((e=>{var t;if(this._canGetSkypeTokenFromHost()){const e=null===(t=this.bootstrapData)||void 0===t?void 0:t.region;if(!e)throw(0,he.Tr)(Ll,_.jK.InvalidResponse,"getRegion");return e}throw e}))}getUser(){var e,t,n;let i;if(this._canGetSkypeTokenFromHost()){const i=null===(e=this.bootstrapData)||void 0===e?void 0:e.userId,a=null===(t=this.bootstrapData)||void 0===t?void 0:t.region,o=null===(n=this.bootstrapData)||void 0===n?void 0:n.licenseDetails;if(i)return this.logger.log(`skypeid and region received from host: ${i} ${a}`),Promise.resolve({id:i,region:a||void 0,tenant:{type:this.licenseTypeToTenantType(null==o?void 0:o.isFreemium)},isAdvComms:(null==o?void 0:o.isAdvComms)||!1,isTranscriptEnabled:(null==o?void 0:o.isTranscriptEnabled)||!1,isFreemium:(null==o?void 0:o.isFreemium)||!1,isTrial:(null==o?void 0:o.isTrial)||!1,isWebinarEnabled:(null==o?void 0:o.isWebinarEnabled)||!1,eduLicenseSkuAndCategory:(null==o?void 0:o.eduLicenseSkuAndCategory)||void 0,isBasicLiveEventsEnabled:(null==o?void 0:o.isBasicLiveEventsEnabled)||!1,isTPProtection:(null==o?void 0:o.isTPProtection)||!1,isTPCustomization:(null==o?void 0:o.isTPCustomization)||!1,isTPManagement:(null==o?void 0:o.isTPManagement)||!1,isTPWebinar:(null==o?void 0:o.isTPWebinar)||!1,isTPVirtualAppointments:(null==o?void 0:o.isTPVirtualAppointments)||!1,isInfoProtectionPremium:(null==o?void 0:o.isInfoProtectionPremium)||!1});this.logger.warn("skypeid or region was not received from host when expected")}return this.isCDLWorker?this._acquireUserDetailsWorker():this.getSkypeTokenInfoFromDiscoveryResponse().then((e=>{var t,n,a,o,r,s,l,d,c,u,m,g,p,h;return i={id:e.userDetails.id,region:e.userDetails.region,tenant:{type:this.licenseTypeToTenantType(null===(t=e.userDetails.licenseDetails)||void 0===t?void 0:t.isFreemium)},isAdvComms:null===(n=e.userDetails.licenseDetails)||void 0===n?void 0:n.isAdvComms,isTranscriptEnabled:null===(a=e.userDetails.licenseDetails)||void 0===a?void 0:a.isTranscriptEnabled,isFreemium:(null===(o=e.userDetails.licenseDetails)||void 0===o?void 0:o.isFreemium)||!1,isTrial:(null===(r=e.userDetails.licenseDetails)||void 0===r?void 0:r.isTrial)||!1,isWebinarEnabled:(null===(s=e.userDetails.licenseDetails)||void 0===s?void 0:s.isWebinarEnabled)||!1,isBasicLiveEventsEnabled:(null===(l=e.userDetails.licenseDetails)||void 0===l?void 0:l.isBasicLiveEventsEnabled)||!1,eduLicenseSkuAndCategory:(null===(d=e.userDetails.licenseDetails)||void 0===d?void 0:d.eduLicenseSkuAndCategory)||void 0,isTPProtection:(null===(c=e.userDetails.licenseDetails)||void 0===c?void 0:c.isTPProtection)||!1,isTPCustomization:(null===(u=e.userDetails.licenseDetails)||void 0===u?void 0:u.isTPCustomization)||!1,isTPManagement:(null===(m=e.userDetails.licenseDetails)||void 0===m?void 0:m.isTPManagement)||!1,isTPWebinar:(null===(g=e.userDetails.licenseDetails)||void 0===g?void 0:g.isTPWebinar)||!1,isTPVirtualAppointments:(null===(p=e.userDetails.licenseDetails)||void 0===p?void 0:p.isTPVirtualAppointments)||!1,isInfoProtectionPremium:(null===(h=e.userDetails.licenseDetails)||void 0===h?void 0:h.isInfoProtectionPremium)||!1},i}))}validateSkypeToken(e){return(0,c.mG)(this,void 0,void 0,(function*(){return(yield this.validateSkypeTokenV2(e)).skypeToken}))}validateSkypeTokenV2(e){const t=this.getDiscovery(),n=null==e?void 0:e.forceRenew,i=null==e?void 0:e.invalidSkypeToken;return t.then((({expires:e,skypeToken:t})=>!n&&t!==i&&e.getTime()>Date.now()?{skypeToken:t,fromCache:!0}:(this.resetDiscoveryResponse(),this.getDiscovery(n).then((({skypeToken:e})=>({skypeToken:e,fromCache:!1}))))))}getSkypeTokenInfoFromDiscoveryResponse(){return(0,c.mG)(this,void 0,void 0,(function*(){return this.getDiscovery().then((e=>{const{skypeid:t}=(0,Ds.as)(xl,(0,Os.J)(e.skypeToken)),n=`8:${t}`;this.logger.log(`skypeid received from discovery: ${n}. Region: ${e.region}`);const i={id:n,region:e.region,licenseDetails:Object.assign(Object.assign({},e.licenseDetails),{consumerLicenseDetails:null==e?void 0:e.consumerLicenseDetails}),regionSettings:e.regionSettings};return{regionGtms:e.regionGtms,skypeToken:e.skypeToken,expiration:e.expires.getTime(),userDetails:i}})).catch((e=>{throw this.logger.error(`failed to get skypeid from discovery: ${(0,R.u4)(e)}`),e}))}))}getConsumerLicenseDetails(){return(0,c.mG)(this,void 0,void 0,(function*(){return this.getSkypeTokenInfoFromDiscoveryResponse().then((e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.userDetails)||void 0===t?void 0:t.licenseDetails)||void 0===n?void 0:n.consumerLicenseDetails}))}))}parseAuthzResponse(e,t,n){return t?e.then((e=>Il(jl,e))).then((({regionGtms:e,licenseDetails:t,skypeToken:{skypetoken:i,expiresIn:a},consumerLicenseDetails:o})=>({regionGtms:e,skypeToken:i,expires:new Date(n+a*Ol),licenseDetails:t,consumerLicenseDetails:o?{consumerLicenseDetails:o,timeStamp:new Date}:void 0}))):e.then((e=>Il(Dl,e))).then((({region:e,licenseDetails:t,regionGtms:i,tokens:{skypeToken:a,expiresIn:o},regionSettings:r})=>({region:e,regionGtms:i,skypeToken:a,expires:new Date(n+o*Ol),licenseDetails:t,regionSettings:r})))}getDiscovery(e=!1){if(!this._discoveryResponse){const t=this.scenarioFactory.newScenario(ee.RG.GetSkypeToken),n=this._canGetSkypeTokenFromHost()?this._acquireSkypeTokenDesktop:this.isCDLWorker?this._acquireSkypeTokenWorker:this._acquireSkypeTokenWeb,i=this.getDiscoveryResponse(n,t,0,e);return this.setDiscoveryResponse(i)}return this._discoveryResponse}getDiscoveryResponse(e,t,n=0,i=!1){var a,o;return(0,c.mG)(this,void 0,void 0,(function*(){try{const n=yield e(i);return t.stop(),this.onDiscoverSuccess&&this.onDiscoverSuccess(),Sl(n,this.coreSettings,this.telemetryProvider,this.logger),n}catch(r){let s=r;(null===(a=s.serverResponse)||void 0===a?void 0:a.body)&&(null===(o=s.serverResponse)||void 0===o?void 0:o.body.json)&&(s.serverResponse.body=yield s.serverResponse.body.json().catch((e=>{r.message+=`::${e.message}`})));const{disableResponseParsing:l}=this.coreSettings.get(A.J.Auth);if(s=((e,t,n)=>{var i,a;let o;if(!n){const{response:t}=e;o=null==t?void 0:t.isExpected}let r=e;r.context||(r=(0,he.Jn)(e,_.w5.Discover,_.jK.InvalidResponse,"",{error:e.stack},e.message||("string"==typeof e?e:(0,R.u4)(e))));const{serverResponse:{status:s,body:l,headers:d={}}={},context:c}=r;let{reason:u,message:m,code:g=_.jK.InvalidResponse,subContext:p=""}=r;return u=d?Object.assign(Object.assign({},u),{responseCorrelationId:d["correlation-id"],innerError:r}):u,m=(null===(i=l)||void 0===i?void 0:i.message)||m,p=(null===(a=l)||void 0===a?void 0:a.errorCode)||c,g=t?Zs(s):_.jK.NetworkOffline,(0,he.Tr)(_.w5.Discover,g,p,Object.assign(Object.assign({},u),{innerError:e}),m,r.serverResponse,o)})(r,this.isOnline(),!!l),this.canRetry(n,s))return null==t||t.mark("retry_skype_token_step",{message:s.message,reason:(0,R.u4)(s)}),this.getDiscoveryResponse(e,t,++n,this.coreSettings.get(A.J.Auth).useForceRenewInSkypeTokenRetry?i:void 0);throw this.onDiscoverFail&&this.onDiscoverFail(this._canGetSkypeTokenFromHost()),this.resetDiscoveryResponse(),((e,t,n)=>{var i;if(!e)throw t;const a=Object.assign(Object.assign({},t),{errorCode:t.code,reason:(0,R.u4)(t.reason)});return hl(t)||!n&&(null===(i=t)||void 0===i?void 0:i.isExpected)?e.cancel(a):e.fail(a),t.reason&&(t.reason.isExpectedError=hl(t)),t})(t,s,!!l)}}))}resetDiscoveryResponse(){this._discoveryResponse=void 0,this.clearFromLocalStorage()}canRetry(e,t){return e<1&&t.code!==_.jK.NetworkOffline&&t.code!==_.jK.Forbidden&&t.code!==_.jK.ProxyAuthenticationRequired}setDiscoveryResponse(e){return e=e.then((e=>(this._skypeToken.next(e.skypeToken),e))),this._discoveryResponse=e}getResponseFromLocalStorage(e,t){let n=this.getFromLocalStorage(e,t,"auth.gtm.table");const i=this.getFromLocalStorage(e,t,"auth.skype.token");return n&&i?(Bl(this.globalScope)&&this.shouldNotDecodeTokenForIE||(n=Il(Ns,n)),Object.assign(Object.assign({},i.userDetails),{skypeToken:i.skypeToken,expires:new Date(i.expiration),regionGtms:n})):null}getFromLocalStorage(e,t,n){var i;if(!(null===(i=this.globalScope)||void 0===i?void 0:i.localStorage))return;let a=`ts.${t}-${e}.${n}`,o=this.globalScope.localStorage.getItem(a);if(o||(a=`ts.${e}.${n}`,o=this.globalScope.localStorage.getItem(a)),o){this._localStorageKeys.push(a);try{return JSON.parse(o)}catch(e){this.logger.error(e)}}}clearFromLocalStorage(){var e;(null===(e=this.globalScope)||void 0===e?void 0:e.localStorage)&&(this._localStorageKeys.forEach((e=>{this.globalScope.localStorage.removeItem(e)})),this._localStorageKeys=[])}}var Gl=n(62174),Vl=n(91902);const Hl="Login Rate limit exceeded",$l={AdminUserLicenseNotPresentForbidden:"AdminUserLicenseNotPresentForbidden",AdminTeamsDisabledForTenantForbidden:"AdminTeamsDisabledForTenantForbidden",UserLicenseNotPresentForbidde:"UserLicenseNotPresentForbidde",TeamsDisabledForTenantForbidden:"TeamsDisabledForTenantForbidden",UserLicenseNotPresentTrialEligible:"UserLicenseNotPresentTrialEligible",TrialLicenseTenantNotReady:"TrialLicenseTenantNotReady",NewFederatedUsersNotAllowed:"NewFederatedUsersNotAllowed"},zl=(e,t)=>(t<0||Date.now()-t>=xs.gT.MILLISECONDS_PER_HOUR)&&((0,he.o7)(e)||[Ts.qb.THROTTLED,Ts.qb.NOT_AUTHORIZED,-1].indexOf(e)>-1),ql=(e,t,n,i,a)=>(0,c.mG)(void 0,void 0,void 0,(function*(){var o;const r=nl(i),{serverResponse:{status:s,body:l}={}}=e;null==r||r.appendEventData({statusCode:s}),(0,he.o7)(null!=s?s:0)?null==r||r.fail({message:(0,Ps.VK)(e),errorCode:_.jK.ServiceUnavailable,statusCode:s}):-1!==s?((null===(o=l.message)||void 0===o?void 0:o.indexOf(Hl))>-1&&(null==r||r.incomplete({message:(0,Ps.VK)(e),errorCode:Hl,statusCode:s}),a.error(`DiscoverRetryPolicy: Delaying skype token fetch for ${Ws.DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD}' .`),(0,Gl._)(Ws.DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD)),yield Jl(e,t,n,i,a)):null==r||r.incomplete({message:(0,Ps.VK)(e),errorCode:_.jK.TimedOut,statusCode:s})})),Jl=(e,t,n,i,a)=>(0,c.mG)(void 0,void 0,void 0,(function*(){var o,r;const s=nl(i),{serverResponse:{status:l,body:d,headers:c}={}}=e;let u;try{const e=yield d.json();u=null===(o=null==e?void 0:e.error)||void 0===o?void 0:o.code}catch(e){a.error(`Body jsonify failed: ${e}`)}switch(a.error(`Getting errorCode: [${u}] from response`),l){case Ts.qb.NOT_AUTHORIZED:yield Kl(c,n,a,null===(r=t.options)||void 0===r?void 0:r.userIdentifier),null==s||s.incomplete({message:(0,Ps.VK)(e),errorCode:null!=u?u:_.jK.Unauthorized,statusCode:l});break;case Ts.qb.FORBIDDEN:((e,t)=>e===Ts.qb.FORBIDDEN&&!!t&&t in $l)(l,u)&&Ql(u,t,i),null==s||s.cancel({message:(0,Ps.VK)(e),errorCode:null!=u?u:_.jK.Forbidden,statusCode:l});break;case Ts.qb.THROTTLED:default:null==s||s.incomplete({message:(0,Ps.VK)(e),errorCode:null!=u?u:_.jK.Throttled,statusCode:l})}})),Ql=(e,t,n)=>{const i=nl(n);if(e===$l.NewFederatedUsersNotAllowed)return t.headerUpdate||(t.headerUpdate={strongConsistencyValue:(a=Bs.strongConsistencyMsInternalUserSignup,Bs.strongConsistencyDefaultValue.replace("{id}",a))}),void(null==i||i.mark($l.NewFederatedUsersNotAllowed));var a;e===$l.UserLicenseNotPresentTrialEligible?(null==i||i.mark($l.UserLicenseNotPresentTrialEligible),t.lastLicenseErrorTime=-1):t.lastLicenseErrorTime=Date.now()},Kl=(e,t,n,i)=>(0,c.mG)(void 0,void 0,void 0,(function*(){var a;e&&0!==(null===(a=Object.keys(e))||void 0===a?void 0:a.length)?yield t(e,i):n.error("DiscoverUnauthorizeError: header is empty")}));const Yl=(e,t,n,i)=>(0,c.mG)(void 0,void 0,void 0,(function*(){return Xl(e,t,Zl)({policy:n,delay:n.createDelay(),retryCount:0,retriesTable:{},startTime:Date.now().valueOf(),forever:n.foreverCheck,headerUpdate:void 0,lastLicenseErrorTime:-1,options:{userIdentifier:null!=i?i:void 0}})})),Xl=(e,t,n)=>i=>(0,c.mG)(void 0,void 0,void 0,(function*(){for(var a;;){const o=t;(null===(a=i.headerUpdate)||void 0===a?void 0:a.strongConsistencyValue)&&(o.headers||(o.headers={}),o.headers.ConsistencyLevel=i.headerUpdate.strongConsistencyValue);try{return yield e(o)}catch(e){yield n(e,i)}}})),Zl=(e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){if(!e.serverResponse)throw e;const n=!(yield t.forever()),{serverResponse:{status:i}}=e;if(-1!==t.startTime&&Date.now().valueOf()-t.startTime>=t.policy.retryMaxTimeMs&&(t.startTime=-1,t.policy.retryMaxTimeCallback(n)),i&&t.policy.isOnline()&&(t.retryCount++<t.policy.maxRetryCount&&!n||n)&&t.policy.shouldRetry(i,t.lastLicenseErrorTime))return t.retriesTable[i]=(t.retriesTable[i]||0)+1,t.policy.errorHandler(e,t);throw e}));var ed=n(63660),td=n(89251),nd=n(5216);class id{constructor(e,t,n,i,a,o,r,s,l,d,m,g,p=(0,Q.J)()){var h,v,S,f,y;this._authenticationService=e,this._coreSettings=i,this._scenarioFactory=a,this._networkStateProvider=o,this._i18n=r,this._authStateProvider=s,this.onDiscoverSuccess=l,this.onDiscoverFail=d,this.isCDLWorker=m,this.cdlAuthClient=g,this.globalScope=p,this._skypeToken=new u.X(null),this._localStorageKeys=[],this.clearDiscoveryCacheForLogout=e=>(0,c.mG)(this,void 0,void 0,(function*(){const t=(0,Ms.Xx)(e);this.clearDiscoveryCache(t,["^fn:clearDiscoveryCacheForLogout"])})),this.clearDiscoveryCache=(e,t,n)=>{this._skypeToken=new u.X(null),Rs.Jt.del(ol(e)),null==t||t.push("skypeCacheClear"),n||(Rs.Jt.del(rl(e)),null==t||t.push("userDetailsCacheClear"),Rs.Jt.del(al(e)),null==t||t.push("regionGtmsCacheClear")),this._clearFromLocalStorage(n),null==t||t.push("localstorageCacheClear"),this._logger.log(`[clearDiscoveryCache] Discover cache cleared, tokenOnly: ${!!n}.`)},this._getDiscoverResponse=e=>(0,c.mG)(this,void 0,void 0,(function*(){var t,n,i,a;const{correlationId:o=(0,Ps.pW)(),eventData:r=[]}=e;null==r||r.push("_getDiscoverResponse|startScenario");const s=this._scenarioFactory.newScenario(ee.RG.GetSkypeToken);let l;try{if(!this._isAppOnline())throw(0,js.Tr)(Object.assign(Object.assign({},Ys),{correlationId:o}));if((null===(t=this._authStateProvider)||void 0===t?void 0:t.getState())===kl.jq.InteractionRequired)throw(0,js.Tr)(Object.assign(Object.assign({},Xs),{correlationId:o}));l=yield this._discoverProvider(Object.assign(Object.assign({},e),{eventData:r})),Sl(l,this._coreSettings,this._telemetryProvider,this._logger)}catch(e){throw e.errorCode!==ni.SM.InteractionRequired?(null===(n=this._authStateProvider)||void 0===n||n.reportSkypeTokenState(kl.QI.Failure),null==r||r.push("authState:0")):null===(i=this._authStateProvider)||void 0===i||i.reportSkypeTokenState(kl.QI.InteractionRequired),this.onDiscoverFail&&this.onDiscoverFail(!!this._bootstrapData),pl(e,r,this._isAppOnline(),s,this._logger,this._coreSettings)}null===(a=this._authStateProvider)||void 0===a||a.reportSkypeTokenState(kl.QI.Success);const d=sl(l,this._logger);((e,t,n,i,a)=>{Rs.Jt.put(rl(e),t.userDetails),null==n||n.push("userDetails:1"),Rs.Jt.put(ol(e),t),null==n||n.push("skypeToken:1"),(null==t?void 0:t.regionGtms)?(Rs.Jt.put(al(e),null==t?void 0:t.regionGtms),null==n||n.push("regionGtms:1")):(null==n||n.push("regionGtms:-1"),a.error(`[_getDiscoverResponse][${i}] RegionGtm is missing in response, not able to cache.`))})(e.userIdentifier,d,r,o,this._logger);const c=yield il(this._authenticationService,this._logger,r);return(0,Ms.FG)(null==e?void 0:e.userIdentifier,c)||!(null==e?void 0:e.userIdentifier)?this._skypeToken.next(l.skypeToken):this._logger.error(`[_getDiscoverResponse][${o}] option uid:${null==e?void 0:e.userIdentifier}`),null==s||s.stop({reason:r.join(";")}),this.onDiscoverSuccess&&this.onDiscoverSuccess(),l})),this._isSkypeTokenValidInMemory=e=>(0,c.mG)(this,void 0,void 0,(function*(){const t=null!=e?e:yield il(this._authenticationService,this._logger,[]);return!!Rs.Jt.getValue(ol(t))})),this._retryMaxTimeCallback=e=>{var t;return e?(null===(t=this._authStateProvider)||void 0===t||t.reportSkypeTokenState(kl.QI.Failure),this._logger.error("[_retryMaxTimeCallback]Reporting skype token failure to authState"),!1):(this._logger.warn("[_retryMaxTimeCallback] Reached retry max time."),!1)},this._getResponseFromLocalStorage=(e,t)=>{if(!t||!e)return;const n=this._getFromLocalStorage(e,t,"auth.gtm.table"),i=this._getFromLocalStorage(e,t,"auth.skype.token");return n&&i?Object.assign(Object.assign({},i.userDetails),{skypeToken:i.skypeToken,expires:new Date(i.expiration),regionGtms:n}):void 0},this._getCachedResponseWrapper=e=>(0,c.mG)(this,void 0,void 0,(function*(){var t,n;return this._getResponseFromLocalStorage(null===(t=null==e?void 0:e.profile)||void 0===t?void 0:t.oid,null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.tid)})),this._acquireSkypeTokenWeb=e=>(0,c.mG)(this,void 0,void 0,(function*(){var t,n,i,a;null===(t=e.eventData)||void 0===t||t.push("fn:_acquireSkypeTokenWeb");let o=yield this._authenticationService.getUser({accountId:e.userIdentifier.id,userIdentifier:e.userIdentifier,correlation:{id:e.correlationId,source:"discoverV2::_acquireSkypeTokenWeb",scenarioName:ee.RG.AuthWebUser}});if(null===(n=e.eventData)||void 0===n||n.push("user:"+ +!!o,"uid:"+ +!!e.userIdentifier),!o){if(o=yield this._authenticationService.getUser({correlation:{id:e.correlationId,source:"discoverV2::_acquireSkypeTokenWeb",scenarioName:ee.RG.AuthWebUser}}),!o)throw(0,js.Tr)({context:Ls,subContext:"_acquireSkypeTokenWeb",errorCode:ni.SM.UserNotFoundError,message:"User not found for provided userIdentifier nor globally.",correlationId:e.correlationId,isExpected:!1});((e,t,n)=>{var i;if(!(0,Ms.FG)(e.userIdentifier,(0,Ms.Xx)(t)))throw null===(i=e.eventData)||void 0===i||i.push("userMismatch"),n.warn("[_acquireSkypeTokenWeb] user obtained does not match provided userIdentifier, throw error."),(0,js.Tr)({context:Ls,subContext:"_acquireSkypeTokenWeb",errorCode:ni.SM.UserNotFoundError,message:"User obtained does not match provided userIdentifier.",correlationId:e.correlationId,isExpected:!0})})(e,o,this._logger)}const r=yield this._getCachedResponseWrapper(o);if(r)return null===(i=e.eventData)||void 0===i||i.push("cache:1"),r;const s=Rs.Jt.getValue(rl((0,Ms.Xx)(o))),l=cl(o,e.correlationId,this._coreSettings,this._logger,this._i18n,!!s),d=this._scenarioFactory.findScenario(ee.RG.GetSkypeToken);null==d||d.mark(Hs,gl(e.eventData,this._isAppOnline(),this._coreSettings));const u=yield this.send({userIdentifier:e.userIdentifier,correlationId:e.correlationId})(l);return null===(a=e.eventData)||void 0===a||a.push("response:1"),null==d||d.mark($s,gl(e.eventData,this._isAppOnline(),this._coreSettings)),d&&(d.eventData.authzCorrelationId=u.headers["correlation-id"],d.eventData.correlationTags=u.headers["correlation-tags"],d.eventData.correlationId=null==e?void 0:e.correlationId),((e,t,n)=>(0,c.mG)(void 0,void 0,void 0,(function*(){var i,a;const o=Date.now(),{regionGtms:r,licenseDetails:s,skypeToken:l,tokens:d,region:c,regionSettings:u,skypeGuestUserToken:m,consumerLicenseDetails:g}=yield e.body.json();null===(i=t.eventData)||void 0===i||i.push("parsejson:1");const p=l||d||m,h=null!==(a=null==p?void 0:p.skypeToken)&&void 0!==a?a:null==p?void 0:p.skypetoken;let v;return n.log(`[_acquireSkypeTokenWeb][${null==t?void 0:t.correlationId}] Response parsed succeed.`),g&&(v={timeStamp:new Date(o),consumerLicenseDetails:g}),{userId:tl(h,n),regionGtms:r,licenseDetails:s,skypeToken:h,expires:new Date(o+(null==p?void 0:p.expiresIn)*xs.gT.MILLI_PER_SECOND),region:c,regionSettings:u,consumerLicenseDetails:v}})))(u,e,this._logger)})),this._acquireSkypeTokenDesktop=e=>(0,c.mG)(this,void 0,void 0,(function*(){var t,n,i,a;null===(t=e.eventData)||void 0===t||t.push("fn:_acquireSkypeTokenDesktop");const o=yield this._authenticationService.getUser({accountId:e.userIdentifier.id,userIdentifier:e.userIdentifier,correlation:{id:e.correlationId,source:"discoverV2::_acquireSkypeTokenWeb",scenarioName:ee.RG.AuthWebUser}}),r=yield this._getCachedResponseWrapper(o);if(r)return r;null===(n=e.eventData)||void 0===n||n.push("cache:0");const s=this._scenarioFactory.findScenario(ee.RG.GetSkypeToken);null==s||s.mark(zs);const l=yield this.globalScope.opener.requestMessage(K.rY.GetStateData,{requestType:"skypeToken",timeout:xs.lP.ACQUIRE_TOKEN_TIMEOUT});null==s||s.mark($s);const d=null==l?void 0:l.skypeTokenData;s&&(s.eventData.correlationId=null==l?void 0:l.correlationId);return{userId:tl(null===(i=null==d?void 0:d.token)||void 0===i?void 0:i.skypeToken,this._logger),userDetails:null==d?void 0:d.userDetails,skypeToken:null===(a=null==d?void 0:d.token)||void 0===a?void 0:a.skypeToken,regionGtms:null==d?void 0:d.regionGtms,expires:new Date(null==d?void 0:d.token.expiration)}})),this._acquireSkypeTokenWorker=e=>(0,c.mG)(this,void 0,void 0,(function*(){const{eventData:t}=e;if(t.push("fn:_acquireSkypeTokenWorker"),!this.cdlAuthClient)throw(0,js.Tr)({context:Ls,subContext:"_acquireSkypeTokenWorker",errorCode:_.jK.NotPresent,message:"CDL worker auth client unavailable",correlationId:e.correlationId,isExpected:!1});const n=!1!==e.forceRenew,i=this._scenarioFactory.findScenario(ee.RG.GetSkypeToken);null==i||i.mark(qs);const a=yield this.cdlAuthClient.getSkypeToken(n);return null==i||i.mark(Js),Object.assign(Object.assign({userId:tl(a.skypeToken,this._logger)},a.userDetails),{skypeToken:a.skypeToken,regionGtms:a.regionGtms,expires:new Date(a.expiration)})})),this._getRetryForSend=e=>{const{authzResource:t,disableRetryInDiscoverV2:n}=this._coreSettings.get(A.J.Auth);return i=>{var a;if(!this._authenticationService.authorizeV2)throw(0,js.Tr)({context:Ls,subContext:"_getRetryForSend",errorCode:"AuthorizeV2NotFound",message:"AuthorizeV2 endpoint not accessible",correlationId:null!==(a=i.correlationId)&&void 0!==a?a:(0,Ps.pW)(),isExpected:!1});const o=this._authenticationService.authorizeV2.bind(this._authenticationService),r=()=>(0,Tl.B)(o(e,t||xs.ej.MT_AAD_KEY,{userIdentifier:i.userIdentifier}),Ts.qb.OK);return n?r():function(e,t,n){return i=>Yl(e,i,t,n)}(r(),((e,t,n,i,a,o)=>({shouldRetry:zl,errorHandler:(i,a)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const o=nl(t),{serverResponse:{status:r,headers:s}={}}=i;if(!r||!a.retriesTable[r])throw i.reason=Object.assign(Object.assign({},i.reason),{scenarioStep:"fail"}),i.message=`dicoverRetryPolicy: retry count for ${r} is empty`,i;const l=null==s?void 0:s["correlation-id"],d=null==s?void 0:s["correlation-tags"];null==o||o.appendEventData({authzCorrelationId:l,correlationTags:d}),a.headerUpdate=void 0,yield ql(i,a,n,t,e),e.error(`[DiscoverRetryPolicy]: retrying '[${a.retryCount}]' times due to response status - '[${r}], wait for '[${a.delay.next()}] for next retry..'`);const c=yield a.forever();if(a.retryCount>=a.policy.maxRetryCount&&c)throw e.log(`[DiscoverRetryPolicy]: maxTimeReached count: ${a.retryCount} and tokenValid, cancel forever`),i.reason=["LoggedAlready"],i;return(0,Gl._)(a.delay.next())})),retryMaxTimeMs:xs.lP.DEFAULT_SKYPE_MAX_RETRY_DURATION_MS,maxRetryCount:xs.lP.DEFAULT_SKYPE_MAX_RETRY_COUNT,createDelay:()=>new Vl.df(xs.lP.DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS,xs.lP.DEFAULT_SKYPE_EXP_DELAY_FACTOR,xs.lP.DEFAULT_SKYPE_MAX_DELAY_TIME_MS),isOnline:i,retryMaxTimeCallback:a,foreverCheck:o}))(this._logger,this._scenarioFactory,this.unauthorizedErrorHandler,this._isAppOnline,this._retryMaxTimeCallback,this._isSkypeTokenValidInMemory),i.userIdentifier)}},this._isRefreshInBackgroundRequired=(e,t,n,i)=>{(null==e?void 0:e.shouldRefresh)&&(null==n||n.push("shouldrefreshbg"),this._debouncedGetDiscoverResponse((0,R.u4)(t),{userIdentifier:t,correlationId:i,eventData:n}).catch((e=>{ml(e,null==e?void 0:e.message,n,this._logger)})))},this._populateDiscoverResponseFromBootstrapdata=()=>{this._bootstrapData=this._coreSettings.get(A.J.Host).authBootstrapData,this._bootstrapData},this._isAppOnline=()=>this._networkStateProvider.getState()===Xr.G.Online,this.unauthorizedErrorHandler=(e,t)=>(0,c.mG)(this,void 0,void 0,(function*(){((e,t,n,i,a)=>{(0,c.mG)(void 0,void 0,void 0,(function*(){const{disableClaimsChallenge:o}=i.get(A.J.Auth);if(o)a.log("[unauthorizedErrorHandler] Claims challenge handling disabled.");else if(e)if(t)Rs.Jt.deleteType(t,"Token");else{const e=yield n.getUser();Rs.Jt.deleteType((0,Ms.Xx)(e),"Token")}else a.log("[unauthorizedErrorHandler] No header passed in.")}))})(e,t,this._authenticationService,this._coreSettings,this._logger)})),this._logger=t.newLogger(Ls),(0,ed.g)(this,"DiscoverV2",this._getConfig("mockApi"),this._getConfig("enableMockApi")),this.send=this._getRetryForSend(n),this._debouncedGetDiscoverResponse=(0,td.k)(this._getDiscoverResponse),(0,Rs.ky)(p),this._populateDiscoverResponseFromBootstrapdata(),this._discoverProvider=this.resolveProvider(),null===(v=null===(h=this._authenticationService)||void 0===h?void 0:h.registerCleanUpOnLogoutCallback)||void 0===v||v.call(h,this.clearDiscoveryCacheForLogout),this._tokenObserver=null===(y=null===(f=(S=this._authenticationService).observeMiddleTierToken)||void 0===f?void 0:f.call(S))||void 0===y?void 0:y.subscribe((e=>{void 0===e&&il(this._authenticationService,this._logger,[]).then((e=>{e&&Rs.Jt.del(ol(e))}))})),this._telemetryProvider=(0,Jn.G)(),this._logger.log("[ctor]Service initialized.")}observeSkypeToken(){return this._skypeToken.pipe((0,S.h)((e=>null!==e)),(0,Br.x)())}shouldThrowErrorIfSkypeTokenIsEmpty(){return!this._coreSettings.get(A.J.Auth).disableThrowingErrorIfSkypeTokenIsEmpty}getSettingToDisableSkypeTokenValidation(e,t){return ll(e,t,this._coreSettings,this._logger,this._scenarioFactory)}regionGtm(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){const n=(0,Ps.pW)(),i=["^fn:regionGtm:uid:"+ +!!t];try{const a=null!=t?t:yield il(this._authenticationService,this._logger,i);let o=Rs.Jt.getValue(al(a));if(!o){this._logger.log(`[regionGtm][${n}] No cached regionGtm, start network call..`),null==i||i.push("cache:0");const e=yield this._debouncedGetDiscoverResponse((0,R.u4)(a),{userIdentifier:a,correlationId:n,eventData:i});o=null==e?void 0:e.regionGtms,null==i||i.push(`InResponse:${!!o}`)}const r=null==o?void 0:o[e];if(r)return r===Qs?r:(0,Mo.m)(r);throw(0,js.Tr)({correlationId:n,message:`${Ls}[regionGtm][${n}] ${e} not found in regionGtms table`,isExpected:!0,context:Ls,subContext:"regionGtm",errorCode:"RegionGtmNotFoundInRespone"})}catch(e){throw ul(e,"regionGtm",n),ml(e,null==e?void 0:e.message,i,this._logger)}}))}skypeid(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=(0,Ps.pW)(),n=["^fn:skypeid:uid:"+ +!!e];try{const n=yield this.getUser(t,e);if(!n){const e=`[skypeid][${t}] No userDetail for getting skypeId`;throw this._logger.error(e),new Error(`${Ls} No user for getting skypeId`)}return n.id}catch(e){throw ul(e,"skypeid",t),ml(e,null==e?void 0:e.message,n,this._logger)}}))}validateSkypeToken(e){return(0,c.mG)(this,void 0,void 0,(function*(){return(yield this.validateSkypeTokenV2(e)).skypeToken}))}validateSkypeTokenV2(e){var t,n;return(0,c.mG)(this,void 0,void 0,(function*(){const i=(0,Ps.pW)(),a=["^fn:validateSkypeToken:uid:"+ +!!(null==e?void 0:e.userIdentifier)];try{const o=null!==(t=null==e?void 0:e.userIdentifier)&&void 0!==t?t:yield il(this._authenticationService,this._logger,a),r=Rs.Jt.get(ol(o)),s=null==r?void 0:r.item;if(a.push(`cache:${!!s}`),(null==o?void 0:o.accountType)===Pr.Ch.Anonymous&&(null==s?void 0:s.skypeToken)&&!this._coreSettings.get(A.J.Auth).disableIgnoringForceRenewForAnon)return{skypeToken:s.skypeToken,fromCache:!0};const l=null==e?void 0:e.forceRenew,d=null==e?void 0:e.invalidSkypeToken;if(!l&&s&&s.skypeToken!==d&&s.expiration&&s.expiration>Date.now())return this._isRefreshInBackgroundRequired(r,o,a,i),this._skypeToken.value||this._skypeToken.next(s.skypeToken),null===(n=this._authStateProvider)||void 0===n||n.reportSkypeTokenState(kl.QI.Success),{skypeToken:s.skypeToken,fromCache:!0};this.clearDiscoveryCache(o,a,!0),this._logger.log(`[validateSkypeToken][${i}] Skype token not valid during ping of forceRenew:${l}, clear old cache and start wire request.`);const c=yield this._debouncedGetDiscoverResponse((0,R.u4)(o),{userIdentifier:o,correlationId:i,eventData:a});return this._logger.log(`[validateSkypeToken][${i}] SkypeToken fetched from network.`),a.push(`InResponse:${!!c.skypeToken}`),{skypeToken:c.skypeToken,fromCache:!1}}catch(e){throw ul(e,"validateSkypeToken",i),ml(e,null==e?void 0:e.message,a,this._logger)}}))}getRegion(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=(0,Ps.pW)(),n=["^fn:getRegion:uid:"+ +!!e];try{const i=null!=e?e:yield il(this._authenticationService,this._logger,n),a=Rs.Jt.getValue(rl(i));if(a)return a.region;n.push("cache:0"),this._logger.log(`[getRegion][${t}] No user details found in cache. Getting it from request.`);const o=yield this._debouncedGetDiscoverResponse((0,R.u4)(i),{userIdentifier:i,correlationId:t,eventData:n});return n.push(`InResponse:${!!o.region}`),o.region}catch(e){throw ul(e,"getRegion",t),ml(e,null==e?void 0:e.message,n,this._logger)}}))}getUser(e=(0,Ps.pW)(),t){var n,i;return(0,c.mG)(this,void 0,void 0,(function*(){const a=["^fn:getUser:uid:"+ +!!t];try{const o=null!=t?t:yield il(this._authenticationService,this._logger,a);let r=Rs.Jt.getValue(rl(o));if(r||(this._logger.log(`[getUser][${e}]No cache, start network call...`),a.push("cache:0"),a.push(`IsCDL:${this.isCDLWorker&&this.cdlAuthClient}`),r=this.isCDLWorker&&this.cdlAuthClient?null===(n=yield this.cdlAuthClient.getUserDetails())||void 0===n?void 0:n.userDetails:((e,t,n)=>{if(e.push("fn:_getUserDetailFromHost"),!t)return void e.push("_bootstrapData:0");const{userId:i,region:a,licenseDetails:o}=t;return i&&a&&o?{id:i,licenseDetails:o,region:a}:(n.log(`[_getUserDetailFromHost] userId:${!!i}|region:${!!a}|licenseDetails:${!!o}`),void e.push(`userId:${!!i}|region:${!!a}|licenseDetails:${!!o}`))})(a,this._bootstrapData,this._logger)||(null===(i=yield this.getSkypeTokenInfoFromDiscoveryResponse({silent:!1,correlationId:e,userIdentifier:t,eventData:a}))||void 0===i?void 0:i.userDetails)),!r)throw new Error(`${Ls}[getUser][${e}] UserDetails fetched failure from network request`);return(e=>{var t,n,i,a,o,r,s,l,d,c,u,m,g,p;return{id:e.id,region:e.region,tenant:{type:(null===(t=e.licenseDetails)||void 0===t?void 0:t.isFreemium)?Es.OV.Freemium:Es.OV.Work},isAdvComms:(null===(n=e.licenseDetails)||void 0===n?void 0:n.isAdvComms)||!1,isTranscriptEnabled:(null===(i=e.licenseDetails)||void 0===i?void 0:i.isTranscriptEnabled)||!1,isFreemium:(null===(a=e.licenseDetails)||void 0===a?void 0:a.isFreemium)||!1,isTrial:(null===(o=e.licenseDetails)||void 0===o?void 0:o.isTrial)||!1,isWebinarEnabled:(null===(r=e.licenseDetails)||void 0===r?void 0:r.isWebinarEnabled)||!1,eduLicenseSkuAndCategory:(null===(s=e.licenseDetails)||void 0===s?void 0:s.eduLicenseSkuAndCategory)||void 0,isBasicLiveEventsEnabled:(null===(l=e.licenseDetails)||void 0===l?void 0:l.isBasicLiveEventsEnabled)||!1,isTPProtection:(null===(d=e.licenseDetails)||void 0===d?void 0:d.isTPProtection)||!1,isTPCustomization:(null===(c=e.licenseDetails)||void 0===c?void 0:c.isTPCustomization)||!1,isTPManagement:(null===(u=e.licenseDetails)||void 0===u?void 0:u.isTPManagement)||!1,isTPWebinar:(null===(m=e.licenseDetails)||void 0===m?void 0:m.isTPWebinar)||!1,isTPVirtualAppointments:(null===(g=e.licenseDetails)||void 0===g?void 0:g.isTPVirtualAppointments)||!1,isInfoProtectionPremium:(null===(p=e.licenseDetails)||void 0===p?void 0:p.isInfoProtectionPremium)||!1}})(r)}catch(t){ul(t,"getUser",e);const n=ml(t,null==t?void 0:t.message,a,this._logger);throw new nd.l(n)}}))}getSkypeTokenInfoFromDiscoveryResponse(e){var t,n,i;return(0,c.mG)(this,void 0,void 0,(function*(){const{correlationId:a=(0,Ps.pW)(),userIdentifier:o}=e||{},r=null!==(t=null==e?void 0:e.eventData)&&void 0!==t?t:[];null==r||r.push("fn:getSkypeTokenInfoFromDiscoveryResponse");try{const t=null!=o?o:yield il(this._authenticationService,this._logger,r),s=null==e?void 0:e.forceRenew,l=Rs.Jt.get(ol(t));if((null==t?void 0:t.accountType)===Pr.Ch.Anonymous&&(null===(n=null==l?void 0:l.item)||void 0===n?void 0:n.skypeToken)&&!this._coreSettings.get(A.J.Auth).disableIgnoringForceRenewForAnon)return l.item;let d;if(l&&l.item&&!s)this._isRefreshInBackgroundRequired(l,t,r,a),d=l.item;else{null==r||r.push("cache:0"),this._logger.log(`[getSkypeTokenInfoFromDiscoveryResponse][${a}] No response retrieved from cache.`),this.clearDiscoveryCache(t,r,!0);const n=yield this._debouncedGetDiscoverResponse((0,R.u4)(t),Object.assign(Object.assign({},e),{userIdentifier:t,eventData:r}));d=sl(n,this._logger)}return null===(i=this._authStateProvider)||void 0===i||i.reportSkypeTokenState(kl.QI.Success),d}catch(e){throw ul(e,"getSkypeTokenInfoFromDiscoveryResponse",a),ml(e,null==e?void 0:e.message,r,this._logger)}}))}unsubscribeMtToken(){var e;null===(e=this._tokenObserver)||void 0===e||e.unsubscribe()}getConsumerLicenseDetails(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const n=(0,Ps.pW)(),i=["^fn:getConsumerLicenseDetails:uid:"+ +!!e];try{const a=null!=e?e:yield il(this._authenticationService,this._logger,i);if(!(a.accountType===Pr.Ch.MsaLife))return this._logger.log(`[getConsumerLicenseDetails][${n}] User account type is not MsaLife.`),Promise.resolve(void 0);const o=Rs.Jt.getValue(rl(a)),r=null===(t=null==o?void 0:o.licenseDetails)||void 0===t?void 0:t.consumerLicenseDetails;if(r)return r;i.push("cache:0"),this._logger.log(`[getConsumerLicenseDetails][${n}] No user license details found in cache. Getting it from request.`);const s=yield this._debouncedGetDiscoverResponse((0,R.u4)(a),{userIdentifier:a,correlationId:n,eventData:i});return i.push(`InResponse:${!!(null==s?void 0:s.consumerLicenseDetails)}`),null==s?void 0:s.consumerLicenseDetails}catch(e){throw ul(e,"getConsumerLicenseDetails",n),ml(e,null==e?void 0:e.message,i,this._logger)}}))}_clearFromLocalStorage(e){var t;(null===(t=this.globalScope)||void 0===t?void 0:t.localStorage)&&(e?this._localStorageKeys.forEach((e=>{e.indexOf("auth.skype.token")>-1&&this.globalScope.localStorage.removeItem(e)})):this._localStorageKeys.forEach((e=>{this.globalScope.localStorage.removeItem(e)})),this._localStorageKeys=[])}resolveProvider(){return this._bootstrapData?this._acquireSkypeTokenDesktop:this.isCDLWorker?this._acquireSkypeTokenWorker:this._acquireSkypeTokenWeb}_getFromLocalStorage(e,t,n){var i;if(!(null===(i=this.globalScope)||void 0===i?void 0:i.localStorage))return;let a=`ts.${t}-${e}.${n}`,o=this.globalScope.localStorage.getItem(a);if(o||(a=`ts.${e}.${n}`,o=this.globalScope.localStorage.getItem(a)),o){this._localStorageKeys.push(a);try{return JSON.parse(o)}catch(e){this._logger.error(`[_getFromLocalStorage] ${e}`)}}}_getConfig(e){return this._coreSettings.get(A.J.Auth)[e]}}const ad=(e,t,n,i,a,o,r,s,l,d,c,u,m,g,p)=>{const{enableRequireDiscoverV2:h}=i.get(A.J.Auth);return h?new id(e,t,n,i,a,r,s,l,c,u,m,g,p):new Wl(e,t,n,i,a,o,d,c,u,m,g,p)};var od=n(33498);class rd extends xe{constructor(){super(_.Yg.CreateAuthMTMA,["appStateService","loggerFactory","scenarioFactory","networkState","coreSettings","authenticationService","authenticationUser","telemetryService","i18n"])}execute(e){var t,n;return(0,c.mG)(this,void 0,void 0,(function*(){const{appStateService:i,loggerFactory:a,scenarioFactory:o,networkState:r,coreSettings:s,authenticationService:l,authenticationUser:d,telemetryService:c,i18n:u}=e,{enableUserAuthT2:m}=s.get(A.J.Auth)||{};if(!m)return;const g=sd(d);try{if(!d)throw new Error("No AuthenticationUserContext found during User Auth init.");if(!l.createUserAuth)throw new Error("No User Auth Creation API exposed.");const n=new bl(a,s);e.authStateProvider=n,g.addEventData(["authState:created"]);const m=null===(t=l.createUserAuth)||void 0===t?void 0:t.call(l,d,"create-auth-mtma-task",n);e.authenticationService=m,g.addEventData(["userAuth:created"]);const p=(0,od.Gg)(i);let h;s.get(A.J.Telemetry).useTelemetryServicesCache&&(h=c.getTelemetryServicesCache().get(d.id),g.setUserToTelemetryContext({id:d.id,oid:d.profile.objectId,tid:d.profile.tenantId,type:d.type,role:d.role}));const v=ad(m,a,ys.l,s,(null==h?void 0:h.coreScenarioFactory)||o,p,r,u,n,void 0,void 0,void 0,void 0,void 0);return e.discover=v,g.addEventData(["discover:created"]),v.validateSkypeToken(),s.get(A.J.Telemetry).useTelemetryServicesCache&&v.getRegion().then((e=>g.setUserDetailsToTelemetryContext({region:e||""}))),g.closeScenario(),e=>{switch(e){case"quit":case"restart":break;case"signout":default:null==n||n.cleanupObservables()}}}catch(e){const t=e instanceof nd.l?e:new nd.l(e);throw g.closeScenario({error:null!==(n=t.prevError)&&void 0!==n?n:e}),t}}))}}const sd=e=>{const t={id:(0,Ps.pW)(),scenarioName:ee.RG.AuthUserInit,source:"create-auth-mtma-task::execute"};return Cl.cv.create({correlation:t,subContext:"createAuthMTMATask",timeoutMs:ni.rF.ONE_HOUR,scenarioEventData:{context:`id:${!!(null==e?void 0:e.id)}`,accountId:null==e?void 0:e.id}})};class ld extends xe{constructor(){super(_.Yg.CreateAuthStateTask,["loggerFactory","coreSettings","telemetryService"]),this._updateTelemetryOnClientStateChange=(e,t)=>{e.observe().subscribe((e=>{t.setCoreContext("AppInfo.AuthState",e)}))}}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{loggerFactory:t,coreSettings:n,telemetryService:i}=e,{enableAuthState:a,enableUserAuthT2:o}=n.get(A.J.Auth);if(!a||o)return;const r=new bl(t,n);e.authStateProvider=r,this._updateTelemetryOnClientStateChange(r,i)}))}}var dd=n(62990),cd=n(43978);const ud=(e,t,n)=>{var i;const{environment:a}=null!==(i=n.get(A.J.Metadata))&&void 0!==i?i:{},{clientType:o,currentUrl:r,hostingParent:s,isInIframe:l,isInCypressFrame:d,browser:c,browserVersion:u,osPlatform:m,osVersion:g}=t.config;return Object.assign(Object.assign({},e),{clientType:o,currentUrl:r,hostingParent:s,isInIframe:l,isInCypressFrame:d,browser:c,browserVersion:u,osPlatform:m,osVersion:g,environment:a})},md=e=>(0,c.mG)(void 0,void 0,void 0,(function*(){e.initializeAuthenticationService&&(yield e.initializeAuthenticationService())})),gd=(e,t,n,i)=>{const a={id:(0,Ps.pW)(),scenarioName:ee.RG.AuthStart,source:"core-auth-tasks::init"};return Rs.Jt.put(dd.Jl.authSessionId,a.id),Cl.cv.create({correlation:a,subContext:"createAuthenticationServiceInstance",timeoutMs:ni.rF.ONE_HOUR,scenarioEventData:{context:`env:${e}||host:${t}||v2:${+!!n}||global:${+!!i}`}})};class pd extends xe{constructor(){super(_.Yg.CreateAuth,[])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){e.authenticationService=yield(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){var t,i,a;const{loggerFactory:o,scenarioFactory:r,config:s,appStateService:l,coreSettings:d,windowProvider:c,platformService:u,authStateProvider:m,hostCommunicationService:g,telemetryService:p,i18n:h}=e;(0,Rs.ky)(c),(0,Cl.Tu)(r,p);const v=ud(s,u,d),S=(0,od.Gg)(l),{enableAuthV2:f,enableUserAuthT2:y}=(null==d?void 0:d.get(A.J.Auth))||{},k=gd(null!==(t=v.environment)&&void 0!==t?t:"",null===(i=null==c?void 0:c.location)||void 0===i?void 0:i.hostname,!!f,!!y);let C;try{C=f?y?new((yield(0,cd.mT)((()=>Promise.all([n.e(5593),n.e(3913),n.e(8983)]).then(n.bind(n,8332))),"global-auth",r)).GlobalAuthService)(o,r,v,c,g,h,d):new((yield(0,cd.mT)((()=>Promise.all([n.e(5593),n.e(3913),n.e(6106)]).then(n.bind(n,38752))),"auth_v2",r)).AuthenticationService)(o,r,v,c,g,h,m,d):new((yield(0,cd.mT)((()=>Promise.all([n.e(5177),n.e(5593),n.e(9818)]).then(n.bind(n,79176))),"auth",r)).AuthenticationService)(o,r,S,v,c,p,d,g),yield md(C),k.closeScenario()}catch(e){const t=e instanceof nd.l?e:new nd.l(e);throw k.closeScenario({error:null!==(a=t.prevError)&&void 0!==a?a:e}),t}return C})))(e)}))}}const hd=e=>{const t={id:(0,Ps.pW)(),scenarioName:ee.RG.AuthWebSetUpTenants,source:"create-auth-tenants-task::execute"};return Cl.cv.create({correlation:t,subContext:"createAuthTenantsTask",timeoutMs:ni.rF.ONE_HOUR,scenarioEventData:{accountId:null==e?void 0:e.id}})};class vd extends xe{constructor(){super(_.Yg.CreateAuthTenants,[])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=e;yield(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){var t;const{coreSettings:n,authenticationUser:i,endpointsManager:a,authenticationService:o}=e,{enableUserAuthT2:r,enableMultiTenants:s}=n.get(A.J.Auth)||{},{testAutomation:l}=n.get(A.J.Test)||{};if(!r||!s)return;const d=hd(i);try{if(!i)throw new Error("No AuthenticationUserContext found during OnUserAuthenticated_MTMA hook");if(!o.setUpTenantsService||!o.getTenants)throw new Error("No TenantsService Set Up found duringGetTenants Task");const e={accountId:i.id,correlation:d.correlation,forceRefresh:!l};try{yield o.setUpTenantsService(a,e)}catch(e){return d.closeScenario({error:e}),Promise.resolve()}return d.addEventData(["tenantService:created"]),o.getTenants(e).then((e=>{d.appendScenarioEventData({tenantCount:null==e?void 0:e.length}),d.closeScenario()})).catch((e=>{d.closeScenario({error:e})})),Promise.resolve()}catch(e){const n=e instanceof nd.l?e:new nd.l(e);throw d.closeScenario({error:null!==(t=n.prevError)&&void 0!==t?t:e}),n}})))(t)}))}}class Sd extends xe{constructor(){super(_.Yg.CreateCacheClearing,["clientState","windowProvider"]),this._clearCacheOnClientStateChangeToInactive=(e,t)=>{e.observe().subscribe((e=>(0,c.mG)(this,void 0,void 0,(function*(){var n;e===Ve.pk.Inactive&&(yield null===(n=this.dataEvictionService)||void 0===n?void 0:n.evict(),t.clearCache())}))))}}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{clientState:t,windowProvider:n,dataEvictionService:i}=e;this.dataEvictionService=i,this._clearCacheOnClientStateChangeToInactive(t,n)}))}}class fd{constructor(e,t,n,i){this._caches=e,this._tenantId=t,this._userId=n,this._experienceName=i}setUserAndTenantIds(e,t){this._tenantId=e,this._userId=t}createRequest(e,t,n,i,a=!1,o=this._experienceName){const r=this._getFormatKey(t,o,n,a);return{cacheName:e,request:new Request(r,i)}}add({cacheName:e,request:t}){return(0,c.mG)(this,void 0,void 0,(function*(){return(yield this._caches.open(e)).add(t)}))}addAll(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{cacheName:t}=e[0],n=e.map((({request:e})=>e));return(yield this._caches.open(t)).addAll(n)}))}delete({request:e,cacheName:t},n){return(0,c.mG)(this,void 0,void 0,(function*(){return(yield this._caches.open(t)).delete(e,n)}))}keys(e,t,n){return(0,c.mG)(this,void 0,void 0,(function*(){return(yield this._caches.open(e)).keys(t,n)}))}match({request:e,cacheName:t},n){return(0,c.mG)(this,void 0,void 0,(function*(){return(yield this._caches.open(t)).match(e,n)}))}matchAll({request:e,cacheName:t},n){return(0,c.mG)(this,void 0,void 0,(function*(){return(yield this._caches.open(t)).matchAll(e,n)}))}put({request:e,cacheName:t},n){return(0,c.mG)(this,void 0,void 0,(function*(){return(yield this._caches.open(t)).put(e,n)}))}clear(e){return(0,c.mG)(this,void 0,void 0,(function*(){return this._caches.delete(e)}))}_getFormatKey(e,t,n,i){try{return new URL(e),e}catch(a){let o="";switch(n){case or.f.Experience:o=`${t}/${e}`;break;case or.f.User:if(!this._tenantId||!this._userId)throw new Error("tenantId and userId must be defined for storage scope User.");o=`${this._tenantId}/${this._userId}/${e}`;break;case or.f.Global:o=e;break;case or.f.UserAndExperience:if(!this._tenantId||!this._userId)throw new Error("tenantId and userId must be defined for storage scope UserAndExperience.");o=`${this._tenantId}/${this._userId}/${this._experienceName}/${e}`;break;default:return`/${e}`}return i?`//${o}`:o}}}class yd{constructor(e,t){this._cacheStorage=e,this._cacheName="offline-cache-manager",this._logger=t.newLogger("OfflineCacheManager")}setUserAndTenantIds(e,t){this._cacheStorage.setUserAndTenantIds(e,t)}save(e,t,n,i=!0){return(0,c.mG)(this,void 0,void 0,(function*(){if(!e)throw this._error("get","Invalid key");try{this._logger.log(`saving item to offline cache: ${e}`);const a=this._getScopedRequest(e,n,i);return yield this._cacheStorage.put(a,t),a.request.url}catch(e){throw e instanceof DOMException&&this._logger.error(`DOMException name:${e.name}, message${e.message}`),this._error("save","Failed to save object to cache")}}))}saveDynamic(e,t,n=!0){return(0,c.mG)(this,void 0,void 0,(function*(){const i=(0,Je.v4)();return[i,yield this.save(i,e,t,n)]}))}get(e,t,n,i=!0){return(0,c.mG)(this,void 0,void 0,(function*(){if(!e)throw this._error("get","Invalid key");try{const n=this._getScopedRequest(e,t,i),a=yield this._cacheStorage.match(n);if(!a)throw this._error("get","Object not found");return a}catch(e){throw e instanceof DOMException&&this._logger.error(`DOMException name:${e.name}, message${e.message}`),this._error("get","Failed to get item from cache")}}))}getAll(e,t,n){return(0,c.mG)(this,void 0,void 0,(function*(){try{return yield this._cacheStorage.keys(this._cacheName,e?this._getScopedRequest(e,t).request:void 0,n)}catch(e){throw e instanceof DOMException&&this._logger.error(`DOMException name:${e.name} code:${e.code}`),this._error("getAll","Failed to get keys from cache")}}))}delete(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){if(!e)throw this._error("get","Invalid key");this._logger.log(`deleting item from offline cache: ${e}`);const n=this._getScopedRequest(e,t);return this._cacheStorage.delete(n)}))}clear(){return(0,c.mG)(this,void 0,void 0,(function*(){return this._logger.log("clearing offline cache"),this._cacheStorage.clear(this._cacheName)}))}getCachedUrlByKey(e,t){return this._getScopedRequest(e,t).request.url}_error(e,t){const n=(0,he.Tr)("OfflineCacheManager",_.jK.Undefined,e,void 0,t);return this._logger.error(n.message),n}_getScopedRequest(e,t,n=!0){return this._cacheStorage.createRequest(this._cacheName,`${this._cacheName}/${e}`,or.f.UserAndExperience,t,n)}}class kd extends xe{constructor(){super(_.Yg.CreateCacheStorageAndCacheManagers,[])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{authenticationUser:t,windowProvider:n,config:i,loggerFactory:a}=e;t&&(e.cacheStorage=new fd(n.caches,t.profile.tenantId,t.profile.objectId,i.experienceName)),e.cacheStorage&&(e.offlineCacheManager=new yd(e.cacheStorage,a))}))}}class Cd{constructor(e){this.logger=e}log(e,t){return e?this.safeWrapILoggerCall((e=>this.logger.log(e)),e,t):re.None}warn(e,t){return e?this.safeWrapILoggerCall((e=>this.logger.warn(e)),e,t):re.None}debug(e,t){return this.safeWrapILoggerCall((e=>this.logger.debug(e)),e,t)}error(e,t,n){return e&&n?this.safeWrapILoggerCall((e=>this.logger.error(e)),e,t,n):re.None}errorToTelemetry(e,t,n,i){return this.logger.errorToTelemetry?this.logger.errorToTelemetry(e,t,n,i):this.logger.error(e)}warnToTelemetry(e,t,n,i){return this.logger.warnToTelemetry?this.logger.warnToTelemetry(e,t,n,i):this.logger.warn(e)}debugToTelemetry(e,t,n,i){return this.logger.debugToTelemetry?this.logger.debugToTelemetry(e,t,n,i):this.logger.debug(e)}infoToTelemetry(e,t,n,i){return this.logger.infoToTelemetry?this.logger.infoToTelemetry(e,t,n,i):this.logger.log(e)}safeWrapILoggerCall(e,t,n,i){return function(e){return(0,Z.isObject)(e)&&"hostRendererId"in e&&"component"in e}(n)?e(this.serializeMessageFromParams(t,n,i)):e(t)}serializeMessageFromParams(e,t,n){const i=Object.assign(Object.assign(Object.assign(Object.assign({},n?{errorCode:n}:{}),t?{requestId:t.requestId,component:t.component,requestRendererId:t.requestRendererId,requestWindowId:t.requestWindowId,operationType:t.operationType,operationName:t.operationName,requestType:t.requestType,timeOfRequest:t.timeOfRequest,correlationId:t.correlationId,callerInfo:t.callerInfo,callerScenarioId:t.callerScenarioId}:{}),{message:e}),t);return JSON.stringify(i,void 0,"").replace(/\\|"/g,"")}}const bd=(e,t,n,i,a,o,r,s,l,d,c)=>{let u={};return e&&(u={experienceName:e}),t&&(u=Object.assign(Object.assign({},u),{ring:t})),n&&(u=Object.assign(Object.assign({},u),{environment:n})),i&&(u=Object.assign(Object.assign({},u),{sessionId:i})),a&&(u=Object.assign(Object.assign({},u),{platformId:a})),o&&(u=Object.assign(Object.assign({},u),{buildVersion:o})),r&&(u=Object.assign(Object.assign({},u),{localeCode:r})),s&&(u=Object.assign(Object.assign({},u),{workerId:s})),l&&(u=Object.assign(Object.assign({},u),{preAuthUserId:l})),void 0!==c?u=Object.assign(Object.assign({},u),{userConsoleLogLevel:c}):void 0!==d&&(u=Object.assign(Object.assign({},u),{preECSConsoleLogLevel:d})),JSON.stringify(u)};let Td;const wd=(e,t,n,i,a)=>class{constructor(o){const r=i?`${o}#${i}`:o,s=typeof e==typeof Worker?"cdlWorker":"cdlsharedWorker";_d(t,r,!1,s,n),null==a||a(r);const l=((e,t)=>{var n,i;if(Td)return Td;try{return Td=null===(n=window.trustedTypes)||void 0===n?void 0:n.createPolicy("@msteams/core-cdl-worker-common#create-cdl-worker",{createScriptURL:e=>Id(e,t)}),Td}catch(n){null===(i=t.errorToTelemetry)||void 0===i||i.call(t,`Create CDL worker URL trustedType policy failed. This is not a critical error, falling back to function validation. Error ${n}`,"cdl_worker_startup_error_trusted_policy",{endpointUrl:e},!0)}})(r,t);if(l){const t=l.createScriptURL(r);return new e(t)}const d=Id(r,t);return new e(d)}},_d=(e,t,n,i,a)=>{e.log(`{"hostRendererId":${i},"component":${a} Creating CDL Worker with ${n?"passed":"determined"} url ${t} }`)};function Id(e,t){var n;try{const t=new URL(e,Ad().location.origin);let n=!0,i="CDL Web worker URL is invalid.";if(t.origin!==Ad().location.origin&&(i=i.concat("OriginValidationFailed"),n=!1),n)return e;throw new Error(i)}catch(i){throw null===(n=t.errorToTelemetry)||void 0===n||n.call(t,"CDL web worker url is not valid","cdl_worker_startup_error_invalid_url",{endpointUrl:e},!0),(0,he.Tr)(i.message,_.jK.InvalidUrl,"",void 0)}}function Ad(){return window}var Nd=n(83134);class Ed{constructor(e,t){this.logger=e,this.loggingContext=t,this.isCompleted=!1,this.subscriptions=new Set,this.observable$=new Nd((e=>(this.subscriptions.add(e),()=>{this.subscriptions.has(e)&&this.subscriptions.delete(e)})))}get observable(){return this.observable$}subscribe(e){return this.isCompleted&&this.logger.error("Subject - tried to subscribe to a complete observable",this.loggingContext,_.jK.NotPresent),this.observable$.subscribe(e)}onNext(e){this.subscriptions.forEach((t=>{t.next(e)}))}onComplete(){this.isCompleted=!0,this.subscriptions.forEach((e=>{e.closed||e.complete()}))}onError(e){this.isCompleted=!0,this.subscriptions.forEach((t=>{t.error(e)}))}}class Dd{constructor(e){this._state=null,this._checkpoints=new Set,this._context={bootstrapServices:e.bootstrapServices,loggingContext:{hostRendererId:e.loggingContext.hostRendererId,component:"CDLGlobalState"}},this.subject=new Ed(e.bootstrapServices.logger,this._context.loggingContext)}get current(){return this._state}setState(e,t){if(!e)throw new TypeError("state should have name specified");this.hasReachedCheckpoint(e)||(this._context.bootstrapServices.logger.log(`Global state has reached checkpoint ${e}`,this._context.loggingContext),this._checkpoints.add(e),this._state=e,this.subject.onNext({newState:e,args:t}))}subscribe(e){return this.subject.subscribe(e)}hasReachedCheckpoint(e){if(!e)throw new TypeError("state should have name specified");return this._checkpoints.has(e)}}var Fd=n(62975);class Pd{constructor(e,t,n,i){var a;this._context=i,this._clients=new Map,t.forEach(((t,a)=>{const o=new t((t=>e(t)),n,i,a);this._clients.set(a,o)})),null===(a=i.bootstrapServices.workerCacheManager)||void 0===a||a.saveWorkerStatusToCacheStorage({state:"Success",stepName:"ClientResponseRouterCreated"})}get cdlControlClient(){return this._clients.get(Fd.k.control)}get cdlDiagnosticsClient(){return this._clients.get(Fd.k.diagnostics)}get cdlAuthClient(){return this._clients.get(Fd.k.auth)}get cdlAppServiceClient(){return this._clients.get(Fd.k.appService)}get cdlAppStateClient(){return this._clients.get(Fd.k.appState)}get cdlDatabaseClient(){return this._clients.get(Fd.k.database)}get cdlSyncEngineClient(){return this._clients.get(Fd.k.syncEngine)}get cdlGraphQLClient(){return this._clients.get(Fd.k.graphql)}get cdlNetworkStateClient(){return this._clients.get(Fd.k.networkState)}get cdlEndpointsHealthClient(){return this._clients.get(Fd.k.endpointHealth)}get telemetryClient(){return this._clients.get(Fd.k.telemetry)}handleResponse(e){const t=this._clients.get(e.type);if(!t)throw this._context.bootstrapServices.logger.error(`no client is configured for response type ${e.type}`,Object.assign({requestId:e.requestId,requestRendererId:e.rendererId,requestWindowId:e.windowId,component:"CDLClientResponseRouter"},this._context.loggingContext),_.jK.Unknown),new TypeError(`no client is configured for response type ${e.type}`);return t.handleResponse(e)}cleanup(){this._clients.forEach((e=>{Object.keys(e).forEach((t=>e[t]=void 0))})),Object.keys(this).forEach((e=>this[e]=void 0))}}class Md{constructor(e,t,n,i){var a;this._bootstrapServices=e,this._stateAndRequestHandlers=i,this._globalState=n,this._context={component:"CDLServer",hostRendererId:t},this._bootstrapServices.logger.log("Booted up server",this._context),null===(a=this._bootstrapServices.workerCacheManager)||void 0===a||a.saveWorkerStatusToCacheStorage({state:"Success",stepName:"CDLServerCreated"})}handleRequest(e,t,n){const i=performance.now(),a=this._stateAndRequestHandlers.get(e.type);return a?a.stateMachine.isCompleted().then((o=>{const r=performance.now(),s={requestStartTime:i,stateMachineTime:r-i};return this._handleMessage(e,t,a.requestHandler,s,n,o).catch((t=>this._bootstrapServices.logger.error(`Failed to process request due to error ${(0,he.VK)(t)}`,Object.assign(Object.assign({},this._context),{requestId:e.requestId,requestRendererId:e.rendererId,requestWindowId:e.windowId,requestType:e.type}),_.jK.Unknown)))})).catch((n=>this._returnCriticalError(e,t,`State machine init failed for request of type ${e.type} with error ${(0,he.VK)(n)}`,n))):this._returnCriticalError(e,t,`StateMachine and requestHandler not defined for request of type ${e.type}`)}start(){this._globalState.setState("Server_Start")}cleanup(){this._stateAndRequestHandlers.forEach((e=>{Object.keys(e).forEach((t=>e[t]=void 0))})),Object.keys(this).forEach((e=>this[e]=void 0))}_handleMessage(e,t,n,i,a,o){const r=this._decorateResponseCallback(e,t,i);return n.handle(e,r,{bootstrapServices:this._bootstrapServices,loggingContext:{hostRendererId:this._context.hostRendererId,requestId:e.requestId,requestRendererId:e.rendererId,requestWindowId:e.windowId,requestType:e.type},portId:a},o)}_decorateResponseCallback(e,t,n){return i=>{const a=performance.now()-n.requestStartTime,o=a-n.stateMachineTime;if(n=Object.assign(Object.assign({},n),{handlerResponseTime:o}),"graphql"===e.type){const n=i.response;n.extensions=Object.assign({},n.extensions),n.extensions.perfStats=Object.assign(Object.assign({},n.extensions.perfStats),{workerResponseTime:a,dataStorePerfStats:[]}),t(Object.assign({requestId:e.requestId,rendererId:e.rendererId,windowId:e.windowId,type:e.type,extensions:n.extensions},i))}else t(Object.assign(Object.assign(Object.assign({requestId:e.requestId,rendererId:e.rendererId,windowId:e.windowId,type:e.type},i),n),{extensions:{},workerResponseTime:a}))}}_returnCriticalError(e,t,n,i){return Promise.reject(t({windowId:e.windowId,requestId:e.requestId,type:e.type,response:{errors:n,errorCode:(null==i?void 0:i.errorCode)||(null==i?void 0:i.code),error:i},status:"failure",rendererId:e.rendererId,extensions:{},workerResponseTime:-1}))}}function jd(e,t,n,i){var a,o;null===(a=e.workerCacheManager)||void 0===a||a.saveWorkerStatusToCacheStorage({state:"InProgress",stepName:"CDLPeerCreated"});const r=new Pd((e=>t.postMessageCallback(JSON.stringify(e))),t.clients,{rendererId:i},{bootstrapServices:e,loggingContext:{hostRendererId:i}}),s=new Md(e,i,n.globalState,n.requestAndStateHandlers);return null===(o=e.workerCacheManager)||void 0===o||o.saveWorkerStatusToCacheStorage({state:"Success",stepName:"CDLPeerCreated"}),{workerServer:s,workerClientResponseRouter:r,onMessageCallback:(t,n,a)=>{var o,l;const d=Date.now(),c=t.data&&JSON.parse(t.data);if(c&&c.rendererId===i){const e=null===(l=null===(o=c.response)||void 0===o?void 0:o.extensions)||void 0===l?void 0:l.perfStats;e&&(e.payloadLength=t.data.length),r.handleResponse(c)}else c&&c.status?e.logger.error(`Received response with rendererId mismatch ${JSON.stringify(t)}`,{component:"CDLPeer",hostRendererId:i},_.jK.Unknown):c?s.handleRequest(c,(e=>(e=>{var t;const i=Date.now();if("graphql"===e.type){const n=e.response;(null===(t=n.extensions)||void 0===t?void 0:t.perfStats)&&(n.extensions.perfStats.requestReceivedTime=d,n.extensions.perfStats.responseSendTime=i),e.extensions.perfStats&&(e.extensions.perfStats.requestReceivedTime=d,e.extensions.perfStats.responseSendTime=i)}else e.requestReceivedTime=d,e.responseSendTime=i;n(JSON.stringify(e))})(e)),a):e.logger.error(`Unknown message received that doesn't conform to CDL format ${JSON.stringify(t)}`,{component:"CDLPeer",hostRendererId:i},_.jK.Unknown)}}}var Rd=n(85369);class xd{constructor(){this.isSubscriptionRequest=e=>e instanceof Ed,this._rendererRequestMap=new Map}addRequest(e,t){if(!e.rendererId)throw new TypeError("No rendererId in request");if(!e.requestId)throw new TypeError("No requestId in request");const n=this.getRequestRegistrationKey(e);let i=this._rendererRequestMap.get(n);if(i||(i=new Map,this._rendererRequestMap.set(n,i)),i.has(e.requestId))throw new Error(`Request ${e.requestId} for renderer ${n} already exists, something is off here`);if(t&&this.isSubscriptionRequest(t))return i.set(e.requestId,{resolution:t,request:e}),Promise.resolve(void 0);const a=(0,Rd.P)();return i.set(e.requestId,{resolution:a,request:e}),a.promise}reconcileResponse(e){if(!e.rendererId)throw new TypeError("No rendererId in response");if(!e.requestId)throw new TypeError("No requestId in response");const t=this.getRequestRegistrationKey(e);if(!this._rendererRequestMap.has(t))throw new Error(`Response ${t} is not found in map`);const n=this._rendererRequestMap.get(t);if(!n)throw new Error(`Request map for renderer/window ${t} does not exist`);const i=n.get(e.requestId);if(!i)throw new Error(`Request ${e.requestId} for renderer/window ${t} does not exist`);"success"===e.status?this.handleSuccessResponse(e,i):this.handleErrorResponse(e,i),this.isSubscriptionRequest(i.resolution)&&"failure"!==e.status||n.delete(e.requestId),0===n.size&&this._rendererRequestMap.delete(t)}handleSuccessResponse(e,t){this.isSubscriptionRequest(t.resolution)?t.resolution.onNext(e):t.resolution.resolve(e)}handleErrorResponse(e,t){this.isSubscriptionRequest(t.resolution)?t.resolution.onError(e):t.resolution.reject(e)}getRequestRegistrationKey(e){return`${e.rendererId}${e.windowId?`_${e.windowId}`:""}`}}class Od{constructor(e){this.requestType=e,this.counter=0}toString(){return`${this.getOperationPrefix(this.currentCounterRequestType)||this.requestType}-${this.counter}`}next(e){return this.safeIncrementCounter(),this.currentCounterRequestType=e,this.toString()}getOperationPrefix(e){switch(e){case"mutation":return"m";case"subscription":return"s";case"query":return"q";default:return e}}safeIncrementCounter(){return this.counter===Od.MAX_COUNTER_VALUE&&(this.counter=0),this.counter++}}Od.MAX_COUNTER_VALUE=Number.MAX_SAFE_INTEGER;class Ld{constructor(e,{rendererId:t,windowId:n},i,a){this._context=i,this._loggingContext={component:"CDLClient",hostRendererId:t,requestWindowId:n},this._rendererId=t,this._windowId=n,this._clientRequestType=a,this._postMessage=t=>e(t),this._requestRegistrar=new xd,this.requestId=new Od(a)}sendRequest(e,t){const n={rendererId:this._rendererId,windowId:this._windowId,requestId:this.requestId.next(),type:this._clientRequestType,payload:e},i=this._requestRegistrar.addRequest(n,t);return this._postMessage(n),i}handleResponse(e){return new Promise(((t,n)=>{try{this._requestRegistrar.reconcileResponse(e),t()}catch(t){this._context.bootstrapServices.logger.error(`Error occurred on reconciling response ${t}`,Object.assign(Object.assign({},this._loggingContext),{requestId:e.requestId,requestRendererId:e.rendererId,requestWindowId:e.windowId}),_.jK.Unknown),n(t)}}))}}const Ud="MainRenderer",Bd="GQL_STOP";class Wd extends Ld{constructor(e,{rendererId:t,windowId:n},i,a){super(e,{rendererId:t,windowId:n},i,a)}sendFilteredAppStateRequest(e){const t=e.context.appState;return this._rendererId===Ud&&(e.context.appState=this.filterWorkerAppState(t)),super.sendRequest(e)}filterWorkerAppState(e){return e}}class Gd{constructor(){this.onResponseReceived=e=>{if(this.onMessage){const t=this.transformLegacyClientFields(e.payload.dataLayer);this.onMessage(t)}}}transformLegacyClientFields(e){return e.error&&(e.errors=e.error),e.extensions||(e.extensions={}),e.perfStats&&(e.extensions.perfStats=e.perfStats),e}}class Vd extends Gd{constructor(e,{rendererId:t,windowId:n},i,a){super(),this._context=i,this._loggingContext={hostRendererId:t,component:"CDLClient",requestWindowId:n},this.sendMessage=t=>e({requestId:t.requestId,rendererId:t.rendererId,windowId:t.windowId,payload:t.request,operationName:t.operationName,type:a,cdlOperationCustomContext:t.cdlOperationCustomContext})}handleResponse(e){var t;return this._context.bootstrapServices.logger.debug("Received message",Object.assign(Object.assign({},this._loggingContext),{requestId:e.requestId,requestRendererId:e.rendererId,requestWindowId:e.windowId})),Promise.resolve(this.onResponseReceived({payload:{dataLayer:{rendererId:e.rendererId,requestId:e.requestId,windowId:e.windowId,data:e.response.data,errors:e.response.errors?e.response.errors:void 0,errorCode:null===(t=e.response)||void 0===t?void 0:t.errorCode,extensions:e.response.extensions}}}))}}class Hd{constructor(e,t,n,i,a){var o;this.stateMachineName=a,this.completionAwaiter=(0,Rd.P)(),this.bootstrapContext=Object.assign(Object.assign({},i),{loggingContext:Object.assign(Object.assign({},i.loggingContext),{component:"CDLStateMachine"})}),this.actionStateMap=t,this.globalState=e,this.currentState=e.current,null===(o=this.workerStartupTelemetryService)||void 0===o||o.onStart(this.stateMachineName),this.globalState.hasReachedCheckpoint(n)?this.transitionToNextState(n):this.subscribeToGlobalState()}isCompleted(){return this.completionAwaiter.promise}errorStateMachine(e){var t,n;this.unsubscribeStateTransition&&this.unsubscribeStateTransition.unsubscribe(),this.completionAwaiter.reject(e),"coreGraphql"===this.stateMachineName&&(null===(t=this.bootstrapContext.bootstrapServices.workerCacheManager)||void 0===t||t.saveWorkerStatusToCacheStorage({error:JSON.stringify(e),state:"Failure",stepName:`${this.currentState}::Fail`})),e&&e.code===_.jK.Disabled?this.bootstrapContext.bootstrapServices.logger.log(e.message,this.bootstrapContext.loggingContext):this.bootstrapContext.bootstrapServices.logger.error(`State machine is erroring out: ${(0,he.VK)(e)}`,this.bootstrapContext.loggingContext,_.jK.Unknown),null===(n=this.workerStartupTelemetryService)||void 0===n||n.onFail(this.stateMachineName,e)}completeStateMachine(e){var t;this.unsubscribeStateTransition&&this.unsubscribeStateTransition.unsubscribe(),this.completionAwaiter.resolve(e),this.bootstrapContext.bootstrapServices.logger.log("State machine is reaching completion",this.bootstrapContext.loggingContext),null===(t=this.workerStartupTelemetryService)||void 0===t||t.onComplete(this.stateMachineName)}execute(e,t,n){var i;null===(i=this.workerStartupTelemetryService)||void 0===i||i.onStepStart(this.stateMachineName,e);const a=e,o=this.actionStateMap.get(a);if(!o)return this.bootstrapContext.bootstrapServices.logger.log(`State machine is transitioning from ${this.currentState} to ${e}, skipping action invoke as none is defined`,this.bootstrapContext.loggingContext),this.emitState(e,n);this.bootstrapContext.bootstrapServices.logger.log(`State machine is invoking action for transition state ${this.currentState} to ${e}`,this.bootstrapContext.loggingContext),o.action(t,n).then((t=>{var n;this.bootstrapContext.bootstrapServices.logger.log(`State machine is transitioning from ${this.currentState} to ${e}`,this.bootstrapContext.loggingContext),o.eventData&&(null===(n=this.workerStartupTelemetryService)||void 0===n||n.appendEventData(this.stateMachineName,o.eventData)),this.emitState(e,t)})).catch((e=>{this.errorStateMachine(e)}))}transitionToNextState(e,t){this.currentState=e,this.transitionState(e,t)}subscribeToGlobalState(){this.unsubscribeStateTransition=this.globalState.subscribe({next:e=>{const{newState:t,args:n}=e;this.transitionToNextState(t,n)}})}emitState(e,t){this.globalState.hasReachedCheckpoint(e)?this.transitionToNextState(e,t):(this.unsubscribeStateTransition||this.subscribeToGlobalState(),this.globalState.setState(e,t))}get workerStartupTelemetryService(){return this.bootstrapContext.bootstrapServices.workerStartupTelemetryService}}class $d extends Hd{transitionState(e,t){switch(e){case"authLoaded":this.execute("authServiceInjected",t,void 0);break;case"authServiceInjected":this.completeStateMachine(!0)}}}class zd extends Hd{transitionState(e,t){switch(e){case"appService:Loaded":this.execute("appService:Injected",t,void 0);break;case"appService:Injected":this.completeStateMachine(!0)}}}class qd{constructor(e){this._componentName=e,this._handlerMap=new Map}addHandlers(e){e.forEach((e=>{this._handlerMap.set(e.requestType,e.handlerFunc)}))}handle(e,t,n,...i){const a=e.payload;return new Promise(((e,o)=>{const r=this._handlerMap.get(a.requestOperationtype);if(!r){n.bootstrapServices.logger.error(`No handler found for request type ${a.requestOperationtype}`,Object.assign({component:this._componentName},n.loggingContext),_.jK.NotImplemented);const e={response:{statusMsg:`Unknown request type: ${a.requestOperationtype}`,data:void 0},status:"failure"};return t(e),o(e)}r(a,n,...i,t).then((n=>e(qd.callResponseCallback(t,n,"success")))).catch((e=>{const n={response:e,status:"failure"};return t(n),o(n)}))}))}static callResponseCallback(e,t,n){e({response:t,status:n})}static onHandlerError(e,t,n,i,a){e.bootstrapServices.logger.error(n,Object.assign({component:a},e.loggingContext),t);const o={statusMsg:i,data:void 0};return Promise.reject(o)}}var Jd,Qd,Kd,Yd;!function(e){e.AadGetToken="aadGetToken",e.AadGetCurrentUser="aadCurrentUser",e.AadClearCache="aadClearCache",e.StartupApiToken="startupApiToken",e.GetSkypeTokens="getSkypeTokens",e.GetUserDetails="getUserDetails",e.SubscribeToAuthState="subscribeToAuthState"}(Jd||(Jd={}));class Xd{constructor(e){this._requestUtility=new qd("CDLAuthHandler");let t=[];t=e===Ud?[{requestType:Jd.AadGetToken,handlerFunc:Xd.getAadTokensAngular},{requestType:Jd.AadGetCurrentUser,handlerFunc:Xd.getUserInformationAngular},{requestType:Jd.GetSkypeTokens,handlerFunc:Xd.getSkypeTokensAngular},{requestType:Jd.GetUserDetails,handlerFunc:Xd.getUserDetailsAngular},{requestType:Jd.SubscribeToAuthState,handlerFunc:Xd.subscribeToAuthState}]:[{requestType:Jd.AadGetToken,handlerFunc:Xd.getAadTokens},{requestType:Jd.AadGetCurrentUser,handlerFunc:Xd.getUserInformation},{requestType:Jd.GetSkypeTokens,handlerFunc:Xd.getSkypeTokens},{requestType:Jd.GetUserDetails,handlerFunc:Xd.getUserDetails},{requestType:Jd.SubscribeToAuthState,handlerFunc:Xd.subscribeToAuthState}],this._requestUtility.addHandlers(t)}injectDependentServices(e){return new Promise((t=>{if(!e)throw new TypeError("Cannot injectDependentServices of undefined");if("function"==typeof e.getAuthTokens&&(e={authenticationService:e,discover:void 0}),!e.authenticationService)throw new TypeError("Cannot inject authentication service that is not defined");if(this._authenticationService)throw new TypeError("injectDependentServices has been called again, even though it's already initialized");return this._authenticationService=e.authenticationService,this._discover||(this._discover=e.discover),this._authStateProvider||(this._authStateProvider=e.authStateProvider),t()}))}handle(e,t,n){return this._requestUtility.handle(e,t,n,this._authenticationService,this._discover,this._authStateProvider)}static convertAngularPromise(e){return new Promise(((t,n)=>{e.then((e=>t(e))).catch((e=>n(e)))}))}static handleAuthResult(e,t,n){const i=t.bootstrapServices.newScenario(ee.RG.AuthHandlerRequest);return i.appendEventData({operation:n}),e.then((e=>{if(null==e){const e="response payload is empty";throw i.fail({message:e}),new Error(e)}const t={statusMsg:`${n} request in main renderer has been processed`,data:e};return i.stop(),t})).catch((e=>{const a=Xd.getErrorMessage(n,e);qd.onHandlerError(t,_.jK.UnhandledPromiseRejection,"the auth handler has exception",a,"CDLAuthHandler"),e.isExpected?i.incomplete({message:a}):i.fail({message:a});try{"string"==typeof e&&(e=new Error(e)),e.reason||(e.reason={}),e.reason.cdlClient="auth"}catch(n){t.bootstrapServices.logger.warn(`Failed to handle auth error. Original error: ${(0,he.VK)(e)}. Handling error: ${(0,he.VK)(n)}`,Object.assign({component:"CDLAuthHandler"},t.loggingContext))}throw e}))}static getAadTokensAngular(e,t,n){var i;const a=e.context.resource,o=e.context.options;return Xd.logStartHandle(e,t,a),Xd.handleAuthResult(Xd.convertAngularPromise(n.getAuthToken(a,null==o?void 0:o.claim,null==o?void 0:o.silent,null===(i=e.context)||void 0===i?void 0:i.forceRenew)).then((e=>{if(!e)return;return{token:e.token,expires:e.expiration,tokenType:e.tokenType,fromCache:!1}})),t,Jd.AadGetToken)}static getAadTokens(e,t,n){const{resource:i,options:a}=e.context;let o;return Xd.logStartHandle(e,t,i),o=n.acquireTokenV2?n.acquireTokenV2(i,a):n.acquireToken(i,a).then((e=>({token:e}))),Xd.handleAuthResult(o,t,Jd.AadGetToken)}static getUserInformationAngular(e,t,n){return Xd.logStartHandle(e,t),Xd.handleAuthResult(Xd.convertAngularPromise(n.getUserInformation()),t,Jd.AadGetCurrentUser)}static getUserDetailsAngular(e,t,n){return Xd.logStartHandle(e,t),Xd.handleAuthResult(Xd.convertAngularPromise(n.getUserDetails()),t,Jd.GetUserDetails)}static getUserDetails(e,t,n,i){var a;return(0,c.mG)(this,void 0,void 0,(function*(){Xd.logStartHandle(e,t);const n=yield i.getSkypeTokenInfoFromDiscoveryResponse({forceRenew:!!(null===(a=e.context)||void 0===a?void 0:a.forceRenew)}),o=n?{userDetails:n.userDetails,id:n.userDetails.id}:void 0;return Xd.handleAuthResult(Promise.resolve(o),t,Jd.GetUserDetails)}))}static subscribeToAuthState(e,t,n,i,a,o){return(0,c.mG)(this,void 0,void 0,(function*(){if(!a){t.bootstrapServices.logger.log("Auth-Handler - auth state provider not provided. Not subscribing.",Object.assign({component:"CDLAuthHandler"},t.loggingContext));const e=(0,he.Tr)("AuthStateProvider not provided - This will should be an error in the RWC experience",_.jK.MissingParameter,"Auth-Handler");return Promise.reject(e)}const e=a.observe().subscribe((e=>(0,c.mG)(this,void 0,void 0,(function*(){const n=yield Xd.handleAuthResult(Promise.resolve(e),t,Jd.SubscribeToAuthState);qd.callResponseCallback(o,n,"success")}))),(e=>(0,c.mG)(this,void 0,void 0,(function*(){qd.callResponseCallback(o,{statusMsg:Xd.getErrorMessage(Jd.SubscribeToAuthState,e),data:e},"failure")}))),(()=>(0,c.mG)(this,void 0,void 0,(function*(){e.unsubscribe(),qd.callResponseCallback(o,{statusMsg:"AuthStateProvider Completed",data:void 0},"failure")}))));return Xd.handleAuthResult(Promise.resolve(a.getState()),t,Jd.SubscribeToAuthState)}))}static getSkypeTokensAngular(e,t,n){var i;Xd.logStartHandle(e,t);const a=n.getSkypeTokens(!!(null===(i=e.context)||void 0===i?void 0:i.forceRenew)).then((e=>{if(!e)return;return{expiration:e.tokenExpiration||0,skypeToken:e.skypeToken,userDetails:e.userDetails,regionGtms:e.regionGtms}}));return Xd.handleAuthResult(a,t,Jd.GetSkypeTokens)}static getSkypeTokens(e,t,n,i){var a;return Xd.logStartHandle(e,t),Xd.handleAuthResult(i.getSkypeTokenInfoFromDiscoveryResponse({forceRenew:!!(null===(a=e.context)||void 0===a?void 0:a.forceRenew)}),t,Jd.GetSkypeTokens)}static getUserInformation(e,t,n){return Xd.logStartHandle(e,t),Xd.handleAuthResult(n.getUser({correlation:{source:"AuthHandlerRequest",id:"na",scenarioName:"CentralDataLayerBootstrapAuthGetUser"}}),t,Jd.AadGetCurrentUser)}static logStartHandle(e,t,n){const i=n?` for resource ${n}`:"";t.bootstrapServices.logger.log(`Auth handler started serving request ${e.requestOperationtype}${i}`,Object.assign({component:"CDLAuthHandler"},t.loggingContext))}}Xd.getErrorMessage=(e,t)=>`the request type for ${e} failed due to ${(0,he.VK)(t)}`,function(e){e.MachineActive="MachineActive",e.MachineInactive="MachineInactive",e.MachineLongInactive="MachineLongInactive",e.MachineLocked="MachineLocked"}(Qd||(Qd={})),function(e){e.NotifyAppState="NotifyAppState",e.NotifyCoreClientState="NotifyCoreClientState",e.NotifyCoreMachineState="NotifyCoreMachineState",e.NotifyCoreSuspendedState="NotifyCoreSuspendedState",e.NotifyServiceUp="NotifyServiceUp",e.NotifyServiceDown="NotifyServiceDown"}(Kd||(Kd={})),function(e){e[e.ChatSync=0]="ChatSync",e[e.Presence=1]="Presence",e[e.Files=2]="Files",e[e.OneNote=3]="OneNote",e[e.Groups=4]="Groups",e[e.Video=5]="Video",e[e.MasterTab=6]="MasterTab",e[e.IndexDb=7]="IndexDb",e[e.AdalTokens=8]="AdalTokens",e[e.AdalLogin=9]="AdalLogin",e[e.AdalReauth=10]="AdalReauth",e[e.SkypeTokens=11]="SkypeTokens",e[e.SkypeLicense=12]="SkypeLicense",e[e.SupportedBrowser=13]="SupportedBrowser",e[e.MSAGuestLicense=14]="MSAGuestLicense",e[e.AppSession=15]="AppSession",e[e.CSAStartup=16]="CSAStartup"}(Yd||(Yd={}));class Zd{constructor(e){this._requestUtility=new qd("CDLAppServiceHandler");let t=[];t=e===Ud?[{requestType:Kd.NotifyServiceUp,handlerFunc:Zd.notifyServiceUpAngular},{requestType:Kd.NotifyServiceDown,handlerFunc:Zd.notifyServiceDownAngular}]:[{requestType:Kd.NotifyServiceUp,handlerFunc:Zd.notifyServiceUp},{requestType:Kd.NotifyServiceDown,handlerFunc:Zd.notifyServiceDown}],this._requestUtility.addHandlers(t)}injectAppState(e){return new Promise((t=>{if(this.appService)throw new TypeError("injectAppStateService has been called again, even though it's already initialized");return this.appService=e,t()}))}handle(e,t,n){return this._requestUtility.handle(e,t,n,this.appService)}static notifyServiceUp(e,t,n){return new Promise((i=>{t.bootstrapServices.logger.log(`App service change is received, ${e.context.appService} is up and running`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:a,reason:o}=e.context;return n.notifyServiceUp(a,o),i()}))}static notifyServiceUpAngular(e,t,n){return new Promise((i=>{t.bootstrapServices.logger.log(`App service change is received, ${e.context.appService} is up and running. Notifying Angular.`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:a,reason:o}=e.context,r=Yd[a];return n.notifyServiceUp(r,o),i()}))}static notifyServiceDown(e,t,n){return new Promise((i=>{t.bootstrapServices.logger.log(`App service change is received, ${e.context.appService} is down`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:a,reason:o,code:r}=e.context;return n.notifyServiceDown(a,o,r),i()}))}static notifyServiceDownAngular(e,t,n){return new Promise((i=>{t.bootstrapServices.logger.log(`Angular app service change is received, ${e.context.appService} is down. Notifying Angular.`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:a,reason:o,code:r}=e.context,s=Yd[a];return n.notifyServiceDown(s,o,r),i()}))}}class ec{handle(e,t,n){return new Promise((i=>{var a;n.bootstrapServices.logger.log(`Network state received from CDL worker. Network state: ${e.payload.networkState}`,Object.assign({component:"NetworkStateHandler"},n.loggingContext)),null===(a=this.networkStateChangeHandler)||void 0===a||a.next(e.payload.networkState);i(t({response:{statusMsg:"Network state received success.",data:void 0},status:"success"}))}))}injectNetworkStateTracker(e){return new Promise((t=>{if(this.networkStateChangeHandler)throw new TypeError("injectNetworkStateTracker has been called again, even though it's already initialized");return this.networkStateChangeHandler=e,t()}))}}class tc extends Hd{transitionState(e,t){switch(e){case"networkStateService:Loaded":this.execute("networkStateService:Injected",t,void 0);break;case"networkStateService:Injected":this.completeStateMachine(!0)}}}class nc{constructor(){this._componentName="EndpointsHealthMessageHandler"}handle(e,t,n){return new Promise((i=>{var a,o;(!e.payload||void 0===e.payload.healthState&&void 0===e.payload.endpointHealth)&&(this.log("Endpoints health message received from CDL. Payload is empty.",n),i(t(this.getSuccessMessage()))),e.payload.endpointHealth&&(this.log(`Endpoints health message received from CDL. Update: ${JSON.stringify(e.payload.endpointHealth)}.`,n),null===(a=this.endpointsHealthUpdateHandler)||void 0===a||a.handleEndpointHealthUpdate(e.payload.endpointHealth),i(t(this.getSuccessMessage()))),e.payload.healthState&&(this.log("Endpoints state dump message received from CDL.",n),null===(o=this.endpointsHealthUpdateHandler)||void 0===o||o.handleStateDump(e.payload.healthState),i(t(this.getSuccessMessage())))}))}injectEndpointsHealthUpdateHandler(e){return new Promise((t=>{if(this.endpointsHealthUpdateHandler)throw new TypeError("injectEndpointsHealthUpdateHandler has been called again, even though endpointsHealthUpdateHandler is already initialized");return this.endpointsHealthUpdateHandler=e,t()}))}log(e,t){t.bootstrapServices.logger.log(e,Object.assign({component:this._componentName},t.loggingContext))}getSuccessMessage(){return{response:{statusMsg:"Endpoints health received success.",data:void 0},status:"success"}}}class ic extends Hd{transitionState(e,t){switch(e){case"endpointsHealthUpdateHandler:Loaded":this.execute("endpointsHealthUpdateHandler:Injected",t,void 0);break;case"endpointsHealthUpdateHandler:Injected":this.completeStateMachine(!0)}}}function ac(e,t,n){const{authStateMachine:i,authHandler:a}=oc(e,t,n),{appServiceStateMachine:o,appServiceMessageHandler:r}=rc(e,t,n),{networkStateHandlerStateMachine:s,networkStateHandler:l}=sc(e,t,n),{endpointsHealthHandlerStateMachine:d,endpointsHealthHandler:c}=lc(e,t,n);return new Map([[Fd.k.auth,{stateMachine:i,requestHandler:a}],[Fd.k.appService,{stateMachine:o,requestHandler:r}],[Fd.k.networkState,{stateMachine:s,requestHandler:l}],[Fd.k.endpointHealth,{stateMachine:d,requestHandler:c}]])}const oc=(e,t,n)=>{const i=new Xd(t),a={action:i.injectDependentServices.bind(i)},o=new Map;o.set("authServiceInjected",a);return{authHandler:i,authStateMachine:new $d(n,o,"authLoaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:"auth",component:"CreateWorkerStateAndRequestHandlers"}},"auth")}},rc=(e,t,n)=>{const i=new Zd(t),a={action:i.injectAppState.bind(i)},o=new Map;o.set("appService:Injected",a);return{appServiceMessageHandler:i,appServiceStateMachine:new zd(n,o,"appService:Loaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:"appService",component:"CreateWorkerStateAndRequestHandlers"}},"appService")}},sc=(e,t,n)=>{const i=new ec,a={action:i.injectNetworkStateTracker.bind(i)},o=new Map;o.set("networkStateService:Injected",a);return{networkStateHandler:i,networkStateHandlerStateMachine:new tc(n,o,"networkStateService:Loaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:Fd.k.networkState,component:"CreateWorkerStateAndRequestHandlers"}},"networkState")}},lc=(e,t,n)=>{const i=new nc,a={action:i.injectEndpointsHealthUpdateHandler.bind(i)},o=new Map;o.set("endpointsHealthUpdateHandler:Injected",a);return{endpointsHealthHandler:i,endpointsHealthHandlerStateMachine:new ic(n,o,"endpointsHealthUpdateHandler:Loaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:Fd.k.endpointHealth,component:"CreateWorkerStateAndRequestHandlers"}},"endpointsHealth")}};function dc(){return new SharedWorker("/statics/teams-modular-packages/hashed-assets/precompiled-shared-worker-ad02d32b10f96670.js")}function cc(){return new Worker("/statics/teams-modular-packages/hashed-assets/precompiled-web-worker-c1e4e2449613a624.js")}const uc=e=>({loaded:e.hasReachedCheckpoint("loaded")?1:0,healthCheck:e.hasReachedCheckpoint("health_checked")?1:0,syncEngine:e.hasReachedCheckpoint("syncEngine:Initialized")?1:e.hasReachedCheckpoint("syncEngine:FailedToInitialize")?2:0,authLoaded:e.hasReachedCheckpoint("authLoaded")?1:0}),mc=120*xs.gT.MILLI_PER_SECOND,gc="CDLWorkerManager";function pc(e,t,n,i,a,o,r,s,l,d,c,u,m){var g;let p;const h=function(){const e=new Map;return e.set(Fd.k.appState,Wd),e.set(Fd.k.control,Ld),e.set(Fd.k.database,Ld),e.set(Fd.k.diagnostics,Ld),e.set(Fd.k.endpointHealth,Ld),e.set(Fd.k.graphql,Vd),e.set(Fd.k.networkState,Ld),e.set(Fd.k.syncEngine,Ld),e.set(Fd.k.supportedResolvers,Ld),e.set(Fd.k.telemetry,Ld),e}();return null===(g=e.workerCacheManager)||void 0===g||g.saveWorkerStatusToCacheStorage({state:"InProgress",stepName:"CreateCDLWorker"}),p=n?function(e,t,n,i,a,o,r,s,l,d,c,u,m){if(l){_d(e.logger,l,!0,e.hostRendererId,gc);const d=new SharedWorker(l);return hc(e,i,a,s,t,n,(e=>d.port.postMessage(e)),(e=>{d.port.onmessage=t=>e(t,(e=>d.port.postMessage(e)))}),(e=>{d.onerror=t=>e(t)}),"shared-worker",o,r,u,m)}const g=bd(null==c?void 0:c.experienceName,null==c?void 0:c.ring,null==c?void 0:c.environment,null==c?void 0:c.sessionId,null==c?void 0:c.platformId,null==c?void 0:c.buildVersion,null==c?void 0:c.localeCode,null==c?void 0:c.workerId,void 0,null==c?void 0:c.preECSConsoleLogLevel,null==c?void 0:c.userConsoleLogLevel),p=SharedWorker;SharedWorker=wd(p,e.logger,gc,g,d);const h=new dc;return SharedWorker=p,hc(e,i,a,s,t,n,(e=>h.port.postMessage(e)),(e=>{h.port.onmessage=t=>e(t,(e=>h.port.postMessage(e)))}),(e=>{h.onerror=t=>e(t)}),"shared-worker",o,r,u,m)}(e,t,h,i,a,o,r,s,l&&l.cdlSharedWorkerUrl,(e=>{l&&(l.cdlSharedWorkerUrl=e)}),d,c):function(e,t,n,i,a,o,r,s,l,d,c,u,m,g){var p,h;if(l){_d(e.logger,l,!0,e.hostRendererId,gc);const d=null===(h=null===(p=null==m?void 0:m.loader)||void 0===p?void 0:p.getWorker)||void 0===h?void 0:h.call(p),c=d||new Worker(l);return hc(e,i,a,s,t,n,(e=>c.postMessage(e)),(e=>{c.onmessage=t=>e(t,(e=>c.postMessage(e)))}),(e=>{c.onerror=t=>e(t)}),"web-worker",o,r,u,g)}const v=bd(null==c?void 0:c.experienceName,null==c?void 0:c.ring,null==c?void 0:c.environment,null==c?void 0:c.sessionId,null==c?void 0:c.platformId,null==c?void 0:c.buildVersion,null==c?void 0:c.localeCode,null==c?void 0:c.workerId,null==c?void 0:c.preAuthUserId,null==c?void 0:c.preECSConsoleLogLevel,null==c?void 0:c.userConsoleLogLevel),S=Worker;Worker=wd(S,e.logger,gc,v,d);const f=new cc;return Worker=S,hc(e,i,a,s,t,n,(e=>f.postMessage(e)),(e=>{f.onmessage=t=>e(t,(e=>f.postMessage(e)))}),(e=>{f.onerror=t=>e(t)}),"web-worker",o,r,u,g)}(e,t,h,i,a,o,r,s,l&&l.cdlWebWorkerUrl,(e=>{l&&(l.cdlWebWorkerUrl=e)}),d,c,u,m),p}function hc(e,t,n,i,a,o,r,s,l,d,u,m,g,p){return new Promise(((h,v)=>(0,c.mG)(this,void 0,void 0,(function*(){const S={hostRendererId:a,component:"CDLWorker"},f=new Dd({bootstrapServices:e,loggingContext:S});f.setState("bootstrapped"),null==g||g.mark(ee.ck.CdlWorkerBootstrapped);const y=jd(e,{postMessageCallback:e=>r(e),clients:o},{globalState:f,requestAndStateHandlers:ac(e,a,f)},a);y.workerServer.start(),s(((e,t)=>y.onMessageCallback(e,t,-1))),l((t=>{v(vc(t,e,S,"workerOnError",m,k.state))}));const k={workerServer:y.workerServer,workerClientResponseRouter:y.workerClientResponseRouter,state:f,workerType:d,syncEngineInitializationPromise:u};k.state.setState("loaded");try{yield function(e,t,n,i,a){return(0,c.mG)(this,void 0,void 0,(function*(){const o=t.workerClientResponseRouter.cdlControlClient.sendRequest({type:"health_check",bootstrapData:i,initiatorExperience:n});let r;r=a?(yield o).response:(yield(0,Oe.E)(o,e)).response,t.cdlWorkerSessionId=r.cdlWorkerSessionId,t.cdlWorkerSupportedResolvers=r.cdlWorkerSupportedResolvers,t.state.setState("health_checked")}))}(t||mc,k,n,i,p)}catch(t){v(vc(t,e,S,"healthCheckException",m,k.state))}h(k)}))))}function vc(e,{logger:t,workerCacheManager:n},i,a,o,r){const s=((e,t)=>{if(e.hasOwnProperty("code")){const t=e;if(t.code!==_.jK.Unknown)return t.code}return t.hasReachedCheckpoint("loaded")?t.hasReachedCheckpoint("syncEngine:FailedToInitialize")?_.jK.NotInitialized:t.hasReachedCheckpoint("health_checked")&&t.hasReachedCheckpoint("syncEngine:Initialized")?_.jK.UnhandledRuntimeException:_.jK.TimedOut:_.jK.ScriptLoadError})(e,r),l=(e=>{const t=uc(e);return`LD${t.loaded}:HC${t.healthCheck}:SE${t.syncEngine}:AL${t.authLoaded}`})(r),d=`err: ${(0,he.VK)(e.error)};message: ${(0,he.VK)(e.message)}`,c=(0,he.Tr)(_.w5.DataLayerClient,s,d,void 0,`Uncaught ${a} in Worker: ${(0,he.VK)(e.message)} Auth: ${o} WorkerState: ${l}`),u=`CDL Worker OnError for ${a}::Auth${o}::workerState:${l}::${(e=>e&&e.message&&e.message.includes("AsyncIterableObserver buffer is full")?"AsyncIterableBufferOverflow":"Unknown")(e)}`;return t.errorToTelemetry?t.errorToTelemetry(u,"cdl_worker_startup_error",(e=>{const t=uc(e);return{"WorkerStartupState.Loaded":1===t.loaded,"WorkerStartupState.HealthCheck":1===t.healthCheck,"WorkerStartupState.SyncEngine":t.syncEngine,"WorkerStartupState.AuthLoaded":1===t.authLoaded}})(r),!0):t.error(u,i,s),null==n||n.saveWorkerStatusToCacheStorage({state:"Failure",stepName:"CDLWorkerOnError",error:d}),c}var Sc=n(88476),fc=n(10588);const yc=(0,Sc.p)(fc.A),kc=()=>{let e;return(t,n,i)=>(0,c.mG)(void 0,void 0,void 0,(function*(){if(void 0===e){const a=yield Cc(t,n,i);return e=a,a}return e}))},Cc=(e,t,n)=>(0,c.mG)(void 0,void 0,void 0,(function*(){var i,a,o,r,s;if(!e)return t.log("WebWorkerURL is undefined",n),!0;let l;null===(i=t.infoToTelemetry)||void 0===i||i.call(t,"Pinging PDS / ServiceWorker to verify if worker script is up","cdl_worker_startup_error_verify_worker_script",{endpointUrl:e});const d=new Date,c=performance.now();try{l=yield yc({url:e,method:"HEAD"})}catch(e){return null===(a=t.errorToTelemetry)||void 0===a||a.call(t,e.toString(),"cdl_worker_startup_error_verify_worker_script",{statusCode:-1},!0),!1}const u=performance.now()-c;if(null===(o=t.infoToTelemetry)||void 0===o||o.call(t,"Finished pinging PDS / ServiceWorker","cdl_worker_startup_error_verify_worker_script",{totalRequestTime:u,statusCode:l.status,size:Number(l.headers["content-length"]||-1),correlationId:l.headers["x-msedge-ref"],callId:l.headers["x-ms-request-id"],contentType:l.headers["x-cache"]}),t.log(`precompiled-web-worker header x-msedge-ref: ${l.headers["x-msedge-ref"]}`,n),function(e,t){const n="Ref C: ";if(!e)return!0;let i;if(!(i=e.indexOf(n)))return!0;const a=e.slice(i+n.length),o=new Date(a);if(r=o,!(r instanceof Date)||isNaN(r.getTime()))return!0;var r;return t.getTime()<o.getTime()}(l.headers["x-msedge-ref"],d)||t.log("Request is likely served from service worker, since PDS response time is before the request time",n),l.status!==Ts.qb.OK)return null===(r=t.errorToTelemetry)||void 0===r||r.call(t,`PDS returned ${l.status} for worker script`,"cdl_worker_startup_error_verify_worker_script",void 0,!0),!1;return!l.headers["content-length"]||Number(l.headers["content-length"])<1e3?(null===(s=t.errorToTelemetry)||void 0===s||s.call(t,`PDS returned smaller than expected worker script, of size ${l.headers["content-length"]}`,"cdl_worker_startup_error_verify_worker_script",void 0,!0),!1):(t.log("Worker script fetched successfully.",n),!0)}));const bc=(e,t,n,i,a,o,r,s,l,d,u,m,g,p,h,v)=>new Promise(((S,f)=>{const y=performance.now();let k=null==g?void 0:g.workerStartupScenario,C=null==g?void 0:g.workerStartupScenarioTimeout;const b=Tc(t);if(!k){const e=wc(n.newScenario,o,b,n.workerCacheManager,u,m,h,n.logger);k=e.workerStartupScenario,C=e.workerStartupScenarioTimeout}k.appendEventData({origin:r});const T=k;u&&n.logger.log(`Initializing worker manager from renderer with host: ${u.location.host} protocol: ${u.location.protocol} port: ${u.location.port}`,{hostRendererId:e,component:"CDLWorkerManager"});const w=kc();let I;p||(I=null==u?void 0:u.setTimeout((()=>(0,c.mG)(void 0,void 0,void 0,(function*(){const t=Ac(e);if(!(yield w(b?null==i?void 0:i.cdlSharedWorkerUrl:null==i?void 0:i.cdlWebWorkerUrl,n.logger,t))){const t=(0,he.Tr)("CDL worker script load error",_.jK.ScriptLoadError,"cdl_worker_startup_error_script_load_error"),a=yield Ic(t,n,e,T,b,i,w,!1,!!p);f(a)}}))),4e4)),function(e,t,n,i,a,o,r,s,l,d,u,m,g,p,h,v,S,f){return(0,c.mG)(this,void 0,void 0,(function*(){let y=!1;h&&t.logger.log(`Initializing worker manager from renderer with host: ${h.location.host} protocol: ${h.location.protocol} port: ${h.location.port}`,{hostRendererId:e,component:"CDLWorkerManager"});try{const u=(0,Rd.P)();d.appendEventData({newState:"beforeCreateCDLWorker"});const S=yield pc(t,e,o,i,a,u.promise,v?v.getState():kl.jq.Up,m,n,g,void 0,h,f).finally((()=>{var e,t,n;null===(e=null==h?void 0:h.clearTimeout)||void 0===e||e.call(h,l),null==h||h.clearTimeout(s),null===(n=null===(t=null==h?void 0:h.loader)||void 0===t?void 0:t.clearWorker)||void 0===n||n.call(t)}));return y=!0,d.appendEventData({newState:ee.ck.CdlWorkerManagerHealthChecked,searchSessionId:S.cdlWorkerSessionId}),S.state.setState("initialized"),Nc(d),d.mark("CDLWorkerManagerInitialized"),function(e,t,n,i,a,o,r,s){var l,d,u,m,g,p;(0,c.mG)(this,void 0,void 0,(function*(){const c=Ac(n);try{const{response:n}=yield e.workerClientResponseRouter.cdlSyncEngineClient.sendRequest({type:"startup_info",subType:"Messaging",params:void 0}),o=n;if(o&&"string"!=typeof o&&"error"===o.type){const e="string"==typeof o.details?o.details:JSON.stringify(o.details);throw t.logger.warn(`Sync engine for Messaging strategy: ${e}`,c),e}null==s||s.appendEventData({messagingSyncEngineStartupMode:o,appLaunchMode:"clean"===o?"cold":"warm",workerResponseTime:performance.now()-r}),a.resolve(!0),e.state.setState("syncEngine:Initialized"),Nc(i),i.stop({dataSource:o})}catch(n){const r=yield _c(o,t.workerCacheManager),s="Init SyncEngine failed",h=`err: ${(0,he.VK)(n)}`,v=n.code||_.jK.Unknown;t.logger.error(`${s}:: ${h}`,c,v),t.logger.error(`${s}:: WSM: ${r}`,c,v),Nc(i);const S=`${s}:: WSM: ${r}:: ${h}`,f=(null===(d=null===(l=n.response)||void 0===l?void 0:l.error)||void 0===d?void 0:d.isExpected)||!1,y={errors:S,isAccepted:f,errorCode:v,dataSource:null===(m=null===(u=n.response)||void 0===u?void 0:u.error)||void 0===m?void 0:m.startupMode,reason:null===(p=null===(g=n.response)||void 0===g?void 0:g.error)||void 0===p?void 0:p.message};f?i.cancel(y):i.fail(y),e.state.setState("syncEngine:FailedToInitialize"),a.resolve(!1)}}))}(S,t,e,d,u,o,r,p),S}catch(i){throw yield Ic(i,t,e,d,o,n,u,!y,!!S)}}))}(e,n,i,a,r,b,y,I,C,k,w,s,l,d,u,m,p,v).then((e=>S(e))).catch((e=>f(e)))})),Tc=e=>"electron"===e||"sharedworker"===e;function wc(e,t,n,i,a,o,r,s){var l;const d=300*ne.kg,c=t||d,u=e(ee.RG.CentralDataLayerWorkerManagerStartup,c);let m=!0;(null==r?void 0:r.getUser)&&(m=!1,null==r||r.getUser().then((()=>m=!0)));const g=null===(l=null==a?void 0:a.setTimeout)||void 0===l?void 0:l.call(a,(()=>{m||(null==s||s.warn("Worker startup - getUser is still not available. Cancelling Worker Scenario"),u.cancel({reason:"GetUser"}));(o?o.getState():kl.jq.Up)===kl.jq.InteractionRequired&&(null==s||s.warn("Worker startup - User is in InteractionRequired state. Cancelling Worker Scenario"),u.cancel({reason:"InteractionRequired"})),_c(n,i).then((e=>{u.appendEventData({errors:e})}))}),c-500);return{workerStartupScenario:u,workerStartupScenarioTimeout:g}}function _c(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){const n=e?"shared-worker":"web-worker";let i="";if(t)try{const e=yield t.getWorkerStartupStatus(n);return"WorkerStartupStatus: "+(e?`lastError: ${JSON.stringify(e.lastError)}:: lastState: ${JSON.stringify(e.lastState)}`:"Unable to get CDL worker startup status")}catch(e){i=`Unable to get CDL worker startup status. Reason: ${(0,he.VK)(e)}`}else i="Unable to get CDL worker startup status. Reason: workerCacheManager is undefined";return i}))}function Ic(e,t,n,i,a,o,r,s,l){var d;return(0,c.mG)(this,void 0,void 0,(function*(){const c=yield _c(a,t.workerCacheManager),u=`Failed to initialize CDL Worker :: err: ${(0,he.VK)(e)}`,m=`${u} :: ${c}`,g=Ac(n);let p={errors:m,errorCode:t.workerCacheManager?e.code:_.jK.NotInitialized};if(s&&!l)try{(yield r(a?null==o?void 0:o.cdlSharedWorkerUrl:null==o?void 0:o.cdlWebWorkerUrl,t.logger,g))||(e.code=_.jK.ScriptLoadError,p={errors:"CDL Worker Script load error",errorCode:_.jK.ScriptLoadError})}catch(t){e.code=_.jK.ScriptLoadError,p={errors:`CDL Worker Script load error :: ${t.message}`,errorCode:_.jK.ScriptLoadError}}const h=(0,he.Tr)("CDLWorkerManager",e.code,JSON.stringify(g),void 0,m);return t.logger.error(u,g,h.code),t.logger.error(c,g,h.code),Nc(i),e&&e.code===_.jK.TimedOut?i.stop(p,"timeout"):i.fail(p),null===(d=t.workerCacheManager)||void 0===d||d.saveWorkerStatusToCacheStorage({state:"Failure",stepName:"CreateCDLWorker",error:m}),h}))}function Ac(e){return{hostRendererId:e,component:"CDLWorkerManager"}}function Nc(e){e.appendEventData({"Thread.Id":"",threadId:""})}const Ec="cdl-worker-startup-status",Dc="cdl-worker-verbose-log";class Fc{constructor(e,t,n){this._cacheStorage=e,this._cacheName="cdl-worker-cache-manager",this.lastSavePromise=Promise.resolve(null),this._logger=t,this._scenarioFactory=n}save(e,t,n,i,a){return(0,c.mG)(this,void 0,void 0,(function*(){let o="";try{if(!e)throw this._error("get","Invalid key");null==a||a.appendEventData({context:i}),o=JSON.stringify(t),this._logger.log(`[CDLWorkerCacheManager]: Saving item to ${this._cacheName} key: ${e}`);const r=new Response(o),s=this._getScopedRequest(e,n,i);return yield this._cacheStorage.put(s,r),null==a||a.stop(),s.request.url}catch(t){const n=this._error("save",`[CDLWorkerCacheManager]: Failed to save object to cache, err: ${(0,he.VK)(t)}, key: ${e}, experienceName: ${i}`);return this._logger.warn((0,he.VK)(n)),null==a||a.fail({message:t.message,errorCode:t.name,errors:(0,he.VK)(n)}),null}}))}get(e,t,n,i){return(0,c.mG)(this,void 0,void 0,(function*(){try{if(!e)throw this._error("get","Invalid key");null==i||i.appendEventData({context:n});const a=this._getScopedRequest(e,t,n),o=yield this._cacheStorage.match(a);return o&&o.body?(null==i||i.stop({cached:!0}),yield o.json()):(this._logger.log(`[CDLWorkerCacheManager]: Get from cache for key ${e} could not find a result, returning null.`),null==i||i.stop({cached:!1}),null)}catch(t){const n=this._error("get",`[CDLWorkerCacheManager]: Failed to get item from cache for key ${e}, err: ${(0,he.VK)(t)}`);throw this._logger.error((0,he.VK)(n)),null==i||i.fail({errors:(0,he.VK)(n),errorCode:t.name,message:t.message}),n}}))}delete(e,t,n){return(0,c.mG)(this,void 0,void 0,(function*(){try{if(!e)throw this._error("get","Invalid key");this._logger.log(`[CDLWorkerCacheManager]: Deleting item from cdl worker cache key: ${e}, experienceName: ${n}`);const i=this._getScopedRequest(e,t,n),a=yield this._cacheStorage.delete(i);return Promise.resolve(a)}catch(t){const i=this._error("delete",`[CDLWorkerCacheManager]: Failed to delete item from cache key: ${e}, experienceName: ${n}, err: ${(0,he.VK)(t)}`);return this._logger.error((0,he.VK)(i)),!1}}))}clear(){return(0,c.mG)(this,void 0,void 0,(function*(){try{return this._logger.log("[CDLWorkerCacheManager]: Clearing cdl-worker cache"),this._cacheStorage.clear(this._cacheName)}catch(e){const t=this._error("clear",`[CDLWorkerCacheManager]: Failed to clear the cache: ${this._cacheName}, err: ${(0,he.VK)(e)}`);return this._logger.error((0,he.VK)(t)),!1}}))}getCachedUrlByKey(e,t){return this._getScopedRequest(e,t).request.url}saveWorkerStatusToCacheStorage(e){return(0,c.mG)(this,void 0,void 0,(function*(){let t;return yield this.lastSavePromise,this.lastSavePromise=this.get(Ec).then((e=>{t=e})).catch((()=>{this._logger.warn("WorkerCacheManager couldn't get cache key cdl-worker-startup-status, setting to default")})).then((()=>(t||(t={}),"Failure"===e.state?t.lastError=e:t.lastState=e,this.save(Ec,t)))),this.lastSavePromise}))}getWorkerStartupStatus(e){return(0,c.mG)(this,void 0,void 0,(function*(){return this.get(Ec,void 0,e)}))}saveWorkerVerboseLog(e){return this.save(Dc,e,void 0)}getWorkerVerboseLog(e){return(0,c.mG)(this,void 0,void 0,(function*(){try{const t=yield this.get(Dc,void 0,e);return t||""}catch(e){return""}}))}getAggregatedUserData(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){try{const n=null===(t=this._scenarioFactory)||void 0===t?void 0:t.newScenario(ee.RG.MTMAAggregatorUserDataRead);return yield this.get(`cdl-worker-aggregated-user-data/${e}`,void 0,"cdl-worker",n)}catch(e){return null}}))}getAllKeys(e){return(0,c.mG)(this,void 0,void 0,(function*(){try{const t=yield this._cacheStorage.keys(this._cacheName);if(null==e||e.stop(),!t)return[];return t.map((e=>e.url))}catch(t){const n=this._error("getAllKeys",`[CDLWorkerCacheManager]: Failed to get all keys from cache, err: ${(0,he.VK)(t)},`);return this._logger.warn((0,he.VK)(n)),null==e||e.fail({message:t.message,errorCode:t.name,errors:(0,he.VK)(n)}),[]}}))}_error(e,t){return(0,he.Tr)("CDLWorkerCacheManager",_.jK.Undefined,e,void 0,t)}_getScopedRequest(e,t,n){return this._cacheStorage.createRequest(this._cacheName,`${this._cacheName}/${e}`,or.f.Experience,t,!0,n)}}const Pc=(e,t,n)=>{try{const i=new Fc(new fd(caches,"","",e),t,n);return i.delete(Ec),i}catch(e){return void t.error(`[createCDLWorkerCacheManager]: Error occurred while creating CDLWorkerCacheManager: ${(0,he.VK)(e)}`)}};function Mc(e,t,n,i,a,o,r,s,l,d,u,m,g,p,h){var v,S;return(0,c.mG)(this,void 0,void 0,(function*(){const{workerStartScenarioTimeoutInMs:f}=o.get(A.J.CdlWorker),y=(e,t,n)=>a.newScenario(e,{callback:n,timeoutMs:t}),k=Pc(t.experienceName,i.newLogger("CDL:DataClientCoreWorkerManager"),a),C=Rc(l,o),b=wc(y,f,Tc(C),k,e,m,r,d),T=xc(o,e,a,d),w=(null===(v=e.loader)||void 0===v?void 0:v.getCdlWorkerUrl)?null===(S=e.loader)||void 0===S?void 0:S.getCdlWorkerUrl():void 0,_=jc(l,o,a,e,d);b.workerStartupScenario.appendEventData({contentType:_.toString(),newState:"beforeBootstrapData"}),function(e,t,n,i){i.log(`Initializing workerType ${e} ${t?"as Worker host":`as non-Worker host with sharedWorkerUrl ${n}`}`)}(C,_,T,d);try{let a;_&&(a=yield function(e,t,n,i,a,o,r){return(0,c.mG)(this,void 0,void 0,(function*(){o.appendEventData({newState:"beforeAuthBootstrapData"});const s=yield function(e,t,n,i,a,o){return(0,c.mG)(this,void 0,void 0,(function*(){let r;a.appendEventData({newState:"beforeAuthUserData"});const s=1e4,l=o.get(A.J.CdlWorker).timeToGetUserFromAuthMs||s;try{r=yield(0,Oe.E)(e.getUser(),l)}catch(e){n.error(`Worker bootstrap authentication error - cannot authenticationService.getUser: ${null==e?void 0:e.code}`)}if(!r)return{};let d;a.appendEventData({newState:"beforeDiscoverUserData"});try{d=yield(0,Oe.E)(t.getUser(),l)}catch(e){n.error(`Worker bootstrap authentication error - cannot discover.getUser: ${null==e?void 0:e.code}`)}if(!d)return{userInformation:r};return{userInformation:r,userDetails:{userDetails:d,id:null==d?void 0:d.id},authState:(null==i?void 0:i.getState())||kl.jq.Up}}))}(e,t,n,i,o,r);return{hostSettings:a.hostSettings,auth:s}}))}(r,s,d,m,n,b.workerStartupScenario,o)),b.workerStartupScenario.appendEventData({newState:"beforeInitializeWorkerManagerFromDataClientCore"});return yield function(e,t,n,i,a,o,r,s,l,d,u,m,g,p,h,v,S,f,y){var k,C;return(0,c.mG)(this,void 0,void 0,(function*(){const{ring:c,environment:b}=u.get(A.J.Metadata),{sessionId:T}=u.get(A.J.Platform),{enablePassingPlatformIdInWorkerUrlHash:w}=u.get(A.J.Core),{workerStartTimeoutInMs:_,workerStartScenarioTimeoutInMs:I,disablePingingPDSIfWorkerStartupFails:N,shouldDisableHealthCheckTimeout:E}=u.get(A.J.CdlWorker),D=b?(0,Z.get)(bt.s,b):void 0;return v.workerStartupScenario.appendEventData({newState:"beforeInitializeWorkerManager"}),bc(e,t,{logger:new Cd(s.newLogger("CDL:DataClientCoreWorkerManager")),newScenario:h,offlineCacheManager:r,workerCacheManager:d,hostRendererId:e},{cdlSharedWorkerUrl:n||"",cdlWebWorkerUrl:i||""},_||void 0,I||void 0,a,o,{experienceName:a,ring:(null==c?void 0:c.id)||void 0,environment:D,platformId:w?l.config.platformId:void 0,sessionId:T||void 0,buildVersion:l.config.buildVersion,localeCode:S,workerId:p,preECSConsoleLogLevel:null===(k=m.defaultConsoleLogLevel)||void 0===k?void 0:k.preECSConsoleLogLevel,userConsoleLogLevel:null===(C=m.defaultConsoleLogLevel)||void 0===C?void 0:C.userConsoleLogLevel},f,m,g,v,!!N,y,!!E)}))}(t.clientId,C,T,w,t.experienceName,a,u,i,l,k,o,e,m,g,y,b,p,h,r)}catch(e){return void d.error(`Failed to start CDL Worker from DataClientCore: ${(0,he.VK)(e)}`)}}))}const jc=(e,t,n,i,a)=>{const o=Rc(e,t),r=xc(t,i,n,a);return"webworker"===o||"web"===o||!r};function Rc(e,t){let n=e.config.clientType===Fo.Bh.Web?"webworker":"sharedworker";const i=t.get(A.J.Host).cdlWorkerType,a=t.get(A.J.CdlWorker).cdlWorkerType;return i?n=i:a&&(n=a),n}function xc(e,t,n,i){let{cdlSharedWorkerUrl:a}=e.get(A.J.Host);const o=t.localStorage.getItem("ts.cdlSharedWorkerJsUrl");if(a&&o&&a!==o){i.error(`Worker URL saved in TSW:${a} is different from worker url in TMP:${o}`);n.newScenario(ee.RG.HostSettingsSync).fail({reason:JSON.stringify({cdlSharedWorkerUrl:a,storedWorkerUrl:o})}),a=o}return a}const Oc=e=>{const t=e.get(A.J.Host).enableSyncEngine;return(0,Z.isNil)(t)?!!e.get(A.J.CdlWorker).enableSyncEngine:t},Lc=e=>{const t=e.get(A.J.Host).enableProfileManagerStore;return(0,Z.isNil)(t)?!!e.get(A.J.People).enableProfileManagerStore:t},Uc=e=>{const{dataStoreMapType:t,disableDataStoreInMemoryProvider:n}=e.get(A.J.CdlWorker);return n?"none":t||"red-black-tree"};class Bc extends xe{constructor(){super(_.Yg.CreateCDLWorkerAppServiceTask,["appStateService","loggerFactory","platformService","scenarioFactory","windowProvider","cdlWorkerService","coreSettings"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=Oc(e.coreSettings),n=e.coreSettings.get(A.J.CdlWorker).disableTrouterDisconnectedBannerT2;return t&&e.cdlWorkerService&&!n?function(e,t,n,i,a,o,r){return(0,c.mG)(this,void 0,void 0,(function*(){if(jc(i,n,t,e,a)){const e=yield o.getCDLWorkerManager();null==e||e.state.setState("appService:Loaded",r)}}))}(e.windowProvider,e.scenarioFactory,e.coreSettings,e.platformService,e.loggerFactory.newLogger("CDLWorkerManager"),e.cdlWorkerService,e.appStateService):Promise.resolve()}))}}class Wc extends xe{constructor(){super(_.Yg.CreateCDLWorkerAuthTask,[])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=Oc(e.coreSettings),n=e.cdlWorkerService;if(t&&n){yield function(e,t,n,i,a,o,r,s,l){return(0,c.mG)(this,void 0,void 0,(function*(){if(jc(o,n,t,e,r)){const e=yield s.getCDLWorkerManager();null==e||e.state.setState("authLoaded",{authenticationService:i,discover:a,authStateProvider:l})}}))}(e.windowProvider,e.scenarioFactory,e.coreSettings,e.authenticationService,e.discover,e.platformService,e.loggerFactory.newLogger("CDLWorkerManager"),n,e.authStateProvider);if(!e.coreSettings.get(A.J.CdlWorker).enableCleanUpOnLogout)return;return t=>(0,c.mG)(this,void 0,void 0,(function*(){switch(t){case"signout":yield n.logoutCurrentUser(e.coreSettings);break;default:return}}))}}))}}class Gc{constructor(e,t,n,i){this.cdlWorkerService=i,this._logger=n.newLogger("CDLWorkerStateSender"),this._clientStateSubscription=e.observe().subscribe((e=>this.sendAppStateChangeToWorker({requestOperationtype:Kd.NotifyCoreClientState,context:{appState:e}}))),this._machineLockStateSubscription=t.observe().pipe((0,Br.x)(((e,t)=>e.machineLockState===t.machineLockState))).subscribe((e=>this.sendAppStateChangeToWorker({requestOperationtype:Kd.NotifyCoreMachineState,context:{appState:e.machineLockState}}))),this._suspendedStateSubscription=t.observe().pipe((0,Br.x)(((e,t)=>e.suspendedState===t.suspendedState))).subscribe((e=>this.sendAppStateChangeToWorker({requestOperationtype:Kd.NotifyCoreSuspendedState,context:{appState:e.suspendedState}})))}dispose(){this._clientStateSubscription&&(this._clientStateSubscription.unsubscribe(),this._clientStateSubscription=void 0),this._machineLockStateSubscription&&(this._machineLockStateSubscription.unsubscribe(),this._machineLockStateSubscription=void 0),this._suspendedStateSubscription&&(this._suspendedStateSubscription.unsubscribe(),this._suspendedStateSubscription=void 0)}sendAppStateChangeToWorker(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=(0,R.u4)(e);let n;try{n=yield this.getCdlAppStateClient()}catch(e){return void this._logger.error(`Failed to send app state change ${t} to CDL. Reason: failed to obtain a CDLAppStateClient. See initialization failures earlier in the logs.`)}if(n){this._logger.log(`Alerting CDL Worker of host state change: ${t}`);try{yield n.sendFilteredAppStateRequest(e)}catch(e){this._logger.error(`Failed to send app state change ${t} to CDL. Reason: ${(0,R.u4)(e)}`)}}else this._logger.error(`Failed to send app state change ${t} to CDL. Reason: CDLAppStateClient does not exist. See initialization failures earlier in the logs.`)}))}getCdlAppStateClient(){return(0,c.mG)(this,void 0,void 0,(function*(){const e=yield this.cdlWorkerService.getCDLWorkerManager();return null==e?void 0:e.workerClientResponseRouter.cdlAppStateClient}))}}class Vc extends Gd{constructor(e,t){super(),this.workerClientResponseRouter=e,this.logger=t.loggerFactory.newLogger("CDLControlPlaneCommunicator")}sendMessage(e){this.getRequestForOperationName(e).then((t=>this.handleResponse(e.rendererId,e.requestId,this.extractPerfStats(t)))).catch((t=>this.handleResponse(e.rendererId,e.requestId,void 0,(0,R.u4)(t)||"Unknown Error")))}getRequestForOperationName(e){const t=e.operationName;if(!t)return Promise.reject(`Request could not be sent: operationName unavailable. RequestId: ${e.requestId}.`);switch(this.logger.log(`Converting GQL operation ${t} to CDL Worker control plane message.`),t){case"notifyWorkerSyncCanStart":return this.workerClientResponseRouter.cdlControlClient.sendRequest({type:"sync_can_start"});case"AppsChatNotifyActiveContextChangedMutation":const t=e.request.variables;return this.workerClientResponseRouter.cdlControlClient.sendRequest({type:"active_context_changed",activeContextChangedData:{activeContextId:t.activeContextId,activeContextType:t.activeContextType}})}}handleResponse(e,t,n,i){return Promise.resolve(this.onResponseReceived({payload:{dataLayer:{rendererId:e,requestId:t,data:!i,errors:i,extensions:{perfStats:n}}}}))}extractPerfStats(e){return{workerResponseTime:e.workerResponseTime||0,dataStorePerfStats:[]}}}var Hc=n(59193);class $c{constructor(e,t,n,i,a,o,r){this.configLoader=e,this.coreSettings=t,this.coreSettingsContext=n,this.platformService=a,this.primaryUser=o,this.locale=r,this._hostSettings={},this.logger=i.newLogger("CDLWorkerHostSettingsAggregator")}get hostSettings(){return 0===Object.keys(this._hostSettings).length&&(this._hostSettings=this.aggregateHostSettings()),this._hostSettings}startNotifyingCDLWorkerForHostSettingsChanges(e){const t=[A.J.Activity,A.J.Auth,A.J.Calendar,A.J.CdlWorker,A.J.Communities,A.J.Core,A.J.CsaService,A.J.Diagnostics,A.J.DiscoverSurface,A.J.Esp,A.J.ExternalAccounts,A.J.Files,A.J.Flyout,A.J.Guardians,A.J.Host,A.J.Messaging,A.J.Metadata,A.J.People,A.J.Platform,A.J.Presence,A.J.TeamsAndChannels,A.J.WhatsNew,A.J.WindowsSignatureExperiences].map((e=>this.coreSettings.getObservable(e)));(0,Ur.T)(...t).subscribe((t=>{const n=this.aggregateHostSettings();(0,Z.isEqual)(this._hostSettings,n)||(this._hostSettings=n,this.logger.log("Notifying CDL Worker of host settings changes: ",n),e.sendRequest({type:"host_settings_updated",hostSettings:n}))}))}aggregateHostSettings(){var e;this.logger.debug("aggregateHostSettings called...");const{enableNetworkStateCommsBetweenCoreAndWorker:t,enableMTMA:n}=this.coreSettings.get(A.J.Core),{electronVersion:i,enableHybridChannelList:a=!1,msgEnableChannelsV2:o=!1,msgEnableChannelsV2Header:r=!1,msgEnableSelfChat:s=!1,userType:l="",windowsInsiderChannel:d}=this.coreSettings.get(A.J.Host),c=this.coreSettingsContext,{enableTPSSyncStrategy:u,enableTPSUpdatesOverTrouter:m,tpsSyncStrategyPollingIntervalMs:g}=this.coreSettings.get(A.J.CdlWorker);let p=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({enableNetworkStateCommsBetweenCoreAndWorker:!!t,enableMTMA:!!n,policiesNamespaces:this.configLoader("policies").namespaces||[],enableSyncEngine:Oc(this.coreSettings),enableProfileManagerStore:Lc(this.coreSettings),enableMessagingNotificationsOverTrouter:this.isMessagingNotificationsOverTrouterEnabled(),imageCookieAuthEnabled:!this.coreSettings.get(A.J.Auth).skipAmsAuthRequest,msgEnableChannelsV2:o,msgEnableChannelsV2Header:r,msgEnableSelfChat:s,enableHybridChannelList:a,enableEspInWorker:!!this.coreSettings.get(A.J.Esp).enableEsp,ecsHostUrl:this.platformService.ecsOverrides.hostUrl,desktopVersion:this.platformService.host.hostAppVersion,initialWorkerHostLocationUrl:this.platformService.config.currentUrl,serviceSwitcherSelectedServiceId:c.getServiceSwitcherApiKey(),electronVersion:i,locale:this.locale||_.ZW,userType:l,windowsInsiderChannel:d,enableTPSSyncStrategy:!!u,enableTPSUpdatesOverTrouter:!!m,tpsSyncStrategyPollingIntervalMs:g},this.getCdlWorkerHostSettings(this.coreSettings)),this.getActivityHostSettings(this.coreSettings)),this.getActivityNotificationHostSettings(this.coreSettings)),this.getEndpointsHealthHostSettings(this.coreSettings)),this.getPeopleHostSettings(this.coreSettings)),this.getMessagingHostSettings(this.coreSettings)),this.getTeamsAndChannelsSettings(this.coreSettings)),this.getCalendarHostSettings(this.coreSettings)),this.getExternalAccountSettings(this.coreSettings)),this.getPresenceHostSettings(this.coreSettings)),this.getDataStoreHostSettings(this.coreSettings)),this.getFilesHostSettings(this.coreSettings)),this.getAuthHostSettings(this.coreSettings)),this.getDiscoverSurfaceHostSettings(this.coreSettings)),this.getMtmaSpecificHostSettings()),this.getGuardiansHostSettings(this.coreSettings)),h=this.getCoreSettingsTestOverrides(this.coreSettingsContext);const{isRunningGlassjar:v}=this.coreSettings.get(A.J.Test);if(this.platformService.config.isInCypressFrame||v){const t={authOverrides:{authzEndpointUrl:this.coreSettings.get(A.J.Auth).authzEndpointUrl},csaOverrides:{csaHostUrl:null===(e=this.coreSettings.get(A.J.CsaService).apiConstants)||void 0===e?void 0:e.host}};p=Object.assign(Object.assign({},p),t),h={localStorageTestOverrides:Object.assign(Object.assign({},h.localStorageTestOverrides),{test:{}}),qspTestOverrides:h.qspTestOverrides}}return Object.assign(Object.assign(Object.assign({},p),h),{cdlWorkerSettings:this.getCdlWorkerSettings(this.coreSettings)})}getCdlWorkerSettings(e){const{enableFilterPinnedAppsBasedOnPolicy:t}=e.get(A.J.Extensibility),{enableCommunitiesApp:n,enableMemberThreadDetailsSync:i}=e.get(A.J.Communities),{enablePoliciesPushUpdates:a,enable1JSGraphqlSearchBox:o,searchBoxSuggestions:r,enableCommunitiesBadgeCount:s}=e.get(A.J.Core),{enableVoicemailFeedItems:l,enableCommunitiesFeedItems:d,enabledCommunitiesActivities:c,activityCustomizations:u}=e.get(A.J.Activity),{enableCalendarInviteRouting:m}=e.get(A.J.Calendar),{enableCallsAppPhaseStateMachine:g}=e.get(A.J.Calling),{enableSubstrateInstrumentation:p}=e.get(A.J.Autosuggest),{enableTaglessNameForAnonConsumerUser:h}=e.get(A.J.People),{enableConsumerConversations:v,commCopilotSummarizationRequestConfig:S}=e.get(A.J.Messaging),{ageGroup:f}=e.get(A.J.AgeConsent),{enableT2ChannelsAtMentionBadging:y,enableAutoFavoriteChannel:k,enableRecommendedTeamsSync:C,enableReactJoinTeamsGallery:b,recommendedTeamsCacheIntervalInHours:T,enableUserResolutionForChannelModeratorList:w}=e.get(A.J.TeamsAndChannels),{enableShowMissedActivitiesInChatList:_}=e.get(A.J.ChatList),{clientExtendedDiagnosticsData:I,disableExtendedDiagnosticsDataToggle:N,enableWorkerStoreDiagnosticsLogsInIDB:D,workerDiagnosticsLogBufferArraySize:F,workerDiagnosticsLogsIDBObjectCount:P,logsMarkInterval:M,savingLogsIntoIDBThrottleTime:j,throttleWindowSizeMs:R,throttleCapacity:x,diagnosticsLogsThrottling:O,consoleLogLevel:L}=e.get(A.J.Diagnostics),{enableWhatsNew:U,enableEntryPointPromotions:B,maxFeaturesInOverlayCount:W,maxValidFromDaysToBeShown:G,contactsSync:V,chatViaSms:H,flyoutV2:$,flyoutInlineChat:z,togetherEmojisHighFive:q,communitiesBeta:J}=e.get(A.J.WhatsNew),{enableOverflowMenuInFlyout:Q}=e.get(A.J.Flyout),{enableHighFiveTogetherEmojis:K}=e.get(A.J.WindowsSignatureExperiences);return{core:{enablePoliciesPushUpdates:a,enable1JSGraphqlSearchBox:!!o,searchBoxSuggestions:r,enableCommunitiesBadgeCount:!!s},[A.J.Messaging]:{allowUserChat:this.getAllowUserChat(e),enableConsumerConversations:!!v,commCopilotSummarizationRequestConfig:S},[A.J.Extensibility]:{enableFilterPinnedAppsBasedOnPolicy:t},[A.J.Activity]:{activityCustomizations:u,enableVoicemailFeedItems:!!l,enableCommunitiesFeedItems:!!d,enabledCommunitiesActivities:c},[A.J.Communities]:{enableCommunitiesApp:n,enableMemberThreadDetailsSync:i},[A.J.Calendar]:{enableCalendarInviteRouting:m},[A.J.Calling]:{enableCallsAppPhaseStateMachine:!!g},[A.J.People]:{enableTaglessNameForAnonConsumerUser:!!h},[A.J.AgeConsent]:{ageGroup:f},platform:{deviceInfo:e.get(A.J.Platform).deviceInfo},[A.J.Autosuggest]:{enableSubstrateInstrumentation:!!p},[A.J.TeamsAndChannels]:{enableT2ChannelsAtMentionBadging:!!y,enableAutoFavoriteChannel:k,enableRecommendedTeamsSync:!!C,enableReactJoinTeamsGallery:!!b,recommendedTeamsCacheIntervalInHours:T,enableUserResolutionForChannelModeratorList:!!w},[A.J.ChatList]:{enableShowMissedActivitiesInChatList:!!_},metadata:{region:e.get(A.J.Metadata).region},cdlWorker:{disableLastMessageSenderCache:!!e.get(A.J.CdlWorker).disableLastMessageSenderCache},[A.J.Test]:Object.assign({},e.get(A.J.Test)),[A.J.Diagnostics]:{clientExtendedDiagnosticsData:!!I,disableExtendedDiagnosticsDataToggle:!!N,enableWorkerStoreDiagnosticsLogsInIDB:!!D,workerDiagnosticsLogBufferArraySize:F||0,workerDiagnosticsLogsIDBObjectCount:P||0,logsMarkInterval:M||0,throttleWindowSizeMs:R||0,throttleCapacity:x||0,savingLogsIntoIDBThrottleTime:j||0,diagnosticsLogsThrottling:O||E.gG.DryRunQuiet,consoleLogLevel:L},[A.J.WhatsNew]:{enableWhatsNew:!!U,enableEntryPointPromotions:!!B,maxFeaturesInOverlayCount:W||0,maxValidFromDaysToBeShown:G||0,contactsSync:V,chatViaSms:H,flyoutV2:$,flyoutInlineChat:z,togetherEmojisHighFive:q,communitiesBeta:J},[A.J.WindowsSignatureExperiences]:{enableHighFiveTogetherEmojis:!!K},[A.J.Flyout]:{enableOverflowMenuInFlyout:!!Q}}}getAllowUserChat(e){const{allowUserChat:t,messagingPolicy:n}=e.get(A.J.Messaging);return"boolean"==typeof t||!!n?!!t:void 0}getPresenceHostSettings(e){const{enablePresenceInWorker:t,enablePresenceNotificationsOverTrouter:n,enablePriorityContactsSettings:i,enableEndpointsManagerOnBreakthroughService:a,enableOOFSettings:o}=e.get(A.J.Presence);return{enablePresenceInWorker:!!t,enablePresenceNotificationsOverTrouter:!!n,enablePriorityContactsSettings:!!i,enableEndpointsManagerOnBreakthroughService:!!a,enableOOFSettings:!!o}}getAuthHostSettings(e){const{skypeTokenValidationDisabled:t}=e.get(A.J.Auth);return{skypeTokenValidationDisabled:!!t}}getCdlWorkerHostSettings(e){const{enableAppsPlatformSyncEngine:t,enableChatWithUserNetworkFetch:n,enableClassBasedErrors:i,enableOfflineActionsSyncEngine:a,enableOpenWindowsSettingsMaglev:o,enablePoliciesSyncEngine:r,enableCrossTenantPoliciesSyncEngine:s,enableConversationReminderEngine:l,enableNotificationsEngine:d,enableSendNudgeAfterInactivityPeriod:c,enableStartupDeferral:u,enableTenantSyncStrategy:m,enableSearchTopNPopulateStrategy:g,enableSensitivityLabelSync:p,enableUserPreferencesWorkerFetch:h,enableWaitOnAuthUp:v,chatsStartupJobPageSize:S,enableStartupUsingPartialData:f,enableNonRecentChatsStartup:y,nonRecentChatsStartupPageSize:k,nonRecentChatsStartupMaxCalls:C,nonRecentChatsStartupWorkflowTimeoutInMS:b,partialDataStartupChatsLimit:T,partialDataStartupSkipNonRecentMeeting:w,enableChatTitleCache:_,disableLastMessageSenderCache:I,disableUnknownTitleFallback:N,disableTitleCacheRefreshOnDisplayNameChange:E,enableMruChannelsMemoryPruning:D,currentConversationTableVersion:F,disableMessageContentWrapperDiv:P,disablePartialLoadConversationNetworkFetch:M,enableMultipleReplyChainsUpdatesFromWorker:j,enableMTMAAggregator:R,skipMeetingChatsInGroupChatSync:x,disablePingingPDSIfWorkerStartupFails:O,enablePriorityJobRunner:L,scheduleChannelsConversationSyncAtBackgroundPriority:U,trouterNotifyServiceDownTimerMs:B,chatServiceMaxPageSize:W,chatReplyChainsToFetch:G}=e.get(A.J.CdlWorker);return{enableClassBasedErrors:!!i,enablePoliciesSyncEngine:!!r,enableCrossTenantPoliciesSyncEngine:!!s,enableOpenWindowsSettingsMaglev:!!o,enableConversationReminderEngine:!!l,enableSendNudgeAfterInactivityPeriod:!!c,enableNotificationsEngine:!!d,enableUserPreferencesWorkerFetch:!!h,enableAppsPlatformSyncEngine:!!t,enableChatWithUserNetworkFetch:!!n,enableOfflineActionsSyncEngine:!!a,enableStartupDeferral:!!u,enableTenantSyncStrategy:!!m,enableSearchTopNPopulateStrategy:!!g,enableSensitivityLabelSync:!!p,enableWaitOnAuthUp:!!v,enableStartupUsingPartialData:!!f,enableNonRecentChatsStartup:!!y,nonRecentChatsStartupPageSize:k,nonRecentChatsStartupMaxCalls:C,nonRecentChatsStartupWorkflowTimeoutInMS:b,chatsStartupJobPageSize:S,partialDataStartupChatsLimit:T,partialDataStartupSkipNonRecentMeeting:w,skipMeetingChatsInGroupChatSync:!!x,enableChatTitleCache:!!_,disableLastMessageSenderCache:!!I,enableMruChannelsMemoryPruning:!!D,disableUnknownTitleFallback:!!N,disableTitleCacheRefreshOnDisplayNameChange:!!E,disablePartialLoadConversationNetworkFetch:!!M,enableMultipleReplyChainsUpdatesFromWorker:!!j,enableMTMAAggregator:!!R,disablePingingPDSIfWorkerStartupFails:O,currentConversationTableVersion:F,disableMessageContentWrapperDiv:P,enablePriorityJobRunner:!!L,scheduleChannelsConversationSyncAtBackgroundPriority:!!U,trouterNotifyServiceDownTimerMs:B,chatServiceMaxPageSize:W,chatReplyChainsToFetch:G}}getActivityHostSettings(e){const{enableActivityManagerStore:t,enableActivityBellCount:n,paginationFirstLoad:i,maxActivityFeedLatency:a,clientStableBufferTimeForAPT:o,enableOrderFeedsReplyChainsByMaxVersion:r,enableChannelFeedItems:s,enableActivityTranslationInCDL:l,enableUrgentFeedItems:d,enableSyntheticNotificationProcessor:c,enableGraphFeedItems:u,enableSharedChannelFeedItems:m,disableIncomingPstnActivityFeed:g,enableMTMAMissedNotifications:p,mtmaNotificationsPollingInterval:h,enableActivityFeedItemDeletion:v}=e.get(A.J.Activity);return{enableActivityManagerStore:!!t,enableActivityBellCount:!!n,feedItemsCountOnAppLoad:i||0,maxActivityFeedLatency:a||0,clientStableBufferTimeForAPT:o||0,enableOrderFeedsReplyChainsByMaxVersion:!!r,enableChannelFeedItems:!!s,enableActivityTranslationInCDL:!!l,enableSharedChannelFeedItems:!!m,enableUrgentFeedItems:!!d,enableSyntheticNotificationProcessor:!!c,enableGraphFeedItems:!!u,disableIncomingPstnActivityFeed:!!g,enableMTMAMissedNotifications:!!p,mtmaNotificationsPollingInterval:h||$c.mtmaNotificationsPollingIntervalDefault,enableActivityFeedItemDeletion:!!v}}getActivityNotificationHostSettings(e){const{enableNewSettingsApiUse:t,enableMissedActivityEmails:n}=e.get(A.J.ActivityNotification);return{enableNewSettingsApiUse:!!t,enableMissedActivityEmails:!!n}}getPeopleHostSettings(e){const{enableBuddyListService:t,buddyListRefreshTimeoutInMilliSeconds:n,enableContactsSync:i,enableMultipleAliasesForContactsSync:a,maxNumberOfRoamingDevices:o,enableInstantSyncForRoamingDevices:r,fetchTFLContactsRefreshInterval:s,enableEndpointsManagerOnAcceptListService:l,enableEndpointsManagerOnBuddyService:d,enableEndpointsManagerOnBlockService:c,contactsSyncDeltaRefreshIntervalInMs:u,contactsSyncFullRefreshIntervalInMs:m,contactsSyncKeepAliveIntervalInMs:g,maxBatchSizeforSCDDeletion:p,lokiTokenResourceUrl:h,buddyServiceEndpointManagerMaxRetries:v,enableTflTfwFederation:S,enableProfilePicturesWithObjectId:f,enableMeProfileSyncStrategy:y,checkProfileExpiryAndRefreshIntervalInMs:k,enableTfwToTfwFederatedInviteFree:C,enableBlockedContactsDataStore:b,enableM365Endpoint:T,enableExtendedDirectory:w,enableCapiv3ContactsSync:_,enableProfileFetchFromWorkingSet:I}=e.get(A.J.People);return{enableBuddyListService:!!t,buddyListRefreshTimeoutInMilliSeconds:n||0,enableContactsSync:!!i,enableMultipleAliasesForContactsSync:!!a,maxNumberOfRoamingDevices:o||0,enableInstantSyncForRoamingDevices:!!r,fetchTFLContactsRefreshInterval:s||[],enableEndpointsManagerOnAcceptListService:!!l,enableEndpointsManagerOnBuddyService:!!d,enableEndpointsManagerOnBlockService:!!c,contactsSyncDeltaRefreshIntervalInMs:u||0,contactsSyncFullRefreshIntervalInMs:m||0,contactsSyncKeepAliveIntervalInMs:g||0,maxBatchSizeforSCDDeletion:p||0,lokiTokenResourceUrl:h||"",buddyServiceEndpointManagerMaxRetries:v||0,enableTflTfwFederation:!!S,enableProfilePicturesWithObjectId:!!f,enableMeProfileSyncStrategy:!!y,checkProfileExpiryAndRefreshIntervalInMs:k||0,enableTfwToTfwFederatedInviteFree:!!C,enableBlockedContactsDataStore:!!b,enableM365Endpoint:!!T,enableExtendedDirectory:!!w,enableCapiv3ContactsSync:!!_,enableProfileFetchFromWorkingSet:!!I}}getMessagingHostSettings(e){const{enableChatWithNonTflUsers:t,enableTflSmsCreate:n,enableTfwTflFederation:i,enableTfwFederationOnTfl:a,tflSmsAllowedPhoneNumberRegionCodes:o,enableTFLSmsFriendlyNameSearch:r,disableMessagingSyncEngine:s,disableRendererSideSanitization:l,enableAutoSendV2:d}=e.get(A.J.Messaging);return{enableChatWithNonTflUsers:!!t,enableTflSmsCreate:!!n,enableTfwTflFederation:!!i,enableTfwFederationOnTfl:!!a,enableTFLSmsFriendlyNameSearch:!!r,tflSmsAllowedPhoneNumberRegionCodes:o||[],disableMessagingSyncEngine:!!s,enableAutoSendV2:!!d,disableRendererSideSanitization:!!l}}getTeamsAndChannelsSettings(e){const{enablePinnedChannelsSyncEngine:t,maximumPinnedChannelLimit:n,pinnedChannelsSyncIntervalInMs:i,enableFixingPinnedChannelsConflict:a,enableUserResolutionForChannelModeratorList:o}=e.get(A.J.TeamsAndChannels);return{enablePinnedChannelsSyncEngine:!!t,maximumPinnedChannelLimit:n,pinnedChannelsSyncIntervalInMs:i,enableFixingPinnedChannelsConflict:!!a,enableUserResolutionForChannelModeratorList:!!o}}getCalendarHostSettings(e){const{autodiscoverSettings:t,calendarRESTEnabledAPIs:n,connectedCalendarSettingsRefreshIntervalInMs:i,enableCalendarSyncEngine:a,enableCalendarV2ApiService:o,enableCalendarV2ApiServiceEnterprise:r,enableClientStateCheckForCalendarPolling:s,enableMultipleCalendarSyncEngine:l,enableClientStateCheckForMultipleCalendarPolling:d,enableConnectedCalendar:c,enableConnectedCalendarSettingsSync:u,enableCourseCalendarSyncEngine:m,isOnCloud:g,maxRoomListsToFetch:p,maxRoomsInRoomListToFetch:h,maxRoomsToFetch:v,enableThirdPartyCalendar:S,calendarEventsPollIntervalInMs:f,isLmsCourseCalendar:y,enablePrefetchCalendarEventsOnStartUp:k,enablePrefetchCourseCalendarEventsOnStartUp:C,enableSensitivityLabelInCalendar:b,enableEventFetchOptimizationUsingLastSync:T,enableMeetingArtifactsCollaborationData:w,enableCalendarPushNotifications:_,enableCalendarPollingWithPushNotifications:I}=e.get(A.J.Calendar);return{autodiscoverSettings:t,calendarRESTEnabledAPIs:n,connectedCalendarSettingsRefreshIntervalInMs:i||0,enableCalendarSyncEngine:!!a,enableCalendarV2ApiService:!!o,enableCalendarV2ApiServiceEnterprise:!!r,enableClientStateCheckForCalendarPolling:!!s,enableClientStateCheckForMultipleCalendarPolling:!!d,enableMultipleCalendarSyncEngine:!!l,enableConnectedCalendar:!!c,enableConnectedCalendarSettingsSync:!!u,enableCourseCalendarSyncEngine:m,enableEventFetchOptimizationUsingLastSync:T,enableMeetingArtifactsCollaborationData:w,enablePrefetchCourseCalendarEventsOnStartUp:C,isOnCloud:g,maxRoomListsToFetch:p,maxRoomsInRoomListToFetch:h,maxRoomsToFetch:v,enableThirdPartyCalendar:!!S,calendarEventsPollIntervalInMs:f,isLmsCourseCalendar:!!y,enablePrefetchCalendarEventsOnStartUp:!!k,enableSensitivityLabelInCalendar:!!b,enableCalendarPushNotifications:!!_,enableCalendarPollingWithPushNotifications:!!I}}getExternalAccountSettings(e){const{enableExternalAccounts:t,requestSource:n,enableUnifiedHardDelete:i}=e.get(A.J.ExternalAccounts);return{enableExternalAccounts:!!t,requestSource:n,enableUnifiedHardDelete:!!i}}getEndpointsHealthHostSettings(e){const{enableWorkerEndpointsHealthMonitor:t,enableWorkerEndpointsHealthService:n}=e.get(A.J.Core);return{enableWorkerEndpointsHealthMonitor:!!t,enableWorkerEndpointsHealthService:!!n}}getDataStoreHostSettings(e){const{enableDbOpenTimeout:t,dbOpenTimeoutLengthSeconds:n,dataStoreMapType:i,disableDataStoreInMemoryProvider:a,disableDataStoreDbProvider:o,disableReplyChainManagerPrefetch:r,dataStoreCreationResiliencyConfig:s,dataStoreDbOperationResiliencyConfig:l,rollbackSupportInDataStoreInMemoryProvider:d}=e.get(A.J.CdlWorker);return{enableDbOpenTimeout:!!t,dbOpenTimeoutLengthSeconds:n||60,dataStoreMapType:i||"",disableDataStoreInMemoryProvider:!!a,disableDataStoreDbProvider:!!o,rollbackSupportInDataStoreInMemoryProvider:!!d,disableReplyChainManagerPrefetch:!!r,dataStoreCreationResiliencyConfig:s||{enable:!1},dataStoreDbOperationResiliencyConfig:l}}getCoreSettingsTestOverrides(e){const t=e;return{localStorageTestOverrides:t.getLocalStorageTestOverrides()||{},qspTestOverrides:t.getQspTestOverrides()||{}}}getFilesHostSettings(e){const{preferGraphOverVroom:t,vroomEndpointBaseUrl:n,graphEndpointBaseUrl:i,graphAuthScope:a,vroomAuthScope:o}=e.get(A.J.Files);return{filesOverrides:{preferGraphOverVroom:!!t,vroomEndpointBaseUrl:n||"",graphEndpointBaseUrl:i||"",graphAuthScope:a||"",vroomAuthScope:o||""}}}getDiscoverSurfaceHostSettings(e){const{discoverSurfaceDefaultSection:t,discoverSurfaceTopItemsCount:n,enableDiscoverSurfaceDebugMenu:i,enableHybridDiscoverSurface:a,enableDiscoverBadging:o,dataSyncIntervalTime:r,enableDiscoverSurfaceSyncEngine:s}=e.get(A.J.DiscoverSurface);return{enableHybridDiscoverSurface:!!a,discoverSurfaceTopItemsCount:n||Hc.$.defaultItemsToFetch,discoverSurfaceDefaultSection:t||Hc.$.defaultSection,enableDiscoverSurfaceDebugMenu:!!i,enableDiscoverBadging:!!o,dataSyncIntervalTime:r||Hc.$.defaultDataSyncIntervalTime,enableDiscoverSurfaceSyncEngine:!!s}}getMtmaSpecificHostSettings(){const{enableMTMA:e}=this.coreSettings.get(A.J.Core);return e&&this.primaryUser&&this.primaryUser.profile?{primaryUserProfile:{oid:this.primaryUser.profile.objectId,tid:this.primaryUser.profile.tenantId}}:{}}isMessagingNotificationsOverTrouterEnabled(){const e=this.coreSettings.get(A.J.Host).enableMessagingNotificationsOverTrouter;return(0,Z.isNil)(e)?!!this.coreSettings.get(A.J.CdlWorker).enableMessagingNotificationsOverTrouter:e}getGuardiansHostSettings(e){const{enableGuardiansPreferredMethodAndSmsInvite:t}=e.get(A.J.Guardians);return{enableGuardiansPreferredMethodAndSmsInvite:t}}}$c.mtmaNotificationsPollingIntervalDefault=3e5;class zc{constructor(){this.perfDataByOperationName=new Map,this.cdlSubscriptionAggregatorAllowList=[]}static getInstance(){return this.subscriptionEventAggregatorSingleton||(this.subscriptionEventAggregatorSingleton=new zc),this.subscriptionEventAggregatorSingleton}init(e,t,n=[]){var i;this.logger=e.newLogger("SubscriptionEventAggregator"),this.cdlSubscriptionAggregatorAllowList=(0,Z.union)(n,this.cdlSubscriptionAggregatorAllowList),null===(i=this.logger)||void 0===i||i.log(`Initialized CDLSubscriptionEventAggregator Allow List: ${this.cdlSubscriptionAggregatorAllowList.join(",")}`),this.intervalCancellationToken=setInterval((()=>{this.logStats(t)}),ne.A_)}addToTimeline(e,t,n,i,a,o){if(this.intervalCancellationToken||this.init(n,i,a),!t)return void(this.logger&&this.logger.log("Received subscription perf stat without responseSendTime. Ignoring."));const r=Date.now()-t;if(!(r<0)&&(e&&!this.perfDataByOperationName.has(e)&&this.perfDataByOperationName.set(e,{ipcTimes:[],customIdentifierCount:{}}),e)){const t=this.perfDataByOperationName.get(e);if(!t)return void(this.logger&&this.logger.warn(`SubscriptionEventAggregator: No perf data found for operationName ${e}`));if(t.ipcTimes.push(r),o){let e={};e="string"==typeof o?{[o]:1}:o,Object.keys(e).forEach((n=>{const i=e[n];t.customIdentifierCount[n]||(t.customIdentifierCount[n]=0),t.customIdentifierCount[n]+=i}))}}}logStats(e){const t=Array.from(this.perfDataByOperationName.entries());this.perfDataByOperationName.clear();for(const[n,i]of t){if(!this.cdlSubscriptionAggregatorAllowList.includes(n))continue;const t={operationName:n,numberOfRequests:i.ipcTimes.length,averageIPCTimeOneWay:i.ipcTimes.reduce(((e,t)=>e+t),0)/i.ipcTimes.length},a=e.newScenario(ee.RG.CentralDataLayerSubscription);(0,Z.keys)(i.customIdentifierCount).forEach((e=>{a.mark(e,{size:i.customIdentifierCount[e],type:e})})),a.stop(t)}}}function qc(e,t,n,i,a){var o,r;let s;if(function(e,t,n){return!e.some((e=>{var i,a;const o=t.getEntriesByName(e);return null===(i=n.infoToTelemetry)||void 0===i||i.call(n,`Marker performance information ${e}!`,"telemetry_instrumentation_capture_perf_measurement",void 0,!1),o.length<=0&&(null===(a=n.errorToTelemetry)||void 0===a||a.call(n,`Measure ${e} was never created!`,"telemetry_instrumentation_capture_perf_measurement",void 0,!0),!0)}))}([t,n],i,a))try{i.measure(e,t,n);const a=i.getEntriesByName(e)[0];s=null==a?void 0:a.duration,s&&(s=Math.round(s)),i.clearMeasures(e)}catch(e){null===(o=a.errorToTelemetry)||void 0===o||o.call(a,`Failed to capture measurement between ${t} and ${n}: ${e}`,"telemetry_instrumentation_capture_perf_measurement",void 0,!0)}else null===(r=a.errorToTelemetry)||void 0===r||r.call(a,`Can not capture measurement between ${t} and ${n}, at least one of them not exist`,"telemetry_instrumentation_capture_perf_measurement",void 0,!0);return s}function Jc(e,t,n,i){e.measure(t,n,i),e.clearMeasures(t),e.clearMarks(n),i&&e.clearMarks(i)}class Qc{constructor(e,t,n){this.isResponse=t,this.internalPerfStat={operationName:n,requestStartTime:{perf:performance.now(),date:Date.now()},responseReceivedTime:{perf:performance.now(),date:Date.now()},workerResponseTime:0,dataStorePerfStats:[]},this.operationName=n||"",this.operationType=e,performance.mark(`${this.getPerformanceName()}-start`)}stopMeasurement(e,t,n){this.internalPerfStat=Object.assign(Object.assign(Object.assign({},this.internalPerfStat),e),{responseReceivedTime:{perf:performance.now(),date:Date.now()}});const i=this.getPerformanceName(),a=`${i}-start`,o=`${i}-end`;!function(e,t){void 0===function(e,t){const n=t.getEntriesByName(e);if(n&&n.length>0)return n[0]}(e,t)&&t.mark(e)}(a,performance),performance.mark(o),Jc(performance,i,a,o);const{requestStartTime:r,requestReceivedTime:s,responseSendTime:l,responseReceivedTime:d,workerResponseTime:c}=this.internalPerfStat,u={totalRequestTime:Math.round(d.perf-r.perf),workerResponseTime:Math.round(c),requestTime:Math.round(r.perf),responseTime:Math.round(d.perf)};return(null==t?void 0:t.length)&&(u.otherResponsesReceivedWhileInTransit=t),n&&(u.responseReceiveLatency=n),s&&(u.requestIPCTime=s-r.date),l&&(u.responseIPCTime=d.date-l),u}static markSubscriptionRequest(e){const t=`subscription_request_start_${e}`,n=`subscription_request_${e}`;performance.mark(t),Jc(performance,n,t)}static addSubscriptionResponse(e,t,n,i,a,o){zc.getInstance().addToTimeline(e,t,n,i,o||[],a)}getPerformanceName(){return`cdl-${this.isResponse?"response":"request"}-${this.operationName||this.operationType}`}}const Kc=["callParticipantsVoiceLevelsChangedEvent","callParticipantsChangedEvent"],Yc=["callingIntent","chat","messageList"],Xc=["putConversations"],Zc="debug";class eu{constructor(e,t,n,i,a,o,r,s,l,d,c=[],u,m,g,p,h,v){var S;if(this._logger=a,this.loggerFactory=o,this.scenarioFactory=r,this.syncEngineInitializationPromise=s,this.rendererId=l,this.requestHealthMonitor=u,this.enableClassBasedErrors=m,this.splitFetchWaitMarkerInWLT=h,this.dataLayerClientSettings=v,this._perfStats=null,this._perfStatsForResponseProcessing=null,this._scenario=void 0,this._requestId=e,this._windowId=d,this._requestType=t,"subscription"!==t?this._perfStats=new Qc(t,!1,i):Qc.markSubscriptionRequest(i),this._requestComplete=!1,this._operationName=i,this._loggingContext={requestId:e,component:"RequestHandler",requestRendererId:this.rendererId,requestWindowId:this.windowId,hostRendererId:n,operationType:t,operationName:i},c=c&&c.length?c:Xc,this.subject=new Ed(this._logger,this._loggingContext),this.logRequest(),i&&!c.includes(i)&&"subscription"!==t){this._scenario=this.scenarioFactory.newScenario(ee.RG.CentralDataLayerRequest),this._scenario.clientName=i;const e=this.getActiveCPM();if(this._scenario.appendEventData({operationName:i,operationType:t,context:this.rendererId,"Panel.WindowID":this.windowId,target:g,correlationId:null==p?void 0:p.callerScenarioId,origin:null==p?void 0:p.callerInfo,activeCPM:e}),this.isRequestFromWindowLaunch(i,r)){r.startStep(ee.RG.WindowLaunchTime,ee.ck.FetchWait);const e=this.scenarioFactory.findScenario(ee.RG.WindowLaunchTime);this._wltTimestampsAtInit=null==e?void 0:e.timestamps.length}}null===(S=this.requestHealthMonitor)||void 0===S||S.requestCreated(this)}get requestId(){return this._requestId}get windowId(){return this._windowId}get response(){return this.subject.observable}get requestType(){return this._requestType}get operationName(){return this._operationName}isComplete(){return this._requestComplete}setResponseAndEndScenario(e,t,n){var i,a,o;const r=!e.errors&&e.data;this._otherResponsesReceivedWhileInTransit=t,this._responseReceiveLatency=n,r?(this._perfStatsForResponseProcessing=new Qc(this.requestType,!0,this.operationName),this.onSuccess(e)):this.onError(e),this.onComplete(r?"success":"error"),r&&(null===(i=e.extensions)||void 0===i?void 0:i.perfStats)&&(null===(a=this._perfStatsForResponseProcessing)||void 0===a||a.stopMeasurement(null===(o=e.extensions)||void 0===o?void 0:o.perfStats,t,n))}cancel(){this._requestComplete||(this._requestComplete=!0,this._scenario&&this._scenario.incomplete(),this.onComplete("cancelled"))}onComplete(e){var t;this._requestComplete&&(this.subject.onComplete(),null===(t=this.requestHealthMonitor)||void 0===t||t.requestCompleted(this,e))}onSuccess(e){this.mergeAndEndStatsSnapshot(e.extensions),this.logResponse(),this.subject.onNext(e)}onError(e){var t;this._requestComplete=!0;const n=(null==e?void 0:e.errors)||"Unexpected: data layer query response missing both data and error",i=Array.isArray(n)?n.map((e=>(0,he.VK)(e))).join():(0,he.VK)(n);if(this.mergeAndEndStatsSnapshot(e.extensions,i),this.enableClassBasedErrors)this.subject.onNext(e);else{let n=e.errorCode;!n&&(null===(t=e.errors)||void 0===t?void 0:t.length)&&(n=e.errors[0].name||_.jK.RemoteOperationFailed),n||(n=_.jK.InvalidResponse);const a=(0,he.Tr)(_.w5.DataLayerClient,n,"onError",void 0,i);this._logger.error(`error while processing ${this._requestId}: ${a.message} (reason: ${a.reason})`,this._loggingContext,n),this.subject.onError(a)}}mergeAndEndStatsSnapshot(e,t){var n,i,a;let o;e&&e.perfStats&&(this._perfStats&&(o=this._perfStats.stopMeasurement(e.perfStats,this._otherResponsesReceivedWhileInTransit,this._responseReceiveLatency)),"subscription"===this.requestType&&Qc.addSubscriptionResponse(this.operationName,e.perfStats.responseSendTime,this.loggerFactory,this.scenarioFactory,e.subscriptionCustomIdentifier,null===(n=this.dataLayerClientSettings)||void 0===n?void 0:n.cdlSubscriptionAggregatorAllowList)),e&&(null===(i=this._scenario)||void 0===i||i.appendEventData({dataSource:e.dataSource,size:null===(a=e.perfStats)||void 0===a?void 0:a.payloadLength})),this._scenario&&(t?this.syncEngineInitializationPromise.then((e=>{var n,i,a;null===(n=this._scenario)||void 0===n||n.appendEventData(Object.assign(Object.assign({},o),{errors:(0,me.A)(t)})),e?null===(i=this._scenario)||void 0===i||i.fail():null===(a=this._scenario)||void 0===a||a.incomplete()})):(this._scenario.stop(o),this.isRequestFromWindowLaunch(this.operationName,this.scenarioFactory)&&this.createWltSteps(o)))}logResponse(){this._logger[this.getLogLevel()]("Received response data for request",this._loggingContext)}createWltSteps(e){const t=this.scenarioFactory.findScenario(ee.RG.WindowLaunchTime);if(t&&t.currentStep!==ee.ck.FetchProcessResponse){if(e){const{requestIPCTime:n,responseIPCTime:i,workerResponseTime:a}=e;if(n&&i&&this.splitFetchWaitMarkerInWLT){if(this._wltTimestampsAtInit&&t.timestamps.length>this._wltTimestampsAtInit)return;t.mark(ee.ck.FetchWaitRequestIPC,{offsetCurrentTimeInMs:Math.round(a)+i}),t.mark(ee.ck.FetchWaitWorker,{offsetCurrentTimeInMs:i}),t.mark(ee.ck.FetchWaitResponseIPC)}else t.mark(ee.ck.FetchWaitIPC,{offsetCurrentTimeInMs:Math.round(a)}),t.mark(ee.ck.FetchWaitWorker)}t.startStep(ee.ck.FetchProcessResponse)}}isRequestFromWindowLaunch(e,t){return!!t.findScenario(ee.RG.WindowLaunchTime)&&Yc.indexOf(e)>-1}logRequest(){this._logger.debug("Created new request",this._loggingContext)}getLogLevel(){var e;return Kc.indexOf(null!==(e=this._loggingContext.operationName)&&void 0!==e?e:"")>=0?Zc:"log"}getActiveCPM(){const e=[ee.RG.ChatSwitch,ee.RG.ChannelSwitchL1,ee.RG.ChannelSwitchL2,ee.RG.ChannelL1Deeplink,ee.RG.ChannelL2Deeplink,ee.RG.ActivitySwitch,ee.RG.ApplicationLaunchTime,ee.RG.WindowLaunchTime];if(this.scenarioFactory.doesScenariosExist){const t=this.scenarioFactory.doesScenariosExist(e);if(t.length)return t.join(",")}}}class tu extends eu{onSuccess(e){super.onSuccess(e),this._requestComplete=!0}}class nu extends eu{onSuccess(e){super.onSuccess(e),this._requestComplete=!0}}class iu extends eu{onSuccess(e){super.onSuccess(e)}}var au=n(73491);class ou{constructor(e,t,n,i,a){this.config=t,this.timeoutProvider=n,this.syncEngineInitializationPromise=i,this.dataLayerTarget=a,this.isRequestInProcess=!1,this.requestTimer=null,this.openRequests=new Map,this.timedOutDistinctRequestCount=0,this.failedDistinctRequestCount=0,this.timedOutOperationNames=new Set,this.failedOperationNames=new Set,this.lastSucceededRequest=this.firstTimedOutRequest=ou.DefaultRequestLoggingData,this.logger=e.newLogger("RequestHealthMonitor")}requestCreated(e){if(!this.shouldMonitor(e))return;let t;null!==this.requestTimer||this.isRequestInProcess?t=!1:(this.startTimer(),t=!0),this.openRequests.set(e.requestId,{operationName:e.operationName,shouldTimeout:t,timeAdded:Date.now()})}requestCompleted(e,t){if(!this.shouldMonitor(e))return;this.openRequests.delete(e.requestId)||this.logger.warn(`Unknown request completed. Possibly timed out. RequestId ${e.requestId}, OperationName ${e.operationName}, Target ${this.dataLayerTarget}.`),0===this.openRequests.size&&null!==this.requestTimer&&this.clearTimer(),"success"===t&&this.onSuccess(e),"error"===t&&this.onError(e)}onSuccess(e){this.lastSucceededRequest={requestId:e.requestId,operationName:e.operationName},this.timedOutDistinctRequestCount=0,this.failedDistinctRequestCount=0,this.timedOutOperationNames.clear(),this.failedOperationNames.clear(),this.firstTimedOutRequest=ou.DefaultRequestLoggingData}onError(e){this.failedOperationNames.has(e.operationName)||(this.failedDistinctRequestCount++,this.failedOperationNames.add(e.operationName),this.failedDistinctRequestCount===this.failureCountThreshold&&this.indicateTargetUnhealthy("error"))}onTimeout(){let e=ou.DefaultRequestLoggingData,t=Number.MAX_SAFE_INTEGER;this.openRequests.forEach(((n,i)=>{if(n.shouldTimeout){const a=n.operationName;n.timeAdded<t&&(t=n.timeAdded,e={operationName:a,requestId:i}),this.logger.warn(`Request reached time out in health monitor. RequestId ${i}, OperationName ${a}, Target ${this.dataLayerTarget}.`),this.openRequests.delete(i),this.timedOutOperationNames.has(a)||(this.timedOutDistinctRequestCount++,this.timedOutOperationNames.add(a),this.timedOutDistinctRequestCount===this.timedOutCountThreshold&&this.indicateTargetUnhealthy("timedOut"))}else n.shouldTimeout=!0})),this.firstTimedOutRequest===ou.DefaultRequestLoggingData&&(this.firstTimedOutRequest=e),this.requestTimer=null,this.isRequestInProcess=!1,this.openRequests.size>0&&this.startTimer()}startTimer(){null!==this.requestTimer&&(this.logger.warn(`Health monitor timer already running when attempting to start new. Clearing old timer. Target ${this.dataLayerTarget}.`),this.timeoutProvider.clearTimeout(this.requestTimer)),this.isRequestInProcess=!0,this.syncEngineInitializationPromise.then((e=>{e&&(this.requestTimer=this.timeoutProvider.setTimeout((()=>this.onTimeout()),this.timeOutLengthMs))}))}clearTimer(){null!==this.requestTimer?(this.timeoutProvider.clearTimeout(this.requestTimer),this.requestTimer=null,this.isRequestInProcess=!1):this.logger.warn(`Health monitor timer tried to cancel non-existent timer. Ignoring. Target ${this.dataLayerTarget}.`)}indicateTargetUnhealthy(e){var t,n;let i="error"===e?`ErrorCount: ${this.failureCountThreshold}.`:`TimedOutCount: ${this.timedOutCountThreshold}. TimeOutMs: ${this.timeOutLengthMs}.`;this.config.memoryMapType&&(i=`${i} MemoryMapType: ${this.config.memoryMapType}.`);const a=`Last succeeded operation: ${this.lastSucceededRequest.operationName}, ${this.lastSucceededRequest.requestId}.`,o=`First timeout operation: ${this.firstTimedOutRequest.operationName}, ${this.firstTimedOutRequest.requestId}`,r=`RequestHealthMonitor: DataLayer is unhealthy due to successive requests failing with ${e}. Target: ${this.dataLayerTarget}. ${i} ${a} ${o}`;this.logger.error(r),null===(n=(t=this.config).unhealthyDataLayerCallback)||void 0===n||n.call(t,r)}shouldMonitor(e){return"subscription"!==e.requestType}get failureCountThreshold(){return this.config.failureCountThreshold||ou.DefaultFailureCountThreshold}get timeOutLengthMs(){return(this.config.timeoutLengthSeconds||ou.DefaultTimeoutLengthSeconds)*ne.NO}get timedOutCountThreshold(){return this.config.timeoutCountThreshold||ou.DefaultTimeoutCountThreshold}}ou.DefaultFailureCountThreshold=5,ou.DefaultTimeoutCountThreshold=5,ou.DefaultTimeoutLengthSeconds=60,ou.DefaultRequestLoggingData={operationName:"na",requestId:"na"};class ru{constructor(e,t,n,i,a,o,r,s,l,d,c,u,m){var g;this.logger=e,this.scenarioFactory=n,this.syncEngineInitializationPromise=a,this.leakDetectorService=o,this.dataLayerCommunicatorTarget=r,this.timeoutProvider=s,this.enableClassBasedErrors=d,this.trackingOperationsDuringWaitConfig=c,this.dataClientTrackingService=u,this.dataLayerClientSettings=m,this.requestMap=new Map,this.recentlyCancelledRequests=new Map,this.loggingContext={hostRendererId:t,component:"RequestRegistrar"},this.leakDetector=null===(g=this.leakDetectorService)||void 0===g?void 0:g.create(),l&&l.enableRequestHealthMonitor&&s&&(this.requestHealthMonitor=new ou(i,l,s,this.syncEngineInitializationPromise,r))}createRequest(e,t,n,i,a,o,r,s){var l;const d=class{static createDataLayerRequest(e,t,n,i,a,o,r,s,l,d,c,u,m,g,p,h){const v=[e,t,n,i,a,o,r,s,l,d,void 0,c,u,m,g,p,h];switch(t){case"mutation":return new tu(...v);case"query":return new nu(...v);case"subscription":return new iu(...v)}}}.createDataLayerRequest(e,t,this.loggingContext.hostRendererId,n,this.logger,i,this.scenarioFactory,this.syncEngineInitializationPromise,a,o,this.requestHealthMonitor,this.enableClassBasedErrors,this.dataLayerCommunicatorTarget,r,s,this.dataLayerClientSettings);return null===(l=this.leakDetector)||void 0===l||l.track(`Request-${d.requestType}-${n}`,d),this.requestMap.set(e,d),au.Q.Instance.processRequest(t,n,e),d}reconcileResponse(e,t){var n,i,a,o,r;const s=this.requestMap.get(e),l=t.data?t.data&&Object.keys(t.data).toString():"";if(this.recentlyCancelledRequests.has(e))return void this.logger.log(`Received response to a requestId that was recently cancelled. RequestId: ${e}. OperationNameHints: ${l}.`,this.loggingContext);if(!s)return void(null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,`Received response to a requestId that cannot be found in the map. operationName ${l}`,"cdl_request",{operationName:l,windowId:t.windowId,callId:t.requestId,contextId:t.rendererId,target:this.dataLayerCommunicatorTarget},!0));const d=t.extensions&&t.extensions.perfStats;let c,u;if(d||this.logger.warn(`Received response without perfStats for request. RequestId: ${e} RendererId: ${t.rendererId}, WindowId: ${t.windowId}, Target ${this.dataLayerCommunicatorTarget}`,this.loggingContext),(null===(a=this.trackingOperationsDuringWaitConfig)||void 0===a?void 0:a.enableTrackingCdlOperationsDuringWait)&&d&&d.responseSendTime){this.markResponse(s);const e=d.responseSendTime,t=Date.now();if(u=t-e,u>((null===(o=this.trackingOperationsDuringWaitConfig)||void 0===o?void 0:o.trackingCdlOperationsDuringWaitThresholdInMs)||100)){c=this.getResponsesBetweenStartAndLast(e);const n=null==c?void 0:c.reduce(((e,t)=>{const n=e.find((e=>(null==e?void 0:e.name)===t));return n?n.count++:e.push({name:t,count:1}),e}),[]);(null===(r=this.trackingOperationsDuringWaitConfig)||void 0===r?void 0:r.enableLoggingCdlOperationsDuringWait)&&this.logger.log(`${null==s?void 0:s.operationName}, sendtime: ${e}, receivetime: ${t}, latency: ${t-e}, responses received between send and receive: ${JSON.stringify(n)}`,this.loggingContext)}}const m=d;s.setResponseAndEndScenario(t,c,u),s.isComplete()&&(this.requestMap.delete(e),au.Q.Instance.processResponse(e,m&&m.workerResponseTime))}cancelRequest({requestId:e,rendererId:t,windowId:n}){const i=this.requestMap.get(e);i?(i.cancel(),this.requestMap.delete(e),this.recentlyCancelledRequests.set(e,(new Date).getTime()),this.scheduleCancelledRequestsMapCleanup()):this.logger.debug(`Nothing to cancel, request no longer in map. RequestId: ${e} RendererId: ${t}, WindowId: ${n}, Target ${this.dataLayerCommunicatorTarget}`,this.loggingContext)}scheduleCancelledRequestsMapCleanup(){var e;if(!this.recentlyCancelledRequestsTimer){const t=2,n=(new Date).getTime();this.recentlyCancelledRequestsTimer=null===(e=this.timeoutProvider)||void 0===e?void 0:e.setTimeout((()=>this.cleanRecentlyCancelledRequestsMap(n)),t*ne.A_)}}cleanRecentlyCancelledRequestsMap(e){this.recentlyCancelledRequests.forEach(((t,n)=>{t<e&&this.recentlyCancelledRequests.delete(n)})),this.recentlyCancelledRequestsTimer=void 0}markResponse(e){var t;null===(t=this.dataClientTrackingService)||void 0===t||t.markResponse(e.operationName)}getResponsesBetweenStartAndLast(e){var t;return(null===(t=this.dataClientTrackingService)||void 0===t?void 0:t.getResponsesBetweenStartAndLast(e))||[]}}var su,lu,du=n(9458),cu=n(96758);class uu{constructor(e,t,n,i,a,o,r,s,l=!1,d=Promise.resolve(!0),c,u,m,g){this.hostRendererId=e,this.loggerFactory=t,this.scenarioFactory=n,this.dataLayerCommunicator=i,this.leakDetectorService=a,this.splitFetchWaitMarkerInWLT=m,this.loggingContext={component:"DataLayerClient",hostRendererId:e},this.logger=new Cd(t.newLogger("CDL")),this.logger.log("logger created for renderer",this.loggingContext),this.dataLayerCommunicator.onMessage=this.onMessageReceived.bind(this),this.requestRegistrar=new ru(this.logger,e,this.scenarioFactory,this.loggerFactory,d,this.leakDetectorService,o,r,s,l,c,u,g),this.requestId=new Od("graphql")}execute(e,t,n,i,a,o){const r=(0,du.S)(e,n),s=r&&r.operation||"query",l=this.requestId.next(s),d=this.requestRegistrar.createRequest(l,s,n||s,this.loggerFactory,i,a,o,this.splitFetchWaitMarkerInWLT);this.logger.log("executing graphql request to data layer",Object.assign(Object.assign({requestId:d.requestId},this.loggingContext),{operationType:s,operationName:n,hostRendererId:this.hostRendererId,requestRendererId:i,requestWindowId:a})),this.dataLayerCommunicator.sendMessage({requestId:l,windowId:a,rendererId:this.hostRendererId,request:{graphqlQuery:(0,cu.S)(e),variables:t},cdlOperationCustomContext:o,operationName:n});return function(e,t){const n=e.subscribe;return e.subscribe=i=>{const a=n.call(e,i),o=a.unsubscribe;return a.unsubscribe=()=>(t(),o.call(a)),a},e}(d.response,this.onUnsubscribe(d,n))}onUnsubscribe(e,t){return()=>{e.isComplete()||(this.logger.log("Notifying server of unsubscription",Object.assign(Object.assign({},this.loggingContext),{requestId:e.requestId,requestType:Bd,operationName:t})),this.dataLayerCommunicator.sendMessage({requestId:e.requestId,rendererId:this.hostRendererId,windowId:e.windowId,request:{graphqlQuery:Bd,variables:void 0},operationName:t}),this.requestRegistrar.cancelRequest({requestId:e.requestId,rendererId:this.hostRendererId,windowId:e.windowId}))}}onMessageReceived(e){this.requestRegistrar.reconcileResponse(e.requestId,e)}}class mu{constructor(e,t,n,i,a,o,r,s,l,d,c,u,m,g,p,h,v,S,f){this.host=e,this.config=t,this.loggerFactory=i,this.scenarioFactory=a,this.coreSettings=o,this.dataClientTrackingService=S,this.isDisposed=!1,this.logger=i.newLogger("DataClientCoreCDLWorkerService"),this.cdlWorkerHostSettingsAggregator=new $c(n,o,r,i,d,m,g),this.cdlWorkerManagerInitializationPromise=Mc(e,t,this.cdlWorkerHostSettingsAggregator,i,a,o,s,l,d,this.logger,p,h,v,g,f);if(jc(d,o,a,e,this.logger)){this.cdlWorkerStateSender=new Gc(c,u,i,this);const{disableCDLWorkerHostSettingsUpdates:e}=o.get(A.J.Core);e||this.startNotifyingCDLWorkerForHostSettingsChanges()}}getCDLWorkerManager(){return this.cdlWorkerManagerInitializationPromise}getDataLayerClient(){return(0,c.mG)(this,void 0,void 0,(function*(){if(!this.dataLayerClient){const e=yield this.getCDLWorkerManagerOrThrow("getDataLayerClient"),t=this.coreSettings.get(A.J.CdlWorker),{logCdlOperationsDuringWaitSettings:n}=this.coreSettings.get(A.J.Core),{cdlSubscriptionAggregatorAllowList:i}=this.coreSettings.get(A.J.Sync);this.dataLayerClient=new uu(this.config.clientId,this.loggerFactory,this.scenarioFactory,e.workerClientResponseRouter.cdlGraphQLClient,void 0,"Worker",this.host,{enableRequestHealthMonitor:!!t.enableRequestHealthMonitor,failureCountThreshold:t.requestHealthMonitorFailureCountThreshold,timeoutCountThreshold:t.requestHealthMonitorTimeoutCountThreshold,timeoutLengthSeconds:t.requestHealthMonitorTimeoutLengthSeconds,memoryMapType:Uc(this.coreSettings)},!!t.enableClassBasedErrors,e.syncEngineInitializationPromise,{enableLoggingCdlOperationsDuringWait:null==n?void 0:n.enableLoggingCdlOperationsDuringWait,enableTrackingCdlOperationsDuringWait:null==n?void 0:n.enableTrackingCdlOperationsDuringWait,trackingCdlOperationsDuringWaitThresholdInMs:null==n?void 0:n.trackingCdlOperationsDuringWaitThresholdInMs},this.dataClientTrackingService,!!t.splitFetchWaitMarkerInWLT,{cdlSubscriptionAggregatorAllowList:i||[]})}return this.dataLayerClient}))}getControlPlaneCommunicator(){return(0,c.mG)(this,void 0,void 0,(function*(){if(!this.controlPlaneCommunicator){const e=yield this.getCDLWorkerManagerOrThrow("getControlPlaneCommunicator");this.controlPlaneCommunicator=new Vc(e.workerClientResponseRouter,{loggerFactory:this.loggerFactory})}return this.controlPlaneCommunicator}))}dispose(){this.cdlWorkerStateSender&&this.cdlWorkerStateSender.dispose(),this.isDisposed=!0}logoutCurrentUser(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=e.get(A.J.CdlWorker).maxLogoutTime||5e3;if(this.isDisposed)return void this.logger.warn("Unable to cleanup CDL Worker: Already disposed.");const n=yield this.getCDLWorkerManager();if(n)try{yield(0,Oe.E)(n.workerClientResponseRouter.cdlSyncEngineClient.sendRequest({type:"logout",subType:"",params:void 0}),t,`logout request to CDL worker timed out after ${t} ms`)}catch(e){this.logger.error(`Failed to cleanup CDL Worker on logout. ${e&&e.code===_.jK.TimedOut?e.message:""}`)}else this.logger.warn("Unable to cleanup CDL Worker: Worker manager not available.")}))}getDebugService(){return(0,c.mG)(this,void 0,void 0,(function*(){if(!this.debugService){const{DataClientCoreCDLWorkerDebugService:e}=yield n.e(3194).then(n.bind(n,16493));this.debugService=new e(this.loggerFactory,this)}return this.debugService}))}startNotifyingCDLWorkerForHostSettingsChanges(){return(0,c.mG)(this,void 0,void 0,(function*(){let e;try{e=yield this.getCDLWorkerManager()}catch(e){return void this.logger.error(`Unable to start notifying CDL Worker for host settings changes: getCDLWorkerManager failed: ${e.message}.`)}e?(this.cdlWorkerHostSettingsAggregator.startNotifyingCDLWorkerForHostSettingsChanges(e.workerClientResponseRouter.cdlControlClient),this.logger.log("Start notifying CDL Worker for host settings changes.")):this.logger.log("Unable to start notifying CDL Worker for host settings changes: Worker manager not available.")}))}getCDLWorkerManagerOrThrow(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=yield this.getCDLWorkerManager();if(!t)throw(0,he.Tr)(mu.ComponentName,_.jK.NotInitialized,e,void 0,"Worker manager is not initialized");return t}))}}mu.ComponentName="DataClientCoreCDLWorkerService",function(e){e.Messaging="messaging_logs",e.AllConversations="all_conversations_logs",e.Policies="policies_logs",e.PoliciesSettings="policies_settings_logs",e.Calendar="calendar_logs",e.CourseCalendar="course_calendar_logs",e.Esp="esp_logs",e.UserPreferences="user_preferences_logs",e.OfflineActions="offline_actions_manager_logs",e.PinnedChannels="pinned_channels_logs",e.People="people_logs",e.Presence="presence_logs",e.AppsPlatform="apps_platform_logs",e.NoLog="no_logs",e.Activities="activities_logs",e.ConnectedCalendar="connected_calendar_logs",e.MfuContacts="mfu_contacts_logs",e.Guardians="guardians_logs",e.ChannelInfoPane="channel-info-pane",e.Tenant="tenant_logs",e.WhatsNew="whats_new_logs",e.MTMAAggregator="mtma_aggregator",e.Diagnostics="diagnostics_logs",e.SensitivityLabel="sensitivity-label",e.CapiV3Contacts="capiv3_contacts_logs",e.RecommendedTeams="recommended-teams",e.TflMeetingLinks="tflmeetingLinks"}(su||(su={}));class gu{constructor(e,t,n,i){this.cdlWorkerManager=e,this.logger=t,this.authenticationService=n,this.cacheStorage=i,this.logsProviderName="CdlWorkerLogsProvider"}getLogsFiles(e){return(0,c.mG)(this,void 0,void 0,(function*(){let t;const n=this.getWorkerDiagnosticsLogsFromCdlWorkerManager(),i=this.getVerboseWorkerLogs(this.cdlWorkerManager.workerType),a=yield this.authenticationService.getUser();if(a&&a.isAuthenticated)t=this.getSyncEngineLogsFromCdlWorkerManager();else{const e="Sync logs cannot be retrieved for unauthenticated users.";t=Promise.resolve([{isPiiFree:!0,fileName:"sync-failure-logs.txt",content:e}]),this.logger.warn(e)}const o=yield n;return[{isPiiFree:!o.diagnosticsEvents||!!e,fileName:"cdl-worker-diagnostics-logs.txt",content:o.diagnosticsEvents?O(e?o.diagnosticsEvents.filter((e=>e.isPiiFree)):o.diagnosticsEvents):"No logs found"},{isPiiFree:!0,fileName:"cdl-worker-settings.json",content:o.coreSettingsSnapshot},...yield t,...yield i]}))}getSystemInfo(){return(0,c.mG)(this,void 0,void 0,(function*(){return new Map}))}getVerboseWorkerLogs(e){return(0,c.mG)(this,void 0,void 0,(function*(){if(this.cacheStorage){const t=new Fc(this.cacheStorage,this.logger),n=yield t.getWorkerVerboseLog(e);if(""!==n)return Promise.resolve([{isPiiFree:!1,fileName:"verbose-worker-logs.txt",content:n}])}return Promise.resolve([])}))}getWorkerDiagnosticsLogsFromCdlWorkerManager(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){const t=this.cdlWorkerManager.workerClientResponseRouter.cdlDiagnosticsClient;try{const n=yield t.sendRequest("get_logs");if(null===(e=null==n?void 0:n.response)||void 0===e?void 0:e.data)return n.response.data;this.logger.warn("Diagnostic event list empty or ill-formed")}catch(e){this.logger.error(`Unable to retrieve worker diagnostics logs. ${(0,he.VK)(e)}`)}return{diagnosticsEvents:void 0,coreSettingsSnapshot:""}}))}getSyncEngineLogsFromCdlWorkerManager(){return(0,c.mG)(this,void 0,void 0,(function*(){const e=[];for(const t of(0,Z.values)(su))t!==su.NoLog&&t!==su.Diagnostics&&e.push(this.getSyncEngineLogsForTypeFromCdlWorkerManager(t));return Promise.all(e)}))}getSyncEngineLogsForTypeFromCdlWorkerManager(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=this.cdlWorkerManager.workerClientResponseRouter.cdlSyncEngineClient;let n;try{const i=yield t.sendRequest({type:"get_logs",subType:e,params:{conversationId:void 0}});(null==i?void 0:i.response)?n=i.response:(this.logger.warn(`Sync engine logs empty. LogType: ${e}`),n="No logs available.")}catch(e){const t=`Unable to retrieve sync diagnostics logs. ${(0,he.VK)(e)}`;this.logger.error(t),n=t}return{isPiiFree:!1,fileName:`sync-${this.syncEngineLogTypeToFileName(e)}-logs.txt`,content:n}}))}syncEngineLogTypeToFileName(e){switch(e){case su.Messaging:return"messaging";case su.AllConversations:return"all_conversations";case su.People:return"people";case su.Presence:return"presence";case su.Esp:return"esp";case su.Policies:return"policies";case su.PoliciesSettings:return"policies-settings";case su.UserPreferences:return"user-preferences";case su.OfflineActions:return"offline_actions_manager";case su.Calendar:return"calendar";case su.CourseCalendar:return"course_calendar";case su.AppsPlatform:return"apps-platform";case su.Activities:return"activities";case su.PinnedChannels:return"pinned-channels";case su.ConnectedCalendar:return"connected_calendar";case su.MfuContacts:return"mfu_contacts";case su.Guardians:return"guardians";case su.Tenant:return"tenant";case su.ChannelInfoPane:return"channel-info-pane";case su.WhatsNew:return"whats-new";case su.MTMAAggregator:return"mtma-aggregator";case su.SensitivityLabel:return"sensitivity-label";case su.RecommendedTeams:return"recommended-teams";case su.TflMeetingLinks:return"tfl-meeting-links";case su.CapiV3Contacts:return"capiv3_contacts";default:throw new Error(`Invalid sync engine log type: ${e}`)}}}function pu(e){var t,n;return(0,c.mG)(this,void 0,void 0,(function*(){const i=new mu(e.windowProvider,e.config,e.configLoader,e.loggerFactory,e.scenarioFactory,e.coreSettings,e.coreSettingsContext,e.authenticationService,e.discover,e.platformService,e.clientState,e.hostState,e.primaryUser,null===(t=e.i18NextWrapper)||void 0===t?void 0:t.locale,e.offlineCacheManager,e.authStateProvider,e.workerId,e.dataClientTrackingService,null===(n=e.altScenarioService)||void 0===n?void 0:n.altScenario);return function(e,t){const n=null==e?void 0:e.altScenario;n&&n.appendEventData({dataStoreName:Uc(t)})}(e.altScenarioService,e.coreSettings),i.getCDLWorkerManager().then((t=>{if(t){const{authenticationService:n,authenticationUser:i,cacheStorage:a,cdlWorkerRegistrarService:o,loggerFactory:r,logsCollectorService:s,workerId:l}=e,d=new gu(t,r.newLogger("CdlWorkerLogsProvider"),n,a),c=i&&(0,qe.b)(i);s.registerUserLogsProvider(c||"",d),o&&l&&(o.activeWorkers.add(l),o.initTaskWorkerId||(o.initTaskWorkerId=l)),function(e,t){var n,i;const{enableNetworkStateCommsBetweenCoreAndWorker:a}=e.coreSettings.get(A.J.Core);if(a){const a=n=>{const i={networkState:e.networkState.getState(),baselineNetworkStateOverride:n};t.workerClientResponseRouter.cdlNetworkStateClient.sendRequest(i)},o=e.authenticationUser&&(0,qe.b)(e.authenticationUser)||"",r=null===(i=(n=e.networkState).createNetworkStateTracker)||void 0===i?void 0:i.call(n,o,`CDL Worker EM [${o}]`,a);r&&t.state.setState("networkStateService:Loaded",r);return function(e,t){return()=>{e.unsubscribe(),t.dispose()}}(e.networkState.observe().subscribe((e=>{const n={networkState:e};t.workerClientResponseRouter.cdlNetworkStateClient.sendRequest(n)})),r)}}(e,t),function(e,t){const{enableEndpointsHealthCommsBetweenCoreAndWorker:n}=e.coreSettings.get(A.J.Core);if(n){const n=e.endpointsHealthService;if(null==n?void 0:n.getEndpointsHealthUpdateHandler){const e=n.getEndpointsHealthUpdateHandler();t.state.setState("endpointsHealthUpdateHandler:Loaded",e),e.onStateDumpRequest((()=>{const e="get_health_state";t.workerClientResponseRouter.cdlEndpointsHealthClient.sendRequest(e)}))}}}(e,t),function(e){(0,Jn.G)().setCdlContextCallback(((t,n,i)=>{e.workerClientResponseRouter.telemetryClient.sendRequest({requestOperationtype:"setContext",context:{[t]:n},userContextId:i})}))}(t)}})),yield(0,Gl._)(1),i}))}function hu(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const n=yield null===(t=null==e?void 0:e.getCachedUsers)||void 0===t?void 0:t.call(e,Object.assign(Object.assign({},Xe({source:I.D.Core})),{scenarioName:ee.RG.AuthWebCachedUser}),{isPrimaryUser:!0}),i=null==n?void 0:n[0];if(i)return(0,qe.K)(i)}))}class vu extends xe{constructor(){super(_.Yg.CreateCDLWorkerOnAuthUserTask,["altScenarioService","authenticationService","clientState","config","configLoader","coreSettings","coreSettingsContext","diagnosticsService","discover","endpointsHealthService","hostState","i18NextWrapper","loggerFactory","logsCollectorService","networkState","platformService","scenarioFactory","windowProvider"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{altScenarioService:t,authenticationService:n,clientState:i,config:a,configLoader:o,coreSettings:r,coreSettingsContext:s,diagnosticsService:l,discover:d,endpointsHealthService:c,hostState:u,i18NextWrapper:m,loggerFactory:g,logsCollectorService:p,networkState:h,platformService:v,scenarioFactory:S,windowProvider:f}=e,{authenticationUser:y,authStateProvider:k,cacheStorage:C,cdlWorkerRegistrarService:b,dataClientTrackingService:T,offlineCacheManager:w}=e,_=g.newLogger("CreateCDLWorkerOnAuthUserTask"),I=Oc(r),{enableMTMA:N,disableExperience:E}=r.get(A.J.Core);if(!I||!N)return _.warn(`Not creating worker as cdl worker or mtma is not enabled. isCdlWorkerEnabled: ${I}, isMTMAEnabled: ${N}`),Promise.resolve();if(!y||!b)return _.warn("Not creating worker as authenticated user is not available or cdl worker registrar service is undefined."),Promise.resolve();if(E)return _.warn("Not creating worker as experience is disabled for the user."),Promise.resolve();const D=null==y?void 0:y.id;if(b.activeWorkers.has(D)||b.useInitTaskWorker)return _.log(`Not creating a worker as we already have created worker workerId: ${D} for the user oid: ${y.profile.objectId},\n         tid: ${y.profile.tenantId}`),void(b.useInitTaskWorker=!1);let F;_.log(`Creating a worker with id: ${D} for the user oid: ${y.profile.objectId},\n       tid: ${y.profile.tenantId}`),N&&(F=yield hu(n)),e.cdlWorkerService=yield pu({altScenarioService:t,authenticationService:n,authenticationUser:y,authStateProvider:k,cacheStorage:C,cdlWorkerRegistrarService:b,clientState:i,config:a,configLoader:o,coreSettings:r,coreSettingsContext:s,dataClientTrackingService:T,diagnosticsService:l,discover:d,endpointsHealthService:c,hostState:u,i18NextWrapper:m,loggerFactory:g,logsCollectorService:p,networkState:h,offlineCacheManager:w,platformService:v,primaryUser:F,scenarioFactory:S,windowProvider:f,workerId:D})}))}}class Su extends xe{constructor(){super(_.Yg.CreateCDLWorkerOnInitTask,["altScenarioService","authenticationService","clientState","config","configLoader","coreSettings","coreSettingsContext","diagnosticsService","discover","endpointsHealthService","hostState","i18NextWrapper","loggerFactory","logsCollectorService","networkState","platformService","scenarioFactory","windowProvider"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{altScenarioService:t,authenticationService:n,clientState:i,config:a,configLoader:o,coreSettings:r,coreSettingsContext:s,diagnosticsService:l,discover:d,endpointsHealthService:c,hostState:u,i18NextWrapper:m,loggerFactory:g,logsCollectorService:p,networkState:h,platformService:v,scenarioFactory:S,windowProvider:f}=e,{authenticationUser:y,authStateProvider:k,cacheStorage:C,cdlWorkerRegistrarService:b,dataClientTrackingService:T,offlineCacheManager:w}=e,_=g.newLogger("CreateCDLWorkerOnInitTask");if(!Oc(r))return void _.warn("Not creating worker as CDL worker is not enabled");let I,N;const{enableMTMA:E}=r.get(A.J.Core);if(E){if(I=y?y.id:(0,Je.v4)(),!b)return void _.warn("Not creating worker as cdlWorkerRegistrarService is undefined");_.log(`Creating CDL worker with id ${I} for user oid:${null==y?void 0:y.profile.objectId}, tid: ${null==y?void 0:y.profile.tenantId}`),N=yield hu(n)}else _.log("MTMA is not enabled. Creating a CDL worker without any workerId");e.cdlWorkerService=yield pu({altScenarioService:t,authenticationService:n,authenticationUser:y,authStateProvider:k,cacheStorage:C,cdlWorkerRegistrarService:b,clientState:i,config:a,configLoader:o,coreSettings:r,coreSettingsContext:s,dataClientTrackingService:T,diagnosticsService:l,discover:d,endpointsHealthService:c,hostState:u,i18NextWrapper:m,loggerFactory:g,logsCollectorService:p,networkState:h,offlineCacheManager:w,platformService:v,primaryUser:N,scenarioFactory:S,windowProvider:f,workerId:I})}))}}class fu{constructor(){this.initTaskWorkerId="",this.useInitTaskWorker=!0,this.activeWorkers=new Set}}class yu extends xe{constructor(){super(_.Yg.CreateCDLWorkerRegistrarServiceTask,[])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){return e.cdlWorkerRegistrarService=new fu,Promise.resolve()}))}}!function(e){e.LifeCycleScopeChange="LifeCycleScopeChange"}(lu||(lu={}));class ku extends xe{constructor(){super(_.Yg.CreateChangeReporting,[])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){e.schedulerChangeReporting=new $a,e.experienceChangeReportingService=new $a,e.lifeCycleScopeChangeReportingService=new $a,e.commandResultChangeReportingService=new $a,e.commandChangeReportingService=new $a}))}}const Cu="local-user-preferences",bu={theme:{userTheme:"light",followOsTheme:!0},animation:{disableAnimations:!1},infoPane:{chats:"closed",chatContextualSearch:"closed",channelcontextualsearch:"closed"},flyoutCamera:{cameraState:"notSet"},promo:{badgeActionComplete:!1,labelActionComplete:!1},density:{chatDensity:"comfy"},performance:{mode:"normal"},appSwitcher:{checkboxChecked:!1},videoEffect:{lastUsedVideoFilter:void 0,lastUsedBackgroundImage:void 0},avatar:{lastUsedAvatarFilter:void 0},teamLayout:{currentLayout:void 0},diagnosticsLogs:{shouldPersistLogsIntoIDB:!1}},Tu={get:()=>null,set:()=>{}};class wu{constructor(e,t=Tu){this.storage=t,this.subjectCache=new Map,this.logger=e.newLogger("ClientPreferencesService"),this.clientPreferences=this.hydrateClientPreferences()}getPreferences(e){return this.clientPreferences[e]}getAllPreferences(){return this.clientPreferences}updatePreferences(e){const t=this.clientPreferences;this.clientPreferences=(0,Z.merge)({},this.clientPreferences,e),this.storage.set(Cu,JSON.stringify(this.clientPreferences)),this.subjectCache.forEach(((e,n)=>{(0,Z.isEqual)(t[n],this.clientPreferences[n])||(this.logger.log(`Notifying subscribers of: '${n}', settings changed to: `,this.clientPreferences[n]),e.next(this.clientPreferences[n]))}))}getPreferenceObservable(e){return this.createOrGetSubjectFromCache(e).asObservable()}createOrGetSubjectFromCache(e){const t=this.subjectCache.get(e);if(t)return t;const n=this.getPreferences(e),i=new u.X(n);return this.subjectCache.set(e,i),this.logger.log(`Creating subject for '${e}' category, settings:`,n),i}hydrateClientPreferences(){try{const e=this.storage.get(Cu);if(!e)return this.logger.log("Client preferences were not found in local storage; returning defaults."),bu;this.logger.log("Client preferences was found in local storage.");const t=JSON.parse(e);return(0,Z.defaultsDeep)(t,bu)}catch(e){return this.logger.error("Unable fetch client preferences from local storage. ",e),bu}}}class _u extends xe{constructor(){super(_.Yg.CreateClientPreferences,["localStorage","loggerFactory"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{localStorage:t,loggerFactory:n}=e;e.clientPreferences=new wu(n,{set:(e,n)=>t.set(e,n,or.f.Experience),get:e=>t.get(e,or.f.Experience)})}))}}class Iu extends xe{constructor(){super(_.Yg.CreateCommandDelegator,["appsRegistryService","client","commandChangeReportingService","coreSettings","loggerFactory","scenarioFactory","userBiService","windowProvider"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:n,commandChangeReportingService:i,coreSettings:a,loggerFactory:o,scenarioFactory:r,userBiService:s,windowProvider:l}=e;e.commandDelegator=(e,d)=>jt({appsRegistryService:t,client:n,commandChangeReportingService:i,commandHandler:d,commandInput:e,coreSettings:a,loggerFactory:o,scenarioFactory:r,host:l,userBiService:s})}))}}class Au extends xe{constructor(){super(_.Yg.CreateCommandHandler,["appsRegistryService","client","commandChangeReportingService","coreSettings","loggerFactory","platformService","scenarioFactory","userBiService"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:n,commandChangeReportingService:i,coreSettings:a,loggerFactory:o,platformService:r,scenarioFactory:s,userBiService:l}=e;e.commandHandler=(e,d)=>Pn({appsRegistryService:t,client:n,commandChangeReportingService:i,coreSettings:a,entityCommandInput:e,loggerFactory:o,platformService:r,scenarioFactory:s,clientLaunchId:d,userBiService:l})}))}}var Nu;!function(e){e[e.Canceled=0]="Canceled",e[e.Failure=1]="Failure",e[e.Incomplete=2]="Incomplete",e[e.Success=3]="Success"}(Nu||(Nu={}));const Eu=[Qe.B.Abandoned,Qe.B.Close],Du=[Qe.B.Incomplete,Qe.B.WindowNotUpdated],Fu=[Qe.B.Blanked,Qe.B.CommandHandledByOnCommandReceived,Qe.B.CommandHandledPriorToResolution,Qe.B.EventHandled,Qe.B.Hidden,Qe.B.LayoutRendered,Qe.B.LayoutRenderUpdated,Qe.B.NotHandled,Qe.B.Toggled],Pu=[Qe.B.Failure,Qe.B.SlotPhasedRenderingTimedOut];function Mu(e){switch(e){case Qe.B.ApplicationHookReceivedCommand:case Qe.B.CommandBeforeGetAppViewEntities:case Qe.B.RenderStarted:case Qe.B.ChunkLoadStarted:case Qe.B.ChunkLoadSucceeded:case Qe.B.Rendered:return!0;default:return!1}}const ju={[ee.RG.ClientStart]:24e4},Ru="command-result-service";class xu{constructor(e,t,n,i){this.commandChangeReportingService=t,this.commandResultChangeReportingService=n,this.host=i,this.logger=e.newLogger(Ru),this.pendingCommands=new Map}init(){this.commandChangeSubscription=this.setUpCommandChangeSubscriptions()}destroy(){var e;this.pendingCommands.clear(),null===(e=this.commandChangeSubscription)||void 0===e||e.unsubscribe()}registerForCommandTimeOut(e,t){const n=this.pendingCommands.get(e);n&&(n.onCommandTimeOut=t)}unRegisterForCommandTimeOut(e){const t=this.pendingCommands.get(e);t&&(t.onCommandTimeOut=void 0)}onCommandChange(e){switch(e.type){case Qe.B.ScenarioEventDataAppended:case Qe.B.ScenarioMarked:case Qe.B.Rendered:break;case Qe.B.CommandMetaDataAdded:{const{context:{contentExistsAndHasChanged:t},correlationId:n}=e,i=this.pendingCommands.get(n);i&&void 0!==t&&(this.logger.log(`CommandMetaDataAdded: contentExistsAndHasChanged=${t}`),i.contentExistsAndHasChanged=t);break}case Qe.B.DelegatedCommandReceived:case Qe.B.EventBubbled:{const{context:{correlation:t},correlationId:n}=e;let i=this.pendingCommands.get(n);i||(i=this.createPendingCommand({correlation:t}),this.pendingCommands.set(n,i));break}case Qe.B.CommandStart:{const{correlationId:t,context:{entityCommand:n},userContextId:i}=e;let a=this.pendingCommands.get(t);a?a.entityCommand=n:a=this.createPendingCommand({entityCommand:n,userContextId:i}),this.pendingCommands.set(t,a);break}case Qe.B.NavigationCommandStart:{const{correlationId:t,context:{correlation:n},userContextId:i}=e;let a=this.pendingCommands.get(t);a||(a=this.createPendingCommand({correlation:n,userContextId:i})),this.pendingCommands.set(t,a);break}case Qe.B.Incomplete:case Qe.B.Failure:{const{correlationId:t,context:{errorInfo:n,errorMessage:i,showOops:a,eventData:o},userContextId:r}=e,s=this.pendingCommands.get(t);s&&this.calculateCommandResult(s,e.type,r,{errorInfo:n,errorMessage:i,showOops:a,eventData:o});break}default:{const{type:t,correlationId:n,context:{eventData:i}}=e,a=this.pendingCommands.get(n);if(a&&a.previousEvents.has(t))break;a&&this.calculateCommandResult(a,e.type,e.userContextId,{eventData:i});break}}}createPendingCommand({correlation:e,entityCommand:t,userContextId:n}){if(!(e=null!=e?e:null==t?void 0:t.command.correlation)){const e=new Error("correlation cannot be undefined. A valid entityCommand or correlation should be passed.");throw this.logger.errorToTelemetry&&this.logger.errorToTelemetry(e.message,"webclient_framework_foundation_command_reporting_service_event",void 0,!0),e}const i=e.id,a=this.host.setTimeout(this.getCommandTimeoutHandler(i,n),this.getCommandTimeout(e));return{contentExistsAndHasChanged:void 0,correlation:e,entityCommand:t,previousEvents:new Set,timeoutId:a}}getCommandTimeoutHandler(e,t){return()=>{var n;const i=this.pendingCommands.get(e);if(i){const{previousStep:a}=i,o=function(e){return e&&Mu(e)?Ke.y.TimeoutRunningApp:Ke.y.TimeoutRunningCore}(a);null===(n=i.onCommandTimeOut)||void 0===n||n.call(i),this.logger.error(`Command error, correlationId: ${e}, reason ${o}, previousStep: ${a}`),this.onCommandResult(Nu.Failure,e,o,a,t,{errorCode:o})}}}setUpCommandChangeSubscriptions(){return this.commandChangeReportingService.observeChanges().subscribe((e=>this.onCommandChange(e)))}getCommandTimeout({id:e,scenarioName:t}){return t&&ju[t]?(this.logger.log(`Increasing the command timeout (${ju[t]}) during ${t}, correlationId: ${e}`),ju[t]):12e4}calculateCommandResult(e,t,n,i){var a;const{previousStep:o,correlation:{id:r}}=e;if(e.previousEvents.add(t),e.previousStep=t,function(e){return Fu.includes(e)}(t))this.onCommandResult(Nu.Success,r,t,o,n,{eventData:null==i?void 0:i.eventData});else if(function(e){return Pu.includes(e)}(t)){const e=(s=t,l=null==i?void 0:i.errorInfo,s===Qe.B.SlotPhasedRenderingTimedOut?Ke.y.SlotPhasedRenderingTimedOut:l||Ke.y.UnknownCommandError),d=(null==i?void 0:i.errorMessage)||(null===(a=null==i?void 0:i.eventData)||void 0===a?void 0:a.errors);this.logger.error(`Command error, correlationId: ${r}, reason ${e}, previousStep: ${o}`),this.onCommandResult(Nu.Failure,r,e,o,n,{errorCode:e,errorMessage:d,eventData:null==i?void 0:i.eventData})}else if(function(e,t){return e===Qe.B.RenderStarted&&!1===t}(t,e.contentExistsAndHasChanged)){const e=Ke.y.AlreadyRendered;this.onCommandResult(Nu.Incomplete,r,e,o,n,{errorCode:e,eventData:null==i?void 0:i.eventData})}else if(function(e){return Eu.includes(e)}(t)){const e=function(e,t){return e===Qe.B.Close?t&&Mu(t)?Ke.y.WindowCloseRunningApp:Ke.y.WindowCloseRunningCore:e===Qe.B.Abandoned?Qe.B.Abandoned:Ke.y.UnknownCommandError}(t,o);this.onCommandResult(Nu.Canceled,r,e,o,n,{errorCode:e,eventData:null==i?void 0:i.eventData}),this.logger.error(`Command abandoned, correlationId: ${r}, reason ${e}, previousStep: ${o}`)}else if(function(e){return Du.includes(e)}(t)){const e=(null==i?void 0:i.errorInfo)||t;this.onCommandResult(Nu.Incomplete,r,e,o,n,{errorCode:e,eventData:null==i?void 0:i.eventData}),this.logger.error(`Command incomplete, correlationId: ${r}, reason ${t}, previousStep: ${o}`)}var s,l}onCommandResult(e,t,n,i,a,o){const r=this.pendingCommands.get(t);r&&(this.reportCommandResult(t,a,e,n,i,r,o),this.cleanUpPendingCommand(t,r))}cleanUpPendingCommand(e,{timeoutId:t}){this.host.clearTimeout(t),this.pendingCommands.delete(e)}reportCommandResult(e,t,n,i,a,o,r){const{entityCommand:s}=o;this.commandResultChangeReportingService.report({correlationId:e,userContextId:t,context:{entityCommand:s,error:(null==r?void 0:r.errorCode)||(null==r?void 0:r.errorMessage)?{errorCode:null==r?void 0:r.errorCode,errorMessage:null==r?void 0:r.errorMessage}:void 0,previousStep:a,reason:i,target:Ru,eventData:null==r?void 0:r.eventData},type:n})}}var Ou;!function(e){e.ExpLoader="ExpLoader",e.Core="Core",e.App="App"}(Ou||(Ou={}));var Lu=n(66695),Uu=n(59754);const Bu={eventId:"executeEntityCommand"};function Wu(e,t,n,i){const{replyContent:a}=e,{id:o,type:r}=t;if(i)switch(r){case Ie.p.chats:return function({actionType:e,convId:t,userContextId:n},i,a){let o=Hn.unknown;switch(e){case"quickReply":o=Hn.quickReply;break;default:const e=`HostComms:: ${Uu.f.RequiredFieldMissing} Toast activation command received from host with unknown chats action Type`;a.errorToTelemetry&&a.errorToTelemetry(e,"webclient_framework_host_comms",void 0,!0)}return{actionType:o,convId:t||void 0,message:i,userContextId:n}}(i,a,n);case Ie.p.calls:return function({actionType:e,userContextId:t,toastType:n},i,a){return e||(a.errorToTelemetry&&a.errorToTelemetry(`HostComms:: ${Uu.f.RequiredFieldMissing} Toast activation command received from host with unknown calls action type`,"webclient_framework_host_comms",void 0,!0),e="Unknown"),{actionType:e,toastId:i||void 0,toastType:n,userContextId:t}}(i,o,n);case Ie.p.communities:return function({actionType:e,userContextId:t,toastType:n,teamId:i,messageId:a},o){return n||(o.errorToTelemetry&&o.errorToTelemetry(`HostComms:: ${Uu.f.RequiredFieldMissing} Toast activation command received from host with unknown communities toast type`,"webclient_framework_host_comms",void 0,!0),n="Unknown"),{actionType:e,toastType:n,userContextId:t,messageId:a,teamId:i}}(i,n);default:return void(n.errorToTelemetry&&n.errorToTelemetry(`HostComms:: ${Uu.f.RequiredFieldMissing} Unkown target entity type received from host for toast activation command`,"webclient_framework_host_comms",void 0,!0))}else n.errorToTelemetry&&n.errorToTelemetry(`HostComms:: ${Uu.f.RequiredFieldMissing} Toast activation command received from host without target host entity options`,"webclient_framework_host_comms",void 0,!0)}function Gu(e,t){switch(e){case r.mutate:return Ie.u.mutate;case r.view:return Ie.u.view;case r.list:return Ie.u.list;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${Uu.f.RequiredFieldMissing} Toast activation command received from host with unknown entity action. Defaulting to view.`,"webclient_framework_host_comms",void 0,!0),Ie.u.view}}function Vu(e,t){const{entity:n,entityOptions:i,command:o}=e,{visibilityState:s,correlation:l}=o,{id:d,startTimestamp:c,source:u}=l,m=null==i?void 0:i.toastActivationEntityOptions;if(!m)return Bu;if(!n)return Bu;const{optionsJson:g}=n,p=function(e,t){const{id:n,type:i,action:a,linkedEntity:o}=e;return{action:Gu(a,t),id:n,linkedEntity:tm(o,t),type:$u(i,t)}}(n,t),h=g?(0,Lu.D)(g,void 0):void 0;return Object.assign(Object.assign({},Bu),{payload:{entity:p,command:{visibilityState:zu(s,t),correlation:{id:d,startTimestamp:c?c.getTime():void 0,source:u,scenarioName:ee.RG.ToastActivation},stateTransition:nm(n.type,t)},entityOptions:Hu(h),dataOptions:n.action===r.mutate||n.type===a.communities?Wu(m,p,t,h):{userContextId:h.userContextId}}})}function Hu(e){if(!(null==e?void 0:e.messageId))return;const{messageId:t,focusOnLoad:n}=e;return{messageId:t,focusOnLoad:n}}function $u(e,t){switch(e){case a.chats:case a.reminders:return Ie.p.chats;case a.calls:return Ie.p.calls;case a.extensions:return Ie.p.extensions;case a.activity:return Ie.p.activity;case a.campaignnotifications:return Ie.p.campaignnotifications;case a.channels:return Ie.p.channels;case a.communities:return Ie.p.communities;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${Uu.f.RequiredFieldMissing} Toast activation command received from host with unknown entity type. Defaulting to chats`,"webclient_framework_host_comms",void 0,!0),Ie.p.chats}}function zu(e,t){switch(e){case o.show:return Ae.fe.show;case o.hide:return Ae.fe.hide;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${Uu.f.RequiredFieldMissing} Toast activation command received from host with unknown visibility state. Defaulting to show`,"webclient_framework_host_comms",void 0,!0),Ae.fe.show}}function qu(e,t){var n;const{command:a}=e,{correlation:o,visibilityState:r}=a;let s;return(null==o?void 0:o.startTimestamp)&&(s=new Date(+o.startTimestamp),s=om(s)?s:void 0),{correlation:{id:null!==(n=null==o?void 0:o.id)&&void 0!==n?n:(0,Je.v4)(),startTimestamp:s,source:i.toastFromWeb},visibilityState:em(r,t)}}function Ju(e,t){try{const{entity:n}=e,{action:i,id:a,type:o}=n;return{action:Qu(i,t),id:a,type:Xu(o)}}catch(e){throw t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${(0,R.u4)(e)}`,"webclient_framework_host_comms",void 0,!0),e}}function Qu(e,t){switch(e){case Ie.u.mutate:return r.mutate;case Ie.u.view:return r.view;case Ie.u.list:return r.list;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${Uu.f.RequiredFieldMissing}: EntityAction. Defaulting to HostEntityAction.view`,"webclient_framework_host_comms",void 0,!0),r.view}}function Ku(e){const{id:t,linkedEntity:n,action:i,type:a,dataOptions:o}=e;return{action:i,id:t,linkedEntity:n,type:a,optionsJson:(0,R.u4)(o)}}function Yu(e){!function(e){if(!e)throw(0,he.Tr)(_.w5.Commanding,Uu.f.RequiredFieldMissing,Ie.p.toasts,void 0,`${Uu.f.RequiredFieldMissing}: entityOptions`);const t=e;if(!(t.targetEntity&&t.targetEntity.action&&t.targetEntity.type&&t.targetEntity.dataOptions&&t.time&&t.title))throw(0,he.Tr)(_.w5.Commanding,Uu.f.RequiredFieldMissing,Ie.p.toasts,void 0,`${Uu.f.RequiredFieldMissing}: hostEntityOptions?.toastEntityOptions`)}(e);const{buttons:t,targetEntity:n,textInput:i,time:a}=e;return{toastEntityOptions:Object.assign(Object.assign({},e),{targetEntity:Ku(n),time:a,buttons:am(t),textInput:Zu(i)})}}function Xu(e){switch(e){case Ie.p.toasts:return a.toasts;default:throw(0,he.Tr)(_.w5.Commanding,Uu.f.RequiredFieldMissing,Ie.p.toasts,void 0,`${Uu.f.RequiredFieldMissing}: EntityType`)}}function Zu(e){if(!e)return;const{placeholderText:t,sendButton:n}=e;return{placeholderText:t,sendButton:n?im(n):void 0}}function em(e,t){switch(e){case Ae.fe.hide:return o.hide;case Ae.fe.show:return o.show;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${Uu.f.RequiredFieldMissing}: EntityVisibilityState. Defaulting to HostEntityVisibilityState.show`,"webclient_framework_host_comms",void 0,!0),o.show}}function tm(e,t){if(!e)return;const{id:n,type:i,action:a}=e;return{action:a?Gu(a,t):void 0,id:n,type:$u(i,t)}}function nm(e,t){switch(e){case a.chats:case a.channels:return Ae.su.new;case a.calls:case a.campaignnotifications:return Ae.su.new;case a.extensions:case a.reminders:case a.activity:case a.communities:return Ae.su.flush;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${Uu.f.RequiredFieldMissing} Toast activation command received from host with unhandled host entity type - ${e}.`,"webclient_framework_host_comms",void 0,!0),Ae.su.new}}function im(e){const{image:t,targetEntity:n,text:i,preferImageOnly:a,style:o}=e;return{image:t,preferImageOnly:a,style:o,targetEntity:Ku(n),text:i}}function am(e){if(e)return e.map(im)}const om=e=>e instanceof Date&&!isNaN(e.getTime());function rm(e,t,n,i){var a;return(0,c.mG)(this,void 0,void 0,(function*(){if(e.entity.type!==Ie.p.toasts)return;let o;(null===(a=e.command.correlation)||void 0===a?void 0:a.id)&&(o=i.findScenarioByNameAndId(ee.RG.CrossClientToastView,e.command.correlation.id));const r=yield function(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){let n;try{n=yield e.loadModule("core"),t.log(`HostComms:: ${Qr.LoadModuleCoreSuccess}`)}catch(e){const n=`HostComms:: ${Jr.LoadModuleCoreFailed} ${(0,R.u4)(e)}`;t.errorToTelemetry&&t.errorToTelemetry(n,"webclient_framework_host_comms",void 0,!0)}return n}))}(t,n);if(!r||!r.executeCommand)return n.errorToTelemetry&&n.errorToTelemetry(`HostComms:: ${Jr.LoadModuleCoreFailed}`,"webclient_framework_host_comms",void 0,!0),void(null==o||o.fail({errorCode:Jr.LoadModuleCoreFailed}));try{const t=function(e,t){return{command:qu(e,t),entity:Ju(e,t),entityOptions:Yu(null==e?void 0:e.entityOptions)}}(e,n);yield null==r?void 0:r.executeCommand(t),n.log(`HostComms:: ${Qr.ExecuteCommandSuccess}`),null==o||o.mark(ee.ck.CrossClientHostEventSent)}catch(e){n.errorToTelemetry&&n.errorToTelemetry(`HostComms:: ${Jr.ExecuteCommandFailed} ${(0,R.u4)(e)}`,"webclient_framework_host_comms",void 0,!0),null==o||o.fail({errorCode:Jr.ExecuteCommandFailed})}}))}class sm{constructor(e,t,n,i){this.commandChangeReportingService=e,this.commandResultChangeReportingService=t,this.scenarioFactory=n,this.pendingCommands=new Map,this.logger=i.newLogger("CommandTelemetryService"),this.commandSequence=0}init(){this.commandChangeSubscription=this.commandChangeReportingService.observeChanges().subscribe((e=>this.onCommandChange(e))),this.commandResultChangeSubscription=this.commandResultChangeReportingService.observeChanges().subscribe((e=>this.onCommandResultChange(e)))}destroy(){var e,t,n;this.pendingCommands.clear(),null===(e=this.commandChangeSubscription)||void 0===e||e.unsubscribe(),null===(t=this.commandResultChangeSubscription)||void 0===t||t.unsubscribe(),null===(n=this.lifeCycleScopeChangeSubscription)||void 0===n||n.unsubscribe()}onCommandChange(e){switch(e.type){case Qe.B.ScenarioEventDataAppended:{const{correlationId:t,context:{eventData:n}}=e;this.appendScenarioEventData(t,n);break}case Qe.B.ScenarioMarked:{const{correlationId:t,context:{step:n,eventData:i,status:a,monitoringData:o}}=e;this.addScenarioMark(t,n,e.type,i,a,o);break}case Qe.B.Rendered:case Qe.B.CommandMetaDataAdded:break;case Qe.B.DelegatedCommandReceived:case Qe.B.EventBubbled:{const{context:{correlation:t}}=e;this.startCommandTelemetry(t.id,{correlation:t});break}case Qe.B.CommandStart:{const{correlationId:t,context:{entityCommand:n}}=e,{scenarioEventData:i}=n;this.startCommandTelemetry(t,{entityCommand:n}),i&&this.appendScenarioEventData(t,i);break}case Qe.B.NavigationCommandStart:{const{correlationId:t,context:{clientLaunchId:n,correlation:i,eventData:a}}=e;this.startCommandTelemetry(t,{correlation:i,clientLaunchId:n}),a&&this.appendScenarioEventData(t,a);break}default:{const{type:t,correlationId:n,context:{eventData:i}}=e,a=this.pendingCommands.get(n);if(a&&a.previousEvents.has(t))break;null==a||a.previousEvents.add(t),Mu(t)&&(null==a||a.commandScenario.appendEventData({scenarioPhase:Ou.App})),i&&this.appendScenarioEventData(n,i),this.addScenarioMark(n,t,t,i);break}}}findExistingNavigationCommandScenario(e,t){const n=t.scenarioName||ee.RG.NavigationCommand;let i=this.scenarioFactory.findScenarioByNameAndId(n,e);return i||t.scenarioName!==ee.RG.ClientStart||(i=this.scenarioFactory.findScenario(ee.RG.ClientStart)),i||void 0}findExistingActivitySwitchScenario(e){const t=e.command.correlation.id;if(e.command.correlation.source===I.D.ActivityFeedBellClick){const e=Array.from(this.pendingCommands.values());for(const n of e)if(n.correlation.scenarioName===ee.RG.ActivitySwitch||n.correlation.scenarioName===ee.RG.NavigationCommand){const e=n.correlation.id;this.logger.log(`Command was sent by activity app as a result of a bell click, correlationId ${t}. Combining scenario with existing activity_switch of correlationId ${e}`);const i=n.commandScenario;return this.pendingCommands.delete(e),i}}}startCommandTelemetry(e,{entityCommand:t,correlation:n,clientLaunchId:i}){let a,o=this.pendingCommands.get(e);i&&n&&(a=this.findExistingNavigationCommandScenario(i,n)),t&&!a&&(a=this.findExistingActivitySwitchScenario(t)),o?t&&(this.logger.log(`Updating command\n\tscenarioName: ${o.commandScenario.name}\n\tcorrelationId: ${e}\n\tentityType: ${t.entity.type}\n\tentityAction: ${t.entity.action}`),o.commandScenario.appendEventData({mainEntityAction:t.entity.action,mainEntityType:t.entity.type})):o=this.createPendingCommand(e,{commandScenario:a,entityCommand:t,correlation:n,clientLaunchId:i}),this.pendingCommands.set(e,o)}createPendingCommand(e,{entityCommand:t,correlation:n,clientLaunchId:i,commandScenario:a}){var o;if(!(n=null!=n?n:null==t?void 0:t.command.correlation)){const e=new Error("correlation cannot be undefined. A valid entityCommand or correlation should be passed.");throw this.logger.errorToTelemetry&&this.logger.errorToTelemetry(e.message,"webclient_framework_foundation_command_reporting_service_event",void 0,!0),e}if(n.scenarioName=null!==(o=n.scenarioName)&&void 0!==o?o:ee.RG.EntityCommand,!a){this.logger.log(`Creating new scenario with scenarioName: ${n.scenarioName}, correlationId ${e}`);const{startTimestamp:o}=n,r=o&&om(new Date(+o))?+o:void 0;a=this.scenarioFactory.newScenario(n.scenarioName,{startTime:r}),void 0!==i&&(a.clientId=i),a.appendEventData({"EventInfo.CorrelationId":e,commandSequence:++this.commandSequence,commandSource:n.source,mainEntityAction:null==t?void 0:t.entity.action,mainEntityType:null==t?void 0:t.entity.type,scenarioPhase:Ou.Core})}return this.logger.log(`Starting to track a new command\n\tscenarioName: ${n.scenarioName}\n\tcorrelationId: ${e}\n\tentityType: ${null==t?void 0:t.entity.type}\n\tentityAction: ${null==t?void 0:t.entity.action}`),{correlation:n,commandScenario:a,previousEvents:new Set}}appendScenarioEventData(e,t){const n=this.pendingCommands.get(e);n&&n.commandScenario.appendEventData(t)}addScenarioMark(e,t,n,i,a,o){const r=this.pendingCommands.get(e);r&&(n!==Qe.B.ScenarioMarked&&this.logger.log(`${r.commandScenario.name} addScenarioMark, correlationId: ${e}, step: ${t}, eventData: ${JSON.stringify(i)}`),r.commandScenario.mark(t,i,a,o))}onCommandResultChange(e){const{context:{error:t,reason:n,previousStep:i,eventData:a},correlationId:o,type:r}=e,s=this.pendingCommands.get(o);if(!s)return void this.logger.error(`Command Result of ${n} and correlationId ${o} was reported but no pending command was found`);const l=null==s?void 0:s.commandScenario;switch(r){case Nu.Canceled:{const{errorCode:e}=t||{};this.logger.warn(`${l.name} Cancelled, correlationId: ${o}, reason: ${e}, previousStep: ${i}`),l.cancel(Object.assign({errorCode:e,reason:e},a));break}case Nu.Failure:{const{errorCode:e,errorMessage:n}=t||{};this.logger.error(`${l.name} Failed, correlationId: ${o}, reason: ${e}, errorMessage: ${n}, previousStep: ${i}`),l.fail(Object.assign({errorCode:e,reason:e,errors:n&&(0,me.A)(n)},a));break}case Nu.Incomplete:{const{errorCode:e}=t||{};this.logger.warn(`${l.name} Incomplete, correlationId: ${o}, reason: ${e}, previousStep: ${i}`),l.incomplete(Object.assign({errorCode:e,reason:e},a));break}case Nu.Success:this.logger.log(`${l.name} Successful, correlationId: ${o}, reason: ${n}, previousStep: ${i}`),l.stop(Object.assign({reason:n},a))}this.pendingCommands.delete(o)}}const lm=[Qe.B.ApplicationHookReceivedCommand,Qe.B.ApplicationHookContinuedCommand],dm=[Qe.B.ScenarioEventDataAppended,Qe.B.ScenarioMarked];class cm{constructor(e,t){this._host=t,this.commandTimedOutAtHostHandler=e=>{const{correlationId:t}=e.payload,n=this._pendingCommands.get(t);n&&(n.onCommandTimeOut&&n.onCommandTimeOut(),this.cleanUpPendingCommand(t))},this._logger=e.newLogger("CommandReportingServiceHybrid"),this._pendingCommands=new Map,this._host.opener.addEventListener(K.rY.EntityCommandTimedOutAtHost,this.commandTimedOutAtHostHandler)}registerNavigationCommandStart(){}registerCommandStart(e){var t;const n=e.command.correlation.id;if(!n)return void this._logger.error("registerCommandStart called without a command correlation id");const i=this._pendingCommands.get(n);i&&(this._logger.log(`registerCommandStart called with a pending command with correlation id ${n}, overwriting and starting new timeout interval`),this._host.clearTimeout(i.timeoutId));const a=null===(t=null==i?void 0:i.entityCommand.entityOptions)||void 0===t?void 0:t.timeout,o=a||9e4,r=this._host.setTimeout((()=>{this.reportCommandEvent(n,Qe.B.CommandReportingTimedOut),this.cleanUpPendingCommand(n)}),o);this._logger.log(`Starting to track command with correlation Id ${n}`),this._pendingCommands.set(n,{entityCommand:e,timeoutId:r,previousEvents:new Set})}appendCommandEventData(e,t){const n=this._pendingCommands.get(e);n?this._pendingCommands.set(e,Object.assign(Object.assign({},n),{eventData:Object.assign(Object.assign({},n.eventData),t)})):this._logger.warn(`appendCommandEventData called with correlationId ${e}, but there was no such pending command`)}reportCommandEvent(e,t,n,i,a,o){const r=this._pendingCommands.get(e);if(!r)return;if(!dm.includes(t)&&r.previousEvents.has(t))return;r.previousEvents.add(t);const{entityCommand:s,eventData:l}=r,d=Object.assign(Object.assign(Object.assign({entityCommand:s,commandEvent:t},l),n),{timestamp:Date.now(),scenarioEventData:i,step:a,status:o});t===Qe.B.CommandReportingTimedOut||lm.includes(t)||this._logger.log(`Command event reported ${t} for correlation id ${e}`),lm.includes(t)||this._host.opener.postMessage(N.W.CommandChangeType,d)}registerForCommandTimeOut(e,t){const n=this._pendingCommands.get(e);n&&(n.onCommandTimeOut=t)}unRegisterForCommandTimeOut(e){const t=this._pendingCommands.get(e);t&&(t.onCommandTimeOut=void 0)}appendScenarioEventData(e,t){this.reportCommandEvent(e,Qe.B.ScenarioEventDataAppended,void 0,t)}addScenarioMark(e,t,n,i){this.reportCommandEvent(e,Qe.B.ScenarioMarked,void 0,n,t,i)}cleanUpPendingCommand(e){const t=this._pendingCommands.get(e);t&&(this._host.clearTimeout(t.timeoutId),this._pendingCommands.delete(e))}}class um{constructor(e,t){this.legacyCommandReportingService=e,this.commandChangeReportingService=t,this.commandChangeSubscription=this.setUpCommandChangeSubscriptions()}destroy(){this.commandChangeSubscription.unsubscribe()}changeToCommandReportingService(e){switch(e.type){case Qe.B.AfterOnCommandReceived:case Qe.B.AfterOnEventReceived:case Qe.B.BeforeOnCommandReceived:case Qe.B.BeforeOnEventReceived:case Qe.B.CommandHandledByOnCommandReceived:case Qe.B.EventBubbled:case Qe.B.EventHandled:case Qe.B.DelegatedCommandReceived:break;case Qe.B.ScenarioEventDataAppended:{const{context:{eventData:t},correlationId:n}=e;this.legacyCommandReportingService.appendScenarioEventData(n,t);break}case Qe.B.ScenarioMarked:{const{context:{step:t,eventData:n,status:i,monitoringData:a},correlationId:o}=e;this.legacyCommandReportingService.addScenarioMark(o,t,n,i,a);break}case Qe.B.CommandStart:{const{context:{entityCommand:t,executionContextEntity:n},correlationId:i}=e,{scenarioEventData:a}=t;this.legacyCommandReportingService.registerCommandStart(t),a&&this.legacyCommandReportingService.appendScenarioEventData(i,a),this.legacyCommandReportingService.reportCommandEvent(i,Qe.B.CommandReceived,{executionContextEntity:n});break}case Qe.B.NavigationCommandStart:{const{context:{clientLaunchId:t,correlation:n,eventData:i},correlationId:a}=e;this.legacyCommandReportingService.registerNavigationCommandStart(t,n),this.legacyCommandReportingService.addScenarioMark(a,Qe.B.DeeplinkReceived),i&&this.legacyCommandReportingService.appendScenarioEventData(a,i);break}case Qe.B.CommandMetaDataAdded:{const t=e.context,{target:n}=t,i=(0,c._T)(t,["target"]),{correlationId:a}=e;this.legacyCommandReportingService.appendCommandEventData(a,i);break}case Qe.B.NotHandled:{const{correlationId:t,type:n}=e;this.legacyCommandReportingService.reportCommandEvent(t,n);break}default:{const t=e.context,{target:n,eventData:i}=t,a=(0,c._T)(t,["target","eventData"]),{correlationId:o,type:r}=e;this.legacyCommandReportingService.reportCommandEvent(o,r,a,i);break}}}setUpCommandChangeSubscriptions(){return this.commandChangeReportingService.observeChanges().subscribe((e=>this.changeToCommandReportingService(e)))}}class mm{constructor(e,t,n){this.commandChangeReportingService=e,this.lifeCycleScopeChangeReportingService=t,this.logger=n.newLogger("CommandAppLifeCycleListenerService"),this.lifeCycleScopeChangeSubscription=this.subscribeToLifeCycleScopeChange()}destroy(){var e;null===(e=this.lifeCycleScopeChangeSubscription)||void 0===e||e.unsubscribe()}subscribeToLifeCycleScopeChange(){return this.lifeCycleScopeChangeReportingService.observeChanges().pipe((0,h.U)((({correlationId:e,context:{apps:t}})=>{let n=!1;return t.forEach((({id:t,type:i})=>{i===Tt.c4.Initialized&&(n=!0,this.logger.log(`${t} initialized, correlationId: ${e}`))})),{appInitialized:n,correlationId:e}})),(0,S.h)((({appInitialized:e})=>e))).subscribe((({correlationId:e,appInitialized:t})=>{this.commandChangeReportingService.report({correlationId:e,type:Qe.B.ScenarioEventDataAppended,context:{target:"commandAppLifeCycle",eventData:{appInitialized:t}}})}))}}class gm{constructor(e){this._cap=e,this._map=new Map}entries(){return this._map.entries()}get(e){return this._map.get(e)}set(e,t){if(this._map.size>=this._cap){const e=this._map.keys().next().value;this._map.delete(e)}return this._map.set(e,t)}}class pm{constructor(e){this.commandChangeReportingService=e}init(){this.commandsHistory&&this.destroy(),this.commandsHistory=new gm(30),this.initCommandChangeReportingSubscription()}destroy(){var e;null===(e=this.commandChangeReportingSubscription)||void 0===e||e.unsubscribe(),this.commandChangeReportingSubscription=void 0,this.commandsHistory=void 0}get CommandsHistory(){return this.commandsHistory}initCommandChangeReportingSubscription(){this.commandChangeReportingSubscription=this.commandChangeReportingService.observeChanges().subscribe((e=>this.onCommandChange(e)))}onCommandChange(e){const{correlationId:t}=e;if(this.commandsHistory)if(e.type===Qe.B.CommandStart){const{context:{entityCommand:n}}=e;let i=this.commandsHistory.get(t);const a={entityCommand:n,isCommandTargetedToMainWindow:!1,steps:[]};i=i?Object.assign(Object.assign({},i),{entityCommand:n}):a,this.commandsHistory.set(t,i)}else if(e.type===Qe.B.CommandMetaDataAdded){const{correlationId:t,context:{isCommandTargetedToMainWindow:n}}=e,i=this.commandsHistory.get(t);i&&n&&this.commandsHistory.set(t,Object.assign(Object.assign({},i),{isCommandTargetedToMainWindow:n}))}else{const n=this.commandsHistory.get(t);null==n||n.steps.push({event:e.type,timestamp:Date.now()-(parseInt(n.entityCommand.command.correlation.startTimestamp,10)||0)})}}}function hm(e,t,...n){var i;const{coreSettings:a}=t,o=null!==(i=null==a?void 0:a.get(A.J.Core).enableCoreErrorsV2)&&void 0!==i&&i,r=[];for(const i of n)if(!t[i]&&(r.push(i),!o)){const t=`${e}: ${i} is missing`;throw(0,he.Tr)(_.w5.Core,_.jK.CoreServiceMissing,e,void 0,t)}if(o&&r.length>0)throw Re.fromMissingDependencies(e,r);return t}class vm extends xe{constructor(){super(_.Yg.CreateCommandReportingService,[])}execute(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const n="CreateCommandReportingServiceTask",{commandChangeReportingService:i,coreSettings:a,lifeCycleScopeChangeReportingService:o,loggerFactory:r,scenarioFactory:s,windowProvider:l}=hm(n,e,"coreSettings","commandChangeReportingService","lifeCycleScopeChangeReportingService","loggerFactory","scenarioFactory","windowProvider");if(null===(t=a.get(A.J.Core))||void 0===t?void 0:t.enableStandaloneCommandReportingService){const{commandResultChangeReportingService:t}=hm(n,e,"commandResultChangeReportingService"),o=new xu(r,i,t,l);o.init(),e.commandResultService=o,new sm(i,t,s,r).init(),this.initCommandHistoryService(e,i,a)}else e.commandReportingService=new cm(r,l),new um(e.commandReportingService,i);new mm(i,o,r),this.initCommandHistoryService(e,i,a)}))}initCommandHistoryService(e,t,n){e.commandHistoryService=new pm(t),(null==n?void 0:n.get(A.J.Diagnostics).isDiagnosticsPanelEnabled)&&e.commandHistoryService.init()}}class Sm extends xe{constructor(){super(_.Yg.CreateCommandResultHooksService,[])}execute(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const{appsRegistryService:n,coreSettings:i,client:a,commandResultChangeReportingService:o,entityCommanding:r,loggerFactory:s,scenarioFactory:l}=hm("CreateCommandReportingServiceTask",e,"appsRegistryService","client","commandResultChangeReportingService","coreSettings","entityCommanding","loggerFactory","scenarioFactory");return(null===(t=i.get(A.J.Core))||void 0===t?void 0:t.enableStandaloneCommandReportingService)&&(e.commandResultHooksService=new Sa(n,a,o,i,r,s,l,e.authenticationUser&&(0,qe.b)(e.authenticationUser)),e.commandResultHooksService.init()),Promise.resolve()}))}}var fm=n(40474);const ym=(e,t,n,i)=>{const a=`${e}::TypeError::`;try{return new URL(t,n||void 0)}catch(e){let o=`${a}base::${n}`;throw i&&(o=o.concat(`::url::${t}`)),new fm.Y("URL_PARSE_FAILED",new Error(o))}},km=(e,t,n)=>{let i=!1,a=!1,o=!1,r=!1,s=!1,l=`${e}::`;const d="ProtocolValidationFailed::",c="OriginValidationFailed::";if(t.protocol&&n.protocol?a=!0:l=l.concat(`${d}EmptyProtocol::'${t.protocol}'::'${n.protocol}'`),t.protocol!==n.protocol?l=l.concat(`${d}'${t.protocol}' !== '${n.protocol}'`):o=!0,t.origin&&n.origin?r=!0:l=l.concat(`${c}EmptyOrigin::'${t.origin}'::'${n.origin}'`),t.origin!==n.origin?l=l.concat(`${c}'${t.origin}' !== '${n.origin}'`):s=!0,i=a&&o&&r&&s,!i)throw new fm.Y("URL_VALIDATION_FAILED",new Error(l))},Cm=[{id:"@msteams/components-calling-ppt-sharing#components-calling-ppt-sharing",getConfig:e=>({createScriptURL:(t,n)=>{var i;const a="pptLivePolicy",o=null!==(i=e.get(A.J.Security).pptLiveAllowedOrigin)&&void 0!==i?i:[];if(!Array.isArray(o)||0===o.length)throw new fm.Y("URL_VALIDATION_FAILED",new Error("pptLivePolicy::TypeError::allowedOriginList pptLiveAllowedOrigin is undefined or empty"));let r;const s=ym(a,t,n,!0);for(const e of o)try{const t=ym(a,e,void 0,!0);return km(a,s,t),s.href}catch(e){r=e}throw r}})}],bm=[{id:"@msteams/no-op",getConfig:()=>({createHTML:e=>e,createScriptURL:e=>e})},{id:"@msteams/services-utilities-common#ChunkLoader",getConfig:e=>({createScriptURL:(t,n)=>{var i;const a="chunkLoaderPolicy";let o,r,s,l=!1,d=!1;const c=ym(a,t,n,!0),u=null!==(i=e.get(A.J.Platform).staticsPath)&&void 0!==i?i:"";if(!u)throw new fm.Y("URL_PARSE_FAILED",new Error(`${a}::TypeError::allowListUrl staticsPath is undefined`));try{s=ym(a,u,void 0,!0),km(a,c,s),l=!0}catch(e){o=e}if(l)return c.href;try{s=ym(a,wm,void 0,!0),km(a,c,s),d=!0}catch(e){r=e}if(d)return c.href;if(o)throw o;throw r}})},{id:"@msteams/services-io-browser-web-client-update#register-service-worker",getConfig:()=>({createScriptURL:(e,t)=>{const n="registerServiceWorkerPolicy";let i,a,o=!1;const r=ym(n,e,t,!0);try{a=ym(n,wm,void 0,!0),km(n,r,a),o=!0}catch(e){i=e}if(o)return r.pathname;throw i}})},{id:"@msteams/core-services-telemetry-worker#TelemetryWorker",getConfig:e=>({createScriptURL:(e,t)=>{const n="telemetryWorkerPolicy";let i,a,o=!1;const r=ym(n,e,t,!0);try{a=ym(n,wm,void 0,!0),km(n,r,a),o=!0}catch(e){i=e}if(o)return r.pathname;throw i}})}];function Tm(){return window}const wm=Tm().location.origin;class _m{constructor(e,t){this.coreSettings=e,this.logger=t.newLogger("CoreSecurityService"),this.configMap=new Map,this.policyMap=new Map,this.initializeTrustedTypeConfigMap(),this.setIsTrustedTypePoliciesEnabled()}getTrustedTypePolicy(e){var t,n,i;let a;if(this.isTrustedTypePoliciesEnabled||(e="@msteams/no-op"),a=this.policyMap.get(e),a)return a;if(a=this.createTrustedTypePolicyOnDemand(e),a)return this.policyMap.set(e,a),a;const o=new fm.Y("POLICY_NOT_FOUND",new Error(`${e}`));throw null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`${o.code}::${null===(i=o.prevError)||void 0===i?void 0:i.message}`,"webclient_framework_foundation_core_services_security",void 0,!0),o}createTrustedTypePolicyOnDemand(e){var t,n,i;const a=this.configMap.get(e);if(!a)return;const o=Tm().trustedTypes;if(!this.isTrustedTypePoliciesEnabled||!o)return this.getOptionsAsTrustedTypePolicy(a);try{return o.createPolicy(a.id,a.getConfig(this.coreSettings))}catch(a){const o=new fm.Y("CREATE_POLICY_FAILED",new Error(`${e}${null==a?void 0:a.message}`));throw null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`${o.code}::${null===(i=o.prevError)||void 0===i?void 0:i.message}`,"webclient_framework_foundation_core_services_security",void 0,!0),o}}getOptionsAsTrustedTypePolicy(e){return e.getConfig(this.coreSettings)}initializeConfigs(){Cm.forEach((e=>{this.setConfig(e)}))}initializeCoreConfigs(){bm.forEach((e=>{this.setConfig(e)}))}initializeTrustedTypeConfigMap(){this.initializeCoreConfigs(),this.initializeConfigs()}setConfig(e){if(this.configMap.has(e.id))throw new fm.Y("DUPLICATE_POLICY_FOUND",new Error(`CoreSecurityService::${e.id}`));this.configMap.set(e.id,e)}setIsTrustedTypePoliciesEnabled(){const{enableTrustedTypePolicies:e}=this.coreSettings.get(A.J.Core);this.isTrustedTypePoliciesEnabled=!!e}}class Im extends xe{constructor(){super(_.Yg.CreateCoreSecurityTask,["coreSettings","loggerFactory","windowProvider"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n,windowProvider:i}=e,a=n.newLogger("CoreSecurityService"),o=new _m(t,n);e.coreSecurityService=o,i.chunkLoader.configureCoreSecurityService(o),a.log("CoreSecurityService Initialized")}))}}var Am=n(29289);const Nm="ringFinder";function Em({experienceName:e,coreSettings:t,platformService:n,logger:i,authenticationUser:a}){const o=function(e,t,n){const{primaryUserProfile:i}=e.get(A.J.Host);if(i)return Dm(i);return(null==t?void 0:t.profile)||function(e){try{const e=ct.get(Nm);if(!e)return;const t=JSON.parse(decodeURIComponent(e));return Dm(t)}catch(t){return void e.warn(`Error parsing ringFinder cookie when user not authenticated: ${t}`)}}(n)}(t,a,i),{ecsOverrides:r,config:{platformId:s,buildVersion:l,buildType:d,vdi:c,osPlatform:u}}=n,{ecsNamespaces:m,criticalEcsNamespaces:g,ecsEndpoint:p,enableEcsNativeRingResolution:h}=t.get(A.J.Core),v=function(e,t){const{environment:n="prod",ring:i,originalRing:a}=e,o={environment:n};t&&!a||(o.audienceGroup=i,o.teamsRing=i);return o}(r,h),{ecsHostUrl:S,electronVersion:f,windowsInsiderChannel:y}=t.get(A.J.Host);return{hostUrl:r.hostUrl||S||p,platformId:s,namespaces:m,criticalNamespaces:g,filters:Object.assign(Object.assign({},v),{experience:e,buildType:d,virtualization:null==c?void 0:c.configFilter,osPlatform:u,wip:y,id:null==o?void 0:o.objectId,aaduserid:null==o?void 0:o.objectId,tenantId:null==o?void 0:o.tenantId,experienceBuild:Pm(d,l),desktopVersion:Fm(t,n),electronVersion:f})}}const Dm=e=>({objectId:e.oid,tenantId:e.tid,puid:null});function Fm(e,t){const{desktopVersion:n}=e.get(A.J.Host);if(n){const e=n.indexOf("/");return e>-1?n.substr(e+1):n}return t.host.hostAppVersion}function Pm(e,t){if("local"===e||"container"===e)return"99999999999";if(t){const e="1.0.0.20",n=6;if((t=`${t}`).startsWith(e)){const i=t.substring(e.length,e.length+n),a=t.substring(e.length+n);t=`${i}000${a}`}const i=parseInt(t,10);if(!isNaN(i))return i.toString()}}var Mm,jm=n(33107);!function(e){e[e.Configuration=0]="Configuration",e[e.Override=1]="Override",e[e.ClientFilters=2]="ClientFilters",e[e.Policy=3]="Policy",e[e.TestOverride=4]="TestOverride"}(Mm||(Mm={}));class Rm{constructor(){this.providers={[Mm.Configuration]:[],[Mm.Override]:[],[Mm.ClientFilters]:[],[Mm.Policy]:[],[Mm.TestOverride]:[]}}registerProvider(e,t){this.providers[t].push(e)}getSettings(e){const t=this.mergeProviders(Mm.Configuration,e),n=this.mergeProviders(Mm.Override,e,t),i=this.mergeProviders(Mm.ClientFilters,e),a=this.combineConfigs(n,i,this.filterAndConfigMergeRule),o=this.mergeProviders(Mm.Policy,e),r=this.combineConfigs(a,o,this.policyAndConfigMergeRule);return this.mergeProviders(Mm.TestOverride,e,r)}mergeProviders(e,t,n={}){return this.providers[e].map((e=>e.getSettings())).filter((e=>!!e)).map((e=>(0,Z.pick)(e,t))).reduce(((e,t)=>((0,Z.mergeWith)(e,t,jm.g),e)),n)}combineConfigs(e,t,n){return Object.keys(t).map((i=>{const a=(0,Z.get)(e,i)||{},o=(0,Z.get)(t,i)||{};Object.keys(o).map((t=>{const r=(0,Z.get)(a,t),s=(0,Z.get)(o,t),l=n(r,s);(0,Z.set)(a,t,l),(0,Z.set)(e,i,a)}))})),e}policyAndConfigMergeRule(e,t){return(0,Z.isNil)(e)?t:(0,Z.isNil)(t)?void 0:(0,Z.isBoolean)(t)?e&&t:t}filterAndConfigMergeRule(e,t){return(0,Z.isNil)(e)?t:!!(0,Z.isBoolean)(t)&&(t&&e)}}class xm{constructor(e,t){this.subjectCache=new Map,this.observedCategories=[],this.subscriptions=[],this.notifySettingsChanged=()=>{this.logger.log("Settings have changed, checking for differences in these categories:",this.observedCategories);const e=this.ruleEngine.getSettings(this.observedCategories);this.logger.log("Updated settings:",e),this.observedCategories.forEach((t=>{const n=this.createOrGetSubjectFromCache(t),i=e[t]||{};(0,Z.isEqual)(n.value,i)||(this.logger.log(`Notifying subscribers of: '${t}', settings changed to: `,i),n.next(i))}))},this.logger=t.newLogger(`CoreSettings/Service(${e})`),this.ruleEngine=new Rm,this.logger.log("Created.")}cleanup(){this.logger.log("Cleaning up."),this.subscriptions.forEach((e=>e.unsubscribe()))}get(e){return this.createOrGetSubjectFromCache(e).value}getObservable(e){return this.createOrGetSubjectFromCache(e).asObservable()}registerProvider(e,t){this.ruleEngine.registerProvider(e,t);const n=e.subscribe(this.notifySettingsChanged);this.subscriptions.push(n)}createOrGetSubjectFromCache(e){let t=this.subjectCache.get(e);if(!t){this.observedCategories.push(e);const n=this.getSettingsForCategory(e);t=new u.X(n),this.subjectCache.set(e,t),this.logger.log(`Creating subject for '${e}' category, settings:`,n)}return t}getSettingsForCategory(e){return this.ruleEngine.getSettings([e])[e]||{}}}class Om{constructor(e,t){this.coreSettingsContext=t,this.providers=[],this.logsProviderName="CoreSettingsLogsProvider",this.logger=e.newLogger("CoreSettingsLogsProvider")}getLogsFiles(){return(0,c.mG)(this,void 0,void 0,(function*(){return[{isPiiFree:!1,fileName:"settings.json",content:(yield this.getCurrentSettingsSnapshot())||"Could not fetch settings"}]}))}getSystemInfo(){return Promise.resolve(new Map)}registerProvider(e,t){this.providers.push({provider:e,type:t})}getCurrentSettingsSnapshot(){return(0,c.mG)(this,void 0,void 0,(function*(){try{const e=yield this.coreSettingsContext.getDebugService(),t=e.getSettings(),n=new Map;this.providers.forEach((({provider:e})=>{const t=e.getDiagnosticsInfo();t&&n.set(e.providerName,t)}));const i={settings:this.getGroupedSettings(t),rawPolicies:e.getRawPolicies()||"",providersInfo:[...n.entries()]};return JSON.stringify(i)}catch(e){this.logger.error("Diagnostics: Failed to get settings snapshot: ",e)}return""}))}getGroupedSettings(e){if(!e||0===e.length)return"";return e.reduce(((e,t)=>{var n;if(void 0===t.value&&(!t.providers||0===t.providers.length))return e;e[t.category]=e[t.category]||{},e[t.category][t.key]={};let i=!1;return null===(n=t.providers)||void 0===n||n.forEach((n=>{e[t.category][t.key][n.shortName]=n.value,(0,Z.isEqual)(t.value,n.value)||(i=!0)})),i&&t.providers&&(t.providers.length>1||void 0===t.value)&&(e[t.category][t.key].value=void 0===t.value?"undefined":t.value),e}),{})}}class Lm{constructor(){this.callbacks=[]}subscribe(e){if(!(0,Z.isFunction)(e))throw Error("Callback is not a valid function.");const t=this;t.callbacks.push(e);return{unsubscribe:()=>{const n=t.callbacks.indexOf(e);n>=0&&t.callbacks.splice(n,1)}}}getRawSettings(){}getDiagnosticsInfo(){}cleanup(){}notifySettingsChanged(){this.callbacks.forEach((e=>e()))}}function Um(e,t,n){const i={};return(0,Z.forOwn)(e,((e,a)=>{const o={};(0,Z.forOwn)(e,((e,i)=>{(0,Z.forEach)(e,(e=>!function(e,t){let n=!0;return(0,Z.forOwn)(t,((t,i)=>{const a=(0,Z.get)(e,i)||[];return null==t?n=0===a.length:a.length>0&&(n=a.includes(t)),n})),n}(e,t)||(o[i]=e.value,!1))),!o[i]&&n&&(o[i]=!1)})),o&&!(0,Z.isEmpty)(o)&&(i[a]=o)})),i}class Bm extends Lm{constructor(e,t,n,i){super(),this.configLoader=e,this.platformService=t,this.clientPreferences=n,this.loggerFactory=i,this.logger=i.newLogger("CoreSettings/ConfigProviderDynamic")}cleanup(){var e;null===(e=this.clientPreferencesSubscription)||void 0===e||e.unsubscribe()}getSettings(){return this.settings||{}}getConfigId(){const{ecsOverrides:{environment:e}}=this.platformService;return`${e}`}setConfigs(e){var t,n;this.configs=e,this.applyFilters();(null===(n=null===(t=this.settings)||void 0===t?void 0:t.core)||void 0===n?void 0:n.enableLowPerformanceModeCoreSettingsFilter)&&!this.clientPreferencesSubscription&&(this.clientPreferencesSubscription=this.clientPreferences.getPreferenceObservable("performance").subscribe((({mode:e})=>this.applyFilters(e))))}applyFilters(e){if(!this.configs)return void this.logger.error("Failed to apply filters because configs have not yet been defined.");const t=this.getFilters(e),n=Um(this.configs,t);this.logger.log("Filters:",t),this.logger.log("Filtered settings:",n),this.settings?(0,Z.isEqual)(this.settings,n)||(this.settings=n,this.notifySettingsChanged()):this.settings=n}getFilters(e){const{ecsOverrides:{environment:t},config:{platformId:n,vdi:i,osPlatform:a,buildType:o}}=this.platformService;return{environment:t,platform:n,buildType:o,virtualization:null==i?void 0:i.configFilter,os:a,performanceMode:e}}}class Wm extends Bm{constructor(){super(...arguments),this.providerName="ConfigProviderAsync"}initialize(){return(0,c.mG)(this,void 0,void 0,(function*(){const e=this.getConfigId(),t=yield this.configLoader(e);this.setConfigs(t)}))}}class Gm extends Bm{constructor(){super(...arguments),this.providerName="ConfigProviderSync"}initialize(){const e=this.configLoader("config");this.setConfigs(e)}}const Vm=e=>e!==Ve.pk.VeryActive;function Hm(e,t,n,i){let a;const o=()=>{null==a||a.unsubscribe(),a=void 0,null==s||s.cancel()},r=()=>{e(),o(),t.debug("Notified about settings change")},s=(0,Z.throttle)((e=>{Vm(e)?r():t.log("Throttle executed with VeryActive state, waiting for next state change")}),i||0,{leading:!1,trailing:!0}),l=()=>!n||Vm(n.getState())?(r(),!0):(a||(a=n.observe().subscribe((e=>{Vm(e)&&!i?r():i&&(t.log("Throttled function called"),s(e))}))),t.log(`Postponed settings change notification due to client state being ${Ve.pk[n.getState()]}`),!1);return l.cancel=o,l}class $m extends Lm{constructor(e,t,n,i,a){var o;super(),this.settings={},this.providerName="HostProvider",this.logger=t.newLogger("CoreSettings/HostProvider"),n?(this.logger.log("Host settings found."),this.updateSettingsAndCheckForChanges(n)):this.logger.log("No host settings found."),this.notifySettingsChangedDeferred=Hm((()=>this.notifySettingsChanged()),this.logger,i,a),null===(o=e.opener)||void 0===o||o.addEventListener(K.rY.UpdateWindowState,(e=>{var t,n;if(null==e?void 0:e.payload){let i=e.payload;(null===(n=null===(t=e.payload)||void 0===t?void 0:t.hostSettings)||void 0===n?void 0:n.hostSettings)&&(i=e.payload.hostSettings),this.logger.log("Host settings update received, payload:",i),this.updateSettingsAndCheckForChanges(i)&&this.notifySettingsChangedDeferred()}}))}getSettings(){return this.settings}cleanup(){super.cleanup(),this.notifySettingsChangedDeferred.cancel()}updateSettingsAndCheckForChanges(e){const t=Object.assign({},this.settings.host),n=Object.assign({},this.settings.metadata);e.hostSettings&&Object.assign(t,e.hostSettings),e.desktopSettings&&Object.assign(t,e.desktopSettings),this.updateSettings(t,n,e);const i={[A.J.Host]:t,[A.J.Metadata]:n};return(0,Z.isEqual)(this.settings,i)?(this.logger.log("Host settings did not change."),!1):(this.settings=i,this.logger.log("Host settings updated to:",this.settings),!0)}updateSettings(e,t,n){var i;if(n.bootstrapData&&(e.authBootstrapData=n.bootstrapData),(null===(i=n.hostSettings)||void 0===i?void 0:i.hostETag)&&(t.hostETag=n.hostSettings.hostETag),n.dataLayerSettings){const t=n.dataLayerSettings,i=t.query||[],a=t.mutation||[],o=t.subscription||[];e.dataLayerSettings={query:i,mutation:a,subscription:o}}}}class zm extends Lm{constructor(e){super(),this.settings={},this.providerName="MaglevHostProvider",this.logger=e.newLogger("CoreSettings/MaglevHostProvider")}initialize(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=yield this.getWindowsInsiderChannel(e);this.settings={[A.J.Host]:{windowsInsiderChannel:t}},this.notifySettingsChanged()}))}getSettings(){return this.settings}getWindowsInsiderChannel(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){try{const n=yield e.loadModule("ecs");return yield null===(t=null==n?void 0:n.getWindowsInsiderChannel)||void 0===t?void 0:t.call(n)}catch(e){this.logger.warn("Unable to get windows insider channel from host:",e)}}))}}const qm=["EducationStudent","EducationFaculty"],Jm=["A1","A3","A5"];class Qm extends Lm{constructor(e,t){super(),this.loggerFactory=e,this.configLoader=t,this.settings={},this.providerName="ClientFiltersProvider",this.logger=this.loggerFactory.newLogger("CoreSettings/ClientFiltersProvider")}initialize(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){const n=yield this.getClientFilterParams(e,t);this.settings=this.filterSettings(n),this.notifySettingsChanged()}))}getSettings(){return this.settings}filterSettings(e){const t=Um(this.configLoader("clientFilters"),e,!0);return this.logger.debug(`Calculated client filters for ${(0,R.u4)(e)}:`,t),t}getClientFilterParams(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){const n=yield this.getUserLicenseFilter(e);return Object.assign(Object.assign({},n),t)}))}getUserLicenseFilter(e){var t,n;return(0,c.mG)(this,void 0,void 0,(function*(){let i,a,o=!0;const{eduLicenseSkuAndCategory:r,region:s}=yield e.getUser(),l=null==s?void 0:s.toLowerCase();if(!r)return{userLicenseSku:i,userLicenseCategory:a,region:l};if(r.trim().length>0&&r.includes("_")){const[e,t]=r.split("_");e&&t&&Jm.find((t=>t===e))&&qm.find((e=>e===t))&&(i=e,a=t,o=!1)}return o&&(null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`Received invalid data ${r}`,"webclient_framework_foundation_core_services",void 0,!0)),{userLicenseSku:i,userLicenseCategory:a,region:l}}))}}var Km;!function(e){e[e.Valid=0]="Valid",e[e.Expired=1]="Expired",e[e.NoData=2]="NoData"}(Km||(Km={}));const Ym="tmp";var Xm;function Zm(e,t){return[Ym,null==t?void 0:t.experienceName,null==t?void 0:t.userId,null==t?void 0:t.environment,null==t?void 0:t.ring,e].filter((e=>!(0,Z.isNil)(e))).join(".")}!function(e){e.TestOverrides="settings",e.EcsCache="ecs-settings-cache",e.PolicyCache="policy-cache"}(Xm||(Xm={}));const eg="CachedProvider";class tg extends Lm{constructor(e,t,n,i){super(),this.storage=t,this.providerName=eg,this.updateCache=()=>(0,c.mG)(this,void 0,void 0,(function*(){if(!this.provider)return;const e=this.provider.getSettings();e&&0!==Object.keys(e).length?(this.settings=e,yield this.storage.setItem(this.storageKey,JSON.stringify(this.settings)),this.logger.log(`Cache '${this.storageKey}' updated.`),this.notifySettingsChanged()):this.logger.log(`Got empty settings from provider. Cache State: ${Km[this.cacheState]} (Storage key: ${this.storageKey})`)})),this.storageKey=Zm(e,i),this.logger=n.newLogger("CoreSettings/CachedProvider")}initialize(){return(0,c.mG)(this,void 0,void 0,(function*(){this.settings=yield this.loadCache()}))}setProvider(e){return(0,c.mG)(this,void 0,void 0,(function*(){this.cleanup(),this.provider=e,this.providerName=`CachedProvider:${this.provider.providerName}`,this.subscription=this.provider.subscribe(this.updateCache),yield this.updateCache()}))}getProvider(){return this.provider}getSettings(){return this.settings}getDiagnosticsInfo(){return this.provider?this.provider.getDiagnosticsInfo():super.getDiagnosticsInfo()}get cacheState(){return this.getCacheState()}cleanup(e=!1){var t;this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0),this.providerName=eg,null===(t=this.provider)||void 0===t||t.cleanup(),e&&this.storage.removeItem(this.storageKey)}getCacheState(){return this.settings?Km.Valid:Km.NoData}loadCache(){return(0,c.mG)(this,void 0,void 0,(function*(){let e;try{const t=yield this.storage.getItem(this.storageKey);t&&(e=JSON.parse(t))}catch(e){this.logger.log(`Error while loading from cache '${this.storageKey}', error:`,e)}return e}))}}class ng extends tg{constructor(e,t,n,i){super(e,t,n,i)}getExpiration(){var e,t;const n=null===(t=null===(e=this.settings)||void 0===e?void 0:e.metadata)||void 0===t?void 0:t.expires;return n&&!isNaN(Date.parse(n))?new Date(n):void 0}getCacheState(){if(!this.settings)return Km.NoData;const e=this.getExpiration();return e&&e.valueOf()>Date.now()?Km.Valid:Km.Expired}}class ig extends Lm{constructor(e,t){super(),this.workerHostSettings=t,this.providerName="WorkerHostProvider",this.logger=e.newLogger("CoreSettings/WorkerHostSettingsProvider"),this.hostSettings={},this.testSettings={},this.logger.log("Worker host settings is initialized",this.hostSettings),t.subscribeToHostSettingsUpdates((()=>(0,c.mG)(this,void 0,void 0,(function*(){const e=yield t.getHostSettings();this.hostSettings=e.hostSettings,this.testSettings=e.testSettings,this.notifySettingsChanged()}))))}initialize(){return(0,c.mG)(this,void 0,void 0,(function*(){const e=yield(0,Oe.E)(this.workerHostSettings.getHostSettings(),1e4).catch((e=>(this.logger.error(`retrieve worker host setting timed out, the error is ${e}`),{hostSettings:{},testSettings:{}})));this.hostSettings=e.hostSettings,this.testSettings=e.testSettings,this.logger.log("Worker host setting is being initialized")}))}getSettings(){const e=this.hostSettings.cdlWorkerSettings||{},t=Object.assign({},this.hostSettings);return delete t.cdlWorkerSettings,Object.assign(Object.assign({},e),{[A.J.Host]:t,[A.J.Test]:this.testSettings})}}class ag extends Lm{constructor(e,t,n){super(),this.loggerFactory=e,this.configLoader=n,this.providerName="ViewportOverrideProvider",this.logger=this.loggerFactory.newLogger("CoreSettings/ViewportOverrideProvider"),this.settings=this.filterSettings(t)}getSettings(){return this.settings}hasOverrides(){return!(0,Z.isEmpty)(this.settings)}hasDifferences(e){const t=this.filterSettings(e);return!(0,Z.isEqual)(this.settings,t)}filterSettings(e){const t=Um(this.configLoader("viewportOverrides"),e);return this.logger.debug(`Calculated overrides for ${(0,R.u4)(e)}:`,t),t}}class og extends Lm{constructor(e,t,n,i){super(),this.host=t,this.providerName="LocalStorageProvider",this.onStorageEvent=e=>{e.key===this.storageKey&&(this.logger.log("Local storage settings updated."),this.settings=this.loadStorageSettings(),this.notifySettingsChanged())},this.logger=n.newLogger("CoreSettings/LocalStorageProvider"),this.storageKey=Zm(e,i),this.settings=this.loadStorageSettings(),this.host.addEventListener("storage",this.onStorageEvent)}getSettings(){return this.settings}cleanup(){this.host.removeEventListener("storage",this.onStorageEvent)}setSettings(e){try{this.host.localStorage.setItem(this.storageKey,(0,R.u4)(e))}catch(e){this.logger.log("Could not write settings to local storage, error:",e)}this.settings=e,this.notifySettingsChanged()}clearSettings(){this.host.localStorage.removeItem("tmp.settings"),this.settings={}}loadStorageSettings(){const e=this.host.localStorage.getItem(this.storageKey);if(e)try{return JSON.parse(e)}catch(e){this.logger.log(`Could not parse settings stored in local storage, key: ${this.storageKey}, error: ${e}`)}return{}}}class rg extends Lm{constructor(e,t){super(),this.clientPreferencesService=e,this.providerName="ClientPreferencesProvider",this.logger=t.newLogger("CoreSettings/ClientPreferencesProvider"),this.settings=this.loadClientPreferences(),this.setupSubscription()}getSettings(){return this.settings}cleanup(){var e;null===(e=this.clientPreferencesSubscription)||void 0===e||e.unsubscribe()}loadClientPreferences(){const e=this.clientPreferencesService.getPreferences("diagnosticsLogs");if(void 0!==(null==e?void 0:e.shouldPersistLogsIntoIDB))try{return{diagnostics:{clientExtendedDiagnosticsData:!!(null==e?void 0:e.shouldPersistLogsIntoIDB)}}}catch(t){this.logger.log(`Could not parse client preferences, ${e}, error: ${t}`)}return{}}setupSubscription(){const e=this.clientPreferencesService.getPreferenceObservable("diagnosticsLogs");this.clientPreferencesSubscription=e.subscribe((e=>this.clientPreferenceUpdateHandler(e)))}clientPreferenceUpdateHandler(e){var t,n;!!(null==e?void 0:e.shouldPersistLogsIntoIDB)!=!!(null===(n=null===(t=this.settings)||void 0===t?void 0:t.diagnostics)||void 0===n?void 0:n.clientExtendedDiagnosticsData)&&(this.settings={diagnostics:{clientExtendedDiagnosticsData:!!(null==e?void 0:e.shouldPersistLogsIntoIDB)}},this.notifySettingsChanged())}}class sg extends Lm{constructor(e){super(),this.providerName="ApiServiceProvider",this.logger=e.newLogger("CoreSettings/ApiServiceProvider"),this.settings=this.loadApiSwitcherSettings()}getSettings(){return this.settings}setOverrides(e){this.settings=this.loadApiSwitcherSettings(e),this.notifySettingsChanged()}loadApiSwitcherSettings(e){if((null==e?void 0:e.configs)&&(null==e?void 0:e.id))try{const t=e.configs,n=e.id;return{apiService:{serviceConfig:t},auth:this.getAuthOverrides(e.configs),metadata:{serviceId:n}}}catch(e){this.logger.log(`Could not parse settings stored in local storage , error: ${e}`)}return{}}getAuthOverrides(e){return{authzEndpointUrl:null==e?void 0:e.authzEndpointUrl,authzResource:null==e?void 0:e.authzResource,regionGtmsEnv:null==e?void 0:e.regionGtmsEnv}}}class lg{constructor(e){this.logger=e.newLogger("CoreSettings/QspSettingsParser")}parse(e,t={}){return new URLSearchParams(e).forEach(((e,n)=>{const i=this.parseQspSetting(n,e);i&&(this.logger.log("QSP override: ",i.key,i.value),(0,Z.set)(t,i.key,i.value))})),t}parseQspSetting(e,t){const n=this.extractQspKeyObject(e);if("config"===n.config)return{key:`${n.category}.${n.featureName}`,value:this.tryGetBooleanValueOrReturnOriginalValue(t)}}extractQspKeyObject(e){const t=e.split(".");let n="";for(let e=2;e<t.length;e++)n+=t[e],e<t.length-1&&(n+=".");return{config:t[0],category:t[1],featureName:n}}tryGetBooleanValueOrReturnOriginalValue(e){const t=e.toLowerCase();return"true"===t||"false"===t?"true"===t:encodeURIComponent(e)}}class dg extends Lm{constructor(e,t,n,i){super(),this.host=e,this.platformService=t,this.experienceName=i,this.providerName="QspProvider",this.settings={},(this.platformService.config.isInternalUser||"meeting-options"===this.experienceName)&&(this.parser=new lg(n))}getSettings(){return this.parseQsp(),this.settings}parseQsp(){if(!this.parser)return;const e={};this.host.location.search&&this.parser.parse(this.host.location.search,e);const t=this.getQueryStringFromHash();t&&this.parser.parse(t,e),this.platformService.config.isInternalUser?this.settings=e:"meeting-options"===this.experienceName&&this.populateAllowList(e)}getQueryStringFromHash(){const e=this.host.location.hash;if(!e)return null;const t=e.indexOf("?");return t>-1?e.substr(t):null}populateAllowList(e){const t={};e&&(e.meetingOptions&&(t.meetingOptions={},e.meetingOptions.isClientSideInviteeListSupported&&(t.meetingOptions.isClientSideInviteeListSupported=e.meetingOptions.isClientSideInviteeListSupported),e.meetingOptions.isClientSideSensitivityLabelSupported&&(t.meetingOptions.isClientSideSensitivityLabelSupported=e.meetingOptions.isClientSideSensitivityLabelSupported)),e.host&&(t.host={},e.host.skin&&(t.host.skin=e.host.skin),e.host.headless&&(t.host.headless=e.host.headless))),this.settings=t}}var cg,ug=n(27645);!function(e){e.None="0",e.CitrixXenDesktop="1",e.CitrixXenApp="2",e.VMWare="3",e.WVD="5"}(cg||(cg={}));class mg extends Lm{constructor(e){super(),this.platformService=e,this.providerName="PlatformProvider",this.platformSettings={[A.J.Platform]:{buildType:this.platformService.config.buildType,buildVersion:this.platformService.config.buildVersion,clientVersion:this.platformService.config.clientVersion,deviceInfo:this.platformService.host.deviceInfo,enableSlotBorderRadius:this.getEnableSlotBorderRadius(),isHtmlInputSelectApiSupported:this.getIsHtmlInputSelectApiSupported(),isScreenRecordingPermissionRequired:this.getIsScreenRecordingPermissionRequired(),localeCode:this.platformService.config.localeCode,sessionId:this.platformService.host.sessionId,staticsPath:this.platformService.config.staticsPath,useMacKeyboardLayout:this.getUseMacKeyboardLayout(),vdi:this.getVdiSettings()},[A.J.Metadata]:{environment:this.platformService.ecsOverrides.environment,ring:{id:this.platformService.ecsOverrides.ring}}}}getSettings(){return this.platformSettings}updateUserMetadataProperties(e){const t=Object.assign(Object.assign({},this.platformSettings.metadata),{region:e.region});this.platformSettings=Object.assign(Object.assign({},this.platformSettings),{[A.J.Metadata]:t}),this.notifySettingsChanged()}getVdiSettings(){const{vdi:e}=this.platformService.config;if(e){const{provider:t,mode:n,isAvRemoted:i,configFilter:a}=e;return{provider:(e=>{switch(e){case cg.CitrixXenDesktop:return E.$w.CitrixXenDesktop;case cg.CitrixXenApp:return E.$w.CitrixXenApp;case cg.VMWare:return E.$w.VMWare;case cg.WVD:return E.$w.WVD;default:return E.$w.None}})(t),mode:n,isAvRemoted:i,configFilter:a}}}getIsHtmlInputSelectApiSupported(){return this.platformService.config.osPlatform!==Fo.NR.IOS}getUseMacKeyboardLayout(){return this.platformService.config.osPlatform===Fo.NR.Mac}getIsScreenRecordingPermissionRequired(){if(this.platformService.config.clientType===Fo.Bh.Web||this.platformService.config.osPlatform!==Fo.NR.Mac||!this.platformService.config.osVersion)return!1;const e=this.platformService.config.osVersion.toString();return(0,ug.compare)(e,"10.15",">=")}getEnableSlotBorderRadius(){return this.platformService.config.osPlatform===Fo.NR.Mac}}class gg extends Lm{constructor(e,t){super(),this.workerHostSettings=t,this.providerName="WorkerHostTestOverridesProvider",this.logger=e.newLogger("CoreSettings/WorkerHostTestOverridesProvider"),this.settings={},t.subscribeToHostSettingsUpdates((()=>(0,c.mG)(this,void 0,void 0,(function*(){const e=yield t.getHostSettings();this.settings=(0,Z.merge)({},e.localStorageTestOverrides,e.qspTestOverrides),this.notifySettingsChanged()}))))}initialize(){return(0,c.mG)(this,void 0,void 0,(function*(){const e=yield(0,Oe.E)(this.workerHostSettings.getHostSettings(),1e4).catch((e=>(this.logger.error(`Retrieving worker host setting timed out, the error is ${e}`),{localStorageTestOverrides:{},qspTestOverrides:{}})));this.settings=(0,Z.merge)({},e.localStorageTestOverrides,e.qspTestOverrides),this.logger.log("Worker host test overrides setting is being initialized")}))}getSettings(){return this.settings}}var pg=n(91073);class hg extends Lm{constructor(e,t,n,i,a,o,r,s,l,d=18e5){super(),this.coreSettings=t,this.loggerFactory=n,this.scenarioFactory=i,this.host=a,this.clientStateProvider=o,this.networkStateProvider=r,this.endpointsManager=s,this.incompleteBootAttemptsCounter=l,this.refreshIntervalInMs=d,this.isInitialized=!1,this.providerName="EcsProvider",this.onEcsClientConfigurationFetch=e=>{this.handleEcsConfigurationData(e,this.createScenario(!1))};const c=`CoreSettings/${this.providerName}`;this.logger=n.newLogger(c),this.ecsClientFetchMode=Am.zd.Manual,this.ecsParameters=Object.assign({},e),this.ecsClient=new pg.X(this.ecsParameters,c,this.endpointsManager,this.host,this.loggerFactory,this.clientStateProvider,this.networkStateProvider,Am.Wp.AbortWhenVeryActive),this.notifySettingsChangedDeferred=Hm((()=>this.notifySettingsChanged()),this.logger,o,this.coreSettings.get(A.J.Core).ecsNotifySettingsChangedDelayInMs)}initialize(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){if(this.isInitialized)return!1;let n=!0;const i=this.performManualFetch(!0);e&&(n=yield i);const a=this.coreSettings.get(A.J.Core).ecsProviderFetchMode;switch(this.ecsClientFetchMode=null!==(t=function(e){const t=Object.keys(Am.zd).filter((e=>isNaN(Number(e))));for(let n=0;n<t.length;n++)if(e===t[n])return n}(a))&&void 0!==t?t:Am.zd.WhenExpired,this.ecsClientFetchMode){case Am.zd.FixedInterval:this.ecsClient.startFixedIntervalFetchSchedule(this.onEcsClientConfigurationFetch,this.refreshIntervalInMs/6e4);break;case Am.zd.WhenExpired:this.ecsClient.startWhenExpiredFetchSchedule(this.onEcsClientConfigurationFetch);break;default:throw new Error(`${Am.zd[this.ecsClientFetchMode]} fetch mode is not supported`)}return this.isInitialized=!0,n}))}getSettings(){return this.settings}getDiagnosticsInfo(){return this.ecsClient.getDiagnosticInfo()}cleanup(){super.cleanup(),this.notifySettingsChangedDeferred.cancel(),this.ecsClient.stopFetchSchedule()}updateEcsParametersAndFetchSettings(e){return(0,c.mG)(this,void 0,void 0,(function*(){this.ecsParameters=Object.assign({},e);this.ecsClient.updateParameters(e)?this.isInitialized?(this.logger.log("Refresh required, manually fetching settings ..."),yield this.performManualFetch(!1)):this.logger.log("Refresh required but provider not initialized, skipping settings fetch."):this.logger.log("No refresh required, ECS parameters haven't changed.")}))}updateRefreshInterval(e){this.refreshIntervalInMs!==e&&(this.refreshIntervalInMs=e,this.logger.debug("Refresh interval changed to",this.refreshIntervalInMs),this.isInitialized&&(this.ecsClientFetchMode===Am.zd.FixedInterval?this.ecsClient.startFixedIntervalFetchSchedule(this.onEcsClientConfigurationFetch,this.refreshIntervalInMs/6e4):this.logger.debug(`Refresh interval not used when in ${Am.zd[this.ecsClientFetchMode]} fetch mode, ignoring}`)))}performManualFetch(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=this.createScenario(e);try{this.logger.debug("Awaiting manual ECS fetch...");const e=yield this.ecsClient.getConfigurationAsync();return this.logger.debug("Manual ECS fetch complete."),this.handleEcsConfigurationData(e,t)}catch(e){return t.fail({errors:e.message}),this.logger.warn("Manual ECS fetch failed.",e),!1}}))}notifyEcsFetchComplete(){this.incompleteBootAttemptsCounter.markBootAttemptComplete()}handleEcsConfigurationData(e,t){var n;this.notifyEcsFetchComplete();let i=!1,a=!1;switch(e.requestStatus){case Am.m1.Success:if(!e.ecsConfiguration||!e.headers){t.fail({errors:"Empty headers or ECS configuration"});break}try{this.settings=this.extractSettings(e.ecsConfiguration,e.headers)}catch(e){t.fail({errors:`Extracting settings failed - ${(null==e?void 0:e.message)||"unknown error"}`});break}a=this.notifySettingsChangedDeferred(),this.logger.log("Settings updated to:",this.settings),t.stop({message:JSON.stringify({settingsUpdated:!0,notified:a})}),i=!0;break;case Am.m1.Success_NoChanges:if(!e.headers){t.fail({errors:"Empty headers"});break}this.settings=Object.assign(Object.assign({},this.settings),{metadata:Object.assign(Object.assign({},null===(n=this.settings)||void 0===n?void 0:n.metadata),{expires:e.headers.Expires.toString()})}),a=this.notifySettingsChangedDeferred(),this.logger.debug("Settings are the same."),t.stop({message:JSON.stringify({settingsUpdated:!1,headersUpdated:!0,notified:a})}),i=!0;break;case Am.m1.Abandoned_ClientVeryActive:this.logger.debug("Skipping override settings check due to app being in a very active state."),t.stop({message:"very active"},"abandoned");break;case Am.m1.Abandoned_NoNetwork:this.logger.debug("Skipping override settings check due to app being offline."),t.stop({message:"no network"},"abandoned");break;case Am.m1.Error_BrowserError:t.stop({errors:`${e.errorMessage} - BrowserError`},"abandoned");break;case Am.m1.Error_TimedOut:t.stop({errors:e.errorMessage},"timeout");break;case Am.m1.Error_TransformFailed:case Am.m1.Error_Unknown:t.fail({errors:e.errorMessage});break;case Am.m1.NotStarted:t.fail({errors:"ECS client is in a corrupt state - received a 'NotStarted' request status"});break;default:t.fail({errors:`Received unknown request status value of ${Am.m1[e.requestStatus]}`})}return i}createScenario(e){const t=this.scenarioFactory.newScenario(ee.RG.EcsProviderFetch);return t.appendEventData({endpointUrl:this.ecsClient.getDiagnosticInfo().fetchUrl,operation:e?"initial":"refresh",correlationId:t.id}),t}extractSettings(e,t){if((0,Z.isNil)(this.ecsParameters.namespaces))return{};let n={};const i=[],a=this.ecsParameters.criticalNamespaces||[];return this.ecsParameters.namespaces.forEach((t=>{var o;const r=e[t];if(a.includes(t)&&(0,Z.isNil)(r))throw new Error(`ECS payload is missing configurations for critical namespace '${t}'`);const s=null===(o=null==e?void 0:e.ConfigIDs)||void 0===o?void 0:o[t];if(s){const e=s.split(",");i.push(...e.filter((e=>e.startsWith("P-E"))))}n=Object.assign(Object.assign({},n),r)})),n=Object.assign(Object.assign({},n),{metadata:Object.assign(Object.assign({},n.metadata),{eTag:t.ETag,expires:t.Expires.toString(),configIds:{experiments:i}})}),n}}class vg extends Lm{constructor(e,t,n,i){super(),this.policiesDataProvider=t,this.configLoader=n,this.enablePoliciesDefaultValues=i,this.providerName="PolicyProvider",this.refreshSettings=e=>{this.rawPolicies=e;const t=this.policySettings,n=this.mapPoliciesToSettings(e);if(this.enablePoliciesDefaultValues){const e=(0,Z.cloneDeep)(this.policySettingsDefaults);this.policySettings=(0,Z.mergeWith)(e,n,jm.g)}else this.policySettings=n;(0,Z.isEqual)(t,this.policySettings)?this.logger.log("No changes detected."):(this.logger.log("Policy settings updated to: ",this.policySettings),this.notifySettingsChanged())},this.logger=e.newLogger("CoreSettings/PolicyProvider"),this.policiesDataProvider.subscribeForSettingsUpdates(this.refreshSettings),this.policySettingsDefaults={},this.rawPolicies={}}initialize(){return(0,c.mG)(this,void 0,void 0,(function*(){this.policiesJson=this.configLoader("policies").mappings,this.logger.log("Loaded policies mapping: ",this.policiesJson),this.enablePoliciesDefaultValues&&this.policiesJson&&(this.policySettingsDefaults=this.getPolicySettingsDefaults(this.policiesJson),this.policySettings=(0,Z.cloneDeep)(this.policySettingsDefaults),this.logger.log("Loaded default for policies settings: ",this.policySettingsDefaults)),yield this.policiesDataProvider.initialize(!0),this.logger.log("Initial fetch completed.")}))}getSettings(){return this.policySettings}getRawSettings(){return this.rawPolicies}cleanup(){this.policiesDataProvider.cleanup()}getPolicySettingsDefaults(e){const t={};return Object.keys(e).map((e=>{const n={},i=(0,Z.get)(this.policiesJson,e);Object.keys(i).map((e=>{const t=(0,Z.get)(i,e);if(t&&(0,Z.has)(t,"defaultValue")){const i=(0,Z.get)(t,"defaultValue");(0,Z.set)(n,e,i)}})),(0,Z.set)(t,e,n)})),t}mapPoliciesToSettings(e){const t={};return this.policiesJson&&Object.keys(this.policiesJson).map((n=>{const i={},a=(0,Z.get)(this.policiesJson,n);Object.keys(a).map((t=>{const n=(0,Z.get)(a,t);if(n&&(0,Z.has)(n,"name")){const a=(0,Z.get)(n,"name"),o=(0,Z.get)(e,a);(0,Z.set)(i,t,o)}})),(0,Z.set)(t,n,i)})),t}}class Sg{constructor(e){this.host=e}setItem(e,t){return this.host.localStorage.setItem(e,t),Promise.resolve()}getItem(e){const t=this.host.localStorage.getItem(e);return Promise.resolve(t)}removeItem(e){return this.host.localStorage.removeItem(e),Promise.resolve()}}class fg{constructor(e){this.cacheMap=new Map,this.logger=e.newLogger("CoreSettings/ContextCache")}cache(e,t){if(this.cacheMap.has(e))throw new Error(`Context '${e}' already stored.`);this.cacheMap.set(e,{context:t,refCount:1}),this.logger.debug(`Context '${e}' cached.`)}acquire(e,t){const n=this.cacheMap.get(e);if(n)return n.refCount++,this.logger.debug(`Acquiring context '${e}', ref count: '${n.refCount}'.`),n.context;if(!t)throw new Error(`Context '${e}' not found in cache.`);this.logger.debug(`Context '${e}' not found in cache, constructing...`);const i=t();return this.cache(e,i),i}release(e,t){const n=this.cacheMap.get(e);if(!n)throw new Error(`Cannot release context '${e}', not found in cache.`);n.refCount--,this.logger.debug(`Releasing context '${e}', ref count: '${n.refCount}'.`),0===n.refCount&&(t(),this.cacheMap.delete(e))}}const yg="incomplete-boot-attempts";class kg{constructor(e,t,n){if(this.coreSettings=e,this.storage=n,this.pastAttemptsCount=0,this.logger=t.newLogger("CoreSettings/IncompleteBootAttemptsCounter"),!n)return void this.logger.debug("Disabled because no storage is available.");this.pastAttemptsCount=function(e){if(!e)return 0;try{return parseInt(e,10)}catch(e){return 0}}(n.get(yg));const i=this.pastAttemptsCount+1;n.setSafe(yg,`${i}`),this.logger.debug(`Set past incomplete boot count to ${i}.`)}markBootAttemptComplete(){this.storage&&(this.pastAttemptsCount>0&&this.logger.debug("Boot attempt complete, incomplete boot counter reset to 0."),this.storage.setSafe(yg,"0"),this.pastAttemptsCount=0)}get tooManyPastAttempts(){if(!this.storage)return this.logger.debug("No blocking fetch because storage is unavailable."),!1;const e=this.coreSettings.get(A.J.Core).maxBootAttemptsWithoutEcsFetch;if(!e)return this.logger.debug("No blocking fetch because incomplete boot count limit is unset or zero."),!1;const t=this.pastAttemptsCount>=e;return this.logger.debug(`Too many attempts: ${t}`),t}}class Cg extends class{constructor(e,t,n,i,a,o,r,s,l){this.id=e,this.experienceName=t,this.cache=n,this.loggerFactory=i,this.platformService=a,this.clientPreferences=o,this.configLoader=r,this.partitionCacheByExperience=s,this.localStorage=l,this.logger=this.loggerFactory.newLogger(`CoreSettings/Context(${e})`),this.cleanupFunctions=[],this.logger.log("Created.")}cleanup(e){this.cache.release(this.id,(()=>{this.logger.log("Cleaning up."),this.cleanupFunctions.forEach((t=>t(e)))}))}getCoreSettings(){return this.settingsService||(this.settingsService=new xm(this.id,this.loggerFactory),this.registerProvider(Mm.Configuration,this.configProvider),this.registerProvider(Mm.Configuration,this.platformProvider),this.registerProvider(Mm.Configuration,this.hostProvider),this.registerProvider(Mm.Configuration,this.maglevHostProvider),this.registerProvider(Mm.Configuration,this.workerHostProvider),this.registerProvider(Mm.Configuration,this.clientPreferencesProvider),this.registerProvider(Mm.Configuration,this.ecsCachedProvider),this.registerProvider(Mm.Override,this.viewportOverrideProvider),this.registerProvider(Mm.ClientFilters,this.clientFiltersProvider),this.registerProvider(Mm.Policy,this.policyCachedProvider),this.registerProvider(Mm.TestOverride,this.apiServiceProvider),this.registerProvider(Mm.TestOverride,this.localStorageProvider),this.registerProvider(Mm.TestOverride,this.qspProvider),this.registerProvider(Mm.TestOverride,this.workerTestProvider),this.registerProvider(Mm.TestOverride,this.workerHostTestOverridesProvider),this.cleanupFunctions.push((()=>{var e;null===(e=this.settingsService)||void 0===e||e.cleanup(),this.settingsService=void 0}))),this.settingsService}getLogsProvider(){return this.logsProvider||(this.logsProvider=new Om(this.loggerFactory,this)),this.logsProvider}getDebugService(){return(0,c.mG)(this,void 0,void 0,(function*(){if(!this.debugSettingsService){const{DebugSettingsService:e}=yield n.e(6842).then(n.bind(n,17116));this.debugSettingsService=new e(this,this.loggerFactory,this.id)}return this.debugSettingsService}))}updateUserMetadataProperties(e){this.platformProvider&&e&&this.platformProvider.updateUserMetadataProperties(e)}registerProvider(e,t){this.settingsService&&t&&(this.settingsService.registerProvider(t,e),this.getLogsProvider().registerProvider(t,e))}createConfigProviderAsync(){return(0,c.mG)(this,void 0,void 0,(function*(){this.configProvider=new Wm(this.configLoader,this.platformService,this.clientPreferences,this.loggerFactory),yield this.configProvider.initialize(),this.cleanupFunctions.push((()=>{var e;null===(e=this.configProvider)||void 0===e||e.cleanup()}))}))}createConfigProviderSync(){this.configProvider=new Gm(this.configLoader,this.platformService,this.clientPreferences,this.loggerFactory),this.configProvider.initialize(),this.cleanupFunctions.push((()=>{var e;null===(e=this.configProvider)||void 0===e||e.cleanup()}))}createHostProvider(e,t){this.hostProvider=new $m(e,this.loggerFactory,t),this.cleanupFunctions.push((()=>{var e;null===(e=this.hostProvider)||void 0===e||e.cleanup()}))}createMaglevHostProvider(){this.maglevHostProvider=new zm(this.loggerFactory),this.cleanupFunctions.push((()=>{var e;null===(e=this.maglevHostProvider)||void 0===e||e.cleanup()}))}createClientFiltersProvider(){this.clientFiltersProvider=new Qm(this.loggerFactory,this.configLoader),this.cleanupFunctions.push((()=>{var e;null===(e=this.clientFiltersProvider)||void 0===e||e.cleanup()}))}createEcsCachedProvider(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{ring:t,environment:n}=this.platformService.ecsOverrides,i="general"===t?void 0:t,a="prod"===n?void 0:n,o=this.partitionCacheByExperience?this.experienceName:void 0;this.ecsCachedProvider=new ng(Xm.EcsCache,e,this.loggerFactory,{experienceName:o,ring:i,environment:a}),yield this.ecsCachedProvider.initialize(),this.cleanupFunctions.push((()=>{var e;null===(e=this.ecsCachedProvider)||void 0===e||e.cleanup()}))}))}createWorkerTestProvider(e){return(0,c.mG)(this,void 0,void 0,(function*(){this.workerTestProvider=new tg(Xm.TestOverrides,e,this.loggerFactory),yield this.workerTestProvider.initialize(),this.cleanupFunctions.push((()=>{var e;null===(e=this.workerTestProvider)||void 0===e||e.cleanup()}))}))}createWorkerHostTestOverridesProvider(e){return(0,c.mG)(this,void 0,void 0,(function*(){this.workerHostTestOverridesProvider=new gg(this.loggerFactory,e),yield this.workerHostTestOverridesProvider.initialize(),this.cleanupFunctions.push((()=>{var e;null===(e=this.workerHostTestOverridesProvider)||void 0===e||e.cleanup()}))}))}createWorkerHostProvider(e){return(0,c.mG)(this,void 0,void 0,(function*(){this.workerHostProvider=new ig(this.loggerFactory,e),yield this.workerHostProvider.initialize(),this.cleanupFunctions.push((()=>{var e;null===(e=this.workerHostProvider)||void 0===e||e.cleanup()}))}))}createViewportOverrideProvider(e){this.viewportOverrideProvider=new ag(this.loggerFactory,e,this.configLoader),this.cleanupFunctions.push((()=>{var e;null===(e=this.viewportOverrideProvider)||void 0===e||e.cleanup()}))}createPolicyCachedProvider(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){this.policyCachedProvider=new tg(Xm.PolicyCache,e,this.loggerFactory,{userId:null==t?void 0:t.id}),yield this.policyCachedProvider.initialize(),this.cleanupFunctions.push((e=>{var t;const n="signout"===e;null===(t=this.policyCachedProvider)||void 0===t||t.cleanup(n)}))}))}createLocalStorageProvider(e){this.localStorageProvider=new og(Xm.TestOverrides,e,this.loggerFactory),this.cleanupFunctions.push((()=>{var e;null===(e=this.localStorageProvider)||void 0===e||e.cleanup()}))}createClientPreferencesProvider(e){this.clientPreferencesProvider=new rg(e,this.loggerFactory),this.cleanupFunctions.push((()=>{var e;null===(e=this.clientPreferencesProvider)||void 0===e||e.cleanup()}))}createApiServiceProvider(){this.apiServiceProvider=new sg(this.loggerFactory),this.cleanupFunctions.push((()=>{var e;null===(e=this.apiServiceProvider)||void 0===e||e.cleanup()}))}createQspProvider(e){this.qspProvider=new dg(e,this.platformService,this.loggerFactory,this.experienceName),this.cleanupFunctions.push((()=>{var e;null===(e=this.qspProvider)||void 0===e||e.cleanup()}))}createPlatformProvider(e){this.platformProvider=new mg(e),this.cleanupFunctions.push((()=>{var e;null===(e=this.platformProvider)||void 0===e||e.cleanup()}))}}{constructor(e,t,n,i,a,o,r,s,l){super(e,t,n,i,a,o,r,s,l),this.fetchEcsSettingsIfApplicable=()=>(0,c.mG)(this,void 0,void 0,(function*(){var e;const t=null===(e=this.ecsCachedProvider)||void 0===e?void 0:e.getProvider();yield null==t?void 0:t.initialize(!0)})),this.getServiceSwitcherApiKey=()=>{var e;return null===(e=this.localStorage)||void 0===e?void 0:e.get("serviceId",or.f.Experience)},this.getChildId=e=>`${this.id}/${e}`,this.getEcsParameters=e=>Em({coreSettings:this.getCoreSettings(),experienceName:this.experienceName,platformService:this.platformService,logger:this.logger,authenticationUser:e})}static createContext(e,t,n,i,a,o,r,s){return(0,c.mG)(this,void 0,void 0,(function*(){const l=new fg(i),d=new Cg("g",t.experienceName,l,i,a,e,n,t.partitionCacheByExperience,s);yield d.createConfigProviderAsync(),d.createHostProvider(o,r),d.createMaglevHostProvider(),d.createPlatformProvider(a),d.createViewportOverrideProvider({viewportContext:o.viewportContext,entityType:null});const c=new Sg(o);return yield d.createEcsCachedProvider(c),d.createClientFiltersProvider(),yield d.createPolicyCachedProvider(c),d.createLocalStorageProvider(o),d.createApiServiceProvider(),d.createQspProvider(o),d.createClientPreferencesProvider(e),l.cache(d.id,d),d}))}static createContextForWorker(e,t,n,i,a){const o=new fg(t),r=new Cg(e,e,o,t,n,i,a);return r.createConfigProviderSync(),r.createPlatformProvider(n),r.createClientFiltersProvider(),o.cache(r.id,r),r}createContextForUser(e,t){var n;return(0,c.mG)(this,void 0,void 0,(function*(){const i=this.getChildId(`u-${e.id}`);let a;if((null===(n=this.primaryUser)||void 0===n?void 0:n.id)===e.id)a=this.cache.acquire(this.id);else{a=this.cache.acquire(i,(()=>this.clone(i))),a.createClientFiltersProvider();const n=new Sg(t);yield a.createPolicyCachedProvider(n,e)}return a}))}createContextForViewport(e){var t;if(this.logger.log("Acquiring context for viewport params: ",e),!this.viewportOverrideProvider||(null===(t=this.viewportOverrideProvider)||void 0===t?void 0:t.hasDifferences(e))){const t=this.getChildId(`v-${e.viewportContext}-${e.entityType}`);return this.cache.acquire(t,(()=>{const n=this.clone(t);return n.createViewportOverrideProvider(e),n}))}return this.cache.acquire(this.id)}setPrimaryUser(e){return(0,c.mG)(this,void 0,void 0,(function*(){this.logger.log(`Setting primary user to: ${null==e?void 0:e.id}`),this.primaryUser=e,yield this.reinitializeEcsProvider(e)}))}initializeMaglevHostProvider(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){yield null===(t=this.maglevHostProvider)||void 0===t?void 0:t.initialize(e)}))}initializeClientFiltersProvider(e,t){var n;return(0,c.mG)(this,void 0,void 0,(function*(){const{enableClientFiltersProvider:i}=this.getCoreSettings().get(A.J.Core);i&&(yield null===(n=this.clientFiltersProvider)||void 0===n?void 0:n.initialize(e,t))}))}initializeEcsProvider({authenticationUser:e,scenarioFactory:t,networkState:n,clientState:i,windowProvider:a,endpointsManager:o,alwaysFetchEcsSettings:r}){var s,l;return(0,c.mG)(this,void 0,void 0,(function*(){const d=yield this.getEcsParameters(e),c=this.getCoreSettings(),u=new kg(c,this.loggerFactory,this.localStorage),m=new hg(d,c,this.loggerFactory,t,a,i,n,o,u),g=c.getObservable(A.J.Core).subscribe((({ecsRefreshIntervalInMs:e})=>{e&&m.updateRefreshInterval(e)}));this.cleanupFunctions.push((()=>{g.unsubscribe()}));const p=(null===(s=this.ecsCachedProvider)||void 0===s?void 0:s.cacheState)!==Km.NoData,h=!p||u.tooManyPastAttempts;h||r?(this.logger.log(`Initializing ECS provider: awaitInitialSync? ${h}, hasCacheData? ${p}, alwaysFetch? ${r}`),yield m.initialize(h)):this.logger.log("Cache is valid, delaying ECS fetch until WARM."),null===(l=this.ecsCachedProvider)||void 0===l||l.setProvider(m)}))}reinitializeEcsProvider(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const n=null===(t=this.ecsCachedProvider)||void 0===t?void 0:t.getProvider();if(!n)return;const i=yield this.getEcsParameters(e);yield n.updateEcsParametersAndFetchSettings(i)}))}initializePolicyProvider(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{enablePoliciesDefaultValues:t}=this.getCoreSettings().get(A.J.Core),n=new vg(this.loggerFactory,e,this.configLoader,!!t);if(this.policyCachedProvider){const e=n.initialize();this.policyCachedProvider.cacheState===Km.NoData&&(this.logger.log("Policy cache is empty, waiting to fetch policies."),yield e),yield this.policyCachedProvider.setProvider(n)}}))}initializeWorkerProviders(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){yield this.createWorkerHostProvider(t),yield this.createEcsCachedProvider(e),yield this.createWorkerTestProvider(e),yield this.createWorkerHostTestOverridesProvider(t),this.settingsService&&(this.registerProvider(Mm.Configuration,this.workerHostProvider),this.registerProvider(Mm.Configuration,this.ecsCachedProvider),this.registerProvider(Mm.TestOverride,this.workerTestProvider),this.registerProvider(Mm.TestOverride,this.workerHostTestOverridesProvider),this.settingsService.notifySettingsChanged())}))}initializeApiServiceProvider(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){const t=this.getSelectedServiceConfigs();t&&(null===(e=this.apiServiceProvider)||void 0===e||e.setOverrides(t))}))}getLocalStorageTestOverrides(){var e;return null===(e=this.localStorageProvider)||void 0===e?void 0:e.getSettings()}getQspTestOverrides(){var e;return null===(e=this.qspProvider)||void 0===e?void 0:e.getSettings()}clone(e){const t=new Cg(e,this.experienceName,this.cache,this.loggerFactory,this.platformService,this.clientPreferences,this.configLoader,this.partitionCacheByExperience);return t.configProvider=this.configProvider,t.ecsCachedProvider=this.ecsCachedProvider,t.hostProvider=this.hostProvider,t.maglevHostProvider=this.maglevHostProvider,t.clientFiltersProvider=this.clientFiltersProvider,t.policyCachedProvider=this.policyCachedProvider,t.qspProvider=this.qspProvider,t.localStorageProvider=this.localStorageProvider,t.apiServiceProvider=this.apiServiceProvider,t.platformProvider=this.platformProvider,t}getSelectedServiceConfigs(){var e,t,n,i,a;const o=this.getServiceSwitcherApiKey()||(null===(t=null===(e=this.getCoreSettings())||void 0===e?void 0:e.get(A.J.Host))||void 0===t?void 0:t.serviceSwitcherSelectedServiceId);if(!o)return;const r=null===(a=null===(i=null===(n=this.getCoreSettings())||void 0===n?void 0:n.get(A.J.Core))||void 0===i?void 0:i.serviceSwitchers)||void 0===a?void 0:a.availableServices;return null==r?void 0:r.find((e=>e.id===o))}}class bg extends xe{constructor(){super(_.Yg.CreateSettings,[]),this.registerShellHandlers=(e,t)=>{var n;null===(n=e.opener)||void 0===n||n.addEventListener(K.rY.GetSettings,(()=>(0,c.mG)(this,void 0,void 0,(function*(){return t.getCurrentSettingsSnapshot().then((t=>e.opener.postMessage(K.rY.GetSettings,{settings:t})),(()=>e.opener.postMessage(K.rY.GetSettings,{settings:""})))}))))}}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{hostSettings:t}=e,{clientPreferences:n,config:i,configLoader:a,diagnosticsService:o,loggerFactory:r,logsCollectorService:s,platformService:l,windowProvider:d,localStorage:c}=hm("CreateCoreSettingsTask",e,"clientPreferences","config","configLoader","diagnosticsService","loggerFactory","logsCollectorService","platformService","windowProvider","localStorage"),u=r.newLogger("create-core-settings-task"),m=yield Cg.createContext(n,i,a,r,l,d,t,c),g=c.get("cachedUser",or.f.User);if(g)try{const e=JSON.parse(g);m.updateUserMetadataProperties(e),u.debugNoPii&&u.debugNoPii("Successfully updated user metadata properties with cached user values")}catch(e){u.logNoPii&&u.logNoPii(`Failed to parse cached user: ${(0,R.u4)(e)}`)}else u.debugNoPii&&u.debugNoPii("No cached user found, user metadata properties not updated");const p=m.getCoreSettings(),h=m.getLogsProvider();e.coreSettingsContext=m,e.coreSettings=p,o.subscribeToCoreSettings(p),s.subscribeToCoreSettings(p);p.get(A.J.Core).enableMTMA||s.registerUserLogsProvider("",h),this.registerShellHandlers(d,h)}))}}class Tg extends xe{constructor(){super(_.Yg.CreateSettingsUserContext,["authenticationUser","coreSettingsContext","logsCollectorService","windowProvider"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettingsContext:n,logsCollectorService:i,windowProvider:a}=e,o=yield n.createContextForUser(t,a);e.coreSettingsContext=o,e.coreSettings=o.getCoreSettings();const r=o.getLogsProvider();return i.registerUserLogsProvider(t.id,r),e=>{switch(e){case"quit":case"signout":o.cleanup(e);break;default:return}}}))}}class wg{constructor(e,t,n,i){this._commandHandler=e,this._client=t,this._experienceChangeReportingService=n,this._authenticationUser=i}addEventListener(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){const n=yield(0,Nr.jW)(this._client);(null==n?void 0:n.id)===e&&(this._mainShortcutServiceCallback=t)}))}processEvent(e,t){var n;return(0,c.mG)(this,void 0,void 0,(function*(){(yield(0,Nr.jW)(this._client))?null===(n=this._mainShortcutServiceCallback)||void 0===n||n.call(this,e):(this._mainShortcutServiceCallbackWithPayload=()=>{var t;null===(t=this._mainShortcutServiceCallback)||void 0===t||t.call(this,e)},this._subscribeToChangeReportingService()),yield this.openMainApp()}))}destroy(){return(0,c.mG)(this,void 0,void 0,(function*(){const e=yield(0,Nr.XD)(this._client),t=e.find((e=>e.isMainWindow&&e.layoutConfig.layoutMode===Ae.lO.standard));t||(this._mainShortcutServiceCallback=void 0),0!==e.length&&this._authenticationUser&&(null==t?void 0:t.userContextId)===(0,qe.b)(this._authenticationUser)||(this._mainShortcutServiceCallbackWithPayload=void 0,this._mainShortcutServiceCallback=void 0,this._subscription&&this._subscription.unsubscribe())}))}openMainApp(){return(0,c.mG)(this,void 0,void 0,(function*(){return this._commandHandler({entity:{type:Ie.p.default,action:Ie.u.default},command:{visibilityState:Ae.fe.show,stateTransition:Ae.su.flush,correlation:{source:I.D.Core}}})}))}_subscribeToChangeReportingService(){const e=this._experienceChangeReportingService.observeChanges();this._subscription=e.pipe((0,h.U)((e=>(0,c.mG)(this,void 0,void 0,(function*(){if(e.type!==Tt.FV.LayoutRenderComplete)return;const t=yield(0,Nr.jW)(this._client);e.windowId===(null==t?void 0:t.id)&&this._onMainWindowLayoutRenderComplete()}))))).subscribe()}_onMainWindowLayoutRenderComplete(){var e;null===(e=this._mainShortcutServiceCallbackWithPayload)||void 0===e||e.call(this),this._mainShortcutServiceCallbackWithPayload=void 0,this._subscription&&this._subscription.unsubscribe()}}class _g extends xe{constructor(){super(_.Yg.CreateCoreShortcutService,["commandHandler","client","coreSettings","experienceChangeReportingService"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{authenticationUser:t,commandHandler:n,client:i,coreSettings:a,experienceChangeReportingService:o}=e;a.get(A.J.Shortcuts).enableShortcutPropagation&&(e.coreShortcutService=new wg(n,i,o,t))}))}}class Ig extends xe{constructor(){super(_.Yg.CreateCoreUtilities,["isEntityInView"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{isEntityInView:t}=e;e.coreUtilities={isEntityInView:t}}))}}var Ag=n(53720),Ng=n(49426);const Eg=["activeCalls","activeMeetings","activeWindow","activeWindowForEntity","activeWindows","allClientPreferences","appsInstalledByCurrentUser","appsUsage","bannerNotificationQueue","cachedAppList","callingScreenLayout","callingScreenStatus","currentCallingState","clientPreferences","fetchDynamicCommandsV2","localizationSettings","lockedTiles","meetingRoomLayoutToggleState","mostRecentlyUsedTiles","pinnedMeetings","pinnedTiles","pptSharingSession","recentMeetings","requestImmersiveReader","whiteboardSharingSession","attendeeCaptionsVisibility","meetingRoomFrontOfRoomCallPanelsState"],Dg=["addSharedPlatformCachedApps","executeEntityCommand","changeSlotsVisibility","performWindowHistoryNavigation","recordAppActionUsage","recordAppSceneUsage","recordAppUsage","removeSharedPlatformCachedApps","removeUserActiveWindows","removeWindow","resizeHeaderSlot","resizeSlotDimensions","saveReactiveVarsToHistory","setActiveCalls","setCallingScreenLayout","setCallingScreenStatus","toggleHideMyselfVideo","toggleParticipantPin","updateActiveCalls","updateAttendeeCaptionsVisibility","updateClientPreferences","updateCurrentLocale","updateEntity","updateEntityState","updateExtendedEntityContainerState","updateMeetingRoomLayoutToggleState","updateSharedPlatformCachedApps","setMeetingRoomFrontOfRoomCallPanelsState"],Fg=["appsInstalledByCurrentUserEvent","appsUsageUpdateEvent","callParticipantPinnedEventv2","dynamicCommandsUpdateEvent","launchTileUpdatedEvent"],Pg=["activeWindow","activeWindowForEntity","activeWindows","allClientPreferences","cachedAppList","clientPreferences","localizationSettings"],Mg=[...Pg,"activeCalls","activeMeetings","appsInstalledByCurrentUser","appsUsage","bannerNotificationQueue","callingScreenLayout","callingScreenStatus","currentCallingState","fetchDynamicCommandsV2","lockedTiles","meetingRoomLayoutToggleState","mostRecentlyUsedTiles","pinnedMeetings","pinnedTiles","pptSharingSession","recentMeetings","requestImmersiveReader","whiteboardSharingSession"],jg=["addSharedPlatformCachedApps","executeEntityCommand","changeSlotsVisibility","removeWindow","resizeHeaderSlot","performWindowHistoryNavigation","recordAppActionUsage","recordAppSceneUsage","recordAppUsage","removeSharedPlatformCachedApps","removeUserActiveWindows","resizeSlotDimensions","saveReactiveVarsToHistory","updateClientPreferences","updateCurrentLocale","updateEntity","updateEntityState","updateExtendedEntityContainerState","updateSharedPlatformCachedApps"],Rg=[...jg,"setActiveCalls","setCallingScreenLayout","setCallingScreenStatus","toggleParticipantPin","toggleHideMyselfVideo","updateActiveCalls","updateMeetingRoomLayoutToggleState"],xg=[],Og=[...xg,"appsInstalledByCurrentUserEvent","appsUsageUpdateEvent","callParticipantPinnedEventv2","callHideMyselfVideoEvent","dynamicCommandsUpdateEvent","launchTileUpdatedEvent"],Lg=["chat","messages","installedAppsV2"],Ug=[...Eg,"lpcState","pinnedChannels","joinedTeamsAndChannels"],Bg=(e,t,n)=>{const i=(0,Ag.p$)(e),{operation:a,selectionSet:{selections:o},variableDefinitions:r}=i,s=Gg[a],l=(null==r?void 0:r.some((e=>!!e.defaultValue)))?function(e,t={}){const n={};for(const i of e){const e=i.variable.name.value;t.hasOwnProperty(e)?n[e]=t[e]:i.defaultValue&&(n[e]=(0,Ng.M)(i.defaultValue))}return n}(r,t):t;return o.filter((e=>"Field"===e.kind&&!Ug.includes(e.name.value))).map((e=>({id:s,fieldName:e.name.value,args:Wg(e,l),schemaId:n})))};function Wg(e,t){var n;if(!(null===(n=null==e?void 0:e.arguments)||void 0===n?void 0:n.length))return;const i={};for(const n of e.arguments){const e=(0,Ng.M)(n.value,t);void 0!==e&&(i[n.name.value]=e)}return i}const Gg={query:"ROOT_QUERY",mutation:"ROOT_MUTATION",subscription:"ROOT_SUBSCRIPTION"};var Vg;!function(e){e[e.DefaultSchema=0]="DefaultSchema",e[e.ViewSchema=1]="ViewSchema"}(Vg||(Vg={}));var Hg=n(79319);const $g=n(86338);var zg=n(92071);class qg{constructor(e){this._inactiveOperations=new Map,this._forcedActiveOperations=new Map,this._windowToDataMap=new Map,this._dataToWindowMap=new Map,this._activeOperations=(null==e?void 0:e.activeOperationLimit)?new zg.Z({maxSize:e.activeOperationLimit,onEviction:this.markLeastRecentlyUsedOperation.bind(this)}):new Map}trackOperation(e,t,n=Vg.DefaultSchema,i){const{fetchPolicy:a,variables:o}=e,r=e.query||e.mutation;if("no-cache"===a)return;if(e.mutation&&!e.keepRootFields)return;Bg(r,o,n).forEach((e=>{const n=(e=>{const t=$g(e);return(0,Hg.Z)(t)})(e);this._activeOperations.set(n,e),"boolean"==typeof i&&this.forceActive(n,i),this.addDataForWindow(t,n),this._inactiveOperations.has(n)&&this._inactiveOperations.delete(n)}))}markDataForWindowAsInactive(e){const t=this._windowToDataMap.get(e)||[];this._windowToDataMap.delete(e),t.forEach((t=>{const n=this._dataToWindowMap.get(t);if(n&&(n.delete(e),n.size))return;const i=this._activeOperations.get(t);i&&this._inactiveOperations.set(t,i),this._dataToWindowMap.delete(t),this._activeOperations.delete(t)}))}flush(e=this._inactiveOperations.size){const t=[],n=[];let i=0;return this._inactiveOperations.forEach(((a,o)=>{i>=e||(t.push(a),n.push(o),Lg.includes(a.fieldName)&&(i=e),i++)})),n.forEach((e=>this._inactiveOperations.delete(e))),{descriptors:t,hasMore:!!this._inactiveOperations.size}}DEBUG_ONLY_getInactiveOperations(){return this._inactiveOperations}addDataForWindow(e,t){let n=this._windowToDataMap.get(e);n||(n=new Set,this._windowToDataMap.set(e,n)),n.add(t);let i=this._dataToWindowMap.get(t);i||(i=new Set,this._dataToWindowMap.set(t,i)),i.add(e)}forceActive(e,t){var n;const i=(null!==(n=this._forcedActiveOperations.get(e))&&void 0!==n?n:0)+(t?1:-1);0!==i?this._forcedActiveOperations.set(e,i):this._forcedActiveOperations.delete(e)}markLeastRecentlyUsedOperation(e,t){var n;(null!==(n=this._forcedActiveOperations.get(e))&&void 0!==n?n:0)>0?this._activeOperations.set(e,t):this._inactiveOperations.set(e,t)}}class Jg{constructor(e,t,n,i){this.dataOpsRepository=e,this.scenarioFactory=t,this.windowProvider=i,this.clients=new Set,this.logger=n.newLogger("EvictionService")}register(e){this.clients.add(e)}unregister(e){this.clients.delete(e)}evict(){return(0,c.mG)(this,void 0,void 0,(function*(){this.lastEvictionResult={entriesEvicted:0,entriesNotEvicted:0,entriesGCed:0};let e=!0;do{e=yield this.evictByWindowRequestIdleCallback()}while(e)}))}DEBUG_ONLY_getInactiveOperations(){return this.dataOpsRepository.DEBUG_ONLY_getInactiveOperations()}DEBUG_ONLY_getClients(){return this.clients}DEBUG_ONLY_lastResult(){return this.lastEvictionResult}evictByWindowRequestIdleCallback(){return new Promise((e=>{this.windowProvider.requestIdleCallback((t=>{let n=!1,i=0;do{const e=performance.now(),a=t.timeRemaining();this.logger.debug("Time remaining at start",a);const o=this.scenarioFactory.newScenario(ee.RG.CacheEviction);n=this.evictInternal(o);const r=t.timeRemaining(),s=performance.now();i=r>0?r:a-(s-e);const l={"Eviction.TimeRemaining":i};o.stop(l),this.logger.debug("Time remaining at end",i)}while(n&&i>10);e(n)}))}))}evictInternal(e){const{descriptors:t,hasMore:n}=this.dataOpsRepository.flush(10);let i=0,a=0;const o=this.groupCachesBySchema(),r=new Set;t.forEach((e=>{var t;const n=null!==(t=o.get(e.schemaId))&&void 0!==t?t:[];let s=!1;n.forEach((t=>{t.evict(e)&&(r.add(t),s=!0)})),s?i++:a++}));const s={"Eviction.EntriesEvicted":i,"Eviction.EntriesNotEvicted":a};e.mark("eviction",s);let l=0;r.forEach((e=>{const t=e.gc();l+=t.length}));const d={"Eviction.EntriesCollected":l};return e.mark("gc",d),this.logger.debug("Eviction results",{entriesEvicted:i,entriesNotEvicted:a,entriesGCed:l}),this.lastEvictionResult&&(this.lastEvictionResult.entriesEvicted+=i,this.lastEvictionResult.entriesNotEvicted+=a,this.lastEvictionResult.entriesGCed+=l),n}groupCachesBySchema(){const e=new Map;return this.clients.forEach((t=>{let n=e.get(t.schemaId);n||(n=new Set,e.set(t.schemaId,n)),n.add(t.cache)})),e}}var Qg=n(73230),Kg=n(37814),Yg=n(42265),Xg=n(93044),Zg=n(26304),ep=n(54455),tp=n(7716),np=n(18327),ip=n(32344);function ap(e){return function(t,{args:n,toReference:i,canRead:a}){if(a(t))return t;const o=e(n);return a(o)?i(o):void 0}}const op={merge:["prejoinState","callTranscriptState","activeWindow","activeWindowForEntity","messages","userPreferences"],replace:["activeWindows","callingAlerts","workWeekDays","dateRange","activeCalls","listBreakoutRoomsWithDetails"]},rp={Query:{fields:Object.assign(Object.assign({user:ap((e=>({__typename:"User",id:null==e?void 0:e.userId}))),presence:ap((e=>({__typename:"Presence",id:`${null==e?void 0:e.userId}_ups`}))),call:ap((e=>({__typename:"Call",id:null==e?void 0:e.id}))),streamDetails:ap((e=>({__typename:"StreamDetailsInfo",id:null==e?void 0:e.id}))),replyChainMessages:{keyArgs:["channelId","replychainId",["id"]]},replyChainSummaries:{keyArgs:["channelId",["id"]]},breakoutRoomsDetails:{keyArgs:["coordinates",["messageId","organizerId","tenantId","threadId"]],read:ap((e=>({__typename:"BreakoutRoomsDetails",id:null==e?void 0:e.coordinates.threadId})))},searchForMentionV2:{keyArgs:["teamId","searchQuery","includeBots","channelText","teamText","generalText","channelType","hostTenantId","enableScheduledTags","enableOwnersTag"]},breakoutRoomSettings:{keyArgs:["coordinates",["messageId","organizerId","tenantId","threadId"]]},listBreakoutRoomsWithDetails:{keyArgs:["coordinates",["messageId","organizerId","tenantId","threadId"]]},breakoutRoomsClientState:{keyArgs:["coordinates",["messageId","organizerId","tenantId","threadId"]]},localizationSettings:{keyArgs:["currentLocale"]},searchConversation:{keyArgs:["searchTerm","conversationId","filters"],merge:(e,t)=>t?e?Object.assign(Object.assign({},t),{Results:[...e.Results,...t.Results]}):t:e}},op.merge.reduce(((e,t)=>Object.assign({[t]:{merge:!0}},e)),{})),op.replace.reduce(((e,t)=>Object.assign({[t]:{merge:!1}},e)),{}))},Subscription:{fields:{chatServiceEvent:{merge:!1},callRecordingStateChangedEvent:{merge:!1},callingServiceEvent:{merge:!1}}},CallParticipantsCounts:{keyFields:["teamsCallId"]},ParticipantCountsChanged:{keyFields:["teamsCallId"]},ParticipantsChanged:{keyFields:["teamsCallId"]},MessagesResult:{keyFields:!1},WindowHistoryItem:{keyFields:!1},SelectedDevices:{keyFields:!1},Window:{fields:{windowHistory:{merge:!1},activeEntities:{merge:!0},correlation:{merge:!0},extendedEntityContainerState:{merge:!0}}},DeviceList:{fields:{cameras:{merge:!1},camerasSupportingAutoFraming:{merge:!1},microphones:{merge:!1},selectedDevices:{merge:!0}}},Call:{fields:{extendedCallType:{merge:!0},capabilities:{merge:!0},breakoutRoomDetails:{merge:!0}}},RoomCoordinates:{keyFields:["threadId"]},BasicParticipant:{keyFields:["participantId"]},BreakoutRoomsDetails:{fields:{breakoutRooms:{merge:!1}}},BreakoutRoom:{fields:{clientActionState:{read:e=>e||null},participants:{merge:!1}}},CalendarEvent:{keyFields:["objectId"]},InDayEvents:{keyFields:["mailboxAddress","date"],fields:{events:{merge:!1}}},AllDayEvents:{keyFields:["mailboxAddress","date"],fields:{events:{merge:!1}}},Building:{keyFields:["address"]},RecurrenceEvents:{keyFields:["mailboxAddress","cleanGlobalObjectId"]},MeetingCompositeKey:{keyFields:["conversationId","messageId","eventId","modifiedStamp"]},Translation:{keyFields:!1},DiagnosticInfo:{keyFields:!1},EmailUser:{keyFields:["smtp"]},AuthenticationUserProfile:{keyFields:["objectId","tenantId"]},FluidPendingMention:{keyFields:["atMentionId"]},Participant:{keyFields:["participantId"]},Rectangle:{keyFields:!1},AudienceSceneExtent:{keyFields:!1},AudienceSceneParticipant:{keyFields:!1},ChatMessageMentionType:{keyFields:!1},Feed:{fields:{section:{keyArgs(e,{variables:t}){if(t)return t.section},merge(e,t){var n,i;return e?(null===(n=null==t?void 0:t.deltaRequestDetails)||void 0===n?void 0:n.deltaRequestId)&&t.deltaRequestDetails.deltaRequestId===(null==e?void 0:e.requestId)?Object.assign(Object.assign({},t),{items:[...e.items,...t.items]}):(null===(i=t.deltaRequestDetails)||void 0===i?void 0:i.deltaRequestId)?e:t:t}}}},FeedItemType:{keyFields:["uri"]},FilesListResult:{keyFields:["threadId"]},PaymentDetails:{keyFields:["eventId"]},Channel:{fields:{defaultFileSettings:{merge:!0},membershipSummary:{merge:!0}}},Team:{fields:{membershipSummary:{merge:!0},teamSettings:{merge:!0},teamGuestSettings:{merge:!0},teamSiteInformation:{merge:!0},sensitivityLabel:{merge:!0}}}};function sp(e,t,n,i,a){if(n){const{config:{publicPath:n,buildType:o,buildVersion:r}}=i;if(!n)return;const s=window;if(s.__APOLLO_CLIENTS__||(s.__APOLLO_CLIENTS__=[]),s.__APOLLO_KEY_FIELDS__||(s.__APOLLO_KEY_FIELDS__=function(){const e={};for(const t of Object.keys(rp))rp[t].keyFields&&(e[t]=rp[t].keyFields);return e}()),"production"===o)"multi-window"===a?s.__REMPL_APOLLO_DEVTOOLS_URL__=`/multi-window/apollo-devtools?version=${r}`:"react-web-client"===a&&(s.__REMPL_APOLLO_DEVTOOLS_URL__="/v2/apollo-devtools");else{const e=n.endsWith("/")?n:n.concat("/");s.__REMPL_APOLLO_DEVTOOLS_URL__=`${e}apollo-devtools.html`}s.__APOLLO_GLOBAL_OPERATIONS__||(s.__APOLLO_GLOBAL_OPERATIONS__={globalMutations:Dg,globalQueries:Eg,globalSubscriptions:Fg}),s.__APOLLO_CLIENTS__.push({client:e,clientId:t})}}const lp=new np.i((()=>{throw new Error("This client has been destroyed!")}));class dp{constructor(e,t,n,i,a){var o,r;this.name=i,this.storeType=a,this.disposed=!1,this.schemaId=Vg.DefaultSchema,this.ctx=t,this.services=e,this._client=n,null===(o=this.services.leakDetector)||void 0===o||o.track(Po.I.DataClient,this),this.services.dataOpsTracker&&this.setupWatchQueryTracking(this.client),this.services.dataEvictionService&&(null===(r=this.services.dataEvictionService)||void 0===r||r.register(this)),this.registerClient(this.client)}get client(){if(!this._client)throw new Error(`Accessing client ${this.constructor.name}/${this.name} after destroy`);return this._client}get cache(){return this.client.cache}updateContext(e,t){var n;this.ctx=e,null===(n=this._client)||void 0===n||n.setLink(t)}destroy(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){(null===(e=this.services)||void 0===e?void 0:e.dataEvictionService)&&this.services.dataEvictionService.unregister(this),yield this.destroyClient(),this.ctx=void 0,this.services=void 0}))}clearCache(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){yield null===(e=this._client)||void 0===e?void 0:e.clearStore()}))}getServices(){return this.services}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:null,selfIsMainClient:!1}}mutate(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const n=this.getApolloClientInstance(e.mutation);null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,Kg.z.mutate);const i=this.patchOptions(e),a=yield n.mutate(i);return this.trackReadOperation(n,e),a}))}query(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const n=this.getApolloClientInstance(e.query);null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,Kg.z.query);const i=this.patchOptions(e),a=yield n.query(i);return this.trackReadOperation(n,e),a}))}readQuery(e,t){var n;const i=this.getApolloClientInstance(e.query);null===(n=this.maybeGetGraphQLStoreStatsReporterService(i))||void 0===n||n.trackCall(this.storeType,Kg.z.readQuery);const a=i.readQuery(e,t);return this.trackReadOperation(i,e),a}subscribe(e){var t;const n=this.getApolloClientInstance(e.query);return null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,Kg.z.subscribe),n.subscribe(e).map((t=>{var i;return this.trackReadOperation(n,e),null===(i=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===i||i.trackSubscribeEvent(this.storeType),t}))}watchQuery(e){var t;try{const n=this.getApolloClientInstance(e.query);null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,Kg.z.watchQuery);const i=this.patchOptions(e);return n.watchQuery(i)}catch(e){return new ip.y((t=>t.error(e)))}}writeQuery(e){var t;const n=this.getApolloClientInstance(e.query);return null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,Kg.z.writeQuery),this.trackWriteOperation(n,e),n.writeQuery(e)}writeFragment(e){var t;const n=this.getApolloClientInstance(e.fragment);return null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,Kg.z.writeFragment),this.trackWriteOperation(n,e),n.writeFragment(e)}readFragment(e,t){var n;const i=this.getApolloClientInstance(e.fragment);return null===(n=this.maybeGetGraphQLStoreStatsReporterService(i))||void 0===n||n.trackCall(this.storeType,Kg.z.readFragment),i.readFragment(e,t)}get defaultOptions(){return this.client.defaultOptions}set defaultOptions(e){this.client.defaultOptions=e}get disableNetworkFetches(){return this.client.disableNetworkFetches}set disableNetworkFetches(e){this.client.disableNetworkFetches=e}getApolloClientInstance(e){return this.client}patchOptions(e){const{context:t,patched:n}=e,i=(0,c._T)(e,["context","patched"]);return n?e:Object.assign(Object.assign({},i),{context:Object.assign(Object.assign({},this.ctx),t),patched:!0})}registerClient(e){e.dataClients||(e.dataClients=[]),e.dataClients.push(this)}unregisterClient(e){var t,n,i;return e.dataClients=null===(t=e.dataClients)||void 0===t?void 0:t.filter((e=>e!==this)),0===(null!==(i=null===(n=e.dataClients)||void 0===n?void 0:n.length)&&void 0!==i?i:0)}disposeClient(e,t){var n;return(0,c.mG)(this,void 0,void 0,(function*(){const i=this.unregisterClient(e);if(i&&((0,ep.$Z)(e),(0,ep.$Z)(e.cache),function(e){let t=window;for(t.__APOLLO_CLIENTS__&&(t.__APOLLO_CLIENTS__=t.__APOLLO_CLIENTS__.filter((t=>t.client!==e)));t;)t.__APOLLO_DEVTOOLS_GLOBAL_HOOK__&&t.__APOLLO_DEVTOOLS_GLOBAL_HOOK__.ApolloClient===e&&(t.__APOLLO_DEVTOOLS_GLOBAL_HOOK__.ApolloClient=void 0),t.__APOLLO_CLIENT__&&t.__APOLLO_CLIENT__===e&&(t.__APOLLO_CLIENT__=void 0),t=t.parent===t?null:t.parent}(e)),i&&t){const{scenarioFactory:t}=null!==(n=this.services)&&void 0!==n?n:{},i=null==t?void 0:t.newScenario(ee.RG.ApolloClientDisposion);try{e.stop(),yield e.clearStore(),e.setLink(lp),e.setResolvers([]),null==i||i.stop()}catch(e){null==i||i.fail({reason:String(e)})}}}))}disposeClients(e){return(0,c.mG)(this,void 0,void 0,(function*(){this._client&&(yield this.disposeClient(this._client,e),e&&(this._client=void 0))}))}destroyClient(){var e,t;return(0,c.mG)(this,void 0,void 0,(function*(){if(!this.disposed){this.disposed=!0;const{enableApolloClientDisposion:n}=null!==(t=null===(e=this.services)||void 0===e?void 0:e.coreSettings.get(A.J.Core))&&void 0!==t?t:{};yield this.disposeClients(null!=n&&n)}}))}setupWatchQueryTracking(e){const t=e.cache;if(dp.patchedCaches.has(t))return;const n=t.watch;t.watch=(i,...a)=>{this.trackReadOperation(e,i,!0);const o=n.call(t,i,...a);return()=>(this.trackReadOperation(e,i,!1),o())},dp.patchedCaches.set(t,n)}trackReadOperation(e,t,n){var i;this.ctx&&this.services&&(e instanceof dp||null===(i=this.services.dataOpsTracker)||void 0===i||i.trackOperation(t,this.name,this.schemaId,n))}trackWriteOperation(e,t){var n;this.ctx&&this.services&&(e instanceof dp||null===(n=this.services.dataReleaseService)||void 0===n||n.trackWriteOperation(t))}maybeGetGraphQLStoreStatsReporterService(e){var t,n;return e instanceof dp||!(null===(t=this.services)||void 0===t?void 0:t.graphqlStoreStatsReporterService)?null:null===(n=this.services)||void 0===n?void 0:n.graphqlStoreStatsReporterService}}dp.patchedCaches=new WeakMap;const cp=e=>e;class up extends dp{constructor(e,t,n,i,a,o){super(e,i,n,a||"INVALID",o),this.parent=t}getApolloClientInstance(e){const t=(0,Ag.p$)(e);if("OperationDefinition"===t.kind||"FragmentDefinition"===t.kind){const{selectionSet:{selections:n}}=t,i=this.getSharedGlobalOperationsList(t),a=n.map((e=>"Field"===e.kind&&-1===i.indexOf(e.name.value)));if(a.every(cp))return this.client;if(a.some(cp)){const t=(0,he.Tr)(this.className,_.jK.InvalidInput,"route",{operation:e},"Operation contains mix of shared and window private selections");throw console.log(t),t}}return this.parent}getSharedGlobalOperationsList(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation?this.parentMutations:"OperationDefinition"===e.kind&&"subscription"===e.operation?this.parentSubscriptions:this.parentQueries}}class mp extends up{constructor(e,t,n,i,a){super(e,t,n,i,i.windowId,a)}get parentQueries(){return Eg}get parentSubscriptions(){return Fg}get parentMutations(){return Dg}get className(){return"ChildDataClient"}clone(e){throw new Error("Trying to clone child instance")}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:this.parent.__UNSAFE_getApolloClientReferencesForDebugPanel().self,selfIsMainClient:!1}}}class gp extends dp{constructor(e,t,n,i){super(e,n,t,n.windowId||"INVALID",i)}clone(e){throw new Error("Trying to clone child instance")}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:null,selfIsMainClient:!!this.ctx&&this.ctx.windowId===_.ew}}}class pp extends gp{constructor(){super(...arguments),this.schemaId=Vg.ViewSchema}subscribe(e){const t=this.getApolloClientInstance(e.query),n=this.patchOptions(e);return t.subscribe(n)}}var hp=n(35416);class vp extends dp{constructor(e,t,n,i){super(e,n,t({windowId:n.windowId||_.ew,entityType:n.entityType,viewportContext:n.windowProvider.viewportContext,name:"core",storeType:Kg.t.core}),n.windowId||_.ew,Kg.t.core),this.createApolloClient=t,this.overrideLink=null,this.viewSchemaClient=null,this.overrideLink=null,i&&(this.viewSchemaClient=i({windowId:n.windowId||_.ew,entityType:n.entityType,viewportContext:n.windowProvider.viewportContext,name:"core-viewSchema",storeType:Kg.t.viewSchema}),this.registerClient(this.viewSchemaClient))}updateContext(e,t){super.updateContext(e,t),this.overrideLink=t}clone(e){return e.windowId===_.ew?new gp(this.getServices(),this.client,Object.assign(Object.assign({},this.ctx),e),this.storeType):new mp(this.getServices(),this,this.createApolloClient({windowId:e.windowId,entityType:e.entityType,viewportContext:e.windowProvider.viewportContext,name:`child-${e.windowId}`,overrideLink:this.overrideLink,storeType:Kg.t.window}),Object.assign(Object.assign({},this.ctx),e),Kg.t.window)}cloneForViewSchema(e){return hp(this.viewSchemaClient,"View schema must be avaliable"),new pp(this.getServices(),this.viewSchemaClient,Object.assign(Object.assign({},this.ctx),e),Kg.t.viewSchema)}disposeClients(e){const t=Object.create(null,{disposeClients:{get:()=>super.disposeClients}});return(0,c.mG)(this,void 0,void 0,(function*(){yield Promise.all([t.disposeClients.call(this,e),(()=>(0,c.mG)(this,void 0,void 0,(function*(){this.viewSchemaClient&&(yield this.disposeClient(this.viewSchemaClient,e),e&&(this.viewSchemaClient=null))})))()])}))}}class Sp extends dp{constructor(e,t,n){super(e,n,t,n.windowId||_.ew,Kg.t.embed)}clone(e){return new gp(this.getServices(),this.client,Object.assign(Object.assign({},this.ctx),e),this.storeType)}}var fp=n(10348),yp=n(9869),kp=n(75981),Cp=n(98076);const bp={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"WriteCallingDefaults"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingDebugTool"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visible"}},{kind:"Field",name:{kind:"Name",value:"passiveBarHiddenParticipantsCount"}}]}},{kind:"Field",name:{kind:"Name",value:"streamPermissionsDebug"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"acknowledged"}},{kind:"Field",name:{kind:"Name",value:"acknowledgementRequired"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}},{kind:"Field",name:{kind:"Name",value:"pptSharingSession"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"_"}}]}},{kind:"Field",name:{kind:"Name",value:"isFake"}},{kind:"Field",name:{kind:"Name",value:"calls"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};const Tp={callingDebugTool:{__typename:"CallingDebugTool",visible:!0,passiveBarHiddenParticipantsCount:0},streamPermissionsDebug:{__typename:"StreamPermissionsDebug",acknowledged:!1,acknowledgementRequired:!1,url:"https://www.microsoft.com/"},pptSharingSession:{__typename:"ActivePptSession",_:!1},isFake:!1,calls:[]},wp={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"lpcState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lpcState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLivePersonaCardInitialized"}}]}}]}}]},_p={Query:{lpcState:(e,t,{cache:n})=>n.readQuery({query:wp})},Mutation:{setLpcState(e,{newLpcState:t},{cache:n}){const i={lpcState:Object.assign(Object.assign({},t),{__typename:"LpcState"})};return n.writeQuery({query:wp,data:i}),i.lpcState}}};var Ip=n(44126);const Ap=(e,t,n)=>{(0,Ip.k)(e),function(e,t){const n=t.newLogger("writeCallingDefaults");(0,fp.tW)(e),(0,fp.bC)(e);try{e.writeQuery({query:bp,data:Tp})}catch(e){n.error(`Fail to write calling defaults - ${e}`)}try{e.writeQuery({query:yp.a,data:{shouldShowVideoEffectsPreview:!1}})}catch(e){n.error(`Fail to write default value of shouldShowVideoEffectsPreview - ${e}`)}try{e.writeQuery({query:kp.z,data:{shouldKeepPreviewWindowInSidePanelOpen:!1}})}catch(e){n.error(`Fail to write default value of shouldKeepPreviewWindowInSidePanelOpen - ${e}`)}try{e.writeQuery({query:Cp.Q,data:{shouldAvatarMenuItemSelected:!0}})}catch(e){n.error(`Fail to write default value of shouldAvatarMenuItemSelected - ${e}`)}}(e,t),function(e){e.writeQuery({query:wp,data:{lpcState:{__typename:"LpcState",isLivePersonaCardInitialized:!1}}})}(e),n&&Np(e,n,t)},Np=(e,t,n)=>{const i=n.newLogger("appDefaults"),a=t.length;i.log(`Writing ${a.toString()} app default values to the Apollo cache.`),t.forEach((t=>{var n,a;try{const{queryFieldName:n,gqlTypeName:i}=t,a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:`${i}DefaultQuery`},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:n},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]}}]},o={[n]:{__typename:i}};e.writeQuery({query:a,data:o})}catch(e){const o=`Failed to write ${t.gqlTypeName} to cache as Query field ${t.queryFieldName}.`;null!==(a=null===(n=i.errorToTelemetry)||void 0===n?void 0:n.call(i,o,"webclient_framework_foundation_core_services_active_application_hooks",void 0,!0))&&void 0!==a||i.error(o)}}))};class Ep extends Gd{constructor(e){super(),this.shellWindow=e,this.shellWindow.opener.addEventListener(K.rY.CentralDataLayerResponse,(e=>{this.onResponseReceived(e)}))}sendMessage(e){this.shellWindow.opener.postMessage(K.rY.CentralDataLayerRequest,{dataLayer:e})}}function Dp(e){return new np.i((t=>{const{query:n,variables:i,operationName:a}=t,o=t.getContext(),r={callerInfo:null==o?void 0:o.callerInfo,callerScenarioId:null==o?void 0:o.callerScenarioId};return e.execute(n,i,a,null==o?void 0:o.rendererId,null==o?void 0:o.windowId,r)}))}const Fp={mutation:new Set(["notifyWorkerSyncCanStart","notifyActiveContextChangedToCDLWorker"])};var Pp=n(94494),Mp=n(25418);function jp({resolvers:e,contextValue:t}){return new np.i(((n,i)=>{const a=function(e,t){const{query:n}=e,i=(0,Ag.p$)(n);if("OperationDefinition"!==i.kind)return;const{operation:a,selectionSet:{selections:o}}=i;if("mutation"!==a)return;const r=function(e,t){let n;return e.forEach((e=>{if("Field"===e.kind){const i=function(e,t){let n;return t.forEach((({Mutation:t})=>{t[e]&&(n=n||t[e])})),n}(e.name.value,t);if(i){if(n)throw new Error("There cannot be more than 1 matching forward resolver for a document");n={selection:e,resolver:i}}}})),n}(o,t);if(!r)return;return function(e){if(!e.arguments.every((({name:e,value:t})=>"Variable"!==t.kind||t.name.value===e.value))){const t=e.arguments.map((e=>e.name.value)).join(","),n=e.arguments.map((e=>e.value.name.value)).join(",");throw new Error(`Argument name mismatch. Mutation queries, which have forward mutation resolvers should \n                    have a 1-1 name match between the document variable names and the field resolver variable names.\n                    Allowed argument names ${t} does not match the supplied argument names ${n}`)}}(r.selection),r.resolver}(n,e);if(!a)return i(n);const o=n.getContext();return(0,Mp.p)(a(n.variables,Object.assign(Object.assign({},t),o))).flatMap((e=>(n.variables=e,i(n))))}))}var Rp=n(13830);function xp(){return new np.i(((e,t)=>t(e).map((t=>{if(!t.data||!e.query)return t;const{definitions:n}=e.query,i=n.find((e=>e.kind===Rp.h.OPERATION_DEFINITION));if(!i||!i.selectionSet)return t;try{const e=i.selectionSet.selections,n=Op(Lp(t.data),e);return t.data=n,t}catch(e){return t}}))))}function Op(e,t){for(const n of t){if(n.kind!==Rp.h.FIELD)continue;const t=n.name.value;if("__typename"!==t)if(t in e){if(null!==e[t]&&n.selectionSet&&n.selectionSet.selections){e[t]=Lp(e[t]);const i=n.selectionSet.selections;Op(e[t],i)}}else e[t]=null}return e}function Lp(e){return Array.isArray(e)?e.slice():"object"==typeof e?Object.assign({},e):e}var Up=n(44401);function Bp(e){return"subscription"===e.operationType}function Wp(e){const{operation:t,graphQLErrors:n,operationType:i}=e,a=t.getContext(),o={operationName:t.operationName,operationType:i,rendererId:a.windowId};return n&&n.length>0&&(o.errors=n.map((e=>function(e,t){let n=_.jK.UnhandledRuntimeException;const i={path:t};if(!e)return i;e.code?n=e.code:"Failed to fetch"===e.message&&(n=_.jK.FailedToFetch);if(i.code=n,e.hasOwnProperty("serverResponse")&&e.serverResponse){"number"==typeof e.serverResponse.status&&(i.status=e.serverResponse.status),i.mscv=e.serverResponse.headers["ms-cv"],i.xmsCorrelationId=e.serverResponse.headers["x-ms-correlation-id"];try{i.contextId=JSON.stringify(e.serverResponse.headers.contextid)}catch(e){}}return i}(e.originalError,e.path&&e.path.join("::"))))),o}function Gp(e,t,n){!Vp(e)&&n&&function(e,t,n){const i=Wp(e);if(i.errors&&i.errors.length>0){!function(e,t){const{operation:n,operationType:i}=e;t.error(`'${n.operationName}' operation of type '${i}' failed.`)}(e,t);const a=Object.assign(Object.assign({},i),{errors:"","Panel.WindowID":i.rendererId});i.errors[0].code===_.jK.FailedToFetch?n.cancel(a):n.fail(a)}else n.stop({operationName:i.operationName,operationType:i.operationType,"Panel.WindowID":i.rendererId})}(e,t,n)}function Vp(e){return Bp(e)}function Hp(e,t,n,i,a){const o=e.newLogger("TrackRequestLink");return new np.i(((e,r)=>{const{query:s}=e,{operation:l}=(0,du.S)(s,null),d=r(e);let c;return n&&(null==a||a.addOperation(e.operationName,l,"Request")),i&&(c=function(e,t){let n;return Vp(e)||(n=t.newScenario(ee.RG.QueryExecution)),n}({operationType:l,operation:e},t)),new ip.y((t=>{let r;try{r=d.subscribe({next:r=>{i&&(r.errors&&r.errors.length>0?Gp({operation:e,operationType:l,graphQLErrors:r.errors,response:r},o,c):function(e,t){if(!Bp(e)&&t){const n=Wp(e);t.mark(ee.ck.QueryResult,{operationName:n.operationName,operationType:n.operationType,"Panel.WindowID":n.rendererId})}}({operation:e,operationType:l,response:r},c)),n&&(null==a||a.addOperation(e.operationName,l,"Response")),t.next(r)},error:r=>{const s=(e=>e&&e.result?e.result.errors:e instanceof Error?[new Up._("Unhandled exception",void 0,void 0,void 0,void 0,e)]:[new Up._("Unknown error payload provided from forward link")])(r);i&&Gp({operation:e,operationType:l,graphQLErrors:s},o,c),n&&(null==a||a.addOperation(e.operationName,l,"Error")),t.error(r)},complete:()=>{i&&Gp({operationType:l,operation:e},o,c),c=void 0,t.complete()}})}catch(t){throw i&&Gp({operationType:l,operation:e,graphQLErrors:[new Up._("Unhandled exception in forward link",void 0,void 0,void 0,void 0,t)]},o,c),c=void 0,t}return()=>{i&&Gp({operationType:l,operation:e},o,c),c=void 0,r&&r.unsubscribe()}}))}))}const $p=new class{constructor(){this.map=new Map}destroy(e){const t=this.map.get(e);t&&(t.subscriptions.forEach((e=>{e.next(void 0),e.complete()})),t.subscriptions.length=0,this.map.delete(e))}register(e){if(!this.map.has(e)){const t=new ip.y((t=>{const{subscriptions:n}=this.map.get(e)||{};n&&n.push(t)}));this.map.set(e,{cancellationObservable:t,subscriptions:[]})}return this.map.get(e).cancellationObservable}};function zp(e){$p.destroy(e)}function qp(e,t){const n=e.newLogger("TrackSubscriptionLinks");return new np.i(((e,i)=>{const{eventsWithoutCancellationListener:a}=t.get(A.J.Calling),{operationName:o,query:r}=e,{operation:s}=(0,du.S)(r,null);if("subscription"!==s||(null==a?void 0:a.includes(o)))return i(e);const l=(0,Je.v4)(),d=$p.register(l);n.debug(`Forwarding request ${l} for operation ${o}`),e.setContext((e=>Object.assign(Object.assign({},e),{cancellationListener:d})));const c=i(e);return new ip.y((e=>{let t;try{t=c.subscribe({next:t=>{var n;(null===(n=null==t?void 0:t.errors)||void 0===n?void 0:n.length)&&zp(l),e.next(t)},error:t=>{zp(l),e.error(t)},complete:()=>{zp(l),e.complete()}})}catch(e){throw zp(l),e}return()=>{zp(l),t&&t.unsubscribe()}}))}))}function Jp(e,t){const n=new Map;if(!e)throw new Error("Need an operation name to support");return new np.i(((i,a)=>{if(!((e,t)=>{const{query:n}=e,i=(0,Ag.p$)(n);if(!i||"OperationDefinition"!==i.kind)return!1;const{selectionSet:{selections:a}}=i,{operation:o}=(0,du.S)(n,null);if("subscription"!==o)return!1;if(a.length>1)throw new Error("There cannot be more than 1 selection for this link");const r=a[0];if("Field"===r.kind&&r.name.value===t){if(r.arguments.every((({name:e,value:t})=>"Variable"!==t.kind||t.name.value===e.value)))return!0;throw new Error("Argument name must match value")}return!1})(i,e))return a(i);const o=(r=i.variables,JSON.stringify(Object.keys(r).sort().map((e=>{const t=r[e];if(-1!==["boolean","string"].indexOf(typeof t)||null===t||Number.isSafeInteger(t))return[e,t];throw new Error("Unsupported argument type")}))));var r;return new ip.y((e=>{const r=n.get(o);if(r)r.observersCollection.push(e);else{let r="";if(t&&t.get(A.J.Calling).enableSubscriptionCancellationListener){r=(0,Je.v4)();const e=$p.register(r);i.setContext((t=>Object.assign(Object.assign({},t),{cancellationListener:e})))}const s=a(i).subscribe({next:e=>{n.get(o).observersCollection.slice().forEach((t=>{t.next(e)}))},error:e=>{const{observersCollection:t}=n.get(o);n.delete(o);for(const n of t)n.error(e)},complete:()=>{const{observersCollection:e}=n.get(o);n.delete(o);for(const t of e)t.complete()}});n.set(o,{observersCollection:[e],forwardSubscription:s,requestId:r})}return()=>{const t=n.get(o);if(!t)return;const{observersCollection:i,forwardSubscription:a,requestId:r}=t,s=i.indexOf(e);-1!==s&&(i.splice(s,1),0===i.length&&(n.delete(o),null!==r&&""!==r&&function(e){$p.destroy(e)}(r),a&&a.unsubscribe()))}}))}))}var Qp=n(37210),Kp=n(39130),Yp=n(46356);function Xp(e){return new np.i((t=>{const{query:n,variables:i}=t,{operation:a}=(0,du.S)(n,null),o=t.getContext(),{schema:r,contextValue:s}=null!=e?e:o.incremental,l=Object.assign(Object.assign({},s),o);return"subscription"===a?(0,Yp.F)((()=>(0,Qp.L)({schema:r,document:n,contextValue:l,variableValues:i}))):new ip.y((e=>{try{Promise.resolve((0,Kp.ht)({schema:r,document:n,variableValues:i,contextValue:l})).then((t=>{e.closed||(e.next(t),e.complete())}),(t=>{e.closed||e.error(t)}))}catch(t){e.closed||e.error(t)}}))}))}var Zp=n(50689);function eh(e,t){const n={};for(const[a,o]of(0,Z.entries)(e))if(i=o,(0,Z.entries)(i).some((([e,t])=>th(t)&&!e.startsWith("__"))))for(const[e,i]of(0,Z.entries)(o))n[a]||(n[a]={}),n[a][e]=th(i)?nh(i,[a,e],t):i;else n[a]=o;var i;return n}function th(e){return"function"==typeof e}function nh(e,t,n){const i=e=>{throw e instanceof je.G?e:new Zp.K(e,{source:n,resolverPath:t})};return(...t)=>{try{const a=e(...t);return"function"==typeof(null===(n=a)||void 0===n?void 0:n.then)?a.catch(i):a}catch(e){i(e)}var n}}var ih=n(84088),ah=n(34942),oh=n(42344);const rh=e=>({modules:[()=>(0,cd.mT)((()=>n.e(7056).then(n.bind(n,2028))),"data-apollo-broadcast-streaming-attendee",e),()=>(0,cd.mT)((()=>n.e(6693).then(n.bind(n,11244))),"data-client-calling",e),()=>(0,cd.mT)((()=>n.e(683).then(n.bind(n,83864))),"data-resolvers-activity",e),()=>(0,cd.mT)((()=>n.e(9073).then(n.bind(n,11327))),"data-resolvers-activity-bell-count",e),()=>(0,cd.mT)((()=>Promise.all([n.e(635),n.e(58)]).then(n.bind(n,33481))),"data-resolvers-activity-settings",e),()=>(0,cd.mT)((()=>n.e(2136).then(n.bind(n,79577))),"data-resolvers-address-autosuggest",e),()=>(0,cd.mT)((()=>n.e(4750).then(n.bind(n,6281))),"data-resolvers-ai-insights-feedback",e),()=>(0,cd.mT)((()=>n.e(812).then(n.bind(n,32330))),"data-resolvers-ai-insights-sds",e),()=>(0,cd.mT)((()=>n.e(7391).then(n.bind(n,66720))),"data-resolvers-app-device-permission",e),()=>(0,cd.mT)((()=>n.e(5230).then(n.bind(n,6375))),"data-resolvers-app-ratings-and-reviews",e),()=>(0,cd.mT)((()=>n.e(2240).then(n.bind(n,11637))),"data-resolvers-app-suggestions",e),()=>(0,cd.mT)((()=>Promise.all([n.e(8008),n.e(1420)]).then(n.bind(n,75428))),"data-resolvers-appbar",e),()=>(0,cd.mT)((()=>n.e(6260).then(n.bind(n,35584))),"data-resolvers-apps-monet",e),()=>(0,cd.mT)((()=>n.e(8594).then(n.bind(n,71784))),"data-resolvers-apps-platform",e),()=>(0,cd.mT)((()=>n.e(7097).then(n.bind(n,1522))),"data-resolvers-azure-maps",e),()=>(0,cd.mT)((()=>n.e(6138).then(n.bind(n,39317))),"data-resolvers-biometric-enrollment",e),()=>(0,cd.mT)((()=>Promise.all([n.e(7624),n.e(87)]).then(n.bind(n,507))),"data-resolvers-bots-platform",e),()=>(0,cd.mT)((()=>n.e(6386).then(n.bind(n,76931))),"data-resolvers-bots-platform-worker",e),()=>(0,cd.mT)((()=>n.e(4042).then(n.bind(n,58455))),"data-resolvers-brb",e),()=>(0,cd.mT)((()=>n.e(8195).then(n.bind(n,89508))),"data-resolvers-breakout-rooms",e),()=>(0,cd.mT)((()=>n.e(6493).then(n.bind(n,51878))),"data-resolvers-browser-activity",e),()=>(0,cd.mT)((()=>n.e(8806).then(n.bind(n,19044))),"data-resolvers-browser-ams",e),()=>(0,cd.mT)((()=>n.e(5818).then(n.bind(n,68339))),"data-resolvers-browser-app-state",e),()=>(0,cd.mT)((()=>n.e(963).then(n.bind(n,76430))),"data-resolvers-browser-audience",e),()=>(0,cd.mT)((()=>Promise.resolve().then(n.bind(n,53046))),"data-resolvers-browser-authentication",e),()=>(0,cd.mT)((()=>n.e(2353).then(n.bind(n,33835))),"data-resolvers-browser-broadcast-attendee",e),()=>(0,cd.mT)((()=>Promise.all([n.e(3309),n.e(9287),n.e(6937),n.e(38)]).then(n.bind(n,31635))),"data-resolvers-browser-calendar",e),()=>(0,cd.mT)((()=>n.e(6310).then(n.bind(n,29501))),"data-resolvers-browser-call-recording",e),()=>(0,cd.mT)((()=>n.e(488).then(n.bind(n,26135))),"data-resolvers-browser-calls-screen",e),()=>(0,cd.mT)((()=>n.e(8314).then(n.bind(n,39875))),"data-resolvers-browser-chat",e),()=>(0,cd.mT)((()=>n.e(8687).then(n.bind(n,52888))),"data-resolvers-browser-communities",e),()=>(0,cd.mT)((()=>n.e(8722).then(n.bind(n,49957))),"data-resolvers-browser-core",e),()=>(0,cd.mT)((()=>n.e(5221).then(n.bind(n,75502))),"data-resolvers-browser-files",e),()=>(0,cd.mT)((()=>n.e(868).then(n.bind(n,28789))),"data-resolvers-browser-floodgate",e),()=>(0,cd.mT)((()=>Promise.all([n.e(591),n.e(4776),n.e(128),n.e(4866),n.e(104)]).then(n.bind(n,60478))),"data-resolvers-browser-live-stream-rendering",e),()=>(0,cd.mT)((()=>n.e(2540).then(n.bind(n,4600))),"data-resolvers-browser-lms-integration",e),()=>(0,cd.mT)((()=>n.e(8840).then(n.bind(n,45831))),"data-resolvers-browser-logs-files",e),()=>(0,cd.mT)((()=>n.e(1638).then(n.bind(n,77705))),"data-resolvers-browser-meet-for-work",e),()=>(0,cd.mT)((()=>n.e(1029).then(n.bind(n,2471))),"data-resolvers-browser-meeting-artifacts",e),()=>(0,cd.mT)((()=>n.e(6166).then(n.bind(n,75932))),"data-resolvers-browser-meeting-bot",e),()=>(0,cd.mT)((()=>n.e(3968).then(n.bind(n,2656))),"data-resolvers-browser-meeting-catchup",e),()=>(0,cd.mT)((()=>n.e(1949).then(n.bind(n,34744))),"data-resolvers-browser-mention",e),()=>(0,cd.mT)((()=>n.e(6756).then(n.bind(n,94998))),"data-resolvers-browser-notifications-settings",e),()=>(0,cd.mT)((()=>n.e(7697).then(n.bind(n,93483))),"data-resolvers-browser-payment",e),()=>(0,cd.mT)((()=>n.e(3553).then(n.bind(n,7606))),"data-resolvers-browser-settings",e),()=>(0,cd.mT)((()=>n.e(229).then(n.bind(n,66841))),"data-resolvers-browser-share",e),()=>(0,cd.mT)((()=>n.e(3969).then(n.bind(n,81906))),"data-resolvers-browser-survey",e),()=>(0,cd.mT)((()=>n.e(5241).then(n.bind(n,68555))),"data-resolvers-browser-teams",e),()=>(0,cd.mT)((()=>n.e(9180).then(n.bind(n,45606))),"data-resolvers-browser-tenant-privacy",e),()=>(0,cd.mT)((()=>n.e(6023).then(n.bind(n,91404))),"data-resolvers-browser-tpn",e),()=>(0,cd.mT)((()=>n.e(357).then(n.bind(n,71139))),"data-resolvers-browser-url-preview",e),()=>(0,cd.mT)((()=>n.e(9455).then(n.bind(n,20048))),"data-resolvers-browser-virtual-events",e),()=>(0,cd.mT)((()=>n.e(7490).then(n.bind(n,64707))),"data-resolvers-browser-voicemail",e),()=>(0,cd.mT)((()=>n.e(6124).then(n.bind(n,11692))),"data-resolvers-browser-webinar",e),()=>(0,cd.mT)((()=>Promise.all([n.e(3309),n.e(9287),n.e(5632)]).then(n.bind(n,80558))),"data-resolvers-calendar",e),()=>(0,cd.mT)((()=>n.e(4653).then(n.bind(n,26312))),"data-resolvers-callable-channel",e),()=>(0,cd.mT)((()=>Promise.all([n.e(9046),n.e(6020)]).then(n.bind(n,69420))),"data-resolvers-calling",e),()=>(0,cd.mT)((()=>Promise.all([n.e(3309),n.e(1712),n.e(1464),n.e(3834),n.e(5585)]).then(n.bind(n,65254))),"data-resolvers-channel-info-pane",e),()=>(0,cd.mT)((()=>Promise.all([n.e(3309),n.e(1712),n.e(1464),n.e(3834),n.e(6639)]).then(n.bind(n,33717))),"data-resolvers-channel-messages",e),()=>(0,cd.mT)((()=>n.e(2991).then(n.bind(n,35697))),"data-resolvers-channels",e),()=>(0,cd.mT)((()=>Promise.all([n.e(3309),n.e(635),n.e(1712),n.e(3834),n.e(9046),n.e(6366)]).then(n.bind(n,89696))),"data-resolvers-chat",e),()=>(0,cd.mT)((()=>n.e(4427).then(n.bind(n,43413))),"data-resolvers-closed-captions",e),()=>(0,cd.mT)((()=>n.e(5499).then(n.bind(n,9553))),"data-resolvers-coach-report",e),()=>(0,cd.mT)((()=>n.e(5264).then(n.bind(n,28924))),"data-resolvers-collab-cloud",e),()=>(0,cd.mT)((()=>n.e(4263).then(n.bind(n,83513))),"data-resolvers-communities",e),()=>(0,cd.mT)((()=>n.e(2767).then(n.bind(n,86954))),"data-resolvers-compose-language",e),()=>(0,cd.mT)((()=>n.e(6003).then(n.bind(n,95947))),"data-resolvers-connected-calendar",e),()=>(0,cd.mT)((()=>n.e(3745).then(n.bind(n,43674))),"data-resolvers-connectors",e),()=>(0,cd.mT)((()=>n.e(6204).then(n.bind(n,62456))),"data-resolvers-contacts-sync",e),()=>(0,cd.mT)((()=>n.e(1627).then(n.bind(n,82053))),"data-resolvers-contacts-sync-banner",e),()=>(0,cd.mT)((()=>n.e(4226).then(n.bind(n,89680))),"data-resolvers-contacts-sync-settings",e),()=>(0,cd.mT)((()=>n.e(8853).then(n.bind(n,2215))),"data-resolvers-conversations-reminder",e),()=>(0,cd.mT)((()=>n.e(3650).then(n.bind(n,55663))),"data-resolvers-cross-tenant-policies",e),()=>(0,cd.mT)((()=>n.e(5145).then(n.bind(n,71512))),"data-resolvers-desktop-client-shortcuts",e),()=>(0,cd.mT)((()=>n.e(7133).then(n.bind(n,30627))),"data-resolvers-developer-switchers",e),()=>(0,cd.mT)((()=>Promise.all([n.e(3309),n.e(1712),n.e(1464),n.e(5446)]).then(n.bind(n,90045))),"data-resolvers-discover-surface",e),()=>(0,cd.mT)((()=>n.e(7767).then(n.bind(n,3549))),"data-resolvers-distribution-list",e),()=>(0,cd.mT)((()=>n.e(1192).then(n.bind(n,92944))),"data-resolvers-dynamics-marketing",e),()=>(0,cd.mT)((()=>n.e(9778).then(n.bind(n,52886))),"data-resolvers-esp",e),()=>(0,cd.mT)((()=>n.e(7574).then(n.bind(n,50421))),"data-resolvers-esp-target",e),()=>(0,cd.mT)((()=>n.e(6090).then(n.bind(n,73116))),"data-resolvers-example",e),()=>(0,cd.mT)((()=>n.e(8542).then(n.bind(n,81248))),"data-resolvers-external-accounts",e),()=>(0,cd.mT)((()=>n.e(378).then(n.bind(n,3445))),"data-resolvers-external-accounts-response",e),()=>(0,cd.mT)((()=>n.e(7392).then(n.bind(n,57065))),"data-resolvers-external-calendar-email-address",e),()=>(0,cd.mT)((()=>n.e(7375).then(n.bind(n,54774))),"data-resolvers-favorite-user",e),()=>(0,cd.mT)((()=>Promise.all([n.e(635),n.e(7301)]).then(n.bind(n,9070))),"data-resolvers-files",e),()=>(0,cd.mT)((()=>n.e(6263).then(n.bind(n,49497))),"data-resolvers-fluid",e),()=>(0,cd.mT)((()=>n.e(7323).then(n.bind(n,47201))),"data-resolvers-gallery",e),()=>(0,cd.mT)((()=>n.e(9689).then(n.bind(n,4377))),"data-resolvers-guardians",e),()=>(0,cd.mT)((()=>n.e(5029).then(n.bind(n,80161))),"data-resolvers-host-updates",e),()=>(0,cd.mT)((()=>n.e(4100).then(n.bind(n,76452))),"data-resolvers-hosted-web-content-log",e),()=>(0,cd.mT)((()=>n.e(8884).then(n.bind(n,63535))),"data-resolvers-implicit-contacts",e),()=>(0,cd.mT)((()=>n.e(2529).then(n.bind(n,97369))),"data-resolvers-import-msa-contacts",e),()=>(0,cd.mT)((()=>n.e(4091).then(n.bind(n,25618))),"data-resolvers-invite-links",e),()=>(0,cd.mT)((()=>Promise.all([n.e(5310),n.e(6965),n.e(8129)]).then(n.bind(n,57588))),"data-resolvers-live-state-broadcast",e),()=>(0,cd.mT)((()=>Promise.resolve().then(n.bind(n,12491))),"data-resolvers-local-preferences",e),()=>(0,cd.mT)((()=>Promise.resolve().then(n.bind(n,51018))),"data-resolvers-localization-settings",e),()=>(0,cd.mT)((()=>n.e(9087).then(n.bind(n,33776))),"data-resolvers-loki",e),()=>(0,cd.mT)((()=>n.e(6448).then(n.bind(n,15895))),"data-resolvers-m365-links",e),()=>(0,cd.mT)((()=>n.e(9367).then(n.bind(n,50258))),"data-resolvers-manage-tenant",e),()=>(0,cd.mT)((()=>Promise.all([n.e(9402),n.e(3338)]).then(n.bind(n,60148))),"data-resolvers-meeting-analytics",e),()=>(0,cd.mT)((()=>n.e(2478).then(n.bind(n,44287))),"data-resolvers-meeting-intelligence",e),()=>(0,cd.mT)((()=>n.e(7400).then(n.bind(n,99311))),"data-resolvers-meeting-options",e),()=>(0,cd.mT)((()=>n.e(4596).then(n.bind(n,70751))),"data-resolvers-meeting-summary-qna-history",e),()=>(0,cd.mT)((()=>n.e(8996).then(n.bind(n,94225))),"data-resolvers-meeting-templates",e),()=>(0,cd.mT)((()=>n.e(5989).then(n.bind(n,10661))),"data-resolvers-mesh-audio",e),()=>(0,cd.mT)((()=>n.e(2329).then(n.bind(n,88610))),"data-resolvers-mesh-spaces",e),()=>(0,cd.mT)((()=>n.e(8400).then(n.bind(n,84533))),"data-resolvers-mfu-contacts",e),()=>(0,cd.mT)((()=>n.e(8507).then(n.bind(n,99727))),"data-resolvers-missed-mtma-notifications",e),()=>(0,cd.mT)((()=>n.e(3989).then(n.bind(n,37222))),"data-resolvers-mru",e),()=>(0,cd.mT)((()=>n.e(5398).then(n.bind(n,25070))),"data-resolvers-msa-authentication",e),()=>(0,cd.mT)((()=>n.e(579).then(n.bind(n,78018))),"data-resolvers-notifications",e),()=>(0,cd.mT)((()=>n.e(4278).then(n.bind(n,60140))),"data-resolvers-os-file-share",e),()=>(0,cd.mT)((()=>n.e(2616).then(n.bind(n,96121))),"data-resolvers-people-avatar",e),()=>(0,cd.mT)((()=>Promise.all([n.e(1968),n.e(8038),n.e(3874),n.e(3844)]).then(n.bind(n,86935))),"data-resolvers-people-picker",e),()=>(0,cd.mT)((()=>n.e(9932).then(n.bind(n,75376))),"data-resolvers-people-targeting",e),()=>(0,cd.mT)((()=>Promise.all([n.e(2961),n.e(7674)]).then(n.bind(n,80729))),"data-resolvers-platform-tabs",e),()=>(0,cd.mT)((()=>Promise.all([n.e(2379),n.e(5512)]).then(n.bind(n,98534))),"data-resolvers-platform-tabs-state",e),()=>(0,cd.mT)((()=>n.e(115).then(n.bind(n,64110))),"data-resolvers-policies",e),()=>(0,cd.mT)((()=>Promise.all([n.e(9480),n.e(3309),n.e(532)]).then(n.bind(n,88403))),"data-resolvers-presence",e),()=>(0,cd.mT)((()=>n.e(3902).then(n.bind(n,14098))),"data-resolvers-privacy-settings",e),()=>(0,cd.mT)((()=>n.e(6759).then(n.bind(n,24402))),"data-resolvers-pstn",e),()=>(0,cd.mT)((()=>n.e(2090).then(n.bind(n,91491))),"data-resolvers-reply-chains",e),()=>(0,cd.mT)((()=>Promise.all([n.e(1968),n.e(3414),n.e(3742),n.e(2672),n.e(6060)]).then(n.bind(n,85486))),"data-resolvers-search",e),()=>(0,cd.mT)((()=>Promise.all([n.e(1968),n.e(3414),n.e(3742),n.e(2672),n.e(6945)]).then(n.bind(n,12528))),"data-resolvers-search-contextual",e),()=>(0,cd.mT)((()=>Promise.all([n.e(1968),n.e(848)]).then(n.bind(n,56149))),"data-resolvers-search-meeting-summary",e),()=>(0,cd.mT)((()=>n.e(4462).then(n.bind(n,48727))),"data-resolvers-search-prefetch",e),()=>(0,cd.mT)((()=>n.e(8001).then(n.bind(n,88062))),"data-resolvers-search-substrate",e),()=>(0,cd.mT)((()=>Promise.all([n.e(1968),n.e(8038),n.e(3874),n.e(7598)]).then(n.bind(n,94527))),"data-resolvers-search-suggestions",e),()=>(0,cd.mT)((()=>n.e(4595).then(n.bind(n,97695))),"data-resolvers-sensitivity-label",e),()=>(0,cd.mT)((()=>Promise.all([n.e(1968),n.e(8038),n.e(9717)]).then(n.bind(n,45156))),"data-resolvers-share-to-teams",e),()=>(0,cd.mT)((()=>n.e(225).then(n.bind(n,43782))),"data-resolvers-shell",e),()=>(0,cd.mT)((()=>n.e(9262).then(n.bind(n,11573))),"data-resolvers-smb-user-intent",e),()=>(0,cd.mT)((()=>n.e(5270).then(n.bind(n,91279))),"data-resolvers-store",e),()=>(0,cd.mT)((()=>n.e(7806).then(n.bind(n,81528))),"data-resolvers-suggestions",e),()=>(0,cd.mT)((()=>n.e(7227).then(n.bind(n,15461))),"data-resolvers-system-settings",e),()=>(0,cd.mT)((()=>n.e(1661).then(n.bind(n,4408))),"data-resolvers-targeting-hierarchy",e),()=>(0,cd.mT)((()=>Promise.all([n.e(8008),n.e(574)]).then(n.bind(n,6186))),"data-resolvers-taskbar",e),()=>(0,cd.mT)((()=>n.e(8866).then(n.bind(n,21350))),"data-resolvers-team-gallery",e),()=>(0,cd.mT)((()=>Promise.all([n.e(3309),n.e(9926),n.e(7785)]).then(n.bind(n,48391))),"data-resolvers-team-settings",e),()=>(0,cd.mT)((()=>n.e(5365).then(n.bind(n,42461))),"data-resolvers-teams",e),()=>(0,cd.mT)((()=>Promise.all([n.e(3309),n.e(635),n.e(9926),n.e(2961),n.e(6205)]).then(n.bind(n,17568))),"data-resolvers-teams-and-channels",e),()=>(0,cd.mT)((()=>n.e(7902).then(n.bind(n,77171))),"data-resolvers-teams-meeting-policies",e),()=>(0,cd.mT)((()=>n.e(6824).then(n.bind(n,33235))),"data-resolvers-tenant-analytics",e),()=>(0,cd.mT)((()=>n.e(8540).then(n.bind(n,49794))),"data-resolvers-tenant-membership",e),()=>(0,cd.mT)((()=>n.e(9706).then(n.bind(n,38962))),"data-resolvers-tfl-meeting-links",e),()=>(0,cd.mT)((()=>n.e(1457).then(n.bind(n,25282))),"data-resolvers-tfl-user",e),()=>(0,cd.mT)((()=>n.e(1694).then(n.bind(n,74753))),"data-resolvers-third-party-calendar",e),()=>(0,cd.mT)((()=>Promise.all([n.e(635),n.e(588)]).then(n.bind(n,101))),"data-resolvers-toast",e),()=>(0,cd.mT)((()=>n.e(9722).then(n.bind(n,36791))),"data-resolvers-transcript",e),()=>(0,cd.mT)((()=>n.e(8815).then(n.bind(n,10700))),"data-resolvers-transcript-feedback",e),()=>(0,cd.mT)((()=>n.e(8095).then(n.bind(n,84475))),"data-resolvers-transcript-settings-store",e),()=>(0,cd.mT)((()=>n.e(7560).then(n.bind(n,31570))),"data-resolvers-unified-consent",e),()=>(0,cd.mT)((()=>n.e(3028).then(n.bind(n,85454))),"data-resolvers-update-client-state",e),()=>(0,cd.mT)((()=>n.e(3676).then(n.bind(n,46902))),"data-resolvers-user",e),()=>(0,cd.mT)((()=>n.e(4335).then(n.bind(n,28800))),"data-resolvers-user-license",e),()=>(0,cd.mT)((()=>Promise.all([n.e(635),n.e(5919)]).then(n.bind(n,95782))),"data-resolvers-user-preferences",e),()=>(0,cd.mT)((()=>n.e(1469).then(n.bind(n,69469))),"data-resolvers-viva-insights",e),()=>(0,cd.mT)((()=>n.e(9318).then(n.bind(n,85238))),"data-resolvers-whats-new",e),()=>(0,cd.mT)((()=>Promise.resolve().then(n.bind(n,87348))),"data-resolvers-windows",e),()=>(0,cd.mT)((()=>n.e(1706).then(n.bind(n,23389))),"data-schema-cdl",e),()=>(0,cd.mT)((()=>n.e(1443).then(n.bind(n,42031))),"data-resolvers-cypress-only",e)],preloadModules:[24,95,96,159],sharedModule:()=>(0,cd.mT)((()=>Promise.all([n.e(1118),n.e(4882)]).then(n.bind(n,66240))),"data-schema",e),dependencies:{1:[161,160],3:[2],4:[161,160,156],13:[161,160],16:[161,160],19:[161,160],25:[161,160],29:[161,160],30:[161,160,60],32:[161,160],34:[161,160],54:[161,160,60],56:[161,160],57:[58],60:[161,160],68:[161,160],70:[161,160],75:[58],78:[161,160],82:[81],84:[161,160],86:[161,160,32],91:[161,160],100:[101],102:[161,160],107:[161,160],114:[161,160],116:[161,160],119:[161,160],123:[161,160],124:[161,160,123],140:[161,160],141:[58],145:[161,160],149:[161,160,101],154:[161,160],156:[161,160],160:[161]},types:{Query:{ignoreMirroringVideoPreferenceSetting:1,ongoingConsultation:1,parkedCallDetails:1,mergeableCalls:1,userCallingSettings:1,explicitRecordingConsentState:1,deviceList:1,defaultVideoBackgroundImages:1,userVideoBackgroundImages:1,call:1,callWhiteboardSharingSources:1,callMeetingInfo:1,callHealthCategories:1,callQuestionnaire:1,callingIntent:1,callByThreadId:1,videoAvailableForConversation:1,callStartTimestamp:1,callParticipants:1,transportCompanionDeviceInfo:1,teamsCallId:1,callingDialogData:1,callTranscriptState:1,callingAlerts:1,shouldShowTheUpsellScreen:1,meetingInfoFromCall:1,getDeviceBlurringCapability:1,callScreenPreviewsV2:1,noiseSuppressionSetting:1,autoGainControlSetting:1,musicModeSettings:1,isAudioOnlySupported:1,isCameraSharingEnabled:1,isMeetingRoomCortanaEnabled:1,isContentCameraEnhancementSupported:1,shouldShowVmrButton:1,isAllowStartWhiteboardEnabled:1,systemAudioState:1,castingSystemAudioState:1,spatialAudioConfigs:1,speakerMuted:1,speakerHWMuted:1,searchUsersByIdsOrQuery:1,threadMembers:1,meetingRoomInMeetingSpeakerAttributionState:1,meetingRoomInMeetingFaceAttributionState:1,meetingRoomInMeetingPeopleFeedState:1,currentSeatingAssignment:1,currentSeatMapping:1,currentAudienceScene:1,callParticipantsCounts:1,isVideoEffectCapableOnDevice:1,isWatermarkSupported:1,videoEffectStateV2:1,videoTouchUpStrength:1,windowsEffectsCapability:1,windowsEffectsState:1,hasActiveCalls:1,meetingRoomDefaultCallSettings:1,meetingRoomInfo:1,videoEffectReadinessOnDevice:1,totalMeetingParticipantCount:1,isAnonUserFromCloud:1,isE2EECallEnabled:1,isE2EESettingEnabledByTenantAdmin:1,isE2EEQualifiedBySlimcoreVersion:1,getEmergencyAddress:1,getLocationResponseAddress:1,emergencyCustomDisclaimer:1,callRedirectionSettings:1,ringtoneSettings:1,isApplianceMode:1,cloudPeopleFeedRoomViewState:1,holographicCallState:1,voicemailPolicySettings:1,voicemailSettings:1,userDelegation:1,busyOnBusySetting:1,isTTYSettingEnabled:1,parkedCalls:1,slaCalls:1,callingAggregateSettings:1,browserPopoutUserPreference:1,activities:2,activitySettingsComponents:4,activitySettings:4,addressAutoSuggest:5,aiInsightsCollectionItems:7,aiInsightsCollectionItem:7,appSuggestions:10,skypeTeamsAppRanking:10,lockedTiles:11,pinnedTiles:11,mostRecentlyUsedTiles:11,m365Apps:11,billingRegion:12,offer:12,appsubscriptions:12,installedApps:13,installedAppsV2:13,installedChatAppsWithPreCheck:13,tflChatInstalledApps:13,installedSideLoadApp:13,installedTrustedSideLoadApp:13,installedApp:13,appDefinitions:13,appDefinition:13,blockedAppDefinition:13,sideLoadAppDefinition:13,trustedSideLoadAppDefinition:13,stagedApps:13,appStoreRating:13,installedAppsForContainerApp:13,customAppPolicy:13,appsUsage:13,appsInstalledByCurrentUser:13,appImpressions:13,installedAppsForUser:13,installedAppThreads:13,isAppsDiscoveryEnabled:13,getTeamManageAppsPermissions:13,getUserAppRequest:13,adminAppRequestConfig:13,addresses:14,fetchAdaptiveCardsForTab:16,searchMessageExtension:16,searchUniversalSearch:16,selectItemMessageExtension:16,fetchDynamicCommands:16,fetchDynamicCommandsV2:16,getAppPreview:16,querySettingUrlMessageExtension:16,getBotFileUploadUrl:16,taskMessageExtension:16,botConfig:16,getAuthToken:16,fetchTaskForAdaptiveCardTab:16,fetchTaskModule:16,brbFormData:18,brbScreenshots:18,listBreakoutRoomsWithDetails:19,breakoutRoomSettings:19,getBreakoutRoomsUsers:19,getGroupsMembers:19,teamMembers:19,fetchAssignees:19,activityDataForLmsIntegration:20,audienceBackgroundScenes:23,audienceSceneDefinition:23,authenticationUsers:24,authenticatedUser:24,authenticationToken:24,authConsent:24,hostMachineUsers:24,tenantData:24,userAuthState:24,broadcastAttendeeMeeting:25,broadcast:25,broadcastCaptions:25,teamCalendarEventByUid:26,teamCalendarEvents:26,meetingRecommendedFiles:26,calendarEventsCacheV2:26,calendarViewV2_1:26,calendarEventByUid:26,buildings:26,rooms:26,userTimeZoneSettings:26,callRecordingsInfo:27,blockedPstnContacts:28,messageDraft:29,messageDraftsIndex:29,tflTwoWaySmsProfiles:29,giphys:29,searchEmoticons:29,emoticonCategories:29,pinnedSkinTone:29,downloadAmsItem:29,constructAmsUrl:29,downloadImageItemUsingProxy:29,getUrlReputationRest:29,safelinksGetPolicy:29,offlineAssetBlobUrl:29,supportedTranslationLanguages:29,optionalTelemetry:29,streamCameraRecorderInUseStatus:29,onePlayerSettings:29,community:30,getThreadProperties:30,experienceAccountMode:31,filePermission:32,filePermissionWarning:32,currentFiles:32,parseFileLabelFromUrl:32,fileDetailsForChiclet:32,filesValidDomains:32,redeemFile:32,fileDownloadDetailsUsingItemDetailsService:32,fileDownloadDetailsUsingLegacyVroomService:32,redeemFileById:32,getFileDetailsForPptSharing:32,fileDetailsForThumbnail:32,fileDetailsWithSharepointId:32,getPersonalSiteInfoForUpload:32,shareDialogAudience:32,fetchVideoInfo:32,getFileSharingInformation:32,videoFileStatus:32,videoMessageCaptionStatus:32,getFileSharingInformationFromUrl:32,getFileAttachSuggestions:32,cloudStorageFolders:32,floodgateDaysUsedMoreThan:33,floodgateSurveyContext:33,floodgateActiveSurvey:33,liveStreamCaptionsCultures:34,liveStreamDiagnosticData:34,liveStreamIsAvailable:34,liveStreamIsStreaming:34,liveStreamIsActive:34,liveStreamIsRendering:34,liveStreamIdMetadata:34,liveStreamCaptionsState:34,teamsForCourse:35,courseMembersAndOwners:35,meetingArtifacts:38,allMeetingArtifacts:38,allMeetingArtifactsBatch:38,readAndOptionallyReserveMeetingArtifact:38,reserveMeetingArtifact:38,chaptersOfRecording:40,atMentionsFromTranscript:40,searchForMention:41,searchForMentionV2:41,retrieveRegionalEndpoint:41,isGlobalNotificationSettingsDisabled:42,paymentProviders:43,currencies:43,products:43,paymentDetails:43,settingsListItems:44,emailMessagePreview:45,checkCloudFilesStatus:45,recentShareToTeamsRecipients:45,shareToTeamsDesktopUpsellDisplayedStatus:45,survey:46,instantAnswers:46,teams:47,teamsLocal:47,tenantPrivacyUrl:48,notice:49,urlPreview:50,richUrlPreview:50,virtualEvent:51,virtualEvents:51,virtualEventMe:51,virtualEventSession:51,virtualEventSessions:51,virtualEventSpeaker:51,virtualEventSpeakers:51,virtualEventSponsor:51,virtualEventSponsors:51,virtualEventRegistration:51,virtualEventAttendees:51,virtualEventEmailTemplate:51,virtualEventEmailTemplates:51,voicemailAudio:52,voicemails:52,webinar:53,webinarImage:53,userMailboxSettings:54,teamCalendarEvent:54,multiCalendarEvents:54,calendarLeftRailSettings:54,calendarEventsV3:54,calendarEventsV3WithPagination:54,calendarEvent:54,calendarEventV2:54,calendarEventMasterCategories:54,refreshCalendarSurface:54,callQueueSettings:55,callQueueAgentOboAccounts:55,callQueues:55,replyChainSummaries:58,replyChainMessages:58,channelDrillDownHeaderBaseData:58,pinnedPostsSummaries:58,channelModerationByID:58,crossPostChannelIds:58,messages:60,message:60,previousNextChats:60,chats:60,pinnedChats:60,recentsChats:60,suggestedContactsInChatList:60,chat:60,chatAwait:60,chatMembers:60,chatsByTitle:60,chatWithUser:60,defaultChat:60,newChatIntentId:60,membersConsumptionHorizon:60,chatsWithUsers:60,chatsWithGuardians:60,badgeCounts:60,searchUsersByConversation:60,messageAnnotations:60,translationSuggestionRequired:60,lastTranslationSuggestion:60,typingUsers:60,chatFilesSuggestions:60,chatSummarization:60,chatScheduleSuggestion:60,closedCaptionsSettings:61,coachArtifactsByThreadId:62,coachArtifact:62,fluidCollabTenantInfo:63,fluidContainerId:63,fluidToken:63,ntpTime:63,clientRoles:63,communities:64,connectedCalendarSettings:66,syncConnectedCalendarSettings:66,connectorProfile:67,suggestedContacts:68,contactsSyncSettings:70,crossTenantPolicies:72,feed:75,panelActive:75,showDiscoverSurfaceModal:75,lastViewedPostInL1View:75,transitiveMembersCountForDistributionList:76,transitiveMembersForDistributionList:76,transitiveMembersForDistributionLists:76,getWebinarLinkDetails:77,virtualEventsOrgDetails:77,espState:78,irisCampaign:78,getEspSurfaceDisplayStatus:79,getExternalAccounts:81,externalAccountsResponse:82,oneDriveDetails:85,fileDetails:86,fluidSharepointInfo:86,getSpecialFolder:86,getFluidSPOEnabled:86,getPermissions:86,checkUserAccess:86,mediaFiles:87,membersAndRelatedContacts:88,relatedContacts:88,teacherAnnouncementsChat:88,guardiansAnnouncementsOffNetworkCount:88,hostUpdateState:89,hostUpdaterAvailable:89,implicitSuggestions:91,implicitSuggestionsSource:91,fetchMsaContacts:92,chatInviteLink:93,userInviteLink:93,getPhoneNumbers:93,userContactSyncClaimToken:93,getLiveStateAuth:94,getLiveStateRegionalUrl:94,allClientPreferences:95,clientPreferences:95,userExperiencePreferences:95,localizationSettings:96,lokiConfig:97,m365Link:98,getTenantAdmins:99,getJoinTenantUrl:99,aadDomain:99,meetingActionItems:100,meetingAIInsightsNotes:100,meetingArtifactsByThreadId:100,meetingArtifact:100,attendanceReport:100,attendanceReportFromMeetingIntelligenceService:100,attendanceReportThreadProperties:101,meetingThreadProperties:101,meetingRecaps:101,meetingRecapCatchupItems:101,meetingRecapTopics:101,meetingRecapTranscriptMetadata:101,meetingRecapManifestUrl:101,meetingInstances:101,currentDefaultSensitivityLabelId:102,getMeetingOptions:102,getMeetingOptionsByCode:102,meetingOptionsForMeetingCreation:102,meetingOptionsForMeetingEdit:102,meetingSummaryQuestionsAndAnswersHistory:103,meetingTemplateDescriptions:104,meshSpaces:106,missedMTMANotificationsBadge:108,mostRecentlyUsedFiles:109,getAccessToken:110,bannerNotificationQueue:111,toastNotificationQueue:111,osfileshare:112,pstnUser:114,getCacheResults:114,people:114,searchUsers:114,searchUsersWithGroupChats:114,searchSuggestionsForPeoplePicker:114,warmupPeopleSubstrateSearch:114,zeroStateSuggestions:114,tflZeroStateSuggestions:114,membersOfTag:115,tagCard:115,tagsForTeamMembers:115,allTeamsTagCards:115,teamsTagCardsByTeamIds:115,teamTagCardsWithSettings:115,teamTagSettings:115,tenantTagSettings:115,deletedTags:115,tagsEnabled:115,platformTab:116,platformTabs:116,platformTabsV2:116,recentPlatformTabs:116,policies:118,presence:119,presences:119,outOfOfficeSettings:119,blockedContacts:120,priorityContacts:120,pstnAssignment:121,replyChains:122,replyChain:122,getTeamForFile:123,parentPostTeamAndChannel:123,buildChatTitle:123,searchMessages:123,searchMessagesPrefetcher:123,searchAllData:123,searchAllDataPrefetcher:123,searchFiles:123,osearchFiles:123,searchMeetings:123,metaPreview:123,searchOdcFilePreview:123,searchReplyChain:123,searchReplyChainFromPost:123,channelPost:123,searchPeople:123,searchEmails:123,searchPreTrigger:123,searchConversation:124,searchMeetingSummary:125,searchPrefetchConfigs:126,getSearchSuggestionResults:128,searchBoxFetchSuggestions:128,sensitivityLabelById:129,sensitivityLabelPolicySettings:129,defaultSensitivityLabel:129,sensitivityLabelsInLocalCache:129,searchSuggestionsForShareToTeams:130,windowState:131,zoomState:131,customFrameRenderingButtons:131,backdropEffectState:131,pearInstallState:131,isPearEnabled:131,waffleAppUrls:131,smbUserIntent:132,smbUserIntentLocal:132,storeCollection:133,storeCollectionList:133,storeCollectionItemList:133,storeHeroItemList:133,storeSearchItems:133,storeExtendedSearchItems:133,storeSuggestItems:133,storeItemsDetail:133,storeHeroItemsDetail:133,storeSearchItemsLegacy:133,storeArticles:133,init3S:134,suggestions:134,systemSettings:135,hierarchyNodeCharacteristics:136,hierarchyNodeDescendantsCount:136,hierarchyNodeChildren:136,recommendedTeams:138,discoverableTeams:138,joinedTeams:140,joinedTeamsWithActivityCounts:140,defaultChannel:140,pinnedChannels:140,teamLevelApps:140,team:140,teamWithMockData:140,canCreateTWT:141,joinedTeamsAndChannels:141,channelByID:141,channelsByIds:141,myGroupSettings:141,sensitivityLabels:141,sensitivityLabelByTeamId:141,sensitivityPolicySettings:141,sharedWithTeamInvitations:141,gridViewSections:141,teamByGroupId:141,teamTemplatesSummary:141,teamTemplate:141,lockedTeamsPendingMemberCount:141,joinRequests:141,threadMembersByRole:141,searchThreadMembers:141,deletedChannels:141,sharedChannelInvitations:141,getRecommendedTeams:141,searchRecommendedTeams:141,tenantMetadata:141,teamsMeetingConfiguration:142,metricPerTeam:143,metricPerChannel:143,metricCrossTeam:143,getInviteErrorMessageFromErrorCode:144,meetingLinks:145,getConnectedCalendarSettings:147,thirdPartyCalendar:147,toastImageAsDataUri:148,hasMeetingArtifactsTranscript:149,getAssociatedMeetingArtifactsTranscripts:149,getMeetingArtifactsTranscript:149,getMeetingArtifactsTranscriptAcl:149,userTranscriptMeetingSettings:151,smisAttributionSetting:151,consentState:152,me:154,userLicenseDetails:154,user:154,userFromEmail:154,users:154,getUsers:154,msaMeProfile:154,ephemeralMsaMeProfile:154,consumerLicenseDetails:155,userPreferences:156,userPreferencesForCategory:156,vivaInsightsStatus:157,whatsNewState:158,annotationImage:160,appDevicePermission:160,userDelegates:160,callingServiceState:160,favoritePhoneNumbers:160,isStandardFormatNormalized:160,parsedAndFormattedNumber:160,botSsoConsentRequest:160,getBatchUserPresence:160,getUsersForConversation:160,getUsersFromCallingRoster:160,vdiCapabilities:160,smsUsersForConversation:160,isBlockedContact:160,contactBlockedStatusExtended:160,isVideoExtensibilityEnabled:160,messagesWithUnreadActivities:160,devicePermission:160,suggestedUsers:160,suggestedTransferTargets:160,teamsCallIdByCallId:160,callParticipantsForScope:160,conversationForCall:160,callScreenPreviews:160,callPptFiles1:160,callInvisionWhiteboardSharingSources:160,getInvisionWhiteboard:160,instantScdSearch:160,streamPermissions:160,overflowRoomId:160,meetingRoomBroadcast:160,getMeetingNotes:160,meetingInfoFromExchange:160,hasVideoOwnership:160,channelSiteInfo:160,sharepointIds:160,suggestedRooms:160,autoMuteChatAlertBannerDismissed:160,callTranscriptData:160,callTranscriptDataByUrl:160,isAttendanceReportEnabledInRoster:160,isAttendanceReportAvailableAfterCallEnded:160,screenRecordingEnabled:160,biometricEnrollmentEnabled:160,biometricEnrollmentStatus:160,isPnsEnabledAndSupported:160,isWhiteboardDeviceCapableOf:160,isSpatialAudioOn:160,isWhiteboardVideoEffectOn:160,isCommunicationDisabledByExtendedDirectoryPolicy:160,tenantVideoBackgroundImages:160,videoEffects:160,meetingBrandingLogoUrl:160,composerStream:160,isTenantVerifiedDomain:160,searchFederatedUsers:160,searchFederatedUsersTfl:160,searchFederatedUsersByMri:160,searchXtapUser:160,batchUsersByEmailsAndPhones:160,messageUniqueIdentifier:160,buddyGroup:160,buddyGroups:160,sharedMailIdForGroupId:160,callingPerformanceScenarioId:160,biometricEnrollmentPrivacyLink:160,scdImageData:160,dialpadSuggestedUsers:160,validateUpgradePolicyOfChatRecipient:160,systemAudioDriverState:160,roomCoordinates:160,breakoutRoom:160,listBreakoutRooms:160,breakoutRoomsDetails:160,participantsForBreakoutRoomsAssignment:160,maxNumberOfVideoStreams:160,msaUserProfilePicture:160,msaGroupProfilePicture:160,joinTenantUrl:160,pptSharingTelemetry:160,joinLink:160,messageLanguages:160,getTranscriptAcl:160,hasVideoBackgroundEffect:160,autoFramingVideoSetting:160,calendarEvents:160,openInDesktopAsDeviceSpecificFileOpenPreference:160,environmentSupport:160,liveStreamState:160,virtualDesktopInfrastructureConnectedState:160,videoEffectApplyingState:160,getGestureBasedReactionOption:160,unifiedWebinar:160,appDevicePermissions:160,teamsWithActivityCountsAndMentions:160,hideMeetingNames:160},Mutation:{setKeyProxyCookiesForStreamingAttendee:0,callMeBackWithResult:1,updateCallRedirectionSettings:1,updateVoicemailSettings:1,updateUserDelegates:1,setIgnoreMirroring:1,toggleE2EECall:1,toggleTTYSetting:1,mergeCalls:1,updateSelfExplicitRecordingConsentState:1,startPstnCall:1,turnOffCallGroupNotification:1,dismissParkedCallById:1,parkCall:1,unparkCall:1,unparkCallById:1,transferCall:1,startConsultation:1,transferCallConsultation:1,transferUserConsultation:1,selectAudienceSceneAndAssignSeats:1,addAudienceBotDataChannel:1,startBotView:1,callingRosterAddARoom:1,addParticipant1:1,stopCall:1,startCall:1,startSharing:1,stopSharing:1,startWhiteboardSharing:1,changeWhiteboardUrl:1,changeFileUserPermissions:1,postFluidWhiteboard:1,startCallAppContentSharing:1,stopWhiteboardSharing:1,stopCallAppContentSharing:1,stopMdpDataCollection:1,changeCallForwardingTargetTo:1,changeRingtoneSettings:1,playAudioFile:1,pauseAudioFile:1,changeImmersiveViewStatus:1,addScreenRecordingDisabledAlert:1,downloadVideoBackgroundImage:1,uploadVideoBackgroundImage:1,deleteVideoBackgroundImage:1,toggleIncomingVideo:1,toggleMute:1,toggleMuteWithState:1,toggleVideo:1,fireCallingIntent:1,navigateToMainWindow:1,saveEmergencyAddress:1,saveEmergencyLocation:1,removeCustomEmergencyAddress:1,setUserAgreementEmergencyCustomDisclaimer:1,setInterpretationGroup:1,updateParticipantInterpretationState:1,startOrContinueInstantMeeting:1,resolveCallingAppEvent:1,removeParticipant1:1,denyParticipant:1,promoteAttendeeToPresenter:1,demotePresenterToAttendee:1,admitParticipant1:1,admitAllParticipants1:1,muteParticipant1:1,toggleParticipantRoomView:1,muteAllParticipants1:1,renameParticipant:1,spotlightParticipant:1,stopSpotlightOnParticipant:1,stopSpotlight:1,bringOnStage:1,removeFromStage:1,createOrGetInstantMeetingInfo:1,applyVideoBackgroundEffects:1,joinCallFromIntent:1,rejoinCall:1,cancelRetry:1,notifyCallingViewportCreation:1,endCallingIntent:1,updateExternalCallMonitorVisibility:1,sendDtmf:1,submitCallFeedback:1,cancelCallFeedback:1,callFeedbackRendered:1,toggleHoldCall:1,dismissAlert:1,actionOnAlert:1,createCompositorV2:1,disposeCompositor:1,updateCompositorLayout:1,updateCallRefreshSettings:1,updateMeetNowTitle:1,videoSizeChanged:1,setTextureSharingSupported:1,setMaxVideoChannels:1,setStreamItemsCountOnStage:1,updateStreams:1,toggleVideoStreamFocus:1,stopStream:1,stopStream1:1,setVideosSizeAndPreference:1,setVideoPreference:1,acknowledgeFirstFrame:1,devicePermission:1,toggleVideoWithState:1,sendCallingDataToTelemetry:1,startRecording:1,startLocalRecording:1,stopRecording:1,stopLocalRecording:1,startRecordingAndTranscript:1,stopRecordingAndTranscript:1,startTranscript:1,stopTranscript:1,stopVideoForAllCalls:1,makeTranscriptEdit:1,startStream1:1,startStream:1,openFeedbackDialog:1,openMeetingRoomCortana:1,initCallingService:1,disposeCallingService:1,toggleRemotePtzCamera:1,toggleCortana:1,toggleMeetingRoomInMeetingSpeakerAttribution:1,toggleMeetingRoomInMeetingFaceAttribution:1,toggleMeetingRoomInMeetingPeopleFeed:1,toggleHighFidelityAudio:1,toggleMusicModeSettings:1,triggerCallingToastAction:1,selectDevice:1,selectAudioDevice:1,setSpeakerVolume:1,tryToggleIncludeSystemAudio:1,toggleMuteSpeaker:1,toggleRaiseHands:1,toggleRoomRemote:1,toggleAutoGainControl:1,saveGeneratedBackgroundImage:1,captureVideoFrame:1,updateNoiseSuppression:1,lowerOtherParticipantsHand:1,lowerAllRaisedHands:1,startPreview:1,stopPreview:1,toggleTogetherModePinning:1,startCoach:1,stopCoach:1,startClosedCaptions:1,stopClosedCaptions:1,setClosedCaptionsLanguage:1,setClosedCaptionsTextTrack:1,requestClosedCaptionSubtitle:1,newCallingScenario:1,markCallingScenario:1,stopCallingScenario:1,failCallingScenario:1,cancelCallingScenario:1,incompleteCallingScenario:1,updateCallingScenarioEventData:1,pauseCallingScenario:1,resumeCallingScenario:1,screenSharingAcceptControlRequest:1,screenSharingDenyControlRequest:1,screenSharingRequestControl:1,screenSharingReleaseControl:1,screenSharingGiveControlRequest:1,screenSharingTerminateControlRequest:1,registerControlEvents:1,unregisterControlEvents:1,setAplCustomLayout:1,triggerBannerAction:1,triggerDialogAction:1,openSettingsPane:1,toggleVideoEffectV2:1,setTouchUpVideoEffect:1,setWindowsEffectsState:1,updateCustomLayoutSelection:1,setSpatialAudio:1,updateSpatialAudioStageConfig:1,updateSpatialAudioSubStageConfig:1,updateSpatialAudioParticipantsPosition:1,toggleAudioPipeline:1,endRoomRemoteSession:1,createRoomRemoteSession:1,sendCommandToMeetingRoom:1,startFileSharing1:1,handlePresentDeepLink:1,callPptSharingChangeSlide:1,callPptSharingMediaEventUpdate:1,callPptSharingUpdatePresentationUrl:1,callPptSharingTakeControl:1,callPptSharingUpdateSlidesCount:1,callPptSharingUpdateLayout:1,callPptSharingUpdateCameoState:1,callPptSharingTogglePrivateViewing:1,callPptSharingStopContentSharing:1,setAvatarModeState:1,setIsAvatarAppAvailable:1,startHolographicInteraction:1,startHolographicFreezeFrameInteraction:1,stopHolographicInteraction2:1,stopHolographicFreezeFrameInteraction:1,updateHolographicViewingParticipant:1,placeHolographicAnnotation:1,continueHolographicInking:1,stopHolographicInking:1,deleteCallHistoryLog:1,deleteHolographicAnnotations:1,recoverHolographicAnnotations:1,clearAllHolographicAnnotations:1,setHolographicToolbarVisibility:1,setHolographicToolbarAvailability:1,clearCallParticipantRestriction:1,updateCallParticipantRestrictions:1,updateAttendeeRestrictions:1,sendThirdPartyDevicePairingResponse:1,updateIgnoreMirroringVideoPreferenceSetting:1,requestAppAudioHandling:1,setBusyOnBusySetting:1,joinCallByInvitationContent:1,setBrowserPopoutUserPreference:1,deleteActivityFeedItem:2,updateActivityThreadId:2,toggleActivityRead:3,clearBellCount:3,updateActivitySettings:4,submitAiInsightsFeedback:6,createAiInsightsCollection:7,createAiInsightsCollectionItem:7,updateAiInsightsCollectionItem:7,firstCreateAiInsightsCollectionItem:7,resolveAppDevicePermission:8,postAppReview:9,updateAppReview:9,deleteAppReview:9,markAppReviewHelpful:9,reportAppReview:9,postAppReviewComment:9,updateAppReviewComment:9,deleteAppReviewComment:9,installApp:13,upgradeApp:13,installCustomApp:13,installSideLoadApp:13,installTrustedSideLoadApp:13,deleteApp:13,createUserAppRequest:13,pinMessageExtensionV2:13,pinMessageExtension:13,unpinMessageExtensionV2:13,unpinMessageExtension:13,deleteStagedApp:13,recordAppActionUsage:13,recordAppUsage:13,recordAppSceneUsage:13,recordAppImpression:13,outgoingWebhook:13,startVoiceCaptureBiometricEnrollment:15,stopVoiceCaptureBiometricEnrollment:15,cancelVoiceBiometricEnrollment:15,startFaceCaptureBiometricEnrollment:15,cancelFaceCaptureBiometricEnrollment:15,finishFaceCaptureBiometricEnrollment:15,sendInvoke:16,sendExecuteInvoke:16,submitTab:16,cardCacheOperation:16,postFileUploadInfoAndUserConsent:16,updateSettingsMessageExtension:16,verifyCardSignInState:16,tokenExchangeInvoke:16,submitO365Action:16,connectorHttpPostAction:16,submitTaskMessageExtension:16,submitBotConfig:16,submitTaskModule:16,submitTaskAdaptiveCardTab:16,cardCacheOperationV2:17,createBrbItem:18,addBreakoutRoom:19,deleteAllBreakoutRooms:19,updateBreakoutRoomInfo:19,deleteBreakoutRoom:19,createBreakoutRoomsWithDetails:19,updateBreakoutRooms:19,updateBreakoutRoomSettings:19,breakoutRoomBulkMoveAction:19,uploadAmsItem:21,authenticateUser:24,loginUser:24,authenticationLogout:24,reauthenticateUser:24,resolveThirdPartyOauthCode:24,initializeAccounts:24,switchAccount:24,refreshTenants:24,startLiveStreamCaptions:25,stopLiveStreamCaptions:25,toggleLiveStreamCaptionButton:25,subscribeToBroadcastUpdates:25,unsubscribeFromBroadcastUpdates:25,meetingRecommendationSearchFeedbackResponse:26,forwardCalendarEvent:26,addToMyCalendar:26,forwardTeamEvent:26,suggestedTime:26,patchCalendarEvent:26,createSchedulingServiceEvent:26,deleteSchedulingServiceEvent:26,unhidePrivateMeetingConversation:26,publishFormCacheSyncEvent:26,publishFormLoadingSpinnerEvent:26,publishCalendarToggleTabEvent:26,publishFormShareDialogEvent:26,publishFormErrorEvent:26,blockOrUnblockPstnContact:28,saveMessageDraft:29,removeMessageDraft:29,transferMessageDraft:29,tflTwoWaySmsSaveProfile:29,tflTwoWaySmsRemoveProfiles:29,translateMessage:29,requestMessageTranslations:29,updateMessageTranslationStatus:29,translateChannelMessage:29,addOfflineAsset:29,removeOfflineAsset:29,setPinnedSkinTone:29,addEmoticonToRecentsByEmoticonID:29,addVideoMessageBlobsAsOfflineAsset:29,runVideoMessageBlobsGC:29,updateStreamCameraRecorderInUseStatus:29,updateOnePlayerSettings:29,sendLinkClickedSignal:29,communitiesReportConcern:30,removeAuthenticatedUser:31,rebootApp:31,provisionPersonalSharepointSite:32,backfillThreadPropertiesWithSpoIDs:32,uploadFile:32,uploadItems:32,cancelUpload:32,deleteAttachedFile:32,refreshSiteUrl:32,createShareLinkInvite:32,createFilesShareLink:32,removeFileFromSharePoint:32,attachFiles:32,downloadFile:32,bootstrapFloodgate:33,floodgateLogActivity:33,floodgateLogActivityStartTime:33,floodgateLogActivityStopTime:33,onCVSurveyEvent:33,floodgateUpdateUserSurveyNotificationEnabled:33,addLiveStreamCues:34,clearLiveStreamCues:34,showLiveStreamCaptions:34,startLiveStream:34,stopLiveStream:34,setLiveStreamOptions:34,setLiveStreamCaptionsData:34,toggleLiveStreamCaptions:34,setLiveStreamSubtitleTrack:34,downloadLogsFiles:36,addMeetingArtifacts:38,commitMeetingArtifact:38,updateMeetingArtifacts:38,createPaymentDetails:43,updatePaymentDetails:43,sendEmailMessage:45,saveShareToTeamsRecipient:45,deleteShareToOutlookEmailDraft:45,setShareToTeamsDesktopUpsellIsDisplayedStatus:45,submitTranslationFeedback:46,submitSurvey:46,sendInstantAnswersTelemetryIsInsightUseful:46,sendInstantAnswersTelemetryDwellTime:46,sendSmartRepliesOCVFeedback:46,sendSuggestedScheduleMessageDeliveryOCVFeedback:46,createVirtualEvent:51,updateVirtualEvent:51,cancelVirtualEvent:51,addVirtualEventSpeaker:51,updateVirtualEventSpeaker:51,deleteVirtualEventSpeaker:51,addVirtualEventSpeakerImage:51,updateVirtualEventSpeakerImage:51,deleteVirtualEventSpeakerImage:51,addVirtualEventSponsor:51,updateVirtualEventSponsor:51,deleteVirtualEventSponsor:51,addVirtualEventSession:51,updateVirtualEventSession:51,deleteVirtualEventSession:51,updateVirtualEventRegistration:51,updateVirtualEventTheme:51,updateVirtualEventPromoImage:51,updateVirtualEventLogoImage:51,managePendingApprovals:51,updateVirtualEventEmailTemplate:51,markReadUnread:52,deleteVoicemail:52,saveWebinar:53,submitAttendeeRegistration:53,cancelAttendeeRegistration:53,createWebinar:53,deleteWebinar:53,sendUpdateEmail:53,saveWebinarImage:53,increaseWebinarPageViewCount:53,registerConsentForD365Link:53,setPrivacyLink:53,addVirtualEventId:53,importCalendarEvent:54,updateMeetingResponse:54,updateMeetingResponseV2:54,deleteCalendarEvent:54,deleteCalendarEventV2:54,cancelCalendarEvent:54,cancelCalendarEventV2:54,updateCalendarLeftRailSettings:54,cancelTeamEvent:54,cancelTeamEventV2:54,updateAttendeeEvent:54,updateAttendeeEventV2:54,createOrUpdateCalendarEvent:54,createOrUpdateCalendarEventV2:54,createOrUpdateTeamEvent:54,createOrUpdateTeamEventV2:54,updatePartialEvent:54,deleteCalendarEventsCache:54,inviteOffNetworkUsers:54,toggleCallableQueueOptInStatus:55,revertEditFailure:58,pinUnpinPost:58,clearDeleteFailureForMessage:58,setReplyChainConsumptionHorizon:58,setReplyChainTitle:58,deleteCrossPostAll:58,deleteCrossPostSingle:58,retryCrossPost:58,clearCrossPostFailure:58,updateCrossPostSelectedChannelIds:58,createChannel:59,updateChannel:59,reportMessage:60,submitReport:60,sendMessage:60,sendMessageWorker:60,sendTypingIndicator:60,createChat:60,createNewChat:60,setMuteChat:60,setThreadPropertyMeeting:60,setThreadPropertyLiveness:60,addMembersToConversation:60,inviteMembersToConversation:60,registerBadgeCounts:60,removeMemberFromConversation:60,updateMessageEmotion:60,ackUrgentMessage:60,setConsumptionHorizon:60,leaveChat:60,setConsumptionHorizonBookmark:60,setChatPinned:60,discardDraftChat:60,setChatVisibility:60,deleteChat:60,setConversationTitle:60,reorderPinnedChats:60,saveMessage:60,unsaveMessage:60,deleteDraftMessage:60,deleteMessage:60,undeleteMessage:60,updateMessageLinks:60,setPinnedItemsThreadProperty:60,setPinnedItemsConversationProperty:60,reportOffensiveMessage:60,updateMessageTranslation:60,updateChannelsMessageTranslation:60,chatScheduleSuggestionSuppress:60,updateClosedCaptionsSettings:61,deleteCoachArtifact:62,registerClientId:63,setFluidContainerId:63,detectComposeLanguage:65,setComposeLanguage:65,switchSpellCheckLanguage:65,publishConnectedCalendarSetting:66,deleteConnectedCalendarSetting:66,invokeUserActionOnContactsSyncBanner:69,publishContactsSyncSettings:70,deleteContactsSyncSettings:70,addDesktopClientShortcut:73,switchRing:74,clearContainer:74,switchService:74,feedback:75,removeHasUpdatedItemsFlag:75,discoverSurfaceUserPreferenceForEntities:75,recordEligibleSurface:78,recordDisplayedSurface:78,triggerNotificationDisplay:78,activateEspTarget:79,deactivateEspTarget:79,registerEspTarget:79,unregisterEspTarget:79,updateEspSurfaceDisplayStatus:79,increment:80,addExternalAccount:81,removeExternalAccount:81,ComponentsPrivacySettingsHardDeleteExternalAccountMutation:81,refreshExternalAccount:81,setExternalCalendarEmailAddress:83,addToFavorite:84,deleteFile:86,createShareLink:86,deleteShareLink:86,odspAtMention:86,renameFile:86,grantUserPermissions:86,createTeacherAnnouncementsChat:88,retrySendGuardiansAnnouncement:88,tryInstallUpdate:89,initService:91,disableChatInviteLink:93,enableChatInviteLink:93,enableCommunitiesInviteLink:93,redeemClaimInviteLink:93,redeemInviteLink:93,initiateAutoClaimVerification:93,confirmAutoClaimVerification:93,sendMeetingReactionLiveState:94,sendMeetingNotesLiveState:94,updateClientPreferences:95,updateUserExperiencePreferences:95,clearUserExperiencePreferences:95,clearUserExperiencePreferencesByCategory:95,updateCurrentLocale:96,downloadAttendanceReportFromType:100,deleteAttendanceReportFromType:100,downloadLocalReport:100,downloadAttendanceReportFromMeetingIntelligenceService:100,updateMeetingOptionsSensitivityLabelForCreate:102,updateMeetingOptionsSensitivityLabelForEdit:102,setCurrentDefaultSensitivityLabelId:102,setMeetingOptions:102,setMeetingOptionsByCode:102,updateLocalMeetingOptions:102,updateLocalMeetingOptionsForEdit:102,updateLocalMeetingOptionsToSS:102,updateLocalEditMeetingOptionsToSS:102,updateLocalMeetingOptionsInvitees:102,requestMuteInApp:105,setIsMutedInApp:105,addUpdateMostFrequentlyUsedContact:107,addTagsToMembersOfTeam:115,deleteTagsFromMembersOfTeam:115,updateTeamTag:115,updateTeamTagSettings:115,deleteTag:115,restoreTag:115,executeDeepLink:116,updatePlatformTab:116,createPlatformTab:116,removePlatformTab:116,migrateLegacyPlatformTab:116,addPlatformCachedApps:116,removePlatformCachedApps:116,updatePlatformCachedApps:116,sendExternalAuthDeeplink:116,sendTswSdkMessage:116,updateShareFormStatus:117,updatePlatformTabsNavigationEvent:117,sendRegisterBackButtonSignalV2:117,pollSettingsOnDemand:118,updatePoliciesInCache:118,setPresence:119,setStatusNote:119,setCallStatePresence:119,setOutOfOffice:119,blockOrUnblockUser:120,removePriorityContact:120,addPriorityContact:120,sendSearchActionsInstrumentation:123,sendSearchEntityActionsInstrumentation:123,sendSearchResultsRenderedInstrumentation:123,sendSearchClientLayoutInstrumentation:123,pingSearch:123,sendClientDataSourceInstrumentation:123,sendResponseReceivedInstrumentation:123,initSubstrateSearch:127,sendSearchActions3SInstrumentation:127,sendSearchEntityActions3SInstrumentation:127,sendSearchResultsRendered3SInstrumentation:127,sendSearchClientLayout3SInstrumentation:127,editSearchHistory:128,setHostTheme:131,setWindowBounds:131,sendIntentSignal:132,toggleSetting:135,joinTeam:138,joinTeamByCode:138,updateTeamSetting:139,updateTeamDiscoverability:139,resetTeamJoinCode:139,removeTeamJoinCode:139,renewTeam:139,acceptInvitationByInvitee:141,createTeam:141,declineInvitationByInvitee:141,deleteInvitationByInvitee:141,approveSharedChannelInvitation:141,denySharedChannelInvitation:141,editTeam:141,leaveChannel:141,restoreChannel:141,setChannelShowForMember:141,showChannel:141,showTeam:141,updateGridViewSection:141,validateTeamName:141,createTeamFromTemplate:141,setCollapsedConversationPropertyV2:141,handleBulkJoinRequests:141,handleJoinRequest:141,sponsorJoinRequest:141,unlockTeam:141,setPinConversationProperty:141,setThreadPropertyChannelSettings:141,setChannelSpaceAdminSettings:141,updateChannelEmailSettings:141,removeChannelEmailSettings:141,removeThreadMembership:141,updatePinnedChannelsOrder:141,stopSharingChannelWithTeam:141,addThreadMembership:141,updateThreadMembership:141,joinTeamById:141,joinTeamWithCode:141,inviteMembersToTenant:144,updateMeetingLinks:145,setCurrentUserIsTFLUser:146,addThirdPartyCalendar:147,removeThirdPartyCalendar:147,reconnectThirdPartyCalendar:147,hardDeleteThirdPartyCalendar:147,deleteMeetingArtifactsTranscript:149,downloadMeetingArtifactsTranscript:149,editMeetingArtifactsTranscript:149,submitTranscriptFeedback:150,updateUserTranscriptMeetingSettings:151,migrateSmisServiceAttributionSettings:151,updateClientStateVeryActive:153,updateMSAMeSearchability:154,updateMsaMeAliasVisibility:154,updateMsaUserName:154,createMsaMeProfileAndStampAliases:154,updateMsaProfileAvatar:154,removeProfilePicture:154,updateUserPreferences:156,recordWhatsNewDisplayedFeature:158,recordWhatsNewEntryPointPromotion:158,recordWhatsNewEntryPointUserAction:158,turnOnCallGroupNotification:160,clearBotSsoConsentRequest:160,disableCallForwarding:160,createBuddyGroupDialog:160,renameBuddyGroupDialog:160,deleteBuddyGroupDialog:160,addFavoritePhoneNumber:160,callMeBack:160,messageListRendered:160,storeAnonymousUsers:160,smartDeviceLogOut:160,smartDeviceQuickFeedback:160,altScenario:160,createMeetingNotes:160,updateAttendeeTranscription:160,acceptBlockSfCChat:160,contactAcceptOrBlockExtended:160,addBlockedMri:160,deleteBlockedMri:160,rejectCall:160,cancelCallParticipantAddition:160,resumeCallBeingConsulted:160,retryCall:160,startStopStreams:160,toggleNativeRenderer:160,toggleIncomingAudio:160,sendMeetingReaction:160,lowerOtherParticipantHand:160,lowerHandsForEveryone:160,toggleVideoSharing:160,toggleTimeZoneIndicator:160,toggleWhiteboardVideoEffect:160,togglePushToTalk:160,userFacingDiagnosticsV2:160,downloadAttendanceInRoster:160,downloadAttendanceAfterCallEnded:160,showInteropScreenshareAlert:160,toggleContentCameraShare:160,toggleMeetingRoomDisplayOemPlugin:160,updateCalendarHealthStatus:160,openMeetingRoomSettings:160,restartMeetingRoomDevice:160,openPublicPreviewFeedbackDialog:160,updateMeetingRoomRemoteHandlerState:160,toggleContentCameraEnhancement:160,showVmrState:160,startSharingFromChat:160,startInteropMeeting:160,callPptWeathepersonFailed:160,startAnnotation:160,stopAnnotation:160,updateLayoutToggleState:160,pauseRecording:160,resumeRecording:160,acceptStreamPermissions:160,toggleScd:160,updateVideoPrivacyPolicy:160,setCurrentDeviceVideoEffect:160,downloadVideoBackgroundImageV2:160,dismissAutoMuteChatAlertBanner:160,openSecurityAndPrivacyPane:160,openInviteDialog:160,updateCurrentActiveCard:160,updateCardDocumentUrl:160,updatePlayerInteractionResult:160,sendToBroadcast:160,startBroadcast:160,stopBroadcast:160,resumeOverflowRoom:160,notifyHolographicImageLoaded:160,deleteFailedMessage:160,startScd:160,stopScd:160,showHiddenChatHistory:160,addContact:160,removeContact:160,removeContactFromBuddyGroup:160,requestSystemAudioDriverInstallation:160,reportParticipant:160,createBreakoutRooms:160,markActivitiesAsRead:160,markActivityMessagesInViewportAsRead:160,goToMainMeetingFromBreakoutRoom:160,goToBreakoutRoomFromMainMeeting:160,openBreakoutRooms:160,closeBreakoutRooms:160,takeControlToManageBreakoutRooms:160,setBreakoutRoomsInMeetingEnabled:160,markUpsellScreenAsDisplayed:160,sendBreakoutRoomAnnouncementAlert:160,updateSelectedUserFrequency:160,askToJoinBreakoutRoom:160,deleteJoinLink:160,updateThreadJoinLink:160,toggleNdi:160,updateMeetingRoomAppState:160,updateMeetingLock:160,applyWhiteboardVideoEffect:160,updateAutoFramingVideoSetting:160,openSettingsPanelWithWindowFocus:160,showPrivateMeetingConversation:160,upgradeConsumerLicense:160,downloadClassicalAttachment:160,setWeatherpersonCapable:160,setAplCustomBackground:160,setAplCustomBackgroundV2:160,joinScheduledMeeting:160,joinScheduledMeetingWithLink:160,startLiveStreaming:160,stopLiveStreaming:160,toggleGestureBasedReactionOption:160,updateGroupProfileAvatar:160,deleteGroupProfileAvatar:160,setAppDevicePermission:160,navigateBackFromApp:160,registerBackButtonHandler:160,sendMeetingRoom3PJoinByCodeValuestoRigel:160,setMeetingRoomHighContrastMode:160,toggleMeetingRoomHdmiIngestActiveState:160,toggleMeetingRoomHdmiIngestMirrorContent:160,refreshBiometricEnrollmentStatus:160,removeCachedBiometricVoiceSignature:160,refreshEnrollmentStatusAndPassSignatureToDeviceManager:160},Subscription:{ignoreMirroringVideoPreferenceSettingChangedEvent:1,activeCallsChangedEvent:1,callParticipantPinnedEventv2:1,callHideMyselfVideoEvent:1,callingServiceEvent:1,callingWindowingContentChangedEvent:1,connectedCallsChangedEvent:1,callParticipantAudioRestrictionsChangedEvent:1,callParticipantVideoRestrictionsChangedEvent:1,callTransferEvents:1,ongoingConsultationEvent:1,dominantSpeakerInfoEvent:1,frameSizeChangedEvent:1,callTitleChangedEvent:1,fullFrameRequiredEvent:1,callAudienceBotDataChannelEvents:1,explicitRecordingConsentStateChangedEvent:1,blurringCapabilityChangedEvent:1,highFidelityAudioSwitchChangedEvent:1,musicModeSettingsChangedEvent:1,callMicNrgLevelsChangedEvent:1,callSpeakerVolumeChangedEvent:1,meetingJoinFromTeamsDeviceEvent:1,callSpeakerMutedChangedEvent:1,callPptSharingEvent:1,broadcastAttendeeCountEvent:1,overflowRoomCallStateChange:1,broadcastQnaFeedUpdatedEvent:1,callSpeakerHWMutedChangedEvent:1,callPptSharingAddedEvent:1,whiteboardSharingAddedEvent:1,callAppContentSharingAddedEvent:1,whiteboardSharingStatusChangedEvent:1,callAppContentSharingStatusChangedEvent:1,whiteboardUrlChangedEvent:1,fileUserPermissionsChangedEvent:1,callAppUrlChangedEvent:1,companionStreamAddedEvent:1,companionStreamRemovedEvent:1,callPptSharingRemovedEvent:1,callAppContentSharingRemovedEvent:1,callPptSharingSlideChangedEvent:1,callPptSharingPresentationUrlReadyEvent:1,callPptSharingChangeSlideCortanaInvocationEvent:1,callPptSharingMediaEventUpdatedEvent:1,callPptSharingTelemetryUpdatedEvent:1,callPptSharingPrivateViewingChangedEvent:1,callPptSharingContentSharingStatusChangedEvent:1,callRecordingStateChangedEvent:1,callLocalRecordingStateChangedEvent:1,callVoiceCollectionChangedEvent:1,callPptSharingStartedEvent:1,whiteboardSharingStartedEvent:1,callAppContentSharingStartedEvent:1,contentCameraState:1,callPptSharingStartFailedEvent:1,noiseSuppressionChangedEvent:1,autoGainControlChangedEvent:1,whiteboardSharingStartFailedEvent:1,callAppContentSharingStartFailedEvent:1,annotationChangedEvent:1,callPptSharingJoinFailedEvent:1,callLayoutChangedEvent:1,callContentCameraSharingChangedEvent:1,callParticipantPinnedEvent:1,callingScreenGalleryTypeChangedEvent:1,callingPoliciesChangedEvent:1,hasOngoingCallsChangedEvent:1,subscribedCallChangedEvent:1,bluetoothStateChangedEvent:1,callTranscriptStateEvent:1,callTranscriptEditEvent:1,callTranscriptEntryEvent:1,teamsCallIdChangedEvent:1,callHealthCategoriesUpdatedEvent:1,callingIntentEvent:1,callParticipantsChangedEvent:1,callParticipantsOnlyChangedEvent:1,callParticipantsCountsOnlyChangedEvent:1,meetingRoomCortanaStateChangedEvent:1,cortanaEvent:1,meetingRoomCortanaEnabled:1,meetingRoomRemoteSelectedLayoutChangedEvent:1,meetingRoomSwapScreensButtonStateChangedEvent:1,callParticipantsVoiceLevelsChangedEvent:1,callParticipantsReactionsEvent:1,callingAllowedEvent:1,hasUnreadMessagesChanged:1,spatialAudioConfigsChangedEvent:1,startStreamsEvent:1,callingScreenStatusChanged:1,callingAppEvents:1,callingClientStateEvent:1,raiseHandStateChangedEvent:1,systemAudioStateChanged:1,closedCaptionsDynamicEntryEvent:1,closedCaptionsEntryEvent:1,closedCaptionsStatusEvent:1,coachStatusEvent:1,videoAvailableForConversationChangedEvent:1,audienceSceneSeatingChangedEvent:1,screenShareControlEvent:1,videoEffectConfigChangedEvent:1,videoCapabilityLimitsChangedEvent:1,videoLayoutCapabilitiesChangedEvent:1,roomRemoteStateUpdateEvent:1,roomRemoteCapabilitiesUpdateEvent:1,roomRemoteProximityBannerEvent:1,e2eeStatusChangedEvent:1,videoEffectReadinessChangedEvent:1,windowsEffectsCapabilityChangedEvent:1,framesinkEventsChangedEvent:1,videoEffectCapabilitiesChangedEvent:1,setScalingEvent:1,scalingModeUpdatedEvent:1,emergencyAddressUpdatedEvent:1,emergencyCustomDisclaimerUpdatedEvent:1,thirdPartyDevicesEvent:1,holographicAnnotationEvent:1,holographicCallStateChangedEvent:1,currentSeatMappingChangedEvent:1,parkedCallsChangedEvent:1,slaCallsChangedEvent:1,sharedLineCallInvitationContent:1,streamingInfoChangedEvent:1,callingAggregateSettingsEvent:1,audioEndedEvent:1,activityEvent:2,activitySettingsChangedEvent:4,hasAppDevicePermission:8,launchTileUpdatedEvent:11,lockedTilesUpdatedEvent:11,m365ApplicationUpdatedEvent:11,m365ApplicationsUpdated:11,installedAppsUpdateEvent:13,installedAppsUpdateEventV2:13,taskModuleUpdateEvent:13,taskModuleUpdateEventV2:13,appsUsageUpdateEvent:13,appsInstalledByCurrentUserEvent:13,biometricVoiceEnrollmentProgressEvent:15,biometricVoiceEnrollmentMicNrgLevelEvent:15,appServiceStateChanged:22,authenticationUsersEvent:24,authenticationStateChanged:24,broadcastQnaFeedStatusEvent:25,broadcastUpdatedEvent:25,multiSlotFormEvent:26,callBlockingListChangedEvent:28,experienceAccountMode:31,fileUploadProgressEvent:32,onSurveySend:33,liveStreamErrorEvent:34,liveStreamPlaybackStartedEvent:34,liveStreamPlaybackNotLiveEvent:34,liveStreamPlaybackStateChangedEvent:34,liveStreamPlaybackSeekedEvent:34,liveStreamUrlSwitchedEvent:34,liveStreamFirstFrameRenderedEvent:34,liveStreamFullScreenToggledEvent:34,liveStreamCaptionsToggledEvent:34,meetAppInsightsEvent:37,meetingBotActionEvent:39,voicemailsChangedEvent:52,syncCalendarEvents:54,calendarSyncStateUpdates:54,syncMultiCalendarEvents:54,syncCalendarLeftRailSettings:54,syncCalendarEventsWithPagination:54,callableChannelUpdatedEvent:55,callingConversationStateEvent:56,hasMessageChanged:56,channelSystemMessageUpdateEvent:57,channelPinnedPostsUpdateEvent:57,replyChainSummaryEvent:58,replyChainMessageEvent:58,channelModerationUpdateEvent:58,crossPostSelectedChannelIdsEvent:58,messagePaneActivityEvent:60,chatListEvent:60,chatListBatchEvent:60,chatPinEvent:60,chatListMissedActivitiesEvent:60,chatServiceEvent:60,chatServiceBatchEvent:60,chatMembersEvent:60,chatServicePostActiveEvent:60,suggestedContactsEvent:60,chatBadgeCountEvent:60,hasTypingUsersEvent:60,typingUsersEvent:60,communitiesBatchEvent:64,keyboardLanguageEvent:65,connectedCalendarSettingsChangedEvent:66,suggestedContactsChangeEvent:68,displayContactsSyncBannerEvent:69,contactsSyncSettingsChangedEvent:70,connectedAccountStateEvent:70,conversationsReminderUpdatedEvent:71,registerForDesktopClientKeyDownShortcuts:73,discoverFeedHasUpdatedItems:75,espTriggerEvent:78,activeEspTargetChangedEvent:79,p2pFilesListUpdated:85,p2pFilesListStoreErrorUpdated:85,hostUpdateState:89,reportAProblemLogUpload:90,callParticipantsReactionsLiveStateEvent:94,callMeetingNotesLiveStateEvent:94,clientPreferencesChangedEvent:95,requestMuteInAppEvent:105,isMutedInAppChangedEvent:105,meshSpacesParticipantsUpdated:106,missedMTMANotificationsUpdateEvent:108,platformTabsEvent:116,platformTabEventV2:116,platformTabEvent:116,externalAuthDeeplinkEvent:116,tswSdkMessageEvent:116,shareFormStatusEvent:117,teamsAndChannelsTabAddedEvent:117,platformTabsNavigationEvent:117,selectAppEntityEvent:117,registerBackButtonEvent:117,policiesUpdatedEvent:118,presencePostActiveEvent:119,presenceUpdateEvent:119,windowState:131,zoomState:131,customFrameAreaEvent:131,backdropEffectState:131,flyoutBeaconUpdatedEvent:137,flyoutChatBadgeUpdatedEvent:137,taskbarBadgeUpdatedEvent:137,teamsAndChannelsBatchEvent:141,teamsAndChannelsSyncEvent:141,gridViewUpdateEvent:141,channelByIDUpdateEvent:141,toastEvent:148,channelToastEvent:148,syntheticNotificationToastEvent:148,communitiesToastEvent:148,msaProfileAvatarChangedEvent:154,userPreferencesChangedEventForCategory:156,windowStateEvent:159,callingServiceStateEvent:160,blockedContactChangedEvent:160,contactAcceptOrBlockExtendedChangedEvent:160,callChatBubbleToggleEvent:160,localMediaVideoStreamUpdatesEvent:160,meetingRoomAppStateEvent:160,callRemotePtzCameraStateChangedEvent:160,meetingRoomThemeChangedEvent:160,meetingRoomDisplayDisconnectedEvent:160,bleLoudSpeakerInMeetingEvent:160,adjacentRoomFoundWithIntentEvent:160,nearbyRoomsChangedEvent:160,ultrasoundRoomsChangedEvent:160,broadcastStreamingDetailsUpdatedEvent:160,playerInteractionOperationEvent:160,meetingRoomRemoteControlVisibilityChangedEvent:160,meetingRoomOemPluginConnectionChangedEvent:160,scdStatusEvent:160,biometricEnrollmentDevicesEvent:160,botSsoRequestEvent:160,buddyGroupUpdatedEvent:160,buddyGroupsChangedEvent:160,attendeeTranscriptionEvent:160,callTechnicalInfoEvent:160,systemAudioDriverStateChangedEvent:160,delegateSettingsChangedEvent:160,callQueueIntentIdTeamsCallIdChangedEvent:160,escalatedCallConversationChangedEvent:160,callCompositorFailedEvent:160,dynamicCommandsUpdateEvent:160,liveStreamChangedEvent:160,eyeContactCapabilityChangedEvent:160,spatialAudioToggleChangedEvent:160,videoEffectStateChangedEvent:160,gestureBasedReactionEvent:160,deeplinkSharingStartedEvent:160,callForwardingSettingsChangedEvent:160,unifiedWebinarDataUpdateEvent:160,supportedMeetingsListChangedEvent:160,complianceRecordingStateChangedEvent:160,meetingRoomHdmiIngestStateChangedEvent:160,teamsWithActivityCountsAndMentionsEvent:160,meetingRoomMeetingJoinErrorEvent:160}}});var sh=n(90290),lh=n(17968),dh=n(85444);const ch=(e,t="resolverUncaughtErrorBoundary__doNotAssignToGraphQLTeam")=>(0,dh.q)((({graphQLErrors:n})=>{const i=e.newLogger(t);n&&n.forEach((({path:e})=>{if(e){const t=function(e){return e.map((e=>"number"==typeof e?`[${e.toString()}]`:`${e}`)).join(".")}(e);i.error(`Uncaught error in a GraphQL resolver, at field selection path: ${t}`)}else i.error("Unknown uncaught error in a GraphQL resolver")}))}));function uh(e,t,n){if(!t||0===Object.keys(t).length)return!1;const{query:i}=e,a=(0,Ag.p$)(i);if(!a||a&&"OperationDefinition"!==a.kind)return!1;const{selectionSet:{selections:o}}=a,r=(0,du.S)(i,null);if(!r)return!1;const s=r.operation;let l=!1;return o.every((e=>{if("Field"===e.kind){if(t[s]&&t[s].has(e.name.value))return l=!0,!0;if(l){n.newLogger("isDataLayerClientOperationSupported").error(`Unexpected partially supported operation - unsupported selection = ${e.name.value}`)}}return!1}))}class mh{static createSingletonLink(e){return(0,c.mG)(this,void 0,void 0,(function*(){if(mh._singletonLink)throw new Error("Links are already created");return mh._singletonLink=np.i.from(yield mh.createDefaultLinks(e)),mh._singletonLink}))}static createLink(e){return(0,c.mG)(this,void 0,void 0,(function*(){return np.i.from(yield mh.createDefaultLinks(e))}))}static get singletonLink(){return mh._singletonLink}static createViewSchemaLink(e){return this._viewSchemaImportPromise||(this._viewSchemaImportPromise=Promise.all([n.e(2938),n.e(3181)]).then(n.bind(n,70050))),np.i.from([ch(e.loggerFactory,"apolloViewSchemaLinkCatchedErrors"),this.createLazyViewSchemaTerminatingLink(e,this._viewSchemaImportPromise)])}static createLazyViewSchemaTerminatingLink(e,t){let n;return this._viewSchemaImport&&this._viewSchemaExecutor?this._viewSchemaImport.createViewSchemaTerminatingLink(e,this._viewSchemaExecutor):new np.i(((i,a)=>new ip.y((o=>{let r,s=!1;return t.then((t=>(this._viewSchemaExecutor||(this._viewSchemaExecutor=new t.ViewSchemaExecutor),this._viewSchemaImport||(this._viewSchemaImport=t),n||(n=t.createViewSchemaTerminatingLink(e,this._viewSchemaExecutor)),n))).then((e=>{var t;s||(r=null===(t=e.request(i,a))||void 0===t?void 0:t.subscribe({next:o.next.bind(o),error:o.error.bind(o),complete:o.complete.bind(o)}))})).catch(o.error.bind(o)),()=>{s=!0,r&&r.unsubscribe()}}))))}static createPatchVariablesLink(e){return jp({contextValue:e,resolvers:[Pp.s]})}static createTerminatingLink({config:e,contextValue:t,cdlWorkerService:n,dataClientTrackingService:i,loggerFactory:a,scenarioFactory:o,coreSettings:r,leakDetectorService:s,windowProvider:l},d){return(0,c.mG)(this,void 0,void 0,(function*(){const c=mh.createMainRendererTerminatingLink(e.clientId,a,o,l,r,s,i),u=np.i.concat(function(e,t){return(0,ih.G)({map:rh(t),contextBuilder:()=>e.contextValue,schemaBuilder({typeDefs:t,resolvers:n}){const i=(0,oh.yM)(n),a=e.enableClassBasedErrors?"function"==typeof i?(...e)=>eh(i(...e),"WebResolver"):eh(i,"WebResolver"):i;return(0,ah.sJ)({typeDefs:t,resolvers:a,noExtensionExtraction:!0,updateResolversInPlace:!0,resolverValidationOptions:{requireResolversForResolveType:"ignore"},skipASTValidation:!0})}})}({contextValue:t,enableClassBasedErrors:!!r.get(A.J.Core).enableClassBasedErrors},o),Xp()),m=a.newLogger("createTerminatingLink"),g=(0,lh.Om)(r,m);let p=np.i.split((e=>function(e,t,n,i){const{enableCentralDataLayer:a}=n.get(A.J.Host);return!!a&&uh(e,t,i)}(e,g,r,a)),(0,sh.z)(xp(),c),u);return Oc(r)&&!d&&(p=yield mh.createCDLWorkerTerminatingLink(n,e,a,o,r,m,p)),p}))}static createMainRendererTerminatingLink(e,t,n,i,a,o,r){const s=a.get(A.J.Cdl),{logCdlOperationsDuringWaitSettings:l}=a.get(A.J.Core),d=this.createDataLayerClientSettings(a);return Dp(new uu(e,t,n,new Ep((0,Q.J)()),o,"Angular",i,{enableRequestHealthMonitor:!!s.enableRequestHealthMonitor,failureCountThreshold:s.requestHealthMonitorFailureCountThreshold,timeoutCountThreshold:s.requestHealthMonitorTimeoutCountThreshold,timeoutLengthSeconds:s.requestHealthMonitorTimeoutLengthSeconds},void 0,void 0,{enableLoggingCdlOperationsDuringWait:null==l?void 0:l.enableLoggingCdlOperationsDuringWait,enableTrackingCdlOperationsDuringWait:null==l?void 0:l.enableTrackingCdlOperationsDuringWait,trackingCdlOperationsDuringWaitThresholdInMs:null==l?void 0:l.trackingCdlOperationsDuringWaitThresholdInMs,trackingCdlOperationsDuringWaitBufferSize:null==l?void 0:l.trackingCdlOperationsDuringWaitBufferSize},r,void 0,d))}static createDataLayerClientSettings(e){const{cdlSubscriptionAggregatorAllowList:t}=e.get(A.J.Sync);return{cdlSubscriptionAggregatorAllowList:t||[]}}static createCDLWorkerTerminatingLink(e,t,n,i,a,o,r){return(0,c.mG)(this,void 0,void 0,(function*(){if(!e)return o.warn("Not creating CDL Worker terminating link. Worker is enabled, but service is unavailable."),r;const s=yield e.getCDLWorkerManager();if(!s)return o.warn("Not creating CDL Worker terminating link. Worker is enabled, service is available but workerManager is not defined."),r;const l=Dp(yield e.getDataLayerClient()),d=(0,lh.Ng)(a,o,s.cdlWorkerSupportedResolvers);return r=np.i.split((e=>function(e,t,n){return uh(e,t,n)}(e,d,n)),(0,sh.z)(xp(),l),r),a.get(A.J.CdlWorker).enableControlPlaneLink&&(r=yield mh.createCDLWorkerControlPlaneTerminatingLink(e,t,n,i,r,a)),r}))}static createCDLWorkerControlPlaneTerminatingLink(e,t,n,i,a,o){return(0,c.mG)(this,void 0,void 0,(function*(){const r=yield e.getControlPlaneCommunicator(),s=Dp(new uu(t.clientId,n,i,r,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.createDataLayerClientSettings(o)));return a=np.i.split((e=>function(e,t){return uh(e,Fp,t)}(e,n)),(0,sh.z)(xp(),s),a)}))}}mh._singletonLink=null,mh._viewSchemaExecutor=null,mh.createDefaultLinks=e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{contextValue:t,loggerFactory:n,scenarioFactory:i,coreSettings:a,noCDLTerminatingLink:o}=e,r=yield mh.createTerminatingLink(e,o),s=mh.createPatchVariablesLink(t),l=a.get(A.J.Core).enableGraphQlOpsCount,d=a.get(A.J.Core).enableTrackRequestsLink,c=l||d?[Hp(n,i,l,d,t.graphqlOpsCountService)]:[],u=a.get(A.J.Calling).enableSubscriptionCancellationListener?[qp(n,a)]:[],m=Jp("presenceUpdateEvent",a),g=Jp("callParticipantUpdatedEvent",a),p=Jp("callParticipantsChangedEvent",a),h=Jp("callParticipantsVoiceLevelsChangedEvent",a),v=Jp("chatServiceEvent",a),S=Jp("blockedContactChangedEvent",a);return[...c,...u,s,ch(n),m,g,p,h,v,S,r]}));var gh=n(86724);const ph=()=>(0,gh.ZB)(["filter","typeFilter"]);function hh(e,t){return t("timestamp",e||{})||""}const vh=()=>{const e=(0,gh.ZB)(!1),{read:t,merge:n}=e,i=(0,c._T)(e,["read","merge"]);return Object.assign(Object.assign({},i),{merge:(e,t,i)=>{var a,o;if("function"==typeof n){const r=n(e,t,i),{readField:s}=i,l=(0,Z.uniqBy)(null==r?void 0:r.edges,(e=>s("id",e.node)));return Object.assign(Object.assign({},r),{edges:l,pageInfo:Object.assign(Object.assign({},null==r?void 0:r.pageInfo),{startCursor:s("timestamp",null===(a=(0,Z.head)(l))||void 0===a?void 0:a.node),endCursor:s("timestamp",null===(o=(0,Z.last)(l))||void 0===o?void 0:o.node)})})}return n},read:(...e)=>{const n=e[0],{readField:i}=e[1];if(!n||!t)return;if(!n.edges)return n;const a=[...n.edges].sort(((e,t)=>function(e,t,n){const i=null==e?void 0:e.node,a=null==t?void 0:t.node,o=hh(i,n),r=hh(a,n);return o?r?parseInt(r,10)-parseInt(o,10):-1:1}(e,t,i)));return Object.assign(Object.assign({},t(...e)),{edges:a})}})};const Sh=()=>{const e=(0,gh.ZB)(!1),{merge:t}=e,n=(0,c._T)(e,["merge"]);return Object.assign(Object.assign({},n),{merge:(e,n,i)=>{if(fh(t)){if(!e)return n;const{readField:a}=i,o=t(e,n,i),r="objectId",s=(0,Z.uniqBy)(o.edges,(e=>a(r,e.node)));return Object.assign(Object.assign({},o),{edges:s,pageInfo:Object.assign({},o.pageInfo)})}return t}})},fh=e=>"function"==typeof e,yh=e=>{const t=rp.Query||{fields:{}};return Object.assign(Object.assign(Object.assign({},rp),e),{Query:Object.assign(Object.assign({},t),{fields:Object.assign(Object.assign({},t.fields),{chats:ph(),recentsChats:ph(),pinnedChats:ph(),activities:vh(),suggestedContactsInChatList:(0,gh.ZB)(["filter","typeFilter"]),fluidMessages:{merge:(e,t)=>[...t]},feed:{merge:!0},calendarEventsV3WithPagination:Sh(),pinnedChannels:{merge:!1}})})})},kh=e=>"cache-and-network"===e||"network-only"===e?"cache-first":e;const Ch={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"deletedMessages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deletedMessages"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"message"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageFieldsForDeletedMessages"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageFieldsForDeletedMessages"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"time"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"count"}}]}},{kind:"Field",name:{kind:"Name",value:"escalations"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"time"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"userHasSaved"}},{kind:"Field",name:{kind:"Name",value:"diagnosticInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"diagnosticErrorCode"}},{kind:"Field",name:{kind:"Name",value:"diagnosticMessage"}}]}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"previewUrl"}},{kind:"Field",name:{kind:"Name",value:"previewHeight"}},{kind:"Field",name:{kind:"Name",value:"previewWidth"}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"FragmentSpread",name:{kind:"Name",value:"deletionInfo"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]}.definitions]};const bh=(e,t)=>{let n;try{n=e.readQuery({query:Ch})}catch(e){t&&t.error("Unable to fetch deleted messages",e)}return n&&n.deletedMessages||[]},Th=(e,t,n,i,a,o)=>{const r={message:null,isDeletedLieMessage:!1};if(!(o=o||bh(e,i))||0===o.length)return r;if(!a){const e=o.find((e=>e.id===t));if(e)return{message:e,isDeletedLieMessage:!1}}const s=o.find((e=>e.message&&e.message.clientMessageId===n));return s?{message:s,isDeletedLieMessage:!0}:r},wh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quotedReply"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quotedReply"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"preview"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}}]}}]}}]};var _h=n(96843),Ih=n(72080);var Ah=n(49355);var Nh=n(21164),Eh=n(75206),Dh=n(30958),Fh=n(99451);const Ph={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"chat"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}},{kind:"Field",name:{kind:"Name",value:"chatSubType"}},{kind:"Field",name:{kind:"Name",value:"chatType"}},{kind:"Field",name:{kind:"Name",value:"isSfB"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMeeting"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMuted"}},{kind:"Field",name:{kind:"Name",value:"isFederated"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isRetentionHorizonSet"}},{kind:"Field",name:{kind:"Name",value:"isModerator"}},{kind:"Field",name:{kind:"Name",value:"hasBotMember"}},{kind:"Field",name:{kind:"Name",value:"chatDisabledContext"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUIDisabled"}},{kind:"Field",name:{kind:"Name",value:"disabledReason"}},{kind:"Field",name:{kind:"Name",value:"extendedData"}},{kind:"Field",name:{kind:"Name",value:"lastUpdatedTime"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizonBookmark"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"userConsumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"memberIds"}},{kind:"Field",name:{kind:"Name",value:"botMembers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"creator"}},{kind:"Field",name:{kind:"Name",value:"meetingInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingInformationFields"}}]}},{kind:"Field",name:{kind:"Name",value:"tenantId"}}]}}]}},...Nh.T.definitions,...Eh.v.definitions,...Dh.f.definitions,...Fh.q.definitions]},Mh=e=>({__typename:"ChatDisabledContext",isUIDisabled:e.isUIDisabled,disabledReason:e.disabledReason,extendedData:e.extendedData,lastUpdatedTime:e.lastUpdatedTime}),jh=()=>({__typename:"ChatDisabledContext",isUIDisabled:!1,disabledReason:Rt.ChatDisabledContextReason.UnknownReason,extendedData:null,lastUpdatedTime:null}),Rh=()=>({__typename:"ChatDisabledContext",isUIDisabled:!1,disabledReason:Rt.ChatDisabledContextReason.ChatDisabledDueToBotStatus,extendedData:null,lastUpdatedTime:null}),xh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fluidMessages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidMessages"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}}]}}]}}]},Oh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fluidManifestEntries"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locale"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidManifestEntries"},arguments:[{kind:"Argument",name:{kind:"Name",value:"locale"},value:{kind:"Variable",name:{kind:"Name",value:"locale"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locale"}},{kind:"Field",name:{kind:"Name",value:"entries"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}}]}}]}}]},Lh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fluidPendingMentions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"componentHash"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidPendingMentions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"componentHash"},value:{kind:"Variable",name:{kind:"Name",value:"componentHash"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"atMentionId"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}},{kind:"Field",name:{kind:"Name",value:"contentId"}},{kind:"Field",name:{kind:"Name",value:"navigationPath"}}]}}]}}]};const Uh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"composeState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"composeState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isExpanded"}}]}}]}}]},Bh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"imageAltText"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"imageAltText"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},Wh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"insertedHyperlink"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"insertedHyperlink"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"displayText"}},{kind:"Field",name:{kind:"Name",value:"address"}}]}}]}}]},Gh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"dlpDialogData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dlpDialogData"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isReport"}},{kind:"Field",name:{kind:"Name",value:"isOverride"}},{kind:"Field",name:{kind:"Name",value:"justification"}}]}}]}}]},Vh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messagePaneScrolledToStartState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messagePaneScrolledToStartState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isScrolledToStart"}}]}}]}}]},Hh={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageFieldsForTranslation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"fromLanguage"}}]}}]}}]},$h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"twoWaySmsFriendlyName"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"twoWaySmsFriendlyName"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},zh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"smartReplyFileSuggestion"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"smartReplyFileSuggestion"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileName"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}}]},qh={Query:{fluidManifestEntries:(e,{locale:t},{cache:n,loggerFactory:i})=>((e,t,n)=>{try{const n=e.readQuery({query:Oh,variables:{locale:t}});return null==n?void 0:n.fluidManifestEntries}catch(e){return void n.newLogger("fluid-manifest-entries").error("Failed to retrieve the cached fluid manifest json")}})(n,t,i)||null,requestImmersiveReader:(e,{conversationId:t,messageId:n,setFocusOnClose:i},a)=>function(e,t,n){return(0,Q.J)().opener.open(Bt.B.OpenOnMainRenderer,Bt._.ImmersiveReader,{conversationId:e,messageId:t,setFocusOnClose:n}),!0}(t,n,i)},Conversation:Object.assign({isFederated(e){var t;return null!==(t=e.isFederated)&&void 0!==t?t:(0,Ih.eX)(e.id)},isMeeting(e){var t;return null!==(t=e.isMeeting)&&void 0!==t?t:(0,_h.e9)(e.id)},isSfB(e){var t;return null!==(t=e.isSfB)&&void 0!==t?t:(0,Ih.C6)(e.id)},chatDisabledContext:e=>(e=>{if(!e)return null;if(!e.chatDisabledContext){const t=e;return t&&t.isDisabled&&t.isOneOnOne&&t.hasBotMember?Rh():jh()}return e.chatDisabledContext})(e)},{isHighImportance:()=>null,isUrgentImportance:()=>null,activeCallsCount:()=>null,datatid:()=>null,displayName:()=>null,hasActiveCalls:()=>null,hasFailedMessages:()=>null,otherMemberMris:()=>null,isNewChat:()=>null,isBotBlocked:()=>null,isBotUser:()=>null,isHidden:()=>null,isContactTagged:()=>null,pictureUpn:()=>null,pinnedIndex:()=>null,showAtMention:()=>null,showMarkers:()=>null,tooltipTitle:()=>null,longTitle:()=>null,pictureGroup:()=>null,lastMessageTime:()=>null,messagePreview:()=>null,messagePreviewAria:()=>null,isLastMessageText:()=>null,plGroupKey:()=>null,presenceSource:()=>null,hasActions:()=>null,canBeDiscarded:()=>null,canBotBeBlocked:()=>null,canBePinned:()=>null,canBeMuted:()=>null,canBeLeft:()=>null,canBeHidden:()=>null,canBeFavorited:()=>null,canTagContact:()=>null,canPopOut:()=>null,canManageApps:()=>null}),Mutation:{untranslateMessage:(e,{messageId:t},{cache:n,loggerFactory:i})=>function(e,t,n){if(!t)return null;const i=Ah.Ps`
    fragment originalMessageFields on Message {
      id
      content
    }
  `;try{const n=e.readFragment({id:`Message:${t}`,fragment:i});return n?n.content:null}catch(e){return n.error(`Failed to get message from cache: ${e}`),null}}(n,t,i.newLogger("untranslateMessage")),updateChatDisabledContext:(e,{convId:t,isUIDisabled:n,disabledReason:i,extendedData:a},{cache:o})=>((e,t,n,i,a)=>{const o={convId:t},r={__typename:"ChatDisabledContextResponse",message:"",success:!1,chatDisabledContext:jh()};try{const t=e.readQuery({query:Ph,variables:o});if(!t||!t.chat)return r.message="Could not update chatDisabledContext for a null chat conversation",r;const s=Date.now().toString();t.chat.chatDisabledContext&&(r.chatDisabledContext=Object.assign({},t.chat.chatDisabledContext));const l={__typename:"ChatDisabledContext",isUIDisabled:n,disabledReason:i,extendedData:a,lastUpdatedTime:s},d={chat:Object.assign(Object.assign({},t.chat),{chatDisabledContext:l})};e.writeQuery({query:Ph,variables:o,data:d}),r.success=!0,d&&d.chat&&d.chat.chatDisabledContext&&(r.chatDisabledContext=Mh(d.chat.chatDisabledContext))}catch(e){r.message=`Exception: Failed to update chatDisabledContext for conversation ${t}. Exception Details: ${e.message}`}return r})(o,t,n,i,a),resetQuotedReply:(e,{convId:t},{cache:n})=>((e,t)=>(t.writeQuery({query:wh,variables:{convId:e},data:{quotedReply:null}}),!0))(t,n),setQuotedReply:(e,{convId:t,quotedReply:n},{cache:i})=>((e,{displayName:t,from:n,messageId:i,preview:a,timestamp:o},r)=>{const s={quotedReply:{__typename:"QuotedReply",displayName:t,from:n,messageId:i,preview:a,timestamp:o}};return r.writeQuery({query:wh,variables:{convId:e},data:s}),!0})(t,n,i),updateComposeState(e,{id:t,isExpanded:n},{cache:i,loggerFactory:a}){return(0,c.mG)(this,void 0,void 0,(function*(){const e={__typename:"ComposeMessageState",id:t,isExpanded:n};try{i.writeQuery({query:Uh,variables:{id:t},data:{composeState:Object.assign(Object.assign({},e),{__typename:"ComposeMessageState"})}})}catch(e){a.newLogger("update-compose-state").error(`Failed to write to client cache the compose state query. Error: ${e.message}`)}return e}))},setImageAltText(e,{altText:t},{cache:n,loggerFactory:i}){return(0,c.mG)(this,void 0,void 0,(function*(){const e={imageAltText:t};try{n.writeQuery({query:Bh,data:e})}catch(e){i.newLogger("update-image-alt-text").error(`Failed to write to client cache the image alt text query. Error: ${e.message}`)}return!0}))},insertHyperlink(e,{displayText:t,address:n},{cache:i,loggerFactory:a}){return(0,c.mG)(this,void 0,void 0,(function*(){const e={__typename:"FluidInsertedHyperlink",displayText:t,address:n};try{i.writeQuery({query:Wh,data:{insertedHyperlink:Object.assign(Object.assign({},e),{__typename:"FluidInsertedHyperlink"})}})}catch(e){a.newLogger("insert-hyperlink-dialog-data").error(`Failed to write to client cache the insert hyperlink dialog data query. Error: ${e.message}`)}return!0}))},setTwoWaySmsFriendlyName(e,{twoWaySmsFriendlyName:t},{cache:n,loggerFactory:i}){return(0,c.mG)(this,void 0,void 0,(function*(){const e={twoWaySmsFriendlyName:t};try{n.writeQuery({query:$h,data:e})}catch(e){i.newLogger("update-tfl-two-way-sms-friendly-name").error(`Failed to write to client cache the tfl two way sms friendly name query. Error: ${e.message}`)}return!0}))},updateMessagePaneScrolledToStartState(e,{id:t,isScrolledToStart:n},{cache:i,loggerFactory:a}){return(0,c.mG)(this,void 0,void 0,(function*(){const e={__typename:"MessagePaneScrolledToStartState",id:t,isScrolledToStart:n};try{i.writeQuery({query:Vh,variables:{id:t},data:{messagePaneScrolledToStartState:Object.assign(Object.assign({},e),{__typename:"MessagePaneScrolledToStartState"})}})}catch(e){a.newLogger("update-chat-bottom-state").error(`Failed to write to client cache the chat bottom state query. Error: ${e.message}`)}return e}))},setDlpDialogData(e,{isReport:t,isOverride:n,justification:i},{cache:a,loggerFactory:o}){return(0,c.mG)(this,void 0,void 0,(function*(){const e={__typename:"DlpDialogData",isReport:t,isOverride:n,justification:i};try{a.writeQuery({query:Gh,data:{dlpDialogData:Object.assign(Object.assign({},e),{__typename:"DlpDialogData"})}})}catch(e){o.newLogger("set-dlp-dialog-data").error(`Failed to write to client cache the set dlp dialog data query. Error: ${e.message}`)}return e}))},setFluidMessage:(e,{fluidMessage:t,remove:n},{cache:i,loggerFactory:a})=>(({messageId:e,originalArrivalTime:t},n,i,a)=>{try{const a=i.readQuery({query:xh}),o=n?function(e,t){var n;return{fluidMessages:(null===(n=null==e?void 0:e.fluidMessages)||void 0===n?void 0:n.filter((e=>e.messageId!==t)))||[]}}(a,e):function(e,t,n){const i=[],a={__typename:"FluidMessage",id:t,messageId:t,originalArrivalTime:n};let o=!1;if(null==e?void 0:e.fluidMessages)for(const t of e.fluidMessages)t.originalArrivalTime<a.originalArrivalTime&&!o&&(i.push(a),o=!0),i.push(t);return o||i.push(a),{fluidMessages:i}}(a,e,t);return i.writeQuery({query:xh,data:o}),!0}catch(e){return a.newLogger("set-fluid-messages-pending-load").error(`Failed to write to client cache the set fluid message pending load query. Error: ${e.message}`),!1}})(t,!!n,i,a),setFluidManifestEntries:(e,{locale:t,entries:n},{cache:i,loggerFactory:a})=>((e,t,n,i)=>{try{const i={fluidManifestEntries:{__typename:"FluidManifestEntries",locale:e,entries:t,timestamp:Date.now()}};return n.writeQuery({query:Oh,variables:{locale:e},data:i}),!0}catch(e){return i.newLogger("fluid-manifest-entries").error(`Failed to write to client cache that set fluid manifest json query. Error: ${e.message}`),!1}})(t,n,i,a),updateFluidPendingMentions:(e,{componentHash:t,pendingMention:n,remove:i},{cache:a,loggerFactory:o})=>((e,t,n,i,a)=>{try{const a=Object.assign({__typename:"FluidPendingMention"},t),o={componentHash:e},r=i.readQuery({query:Lh,variables:o}),s=((null==r?void 0:r.fluidPendingMentions)||[]).filter((e=>a.userPrincipalName!==e.userPrincipalName)),l=n?s:[...s,a];return i.writeQuery({query:Lh,variables:o,data:{fluidPendingMentions:l}}),!0}catch(e){return a.newLogger("fluid-resolvers-update-pending-fluid-mentions").error(`Failed to write pending mentions to the cache, error="${e.message}"`),!1}})(t,n,!!i,a,o),clearFluidPendingMentions:(e,{componentHash:t},{cache:n,loggerFactory:i})=>((e,t,n)=>{try{const n={componentHash:e};return t.writeQuery({query:Lh,variables:n,data:{fluidPendingMentions:[]}}),!0}catch(e){return n.newLogger("fluid-resolvers-clear-fluid-pending-mentions").error(`Failed to clear pending mentions from the cache, error="${e.message}"`),!1}})(t,n,i),resetSmartReplyFileSuggestion:(e,{convId:t},{cache:n,loggerFactory:i})=>((e,t,n)=>{const i={smartReplyFileSuggestion:null};try{return t.writeQuery({query:zh,variables:{convId:e},data:i}),!0}catch(e){return n.newLogger("ResetSmartReplyFileSuggestion").error(`Failed to reset smart reply file suggestion in cache: ${e}`),!1}})(t,n,i),setSmartReplyFileSuggestion:(e,{convId:t,fileSuggestion:n},{cache:i,loggerFactory:a})=>((e,{fileName:t,url:n},i,a)=>{try{const a={smartReplyFileSuggestion:{__typename:"SmartReplyFileSuggestion",fileName:t,url:n}};return i.writeQuery({query:zh,variables:{convId:e},data:a}),!0}catch(e){return a.newLogger("SetSmartReplyFileSuggestion").error(`Failed to set smart reply file suggestion in cache: ${e}`),!1}})(t,n,i,a)},Message:{deletionInfo:(e,t,{cache:n})=>function(e,t){const{message:n}=Th(e,t.id,t.clientMessageId,void 0,!(null==t?void 0:t.deleteTime)),i=n&&n.message&&n.message.importance===Rt.MessageImportance.Urgent;return{__typename:"DeletionInfo",showMessageAsDeleted:!!n,canBeUndeleted:!!n&&!i,deleteFailed:!1}}(n,e),translation:(e,t,{cache:n})=>{var i;try{const t=`Message:${e.id}`,a=null===(i=n.readFragment({id:t,fragment:Hh}))||void 0===i?void 0:i.translation;return a?Object.assign(Object.assign({},a),{__typename:"Translation"}):null}catch(e){return null}},diagnosticInfo:()=>({__typename:"DiagnosticInfo",diagnosticErrorCode:-1,diagnosticMessage:null})}},Jh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientCalendarSchedulingFormBlockingTasksQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"schedulingFormBlockingTasks"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}}]}}]},Qh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientCalendarSchedulingFormTerminatingActionQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"schedulingFormTerminatingAction"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},Kh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientCalendarSchedulingFormActiveTabQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"schedulingFormActiveTab"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]},Yh={Query:{schedulingFormActiveTab(e,t,{cache:n,loggerFactory:i}){var a,o;try{const e=n.readQuery({query:Kh});return null!==(a=null==e?void 0:e.schedulingFormActiveTab)&&void 0!==a?a:null}catch(e){const t=i.newLogger("scheduling-form-active-tab");return null===(o=t.errorToTelemetry)||void 0===o||o.call(t,"schedulingFormActiveTab: Failed to fetch scheduling form active tab from cache.","calendar_form_active_tab"),null}},schedulingFormBlockingTasks(e,t,{cache:n,loggerFactory:i}){var a,o;try{const e=n.readQuery({query:Jh});return null!==(a=null==e?void 0:e.schedulingFormBlockingTasks)&&void 0!==a?a:[]}catch(e){const t=i.newLogger("scheduling-form-blocking-task");return null===(o=t.errorToTelemetry)||void 0===o||o.call(t,"schedulingFormBlockingTasks: Failed to fetch scheduling form blocking task from cache.","calendar_form_blocking_tasks"),[]}},schedulingFormTerminatingAction(e,t,{cache:n,loggerFactory:i}){var a,o,r;try{return null!==(o=null===(a=n.readQuery({query:Qh}))||void 0===a?void 0:a.schedulingFormTerminatingAction)&&void 0!==o?o:null}catch(e){const t=i.newLogger("scheduling-form-terminating-action");return null===(r=t.errorToTelemetry)||void 0===r||r.call(t,"schedulingFormTerminatingAction: Failed to fetch scheduling form terminating action from cache.","calendar_form_terminating_action"),null}},calendarLeftRail:()=>({isExpanded:!0})},Mutation:{addSchedulingFormBlockingTask(e,{input:{task:t}},{cache:n,loggerFactory:i}){var a,o,r,s;const l=i.newLogger("add-scheduling-form-blocking-task"),d=(0,Je.v4)();try{const e=null!==(o=null===(a=n.readQuery({query:Jh}))||void 0===a?void 0:a.schedulingFormBlockingTasks)&&void 0!==o?o:[],i=e.find((e=>e.type===t.type));if(i&&i.state===Rt.SchedulingFormTaskState.Active)return null===(r=l.errorToTelemetry)||void 0===r||r.call(l,"addSchedulingFormBlockingTask: Failed to write scheduling form blocking task in cache. Existing active task of same type already exists.","calendar_form_blocking_tasks"),null;const s=(i?e.filter((e=>e.type!==t.type)):e).concat([Object.assign(Object.assign({__typename:"SchedulingFormTask"},t),{id:d})]);n.writeQuery({query:Jh,data:{schedulingFormBlockingTasks:s}})}catch(e){return null===(s=l.errorToTelemetry)||void 0===s||s.call(l,"addSchedulingFormBlockingTask: Failed to write scheduling form blocking task in cache.","calendar_form_blocking_tasks"),null}return Object.assign(Object.assign({},t),{id:d,__typename:"SchedulingFormTask"})},updateSchedulingFormBlockingTask(e,{input:{type:t,state:n}},{cache:i,loggerFactory:a}){var o,r,s,l;const d=a.newLogger("update-scheduling-form-blocking-task");try{let e=-1;const a=(null!==(r=null===(o=i.readQuery({query:Jh}))||void 0===o?void 0:o.schedulingFormBlockingTasks)&&void 0!==r?r:[]).map(((i,a)=>(null==i?void 0:i.type)===t?(e=a,Object.assign(Object.assign({},i),{state:n})):i));return-1===e?(null===(s=d.errorToTelemetry)||void 0===s||s.call(d,"updateSchedulingFormBlockingTask: Failed to update scheduling form blocking task in cache. Task does not exist.","calendar_form_blocking_tasks"),null):a[e]}catch(e){return null===(l=d.errorToTelemetry)||void 0===l||l.call(d,"updateSchedulingFormBlockingTask: Failed to update scheduling form blocking task in cache.","calendar_form_blocking_tasks"),null}},removeSchedulingFormBlockingTask(e,{input:{type:t}},{cache:n,loggerFactory:i}){var a,o,r;const s=i.newLogger("remove-scheduling-form-blocking-task");try{const e=null!==(o=null===(a=n.readQuery({query:Jh}))||void 0===a?void 0:a.schedulingFormBlockingTasks)&&void 0!==o?o:[],i=e.find((e=>e.type===t));if(!i)return null;const r=e.filter((e=>(null==e?void 0:e.type)!==t));return n.writeQuery({query:Jh,data:{schedulingFormBlockingTasks:r}}),i}catch(e){return null===(r=s.errorToTelemetry)||void 0===r||r.call(s,"removeSchedulingFormBlockingTask: Failed to remove scheduling form blocking task from cache.","calendar_form_blocking_tasks"),null}},setSchedulingFormActiveTab(e,{input:t},{cache:n,loggerFactory:i}){var a;const o=null===t?null:Object.assign(Object.assign({},t),{__typename:"SchedulingFormTab"});try{return n.writeQuery({query:Kh,data:{schedulingFormActiveTab:o}}),o}catch(e){const t=i.newLogger("scheduling-form-active-tab");return null===(a=t.errorToTelemetry)||void 0===a||a.call(t,"setSchedulingFormActiveTab: Failed to set scheduling form active tab in cache.","calendar_form_active_tab"),null}},setSchedulingFormTerminatingAction(e,{input:{type:t}},{cache:n,loggerFactory:i}){var a;const o=i.newLogger("set-scheduling-form-terminating-action");try{n.writeQuery({query:Qh,data:{schedulingFormTerminatingAction:t}})}catch(e){return null===(a=o.errorToTelemetry)||void 0===a||a.call(o,"setSchedulingFormTerminatingAction: Failed to update scheduling form terminating task in cache.","calendar_form_terminating_action"),!1}return!0}}};var Xh=n(63190);var Zh=n(22596);const ev={Mutation:{addFileUpload(e,{fileToAdd:t},{cache:n}){const{fileContainerId:i}=t,a=(({uploadId:e,fileName:t,serviceName:n,context:i})=>({title:t,status:Rt.FileUploadStatus.PROGRESS,id:e,itemId:null,type:(0,Xh.mD)(t),objectUrl:"",baseUrl:"",progress:1,fileId:"",isReferencedFile:!1,shareUrl:"",shareId:"",previewUrl:"",chicletBreadcrumbs:null,context:null!=i?i:null,permissionScope:null,previewHeight:null,previewWidth:null,progressComplete:null,state:Rt.FileChicletState.active,hasUploadFailed:!1,serviceName:n,externalFileShareInfo:"",__typename:"FileUpload"}))(t);return(0,Zh.zz)([a],n,i),!0},removeFileUpload(e,{input:t},{cache:n}){const{uploadId:i,fileContainerId:a}=t;return(0,Zh.Fj)(i,a,n),!0}}},tv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"taskModuleResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"taskModuleResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"card"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}}]}},{kind:"Field",name:{kind:"Name",value:"adaptiveCardTabResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}}]}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"taskModuleId"}},{kind:"Field",name:{kind:"Name",value:"draftId"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"reason"}},{kind:"Field",name:{kind:"Name",value:"entryPoint"}}]}}]}}]},nv=e=>{if(e){const{appIcon:t,appId:n,appName:i,contentType:a,content:o,locale:r}=e;return{__typename:"PlatformCard",appIcon:t||null,appId:n||null,appName:i||null,content:o,contentType:a,locale:r||null}}return null},iv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appDetailsResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDetailsResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appInstallId"}},{kind:"Field",name:{kind:"Name",value:"isAppInstalled"}},{kind:"Field",name:{kind:"Name",value:"errorCode"}}]}}]}}]},av={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformInContextStoreLaunchInstalledAppResultQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"inContextStoreLaunchInstalledAppResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"capability"}},{kind:"Field",name:{kind:"Name",value:"appDisplayName"}},{kind:"Field",name:{kind:"Name",value:"draftId"}}]}}]}}]},ov={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mapCoordinateResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mapCoordinateResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"latitude"}},{kind:"Field",name:{kind:"Name",value:"longitude"}},{kind:"Field",name:{kind:"Name",value:"locationApiError"}}]}}]}}]},rv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"selectPeoplePickerResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectPeoplePickerResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"email"}}]}}]}}]},sv={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"platformAppsFetchPolicyFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PlatformAppsFetchPolicy"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"forceNetworkFetch"}},{kind:"Field",name:{kind:"Name",value:"scope"}},{kind:"Field",name:{kind:"Name",value:"convId"}}]}}]},lv="PlatformAppsFetchPolicy",dv="PlatformAppsFetchPolicyMetadata",cv=Ah.Ps`
  fragment PlatformAppsFetchPolicyMetadata_FetchPolicyIds on PlatformAppsFetchPolicyMetadata {
    fetchPolicyIds
  }
`,uv=Ah.Ps`
  fragment PlatformAppsFetchPolicy_ForceNetwork on PlatformAppsFetchPolicy {
    forceNetworkFetch
  }
`,mv=(e,t)=>{let n=`${lv}:${e}`;return t&&(n=`${n}:${t}`),n},gv=(e,t,n,i)=>{let a=!0;try{const a=mv(t.scope,t.convId);e.writeFragment({id:a,fragment:sv,data:t});const{enableContextlessFetchPolicyUpdates:o}=n.get(A.J.Extensibility);o&&vv(e,a,i)}catch(e){a=!1}return a},pv=(e,t,n)=>{let i=`${e}`;return t&&(i=`${i}:${t}`),{__typename:lv,id:i,scope:e,forceNetworkFetch:n,convId:null!=t?t:null}},hv=e=>{var t;try{const n=e.readFragment({id:dv,fragment:cv});return null!==(t=null==n?void 0:n.fetchPolicyIds)&&void 0!==t?t:[]}catch(e){throw e}},vv=(e,t,n)=>{var i;const a=n.newLogger("updateFetchPolicyIds");try{let n=hv(e);if(n.includes(t))return;n=n.concat(t),e.writeFragment({id:dv,fragment:cv,data:{__typename:dv,fetchPolicyIds:n}})}catch(e){null===(i=a.errorToTelemetry)||void 0===i||i.call(a,`updateFetchPolicyIds: failed to update fetch policy ids when adding ${t}`,"platform_apps_fetch_policy_update_ids_resolver")}},Sv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"selectMediaResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectMediaResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectMediaError"}},{kind:"Field",name:{kind:"Name",value:"mediaUrls"}}]}}]}}]},fv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"viewImagesResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"viewImagesResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"viewImagesError"}},{kind:"Field",name:{kind:"Name",value:"errorCode"}}]}}]}}]},yv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageExtensionsAppsState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageExtensionsAppsState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toggleRefetch"}}]}}]}}]},kv={__typename:"MessageExtensionsAppsState",toggleRefetch:!1},Cv=(e,t)=>{try{const n=e.readQuery({query:yv,variables:{convId:t}});if(!n)throw new Error("Unable to read ME apps state from cache");return n}catch(e){throw e}},bv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"tabConfigurationResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"threadId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tabConfigurationResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"threadId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"tabId"}}]}}]}}]},Tv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageToParentResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageToParentResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]},wv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageToChildResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageToChildResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]},_v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformChangeSettingsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeSettingsResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"tabId"}}]}}]}}]},Iv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformChangeSettingsTriggerQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeSettingsTriggerResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"tabId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]},Av={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformAppButtonQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appButtonResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"action"}}]}}]}}]},Nv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"customAppUploadResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"customAppUploadResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"customAppType"}}]}}]}}]},Ev={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"showLocationResponse"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showLocationResponse"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},Dv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"webhookConfirmationResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webhookConfirmationResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},Fv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformAppDevicePermissionsUpdatedQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDevicePermissionsUpdated"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"status"}}]}}]}}]},Pv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformCachedAppListQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cachedAppList"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"lastUpdatedSourceWindow"}},{kind:"Field",name:{kind:"Name",value:"apps"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webContentsId"}},{kind:"Field",name:{kind:"Name",value:"processId"}},{kind:"Field",name:{kind:"Name",value:"isCachedAndHidden"}},{kind:"Field",name:{kind:"Name",value:"lastLoaded"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}}]}}]}}]}}]},Mv=(e,t,n,i,a)=>{if(!e)return!1;const{lastUpdatedSourceWindow:o}=e;try{const r=t.readQuery({query:Pv}),s=n({input:e,cacheData:r,coreSettings:a,logger:i});if((0,Z.isEqual)(s,null==r?void 0:r.cachedAppList.apps))null==i||i.warn("cache write skipped, data unchanged");else{null==i||i.log("cached app list updated, writing query");const e={cachedAppList:{__typename:"CachedAppList",id:"appcaching",apps:s,lastUpdatedSourceWindow:o}};t.writeQuery({query:Pv,data:e})}return!0}catch(e){return!1}},jv=e=>{const t={};return e.forEach((e=>t[e.processId]=e)),t},Rv=e=>{var t;const{cacheData:n,input:i,logger:a}=e;return(({apps:e},t,n)=>{const i=jv(t),a=e.filter((e=>!i[e.processId]));return a.length!==e.length&&(null==n||n.warn("duplicate apps found in mutation input")),t.concat(a.map((e=>{var t,n,i,a;return Object.assign(Object.assign({},e),{__typename:"CachedApp",webContentsId:null!==(t=e.webContentsId)&&void 0!==t?t:null,lastLoaded:null!==(n=e.lastLoaded)&&void 0!==n?n:null,appId:null!==(i=e.appId)&&void 0!==i?i:null,appName:null!==(a=e.appName)&&void 0!==a?a:null})})))})(i,null!==(t=null==n?void 0:n.cachedAppList.apps)&&void 0!==t?t:[],a)},xv=e=>{var t;const{cacheData:n,input:{apps:i},logger:a}=e,o=jv(i);let r=[];return(null==n?void 0:n.cachedAppList.apps)&&(r=null==n?void 0:n.cachedAppList.apps.filter((e=>!o[e.processId])),r.length===(null==n?void 0:n.cachedAppList.apps.length)&&(null===(t=null==a?void 0:a.errorToTelemetry)||void 0===t||t.call(a,"app to remove is not in the cached app list","platform_app_caching_missing_cached_app_on_update",void 0,!0))),r},Ov=(e,t,n)=>{let i,a=-1;for(const n of e)(!i||n.lastLoaded&&n.lastLoaded<i)&&(a=t.indexOf(n),i=n.lastLoaded);const o=[...t];return-1!==a&&(o.splice(a,1),null==n||n.log("app removed from global cache due to exceeding shared cache size")),o},Lv=e=>{const{cacheData:t,input:{apps:n},coreSettings:i,logger:a}=e,o=null==i?void 0:i.get(A.J.Extensibility),r=null==o?void 0:o.appCachingMaxSizeNS;let s=[];if(null==t?void 0:t.cachedAppList.apps){const e=jv(null==t?void 0:t.cachedAppList.apps);s=n.map((t=>{var n,i,o,r;let s;const l=e[t.processId];l?s=l:(s=t,null==a||a.log("adding app to cache that was not found during update."));const d=null!==(n=s.webContentsId)&&void 0!==n?n:null,c=null!==(i=t.lastLoaded)&&void 0!==i?i:null,u=t.isCachedAndHidden,m=null!==(o=s.appId)&&void 0!==o?o:null,g=null!==(r=s.appName)&&void 0!==r?r:null;return Object.assign(Object.assign({},s),{__typename:"CachedApp",webContentsId:d,lastLoaded:c,appId:m,isCachedAndHidden:u,appName:g})}));const i=jv(s);s=s.concat(t.cachedAppList.apps.filter((e=>!i[e.processId])))}return r?((e,t,n)=>{const i=e.filter((e=>e.isCachedAndHidden));return!i.length||i.length<=t?e:Ov(i,e,n)})(s,r,a):s},Uv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformLocalFrameContextQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"localFrameContext"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"tabId"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}}]}}]}}]},Bv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformAppsBadgeReadQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appsBadgeRead"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},Wv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformBackButtonHandlerStateQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"backButtonHandlerState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"registered"}}]}}]}}]},Gv={Query:{platformAppsBatchFetchPolicy:(e,{options:t},{cache:n})=>t.map((({scope:e,convId:t})=>((e,{scope:t,convId:n})=>{let i;try{const a=mv(t,n),o=e.readFragment({id:a,fragment:sv});i=null==o?void 0:o.forceNetworkFetch}catch(e){i=!1}return pv(t,n,null!=i&&i)})(n,{scope:e,convId:t}))),messageExtensionsAppsState:()=>kv},Mutation:{toggleAppsRefetch:(e,{convId:t},{cache:n})=>{try{const e=Cv(n,t),{messageExtensionsAppsState:i}=e,a=!i.toggleRefetch,o={messageExtensionsAppsState:Object.assign(Object.assign({},i),{toggleRefetch:a})};n.writeQuery({query:yv,variables:{convId:t},data:o});return Cv(n,t).messageExtensionsAppsState.toggleRefetch}catch(e){throw e}},updateTaskModuleResult:(e,{text:t,taskModuleId:n,draftId:i,card:a,conversationId:o,adaptiveCardTabResult:r,reason:s,entryPoint:l},{cache:d})=>{var c;try{const e={taskModuleResult:{__typename:"TaskModuleResult",text:null!=t?t:null,card:nv(a),adaptiveCardTabResult:null!==(c=r&&r.map((e=>nv(e))))&&void 0!==c?c:null,taskModuleId:n,draftId:null!=i?i:null,conversationId:null!=o?o:null,reason:s,entryPoint:l}};return d.writeQuery({query:tv,data:e}),!0}catch(e){return!1}},resetTaskModuleResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:tv,data:{taskModuleResult:null}}),!0}catch(e){return!1}},updateAppDetailsResult:(e,{input:t},{cache:n})=>{try{if(!t)throw new Error("No appInstallDetails input received");const{appId:e,appInstallId:i,isAppInstalled:a,errorCode:o}=t,r={appDetailsResult:{__typename:"AppDetailsResult",appInstallId:i,appId:e,isAppInstalled:a,errorCode:o||null}};return n.writeQuery({query:iv,data:r}),!0}catch(e){return!1}},updateInContextStoreLaunchInstalledAppResult:(e,{input:t},{cache:n})=>{try{let e;if(t){const{id:n,appId:i,capability:a,appDisplayName:o=null,draftId:r=null}=t;e={inContextStoreLaunchInstalledAppResult:{__typename:"InContextStoreLaunchInstalledAppResult",id:n,appId:i,capability:a,appDisplayName:o,draftId:r}}}else e={inContextStoreLaunchInstalledAppResult:null};return n.writeQuery({query:av,data:e}),!0}catch(e){return!1}},setPlatformAppsFetchPolicy:(e,{input:t},{cache:n,loggerFactory:i,coreSettings:a})=>((e,t,n,i)=>{var a;let o=!0;for(const r of t){let t=!0;const s={__typename:lv,forceNetworkFetch:r.fetchSource===Rt.PlatformAppsFetchSource.Network,scope:r.scope,convId:null!==(a=r.convId)&&void 0!==a?a:null};t=gv(e,s,n,i),o=o&&t}return o})(n,t,a,i),updateAllPlatformAppsFetchPolicies:(e,{fetchSource:t},{cache:n,loggerFactory:i,scenarioFactory:a})=>{var o;let r=!0;const s=i.newLogger("updateAllPlatformAppsFetchPolicies"),l=a.newScenario(ee.RG.UpdateAllPlatformAppsFetchPolicies),d=hv(n),c=d.length;l.appendEventData({appCount:c});for(const e of d)try{n.writeFragment({id:e,fragment:uv,data:{__typename:lv,forceNetworkFetch:t===Rt.PlatformAppsFetchSource.Network}})}catch(n){r=!1,null===(o=s.errorToTelemetry)||void 0===o||o.call(s,`updateAllPlatformAppsFetchPolicies: failed to update fetch policy for ${e} to ${t}`,"platform_apps_fetch_policy_update_all_resolver")}return r?(l.stop(),!0):(l.fail(),!1)},updateTabConfigurationResult:(e,{id:t,tabId:n},{cache:i})=>{try{const e={tabConfigurationResult:{__typename:"tabConfigurationResult",id:t,tabId:n}};return i.writeQuery({query:bv,variables:{threadId:t},data:e}),!0}catch(e){return!1}},updateMessageToParentResult:(e,{appId:t,message:n},{cache:i})=>{try{const e={messageToParentResult:{__typename:"messageToParentResult",appId:t,message:n}};return i.writeQuery({query:Tv,variables:{appId:t},data:e}),!0}catch(e){return!1}},updateMessageToChildResult:(e,{appId:t,message:n},{cache:i})=>{try{const e={messageToChildResult:{__typename:"messageToChildResult",appId:t,message:n}};return i.writeQuery({query:wv,variables:{appId:t},data:e}),!0}catch(e){return!1}},updateAppButtonSettings:(e,{appId:t,action:n},{cache:i})=>{if(!t)throw new Error("Incorrect input received; id is required");try{const e={appButtonResult:{__typename:"AppButtonResult",appId:t,action:n}};return i.writeQuery({query:Av,variables:{appId:t},data:e}),!0}catch(e){return!1}},updateChangeSettings:(e,{id:t,status:n,appId:i,tabId:a},{cache:o})=>{if(!t)throw new Error("Incorrect input received; id is required");try{const e={changeSettingsResult:{__typename:"ChangeSettingsResult",id:t,status:n,appId:null!=i?i:null,tabId:null!=a?a:null}};return o.writeQuery({query:_v,variables:{id:t},data:e}),!0}catch(e){return!1}},triggerChangeSettings:(e,{id:t,message:n,appId:i,tabId:a},{cache:o})=>{if(!t)throw new Error("Incorrect input received; id is required");try{const e={changeSettingsTriggerResult:{__typename:"ChangeSettingsTriggerResult",id:t,message:n,appId:null!=i?i:null,tabId:null!=a?a:null}};return o.writeQuery({query:Iv,variables:{id:t},data:e}),!0}catch(e){return!1}},updateSelectMediaResult:(e,{input:t},{cache:n})=>{var i;try{const{selectMediaError:e,mediaUrls:a}=t,o={selectMediaResult:{__typename:"SelectMediaResult",selectMediaError:null!=e?e:null,mediaUrls:null!==(i=a)&&void 0!==i?i:null}};return n.writeQuery({query:Sv,data:o}),!0}catch(e){return!1}},resetSelectMediaResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:Sv,data:{selectMediaResult:null}}),!0}catch(e){return!1}},updateViewImagesResult:(e,{input:t},{cache:n})=>{try{const{viewImagesError:e,errorCode:i}=t,a={viewImagesResult:{__typename:"ViewImagesResult",viewImagesError:null!=e?e:null,errorCode:null!=i?i:null}};return n.writeQuery({query:fv,data:a}),!0}catch(e){return!1}},resetViewImagesResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:fv,data:{viewImagesResult:null}}),!0}catch(e){return!1}},updateMapCoordinateResult:(e,{locationApiResult:t},{cache:n})=>{try{const{latitude:e,longitude:i,locationApiError:a}=t,o={mapCoordinateResult:{__typename:"MapCoordinateResult",latitude:null!=e?e:null,longitude:null!=i?i:null,locationApiError:null!=a?a:null}};return n.writeQuery({query:ov,data:o}),!0}catch(e){return!1}},resetMapCoordinateResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:ov,data:{mapCoordinateResult:null}}),!0}catch(e){return!1}},resetSelectPeoplePickerResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:rv,data:{selectPeoplePickerResult:[]}}),!0}catch(e){return!1}},updateSelectPeoplePickerResult:(e,{selectPeoplePickerResult:t},{cache:n})=>{try{const e={selectPeoplePickerResult:t.map((e=>({__typename:"SelectPeoplePickerResult",objectId:e.objectId,displayName:e.displayName||"",email:e.email||""})))};return n.writeQuery({query:rv,data:e}),!0}catch(e){return!1}},updateCustomAppUploadResult:(e,{input:t},{cache:n})=>{try{if(!t)throw new Error("No customAppUpload input received");const{customAppType:e}=t,i={customAppUploadResult:{__typename:"CustomAppUploadResult",customAppType:e}};return n.writeQuery({query:Nv,data:i}),!0}catch(e){return!1}},updateShowLocationResult:(e,{response:t},{cache:n})=>{try{const e={showLocationResponse:null!=t?t:null};return n.writeQuery({query:Ev,data:e}),!0}catch(e){return!1}},resetShowLocationResponse:(e,t,{cache:n})=>{try{return n.writeQuery({query:Ev,data:{showLocationResponse:null}}),!0}catch(e){return!1}},updateWebhookConfirmationResult:(e,{input:t},{cache:n})=>{try{if(!t)throw new Error("No webhookConfirmation input received");const e={webhookConfirmationResult:t};return n.writeQuery({query:Dv,data:e}),!0}catch(e){return!1}},setAppDevicePermissionsUpdated:(e,{input:t},{cache:n})=>{if(!t||!t.id||!t.status)throw new Error("Incorrect input received; id and status are required");try{const{id:e,status:i}=t,a={appDevicePermissionsUpdated:{__typename:"AppDevicePermissionsUpdated",id:e,status:i}};return n.writeQuery({query:Fv,data:a,variables:{input:e}}),a.appDevicePermissionsUpdated}catch(e){return null}},addSharedPlatformCachedApps:(e,{input:t},{cache:n,loggerFactory:i})=>Mv(t,n,Rv,null==i?void 0:i.newLogger("AppCaching resolver: addSharedPlatformCachedApps")),removeSharedPlatformCachedApps:(e,{input:t},{cache:n,loggerFactory:i})=>Mv(t,n,xv,null==i?void 0:i.newLogger("AppCaching resolver: removeSharedPlatformCachedApps")),updateSharedPlatformCachedApps:(e,{input:t},{cache:n,loggerFactory:i,coreSettings:a})=>Mv(t,n,Lv,null==i?void 0:i.newLogger("AppCaching resolver: updateSharedPlatformCachedApps"),a),setLocalFrameContext:(e,{localFrameContext:t},{cache:n})=>{var i,a,o,r,s;try{const e={localFrameContext:{__typename:"LocalFrameContext",id:t.id,threadId:null!==(i=t.threadId)&&void 0!==i?i:null,messageId:null!==(a=t.messageId)&&void 0!==a?a:null,tabId:null!==(o=t.tabId)&&void 0!==o?o:null,websiteUrl:null!==(r=t.websiteUrl)&&void 0!==r?r:null,contentUrl:null!==(s=t.contentUrl)&&void 0!==s?s:null}};return n.writeQuery({query:Uv,data:e}),e.localFrameContext}catch(e){return null}},resetLocalFrameContext:(e,t,{cache:n})=>{try{return n.writeQuery({query:Uv,data:{localFrameContext:null}}),null}catch(e){throw e}},setAppsBadgeRead:(e,{isRead:t},{cache:n})=>{try{return n.writeQuery({query:Bv,data:{appsBadgeRead:!!t}}),!0}catch(e){return!1}},setBackButtonHandlerState:(e,{backButtonHandlerState:t},{cache:n})=>{var i;try{const e={backButtonHandlerState:{__typename:"BackButtonHandlerState",id:t.id,registered:null!==(i=t.registered)&&void 0!==i&&i}};return n.writeQuery({query:Wv,data:e}),e.backButtonHandlerState}catch(e){return null}},resetBackButtonHandlerState:(e,t,{cache:n})=>{try{return n.writeQuery({query:Wv,data:{backButtonHandlerState:null}}),null}catch(e){throw e}}}};var Vv=n(96766),Hv=n(9255),$v=n(21537),zv=n(43691),qv=n(87155);const Jv="mainAppWindowActiveEntities";function Qv(){return{__typename:"ActiveEntities",subNavEntity:null,startEntity:null,headerEntity:null,mainEntity:{__typename:"Entity",action:Rt.EntityAction.view,entityState:{__typename:"EntityState",flushableByLinkedEntity:!0},id:_.ew,linkedEntity:null,type:Rt.EntityType.blank,options:null,windowOptions:null},endEntity:null,entityExtension:null}}function Kv(e,t){return!(!e||!t)&&(e.id===t.id&&e.type===t.type&&e.action===t.action)}function Yv(e,t){return!e&&!t||!(!e||!t)&&(e.id===t.id&&e.type===t.type&&e.action===t.action&&(null==e?void 0:e.entityState.flushableByLinkedEntity)===(null==t?void 0:t.entityState.flushableByLinkedEntity)&&(null==e?void 0:e.options)===(null==t?void 0:t.options)&&function(e,t){if(!e&&!t)return!0;if(e&&t)return e.action===t.action&&e.id===t.id&&e.type===t.type;return!1}(null==e?void 0:e.linkedEntity,null==t?void 0:t.linkedEntity))}function Xv(e,t,n){const i=new Map,a=new Map;for(const o of e){if(n&&!n(o))continue;const{mainEntity:e,endEntity:r}=o.activeEntities,s=o.userContextId;i.set(t(e,s),[o,e]);const{linkedEntity:l}=e;if(l&&a.set(t(l,s),[o,l]),r){i.set(t(r,s),[o,r]);const{linkedEntity:e}=r;e&&a.set(t(e,s),[o,e])}}return[i,a]}function Zv(e,t){return`${e.type}-${e.id}-${t}`}function eS(e){return!!e.activeEntities}function tS(e,t){if(!t)return{subNavEntity:null,headerEntity:null,startEntity:null,mainEntity:null,endEntity:null,entityExtension:null};const{__typename:n}=t,i=(0,c._T)(t,["__typename"]),a=Object.assign({},i);if(!e)return a;const{subNavEntity:o,headerEntity:r,startEntity:s,mainEntity:l,endEntity:d,entityExtension:u}=e,{subNavEntity:m,headerEntity:g,startEntity:p,mainEntity:h,endEntity:v,entityExtension:S}=t;return a.subNavEntity=Kv(o,m)?null:m,a.headerEntity=Kv(r,g)?null:g,a.startEntity=Kv(s,p)?null:p,a.mainEntity=Kv(l,h)?null:h,a.endEntity=Kv(d,v)?null:v,a.entityExtension=Kv(u,S)?null:S,a}function nS(e,t){const n=eS(e)?e.activeEntities:null,i=eS(t)?t.activeEntities:null;if(!n||!i)return!0;const{subNavEntity:a,headerEntity:o,startEntity:r,mainEntity:s,endEntity:l,entityExtension:d}=n,{subNavEntity:c,headerEntity:u,startEntity:m,mainEntity:g,endEntity:p,entityExtension:h}=i;return!(e.userContextId===t.userContextId&&e.extendedEntityContainerState.containerState===t.extendedEntityContainerState.containerState&&function(e,t){var n,i,a,o;if(e&&t)return(null===(n=e.blockedCommand)||void 0===n?void 0:n.stateTransition)===(null===(i=t.blockedCommand)||void 0===i?void 0:i.stateTransition)&&(null===(a=e.blockedCommand)||void 0===a?void 0:a.visibilityState)===(null===(o=t.blockedCommand)||void 0===o?void 0:o.visibilityState)&&Yv(e.blockedEntity,t.blockedEntity)&&e.blockedEntityOptions===t.blockedEntityOptions;if(!e&&!t)return!0;return!1}(e.blockingEntityExtension,t.blockingEntityExtension)&&Yv(a,c)&&Yv(o,u)&&Yv(r,m)&&Yv(s,g)&&Yv(l,p)&&Yv(d,h))}function iS(e,t,n,i){var a;const o=oS(eS(e)?e.activeEntities:null,eS(t)?t.activeEntities:null);return n!==Rt.EntityStateTransition.none||"search"===(null===(a=o.endEntity)||void 0===a?void 0:a.type)||"search"===i.type&&aS(o)}function aS(e){return!(e.subNavEntity||e.headerEntity||e.startEntity||e.mainEntity||e.endEntity||e.entityExtension)}function oS(e,t){if(!t)return{subNavEntity:(null==e?void 0:e.subNavEntity)||null,headerEntity:(null==e?void 0:e.headerEntity)||null,startEntity:(null==e?void 0:e.startEntity)||null,mainEntity:(null==e?void 0:e.mainEntity)||null,endEntity:(null==e?void 0:e.endEntity)||null,entityExtension:(null==e?void 0:e.entityExtension)||null};const n=Object.assign({},t);if(!e)return n;const{subNavEntity:i,headerEntity:a,startEntity:o,mainEntity:r,endEntity:s,entityExtension:l}=e,{subNavEntity:d,headerEntity:c,startEntity:u,mainEntity:m,endEntity:g,entityExtension:p}=t;return n.subNavEntity=Kv(i,d)?null:null!=d?d:i,n.headerEntity=Kv(a,c)?null:null!=c?c:a,n.startEntity=Kv(o,u)?null:null!=u?u:o,n.mainEntity=Kv(r,m)?null:null!=m?m:r,n.endEntity=Kv(s,g)?null:null!=g?g:s,n.entityExtension=Kv(l,p)?null:null!=p?p:l,n}function rS(e){return!!(e.mainEntity||e.endEntity||e.entityExtension)}function sS(){return{__typename:"ExtendedEntityContainerState",containerState:Rt.ExtendedContainerState.Closed,isExternal:!1}}const lS=()=>({id:(0,Je.v4)(),startTimestamp:Date.now().toString(),source:I.D.Unknown});function dS(e){if(!e)return null;const{action:t=null,entityState:n={flushableByLinkedEntity:!0},id:i,linkedEntity:a=null,options:o=null,type:r,windowOptions:s=null}=Object.assign({},e);return{action:null!=t?t:Rt.EntityAction.view,entityState:{flushableByLinkedEntity:n.flushableByLinkedEntity,__typename:"EntityState"},id:i||null,linkedEntity:a&&uS(a)||null,options:o,type:r,windowOptions:s?Object.assign(Object.assign({},s),{__typename:"WindowOptions"}):null,__typename:"Entity"}}function cS(e,t,n){return{id:e.id||null,type:e.type,action:e.action,options:t||null,windowOptions:n?Object.assign(Object.assign({},n),{__typename:"WindowOptions"}):null,linkedEntity:e.linkedEntity&&uS(e.linkedEntity)||null,entityState:{flushableByLinkedEntity:!0,__typename:"EntityState"},__typename:"Entity"}}function uS(e){return{action:e.action||null,id:e.id,type:e.type,__typename:"LinkedEntity"}}const mS=e=>e?Object.assign(Object.assign({},e),{options:null}):null,gS=e=>Object.assign(Object.assign({},e),{subNavEntity:mS(e.subNavEntity),headerEntity:mS(e.headerEntity),startEntity:mS(e.startEntity),mainEntity:mS(e.mainEntity),endEntity:mS(e.endEntity)}),pS=e=>e?(0,qe.b)(e):null,hS=(e,t,n)=>{var i;const a=t&&(null===(i=e.getApp({entityType:t.type}))||void 0===i?void 0:i.manifest.id);a&&n.add(a)};function vS({appsRegistryService:e,currentWindowId:t,newReactiveValues:n}){n&&(e.resetAllViewState(t),Object.keys(n).forEach((i=>{e.setReactiveValuesForApp(t,i,n[i])})))}function SS(e,t,n,i,a,o){if(rS(e)){const r=!!kS(e,t),s=!!CS(e,wS),l=!!CS(e,IS),d=!!CS(e,NS),c=!!CS(e,ES),u=!!CS(e,DS),m=!!CS(e,FS),g=!!CS(e,PS),p=!!CS(e,US),h=!!CS(e,BS),v=!!CS(e,MS),S=!!CS(e,HS),f=!!CS(e,XS),y=!!CS(e,zS),k=!!CS(e,qS),C=!!CS(e,JS),b=function(e,t,n){const{enableNewConsumerTasksChatTabNavigation:i}=t.get(A.J.Chat);return!i&&!!CS(e,(e=>AS(e,n)))}(e,a,o),T=function(e,t){const{enableAliasVisibilitySettingsCommand:n}=t.get(A.J.People);return!n&&!!CS(e,_S)}(e,a),w=function(e,t,n){const{enableReactTaskModuleForBIM:i,launchAngularDialog:a,enableReactWorkflowsInBIM:o,enableReactTaskModuleForHWC:r,enableModernPurchaseFlow:s}=t.get(A.J.Extensibility);return function(e,t,n){return t===_.ew&&!n&&!!CS(e,WS)}(e,n,i)||function(e,t,n){return t===_.ew&&!n&&!!CS(e,GS)}(e,n,r)||function(e,t){return!!t&&!!CS(e,$S)}(e,a)||function(e,t){return!(t||!CS(e,KS)&&!CS(e,YS))}(e,o)||function(e){return!!CS(e,VS)}(e)||function(e,t){return!t&&!!CS(e,QS)}(e,s)}(e,a,t),I=function(e,t){const{enableBrb:n}=t.get(A.J.Brb);return!n&&!!CS(e,LS)}(e,a),N=function(e,t){const{enableHybridChannelList:n,msgEnableChannelsV2:i}=t.get(A.J.Host);return!(i||n||!CS(e,jS))}(e,a),E=function(e,t){const{isCalendarSurfaceHybridArchitectureEnabled:n}=t.get(A.J.Host),i=!!CS(e,OS);if(i&&n)return!1;return i}(e,a),D=function(e,t){const{isSchedulingFormHybridArchitecureEnabled:n}=t.get(A.J.Host),{enableMultiWindowCalendarSchedulingForm:i}=t.get(A.J.Calendar),a=!!CS(e,RS);if(i&&a)return!1;return a&&!n}(e,a),F=function(e,t,n,i,a){const{isSchedulingFormHybridArchitecureEnabled:o}=a.get(A.J.Host),{enableMultiWindowCalendarSchedulingFormViewAndEdit:r}=a.get(A.J.Calendar),s=!!CS(e,xS);if(s&&i)return!1;if(o&&s)return!1;if(r&&s)return!(t!==_.ew||!n);return s}(e,t,n,i,a),P=function(e,t,n,i){const{isChatHybridArchitectureEnabled:a}=t.get(A.J.Host),o=CS(e,TS);let r=!!o;o&&(i.log(`Checking if opener should handle chat ${o.id}: isChatHybridArchitectureEnabled\n      ${a}, and isNotNewNorNoneOnMainContext ${n}`),r=!1===a&&n,i.log(`Opener should handle chat ${o.id} ${r}`));return r}(e,a,n,o);return r||s||l||d||c||u||m||g||p||h||v||S||f||y||k||C||b||T||w||I||N||E||D||F||P}return!1}function fS(e,t,n,i,a){let o=!1,r=null;return r=kS(t,i)||function(e,t){let n=null;return yS.forEach((t=>{const i=CS(e,t);i&&(n=i)})),n||CS(e,(e=>AS(e,t)))}(t,a),r&&(n.report({correlationId:e.id,type:Qe.B.NotHandled,context:{target:"openerHandleEntityChange"}}),o=!0),o}const yS=[FS,wS,IS,NS,ES,DS,PS,$S,jS,OS,function(e){return!(!e||e.type!==Rt.EntityType.schedulingform)},zS,qS,LS,US,BS,WS,TS,MS,HS,XS,JS,QS,KS,YS,_S,VS];function kS(e,t){return t===_.ew?CS(e,bS):null}function CS(e,t){const{mainEntity:n,endEntity:i,entityExtension:a}=e;let o=null;return n&&t(n)&&(o=n),i&&t(i)&&(o=i),a&&t(a)&&(o=a),o}function bS(e){if(!e)return!1;switch(e.type){case Rt.EntityType.channels:return[Rt.EntityAction.leave,Rt.EntityAction.share].indexOf(e.action)>=0;case Rt.EntityType.channelroster:return e.action===Rt.EntityAction.manage;case Rt.EntityType.eduteamcreate:return e.action===Rt.EntityAction.view;case Rt.EntityType.teams:return e.action===Rt.EntityAction.delete;case Rt.EntityType.channelnotificationsettings:case Rt.EntityType.crosspostchannelselectiondialog:return e.action===Rt.EntityAction.view}return[Rt.EntityType.addchannel,Rt.EntityType.addmember,Rt.EntityType.addmembernewteam,Rt.EntityType.broadcastliveevent,Rt.EntityType.channelconnectors,Rt.EntityType.channeldeeplink,Rt.EntityType.channeldelete,Rt.EntityType.channeledit,Rt.EntityType.channelemail,Rt.EntityType.channelmoderators,Rt.EntityType.restorechannel,Rt.EntityType.teamarchive,Rt.EntityType.teamcreate,Rt.EntityType.teamdeeplink,Rt.EntityType.teamedit,Rt.EntityType.teamjoincode,Rt.EntityType.teamleave,Rt.EntityType.teampicture,Rt.EntityType.teamrenewal,Rt.EntityType.teamrestore,Rt.EntityType.sharedchannelacceptinvitation,Rt.EntityType.sharedchanneldeclineinvitation,Rt.EntityType.showformemberdialog].indexOf(e.type)>=0}function TS(e){return e&&e.type===Rt.EntityType.chats}function wS(e){const t=!(!e||e.type!==Rt.EntityType.extensions||e.id!==Ae.oz.organization);if(t&&!(null==e?void 0:e.linkedEntity))throw(0,he.Tr)(_.w5.Commanding,_.jK.Undefined,"CommandChangeNotification",void 0,"Org chart entity defined without a linked entity. Cannot notify host of route change.");return t}function _S(e){return e.type===Rt.EntityType.settingsstore&&e.id===Ae.oz.privacyManageVisibility}function IS(e){const t=!(!e||e.type!==Rt.EntityType.extensions||e.id!==Rt.EntityType.linkedin);if(t&&!(null==e?void 0:e.linkedEntity))throw(0,he.Tr)(_.w5.Commanding,_.jK.Undefined,"CommandChangeNotification",void 0,"LinkedIn entity defined without a linked entity. Cannot notify host of route change.");return t}function AS(e,t){var n;if(e&&e.type===Rt.EntityType.extensions&&e.action===Rt.EntityAction.view&&(null===(n=e.linkedEntity)||void 0===n?void 0:n.type)===Rt.EntityType.chats){let n;try{(null==e?void 0:e.id)&&(n=JSON.parse(e.id||"").appId)}catch(e){t.warn("isConsumerTasksChatTab, failed to parse appId")}return!("1ded03cb-ece5-4e7c-9f73-61c375528078"!==n)}return!1}function NS(e){return(null==e?void 0:e.type)===Rt.EntityType.transcripttab}function ES(e){return(null==e?void 0:e.type)===Rt.EntityType.meetingrecaptab}function DS(e){return!(!e||e.type!==Rt.EntityType.platformapps||e.action!==Rt.EntityAction.list)}function FS(e){const t=!(!e||e.type!==Rt.EntityType.platformStage||e.action!==Rt.EntityAction.view),n=!(!e||e.type!==Rt.EntityType.platformTabGallery);return t||n}function PS(e){return!(!e||e.type!==Rt.EntityType.platformapps||e.action!==Rt.EntityAction.manage)}function MS(e){return!(!e||(e.type!==Rt.EntityType.file||e.action!==Rt.EntityAction.view)&&e.type!==Rt.EntityType.fileopensettings)}function jS(e){return!(!e||e.type!==Rt.EntityType.channels||!e.id)}function RS(e){return!(!e||e.type!==Rt.EntityType.schedulingform||e.action!==Rt.EntityAction.create)}function xS(e){return!(!e||e.type!==Rt.EntityType.schedulingform||e.action!==Rt.EntityAction.view)}function OS(e){return!(!e||e.type!==Rt.EntityType.calendar)}function LS(e){return!(!e||e.type!==Rt.EntityType.brbfeedbackdialog)}function US(e){return!(!e||e.type!==Rt.EntityType.open3sfeedback)}function BS(e){return!(!e||e.type!==Rt.EntityType.livepersonacard)}function WS(e){return!(!e||e.type!==Rt.EntityType.taskmodule)}function GS(e){return!(!e||e.type!==Rt.EntityType.hwctaskmodule)}function VS(e){return!(!e||e.type!==Rt.EntityType.settingsdialog)}function HS(e){return!(!e||e.type!==Rt.EntityType.accounts)}function $S(e){return!(!e||e.type!==Rt.EntityType.platformapp||e.action!==Rt.EntityAction.info)}function zS(e){return!(!e||e.type!==Rt.EntityType.platformappdetails||e.action!==Rt.EntityAction.config&&e.action!==Rt.EntityAction.update)}function qS(e){return!(!e||e.type!==Rt.EntityType.incontextstore||e.action!==Rt.EntityAction.config&&e.action!==Rt.EntityAction.update)}function JS(e){return!(!e||e.type!==Rt.EntityType.platformapp||e.action!==Rt.EntityAction.view)}function QS(e){return!(!e||e.type!==Rt.EntityType.platformsubscriptionplans||e.action!==Rt.EntityAction.info)}function KS(e){return!(!e||e.type!==Rt.EntityType.workflows||e.action!==Rt.EntityAction.create)}function YS(e){return!(!e||e.type!==Rt.EntityType.workflows||e.action!==Rt.EntityAction.manage)}function XS(e){return!(!e||e.type!==Rt.EntityType.customapp||e.action!==Rt.EntityAction.create)}var ZS=n(41790);const ef=e=>{var t,n,i;return null!==(i=null!==(n=null!==(t=e.subNavEntity)&&void 0!==t?t:e.headerEntity)&&void 0!==n?n:e.startEntity)&&void 0!==i?i:e.mainEntity},tf=({entity:e,currentEntities:t,shouldUseNewEntity:n})=>{var i;return n?{appEntity:null!==(i=e.linkedEntity)&&void 0!==i?i:e,contextEntity:e.linkedEntity?e:null}:t?{appEntity:ef(t),contextEntity:e}:{appEntity:e,contextEntity:null}},nf=({appsRegistryService:e,clientPreferences:t,contextEntity:n,coreSettings:i,entity:a,layoutMode:o})=>{if(!a)throw new Error("entity used to match app is null");const r=e.getApp({entityType:a.type});if(r&&r.getAppViewEntities)return r.getAppViewEntities({contextEntity:n,coreSettings:i,entity:a,layoutMode:o,userPreferences:{infoPane:t.getPreferences("infoPane"),teamLayout:t.getPreferences("teamLayout")}})},af={[Rt.SupportedViewEntities.subNavEntity]:{children:[Rt.SupportedViewEntities.headerEntity,Rt.SupportedViewEntities.startEntity,Rt.SupportedViewEntities.mainEntity,Rt.SupportedViewEntities.endEntity]},[Rt.SupportedViewEntities.headerEntity]:{children:[Rt.SupportedViewEntities.startEntity,Rt.SupportedViewEntities.mainEntity,Rt.SupportedViewEntities.endEntity]},[Rt.SupportedViewEntities.startEntity]:{children:[Rt.SupportedViewEntities.mainEntity,Rt.SupportedViewEntities.endEntity]},[Rt.SupportedViewEntities.mainEntity]:{children:[Rt.SupportedViewEntities.endEntity]},[Rt.SupportedViewEntities.endEntity]:{children:null}};function of(e){return e&&e.viewEntityName?e.viewEntityName:Rt.SupportedViewEntities.subNavEntity}function rf({executionContext:e,viewEntityName:t}){return of(e)===t}function sf({executionContext:e,viewEntityName:t}){const n=of(e),{children:i}=af[n];return!(!i||!i.includes(t))}const lf=(e,t,n)=>{var i;const{coreSettings:a}=t,{enableHybridExperienceRendererLayout:o}=a.get(A.J.Host),{activeEntities:{subNavEntity:r,headerEntity:s,startEntity:l,mainEntity:d,endEntity:c},layoutConfig:{layoutMode:u}}=e,m=(null===(i=t.authenticationUser)||void 0===i?void 0:i.role)===Rt.AuthenticationUserRole.Anonymous,g=d.type===Rt.EntityType.identity,p=d.type===Rt.EntityType.tflfre,h=d.type===Rt.EntityType.callsmonitor,v=d.type===Rt.EntityType.error,S=d.type===Rt.EntityType.pearnotdefaultapp,f=d.type===Rt.EntityType.search||d.type===Rt.EntityType.tflfre,y="newchat"===d.id,k=df(e,t,m),C=u===Rt.LayoutModes.standard;return{subNavSlotConfig:cf(!!o&&C,r,Rt.SlotName.SUBNAV,Rt.SupportedViewEntities.subNavEntity,Rt.AppRenderMode.Rail,t,n),headerSlotConfig:cf(!y,s,Rt.SlotName.HEADER,Rt.SupportedViewEntities.headerEntity,Rt.AppRenderMode.HorizontalBar,t,n),startSlotConfig:cf(!!o,l,Rt.SlotName.START,Rt.SupportedViewEntities.startEntity,Rt.AppRenderMode.Rail,t,n),mainSlotConfig:cf(!0,d,Rt.SlotName.MAIN,Rt.SupportedViewEntities.mainEntity,Rt.AppRenderMode.Main,t,n),endSlotConfig:cf(!0,c,Rt.SlotName.END,Rt.SupportedViewEntities.endEntity,Rt.AppRenderMode.Rail,t,n),navSlotConfig:uf(!!o&&C&&!g&&!m&&!p&&!S,Rt.SlotName.NAV,Rt.SupportedViewEntities.mainEntity,Rt.AppRenderMode.VerticalBar,t,n),notificationsSlotConfig:uf(!(v||h),Rt.SlotName.NOTIFICATIONS,Rt.SupportedViewEntities.mainEntity,Rt.AppRenderMode.ThinHorizontalBar,t,n),titleBarSlotConfig:f?cf(k,d,Rt.SlotName.TITLE_BAR,Rt.SupportedViewEntities.mainEntity,Rt.AppRenderMode.TitleBar,t,n):uf(k,Rt.SlotName.TITLE_BAR,Rt.SupportedViewEntities.mainEntity,Rt.AppRenderMode.TitleBar,t,n),toastsSlotConfig:uf(!0,Rt.SlotName.TOASTS,Rt.SupportedViewEntities.mainEntity,Rt.AppRenderMode.PartialOverlay,t,n),configurationsSlotConfig:uf(!0,Rt.SlotName.CONFIGURATIONS,Rt.SupportedViewEntities.mainEntity,Rt.AppRenderMode.Configurations,t,n),contextualNotificationsSlotConfig:uf(!0,Rt.SlotName.CONTEXTUAL_NOTIFICATIONS,Rt.SupportedViewEntities.mainEntity,Rt.AppRenderMode.OverlayThinHorizontalBar,t,n),__typename:"SlotsConfig"}},df=(e,t,n)=>{const{activeEntities:{mainEntity:i},layoutConfig:{layoutMode:a,isFullscreen:o}}=e,{platformService:r,coreSettings:s}=t,{disableTitleBarForEntityType:l}=s.get(A.J.Core);let{enableTitleBar:d}=s.get(A.J.Core);const{enableHybridExperienceRendererLayout:c}=s.get(A.J.Host),u=(null==r?void 0:r.config.clientType)===Fo.Bh.Web;l&&(d=d&&!l.some((e=>e===i.type))),d=d&&!(e.isMainWindow&&!r.config.isInCypressFrame);d=!(!(c&&a===Rt.LayoutModes.standard)&&!d);return!(i.type===Rt.EntityType.attendeeview||n&&u||!d||o)},cf=(e,t,n,i,a,{appsRegistryService:o},r)=>{var s;const l=((null==t?void 0:t.type)===Rt.EntityType.search||(null==t?void 0:t.type)===Rt.EntityType.tflfre)&&n===Rt.SlotName.TITLE_BAR,d=t&&(null===(s=o.getApp({entityType:t.type===Rt.EntityType.framework||l?void 0:t.type,renderMode:a}))||void 0===s?void 0:s.manifest.id);return!d&&t&&t.type&&t.type!==Rt.EntityType.framework?r.error(`No app found for entityType:${t.type} and appRenderMode:${a} in slot ${n}`):e&&t&&d&&r.log(`SlotConfig -\nentityType:${t.type}\nentityAction:${t.action}\nslotName:${n},\nviewEntityName:${i},\nappRenderMdoe:${a},\nappId:${d}`),e&&t&&d?{entity:t,slotName:n,viewEntityName:i,appRenderMode:a,appId:d,__typename:"SlotConfig"}:null},uf=(e,t,n,i,a,o)=>cf(e,{action:Rt.EntityAction.view,id:null,linkedEntity:null,options:null,type:Rt.EntityType.framework,windowOptions:null,entityState:{flushableByLinkedEntity:!1,__typename:"EntityState"},__typename:"Entity"},t,n,i,a,o);function mf(e,t,n=e.windowHistory.length-1){if(!eS(e))return;const i=e.windowHistoryNavigationState,a=e.windowHistory;e.currentWindowHistoryIndex=n;const o=a.length>0&&a[a.length-1].activeEntities.mainEntity,r=e.activeEntities.mainEntity,s=!!o&&Kv(o,r);i.canNavigateBack=!(0===a.length||1===a.length&&s)&&n>0,i.canNavigateForward=n<e.windowHistory.length-1;let l=n;n!==e.windowHistory.length-1&&(l=n-1),i.backHistory=gf(0,l,e.windowHistory);const d=i.backHistory,c=e.activeEntities.mainEntity;d.length>0&&Kv(c,d[d.length-1].entity)&&(d.pop(),t.debug("windowHistoryNavigationState back history entry was popped.")),i.backHistory=d.reverse().slice(0,10),i.forwardHistory=gf(n+1,e.windowHistory.length-1,e.windowHistory).slice(0,10),t.debug(`Reset windowHistoryNavigationState. size: ${e.windowHistory.length}, windowHistoryIndex: ${n}`),t.debug(`Reset windowHistoryNavigationState. canNavigateBack: ${i.canNavigateBack}, canNavigateForward: ${e.windowHistoryNavigationState.canNavigateForward}, backHistory size: ${e.windowHistoryNavigationState.backHistory.length}, forwardHistory size: ${i.forwardHistory.length}`)}function gf(e,t,n){if(!n)return[];const i=[];for(let a=e;a<=t;a++)i.push({__typename:"WindowHistoryNavigationItem",windowHistoryIndex:a,entity:n[a].activeEntities.mainEntity});return i}const pf=(e,t,n)=>{const i=i=>!i||n(t.getApp({entityType:i.type}),{mainEntity:e.mainEntity,subNavEntity:e.subNavEntity});return i(e.mainEntity)&&i(e.subNavEntity)};function hf({appIdsForReactiveVarChange:e,context:t,isUserContextSwitch:n,logger:i,newActiveEntities:a,windowContentState:o}){const{appsRegistryService:r,windowProvider:s,clientPreferences:l,coreSettings:d}=t,{currentWindowHistoryIndex:c,windowId:u}=o;let{windowHistory:m}=o;const{enableHostHistoryNavigation:g}=d.get(A.J.Core);n&&(m=[]);const p=vf(a,r,l,d,o.layoutMode),h=((e,t)=>{const{subNavEntity:n,headerEntity:i,startEntity:a,mainEntity:o,endEntity:r}=t,s=new Set;return hS(e,n,s),hS(e,i,s),hS(e,a,s),hS(e,o,s),hS(e,r,s),s})(r,p);if(e&&!e.some((e=>h.has(e))))return i.log(`Not storing rv change to history b/c rv changes made for app not being stored in history ${e} `),[m,!1];if(!((e,t,n)=>pf(e,t,((e,t)=>{var i,a;try{return!(null===(i=null==e?void 0:e.onBeforeAddToNavigation)||void 0===i?void 0:i.shouldAddEntitiesToWindowHistory)||e.onBeforeAddToNavigation.shouldAddEntitiesToWindowHistory(t)}catch(t){return null===(a=n.errorToTelemetry)||void 0===a||a.call(n,`App ${e.manifest.name} failed to execute entity command hook 'ShouldAddEntitiesToWindowHistory' with ""${t.name}"" error`,"entity_command_hook",{errors:`${t.name}`},!0),!0}})))(p,r,i))return i.log("Not saving to history b/c app shouldAddEntitiesToWindowHistory hook has returned false"),[m,!1];const v={};h.forEach((e=>{const{navigationalReactiveValues:t,nonNavigationalReactiveValues:n}=r.getAppViewStateForWindow(u,e)||{};(t||n)&&(v[e]=(e=>{if(!e)return;let t={};return t=Object.keys(e).reduce(((t,n)=>{const i=e[n];return Object.assign(Object.assign({},t),{[n]:i.read()})}),{}),t})(Object.assign(Object.assign({},t),n)))})),c<m.length-1&&(m=m.slice(0,c+1),i.debug(`Reset windowHistory navigation path after index ${c}.`));let S=m;const f=m[m.length-1];return(!f||e||rS(tS(a,f.activeEntities)))&&(S=[...m,{__typename:"WindowHistoryItem",activeEntities:p,reactiveVars:v}],g&&(s.history.pushState({windowHistoryIndex:S.length-1},""),i.debug(`Added browser history entry with windowHistoryIndex: ${S.length}.`))),[S,!0]}const vf=(e,t,n,i,a)=>{const o=t.getApp({entityType:ef(e).type});return o&&o.manifest.shouldDeferNavigationToMainSlotApp?Sf(e,t,n,i,a):e},Sf=(e,t,n,i,a)=>{const{appEntity:o,contextEntity:r}=tf({currentEntities:e,entity:e.mainEntity,shouldUseNewEntity:!0}),s=nf({appsRegistryService:t,clientPreferences:n,contextEntity:r,coreSettings:i,entity:o,layoutMode:a});return s&&s.mainEntity?{endEntity:dS(s.endEntity),headerEntity:dS(s.headerEntity),mainEntity:dS(s.mainEntity)||e.mainEntity,startEntity:dS(s.startEntity),subNavEntity:dS(s.subNavEntity),entityExtension:null,__typename:"ActiveEntities"}:e};function ff(e,t,n=!0){var i;try{const{activeWindows:t=[]}=e.readQuery({query:ZS.i8})||{};return n?(0,Z.cloneDeep)(t):t}catch(e){return null===(i=t.errorToTelemetry)||void 0===i||i.call(t,`activeWindowsQuery cache read failed - ${e.message}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0),t.debug("activeWindowsQuery entry not found in cache"),[]}}function yf(e,t,n,i,a){var o;const{cache:r,commandChangeReportingService:s}=e;if(n&&eS(n)){const t=((e,t)=>{const n=t.loggerFactory.newLogger("getCoreViewState");return{slotsConfig:lf(e,t,n),__typename:"CoreViewState"}})(n,e);n=Object.assign(Object.assign({},n),{coreViewState:t})}const l=a||(null==n?void 0:n.correlation.id)||(0,Je.v4)(),d=n?function(e,t,n,i){var a;let o;const r=t.slice(0);if(eS(e)){const t=r.findIndex((t=>t.id===e.id));o=e,-1===t?r.push(o):r[t]=o}else{const t=e.windowHistory.length;if(t>0&&!e.windowHistory[t-1].activeEntities)throw null===(a=n.errorToTelemetry)||void 0===a||a.call(n,"Unable to resolve active entities, trying to pop back to empty window","webclient_framework_foundation_core_services_entity_commanding"),(0,he.Tr)(_.w5.Commanding,_.jK.Undefined,"executeEntityCommand",e.correlation,"Unable to resolve to active entities");o=r.splice(r.findIndex((t=>t.id===e.id)),1)[0],n.log(`Window has no active entities so destroying for correlation ${i}`)}return r}(n,t,i,l):t;try{r.writeQuery({query:ZS.i8,data:{activeWindows:d}})}catch(e){return null===(o=i.errorToTelemetry)||void 0===o||o.call(i,`activeWindowsQuery cache write failed - ${e.message}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0),s.report({correlationId:l,type:Qe.B.Failure,context:{target:"executeEntityCommand",errorInfo:Ke.y.WindowCacheFailedToUpdate,errorMessage:e.message}}),!1}return n&&Cf(d,n,i,e),n&&kf(e,d,n,l),i.log(`After updating window cache, there are ${d.length} active windows`),!0}const kf=({appsRegistryService:e,experienceChangeReportingService:t},n,i,a)=>{if(eS(i)&&Tf(n,i.id)){const n=ef(i.activeEntities),o=e.getPlatformAppIdForEntity(n);t.report({correlationId:a,type:Tt.yU.AppSelectionChanged,context:{target:"entity-command-resolver",appId:o}})}},Cf=(e,t,n,{appsRegistryService:i,clientPreferences:a,coreSettings:o,localStorage:r})=>{var s,l,d,c;const{enableWriteActiveEntitiesToLocalStorage:u,enableWriteAppHistoryToLocalStorage:m}=o.get(A.J.Core);if(eS(t)&&Tf(e,t.id)&&(((e,t,n)=>pf(e,t,((e,t)=>{var i,a;try{return!(null===(i=null==e?void 0:e.onBeforeAddToNavigation)||void 0===i?void 0:i.shouldRestoreClientToEntities)||e.onBeforeAddToNavigation.shouldRestoreClientToEntities(t)}catch(t){return null===(a=n.errorToTelemetry)||void 0===a||a.call(n,`App ${e.manifest.name} failed to execute entity command hook 'ShouldRestoreClientToEntities' with ""${t.name}"" error`,"entity_command_hook",{errors:`${t.name}`},!0),!0}})))(t.activeEntities,i,n)&&u&&r.set(Jv,JSON.stringify({activeEntities:t.activeEntities,userContextId:t.userContextId}),or.f.Experience),m)){const{activeEntities:e}=t,n=ef(e),u=i.getApp({entityType:n.type});if(null===(l=null===(s=null==u?void 0:u.onBeforeAddToNavigation)||void 0===s?void 0:s.shouldStoreLastVisitedInAppHistory)||void 0===l?void 0:l.call(s,e.mainEntity)){const e=null==u?void 0:u.manifest.id;r.set(`appActiveEntitiesHistory-${e}`,JSON.stringify(gS(t.activeEntities)))}else if(null==u?void 0:u.manifest.shouldDeferNavigationToMainSlotApp){const n=i.getApp({entityType:e.mainEntity.type}),s=null==n?void 0:n.manifest;if(null===(c=null===(d=null==n?void 0:n.onBeforeAddToNavigation)||void 0===d?void 0:d.shouldStoreLastVisitedInAppHistory)||void 0===c?void 0:c.call(d,e.mainEntity)){const n=Sf(e,i,a,o,t.layoutConfig.layoutMode);r.set(`appActiveEntitiesHistory-${null==s?void 0:s.id}`,JSON.stringify(gS(n)))}}}},bf=(e,t)=>e.find((e=>e.layoutConfig.layoutMode===t&&e.isMainWindow)),Tf=(e,t)=>{const n=bf(e,Rt.LayoutModes.standard);return t===_.ew||t===(null==n?void 0:n.id)};function wf(e,t){const n=e.get(t);return n&&n[0]}function _f(e,t){return e.find((e=>e.id===t))}function If(e,t,n,i,a){let o=wf(t,Zv(e,i));const{linkedEntity:r}=e;let s=!1;!o&&r&&(o=wf(t,Zv(r,i)),s=!!o),!o&&e.id&&(o=wf(n,Zv({id:e.id,type:e.type},i)),s=!!o);const{enableLinkedEntityMatching:l}=a.get(A.J.Core);return l&&!o&&r&&(o=wf(n,Zv(r,i)),s=!!o),[o,s]}function Af({pubsub:e,fromWindowId:t,isFromWindowMain:n,sourceWindowId:i,diff:a,targetWindow:o,targetVisibilityState:r,stateTransition:s,correlation:l,logger:d}){!function(e,t,n,i,a,o,r){eS(o)&&o.id!==_.ew&&Nf(t,a)&&(n.log(`Focusing window ${r} for correlation ${e.id}`),i.publish(`windowStateEvent-${r}`,{windowStateEvent:{isFocused:!0,correlation:e}}))}(l,a,d,e,r,o,i),function(e,t,n,i,a,o,r,s,l){!Nf(t,s)||i||l.id===n||r!==Rt.EntityStateTransition.flush&&r!==Rt.EntityStateTransition.forceFlush||(a.log(`Closing ${n} for correlation ${e.id}`),o.publish(`windowStateEvent-${n}`,{windowStateEvent:{correlation:e,shouldClose:!0}}))}(l,a,t,n,d,e,s,r,o)}function Nf(e,t){return t===Rt.EntityVisibilityState.show||t===Rt.EntityVisibilityState.toggle&&rS(e)}const Ef=(e,t,n,i,a)=>{e.activeEntities=e.windowHistory[t].activeEntities;const o=e.windowHistory[t].reactiveVars;return vS({appsRegistryService:a.appsRegistryService,currentWindowId:e.id,newReactiveValues:o}),mf(e,n,t),yf(a,i,e,n)};function Df(e){if(!e)return"{}";const{id:t,type:n,action:i,linkedEntity:a,entityState:o}=Object.assign({},e);return`{\n    id: ${t}, \n    type: ${n}, \n    action: ${i}, \n    linkedEntity: { \n      id: ${a&&a.id}, \n      type: ${a&&a.type}}, \n    entityState: {\n      flushableByLinkedEntity: ${null==o?void 0:o.flushableByLinkedEntity}\n    }\n  }`}function Ff(e){return e?`{\n    id: ${e.id}\n    startTimestamp: ${e.startTimestamp},\n    source: ${e.source}\n  }`:"{}"}function Pf(e,t){const{id:n,correlation:i,isMainWindow:a,layoutConfig:{layoutMode:o}}=e;t.log(`{\n    id: ${n},\n    correlation: ${Ff(i)},\n    isMainWindow: ${a},\n    layoutMode: ${o} \n  }`),eS(e)?(t.log("activeEntities for window:"),function(e,t){const{subNavEntity:n,headerEntity:i,startEntity:a,mainEntity:o,endEntity:r,entityExtension:s}=e;n&&t.log(`subNavEntity: ${Df(n)}`),i&&t.log(`headerEntity: ${Df(i)}`),a&&t.log(`startEntity: ${Df(a)}`),t.log(`mainEntity: ${Df(o)}`),r&&t.log(`endEntity: ${Df(r)}`),s&&t.log(`entityExtension: ${Df(s)}`)}(e.activeEntities,t)):t.log("activeEntities: undefined")}function Mf(e,t){if(void 0===e)return t.log("undefined - app not ported to multi slot");if(null===e)return t.log("null - no app supports this entity");const{subNavEntity:n,headerEntity:i,startEntity:a,mainEntity:o,endEntity:r}=e;n&&t.log(`subNavEntity: ${Df(n)}`),i&&t.log(`headerEntity: ${Df(i)}`),a&&t.log(`startEntity: ${Df(a)}`),o&&t.log(`mainEntity: ${Df(o)}`),r&&t.log(`endEntity: ${Df(r)}`)}function jf(e,t,{entity:n,stateTransition:i,logger:a,window:o,correlation:r,commandChangeReportingService:s,entityOptions:l}){var d,c;if(!o.blockingEntityExtension)throw(0,he.Tr)(_.w5.Commanding,_.jK.Undefined,"executeEntityCommand",o.correlation,"Unable to resolve blockingEntityExtension");const u={activeEntities:t,windowHistory:[...o.windowHistory],currentWindowHistoryIndex:o.windowHistory.length-1,layoutMode:o.layoutConfig.layoutMode,userContextId:o.userContextId,windowId:o.id};a.log("Blocking command transition due to blockingEntityExtension");const m=sS();u.activeEntities=Object.assign(Object.assign({},t),{entityExtension:o.blockingEntityExtension.entity});const g=Object.assign(Object.assign({},o.blockingEntityExtension),{blockedEntity:n,blockedEntityOptions:l||null,blockedCommand:{stateTransition:i,visibilityState:e,correlation:r,__typename:"EntityCommand"}});s.report({correlationId:r.id,type:Qe.B.CommandMetaDataAdded,context:{target:"blockTransitionAndShowExtension",transitionBlockedByExtension:!0}});const p=o.windowHistoryNavigationState,h=Object.assign(Object.assign({},p),{backHistory:[...null!==(d=p.backHistory)&&void 0!==d?d:[]],forwardHistory:[...null!==(c=p.forwardHistory)&&void 0!==c?c:[]]});return Object.assign(Object.assign(Object.assign({},o),u),{correlation:r,extendedEntityContainerState:m,blockingEntityExtension:g,windowHistoryNavigationState:h})}const Rf=(e,t,n)=>{const i=e.activeEntities.entityExtension;if(!i)return t.error(`Unable to create hide command for extension in the given window. The window does not have an active extension. Window ID: ${e.id}`),null;const a=lS();a.source=I.D.CoreResolvers;const o={correlation:a,stateTransition:Rt.EntityStateTransition.extend,visibilityState:Rt.EntityVisibilityState.hide};return n.report({type:Qe.B.CommandStart,correlationId:a.id,context:{target:"createAndRegisterHideExtensionCommand",entityCommand:{entity:i,command:Object.assign(Object.assign({},o),{correlation:Object.assign(Object.assign({},a),{startTimestamp:parseInt(a.startTimestamp,10)})})}}}),{entity:i,command:o}},xf=(e,t,n)=>{var i;if(eS(e)){const a=Rf(e,t,n),o=null===(i=null==a?void 0:a.command.correlation)||void 0===i?void 0:i.id;o&&(t.log(`Closing external dialog, sending hide command with new correlation ${o}`),n.report({type:Qe.B.NotHandled,correlationId:o,context:{target:"sendHideExternalExtensionCommand"}}))}},Of=(e,t,n,i,a)=>{const{commandChangeReportingService:o}=a;e.extendedEntityContainerState.isExternal?(n.log(`Routing externally - closing external dialog for correlation ${i.id}`),xf(e,n,o)):(n.log(`Routing externally - closing BIM dialog from command with correlation ${i.id}`),((e,t,n,i,a)=>{eS(t)&&yf(a,n,Lf(t,i),e)})(n,e,t,i,a))};function Lf(e,t){const{activeEntities:n}=e;return Object.assign(Object.assign({},e),{correlation:t,extendedEntityContainerState:Object.assign(Object.assign({},e.extendedEntityContainerState),{containerState:Rt.ExtendedContainerState.Closed}),activeEntities:Object.assign(Object.assign({},n),{entityExtension:null})})}const Uf="webclient_framework_foundation_core_services_entity_commanding";function Bf(e,t,n,i,a){let o;const{windowHistory:r,activeEntities:s}=e;let l=r;const{appsRegistryService:d}=n,c=r.slice().reverse().find((e=>{return t=s,n=e.activeEntities,i=ef(t),a=ef(n),!(i.type===a.type&&i.action===a.action);var t,n,i,a}));if(c){o=c.activeEntities,vS({appsRegistryService:d,currentWindowId:e.id,newReactiveValues:c.reactiveVars});const i={activeEntities:s,windowHistory:r,currentWindowHistoryIndex:e.currentWindowHistoryIndex,layoutMode:e.layoutConfig.layoutMode,userContextId:e.userContextId,windowId:e.id};[l]=hf({context:n,isUserContextSwitch:!1,logger:a,newActiveEntities:o,windowContentState:i}),a.log(`Found app switch in window history ${t.id}`)}else if(a.log(`No app switch found in history ${t.id}`),e.id===_.ew){const r=d.getDefaultCommand(n.coreSettings);if(r){a.log(`Using default command for main window ${t.id}`);const o=lS();return o.source=I.D.CoreResolvers,a.log(`Sending new command with correlation ${o.id}`),sy({entity:r,command:{stateTransition:Rt.EntityStateTransition.forceFlush,visibilityState:Rt.EntityVisibilityState.show,correlation:o},windowId:e.id,clientLaunchId:e.correlation.clientLaunchId},n,i)||Object.assign(Object.assign({},e),{correlation:t,activeEntities:void 0})}o=Qv()}else a.log(`No app switch found in child window ${e.id}, so should close ${t.id}`);return Object.assign(Object.assign({},e),{correlation:t,activeEntities:o,windowHistory:l})}function Wf({appsRegistryService:e,commandChangeReportingService:t,correlation:n,entitiesMap:i,entity:a,logger:o,userContextId:r,window:s}){const{id:l}=n;return o.log(`Hiding main entity and popping history - ${Df(a)} and correlation ${l}`),t.report({correlationId:n.id,type:Qe.B.CommandMetaDataAdded,context:{target:"hideMainEntity",popWindowHistory:!0}}),function({window:e,entitiesMap:t,correlation:n,logger:i,userContextId:a,appsRegistryService:o}){let r;const{windowHistory:s,activeEntities:l}=e;let d=s[s.length-1];if(aS(oS(l,(null==d?void 0:d.activeEntities)||null))&&(s.pop(),d=s[s.length-1]),d){if(wf(t,Zv(d.activeEntities.mainEntity,a))||d.activeEntities.endEntity&&wf(t,Zv(d.activeEntities.endEntity,a)))return r=void 0,o.resetAllViewState(e.id),Object.assign(Object.assign({},e),{correlation:n,activeEntities:r});r=d.activeEntities,vS({appsRegistryService:o,currentWindowId:e.id,newReactiveValues:d.reactiveVars}),mf(e,i)}else e.id===_.ew&&(r=Qv(),o.resetAllViewState(e.id));return Object.assign(Object.assign({},e),{correlation:n,activeEntities:r})}({window:s,entitiesMap:i,correlation:n,logger:o,userContextId:r,appsRegistryService:e})}function Gf({activeEntities:e,correlation:t,entity:n,logger:i,window:a}){const o=a;return Kv(e.startEntity,n)?(i.log(`Hiding start entity - ${Df(n)} and correlation ${t.id}`),Object.assign(Object.assign({},o),{activeEntities:Object.assign(Object.assign({},e),{startEntity:null}),correlation:t})):Kv(e.endEntity,n)?(i.log(`Hiding end entity - ${Df(n)} and correlation ${t.id}`),Object.assign(Object.assign({},o),{activeEntities:Object.assign(Object.assign({},e),{endEntity:null}),correlation:t})):void 0}function Vf(e,t,n){var{commandChangeReportingService:i,correlation:a,enableMultiSlotHide:o,entitiesMap:r,entity:s,logger:l,stateTransition:d,window:u}=e,m=(0,c._T)(e,["commandChangeReportingService","correlation","enableMultiSlotHide","entitiesMap","entity","logger","stateTransition","window"]);if(eS(u)){const{activeEntities:e}=u;if(u.blockingEntityExtension&&d!==Rt.EntityStateTransition.extend)return jf(Rt.EntityVisibilityState.hide,e,Object.assign({commandChangeReportingService:i,correlation:a,enableMultiSlotHide:o,entitiesMap:r,entity:s,logger:l,stateTransition:d,window:u},m));if(d===Rt.EntityStateTransition.forceFlush&&function(e,t){return Kv(e,t.subNavEntity)||Kv(e,t.headerEntity)||Kv(e,t.mainEntity)}(s,e))return function({commandChangeReportingService:e,correlation:t,logger:n,window:i},a,o){const{id:r}=t;if(!eS(i))return i;n.log(`Closing app with correlation correlation ${r}`);const s=Bf(i,t,a,o,n),l=eS(s)?ef(s.activeEntities):void 0;return e.report({correlationId:t.id,type:Qe.B.CommandMetaDataAdded,context:{target:"closeApp",popWindowHistory:!1,entityDisplayedAfterHide:eS(s)?{mainEntity:s.activeEntities.mainEntity,contextEntity:l}:void 0}}),s}(Object.assign({commandChangeReportingService:i,correlation:a,enableMultiSlotHide:o,entitiesMap:r,entity:s,logger:l,stateTransition:d,window:u},m),t,n);if((!o||d===Rt.EntityStateTransition.flush)&&Kv(e.mainEntity,s))return i.report({correlationId:a.id,type:Qe.B.Hidden,context:{target:"handleHideCommandAction"}}),Wf(Object.assign({commandChangeReportingService:i,correlation:a,enableMultiSlotHide:o,entitiesMap:r,entity:s,logger:l,stateTransition:d,window:u},m));if(!o||d===Rt.EntityStateTransition.none){const t=Gf({entity:s,logger:l,window:u,correlation:a,activeEntities:e});if(t)return i.report({correlationId:a.id,type:Qe.B.Hidden,context:{target:"handleHideCommandAction"}}),t}if(Kv(e.entityExtension,s))return l.log(`Closing extended entity container with correlation ${a.id}`),Lf(u,a);i.report({correlationId:a.id,type:Qe.B.Incomplete,context:{target:"handleHideCommandAction"}}),l.warn(`Hide command issued for an entity but that entity is not present - ${Df(s)}`)}else l.warn(`Hide command issued for an entity but are no active entities - ${Df(s)}`);return u}function Hf({appViewEntities:e,commandChangeReportingService:t,coreSettings:n,correlation:i,enableMultiSlotNone:a,entity:o,executionContext:r,logger:s,userContextId:l,window:d}){var c;let u;const m={activeEntities:Qf(d),windowHistory:[...d.windowHistory],currentWindowHistoryIndex:d.currentWindowHistoryIndex,layoutMode:d.layoutConfig.layoutMode,userContextId:d.userContextId,windowId:d.id},{enableMTMACommanding:g}=n.get(A.J.Core);if(g&&l!==d.userContextId)throw null===(c=s.errorToTelemetry)||void 0===c||c.call(s,"Different user context sent for toggle command",Uf),new Error("Different user context sent for toggle command");if(eS(d)){const{activeEntities:n}=d,l=Gf({activeEntities:n,correlation:i,entity:o,logger:s,window:d});if(l)return function({commandChangeReportingService:e,correlation:t,logger:n,newEntity:i}){e.report({correlationId:t.id,type:Qe.B.Toggled,context:{target:"logHideToggle"}}),n.log(`Toggling entity (hide) - ${Df(i)} and correlation ${t.id}`)}({commandChangeReportingService:t,logger:s,newEntity:o,correlation:i}),l;Kv(n.mainEntity,o)||(t.report({correlationId:i.id,type:Qe.B.Incomplete,context:{target:"handleToggleCommandAction"}}),s.log(`Toggling end entity (show) - ${Df(o)} and correlation ${i.id}`),u=Kf({activeEntities:n,appViewEntities:e,correlation:i,enableMultiSlotNone:a,executionContext:r,logger:s,newEntity:o,windowContentState:m}).activeEntities)}else t.report({correlationId:i.id,type:Qe.B.Incomplete,context:{target:"handleToggleCommandAction"}}),s.warn(`Toggle command only supported when active entities set - ${o}`);return Object.assign(Object.assign({},d),{correlation:i,activeEntities:u})}function $f({activeEntities:e,stateTransition:t,executionContext:n}){const i=e.mainEntity.entityState.flushableByLinkedEntity,a=!e.endEntity||e.endEntity.entityState.flushableByLinkedEntity,o=sf({executionContext:n,viewEntityName:Rt.SupportedViewEntities.mainEntity});return t===Rt.EntityStateTransition.forceFlow||o&&i&&t===Rt.EntityStateTransition.flow||!o&&a&&t===Rt.EntityStateTransition.flow}function zf({mainEntity:e,entity:t,stateTransition:n,matchedLinkedEntity:i}){const a=e.entityState.flushableByLinkedEntity;return n===Rt.EntityStateTransition.forceFlush||a&&(n===Rt.EntityStateTransition.flush||n===Rt.EntityStateTransition.new)||i&&t.type!==Rt.EntityType.chats&&t.type!==Rt.EntityType.devicesettings&&t.type!==Rt.EntityType.contentcamerasetup&&t.type!==Rt.EntityType.transcript&&t.type!==Rt.EntityType.meetingdetails&&t.type!==Rt.EntityType.meetingcollaboration}function qf(e,t){const n={__typename:"Entity",action:Rt.EntityAction.view,entityState:{__typename:"EntityState",flushableByLinkedEntity:!0},id:null,linkedEntity:null,type:Rt.EntityType.hybridplaceholder,options:null,windowOptions:null};return t===Rt.CorrelationSourceHint.Activity||t===Rt.CorrelationSourceHint.NonHybridLeftRail?n:dS(e)}function Jf({currentEntity:e,entityFromAppViewEntities:t,isExecutionContextUpstreamOfEntity:n}){const i=!e||e.entityState.flushableByLinkedEntity;return n&&i&&!!t}function Qf(e){return eS(e)?e.activeEntities:void 0}function Kf({activeEntities:e,appViewEntities:t,correlation:n,enableMultiSlotNone:i,executionContext:a,logger:o,newEntity:r,windowContentState:s}){return i&&t?(o.log("Using multi slot none behavior"),function({activeEntities:e,appViewEntities:t,executionContext:n,windowContentState:i}){return Object.assign(Object.assign({},i),{activeEntities:Object.assign(Object.assign({},e),{startEntity:Jf({currentEntity:e.startEntity,entityFromAppViewEntities:t.startEntity,isExecutionContextUpstreamOfEntity:sf({executionContext:n,viewEntityName:Rt.SupportedViewEntities.startEntity})||rf({executionContext:n,viewEntityName:Rt.SupportedViewEntities.startEntity})})?dS(t.startEntity):e.startEntity,endEntity:Jf({currentEntity:e.endEntity,entityFromAppViewEntities:t.endEntity,isExecutionContextUpstreamOfEntity:sf({executionContext:n,viewEntityName:Rt.SupportedViewEntities.endEntity})||rf({executionContext:n,viewEntityName:Rt.SupportedViewEntities.endEntity})})?dS(t.endEntity):e.endEntity})})}({activeEntities:e,appViewEntities:t,executionContext:a,windowContentState:s})):(o.log("Falling back to default none behavior"),function(e,t,n,i,a){return i.log(`Adding as end entity - ${Df(n)} and correlation ${a}`),Object.assign(Object.assign({},e),{activeEntities:Object.assign(Object.assign({},t),{endEntity:n})})}(s,e,r,o,n.id))}function Yf(e,t){var n,i,a,{appViewEntities:o,correlation:r,enableMultiSlotNone:s,entity:l,executionContext:d,isInputDefaultEntity:u,logger:m,matchedLinkedEntity:g,sourceHint:p,stateTransition:h,window:v,userContextId:S}=e,f=(0,c._T)(e,["appViewEntities","correlation","enableMultiSlotNone","entity","executionContext","isInputDefaultEntity","logger","matchedLinkedEntity","sourceHint","stateTransition","window","userContextId"]);const{coreSettings:y}=t,k=Qf(v);let C=v.extendedEntityContainerState,b={activeEntities:k,windowHistory:[...v.windowHistory],currentWindowHistoryIndex:v.currentWindowHistoryIndex,layoutMode:v.layoutConfig.layoutMode,userContextId:v.userContextId,windowId:v.id};if(v.blockingEntityExtension&&k&&h!==Rt.EntityStateTransition.extend)return jf(Rt.EntityVisibilityState.show,k,Object.assign({appViewEntities:o,correlation:r,enableMultiSlotNone:s,entity:l,executionContext:d,isInputDefaultEntity:u,logger:m,matchedLinkedEntity:g,sourceHint:p,stateTransition:h,window:v,userContextId:S},f));if(!k||zf({mainEntity:k.mainEntity,entity:l,stateTransition:h,matchedLinkedEntity:g}))b=function({appViewEntities:e,context:t,correlation:n,isInputDefaultEntity:i,logger:a,newEntity:o,sourceHint:r,userContextId:s,window:l,windowContentState:d}){var c;const{subNavEntity:u=null,headerEntity:m=null,startEntity:g=null,mainEntity:p=null,endEntity:h=null}=Object.assign({},e),{coreSettings:v}=t,{activeEntities:S}=d,{action:f,type:y}=o,{enableMTMACommanding:k}=v.get(A.J.Core),C=!!k&&s!==l.userContextId;if(!C&&(f===Rt.EntityAction.default&&S&&y===ef(S).type||d.activeEntities&&i))return d;const b={__typename:"ActiveEntities",subNavEntity:qf(u,r),headerEntity:dS(m),startEntity:dS(g),mainEntity:null!==(c=dS(p))&&void 0!==c?c:o,endEntity:dS(h),entityExtension:null},[T]=hf({context:t,logger:a,windowContentState:d,newActiveEntities:b,isUserContextSwitch:C});return a.log(`Flushing window - ${Df(o)} and correlation ${n.id}`),{activeEntities:b,windowHistory:T,currentWindowHistoryIndex:T.length-1,layoutMode:l.layoutConfig.layoutMode,userContextId:s,windowId:l.id}}({appViewEntities:o,context:t,correlation:r,isInputDefaultEntity:u,logger:m,newEntity:l,sourceHint:p,userContextId:S,window:v,windowContentState:b});else if($f({activeEntities:k,stateTransition:h,executionContext:d}))b=function({activeEntities:e,appViewEntities:t,context:n,executionContext:i,logger:a,window:o,windowContentState:r}){var s;const l=sf({executionContext:i,viewEntityName:Rt.SupportedViewEntities.headerEntity}),d=l||sf({executionContext:i,viewEntityName:Rt.SupportedViewEntities.startEntity}),c=d||sf({executionContext:i,viewEntityName:Rt.SupportedViewEntities.mainEntity}),u=c||sf({executionContext:i,viewEntityName:Rt.SupportedViewEntities.endEntity});a.log(`Issuing flow command on window - headerEntity ${l}, startEntity ${d}, \n        mainEntity ${c}, endEntity ${u}`);const m=Object.assign(Object.assign({},e),{headerEntity:l?dS(null==t?void 0:t.headerEntity):e.headerEntity,startEntity:d?dS(null==t?void 0:t.startEntity):e.startEntity,mainEntity:c&&null!==(s=dS(null==t?void 0:t.mainEntity))&&void 0!==s?s:e.mainEntity,endEntity:u?dS(null==t?void 0:t.endEntity):e.endEntity}),[g]=hf({context:n,isUserContextSwitch:!1,logger:a,newActiveEntities:m,windowContentState:r});return{activeEntities:m,windowHistory:g,currentWindowHistoryIndex:g.length-1,layoutMode:o.layoutConfig.layoutMode,userContextId:o.userContextId,windowId:o.id}}({activeEntities:k,appViewEntities:o,context:t,executionContext:d,logger:m,window:v,windowContentState:b});else if(function(e,t,n){return!!e&&(Kv(e.mainEntity,t)||Kv(e.endEntity,t))&&n!==Rt.EntityStateTransition.extend}(k,l,h))!function(e,t,n,i){e!==Rt.EntityStateTransition.new&&t.log(`Entity already exists in the active entities no state transition made - ${Df(n)} and correlation ${i}`)}(h,m,l,r.id),b=function(e,t,n,i,a){const{activeEntities:o}=n;if(!o)return n;const{mainEntity:r,endEntity:s}=o,l=Object.assign({},o),{entityState:d}=i,u=(0,c._T)(i,["entityState"]);Kv(r,i)?l.mainEntity=Object.assign(Object.assign({},r),u):s&&Kv(s,i)&&(l.endEntity=Object.assign(Object.assign({},s),u));const[m]=hf({context:e,isUserContextSwitch:!1,logger:t,newActiveEntities:o,windowContentState:n});return{activeEntities:l,windowHistory:m,currentWindowHistoryIndex:m.length-1,layoutMode:a.layoutConfig.layoutMode,userContextId:a.userContextId,windowId:a.id}}(t,m,b,l,v);else if(h===Rt.EntityStateTransition.extend){const e=function({activeEntities:e,extendedEntityContainerState:t,logger:n,newEntity:i,windowContentState:a}){const o=t.containerState===Rt.ExtendedContainerState.Confirmed,r=t.containerState===Rt.ExtendedContainerState.Error,s=e.entityExtension&&t.isExternal;if(i.type===Rt.EntityType.platformapp&&i.action===Rt.EntityAction.create||!e.entityExtension||o||r||s)return t=sS(),a.activeEntities=Object.assign(Object.assign({},e),{entityExtension:i}),[t,a];n.log(`Not showing extension: exists ${!!e.entityExtension}, isConfirmed ${o}, \n  hasError ${r}, hasExternalDialog ${s}`)}({activeEntities:k,extendedEntityContainerState:C,logger:m,newEntity:l,windowContentState:b});if(!e)throw new Error(`Extension already rendered, only one extension command request can be processed at a time. \n        Extension shown: ${null===(n=k.entityExtension)||void 0===n?void 0:n.type}; Extension requested: ${l.type}.`);C=e[0],b=e[1]}else b=Kf({activeEntities:k,appViewEntities:o,correlation:r,enableMultiSlotNone:s,newEntity:l,executionContext:d,logger:m,windowContentState:b});if(function(e,t,n,i){const{enableMTMACommanding:a}=e.get(A.J.Core);return!(!a||t||!n||!i.userContextId||n===i.userContextId)}(y,h===Rt.EntityStateTransition.flush||h===Rt.EntityStateTransition.forceFlush||h===Rt.EntityStateTransition.extend,S,v))throw new Error("Different user context sent for non-flush and non-extend command");const T=v.windowHistoryNavigationState,w=Object.assign(Object.assign({},T),{backHistory:[...null!==(i=T.backHistory)&&void 0!==i?i:[]],forwardHistory:[...null!==(a=T.forwardHistory)&&void 0!==a?a:[]]});return Object.assign(Object.assign(Object.assign({},v),b),{correlation:r,extendedEntityContainerState:C,windowHistoryNavigationState:w})}function Xf(e,t,n,i){switch(e){case Rt.EntityVisibilityState.hide:return Vf(t,n,i);case Rt.EntityVisibilityState.toggle:return Hf(t);case Rt.EntityVisibilityState.show:case Rt.EntityVisibilityState.showWithoutFocusing:return Yf(t,n)}}function Zf(e,t){if(void 0!==t){const n=t?uS(t):null;e.linkedEntity=n}}function ey(e,t,n,i,a){const{visibilityState:o,stateTransition:r,layoutMode:s}=e;if(o!==Rt.EntityVisibilityState.hide){if(i&&r===Rt.EntityStateTransition.new)return(0,Je.v4)();if(a&&n===_.ew){if(!bf(t,null!=s?s:Ae.lO.standard))return(0,Je.v4)()}else if(function(e,t){return t===_.ew&&!_f(e,_.ew)}(t,n))return _.ew}}function ty({activeWindows:e,command:t,coreSettings:n,correlation:i,entitiesMap:a,entity:o,isNewContextSupportEnabled:r,layoutMode:s,linkedEntitiesMap:l,logger:d,userContextId:c,windowId:u,webNrcEnabled:m}){const g=t.stateTransition===Rt.EntityStateTransition.forceFlush,p=t.stateTransition===Rt.EntityStateTransition.flow,[h,v]=!r||g||p?[void 0,!1]:If(o,a,l,c,n);h&&(d.log(`Entity matched matched via linked entity ${v} for correlation ${i.id} to window`),Pf(h,d));const S=h||function({command:e,activeWindows:t,windowId:n,correlation:i,logger:a,isNewContextSupportEnabled:o,layoutMode:r,userContextId:s,webNrcEnabled:l}){const d=ey(e,t,n,o,l);return void 0!==d?(a.log(`Creating new window with id ${d} for correlation ${i.id}`),function(e,t,n,i,a,o,r,s){return{__typename:"Window",id:t,windowOptions:null,windowHistory:[],currentWindowHistoryIndex:0,windowHistoryNavigationState:{__typename:"WindowHistoryNavigationState",canNavigateBack:!1,canNavigateForward:!1,backHistory:[],forwardHistory:[]},correlation:Object.assign(Object.assign({},e),{__typename:"Correlation"}),extendedEntityContainerState:sS(),blockingEntityExtension:null,isMainWindow:a!==Rt.EntityStateTransition.new&&i===_.ew,isInitialWindowStateHidden:o===Rt.EntityVisibilityState.showWithoutFocusing,userContextId:s,layoutConfig:{__typename:"LayoutConfig",layoutMode:null!=n?n:t===_.ew||r&&a!==Rt.EntityStateTransition.new?Rt.LayoutModes.standard:Rt.LayoutModes.focus,isFullscreen:!1,slots:{__typename:"SlotsLayoutConfig",header:{__typename:"SlotLayoutConfig",height:null,isHidden:!1,width:null},subNav:{__typename:"SlotLayoutConfig",height:null,isHidden:!1,width:null},end:{__typename:"SlotLayoutConfig",height:null,isHidden:!1,width:null},contextualNotifications:{__typename:"SlotLayoutConfig",height:null,isHidden:!1,width:null},main:{__typename:"SlotLayoutConfig",height:null,isHidden:!1,width:null},nav:{__typename:"SlotLayoutConfig",height:null,isHidden:!1,width:null},start:{__typename:"SlotLayoutConfig",height:null,isHidden:!1,width:null},titleBar:{__typename:"SlotLayoutConfig",height:null,isHidden:!1,width:null},toasts:{__typename:"SlotLayoutConfig",height:null,isHidden:!1,width:null},notifications:{__typename:"SlotLayoutConfig",height:null,isHidden:!1,width:null}}}}}(i,d,r,n,e.stateTransition,e.visibilityState,l,s)):(e=>e===_.ew)(n)?(a.log(`Retrieving mainWindow with layoutMode ${r} for correlation ${i.id}`),bf(t,null!=r?r:Ae.lO.standard)):(a.log(`Retrieving window with id ${n} for correlation ${i.id}`),_f(t,n))}({activeWindows:e,command:t,correlation:i,isNewContextSupportEnabled:r,layoutMode:s,logger:d,userContextId:c,windowId:u,webNrcEnabled:m});if(!S)throw function(e,t){var n;return null===(n=t.errorToTelemetry)||void 0===n||n.call(t,"Unable to get source window",Uf),(0,he.Tr)(_.w5.Commanding,_.jK.UndefinedWindowError,"CommandResolvers",e,"Unable to find applicable target window")}(i,d);return[S,v]}function ny(e,t,n,i,a){const o=cS(e),[r,s]=Xv(t,Zv,(e=>e.id!==_.ew)),[l]=If(o,r,s,i,a);return l&&(n.log(`Found window for entity ${Df(o)}`),Pf(l,n)),l||null}function iy(e,t,n,i){const a=e.activeEntities;return!!(null==a?void 0:a.entityExtension)&&(a.entityExtension=null,e.extendedEntityContainerState.containerState=Rt.ExtendedContainerState.Error,yf(t,n,e,i))}const ay=(e,t,n,i,a,o)=>{const{appsRegistryService:r,cache:s,commandChangeReportingService:l,localStorage:d,coreSettings:u,windowId:m}=n,g=(0,c._T)(n,["appsRegistryService","cache","commandChangeReportingService","localStorage","coreSettings","windowId"]),p=Object.assign(Object.assign({},e),{extendedEntityContainerState:Object.assign(Object.assign({},e.extendedEntityContainerState),t)}),h=e.blockingEntityExtension;p.blockingEntityExtension=null;const v=yf(n,a,p,i),S=((e,t,n)=>{const i=null==e?void 0:e.blockedEntity,a=null==e?void 0:e.blockedCommand,o=null==e?void 0:e.blockedEntityOptions;if(!i||!a)return t.warn("Unable to re-create the command which was blocked and saved."),null;const r=lS();r.source=I.D.CoreResolvers;const s={entity:i,command:Object.assign(Object.assign({},a),{correlation:r}),entityOptions:o};return n.report({type:Qe.B.CommandStart,correlationId:s.command.correlation.id,context:{target:"createAndRegisterBlockedCommandOnConfirm",entityCommand:Object.assign(Object.assign({},s),{entityOptions:o?JSON.parse(o):void 0})}}),s})(h,i,l);if(S){const{entity:e,command:t,entityOptions:n}=S;return!!sy({entity:e,command:t,entityOptions:n,windowId:m,clientLaunchId:p.correlation.clientLaunchId},Object.assign({appsRegistryService:r,cache:s,commandChangeReportingService:l,coreSettings:u,localStorage:d,windowId:m},g),o)}return v},oy=({logger:e,appsRegistryService:t,coreSettings:n})=>{const i=t.getDefaultCommand(n);return i?(e.log("Default command found"),i):(e.error("No default command defined"),null)},ry=({isInputDefaultEntity:e,sourceWindow:t,context:n,userContextId:i,newEntity:a,matchedLinkedEntity:o,stateTransition:r,executionContext:s,correlation:l,logger:d})=>{const{localStorage:c,coreSettings:u,appsRegistryService:m,commandChangeReportingService:g,clientPreferences:p}=n,{enableWriteActiveEntitiesToLocalStorage:h,enableMTMACommanding:v,enableWriteAppHistoryToLocalStorage:S}=u.get(A.J.Core);let f=null;e&&t.isMainWindow&&h?f=((e,t,n,i)=>{const a=e.get(Jv,or.f.Experience);if(a)try{const e=JSON.parse(a);return i&&n!==e.userContextId?null:e.activeEntities}catch(e){t.error(`Could not restore active entities from local storage. Stored string was in an invalid JSON format. String: ${a}.`)}return null})(c,d,i,v):a.action===Rt.EntityAction.default&&t.isMainWindow&&S&&(f=((e,t,n,i)=>{var a;const o=null===(a=i.getApp({entityType:n}))||void 0===a?void 0:a.manifest.id,r=e.get(`appActiveEntitiesHistory-${o}`);if(r)try{return JSON.parse(r)}catch(e){t.error(`Could not restore active entities from local storage. Stored string was in an invalid JSON format. String: ${r}.`)}return null})(c,d,a.type,m));const y=eS(t)?t.activeEntities:void 0;if(!f){const e=(({currentEntities:e,newEntity:t,matchedLinkedEntity:n,stateTransition:i,executionContext:a})=>!e||zf({entity:t,mainEntity:e.mainEntity,matchedLinkedEntity:n,stateTransition:i})||$f({activeEntities:e,stateTransition:i,executionContext:a}))({currentEntities:y,newEntity:a,matchedLinkedEntity:o,stateTransition:r,executionContext:s});d.log(`Should use entity from command input for getAppViewEntities ${e} `);const{appEntity:n,contextEntity:i}=tf({currentEntities:eS(t)?t.activeEntities:void 0,entity:a,shouldUseNewEntity:e});g.report({type:Qe.B.CommandBeforeGetAppViewEntities,context:{target:"executeEntityCommand"},correlationId:l.id});try{f=nf({appsRegistryService:m,clientPreferences:p,contextEntity:i,coreSettings:u,entity:n,layoutMode:t.layoutConfig.layoutMode}),(({appViewEntities:e,stateTransition:t,appEntity:n,linkedEntity:i})=>t!==Rt.EntityStateTransition.none&&null===e&&n===i)({appEntity:n,appViewEntities:f,linkedEntity:a.linkedEntity,stateTransition:r})&&(d.log(`Initial getAppViewEntities for ${n} returned null`),f=nf({entity:a,clientPreferences:p,contextEntity:null,coreSettings:u,layoutMode:t.layoutConfig.layoutMode,appsRegistryService:m}))}catch(e){g.report({type:Qe.B.Failure,context:{errorInfo:Ke.y.CommandGetAppViewEntitiesFailure,errorMessage:e.message,target:"executeEntityCommand"},correlationId:l.id})}}return f},sy=({clientLaunchId:e,command:t,entity:n,entityOptions:i,executionContext:a,windowId:o,windowOptions:r},s,l)=>{var d,c,u,m;const{appsRegistryService:g,authenticationUser:p,cache:h,clientPreferences:v,commandChangeReportingService:S,coreSettings:f,experienceChangeReportingService:y,loggerFactory:k,windowProvider:C,scenarioFactory:b}=s,T=k.newLogger("executeEntityCommand-mutation"),{visibilityState:w,stateTransition:I,correlation:N,layoutMode:E}=t;try{const m=o||_.ew,k=((e,t)=>t?Object.assign(Object.assign({},t),{clientLaunchId:null!=e?e:null,__typename:"Correlation"}):Object.assign(Object.assign({},lS()),{clientLaunchId:null!=e?e:null,__typename:"Correlation"}))(null!=e?e:null,N);S.report({correlationId:k.id,type:Qe.B.CommandResolutionStarted,context:{target:"executeEntityCommand"}});const D=ff(h,T),[F,P]=Xv(D,Zv,(e=>!Tf(D,e.id)&&!((e,t)=>{const n=bf(e,Rt.LayoutModes.minimal);return t===(null==n?void 0:n.id)})(D,e.id))),M=(e=>e.action===Rt.EntityAction.default&&e.type===Rt.EntityType.default)(n),j=null==N?void 0:N.sourceHint,R=(({entity:e,isInputDefaultEntity:t,logger:n,appsRegistryService:i,coreSettings:a})=>t?oy({logger:n,appsRegistryService:i,coreSettings:a}):e)({entity:n,isInputDefaultEntity:M,logger:T,appsRegistryService:g,coreSettings:f});if(!R)return null===(d=T.errorToTelemetry)||void 0===d||d.call(T,"Unable to use entity from command input",Uf,void 0,!0),null;const x=cS(R,i,r);if(function(e){return e.type===Rt.EntityType.toasts}(x))return T.log("Send all toast commands to Maglev host for execution"),S.report({correlationId:k.id,type:Qe.B.NotHandled,context:{target:"executeEntityCommand",entityCommand:{entity:n,command:Object.assign(Object.assign({},t),{correlation:t.correlation,layoutMode:t.layoutMode||void 0}),entityOptions:i&&JSON.parse(i)}}}),null;T.log(`Command received for entity ${Df(x)}`),T.log(`Command received :${function(e){return`{\n    visibilityState: ${e.visibilityState},\n    stateTransition: ${e.stateTransition},\n    correlation: ${Ff(e.correlation)}\n  }`}(t)}`),T.log(`Command with id ${k.id} received on window context ${m}`),T.log(`Command received with execution context: ${null==a?void 0:a.viewEntityName}`);const{isNewContextSupportEnabled:O,webNrcEnabled:L}=f.get(A.J.Host),{enableMultiSlotHide:U,enableMultiSlotNone:B,enableWindowNotUpdatedEvent:W,enableMTMACommanding:G,forceFocusLayoutMode:V}=f.get(A.J.Core),H=bf(D,Rt.LayoutModes.standard),$=G&&((null==a?void 0:a.userContextId)||pS(p)||I===Rt.EntityStateTransition.extend&&H&&H.userContextId)||null;T.log(`isNewContextSupportEnabled ${O}, enableMultiSlotHide ${U}, enableMultiSlotNone ${B}`);const z=((e,t)=>t?Ae.lO.focus:e&&(e.layoutMode||Ae.lO.focus))(C.Cypress,!!V),q=ty({activeWindows:D,command:t,coreSettings:f,correlation:k,entitiesMap:F,entity:x,isNewContextSupportEnabled:null==O||O,layoutMode:null!=z?z:E,linkedEntitiesMap:P,logger:T,userContextId:$,windowId:m,webNrcEnabled:null!=L&&L});let[J]=q;const[,Q]=q;if(I===Rt.EntityStateTransition.extend){if(L&&!eS(J)&&J.isMainWindow&&m===_.ew){T.log("Extension command - creating main window");const e=oy({logger:T,appsRegistryService:g,coreSettings:f});if(!e)throw new Error("No default entity. Unable to show extension");const t=cS(e,i,r),n=ry({isInputDefaultEntity:!0,sourceWindow:J,context:s,userContextId:$,newEntity:t,matchedLinkedEntity:!1,stateTransition:Rt.EntityStateTransition.flush,executionContext:a,correlation:k,logger:T});T.log(`Extension command - flushing with entity ${Df(t)}`),Mf(n,T),J=Xf(Rt.EntityVisibilityState.show,{appsRegistryService:g,appViewEntities:n||void 0,clientPreferences:v,commandChangeReportingService:S,correlation:k,coreSettings:f,enableMultiSlotHide:U,enableMultiSlotNone:B,entitiesMap:F,entity:t,entityOptions:i,executionContext:a,host:C,isInputDefaultEntity:!0,logger:T,matchedLinkedEntity:Q,sourceHint:j,stateTransition:Rt.EntityStateTransition.flush,userContextId:$,window:J},s,l),T.log("Extension command - created source window"),Pf(J,T)}const e=!eS(J);if(e||J.userContextId!==$){const t=e?Ke.y.EmptyWindowError:Ke.y.UserContextMismatch;return T.log(`Extension command error ${t}`),S.report({correlationId:k.id,type:Qe.B.Incomplete,context:{errorInfo:t,target:"executeEntityCommand"}}),null}}const K=ry({isInputDefaultEntity:M,sourceWindow:J,context:s,userContextId:$,newEntity:x,matchedLinkedEntity:Q,stateTransition:I,executionContext:a,correlation:k,logger:T});if(S.report({type:Qe.B.CommandAfterGetAppViewEntitiesSucceeded,context:{target:"executeEntityCommand"},correlationId:k.id}),T.log("Final appViewEntities: "),Mf(K,T),T.log(`Before updating cache, There are ${D.length} active windows`),T.log("Source window: "),Pf(J,T),null===K)throw null===(c=T.errorToTelemetry)||void 0===c||c.call(T,"No app supports entity command",Uf),new Error("no app view entities for entity input");let Y=Xf(w,{appsRegistryService:g,appViewEntities:K,clientPreferences:v,commandChangeReportingService:S,correlation:k,coreSettings:f,enableMultiSlotHide:U,enableMultiSlotNone:B,entitiesMap:F,entity:x,entityOptions:i,executionContext:a,host:C,isInputDefaultEntity:M,logger:T,matchedLinkedEntity:Q,sourceHint:j,stateTransition:I,userContextId:$,window:J},s,l);T.log("Target window: "),Pf(Y,T);const X=function(e,t){return tS(eS(e)?e.activeEntities:null,eS(t)?t.activeEntities:null)}(J,Y);!function(e,t,n,i,a,o,r){const s=(0,go.YR)(e,n);r.log(`ViewportContext: ${s}`);const l={"Panel.WindowID":t,"Window.ViewportContext":s};a.report({correlationId:i,type:Qe.B.ScenarioEventDataAppended,context:{target:"setViewportContextOnLaunchScenarios",eventData:l}});const d=o.findScenario(ee.RG.WindowLaunchTime);null==d||d.appendEventData(l)}(Y.isMainWindow,Y.id,Y.layoutConfig.layoutMode,k.id,S,b,T),S.report({correlationId:k.id,type:Qe.B.CommandMetaDataAdded,context:{target:"executeEntityCommand",isCommandTargetedToMainWindow:Y.id===_.ew,shouldNavigate:iS(J,Y,I,x)}});const Z=J.id===_.ew&&I!==Rt.EntityStateTransition.new&&I!==Rt.EntityStateTransition.none;if(SS(X,m,Z,I===Rt.EntityStateTransition.flow||I===Rt.EntityStateTransition.none,f,T)){T.log(`Opener will handle the requested entity change with correlationId ${k.id} and entityId ${n.id}`);let e=!0;X.entityExtension&&(Y.extendedEntityContainerState.isExternal=!0,e=yf(s,D,Y,T));const t=_f(D,_.ew);if(t&&(e=>!(!e.activeEntities.entityExtension||e.extendedEntityContainerState.containerState===Rt.ExtendedContainerState.Closed))(t)&&Of(t,D,T,k,s),e)try{return(({correlation:e,diff:t,commandChangeReportingService:n,windowId:i,logger:a,targetWindow:o,context:r,activeWindows:s})=>{var l;if(fS(e,t,n,i,a))return null;throw iy(o,r,s,a),null===(l=a.errorToTelemetry)||void 0===l||l.call(a,"Unable to update cache, opener did not handle change",Uf),(0,he.Tr)(_.w5.Commanding,_.jK.UnhandledRuntimeException,"executeEntityCommand",void 0,"Unable to update cache, opener did not handle the entity change")})({correlation:k,diff:X,commandChangeReportingService:S,windowId:m,logger:T,targetWindow:Y,context:s,activeWindows:D})}catch(e){throw iy(Y,s,D,T),null===(u=T.errorToTelemetry)||void 0===u||u.call(T,"Unable to update cache, errored while having opener handle change",Uf,{errors:`${e.message}`}),(0,he.Tr)(_.w5.Commanding,_.jK.UnhandledRuntimeException,"executeEntityCommand",e,"Unable to update cache, opener threw an exception and did not handle the entity change")}}if(((e,t,n)=>{const i=eS(e)?e.activeEntities.entityExtension:null,a=eS(t)?t.activeEntities.entityExtension:null;return!(t.extendedEntityContainerState.containerState===Rt.ExtendedContainerState.Closed||!(i&&rS(n)||!a))})(J,Y,X)&&(Y=((e,t,n,i,a)=>{if(e.extendedEntityContainerState.isExternal)n.log(`Internal routing - closing external dialog for correlation ${a.id}`),xf(t,n,i);else if(n.log(`Internal routing - closing internal dialog for correlation ${a.id}`),eS(e))return Lf(e,a);return e})(Y,J,T,S,k)),T.log(`Handling the requested entity command internally for correlation ${k.id}`),Af({pubsub:l,fromWindowId:m,isFromWindowMain:Tf(D,m),sourceWindowId:J.id,diff:X,targetWindow:Y,targetVisibilityState:w,stateTransition:I,correlation:k,logger:T}),mf(Y,T),W&&!nS(J,Y))return S.report({correlationId:k.id,type:Qe.B.WindowNotUpdated,context:{target:"executeEntityCommand"}}),null;if(J.correlation.id!==k.id){const e=eS(J)?J.activeEntities:void 0;e&&S.report({correlationId:k.id,type:Qe.B.ScenarioEventDataAppended,context:{target:"executeEntityCommand",eventData:{fromMainEntityType:e.mainEntity.type,fromMainEntityAction:e.mainEntity.action}}}),S.report({correlationId:J.correlation.id,type:Qe.B.Abandoned,context:{target:"executeEntityCommand"}}),y.report({correlationId:k.id,type:Tt.yU.ActiveEntitiesDestroyed,context:{target:"entity-command-resolver"},windowId:J.id})}if(!Kv(eS(Y)?Y.activeEntities.mainEntity:null,eS(J)?J.activeEntities.mainEntity:null)&&eS(J)){const e={height:null,isHidden:!1,width:null};Y.layoutConfig.slots={__typename:"SlotsLayoutConfig",contextualNotifications:Object.assign(Object.assign({},e),{__typename:"SlotLayoutConfig"}),end:Object.assign(Object.assign({},e),{__typename:"SlotLayoutConfig"}),header:Object.assign(Object.assign({},e),{__typename:"SlotLayoutConfig"}),main:Object.assign(Object.assign({},e),{__typename:"SlotLayoutConfig"}),nav:Object.assign(Object.assign({},e),{__typename:"SlotLayoutConfig"}),notifications:Object.assign(Object.assign({},e),{__typename:"SlotLayoutConfig"}),start:Object.assign(Object.assign({},e),{__typename:"SlotLayoutConfig"}),subNav:Object.assign(Object.assign({},e),{__typename:"SlotLayoutConfig"}),titleBar:Object.assign(Object.assign({},e),{__typename:"SlotLayoutConfig"}),toasts:Object.assign(Object.assign({},e),{__typename:"SlotLayoutConfig"})}}const te=yf(s,D,Y,T,k.id);if(te){const e=function(e){const t=[];return Object.keys(e).map((n=>{const i=e[n];i&&t.push(i)})),t}(X);e.length>0&&y.report({correlationId:k.id,type:Tt.yU.ActiveEntitiesResolved,context:{target:"entity-command-resolver",entities:e},windowId:Y.id}),S.report({correlationId:k.id,type:Qe.B.WindowUpdated,context:{target:"executeEntityCommand"}})}return te&&eS(Y)?Y:null}catch(e){throw null===(m=T.errorToTelemetry)||void 0===m||m.call(T,`Unable to execute entity command ${w} ${I} -  ${e.message}`,Uf,{mainEntityType:n.type,mainEntityAction:n.action,correlationId:N.id},!0),e}},ly=(e,t,n,i)=>{var{cache:a,windowId:o,commandChangeReportingService:r}=n,s=(0,c._T)(n,["cache","windowId","commandChangeReportingService"]);if(!e.activeEntities.entityExtension)return!1;const l=Rf(e,t,r);if(l){const{entity:t,command:n}=l;return sy({entity:t,command:n,windowId:o,clientLaunchId:e.correlation.clientLaunchId},Object.assign({cache:a,windowId:o,commandChangeReportingService:r},s),i)}return!1},dy=e=>({Query:{activeWindow(e,{windowId:t},{cache:n,coreSettings:i,loggerFactory:a}){const o=a.newLogger("activeWindow"),{webNrcEnabled:r}=i.get(A.J.Host),s=t||_.ew;let l;const d=ff(n,o,!1);if(l=s===_.ew&&r?bf(d,Rt.LayoutModes.standard):d.find((e=>e.id===s)),!l)throw new Error(`Requesting activeWindow for unknown windowId ${s}`);return l},activeWindowForEntity(e,{entity:t},{cache:n,loggerFactory:i,authenticationUser:a,coreSettings:o}){const r=i.newLogger("activeWindowForEntity-query"),s=ff(n,r),{enableMTMACommanding:l}=o.get(A.J.Core);return ny(t,s,r,l?pS(a):null,o)}},Mutation:{navigateToWindowHistoryIndex:(e,t,n)=>(({windowId:e,windowHistoryIndex:t},n)=>{var i;const{cache:a,loggerFactory:o}=n,r=o.newLogger("navigateToWindowHistoryIndex-mutation");r.debug(`Navigating to windowHistoryIndex ${t} on window ${e}.`);const s=ff(a,r),l=_f(s,e);if(!l)throw new Error("Could not find window.");return!(0===(null===(i=l.windowHistory)||void 0===i?void 0:i.length)||t<0||t>l.windowHistory.length-1)&&Ef(l,t,r,s,n)})(t,n),performWindowHistoryNavigation:(e,t,n)=>(({windowId:e,navigationDirection:t},n)=>{var i;const{cache:a,loggerFactory:o}=n,r=o.newLogger("performWindowHistoryNavigation-mutation");r.debug(`Navigating ${e} with direction ${t}.`);const s=ff(a,r),l=_f(s,e);if(!l)throw new Error("Could not find window.");if(0===(null===(i=l.windowHistory)||void 0===i?void 0:i.length))return!1;let d=l.currentWindowHistoryIndex;const c=e=>r.warn(`Could not navigate ${t}. Index ${e} is out of the bounds of the window history.`);if(t===Rt.NavigationDirection.back){if(d--,d<0)return c(d),!1}else if(++d,d>l.windowHistory.length-1)return c(d),!1;return Ef(l,d,r,s,n)})(t,n),updateEntity(e,{entity:t,entityOptions:n,viewEntityName:i,windowId:a},o){const{cache:r,loggerFactory:s}=o,l=a||_.ew,d=s.newLogger("updateEntity-mutation"),c=ff(r,d),u=_f(c,l);if(!u)return d.warn("Trying to update entity in window that does not exist"),!1;if(u.userContextId&&o.authenticationUser&&u.userContextId!==pS(o.authenticationUser))return d.warn("Trying to update entity in for a different user context than currently present on the window"),!1;return function({entity:e,window:t,viewEntityName:n}){t.activeEntities[n]=Object.assign(Object.assign({},t.activeEntities[n]),e)}({window:u,entity:cS(t,n),viewEntityName:i}),yf(o,c,u,d)},updateEntityState(e,{entity:t,entityState:n},i){const{authenticationUser:a,cache:o,coreSettings:r,loggerFactory:s}=i,{enableMTMACommanding:l}=r.get(A.J.Core),d=s.newLogger("updateEntityState-mutation"),c=ff(o,d),u=ny(t,c,d,l?pS(a):null,r);if(!u)return d.warn("Trying to update flushable entity that does not exist"),!1;return function(e,t,n,i){const{mainEntity:a,endEntity:o}=e.activeEntities,{flushableByLinkedEntity:r,linkedEntityUpdate:s}=n;Kv(a,t)?(null!=r&&(a.entityState.flushableByLinkedEntity=r),Zf(a,s)):o&&Kv(o,t)?(i.log("Updating entity state for end entity"),Zf(o,s)):i.warn(`Updating entity state for entity the does not exist ${t}`)}(u,cS(t),n,d),yf(i,c,u,d),!0},updateExtendedEntityContainerState(t,n,i){return(0,c.mG)(this,void 0,void 0,(function*(){const{cache:t,loggerFactory:a,windowId:o,windowProvider:r}=i,s=a.newLogger("updateExtendedEntityContainerState-mutation"),l=ff(t,s),d=_f(l,o);if(d)if(((e,t)=>{var n;return e===Rt.ExtendedContainerState.Confirmed&&(null===(n=t.blockingEntityExtension)||void 0===n?void 0:n.entity)&&Kv(t.activeEntities.entityExtension,t.blockingEntityExtension.entity)})(n.containerState,d))d.id===_.ew&&r.opener.postMessage(N.W.MainWindowBlockedState,{isBlocked:"Confirmed",entity:null}),ay(d,n,i,s,l,e);else{if(n.containerState!==Rt.ExtendedContainerState.Closed)return d.extendedEntityContainerState=Object.assign(Object.assign({},d.extendedEntityContainerState),n),yf(i,l,d,s);ly(d,s,i,e)}return!1}))},executeEntityCommand:(t,n,i)=>sy(n,i,e),addBlockingExtension:(t,{entity:n,entityOptions:i,windowId:a,removeBlock:o},r)=>{var{cache:s,loggerFactory:l,windowProvider:d}=r,u=(0,c._T)(r,["cache","loggerFactory","windowProvider"]);const m=l.newLogger("addBlockingExtension-mutation");m.log(`${o?"Removing":"Adding"} an entity extension blocker of type ${n.type}`);const g=ff(s,m),p=_f(g,a);if(p){const t=Object.assign(Object.assign({},n),{id:n.id||null,linkedEntity:null,options:i||null,windowOptions:null,__typename:"Entity",entityState:{flushableByLinkedEntity:!1,__typename:"EntityState"}});if(o&&p.blockingEntityExtension)return((e,t,n,i,a,o)=>{const{windowProvider:r}=o;if(!t.blockingEntityExtension||!Kv(t.blockingEntityExtension.entity,e))return!1;const s=Object.assign(Object.assign({},t),{blockingEntityExtension:null}),l=yf(o,n,s,i);return s.id===_.ew&&r.opener.postMessage(N.W.MainWindowBlockedState,{isBlocked:"Unblocked",entity:null}),ly(t,i,o,a),l})(t,p,g,m,e,Object.assign({cache:s,loggerFactory:l,windowProvider:d},u));if(!o)return((e,t,n,i,a)=>{var o;const{windowProvider:r}=a,s={entity:e,__typename:"BlockingEntityExtension",blockedEntity:null,blockedCommand:null,blockedEntityOptions:null},l=Object.assign(Object.assign({},t),{blockingEntityExtension:s});if(l.id===_.ew)try{r.opener.postMessage(N.W.MainWindowBlockedState,{isBlocked:"Blocked",entity:s.entity,entityOptions:e.options&&JSON.parse(e.options)})}catch(e){null===(o=i.errorToTelemetry)||void 0===o||o.call(i,"Unable to parse and post addBlockingExtension to main window",Uf)}return yf(a,n,l,i)})(t,p,g,m,Object.assign({cache:s,windowProvider:d,loggerFactory:l},u))}return!1},setWindowFullscreen:(e,{isFullscreen:t,windowId:n},i)=>{const{cache:a,loggerFactory:o}=i,r=o.newLogger("setWindowFullscreen-mutation"),s=ff(a,r),l=_f(s,n);if(!l)return null;let d=!1;return l.layoutConfig.isFullscreen!==t&&(l.layoutConfig.isFullscreen=t,d=yf(i,s,l,r)),d&&eS(l)?l:null},resizeHeaderSlot:(e,{height:t,windowId:n},i)=>{var a,o,r,s,l;const{cache:d,loggerFactory:c}=i,u=c.newLogger("resizeHeaderSlot-mutation"),m=ff(d,u),g=_f(m,n);if(!g)return null;let p=!1;return(null===(o=null===(a=g.layoutConfig.slots)||void 0===a?void 0:a.header)||void 0===o?void 0:o.height)!==t&&(g.layoutConfig.slots=Object.assign(Object.assign({},g.layoutConfig.slots),{__typename:"SlotsLayoutConfig",header:Object.assign(Object.assign({},null===(r=g.layoutConfig.slots)||void 0===r?void 0:r.header),{__typename:"SlotLayoutConfig",height:t,width:(null===(l=null===(s=g.layoutConfig.slots)||void 0===s?void 0:s.header)||void 0===l?void 0:l.width)||null})}),p=yf(i,m,g,u)),p&&eS(g)?g:null},changeSlotsVisibility:(e,{slotNames:t,windowId:n,isHidden:i},a)=>{const{cache:o,loggerFactory:r}=a,s=r.newLogger("changeSlotsVisibility-mutation"),l=ff(o,s),d=_f(l,n);if(!d)return s.error("mutation fails as targetWindow is not found."),null;let c=!1,u=!1;const m=t.reduce(((e,t)=>{var n;const a=(e=>e.replace(/-./g,(e=>e[1].toUpperCase())))(t),o=null===(n=d.layoutConfig.slots)||void 0===n?void 0:n[a];return u||(null==o?void 0:o.isHidden)===i||(u=!0),e[a]=Object.assign(Object.assign({},o),{isHidden:i}),e}),{});return u&&(d.layoutConfig.slots=Object.assign(Object.assign({__typename:"SlotsLayoutConfig"},d.layoutConfig.slots),m),c=yf(a,l,d,s)),c&&eS(d)?d:null},removeUserActiveWindows:(e,{userContextId:t},n)=>{const{cache:i,loggerFactory:a}=n,o=a.newLogger("removeUserActiveWindowsMutation-mutation");return yf(n,((e,t)=>e.filter((e=>e.isMainWindow||e.userContextId!==t)))(ff(i,o),t),void 0,o)},resizeSlotDimensions:(e,{windowId:t,slotName:n,width:i},a)=>{var o,r,s,l,d,c;const{cache:u,loggerFactory:m}=a,g=m.newLogger("resizeSlotDimensions-mutation"),p=ff(u,g),h=_f(p,t);if(!h)return null;let v=!1;return n===Rt.SlotName.SUBNAV?h.layoutConfig.slots=Object.assign(Object.assign({},h.layoutConfig.slots),{__typename:"SlotsLayoutConfig",subNav:Object.assign(Object.assign({},null===(o=h.layoutConfig.slots)||void 0===o?void 0:o.subNav),{__typename:"SlotLayoutConfig",height:(null===(s=null===(r=h.layoutConfig.slots)||void 0===r?void 0:r.subNav)||void 0===s?void 0:s.height)||null,width:i})}):n===Rt.SlotName.END&&(h.layoutConfig.slots=Object.assign(Object.assign({},h.layoutConfig.slots),{__typename:"SlotsLayoutConfig",end:Object.assign(Object.assign({},null===(l=h.layoutConfig.slots)||void 0===l?void 0:l.end),{__typename:"SlotLayoutConfig",height:(null===(c=null===(d=h.layoutConfig.slots)||void 0===d?void 0:d.end)||void 0===c?void 0:c.height)||null,width:i})})),v=yf(a,p,h,g),v&&eS(h)?h:null},saveReactiveVarsToHistory(e,{windowId:t,appIds:n},i){const{cache:a,loggerFactory:o}=i,r=o.newLogger("saveReactiveVarsToHistory-mutation"),s=t||_.ew,l=ff(a,r),d=_f(l,s);if(!d)return r.warn("Trying to save reactive var history for window that does not exist"),!1;if(0===d.windowHistory.length)return!1;const c={activeEntities:d.activeEntities,windowHistory:d.windowHistory,currentWindowHistoryIndex:d.currentWindowHistoryIndex,layoutMode:d.layoutConfig.layoutMode,userContextId:d.userContextId||null,windowId:d.id},[u,m]=hf({appIdsForReactiveVarChange:n,context:i,isUserContextSwitch:!1,logger:r,newActiveEntities:d.activeEntities,windowContentState:c});if(!m)return r.log("Did not update history"),!1;const g=Object.assign(Object.assign({},d),{windowHistory:u});return mf(g,r),yf(i,l,g,r),!0}}});var cy=n(34507);const uy=e=>({__typename:"MeetingRoomFrontOfRoomCallPanelsState",id:e,rightPanel:null}),my={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserMeetingRoomMeetingRoomFrontOfRoomCallPanelsStateQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meetingRoomFrontOfRoomCallPanelsState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"teamsCallId"},value:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"rightPanel"}}]}}]}}]},gy={Query:{meetingRoomFrontOfRoomCallPanelsState:(e,{teamsCallId:t},{cache:n})=>{let i=uy(t);try{const e=n.readQuery({query:my,variables:{teamsCallId:t}}),a=null==e?void 0:e.meetingRoomFrontOfRoomCallPanelsState;i=null!=a?a:i}catch(e){}return i}},Mutation:{setMeetingRoomFrontOfRoomCallPanelsState:(e,{teamsCallId:t,state:n},{cache:i,loggerFactory:a})=>{var o;const r=null==a?void 0:a.newLogger("setMeetingRoomFrontOfRoomCallPanelsState");let s=uy(t);try{const e=i.readQuery({query:my,variables:{teamsCallId:t}});(null==e?void 0:e.meetingRoomFrontOfRoomCallPanelsState)&&(s=e.meetingRoomFrontOfRoomCallPanelsState)}catch(e){null==r||r.error("No data found in cache for meetingRoomFrontOfRoomCallPanelsState, using default value")}const l={__typename:"MeetingRoomFrontOfRoomCallPanelsState",id:s.id,rightPanel:null!==(o=n.rightPanel)&&void 0!==o?o:null};try{i.writeQuery({query:my,variables:{teamsCallId:t},data:{meetingRoomFrontOfRoomCallPanelsState:l}})}catch(e){null==r||r.error("setMeetingRoomFrontOfRoomCallPanelsState to cache failed.")}return l}}};var py=n(42094),hy=n(670),vy=n(29204),Sy=n(8267);const fy={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientVirtualEventsVirtualEventActionQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"virtualEventAction"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},yy={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientVirtualEventsVirtualEventSchedulingFormDataQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"virtualEventSchedulingFormData"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasUnsavedChanges"}}]}}]}}]},ky={Query:{virtualEventAction(e,t,{cache:n,loggerFactory:i}){var a,o,r;try{return null!==(o=null===(a=n.readQuery({query:fy}))||void 0===a?void 0:a.virtualEventAction)&&void 0!==o?o:null}catch(e){const t=i.newLogger("virtual-event-action");return null===(r=t.errorToTelemetry)||void 0===r||r.call(t,"virtualEventAction: Failed to fetch virtual event action from cache.","virtual_event_form_action"),null}},virtualEventSchedulingFormData(e,t,{cache:n,loggerFactory:i}){var a,o,r;try{return null!==(o=null===(a=n.readQuery({query:yy}))||void 0===a?void 0:a.virtualEventSchedulingFormData)&&void 0!==o?o:null}catch(e){const t=i.newLogger("virtual-event-scheduling-form-data");return null===(r=t.errorToTelemetry)||void 0===r||r.call(t,"virtualEventSchedulingFormData: Failed to fetch virtual event scheduling form data from cache.","virtual_event_scheduling_form_data"),null}}},Mutation:{setVirtualEventAction(e,{input:{type:t}},{cache:n,loggerFactory:i}){var a;const o=i.newLogger("set-virtual-event-action");try{n.writeQuery({query:fy,data:{virtualEventAction:t}})}catch(e){return null===(a=o.errorToTelemetry)||void 0===a||a.call(o,"setVirtualEventStateAction: Failed to update virtual event action task in cache.","virtual_event_form_action"),null}return t},updateVirtualEventSchedulingFormData(e,{virtualEventSchedulingFormDataInput:t},{cache:n,loggerFactory:i}){var a,o;const r=i.newLogger("update-virtual-event-scheduling-form-data"),s={virtualEventSchedulingFormData:{__typename:"VirtualEventSchedulingFormData",hasUnsavedChanges:null!==(a=t.hasUnsavedChanges)&&void 0!==a&&a}};try{n.writeQuery({query:yy,data:s})}catch(e){return null===(o=r.errorToTelemetry)||void 0===o||o.call(r,"updateVirtualEventSchedulingFormData: Failed to update virtual event scheduling form data in cache.","virtual_event_scheduling_form_data"),null}return s.virtualEventSchedulingFormData}}};class Cy{constructor(){}static create(e){if(Cy._clientResolvers)throw new Error("ClientResolvers are already created");return Cy._clientResolvers=function(e){return(0,Z.merge)((0,cy.w)(),Hv.w,Yh,qh,(0,Vv.wf)(),function(){let e;const t=t=>i=>(a,o,r)=>(0,c.mG)(this,void 0,void 0,(function*(){if(!e){const{broadcastClientResolvers:t}=yield Promise.all([n.e(128),n.e(1789)]).then(n.bind(n,85482));e=t()}return e[t][i](a,o,r)}));return{Query:{broadcastLayout:t("Query")("broadcastLayout"),attendeeCaptionsVisibility:t("Query")("attendeeCaptionsVisibility")},Mutation:{setBroadcastActiveSectionSource:t("Mutation")("setBroadcastActiveSectionSource"),updateBroadcastLayout:t("Mutation")("updateBroadcastLayout"),selectBroadcastSection:t("Mutation")("selectBroadcastSection"),clearBroadcastSource:t("Mutation")("clearBroadcastSource"),createDebugBroadcast:t("Mutation")("createDebugBroadcast"),updateAttendeeCaptionsVisibility:t("Mutation")("updateAttendeeCaptionsVisibility")}}}(),function(e){let t;const i=i=>a=>(o,r,s)=>(0,c.mG)(this,void 0,void 0,(function*(){if(!t){const{clientResolvers:i}=yield Promise.all([n.e(128),n.e(1789)]).then(n.bind(n,85482));t=i(e)}return t[i][a](o,r,s)}));return{CallingIntent:{isFake:i("CallingIntent")("isFake")},CallLogParticipant:{hasDisplayName:i("CallLogParticipant")("hasDisplayName"),displayName:i("CallLogParticipant")("displayName")},Query:{whiteboardSharingSession:i("Query")("whiteboardSharingSession"),pptSharingSession:i("Query")("pptSharingSession"),bulkMoveStatus:i("Query")("bulkMoveStatus"),anonymousDisplayName:i("Query")("anonymousDisplayName"),prejoinState:i("Query")("prejoinState"),callingScreenStatus:i("Query")("callingScreenStatus"),callingScreenLayout:i("Query")("callingScreenLayout"),pinnedParticipantIds:i("Query")("pinnedParticipantIds"),videoScanType:i("Query")("videoScanType"),captionFontSize:i("Query")("captionFontSize"),debugVideoEffectState:i("Query")("debugVideoEffectState"),selectedBackgroundsInfo:i("Query")("selectedBackgroundsInfo"),getHardwareOutDevices:i("Query")("getHardwareOutDevices"),avatarInfo:i("Query")("avatarInfo"),selectedAvatarInfo:i("Query")("selectedAvatarInfo"),activeVideoEffects:i("Query")("activeVideoEffects"),videoEffectsCurrentInfo:i("Query")("videoEffectsCurrentInfo"),currentCallingState:i("Query")("currentCallingState"),compositorRegions:i("Query")("compositorRegions"),avatarAppAvailabilityInfo:i("Query")("avatarAppAvailabilityInfo")},Mutation:{moveRoomRetainedParticipants:i("Mutation")("moveRoomRetainedParticipants"),acceptStreamPermissionsDebug:i("Mutation")("acceptStreamPermissionsDebug"),sendToDebugHardwareOutDevice:i("Mutation")("sendToDebugHardwareOutDevice"),stopDebugHardwareOutDevice:i("Mutation")("stopDebugHardwareOutDevice"),setDebugSpeakerVolume:i("Mutation")("setDebugSpeakerVolume"),setDebugToolVisible:i("Mutation")("setDebugToolVisible"),updateMeetingRoomLayoutToggleState:i("Mutation")("updateMeetingRoomLayoutToggleState"),setDebugToolHiddenParticipantsCount:i("Mutation")("setDebugToolHiddenParticipantsCount"),setBulkMoveStatus:i("Mutation")("setBulkMoveStatus"),createDebugBreakoutRooms:i("Mutation")("createDebugBreakoutRooms"),createDebugCall:i("Mutation")("createDebugCall"),addDebugSuggestedUser:i("Mutation")("addDebugSuggestedUser"),joinDebugCallFromIntent:i("Mutation")("joinDebugCallFromIntent"),createDebugCallingIntent:i("Mutation")("createDebugCallingIntent"),createDebugConversation:i("Mutation")("createDebugConversation"),updateDebugCall:i("Mutation")("updateDebugCall"),stopDebugCall:i("Mutation")("stopDebugCall"),stopSpotlightSelfDebugCall:i("Mutation")("stopSpotlightSelfDebugCall"),updateDebugMeetingRoomRemoteSelectedLayoutChanged:i("Mutation")("updateDebugMeetingRoomRemoteSelectedLayoutChanged"),updateDebugSwapScreensButtonState:i("Mutation")("updateDebugSwapScreensButtonState"),toggleHoldDebugCall:i("Mutation")("toggleHoldDebugCall"),addDebugParticipant:i("Mutation")("addDebugParticipant"),createDebugParticipants:i("Mutation")("createDebugParticipants"),toggleDebugLocalMute:i("Mutation")("toggleDebugLocalMute"),startDebugRecording:i("Mutation")("startDebugRecording"),stopDebugRecording:i("Mutation")("stopDebugRecording"),setCallTranscriptStateDebug:i("Mutation")("setCallTranscriptStateDebug"),sendCallTranscriptEntryEventDebug:i("Mutation")("sendCallTranscriptEntryEventDebug"),sendClosedCaptionsEntryEventDebug:i("Mutation")("sendClosedCaptionsEntryEventDebug"),sendClosedCaptionsStatusEventDebug:i("Mutation")("sendClosedCaptionsStatusEventDebug"),removeDebugParticipant:i("Mutation")("removeDebugParticipant"),toggleDebugVideo:i("Mutation")("toggleDebugVideo"),toggleDebugScreenShare:i("Mutation")("toggleDebugScreenShare"),updateDebugParticipant:i("Mutation")("updateDebugParticipant"),updateDebugPinParticipantFromOutside:i("Mutation")("updateDebugPinParticipantFromOutside"),updateDebugCortanaToggleButton:i("Mutation")("updateDebugCortanaToggleButton"),updateDebugContentCameraSharing:i("Mutation")("updateDebugContentCameraSharing"),toggleDebugMuteSpeaker:i("Mutation")("toggleDebugMuteSpeaker"),updateDebugContentCameraState:i("Mutation")("updateDebugContentCameraState"),triggerDebugCallingScreenGalleryTypeChange:i("Mutation")("triggerDebugCallingScreenGalleryTypeChange"),toggleVoiceLevel:i("Mutation")("toggleVoiceLevel"),setDebugDevicesList:i("Mutation")("setDebugDevicesList"),setDebugCallingQualityFeedback:i("Mutation")("setDebugCallingQualityFeedback"),setAnonymousDisplayName:i("Mutation")("setAnonymousDisplayName"),setPrejoinState:i("Mutation")("setPrejoinState"),triggerSubscribedCallChangedDebugEvent:i("Mutation")("triggerSubscribedCallChangedDebugEvent"),updateMeetingBrandingInfoCache:i("Mutation")("updateMeetingBrandingInfoCache"),setAcceptStreamPermissionsDebugResponse:i("Mutation")("setAcceptStreamPermissionsDebugResponse"),setStreamPermissionsDebugAcknowledged:i("Mutation")("setStreamPermissionsDebugAcknowledged"),setStreamPermissionsDebugAcknowledgedRequired:i("Mutation")("setStreamPermissionsDebugAcknowledgedRequired"),setCallingScreenStatus:i("Mutation")("setCallingScreenStatus"),setCallingScreenLayout:i("Mutation")("setCallingScreenLayout"),setPinnedParticipantIds:i("Mutation")("setPinnedParticipantIds"),setVideoScanType:i("Mutation")("setVideoScanType"),updateCaptionFontSize:i("Mutation")("updateCaptionFontSize"),setDebugDeviceBlurringCapability:i("Mutation")("setDebugDeviceBlurringCapability"),setDebugVideoBackgroundImages:i("Mutation")("setDebugVideoBackgroundImages"),triggerBluetoothStateChangedDebugEvent:i("Mutation")("triggerBluetoothStateChangedDebugEvent"),triggerRaiseHandStateChangedEvent:i("Mutation")("triggerRaiseHandStateChangedEvent"),toggleDebugVideoEffect:i("Mutation")("toggleDebugVideoEffect"),updateMeetingLockDebug:i("Mutation")("updateMeetingLockDebug"),updateSelectedBackgroundsInfo:i("Mutation")("updateSelectedBackgroundsInfo"),setShouldReloadVideoApp:i("Mutation")("setShouldReloadVideoApp"),setShouldShowVideoApp:i("Mutation")("setShouldShowVideoApp"),setShouldShowVideoEffectsPreview:i("Mutation")("setShouldShowVideoEffectsPreview"),setShouldKeepPreviewWindowInSidePanelOpen:i("Mutation")("setShouldKeepPreviewWindowInSidePanelOpen"),setVideoAppPostMessageEvent:i("Mutation")("setVideoAppPostMessageEvent"),setAvatarAppPostMessageEvent:i("Mutation")("setAvatarAppPostMessageEvent"),setVideoNotification:i("Mutation")("setVideoNotification"),setAvatarErrorNotification:i("Mutation")("setAvatarErrorNotification"),setAvatarQuickPickerErrorNotification:i("Mutation")("setAvatarQuickPickerErrorNotification"),setShouldSetAvatarRendererTimeout:i("Mutation")("setShouldSetAvatarRendererTimeout"),setShouldRefreshVideoFilters:i("Mutation")("setShouldRefreshVideoFilters"),toggleParticipantPin:i("Mutation")("toggleParticipantPin"),setScaling:i("Mutation")("setScaling"),scalingModeUpdated:i("Mutation")("scalingModeUpdated"),toggleHideMyselfVideo:i("Mutation")("toggleHideMyselfVideo"),updateAvatarInfo:i("Mutation")("updateAvatarInfo"),updateSelectedAvatarInfo:i("Mutation")("updateSelectedAvatarInfo"),setLastSelectedCameraId:i("Mutation")("setLastSelectedCameraId"),setIsAvatarAppLoaded:i("Mutation")("setIsAvatarAppLoaded"),updateActiveVideoEffects:i("Mutation")("updateActiveVideoEffects"),updateVideoEffectsCurrentInfo:i("Mutation")("updateVideoEffectsCurrentInfo"),meetingDebugGoLive:i("Mutation")("meetingDebugGoLive"),setDebugStageRoomOutcome:i("Mutation")("setDebugStageRoomOutcome"),setShouldShowPopupPreview:i("Mutation")("setShouldShowPopupPreview"),setShouldAvatarMenuItemSelected:i("Mutation")("setShouldAvatarMenuItemSelected"),updateCallingState:i("Mutation")("updateCallingState"),setCompositorRegion:i("Mutation")("setCompositorRegion"),removeCompositorRegion:i("Mutation")("removeCompositorRegion"),setAvatarAppAvailabilityInfo:i("Mutation")("setAvatarAppAvailabilityInfo"),setIsAvatarMRULoaded:i("Mutation")("setIsAvatarMRULoaded"),setMeetingCollab:i("Mutation")("setMeetingCollab"),toggleMeetingCollab:i("Mutation")("toggleMeetingCollab")}}}(e),gy,dy(e),_p,$v.D,zv.w,Gv,ev,qv.s,py.s,Sy.s,ky,hy.w,vy.w)}(e),Cy._clientResolvers}static get clientResolvers(){return Cy._clientResolvers}}Cy._clientResolvers=null;class by extends up{constructor(e,t,n,i,a){var o;super(e,t,n({windowId:i.windowId,entityType:i.entityType,viewportContext:i.windowProvider.viewportContext,name:`mtma-user-${(null===(o=null==i?void 0:i.authenticationUser)||void 0===o?void 0:o.id)||"nouser"}-${i.windowId}`,storeType:a}),i,i.windowId,a)}get parentQueries(){return Mg}get parentSubscriptions(){return Og}get parentMutations(){return Rg}get className(){return"MTMAWindowDataClient"}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:this.parent.__UNSAFE_getApolloClientReferencesForDebugPanel().self,selfIsMainClient:!1}}clone(e){throw new Error("Trying to clone child instance")}}class Ty extends dp{constructor(e,t,n,i){super(e,n,t({windowId:n.windowId||_.ew,entityType:n.entityType,viewportContext:n.windowProvider.viewportContext,name:"mtma-core",storeType:Kg.t.mtmaCore}),n.windowId||_.ew,Kg.t.mtmaCore),this.createApolloClient=t,this.viewSchemaClient=null,i&&(this.viewSchemaClient=i({windowId:n.windowId||_.ew,entityType:n.entityType,viewportContext:n.windowProvider.viewportContext,name:"core-viewSchema",storeType:Kg.t.viewSchema}),this.registerClient(this.viewSchemaClient))}clone(e){return e.windowId===_.ew?new gp(this.getServices(),this.client,Object.assign(Object.assign({},this.ctx),e),this.storeType):new by(this.getServices(),this,this.createApolloClient,Object.assign(Object.assign({},this.ctx),e),Kg.t.mtmaWindow)}cloneForViewSchema(e){return hp(this.viewSchemaClient,"View schema must be avaliable"),new pp(this.getServices(),this.viewSchemaClient,Object.assign(Object.assign({},this.ctx),e),Kg.t.viewSchema)}disposeClients(e){const t=Object.create(null,{disposeClients:{get:()=>super.disposeClients}});return(0,c.mG)(this,void 0,void 0,(function*(){yield Promise.all([t.disposeClients.call(this,e),(()=>(0,c.mG)(this,void 0,void 0,(function*(){this.viewSchemaClient&&(yield this.disposeClient(this.viewSchemaClient,e),e&&(this.viewSchemaClient=null))})))()])}))}}class wy extends up{constructor(e,t,n,i,a){var o;super(e,t,n({windowId:i.windowId||_.ew,entityType:i.entityType,viewportContext:i.windowProvider.viewportContext,name:`mtma-user-${(null===(o=null==i?void 0:i.authenticationUser)||void 0===o?void 0:o.id)||"nouser"}-${i.windowId}`,storeType:Kg.t.mtmaUser}),i,i.windowId||_.ew,Kg.t.mtmaUser),this.createApolloClient=n,this.viewSchemaClient=null,a&&(this.viewSchemaClient=a({windowId:i.windowId||_.ew,entityType:i.entityType,viewportContext:i.windowProvider.viewportContext,name:"core-viewSchema",storeType:Kg.t.viewSchema}),this.registerClient(this.viewSchemaClient))}get parentQueries(){return Pg}get parentSubscriptions(){return xg}get parentMutations(){return jg}get className(){return"MTMAUserDataClient"}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:this.parent.__UNSAFE_getApolloClientReferencesForDebugPanel().self,selfIsMainClient:!1}}clone(e){return e.windowId===_.ew?new gp(this.getServices(),this.client,Object.assign(Object.assign({},this.ctx),e),this.storeType):new by(this.getServices(),this,this.createApolloClient,Object.assign(Object.assign({},this.ctx),e),Kg.t.mtmaWindow)}cloneForViewSchema(e){return hp(this.viewSchemaClient,"View schema must be available"),new pp(this.getServices(),this.viewSchemaClient,Object.assign(Object.assign({},this.ctx),e),Kg.t.viewSchema)}disposeClients(e){const t=Object.create(null,{disposeClients:{get:()=>super.disposeClients}});return(0,c.mG)(this,void 0,void 0,(function*(){yield Promise.all([t.disposeClients.call(this,e),(()=>(0,c.mG)(this,void 0,void 0,(function*(){this.viewSchemaClient&&(yield this.disposeClient(this.viewSchemaClient,e),e&&(this.viewSchemaClient=null))})))()])}))}}class _y{constructor(){this._cache=new Map,this.getOrCreateServiceInstance=(e,t)=>{let n;return this._cache.has(e)?n=this._cache.get(e):(n=t(),this._cache.set(e,n)),n},this.clear=()=>{this._cache.clear()}}}const Iy=new _y,Ay=Iy.getOrCreateServiceInstance;var Ny,Ey;!function(e){e.AddressService="AddressService",e.AiInsightsFeedbackService="AiInsightsFeedbackService",e.AiInsightsSdsService="AiInsightsSdsService",e.AppBasedLinkService="AppBasedLinkService",e.AppSuggestionsService="AppSuggestionsService",e.AppsPlatformService="AppsPlatformService",e.AsyncMediaService="AsyncMediaService",e.AtpSafelinksService="AtpSafelinksService",e.AzureMapsService="AzureMapsService",e.BadgeCountService="BadgeCountService",e.BiometricEnrollmentService="BiometricEnrollmentService",e.BiometricFaceEnrollmentService="BiometricFaceEnrollmentService",e.BotsPlatformService="BotsPlatformService",e.BrbService="BrbService",e.BreakoutRoomsService="BreakoutRoomsService",e.BroadcastAttendeeService="BroadcastAttendeeService",e.BroadcastStreamingAttendeeService="BroadcastStreamingAttendeeService",e.BroadcastCaptionsService="BroadcastCaptionsService",e.BroadcastSignalRService="BroadcastSignalRService",e.CalendarService="CalendarService",e.CallBlockingService="CallBlockingService",e.CallingAdapterServices="CallingAdapterServices",e.CallingAppEventsService="CallingAppEventsService",e.CallingAnonymousDisplayNameService="CallingAnonymousDisplayNameService",e.CallingBannerServiceAdapter="CallingBannerServiceAdapter",e.CallingDialogServiceAdapter="CallingDialogServiceAdapter",e.CallingNotificationServiceAdapter="CallingNotificationServiceAdapter",e.CallingService="CallingService",e.CallRecordingService="CallRecordingService",e.ChatService="ChatService",e.ChatServiceEndpointProvider="ChatServiceEndpointProvider",e.CloudStorageFoldersService="CloudStorageFoldersService",e.CmdMeetingIntelligenceService="CmdMeetingIntelligenceService",e.CollabCloudService="CollabCloudService",e.CollabObjectService="CollabObjectService",e.MeetingCatchupService="MeetingCatchupService",e.CommonSubstrateService="CommonSubstrateService",e.ConnectedAccountsService="ConnectedAccountsService",e.ConnectedCalendarSettingsService="ConnectedCalendarSettingsService",e.ConsumerGroupsService="ConsumerGroupsService",e.CSAService="CSAService",e.DeveloperSwitchersService="DeveloperSwitchersService",e.DistributionListService="DistributionListService",e.DynamicsMarketingService="DynamicsMarketingService",e.DynamicsVirtualEventsService="DynamicsVirtualEventsService",e.EmoticonService="EmoticonService",e.EspService="EspService",e.ExampleService="ExampleService",e.ExternalAccountsService="ExternalAccountsService",e.DiscoverSurfaceService="DiscoverSurfaceService",e.DiscoverSurfaceFeedbackService="DiscoverSurfaceFeedbackService",e.ExternalAccountsResponseService="ExternalAccountsResponseService",e.ExternalCalendarEmailAddressService="ExternalCalendarEmailAddressService",e.FilesBackfillThreadPropertiesService="FilesBackfillThreadPropertiesService",e.FilesRedeemService="FilesRedeemService",e.FilesReferenceService="FilesReferenceService",e.FilesValidDomainsService="FilesValidDomainsService",e.FilesSharepointUrlService="FilesSharepointUrlService",e.FileUploadPreviewService="FileUploadPreviewService",e.FileUploadService="FileUploadService",e.FileDownloadManagerService="FileDownloadManagerService",e.FluidService="FluidService",e.GalleryService="GalleryService",e.GiphyService="GiphyService",e.GoogleCalendarAuthenticationService="GoogleCalendarAuthenticationService",e.GoogleContactsAuthenticationService="GoogleContactsAuthenticationService",e.GuardiansService="GuardiansService",e.ImageProxyService="ImageProxyService",e.ImportMsaContactsService="ImportMsaContactsService",e.ImplicitContactsService="ImplicitContactsService",e.InstantAnswersService="InstantAnswersService",e.ItemDeleteService="ItemDeleteService",e.ItemDetailsService="ItemDetailsService",e.DriveItemShareService="DriveItemShareService",e.ItemUploadService="ItemUploadService",e.InviteLinksService="InviteLinksService",e.LiveStateBroadcastService="LiveStateBroadcastService",e.LiveStreamRenderingService="LiveStreamRenderingService",e.LmsIntegrationService="LmsIntegrationService",e.LockedTeamsService="LockedTeamsService",e.LogsFilesService="LogsFilesService",e.LokiMetaPreviewService="LokiMetaPreviewService",e.LokiService="LokiService",e.ManageTenantService="ManageTenantService",e.MeetForWorkService="MeetForWorkService",e.MeetingArtifactsService="MeetingArtifactsService",e.MeetingBotService="MeetingBotService",e.MeetingIntelligenceService="MeetingIntelligenceService",e.MeetingOptionsClientDataService="MeetingOptionsClientDataService",e.MeetingOptionsService="MeetingOptionsService",e.MeetingQuestionsAndAnswersService="MeetingQuestionsAndAnswersService",e.MeetingRecapService="MeetingRecapService",e.MeetingRecapSwaService="MeetingRecapSwaService",e.MeetingTemplateService="MeetingTemplateService",e.MeshSessionService="MeshSessionService",e.MonetizationService="MonetizationService",e.MRUItemService="MRUItemService",e.MsaAuthenticationService="MsaAuthenticationService",e.OdcFilePreviewService="OdcFilePreviewService",e.OdsService="OdcService",e.OSearchService="OSearchService",e.PaymentsService="PaymentsService",e.PeoplePickerService="PeoplePickerService",e.PeopleSearchService="PeopleSearchService",e.PeopleService="PeopleService",e.PeopleTargetingService="PeopleTargetingService",e.PersonalFileDetailsService="PersonalFileDetailsService",e.PetrolService="PetrolService",e.FloodgateService="FloodgateService",e.PoliciesService="PoliciesService",e.PresenceService="PresenceService",e.PstnService="PstnService",e.RefreshSiteUrlService="RefreshSiteUrlService",e.ReportConcernService="ReportConcernService",e.SCISService="SCISService",e.SearchPrefetchService="SearchPrefetchService",e.SensitivityLabelPolicySettingsService="SensitivityLabelPolicySettingsService",e.SharepointRestClient="SharepointRestClient",e.SharepointShareService="SharepointShareService",e.ShareService="ShareService",e.SignalsService="SignalsService",e.SmbUserIntentService="SmbUserIntentService",e.StatefulLongPoll="StatefulLongPoll",e.StoreService="StoreService",e.SubstrateFilesSearchService="SubstrateFilesSearchService",e.SubstrateMeetingRecommendationsService="SubstrateMeetingRecommendationsService",e.SubstrateMeetingSearchService="SubstrateMeetingSearchService",e.SubstrateMeetingSummarySearchService="SubstrateMeetingSummarySearchService",e.SubstrateRecommendationsService="SubstrateRecommendationsService",e.SubstrateSearchService="SubstrateSearchService",e.SubstrateSuggestionsService="SubstrateSuggestionsService",e.TargetingHierarchyService="TargetingHierarchyService",e.TeamCalendarService="TeamCalendarService",e.TeamsAndChannelsService="TeamsAndChannelsService",e.TenantMembershipService="TenantMembershipService",e.TenantService="TenantService",e.TenantAnalyticsService="TenantAnalyticsService",e.TFLUserService="TFLUserService",e.ThirdPartyCalendarService="ThirdPartyCalendarService",e.ToastImageService="ToastImageService",e.TpnNoticeService="TpnNoticeService",e.TranscriptFeedbackService="TranscriptFeedbackService",e.TranscriptSettingsStoreService="TranscriptSettingsStoreService",e.TranscriptService="TranscriptService",e.TranslateService="TranslateService",e.UnifiedConsentService="UnifiedConsentService",e.UrlPreviewService="UrlPreviewService",e.UserLicenseService="UserLicenseService",e.UserProfileService="UserProfileService",e.VideoFileService="VideoFileService",e.VirtualEventsService="VirtualEventsService",e.VoicemailService="VoicemailService",e.WebinarService="WebinarService"}(Ny||(Ny={})),function(e){e.ExampleGlobalService="ExampleGlobalService",e.GlobalCallingService="GlobalCallingService"}(Ey||(Ey={}));const Dy=(e,t)=>n=>(0,cd.mT)(e,t,n),Fy=()=>Promise.all([n.e(46),n.e(3309),n.e(2492),n.e(7675),n.e(9614),n.e(128),n.e(4508),n.e(2052),n.e(6702)]).then(n.bind(n,79611)),Py=Dy((()=>Promise.all([n.e(9480),n.e(5108)]).then(n.bind(n,42527))),"services-app-based-link"),My=Dy((()=>n.e(5203).then(n.bind(n,79291))),"services-apps-platform"),jy=Dy((()=>n.e(3885).then(n.bind(n,15194))),"services-app-suggestions"),Ry=Dy((()=>n.e(1494).then(n.bind(n,40869))),"services-atp-safelinks"),xy=Dy((()=>n.e(1401).then(n.bind(n,31344))),"services-async-media"),Oy=Dy((()=>Promise.all([n.e(6738),n.e(7927)]).then(n.bind(n,6095))),"services-azure-maps"),Ly=Dy((()=>Promise.all([n.e(9491),n.e(6255)]).then(n.bind(n,54033))),"services-biometric-enrollment"),Uy=Dy((()=>Promise.all([n.e(7624),n.e(672)]).then(n.bind(n,90943))),"services-bots-platform"),By=Dy((()=>n.e(60).then(n.bind(n,49272))),"services-brb"),Wy=Dy((()=>Promise.all([n.e(4508),n.e(1846)]).then(n.bind(n,11775))),"services-breakout-rooms"),Gy=Dy((()=>n.e(1710).then(n.bind(n,28909))),"services-transcript"),Vy=Dy((()=>n.e(9211).then(n.bind(n,85070))),"services-transcript-setting-store"),Hy=Dy((()=>n.e(1710).then(n.bind(n,28909))),"services-transcript-feedback"),$y=Dy((()=>n.e(1028).then(n.bind(n,92272))),"services-ai-insights-feedback"),zy=Dy((()=>n.e(1028).then(n.bind(n,92272))),"services-ai-insights-sds"),qy=Dy((()=>n.e(3685).then(n.bind(n,69062))),"services-broadcast-attendee"),Jy=Dy((()=>n.e(188).then(n.bind(n,46104))),"services-broadcast-streaming-attendee"),Qy=Dy((()=>n.e(8560).then(n.bind(n,22922))),"services-broadcast-captions"),Ky=Dy((()=>Promise.all([n.e(4924),n.e(2549)]).then(n.bind(n,60698))),"services-broadcast-signalr"),Yy=Dy((()=>Promise.all([n.e(3309),n.e(9287),n.e(6937),n.e(3376)]).then(n.bind(n,46508))),"services-io-calendar"),Xy=Dy((()=>n.e(4692).then(n.bind(n,99173))),"services-chat-endpoint-provider"),Zy=Dy((()=>n.e(7209).then(n.bind(n,94451))),"services-chat"),ek=Dy((()=>n.e(6808).then(n.bind(n,47318))),"services-report-concern"),tk=(Dy((()=>Promise.all([n.e(46),n.e(3309),n.e(2492),n.e(7675),n.e(9614),n.e(128),n.e(4508),n.e(2052),n.e(5925)]).then(n.bind(n,70132))),"services-calling"),Dy((()=>n.e(3740).then(n.bind(n,61038))),"services-cmd-meeting-intelligence")),nk=Dy((()=>n.e(6737).then(n.bind(n,14965))),"services-collab-object"),ik=Dy((()=>n.e(1480).then(n.bind(n,72072))),"services-meeting-catchup"),ak=Dy((()=>n.e(2034).then(n.bind(n,50052))),"services-connected-accounts"),ok=Dy((()=>n.e(675).then(n.bind(n,1141))),"services-io-connected-calendar"),rk=Dy((()=>n.e(923).then(n.bind(n,52981))),"services-distribution-list"),sk=Dy((()=>n.e(5794).then(n.bind(n,82357))),"services-dynamics-marketing"),lk=Dy((()=>n.e(6652).then(n.bind(n,27206))),"services-dynamics-virtual-events"),dk=Dy((()=>n.e(8832).then(n.bind(n,9807))),"services-emoticon"),ck=Dy((()=>n.e(1174).then(n.bind(n,51546))),"services-esp"),uk=Dy((()=>n.e(9081).then(n.bind(n,88897))),"services-external-accounts"),mk=Dy((()=>n.e(5430).then(n.bind(n,28172))),"services-external-accounts-response"),gk=Dy((()=>n.e(9197).then(n.bind(n,96142))),"services-external-calendar-email-address"),pk=Dy((()=>n.e(3137).then(n.bind(n,72663))),"services-files"),hk=Dy((()=>n.e(2121).then(n.bind(n,46790))),"services-file-upload"),vk=Dy((()=>n.e(2653).then(n.bind(n,10248))),"services-file-download-manager"),Sk=Dy((()=>n.e(1425).then(n.bind(n,46516))),"services-fluid"),fk=Dy((()=>n.e(3806).then(n.bind(n,21906))),"services-giphy"),yk=Dy((()=>n.e(4248).then(n.bind(n,93465))),"services-gallery"),kk=Dy((()=>n.e(3483).then(n.bind(n,18333))),"services-google-calendar-authentication"),Ck=Dy((()=>n.e(3483).then(n.bind(n,18333))),"services-google-contacts-authentication"),bk=Dy((()=>n.e(7480).then(n.bind(n,3464))),"services-image-proxy"),Tk=Dy((()=>n.e(972).then(n.bind(n,60321))),"services-import-msa-contacts"),wk=Dy((()=>n.e(7965).then(n.bind(n,65088))),"services-instant-answers"),_k=Dy((()=>n.e(3088).then(n.bind(n,16471))),"services-invite-links"),Ik=Dy((()=>Promise.all([n.e(5310),n.e(6965),n.e(6978)]).then(n.bind(n,18833))),"services-live-state-broadcast"),Ak=Dy((()=>Promise.all([n.e(591),n.e(4776),n.e(128),n.e(4866),n.e(4408)]).then(n.bind(n,35054))),"services-live-stream-renderer"),Nk=Dy((()=>n.e(2581).then(n.bind(n,12648))),"services-lms-integration"),Ek=Dy((()=>n.e(8475).then(n.bind(n,16981))),"services-tenant-analytics"),Dk=Dy((()=>n.e(9829).then(n.bind(n,82280))),"services-loki"),Fk=Dy((()=>n.e(6934).then(n.bind(n,25703))),"services-discover-surface"),Pk=Dy((()=>n.e(4964).then(n.bind(n,51813))),"services-discover-surface-feedback"),Mk=Dy((()=>n.e(3998).then(n.bind(n,48937))),"services-guardians"),jk=Dy((()=>n.e(1074).then(n.bind(n,30680))),"services-locked-teams"),Rk=Dy((()=>n.e(8975).then(n.bind(n,57496))),"services-logs-files"),xk=Dy((()=>n.e(2066).then(n.bind(n,12999))),"services-manage-tenant"),Ok=Dy((()=>Promise.all([n.e(3309),n.e(7675),n.e(4634),n.e(9287),n.e(8573),n.e(1440)]).then(n.bind(n,75097))),"services-meet-for-work"),Lk=Dy((()=>Promise.all([n.e(9402),n.e(5626)]).then(n.bind(n,14013))),"services-meeting-artifacts"),Uk=Dy((()=>n.e(4945).then(n.bind(n,43186))),"services-meeting-intelligence"),Bk=Dy((()=>n.e(4251).then(n.bind(n,13534))),"services-meeting-recap"),Wk=Dy((()=>n.e(516).then(n.bind(n,20758))),"services-meeting-options"),Gk=Dy((()=>n.e(9880).then(n.bind(n,16605))),"services-meeting-recap-swa"),Vk=Dy((()=>n.e(8137).then(n.bind(n,78554))),"services-meeting-templates"),Hk=Dy((()=>n.e(5459).then(n.bind(n,66660))),"services-mesh-session"),$k=Dy((()=>n.e(7346).then(n.bind(n,68877))),"services-msa-authentication"),zk=Dy((()=>n.e(6151).then(n.bind(n,84368))),"services-people"),qk=Dy((()=>n.e(6313).then(n.bind(n,46058))),"services-people-picker"),Jk=Dy((()=>n.e(4165).then(n.bind(n,45778))),"services-people-targeting"),Qk=Dy((()=>n.e(718).then(n.bind(n,21814))),"services-files-personal"),Kk=Dy((()=>n.e(4988).then(n.bind(n,55966))),"services-example"),Yk=Dy((()=>n.e(2461).then(n.bind(n,85252))),"services-petrol"),Xk=Dy((()=>Promise.all([n.e(3747),n.e(4166)]).then(n.bind(n,48664))),"services-floodgate"),Zk=Dy((()=>n.e(3607).then(n.bind(n,77560))),"services-ods"),eC=Dy((()=>n.e(4609).then(n.bind(n,28206))),"services-policies"),tC=Dy((()=>n.e(6130).then(n.bind(n,10603))),"services-presence"),nC=Dy((()=>Promise.all([n.e(3309),n.e(3363)]).then(n.bind(n,37319))),"scis-service"),iC=Dy((()=>Promise.all([n.e(3309),n.e(1968),n.e(3414),n.e(3742),n.e(9506)]).then(n.bind(n,9643))),"services-search"),aC=Dy((()=>Promise.all([n.e(1968),n.e(2842)]).then(n.bind(n,83540))),"services-search-meeting-summary"),oC=Dy((()=>Promise.all([n.e(1968),n.e(9161)]).then(n.bind(n,8912))),"search-substrate"),rC=Dy((()=>n.e(2078).then(n.bind(n,72062))),"services-substrate-meeting-recommendations"),sC=Dy((()=>Promise.all([n.e(1968),n.e(1129)]).then(n.bind(n,18191))),"services-substrate-recommendations"),lC=Dy((()=>n.e(4574).then(n.bind(n,78276))),"services-sharepoint-client"),dC=Dy((()=>n.e(288).then(n.bind(n,33892))),"services-sharepoint-share"),cC=Dy((()=>n.e(5793).then(n.bind(n,90959))),"services-share"),uC=Dy((()=>n.e(2876).then(n.bind(n,86458))),"services-signals"),mC=Dy((()=>n.e(3473).then(n.bind(n,17545))),"services-smb-user-intent"),gC=Dy((()=>Promise.all([n.e(1796),n.e(9098)]).then(n.bind(n,83296))),"services-store"),pC=Dy((()=>Promise.all([n.e(1968),n.e(3414),n.e(8431)]).then(n.bind(n,25642))),"services-suggestions"),hC=Dy((()=>Promise.all([n.e(3414),n.e(4949)]).then(n.bind(n,72321))),"services-implicit-contacts"),vC=Dy((()=>n.e(4801).then(n.bind(n,85539))),"services-targeting-hierarchy"),SC=Dy((()=>n.e(2437).then(n.bind(n,88168))),"services-tenant-membership"),fC=Dy((()=>n.e(2557).then(n.bind(n,24569))),"services-tenant-service"),yC=Dy((()=>n.e(7412).then(n.bind(n,32258))),"services-third-party-calendar"),kC=Dy((()=>n.e(8340).then(n.bind(n,44114))),"services-toast-image"),CC=(Dy((()=>n.e(1309).then(n.bind(n,89963))),"services-teams-and-channels"),Dy((()=>n.e(6014).then(n.bind(n,39953))),"services-translate")),bC=Dy((()=>n.e(6408).then(n.bind(n,69915))),"services-tpn-notice"),TC=Dy((()=>n.e(9613).then(n.bind(n,43657))),"unified-consent-state"),wC=Dy((()=>Promise.all([n.e(9480),n.e(4826)]).then(n.bind(n,35370))),"services-url-preview"),_C=Dy((()=>n.e(3549).then(n.bind(n,29483))),"services-user-profile"),IC=Dy((()=>n.e(1172).then(n.bind(n,68802))),"services-voicemail"),AC=Dy((()=>n.e(8693).then(n.bind(n,40955))),"services-item-crud"),NC=Dy((()=>n.e(1792).then(n.bind(n,20395))),"services-webinar"),EC=Dy((()=>Promise.all([n.e(3309),n.e(9287),n.e(8573),n.e(5502)]).then(n.bind(n,30351))),"services-meeting-bot"),DC=Dy((()=>n.e(9961).then(n.bind(n,92864))),"services-virtual-events"),FC=Dy((()=>n.e(4621).then(n.bind(n,66281))),"services-developer-switchers"),PC=Dy((()=>n.e(8053).then(n.bind(n,85564))),"services-search-prefetch"),MC=Dy((()=>n.e(8105).then(n.bind(n,1733))),"services-call-recording"),jC=Dy((()=>n.e(9616).then(n.bind(n,34566))),"services-user-license"),RC=Dy((()=>n.e(6049).then(n.bind(n,81517))),"services-payment"),xC=Dy((()=>n.e(7341).then(n.bind(n,98763))),"services-monetization"),OC=Dy((()=>n.e(7264).then(n.bind(n,80498))),"services-mru"),LC=Dy((()=>n.e(1035).then(n.bind(n,36620))),"services-collab-cloud"),UC=Dy((()=>n.e(5402).then(n.bind(n,37321))),"tfl-user-service"),BC=Dy((()=>n.e(2042).then(n.bind(n,18339))),"services-sensitivity-label-policy-settings"),WC=Dy((()=>n.e(3548).then(n.bind(n,87476))),"services-meeting-questions-and-answers"),GC=e=>()=>e.userServicesCache(Ny.AsyncMediaService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{send:t,gtmRegistry:n,discover:i,coreSettings:a,loggerFactory:o,scenarioFactory:r}=e,{AsyncMediaService:s}=yield xy(r);return new s(t,n,i,a,o,r)})))(e))),VC=e=>()=>e.userServicesCache(Ny.SharepointRestClient,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,platformService:n,scenarioFactory:i}=e,{SharepointRestClient:a}=yield lC(i);return new a(t,n)})))(e))),HC=(e,t)=>()=>e.userServicesCache(Ny.BotsPlatformService,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:n,scenarioFactory:i,gtmRegistry:a,send:o,discover:r,platformService:s,i18n:l}=e,d=yield t(),{BotsPlatformService:c}=yield Uy(i);return new c(n,d,a.bind(o,E.Pn.middleTier),r,i,s,l)})))(e,t))),$C=e=>()=>e.userServicesCache(Ny.ConnectedAccountsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{discover:t,gtmRegistry:n,platformService:i,scenarioFactory:a,send:o,coreSettings:r}=e,{ConnectedAccountsService:s}=yield ak(a);return new s(t,n,i,a,r,o)})))(e))),zC=e=>()=>e.userServicesCache(Ny.GoogleCalendarAuthenticationService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n,windowProvider:i,scenarioFactory:a,platformService:o}=e,{GoogleCalendarAuthenticationService:r}=yield kk(a);return new r(i,t,n,a,o)})))(e))),qC=e=>()=>e.userServicesCache(Ny.GoogleContactsAuthenticationService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n,windowProvider:i,scenarioFactory:a,platformService:o}=e,{GoogleContactsAuthenticationService:r}=yield Ck(a);return new r(i,t,n,a,o)})))(e))),JC=e=>()=>e.userServicesCache(Ny.MsaAuthenticationService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:n,windowProvider:i}=e,{MsaAuthenticationService:a}=yield $k(n);return new a(t,n,i)})))(e))),QC=(e,t,n,i)=>()=>e.userServicesCache(Ny.ExternalAccountsService,(()=>((e,t,n,i)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:a,scenarioFactory:o,authenticationService:r,platformService:s}=e,l=yield t(),d=yield n(),c=yield i(),{ExternalAccountsService:u}=yield uk(o);return new u(a,r,l,d,c,o,s)})))(e,t,n,i))),KC=(e,t,n)=>()=>e.userServicesCache(Ny.ThirdPartyCalendarService,(()=>((e,t,n)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:i,scenarioFactory:a,authenticationService:o,localStorage:r}=e,s=yield t(),l=yield n(),{ThirdPartyCalendarService:d}=yield yC(a);return new d(i,o,s,l,a,r)})))(e,t,n)));var YC=n(90660);const XC=e=>()=>e.userServicesCache(Ny.CallingAppEventsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:n,windowProvider:i}=e,{ObservableFactory:a}=yield Fy(),o=new a;return new YC.n(t,o,n,i)})))(e))),ZC=e=>()=>e.userServicesCache(Ny.DiscoverSurfaceService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:n,endpointsManager:i}=e,{DiscoverSurfaceService:a}=yield Fk(n);return new a(t,i,n)})))(e))),eb=e=>()=>e.userServicesCache(Ny.UserLicenseService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{discover:t,endpointsManager:n,loggerFactory:i,scenarioFactory:a}=e,{UserLicenseService:o}=yield jC(a);return new o(t,n,i,a)})))(e))),tb=(e,t)=>()=>e.userServicesCache(Ny.SmbUserIntentService,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{endpointsManager:n,loggerFactory:i,scenarioFactory:a,localStorage:o,windowProvider:r}=e,s=yield t(),{SmbUserIntentService:l}=yield mC(a);return new l(i,n,o,s,r,a)})))(e,t))),nb=e=>()=>{var t;const{coreSettings:n}=e;if(!(null===(t=null==n?void 0:n.get(A.J.CMDMeetingArtifactsService))||void 0===t?void 0:t.enableCMDMeetingArtifactsService))throw new Error("FF enableCMDMeetingArtifactsService is disabled");return e.userServicesCache(Ny.CollabObjectService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{send:t,coreSettings:n,loggerFactory:i,endpointsManager:a,scenarioFactory:o,discover:r}=e,{CollabObjectService:s}=yield nk(o);return new s(t,n,i,a,r)})))(e)))},ib=e=>()=>e.userServicesCache(Ny.AiInsightsFeedbackService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,loggerFactory:i}=e,{AiInsightsFeedbackService:a}=yield $y(t);return new a(n,i,t)})))(e))),ab=e=>()=>e.userServicesCache(Ny.AiInsightsSdsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,loggerFactory:i}=e,{AiInsightsSdsService:a}=yield zy(t);return new a(n,i,t)})))(e))),ob=(e,t)=>()=>e.userServicesCache(Ny.AppBasedLinkService,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:n,scenarioFactory:i,loggerFactory:a}=e,{AppBasedLinkService:o}=yield Py(i);return new o(n,yield t(),i,a)})))(e,t))),rb=e=>()=>e.userServicesCache(Ny.AppsPlatformService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,coreSettings:n,endpointsManager:i,localStorage:a,authenticationService:o}=e,{enableMetaOsSdkIntegration:r}=n.get(A.J.Extensibility),{AppsPlatformService:s,AppsPlatformServiceMetaOS:l}=yield My(t);return r?new l(n,i,t,o):new s(n,i,a)})))(e))),sb=e=>()=>e.userServicesCache(Ny.AppSuggestionsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,coreSettings:i,loggerFactory:a,windowProvider:o}=e,{AppSuggestionsService:r}=yield jy(t);return new r(i,n,a,o)})))(e))),lb=e=>()=>e.userServicesCache(Ny.AzureMapsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,i18NextWrapper:n,scenarioFactory:i,coreSettings:a}=e,{AzureMapsService:o}=yield Oy(i);return new o(t,a,n)})))(e))),db=e=>()=>e.userServicesCache(Ny.BadgeCountService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:t,config:n,discover:i,platformService:a,scenarioFactory:o}=e,{BadgeCountService:r}=yield Zy(o);return new r(a,t,i,n)})))(e))),cb=e=>()=>e.userServicesCache(Ny.BrbService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,coreSettings:i,logsCollectorService:a,authenticationService:o,platformService:r,discover:s,hostCommunicationService:l,endpointsManager:d,authenticationUser:c,i18n:u}=e,{BrbService:m}=yield By(t);return new m(n,i,a,o,r,s,l,d,t,u,c)})))(e))),ub=e=>()=>e.userServicesCache(Ny.BreakoutRoomsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{BreakoutRoomsService:i}=yield Wy(t);return new i(n)})))(e))),mb=e=>()=>e.userServicesCache(Ny.AtpSafelinksService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,gtmRegistry:i,loggerFactory:a,scenarioFactory:o,localStorage:r,send:s}=e,{AtpSafelinksService:l}=yield Ry(o);return new l(i.bind(s,E.Pn.middleTier),t,n,o,a,r)})))(e))),gb=e=>()=>e.userServicesCache(Ny.BroadcastAttendeeService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,coreSettings:n,loggerFactory:i,scenarioFactory:a,windowProvider:o}=e,{BroadcastAttendeeService:r}=yield qy(a);return new r(t,i,a,o,n)})))(e))),pb=e=>()=>e.userServicesCache(Ny.BroadcastStreamingAttendeeService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n}=e,{BroadcastStreamingAttendeeService:i}=yield Jy(n);return new i(t)})))(e))),hb=e=>()=>e.userServicesCache(Ny.BroadcastCaptionsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:t,send:n,endpointsManager:i,scenarioFactory:a,windowProvider:o,loggerFactory:r}=e,{BroadcastCaptionsService:s}=yield Qy(a);return new s(o,r,a,t,n,i)})))(e))),vb=e=>()=>e.userServicesCache(Ny.BroadcastSignalRService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,endpointsManager:i,windowProvider:a}=e,{BroadcastSignalRService:o}=yield Ky(t);return new o(n,i,t,a)})))(e)));var Sb=n(2308);const fb=(e,t)=>n=>{t({payload:n,pubsub:e})},yb=e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:i,gtmRegistry:a,loggerFactory:o,pubsub:r,send:s,windowProvider:l}=e,{CallBlockingService:d}=yield n.e(7417).then(n.bind(n,49720));return new d(t,i,a.bind(s,E.Pn.middleTier),o.newLogger("CallBlockingService"),l,fb(r,kb))})),kb=({payload:e,pubsub:t})=>{t.publish(Sb.oo,e.newBlockedMris)};class Cb{constructor(){this._displayName=null,this.getDisplayName=()=>this._displayName,this.setDisplayName=e=>{this._displayName=e}}}const bb=e=>()=>e.userServicesCache(Ny.CallingAnonymousDisplayNameService,(()=>(0,c.mG)(void 0,void 0,void 0,(function*(){return new Cb}))));var Tb=n(57775);const wb=(e,t)=>()=>e.userServicesCache(Ny.CallingBannerServiceAdapter,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,i18n:i}=e,a=yield t();return new Tb.Y(n,a,i)})))(e,t)));var _b=n(19352);const Ib=(e,t)=>()=>e.userServicesCache(Ny.CallingDialogServiceAdapter,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{loggerFactory:n}=e,i=yield t();return new _b.l(n,i)})))(e,t)));var Ab=n(3157);const Nb=(e,t)=>()=>e.userServicesCache(Ny.CallingNotificationServiceAdapter,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,coreSettings:i}=e,a=yield t();return new Ab.L(n,i,a)})))(e,t))),Eb=e=>()=>e.userServicesCache(Ny.CmdMeetingIntelligenceService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{CmdMeetingIntelligenceService:i}=yield tk(t);return new i(n)})))(e))),Db=e=>()=>{var t;const{coreSettings:n}=e;if(!(null===(t=null==n?void 0:n.get(A.J.MeetingCatchupService))||void 0===t?void 0:t.enableMeetingCatchupService))throw new Error("FF enableMeetingCatchupService is disabled");return e.userServicesCache(Ny.MeetingCatchupService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n}=e,{MeetingCatchupService:i}=yield ik(n);return new i(t)})))(e)))},Fb=e=>()=>e.userServicesCache(Ny.ConnectedCalendarSettingsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:t,scenarioFactory:n,endpointsManager:i}=e,{ConnectedCalendarSettingsService:a}=yield ok(n);return new a(n,t,i)})))(e))),Pb=e=>()=>{const{coreSettings:t}=e,{enableCMDServiceForTokenRetriveAndVoiceSignatureStore:n}=t.get(A.J.BiometricEnrollment),{isCMDSvcEnabledForBiometricStorage:i}=t.get(A.J.Host);return n||i?e.userServicesCache(Ny.BiometricEnrollmentService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{send:t,authenticationService:n,coreSettings:i,loggerFactory:a,platformService:o,scenarioFactory:r,i18n:s}=e,{VoiceBiometricEnrollmentService:l}=yield Ly(r);return new l(t,n,i,a,o,s)})))(e))):e.userServicesCache(Ny.BiometricEnrollmentService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{discover:t,gtmRegistry:n,loggerFactory:i,platformService:a,scenarioFactory:o,send:r,coreSettings:s,i18n:l}=e,{BiometricEnrollmentService:d}=yield Ly(o);return new d(t,n,i,a,r,s,l)})))(e)))},Mb=e=>()=>e.userServicesCache(Ny.BiometricFaceEnrollmentService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{send:t,authenticationService:n,coreSettings:i,loggerFactory:a,platformService:o,scenarioFactory:r}=e,{BiometricFaceEnrollmentService:s}=yield Ly(r);return new s(t,n,i,a,o)})))(e))),jb=e=>()=>e.userServicesCache(Ny.DeveloperSwitchersService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,rebootService:n,windowProvider:i,loggerFactory:a,config:o}=e,{DeveloperSwitchersService:r}=yield FC(t);return new r(n,i,a.newLogger("DeveloperSwitchersService"),o)})))(e))),Rb=e=>()=>e.userServicesCache(Ny.DistributionListService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n,loggerFactory:i,coreSettings:a,scenarioFactory:o}=e,{DistributionListService:r}=yield rk(o);return new r(i,t.bind(n,E.Pn.middleTier),a)})))(e))),xb=e=>()=>e.userServicesCache(Ny.DynamicsMarketingService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,send:i,scenarioFactory:a}=e,{DynamicsMarketingService:o}=yield sk(a);return new o(t,n,i)})))(e))),Ob=e=>()=>e.userServicesCache(Ny.DynamicsVirtualEventsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,send:i,i18NextWrapper:a,scenarioFactory:o,loggerFactory:r,discover:s}=e,{DynamicsVirtualEventsService:l}=yield lk(o);return new l(t,n,i,a,r,s)})))(e))),Lb=(e,t)=>()=>e.userServicesCache(Ny.EmoticonService,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,localStorage:i,scenarioFactory:a,coreSettings:o,i18n:r}=e,{EmoticonService:s}=yield dk(a),l=new s(yield t(),r.locale,i,o,n.newLogger("EmoticonService"),a,r);return yield l.isInitialized,l})))(e,t))),Ub=e=>()=>e.userServicesCache(Ny.EspService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n}=e,{EspService:i}=yield ck(n);return new i(t)})))(e))),Bb=e=>()=>e.userServicesCache(Ny.ExampleService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{ExampleService:n}=yield Kk(t);return new n})))(e))),Wb=(e,t)=>()=>e.userServicesCache(Ny.ExternalAccountsResponseService,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:n,scenarioFactory:i}=e,a=yield t(),{ExternalAccountsResponseService:o}=yield mk(i);return new o(n,a,i)})))(e,t))),Gb=e=>()=>e.userServicesCache(Ny.FluidService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,scenarioFactory:i}=e,{FluidService:a}=yield Sk(i);return new a(t,n)})))(e))),Vb=e=>()=>e.userServicesCache(Ny.GalleryService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:t,discover:n,send:i,scenarioFactory:a}=e,{GalleryService:o}=yield yk(a);return new o(i,t,n,a)})))(e))),Hb=e=>()=>e.userServicesCache(Ny.GiphyService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:t,gtmRegistry:n,endpointsManager:i,send:a,scenarioFactory:o,i18n:r}=e,{GiphyService:s}=yield fk(o);return new s(n.bind(a,E.Pn.middleTier),t,r.locale,i)})))(e))),$b=e=>()=>e.userServicesCache(Ny.GuardiansService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:n,send:i,scenarioFactory:a,loggerFactory:o}=e,{GuardiansService:r}=yield Mk(a);return new r(t,o,n,i)})))(e))),zb=e=>()=>e.userServicesCache(Ny.ImageProxyService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:t,gtmRegistry:n,send:i,scenarioFactory:a}=e,{ImageProxyService:o}=yield bk(a);return new o(n,i,t)})))(e))),qb=(e,t)=>()=>t.userServicesCache(Ny.ImportMsaContactsService,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:n,endpointsManager:i,scenarioFactory:a}=t,{ImportMsaContactsService:o}=yield Tk(a);return new o(yield e(),n,i,a)})))(e,t))),Jb=e=>()=>e.userServicesCache(Ny.ImplicitContactsService,(()=>(({discover:e,gtmRegistry:t,send:n,scenarioFactory:i})=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{ImplicitContactsService:a}=yield hC(i);return new a(n,e,t,i)})))(e))),Qb=e=>()=>e.userServicesCache(Ny.InstantAnswersService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:t,send:n,scenarioFactory:i,loggerFactory:a,i18n:o}=e,{InstantAnswersService:r}=yield wk(i);return new r(a,i,t,n,o)})))(e))),Kb=e=>()=>e.userServicesCache(Ny.InviteLinksService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{InviteLinksService:i}=yield _k(t);return new i(n)})))(e))),Yb=e=>()=>e.userServicesCache(Ny.LiveStateBroadcastService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{pubsub:t,scenarioFactory:n,loggerFactory:i,coreSettings:a,authenticationService:o,platformService:r,discover:s}=e,{LiveStateBroadcastService:l}=yield Ik(n);return new l(t,i,a,o,r,n,s)})))(e))),Xb=e=>()=>e.userServicesCache(Ny.LiveStreamRenderingService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,discover:n,send:i,scenarioFactory:a,loggerFactory:o,pubsub:r,platformService:s,clientState:l,coreSettings:d,endpointsManager:c,networkState:u}=e,{LiveStreamRenderingService:m}=yield Ak(a),{ACSCallingAuthenticationServiceAdapter:g,CallingAuthenticationServiceAdapter:p}=yield Fy(),h=yield t.getUser();return new m(o,d.get(A.J.Calling).enableACSEmbed?new g(n,h,o):new p(t,n,h,o),s,l,r,i,d,a,c,u)})))(e))),Zb=e=>()=>e.userServicesCache(Ny.LmsIntegrationService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:n,send:i,scenarioFactory:a}=e,{LmsIntegrationService:o}=yield Nk(a);return new o(t,n,i)})))(e))),eT=e=>()=>e.userServicesCache(Ny.LockedTeamsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:n,send:i,scenarioFactory:a}=e,{LockedTeamsService:o}=yield jk(a);return new o(t,n,i)})))(e))),tT=e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,logsCollectorService:i,coreSettings:a}=e,{LogsFilesService:o}=yield Rk(t);return new o(n,i,a)})),nT=e=>()=>e.userServicesCache(Ny.LogsFilesService,(()=>tT(e))),iT=e=>()=>e.userServicesCache(Ny.LokiService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,platformService:n,scenarioFactory:i,coreSettings:a}=e,{LokiService:o}=yield Dk(i);return new o(n,t,a)})))(e))),aT=e=>()=>e.userServicesCache(Ny.ManageTenantService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{discover:t,endpointsManager:n,loggerFactory:i,scenarioFactory:a}=e,{ManageTenantService:o}=yield xk(a);return new o(t,i,a,n)})))(e))),oT=(e,t,n)=>()=>{if(!e.coreSettings.get(A.J.Meet).enableMeetForWork)throw new Error("enableMeetForWork flag is disabled");return e.userServicesCache(Ny.MeetForWorkService,(()=>((e,t,n)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:i,authenticationService:a,authenticationUser:o,loggerFactory:r,cmdApolloClient:s,coreSettings:l,pubsub:d,endpointsManager:c}=e,{MeetForWorkService:u}=yield Ok(i),m=yield t(),{enableCMDMeetingArtifactsService:g}=l.get(A.J.CMDMeetingArtifactsService);return new u(a,m,g?yield n():void 0,s,o,i,l,d,r,c)})))(e,t,n)))},rT=e=>()=>e.userServicesCache(Ny.MeetingArtifactsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,coreSettings:i,scenarioFactory:a,i18n:o,loggerFactory:r}=e,{MeetingArtifactsService:s}=yield Lk(a);return new s(n,t,i,o,r,a)})))(e))),sT=(e,t,n)=>()=>{var i;const{coreSettings:a}=e;if(!(null===(i=null==a?void 0:a.get(A.J.MeetingBot))||void 0===i?void 0:i.enableMeetingBot))throw new Error("enableMeetingBot flag is disabled");return e.userServicesCache(Ny.MeetingBotService,(()=>((e,t,n)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:i,cmdApolloClient:a,authenticationService:o,coreSettings:r,loggerFactory:s,localStorage:l,platformService:d,windowProvider:c,entityCommanding:u,i18n:m,authenticationUser:g}=e,{MeetingBotService:p}=yield EC(i);return new p(o,yield t(),r,yield n(),s,i,c,l,d,a,u,m,g)})))(e,t,n)))},lT=e=>()=>e.userServicesCache(Ny.MeetingIntelligenceService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{MeetingIntelligenceService:i}=yield Uk(t);return new i(n)})))(e))),dT=e=>()=>e.userServicesCache(Ny.PeopleService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n,scenarioFactory:i,endpointsManager:a,coreSettings:o}=e,{PeopleService:r}=yield zk(i);return new r(t.bind(n,E.Pn.middleTier),o,a)})))(e))),cT=e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{windowProvider:t,coreSettings:i,scenarioFactory:a,loggerFactory:o}=e,{MeetingOptionsClientDataService:r}=yield n.e(516).then(n.bind(n,73794)),s=dT(e);return new r(t,yield s(),i,a,o)})),uT=e=>()=>e.userServicesCache(Ny.MeetingOptionsClientDataService,(()=>cT(e))),mT=e=>()=>e.userServicesCache(Ny.MeetingOptionsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,scenarioFactory:i,coreSettings:a,gtmRegistry:o,discover:r,loggerFactory:s}=e,{MeetingOptionsService:l}=yield Wk(i);return new l(t,n,i,a,o,r,s)})))(e))),gT=e=>()=>e.userServicesCache(Ny.MeetingQuestionsAndAnswersService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:n,endpointsManager:i}=e,{MeetingQuestionsAndAnswersService:a}=yield WC(n);return new a(i,t,n)})))(e))),pT=e=>()=>e.userServicesCache(Ny.MeetingRecapService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{MeetingRecapService:i}=yield Bk(t);return new i(n)})))(e))),hT=e=>()=>e.userServicesCache(Ny.MeetingRecapSwaService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{send:t,scenarioFactory:n,authenticationService:i}=e,{MeetingRecapSwaService:a}=yield Gk(n);return new a(i,t)})))(e))),vT=e=>()=>e.userServicesCache(Ny.MeetingTemplateService,(()=>(({scenarioFactory:e,send:t,authenticationService:n,coreSettings:i,discover:a,loggerFactory:o})=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{MeetingTemplateService:r}=yield Vk(e);return new r(t,n,i,e,a,o)})))(e))),ST=e=>()=>e.userServicesCache(Ny.MeshSessionService,(()=>(({authenticationService:e,loggerFactory:t,scenarioFactory:n,send:i})=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{MeshSessionService:a}=yield Hk(n);return new a(e,t,i)})))(e))),fT=e=>()=>e.userServicesCache(Ny.PaymentsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,i18n:o,loggerFactory:r}=e,{PaymentService:s}=yield RC(t);return new s(n,i,a,r,t,o)})))(e)));var yT=n(10792);const kT=e=>()=>e.userServicesCache(Ny.PeoplePickerService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n,scenarioFactory:i,endpointsManager:a,coreSettings:o}=e,{PeoplePickerService:r}=yield qk(i);return new r((0,yT.Y)(t.bind(n,E.Pn.middleTier),o,a))})))(e))),CT=e=>()=>e.userServicesCache(Ny.PeopleTargetingService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,loggerFactory:n,send:i,coreSettings:a,scenarioFactory:o,discover:r}=e,{PeopleTargetingService:s}=yield Jk(o);return new s(t,n,i,a,r)})))(e))),bT=e=>()=>e.userServicesCache(Ny.PoliciesService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:t,endpointsManager:n,loggerFactory:i,networkState:a,scenarioFactory:o}=e,{PoliciesService:r}=yield eC(o);return new r(n,t,i,a,o)})))(e))),TT=e=>()=>e.userServicesCache(Ny.PresenceService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,pubsub:n,send:i,scenarioFactory:a,platformService:o,config:r}=e,{PresenceService:s}=yield tC(a);return new s(t.bind(i,E.Pn.unifiedPresence),n,o,r)})))(e))),wT=e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:i,loggerFactory:a}=e,{AddressService:o}=yield n.e(1836).then(n.bind(n,81223));return new o(t.bind(i,E.Pn.middleTier),a)})),_T=e=>()=>e.userServicesCache(Ny.AddressService,(()=>wT(e))),IT=e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:i}=e,{PstnService:a}=yield n.e(3393).then(n.bind(n,67280));return new a(t.bind(i,E.Pn.middleTier))})),AT=e=>()=>e.userServicesCache(Ny.PstnService,(()=>IT(e))),NT=e=>()=>e.userServicesCache(Ny.SCISService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{send:t,authenticationService:n,platformService:i,scenarioFactory:a,loggerFactory:o}=e,{SCISService:r}=yield nC(a);return new r(t,n,i,a,o)})))(e))),ET=e=>()=>e.userServicesCache(Ny.SearchPrefetchService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,authenticationService:i}=e,{SearchPrefetchService:a}=yield PC(t);return new a(i,n)})))(e))),DT=e=>()=>e.userServicesCache(Ny.ShareService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:t,discover:n,gtmRegistry:i,scenarioFactory:a,send:o,i18n:r}=e,{ShareService:s}=yield cC(a);return new s(t,n,i,o,r)})))(e))),FT=e=>()=>e.userServicesCache(Ny.StoreService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,gtmRegistry:i,localStorage:a,coreSettings:o,authenticationService:r,platformService:s,endpointsManager:l,windowProvider:d,i18n:c}=e,{StoreService:u}=yield gC(t);return new u(t,n,i,a,o,r,s,l,d,c)})))(e))),PT=e=>()=>e.userServicesCache(Ny.TenantMembershipService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{TenantMembershipService:i}=yield SC(t);return new i(t,n)})))(e))),MT=e=>()=>e.userServicesCache(Ny.TenantService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{TenantService:i}=yield fC(t);return new i(t,n)})))(e))),jT=e=>()=>e.userServicesCache(Ny.TenantAnalyticsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n,loggerFactory:i}=e,{TenantAnalyticsService:a}=yield Ek(n);return new a(i,t)})))(e))),RT=e=>()=>e.userServicesCache(Ny.TranscriptService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,coreSettings:i,loggerFactory:a}=e,{TranscriptService:o}=yield Gy(t);return new o(n,a,t,i)})))(e))),xT=e=>()=>e.userServicesCache(Ny.TranscriptFeedbackService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{TranscriptFeedbackService:n}=yield Hy(t);return new n})))(e))),OT=e=>()=>e.userServicesCache(Ny.TranscriptSettingsStoreService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,authenticationUser:i}=e,{SettingsStoreService:a}=yield Vy(t);return new a(n,i)})))(e))),LT=e=>()=>e.userServicesCache(Ny.TranslateService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,endpointsManager:n,coreSettings:i,scenarioFactory:a,send:o}=e,{TranslateService:r}=yield CC(a);return new r(t.bind(o,E.Pn.middleTier),a,i,n)})))(e))),UT=e=>()=>e.userServicesCache(Ny.TargetingHierarchyService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,discover:i,loggerFactory:a,scenarioFactory:o,send:r}=e,{TargetingHierarchyService:s}=yield vC(o);return new s(t,a,r,n,i)})))(e))),BT=e=>()=>e.userServicesCache(Ny.ToastImageService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{ToastImageService:i}=yield kC(t);return new i(n)})))(e)));var WT=n(10994);const GT=e=>()=>e.userServicesCache(Ny.TeamsAndChannelsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{endpointsManager:t}=e;return new WT.K(t)})))(e))),VT=e=>()=>e.userServicesCache(Ny.TpnNoticeService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{send:t,platformService:n,scenarioFactory:i}=e,{TpnNoticeService:a}=yield bC(i);return new a(t,n)})))(e))),HT=(e,t)=>()=>e.userServicesCache(Ny.UrlPreviewService,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{gtmRegistry:n,endpointsManager:i,send:a,coreSettings:o,scenarioFactory:r}=e,{UrlPreviewService:s}=yield wC(r);return new s(n,a,o,yield t(),i,r)})))(e,t))),$T=e=>()=>e.userServicesCache(Ny.UserProfileService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n,scenarioFactory:i,coreSettings:a}=e,{UserProfileService:o}=yield _C(i);return new o(n,t,a)})))(e))),zT=e=>()=>e.userServicesCache(Ny.VirtualEventsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,discover:o,loggerFactory:r}=e,{VirtualEventsService:s,MockVirtualEventsService:l}=yield DC(t);return a.get(A.J.VirtualEvents).forceUseMockAPIs?new l:new s(n,i,a,o,r)})))(e)));var qT=n(58741);const JT=({payload:e,pubsub:t})=>{t.publish(qT.Gq,e)},QT=e=>()=>e.userServicesCache(Ny.VoicemailService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,loggerFactory:i,scenarioFactory:a,pubsub:o,send:r,windowProvider:s}=e,{VoicemailService:l}=yield IC(a);return new l(t,n,r,i,s,fb(o,JT))})))(e))),KT=e=>()=>e.userServicesCache(Ny.WebinarService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,discover:o,i18n:r,loggerFactory:s}=e,{WebinarService:l}=yield NC(t);return new l(n,i,a,s,t,r,o)})))(e))),YT=e=>()=>e.userServicesCache(Ny.CallRecordingService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,endpointsManager:i}=e,{CallRecordingService:a}=yield MC(t);return new a(n,i)})))(e))),XT=e=>()=>e.userServicesCache(Ny.MonetizationService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,scenarioFactory:i,loggerFactory:a,discover:o,coreSettings:r,localStorage:s}=e,{MonetizationService:l}=yield xC(i);return new l(t,n,a,o,r,s)})))(e))),ZT=e=>()=>e.userServicesCache(Ny.MRUItemService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,scenarioFactory:i}=e,{MRUService:a}=yield OC(i);return new a(t,n)})))(e))),ew=(e,t)=>()=>e.userServicesCache(Ny.DiscoverSurfaceFeedbackService,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n,windowProvider:i}=e,{DiscoverSurfaceFeedbackService:a}=yield Pk(n);return new a(yield t(),i)})))(e,t))),tw=e=>()=>{var t;const{coreSettings:n}=e;if(!(null===(t=null==n?void 0:n.get(A.J.Extensibility))||void 0===t?void 0:t.enableCollabCloudApis))throw new Error("enableCollabCloudApis flag is disabled");return e.userServicesCache(Ny.CollabCloudService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{CollabCloudService:i}=yield LC(t);return new i(n)})))(e)))},nw=e=>()=>e.userServicesCache(Ny.TFLUserService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,localStorage:i,loggerFactory:a}=e,{TFLUserService:o}=yield UC(t);return new o(a,i,n)})))(e))),iw=e=>()=>e.userServicesCache(Ny.SensitivityLabelPolicySettingsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:t,discover:n,gtmRegistry:i,loggerFactory:a,scenarioFactory:o,send:r}=e,{SensitivityLabelPolicySettingsService:s}=yield BC(o);return new s(t,i,r,n,a.newLogger("SensitivityLabelPolicySettingsService"))})))(e))),aw=(e,t,n)=>()=>e.userServicesCache(Ny.PetrolService,(()=>((e,t,n)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{platformService:i,authenticationService:a,coreSettings:o,send:r,scenarioFactory:s,loggerFactory:l,hostCommunicationService:d,i18n:c}=e,{PetrolService:u}=yield Yk(s);return new u(a,s,l,i,o,r,yield t(),yield n(),d,c)})))(e,t,n))),ow=(e,t)=>()=>e.userServicesCache(Ny.FloodgateService,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,scenarioFactory:i,coreSettings:a,clientState:o,i18NextWrapper:r,windowProvider:s,platformService:l,authenticationUser:d}=e,c=yield t(),{FloodGateService:u}=yield Xk(i);return new u(n,i,o,a,c,r,l,s,d)})))(e,t))),rw=(e,t,n)=>()=>e.userServicesCache(Ny.OdsService,(()=>((e,t,n)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:i,scenarioFactory:a,loggerFactory:o,endpointsManager:r,logsCollectorService:s,coreSettings:l,platformService:d,hostCommunicationService:c,i18n:u}=e,{OdsService:m}=yield Zk(a);return new m(i,o,r,s,l,d,yield t(),c,yield n(),u)})))(e,t,n))),sw=e=>()=>e.userServicesCache(Ny.LokiMetaPreviewService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,loggerFactory:i,scenarioFactory:a}=e,{LokiMetaPreviewService:o}=yield iC(a);return new o(n,t,i)})))(e))),lw=e=>()=>e.userServicesCache(Ny.OdcFilePreviewService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,loggerFactory:i,scenarioFactory:a}=e,{OdcFilePreviewService:o}=yield iC(a);return new o(n,t,i)})))(e))),dw=e=>()=>e.userServicesCache(Ny.OSearchService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{send:t,discover:n,loggerFactory:i,scenarioFactory:a,coreSettings:o,endpointsManager:r}=e,{OSearchService:s}=yield iC(a);return new s(t,r,n,i,o)})))(e))),cw=e=>()=>e.userServicesCache(Ny.PeopleSearchService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{send:t,endpointsManager:n,gtmRegistry:i,loggerFactory:a,scenarioFactory:o,discover:r,coreSettings:s}=e,{PeopleSearchService:l}=yield iC(o);return new l(i.bind(t,E.Pn.middleTier),n,a,r,s)})))(e))),uw=e=>()=>e.userServicesCache(Ny.SubstrateFilesSearchService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,platformService:i,loggerFactory:a,scenarioFactory:o,i18n:r}=e,{SubstrateFilesSearchService:s}=yield iC(o);return new s(n,t,i,o,a,r)})))(e))),mw=e=>()=>e.userServicesCache(Ny.SubstrateRecommendationsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n}=e,{SubstrateRecommendationsService:i}=yield sC(n);return new i(t)})))(e))),gw=e=>()=>e.userServicesCache(Ny.SubstrateSearchService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,loggerFactory:i,platformService:a,scenarioFactory:o,windowProvider:r,coreSettings:s,endpointsManager:l,i18n:d}=e,{SubstrateSearchService:c}=yield iC(o);return new c(n,t,a,o,i,r,s,l,d)})))(e))),pw=e=>()=>e.userServicesCache(Ny.SubstrateSuggestionsService,(()=>(({authenticationService:e,endpointsManager:t,coreSettings:n,discover:i,gtmRegistry:a,send:o,scenarioFactory:r,platformService:s})=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{SubstrateSuggestionsService:l}=yield pC(r);return new l(o,t,e,n,i,a,s)})))(e))),hw=e=>()=>e.userServicesCache(Ny.SubstrateMeetingSearchService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,loggerFactory:i,platformService:a,scenarioFactory:o}=e,{SubstrateMeetingSearchService:r}=yield iC(o);return new r(n,t,a,o,i)})))(e))),vw=e=>()=>e.userServicesCache(Ny.SubstrateMeetingSummarySearchService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,loggerFactory:n,platformService:i,scenarioFactory:a,coreSettings:o,endpointsManager:r}=e,{SubstrateMeetingSummarySearchService:s}=yield aC(a);return new s(t,i,a,n,o,r)})))(e))),Sw=e=>()=>e.userServicesCache(Ny.ChatService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,endpointsManager:n,platformService:i,coreSettings:a,send:o,scenarioFactory:r}=e,{ChatService:s}=yield Zy(r);return new s(t.bind(o,E.Pn.chatService),a,i,n)})))(e))),fw=(e,t)=>()=>e.userServicesCache(Ny.ChatServiceEndpointProvider,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n}=e,i=yield t(),{ChatServiceEndpointProvider:a}=yield Xy(n);return new a(i,n)})))(e,t))),yw=e=>()=>e.userServicesCache(Ny.ConsumerGroupsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:t,scenarioFactory:n,endpointsManager:i,loggerFactory:a}=e,{ConsumerGroupsService:o}=yield Zy(n);return new o(i,a,n,t)})))(e))),kw=e=>()=>e.userServicesCache(Ny.CSAService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,platformService:n,coreSettings:i,scenarioFactory:a,discover:o,endpointsManager:r,config:s,send:l}=e,{createCSAService:d}=yield Zy(a);return d(t,n,i,o,l,r,s)})))(e))),Cw=e=>()=>e.userServicesCache(Ny.StatefulLongPoll,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{StatefulLongPoll:n}=yield Zy(t);return new n})))(e))),bw=e=>()=>e.userServicesCache(Ny.ReportConcernService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,gtmRegistry:i,platformService:a}=e,{ReportConcernService:o}=yield ek(t);return new o(i.bind(n,E.Pn.middleTier),a)})))(e))),Tw=(e,t)=>()=>e.userServicesCache(Ny.SharepointShareService,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:n,loggerFactory:i,send:a,scenarioFactory:o,authenticationService:r}=e,{SharepointShareService:s}=yield dC(o);return new s(a,i,n,yield t(),r)})))(e,t))),ww=(e,t)=>()=>e.userServicesCache(Ny.FilesRedeemService,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{endpointsManager:n,coreSettings:i,loggerFactory:a,send:o,scenarioFactory:r}=e,{FilesRedeemService:s}=yield dC(r);return new s(o,n,a,i,yield t())})))(e,t))),_w=(e,t,n)=>()=>n.userServicesCache(Ny.FilesSharepointUrlService,(()=>((e,t,n)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:i,coreSettings:a}=n,{FilesSharepointUrlService:o}=yield dC(i);return new o(yield e(),yield t(),a)})))(e,t,n))),Iw=(e,t)=>()=>t.userServicesCache(Ny.FilesReferenceService,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n}=t,{FilesReferenceService:i}=yield pk(n);return new i(yield e())})))(e,t))),Aw=(e,t)=>()=>e.userServicesCache(Ny.FileUploadPreviewService,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,scenarioFactory:i}=e,{FileUploadPreviewService:a}=yield hk(i);return new a(yield t(),n)})))(e,t))),Nw=(e,t)=>()=>e.userServicesCache(Ny.FileUploadService,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,scenarioFactory:i,coreSettings:a}=e,{FileUploadService:o}=yield hk(i);return new o(yield t(),a,n)})))(e,t))),Ew=e=>()=>e.userServicesCache(Ny.FileDownloadManagerService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n}=e,{FileDownloadManagerService:i}=yield vk(t);return new i(n.newLogger("fileDownloadManagerService"))})))(e))),Dw=(e,t)=>()=>e.userServicesCache(Ny.PersonalFileDetailsService,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{discover:n,gtmRegistry:i,loggerFactory:a,scenarioFactory:o,send:r}=e,s=yield t(),{PersonalFileDetailsService:l}=yield Qk(o),d=new bs.q(n);return new l(s,o,a,i.bind(d.authorize(r,"x-skypetoken"),E.Pn.middleTier))})))(e,t))),Fw=e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:i,discover:a}=e,{RefreshSiteUrlService:o}=yield n.e(6545).then(n.bind(n,28678));return new o(t,a,i)})),Pw=e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:i,loggerFactory:a,send:o}=e,{CloudStorageFoldersService:r}=yield Promise.all([n.e(46),n.e(128),n.e(4125)]).then(n.bind(n,50859));return new r(t,i,a,o)})),Mw=e=>()=>e.userServicesCache(Ny.CloudStorageFoldersService,(()=>Pw(e))),jw=e=>()=>e.userServicesCache(Ny.FilesBackfillThreadPropertiesService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{discover:t,gtmRegistry:n,scenarioFactory:i,loggerFactory:a,send:o}=e,{FilesBackfillThreadPropertiesService:r}=yield pk(i),s=new bs.q(t);return new r(a,n.bind(s.authorize(o,"x-skypetoken"),E.Pn.middleTier))})))(e))),Rw=(e,t=ys.l)=>(n,i=kl.hO.BEARER)=>{var a,o;return n?null!==(o=null===(a=e.authorizeV2)||void 0===a?void 0:a.call(e,t,n,{scheme:i}))&&void 0!==o?o:e.authorize(t,n):t},xw=(e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n,authenticationService:i,loggerFactory:a,coreSettings:o}=t,r=Ow(o),s=Lw(o,r)||"",l=Uw(o,r)||"",d=Rw(i),{ItemUploadService:c,ItemDeleteService:u,ItemDetailsService:m}=yield AC(n),g=a.newLogger(e);switch(e){case Ny.ItemUploadService:return new c(d,r,s,l,g);case Ny.ItemDeleteService:return new u(d,r,g);case Ny.ItemDetailsService:return new m(d,r,g,o);default:return}})),Ow=e=>!!e.get(A.J.Files).preferGraphOverVroom,Lw=(e,t)=>t?e.get(A.J.Files).graphEndpointBaseUrl:e.get(A.J.Files).vroomEndpointBaseUrl,Uw=(e,t)=>t?e.get(A.J.Files).graphAuthScope:e.get(A.J.Files).vroomAuthScope,Bw=e=>()=>e.userServicesCache(Ny.ItemUploadService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){return yield xw(Ny.ItemUploadService,e)})))(e))),Ww=e=>()=>e.userServicesCache(Ny.ItemDeleteService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){return yield xw(Ny.ItemDeleteService,e)})))(e))),Gw=e=>()=>e.userServicesCache(Ny.ItemDetailsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){return yield xw(Ny.ItemDetailsService,e)})))(e))),Vw=e=>()=>e.userServicesCache(Ny.DriveItemShareService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{DriveItemShareService:n}=yield dC(t),{authenticationService:i,coreSettings:a}=e,o=Ow(a);return new n(Rw(i),o)})))(e))),Hw=(e,t)=>()=>e.userServicesCache(Ny.VideoFileService,(()=>((e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{coreSettings:n,loggerFactory:i,send:a,scenarioFactory:o}=e,{VideoFileService:r}=yield dC(o);return new r(a,i,n,yield t())})))(e,t))),$w=e=>()=>e.userServicesCache(Ny.FilesValidDomainsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n,loggerFactory:i}=e,{FilesValidDomainsService:a}=yield pk(n);return new a(t,i)})))(e))),zw=e=>()=>e.userServicesCache(Ny.CalendarService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,discover:o,loggerFactory:r,platformService:s,i18n:l}=e,{CalendarService:d}=yield Yy(t);return new d(n,i,o,a,r,s,l)})))(e))),qw=e=>()=>e.userServicesCache(Ny.ExternalCalendarEmailAddressService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{ExternalCalendarEmailAddressService:i}=yield gk(t);return new i(n)})))(e))),Jw=e=>()=>e.userServicesCache(Ny.TeamCalendarService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,discover:o,loggerFactory:r,platformService:s,i18n:l}=e,{TeamCalendarService:d}=yield Yy(t);return new d(n,i,o,a,r,s,l)})))(e))),Qw=e=>()=>e.userServicesCache(Ny.SubstrateMeetingRecommendationsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,loggerFactory:a}=e,{SubstrateMeetingRecommendationsService:o}=yield rC(t);return new o(n,i,a)})))(e))),Kw=e=>()=>e.userServicesCache(Ny.CommonSubstrateService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,platformService:i,authenticationService:a,endpointsManager:o,windowProvider:r,coreSettings:s}=e,{CommonSubstrateService:l}=yield oC(t);return new l(r,n,a,i,s,o)})))(e))),Yw=e=>()=>e.userServicesCache(Ny.SignalsService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,config:n,coreSettings:i,scenarioFactory:a,send:o}=e;if(!n)throw new Error("config not set on IUserServicesFactoryContext");const{SignalsService:r}=yield uC(a);return new r(t,i,o,n)})))(e))),Xw=e=>()=>e.globalServicesCache(Ey.ExampleGlobalService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{ExampleService:n}=yield Kk(t);return new n})))(e))),Zw=e=>()=>e.globalServicesCache(Ey.GlobalCallingService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{GlobalCallingService:t}=yield Promise.all([n.e(46),n.e(3309),n.e(2492),n.e(7675),n.e(9614),n.e(128),n.e(4508),n.e(2052),n.e(5925)]).then(n.bind(n,70132));return new t(e)})))(e))),e_=e=>()=>e.userServicesCache(Ny.CallingAdapterServices,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:t,cmdApolloClient:n,coreSettings:i,discover:a,i18NextWrapper:o,localStorage:r,loggerFactory:s,scenarioFactory:l,send:d,windowProvider:c,networkState:u,endpointsManager:m,hostCommunicationService:g,cacheStorage:p}=e,{ACSCallingAuthenticationServiceAdapter:h,AdminSettingsStore:v,AnalyticsService:S,CallingAuthenticationServiceAdapter:f,AggregatedSettingsStoreService:y,AppStateServiceImplementation:k,AriaLiveService:C,AtMentionServiceImplementation:b,AttendanceReportService:T,BatteryStatusService:w,BrbV2FeedbackService:_,CallingHttpAdapterService:I,CallingIdentityAdapterService:N,CallingPeopleServiceAdapter:E,CallingLoggingService:D,CallingMultiWindowService:F,CallingPolicyStore:P,CallParkPolicyStore:M,CallingStorageService:j,CallingLayoutAdapterService:R,CallingTenantServiceAdapter:x,CallStateService:O,ChannelServiceAdapter:L,ChatServiceClientAdapter:U,ChatServiceUtils:B,ClientDatabaseService:W,ConversationsAsyncServiceAdapter:G,ConversationsLocalStoreAdapter:V,ConversationsServiceAdapter:H,ConversationsStoreAdapter:$,loadDataCompressor:z,DataManagerAdapter:q,DeepLinkProviderAdapter:J,DesktopUtilityService:Q,DiagnosticsService:K,DistributionListServiceImplementation:Y,ECSProvider:X,ElectronIpcService:Z,EventingServiceAdapter:ee,ExceptionUtilityService:te,ExperienceContainerFeatureService:ne,FilesNotificationService:ie,FreemiumUtilities:ae,GeoRoutingService:oe,HybridContentVisibilityManager:re,LocalizationService:se,MeetingPolicySettingsStore:le,MessagingPolicySettingsStore:de,MessageFetchServiceImplementation:ce,MessageServiceAdapter:ue,MessagingTelemetryService:me,MsGraphRestClient:ge,MTMASubscriptionUtility:pe,MyUserPreferencesStore:he,initNativeRenderingHelper:ve,customVideoBackgroundServiceHelpers:Se,deviceManagerServiceHelpers:fe,NavigationService:ye,NetworkDetectorService:ke,Observable:Ce,ObservableFactory:be,OfficeIntegrationFirstRunAdapter:Te,OnlineDialinConferencingPolicyStore:we,PaywallService:_e,PhoneNumberUtil:Ie,PlatformDetectServiceAdapter:Ae,PerfStatsNotifierService:Ne,PolicySettingsStore:Ee,ProfilePictureLoaderService:De,ResourceManagerService:Fe,RetryService:Pe,SfbFirstRunServiceAdapter:Me,SfbTeamsUpgradeService:je,SkypeConversationLocalUtilsAdapter:Re,StaticUtils:xe,SXConfig:Oe,SyntheticAutomatedCallPolicySettingsStore:Le,TeamsMeetingBrandingPolicySettingsStore:Ue,TeamsEnhancedEncryptionPolicySettingsStore:Be,TeamsEmergencyCallingPolicySettingsStore:We,TeamsEmergencyCallRoutingPolicySettingsStore:Ge,TelemetryProvider:Ve,TenantPrivacyProfileService:He,TenantSettingsStore:$e,TenantVoiceSettingsStore:ze,TsCallingTelemetryService:qe,UserResourcesSettingsStore:Je,UtilityServiceImplementation:Qe,VoicemailPolicyStore:Ke,VoiceAdminSettingsStore:Ye,WatchServiceAdapter:Xe,WebApiService:Ze}=yield Fy(),{PeopleService:et}=yield zk(l),tt=new et(d,i),nt=new y(s,i),it=new R(c,s),at=yield t.getUser(),ot=i.get(A.J.Calling).enableACSEmbed?new h(a,at,s):new f(t,a,at,s),rt=new N(ot,nt,s),st=new Ae(i,e.platformService),lt=new v(s,i,nt);yield lt.startup();const dt=new S(s),ct=new C,ut=new b(o,s,n),mt=new ce(s,n),gt=new k(u,g),pt=new T(i,s),ht=new re(s),vt=new w(s),St=new _(s),ft=new E(s,n,tt),yt=new B,kt=new j(r,s),Ct=new le(s,i,nt);Ct.startup();const bt=yield XC(e)(),Tt=new I(d,s),wt=new Q(e.platformService),_t=ve(e.hostCommunicationService,s),It=new Y(m),At=new K(s),Nt=new ne(s),Et=new ge(s,m,i),Dt=new me(s),Ft=new be,Pt=new ee(Ft),Mt=new X(i,Pt),jt=yield wb(e,(()=>Promise.resolve(bt)))(),Rt=yield Ib(e,(()=>Promise.resolve(bt)))(),xt=yield Nb(e,(()=>Promise.resolve(bt)))(),Ot=new ye(s,bt),Lt=new Z(s),Ut=new ie(s),Bt=Se(Lt,e.hostCommunicationService,e.platformService),Wt=new ae(s),Gt=new oe(s),Vt=new se(o),Ht=new pe,$t=new he,zt=new ke(c),qt=new we(s,i,nt),Jt=new de(s,i,nt),Qt=new _e(i,c),Kt=new Ne(s),Yt=new De(s,n),Xt=new Fe(s,i,c);let Zt=[];const en=new Ee(s,i,nt);Zt=Zt.concat(en),yield en.startup();const tn=new Pe(Pt,s,l,c),nn=new Le(s,i,nt);yield nn.startup();const an=new je(s,i,tt,l,a),on=new Re,rn=new F(s,bt,Rt,i),sn=new M(s,i,nt);yield sn.startup();const ln=new Ke(s,i,nt);yield ln.startup();const dn=new P(s,i,nt);yield dn.startup();const cn=new D(s,l,e.platformService),un=new qe(l,st,i),mn=new J,gn=new W(s,r),pn=new He(s,t,rt,i,gn,l,m),hn=new L(s,n),vn=new V(s,n,l,c,i),Sn=new H(s,vn,i,nt,an,Ft),fn=new G(s,vn,i,nt,an,n,Ft.createObservable),yn=new U(s,n,fn),kn=new q,Cn=new Ie(s),bn=new Qe(c),Tn=new xe(s),wn=new Oe(yield a.skypeid()),_n=new O,In=new Xe,An=new x(s,t),Nn=new ue(s,n),En=new Be(s,i,nt);Zt=Zt.concat(En);const Dn=new We(s,i,nt);Zt=Zt.concat(Dn);const Fn=new Ge(s,i,nt);Zt=Zt.concat(Fn);const Pn=new Ue(s,i,nt);yield Pn.startup();const Mn=new Ve,jn=new $e(s,i,nt);Zt=Zt.concat(jn);const Rn=new ze(s,i,nt);Zt=Zt.concat(Rn);const xn=new Je(s,i,nt);Zt=Zt.concat(xn);const On=new Ye(s,i,nt,n);Zt=Zt.concat(On);const Ln=new Ce,Un=new $(n,s,Sn,Ft.createObservable),Bn=new te(i,s),Wn=new Me;yield Promise.all(Zt.map((e=>e.startup())));const Gn=new Ze(c),Vn=fe(Lt,Gn),Hn=new Te(ot,Rt,s,cn,st,an,kt,Gn,wt);return{adminSettingsStore:lt,aggregatedSettingsStoreService:nt,analyticsService:dt,appStateServiceImplementation:gt,ariaLiveService:ct,atMentionServiceImplementation:ut,attendanceReportService:pt,authenticationService:ot,batteryStatusService:vt,brbV2FeedbackService:St,cacheStorageService:p,callingAppEventsService:bt,callingBannerServiceAdapter:jt,callingDialogServiceAdapter:Rt,callingHttpAdapterService:Tt,callingLoggingService:cn,callingMultiWindowService:rn,callingNotificationService:xt,callingPeopleServiceAdapter:ft,callingPolicyStore:dn,callParkPolicyStore:sn,voicemailPolicyStore:ln,callingStorageService:kt,callingTenantServiceAdapter:An,callStateService:_n,channelServiceAdapter:hn,chatServiceClientAdapter:yn,chatServiceUtils:yt,clientDatabaseService:gn,conversationsAsyncServiceAdapter:fn,conversationsServiceAdapter:Sn,conversationsStoreAdapter:Un,customVideoBackgroundServiceHelpers:Bt,deviceManagerServiceHelpers:Vn,loadDataCompressor:z,dataManagerAdapter:kn,deepLinkProviderAdapter:mn,desktopUtilityService:wt,diagnosticsService:At,distributionListService:It,ecsProvider:Mt,electronIpcService:Lt,eventingServiceAdapter:Pt,exceptionUtilityService:Bn,experienceContainerFeatureService:Nt,filesNotificationService:Ut,freemiumUtilities:Wt,geoRoutingService:Gt,hybridContentVisibilityManager:ht,layoutService:it,localizationService:Vt,meetingPolicySettingsStore:Ct,messageFetchServiceImplementation:mt,messageServiceImplementation:Nn,messagingPolicySettingsStore:Jt,messagingTelemetryService:Dt,msGraphRestClient:Et,mtmaSubscriptionUtility:Ht,myUserPreferencesStore:$t,nativeRenderingHelper:_t,navigationService:Ot,networkDetectorService:zt,observable:Ln,observableFactory:Ft,officeIntegrationFirstRunAdapter:Hn,onlineDialinConferencingPolicyStore:qt,paywallService:Qt,perfStatsNotifierService:Kt,phoneNumberUtil:Cn,platformDetectService:st,policySettingsStore:en,profilePictureLoaderService:Yt,resourceManagerService:Xt,retryService:tn,sfbFirstRunServiceAdapter:Wn,sfbTeamsUpgradeService:an,skypeConversationLocalUtils:on,staticUtils:Tn,sxConfig:wn,syntheticAutomatedCallPolicySettingsStore:nn,teamsEnhancedEncryptionPolicySettingsStore:En,teamsEmergencyCallingPolicySettingsStore:Dn,teamsEmergencyCallRoutingPolicySettingsStore:Fn,teamsMeetingBrandingPolicySettingsStore:Pn,telemetryProvider:Mn,tenantPrivacyProfileService:pn,tenantSettingsStore:jn,tenantVoiceSettingsStore:Rn,tsCallingTelemetryService:un,userResourcesSettingsStore:xn,utilityServiceImplementation:bn,voiceAdminSettingsStore:On,watchServiceAdapter:In,webApiService:Gn}})))(e))),t_=e=>()=>e.userServicesCache(Ny.UnifiedConsentService,(()=>(e=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n,authenticationService:i,cacheStorage:a,loggerFactory:o}=e,{UnifiedConsentService:r}=yield TC(n);return new r(t,i,a,o)})))(e))),n_=(e,t)=>{const{getAsyncMediaService:n,chatServices:i,getSharepointRestClient:a,getBotsPlatformService:o,fileServices:r,getConnectedAccountsService:s,getGoogleCalendarAuthenticationService:l,getMsaAuthenticationService:d,getExternalAccountsService:c,getThirdPartyCalendarService:u,calendarServices:m,getCallingAppEventsService:g,getDiscoverSurfaceService:p,getUserLicenseService:h,getSmbUserIntentService:v,getCollabObjectService:S}=(e=>{const t=GC(e),n=o_(e),i=VC(e),a=HC(e,n.getChatService),o=r_(e,t,n.getChatService,i),r=$C(e),s=zC(e),l=qC(e),d=JC(e),c=QC(e,s,l,r),u=KC(e,s,r),m=s_(e),g=XC(e),p=ZC(e),h=eb(e);return{getAsyncMediaService:t,chatServices:n,getSharepointRestClient:i,getBotsPlatformService:a,fileServices:o,getConnectedAccountsService:r,getGoogleCalendarAuthenticationService:s,getMsaAuthenticationService:d,getExternalAccountsService:c,getThirdPartyCalendarService:u,calendarServices:m,getCallingAppEventsService:g,getDiscoverSurfaceService:p,getUserLicenseService:h,getSmbUserIntentService:tb(e,h),getCollabObjectService:nb(e)}})(e);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},i),{getAiInsightsFeedbackService:ib(e),getAiInsightsSdsService:ab(e),getAppBasedLinkService:ob(e,o),getAppsPlatformService:rb(e),getAppSuggestionsService:sb(e),getAsyncMediaService:n,getAzureMapsService:lb(e),getBadgeCountService:db(e),getBotsPlatformService:o,getBrbService:cb(e),getBreakoutRoomsService:ub(e),getAtpSafelinksService:mb(e),getBroadcastAttendeeService:gb(e),getBroadcastStreamingAttendeeService:pb(e),getBroadcastCaptionsService:hb(e),getBroadcastSignalRService:vb(e)}),m),{getCallBlockingService:(f=e,()=>f.userServicesCache(Ny.CallBlockingService,(()=>yb(f)))),getCallingAppEventsService:g,getCallingAnonymousDisplayNameService:bb(e),getCallingBannerService:wb(e,g),getCallingDialogService:Ib(e,g),getCallingNotificationService:Nb(e,g),getCallingService:l_(e,t),getCallingServiceAdapters:e_(e),getCmdMeetingIntelligenceService:Eb(e),getCollabObjectService:S,getMeetingCatchupService:Db(e),getConnectedAccountsService:s,getConnectedCalendarSettingsService:Fb(e),getBiometricEnrollmentService:Pb(e),getBiometricFaceEnrollmentService:Mb(e),getDeveloperSwitchersService:jb(e),getDistributionListService:Rb(e),getDynamicsMarketingService:xb(e),getDynamicsVirtualEventsService:Ob(e),getEmoticonService:Lb(e,i.getChatService),getEspService:Ub(e),getExampleService:Bb(e),getExternalAccountsService:c,getExternalAccountsResponseService:Wb(e,s)}),r),{getFluidService:Gb(e),getGalleryService:Vb(e),getGiphyService:Hb(e),getGoogleCalendarAuthenticationService:l,getGoogleContactsAuthenticationService:qC(e),getGuardiansService:$b(e),getImageProxyService:zb(e),getImportMsaContactsService:qb(d,e),getImplicitContactsService:Jb(e),getInstantAnswersService:Qb(e),getInviteLinksService:Kb(e),getLiveStateBroadcastService:Yb(e),getLiveStreamRenderingService:Xb(e),getLmsIntegrationService:Zb(e),getLockedTeamsService:eT(e),getLogsFilesService:nT(e),getLokiService:iT(e),getManageTenantService:aT(e),getMeetForWorkService:oT(e,m.getCalendarService,S),getMeetingArtifactsService:rT(e),getMeetingBotService:sT(e,m.getCalendarService,i.getChatService),getMeetingIntelligenceService:lT(e),getMeetingOptionsClientDataService:uT(e),getMeetingOptionsService:mT(e),getMeetingQuestionsAndAnswersService:gT(e),getMeetingRecapService:pT(e),getMeetingRecapSwaService:hT(e),getMeetingTemplateService:vT(e),getMeshSessionService:ST(e),getMsaAuthenticationService:d,getPaymentService:fT(e),getPeoplePickerService:kT(e),getPeopleService:dT(e),getPeopleTargetingService:CT(e)}),i_(e,v,h)),{getPoliciesService:bT(e),getPresenceService:TT(e)}),a_(e)),{getAddressService:_T(e),getPstnService:AT(e),getSCISService:NT(e),getSearchPrefetchService:ET(e)}),d_(e)),{getSharepointRestClient:a,getShareService:DT(e),getSmbUserIntentService:v,getStoreService:FT(e),getTenantMembershipService:PT(e),getTenantService:MT(e),getTenantAnalyticsService:jT(e),getTranscriptService:RT(e),getTranscriptFeedbackService:xT(e),getTranscriptSettingsStoreService:OT(e),getTranslateService:LT(e),getTargetingHierarchyService:UT(e),getThirdPartyCalendarService:u,getToastImageService:BT(e),getTeamsAndChannelsService:GT(e),getTpnNoticeService:VT(e),getUrlPreviewService:HT(e,r.getFilesReferenceService),getUserProfileService:$T(e),getVirtualEventsService:zT(e),getVoicemailService:QT(e),getWebinarService:KT(e),getCallRecordingService:YT(e),getUserLicenseService:h,getDiscoverSurfaceService:p,getMonetizationService:XT(e),getMRUItemService:ZT(e),getDiscoverSurfaceFeedbackService:ew(e,p),getCollabCloudService:tw(e),getTFLUserService:nw(e),getSensitivityLabelPolicySettingsService:iw(e)});var f},i_=(e,t,n)=>{const i=aw(e,t,n);return{getPetrolService:i,getFloodgateService:ow(e,i),getOdsService:rw(e,t,n)}},a_=e=>({getLokiMetaPreviewService:sw(e),getOdcFilePreviewService:lw(e),getOSearchService:dw(e),getPeopleSearchService:cw(e),getSubstrateFilesSearchService:uw(e),getSubstrateRecommendationsService:mw(e),getSubstrateSearchService:gw(e),getSubstrateSuggestionsService:pw(e),getSubstrateMeetingSearchService:hw(e),getSubstrateMeetingSummarySearchService:vw(e)}),o_=e=>{const t=Sw(e),n=fw(e,t),i=yw(e),a=kw(e),o=Cw(e);return{getChatService:t,getChatServiceEndpointProvider:n,getConsumerGroupsService:i,getCSAService:a,getReportConcernService:bw(e),getStatefulLongPoll:o,getUnifiedConsentService:t_(e)}},r_=(e,t,n,i)=>{const a=Tw(e,i),o=ww(e,i),r=_w(a,o,e);return{getFilesRedeemService:o,getFilesReferenceService:Iw(r,e),getFilesSharepointUrlService:r,getFileUploadPreviewService:Aw(e,t),getFileUploadService:Nw(e,i),getFileDownloadManagerService:Ew(e),getPersonalFileDetailsService:Dw(e,n),getRefreshSiteUrlService:(s=e,()=>s.userServicesCache(Ny.RefreshSiteUrlService,(()=>Fw(s)))),getCloudStorageFoldersService:Mw(e),getFilesBackfillThreadPropertiesService:jw(e),getSharepointShareService:a,getItemUploadService:Bw(e),getItemDeleteService:Ww(e),getItemDetailsService:Gw(e),getDriveItemShareService:Vw(e),getVideoFileService:Hw(e,i),getFilesValidDomainsService:$w(e)};var s},s_=e=>({getCalendarService:zw(e),getExternalCalendarEmailAddressService:qw(e),getTeamCalendarService:Jw(e),getMeetingRecommendationsService:Qw(e)}),l_=(e,t)=>((e,t,n)=>()=>{const i=e.loggerFactory.newLogger("create-calling-service-for-context");return n.getGlobalCallingService().then((n=>(0,c.mG)(void 0,void 0,void 0,(function*(){try{yield n.DO_NOT_CALL_ensureAccountCallingServiceExists(e,t)}catch(e){i.error(`[createCallingServiceForContext][error.name=${null==e?void 0:e.name}][error.message=${null==e?void 0:e.message}][error.stack=${null==e?void 0:e.stack}] Failed to ensureAccountCallingServiceExists`)}return n}))))})(e,{getCallingServiceAdapters:e_(e)},t),d_=e=>({getCommonSubstrateService:Kw(e),getSignalsService:Yw(e)});function c_(e){const t=(n=Object.assign({globalServicesCache:Ay},e),{getExampleGlobalService:Xw(n),getGlobalCallingService:Zw(n),getLogsFilesService:(i=n,()=>i.globalServicesCache(Ny.LogsFilesService,(()=>tT(i))))});var n,i;return Object.assign(Object.assign({entityType:"unknown",windowId:""},e),t)}class u_{static createGlobalDataRequestContext(e){if(u_._globalRequestContext)throw new Error("GlobalDataRequestContext is already created!");return u_._globalRequestContext=c_(e),u_._globalRequestContext}static createUserDataRequestContext(e,t){if(!u_._globalRequestContext)throw new Error("GlobalDataRequestContext has not been created!");return function(e,t,n){const i=Object.assign(Object.assign({},e),{userServicesCache:(new _y).getOrCreateServiceInstance}),{appsRegistryService:a,appStateService:o,authenticationService:r,authenticationUser:s,authStateProvider:l,cacheStorage:d,clientPreferences:c,clientState:u,commandChangeReportingService:m,coreSettings:g,discover:p,experienceChangeReportingService:h,hostCommunicationService:v,localStorage:S,loggerFactory:f,offlineCacheManager:y,platformService:k,pubsub:C,rebootService:b,scenarioFactory:T,userBiService:w,windowProvider:_,i18n:I,brbServiceManager:A,entityCommanding:N,userTrackingService:E}=e;return Object.assign(Object.assign(Object.assign({},t),{appsRegistryService:a,appStateService:o,authenticationUser:s,authenticationService:r,authStateProvider:l,cacheStorage:d,clientPreferences:c,clientState:u,commandChangeReportingService:m,coreSettings:g,discover:p,entityType:"unknown",experienceChangeReportingService:h,hostCommunicationService:v,localStorage:S,loggerFactory:f,offlineCacheManager:y,platformService:k,pubsub:C,rebootService:b,scenarioFactory:T,userBiService:w,windowId:"",windowProvider:_,i18n:I,brbServiceManager:A,entityCommanding:N,userTrackingService:E}),n_(Object.assign(Object.assign({},i),{cmdApolloClient:n}),t))}(e,u_._globalRequestContext,t)}static get globalRequestContext(){return u_._globalRequestContext}}function m_(e,t,n){return(0,c.mG)(this,void 0,void 0,(function*(){if(e.config.enableEmbedDataClient)return function(e,t,n){var i;return(0,c.mG)(this,void 0,void 0,(function*(){const{dataEvictionService:a,platformService:o,coreSettings:r,config:s}=e,{enableApolloDevtools:l}=r.get(A.J.Diagnostics),d=new Qg.pS,{defaultContext:c,link:u}=yield y_(e,n,d),m=null===(i=c.leakDetectorService)||void 0===i?void 0:i.create(),g=g_(e,d,m,u,c.loggerFactory,c.scenarioFactory)({windowId:_.ew,entityType:n,viewportContext:e.windowProvider.viewportContext,name:"embed",storeType:Kg.t.embed});return sp(g,"embed",Boolean(l),o,s.experienceName),new Sp({pubsub:d,leakDetector:m,scenarioFactory:c.scenarioFactory,coreSettings:c.coreSettings,dataOpsTracker:t,dataEvictionService:k_(a)?a:void 0,graphqlStoreStatsReporterService:e.graphqlStoreStatsReporterService},g,c)}))}(e,t,n);const{enableMTMA:i}=e.coreSettings.get(A.J.Core);return i?function(e,t,n){var i;return(0,c.mG)(this,void 0,void 0,(function*(){const{coreSettings:a,dataEvictionService:o}=e,r=new Qg.pS,{defaultContext:s,link:l}=yield y_(e,n,r,{noCDLTerminatingLink:!0}),d=null===(i=s.leakDetectorService)||void 0===i?void 0:i.create(),c=g_(e,r,d,l,s.loggerFactory,s.scenarioFactory),{enableApolloDataEviction:u,enableViewSchema:m}=a.get(A.J.Core);let g;return m&&(g=h_(e,r,d,mh.createViewSchemaLink(e),s.loggerFactory,s.scenarioFactory)),new Ty({pubsub:r,leakDetector:d,scenarioFactory:s.scenarioFactory,coreSettings:s.coreSettings,dataOpsTracker:u?t:void 0,dataEvictionService:u&&k_(o)?o:void 0,graphqlStoreStatsReporterService:e.graphqlStoreStatsReporterService},c,s,g)}))}(e,t,n):function(e,t,n){var i;return(0,c.mG)(this,void 0,void 0,(function*(){const{coreSettings:a,dataEvictionService:o}=e,r=new Qg.pS,{defaultContext:s,link:l}=yield y_(e,n,r),d=null===(i=s.leakDetectorService)||void 0===i?void 0:i.create(),c=g_(e,r,d,l,s.loggerFactory,s.scenarioFactory),{enableApolloDataEviction:u,enableViewSchema:m}=a.get(A.J.Core);let g;return m&&(g=h_(e,r,d,mh.createViewSchemaLink(e),s.loggerFactory,s.scenarioFactory)),new vp({pubsub:r,leakDetector:d,scenarioFactory:s.scenarioFactory,coreSettings:s.coreSettings,dataOpsTracker:u?t:void 0,dataEvictionService:u&&k_(o)?o:void 0,graphqlStoreStatsReporterService:e.graphqlStoreStatsReporterService},c,s,g)}))}(e,t,n)}))}function g_(e,t,n,i,a,o,r,s){const{appsRegistryService:l,coreSettings:d,platformService:c,config:u,graphqlStoreStatsReporterService:m}=e;let g;g=r||Cy.create(t);const{maxApolloResultCacheSize:p}=d.get(A.J.Core),{enableApolloDevtools:h}=d.get(A.J.Diagnostics),v=null!=p?p:void 0;return({windowId:e,entityType:t,viewportContext:r,name:d,overrideLink:p,storeType:S})=>{const f=l.getRegisteredAppsTypePolicies(e),y=p_({leakDetector:n,windowId:e,entityType:t,viewportContext:r,userContextId:s},p||i,g,v,a,o,f,h,S,m);return sp(y,d,Boolean(h),c,u.experienceName),y}}const p_=(e,t,n,i,a,o,r,s,l,d)=>{const c=(0,ep.aw)({typePolicies:yh(null==r?void 0:r.typePolicies),possibleTypes:Xg.g_h,dataIdFromObject:Yg.X,resultCacheMaxSize:i,apolloLeakOptions:e,loggerFactory:a,scenarioFactory:o,storeType:l,graphqlStoreStatsReporterService:d}),u=(0,ep.nl)({cache:c,link:t,resolvers:n,defaultOptions:{watchQuery:{nextFetchPolicy:kh}},apolloLeakOptions:e,loggerFactory:a,enableApolloDevtools:s,storeType:l,graphqlStoreStatsReporterService:d});return Ap(c,a,null==r?void 0:r.defaultTypeName),u};function h_(e,t,n,i,a,o){const{coreSettings:r,platformService:s,config:l,graphqlStoreStatsReporterService:d}=e,{maxApolloResultCacheSize:c}=r.get(A.J.Core),{enableApolloDevtools:u}=r.get(A.J.Diagnostics),m=null!=c?c:void 0;return({windowId:e,entityType:t,viewportContext:r,name:c,overrideLink:g,storeType:p})=>{const h=v_({leakDetector:n,windowId:e,entityType:t,viewportContext:r},g||i,{},m,a,o,p,d);return sp(h,c,Boolean(u),s,l.experienceName),h}}const v_=(e,t,n,i,a,o,r,s)=>{const l=(0,ep.aw)({typePolicies:{},possibleTypes:Zg.g,dataIdFromObject:Yg.X,resultCacheMaxSize:i,apolloLeakOptions:e,loggerFactory:a,scenarioFactory:o,storeType:r,graphqlStoreStatsReporterService:s});return(0,ep.nl)({cache:l,link:t,resolvers:n,defaultOptions:{watchQuery:{nextFetchPolicy:kh}},apolloLeakOptions:e,loggerFactory:a,storeType:r,graphqlStoreStatsReporterService:s})},S_=(e,t,n)=>{const{appsRegistryService:i,appStateService:a,authenticationService:o,authenticationUser:r,cacheStorage:s,clientPreferences:l,clientState:d,commandChangeReportingService:c,coreSettings:u,discover:m,dataEvictionService:g,experienceChangeReportingService:p,hostCommunicationService:h,leakDetectorService:v,localStorage:S,loggerFactory:f,offlineCacheManager:y,platformService:k,rebootService:C,scenarioFactory:b,userBiService:T,windowProvider:w,i18n:I,brbServiceManager:A,entityCommanding:N,userTrackingService:E}=e;return{appsRegistryService:i,appStateService:a,authenticationService:o,authenticationUser:r,cacheStorage:s,clientPreferences:l,clientState:d,commandChangeReportingService:c,coreSettings:u,discover:m,dataEvictionService:g,entityType:n,experienceChangeReportingService:p,hostCommunicationService:h,leakDetectorService:v,localStorage:S,loggerFactory:f,offlineCacheManager:y,platformService:k,pubsub:t,rebootService:C,scenarioFactory:b,userBiService:T,windowId:_.ew,windowProvider:w,i18n:I,brbServiceManager:A,entityCommanding:N,userTrackingService:E}},f_=(e,t)=>{const n=(0,tp.v)(((t,n)=>Object.assign(Object.assign({},e),n)));return np.i.from([n,t])};function y_(e,t,n,{noCDLTerminatingLink:i}={}){return(0,c.mG)(this,void 0,void 0,(function*(){const{networkState:a}=e,o=(0,od.UZ)(ys.l,a.observeIsOnline()),r=Object.assign(Object.assign({},e),{pubsub:n,send:o}),s=u_.createGlobalDataRequestContext(r),l=yield mh.createSingletonLink(Object.assign({contextValue:s,noCDLTerminatingLink:i},r));return{defaultContext:S_(e,n,t),link:l}}))}function k_(e){if(!e)return!1;const t=e;return"function"==typeof t.register&&"function"==typeof t.unregister}class C_ extends xe{constructor(){super(_.Yg.CreateDataClient,["scenarioFactory","loggerFactory","windowProvider","coreSettings","platformService"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,windowProvider:i,coreSettings:a,platformService:o}=e,{enableApolloDataEviction:r,maxApolloCacheOperationCount:s}=e.coreSettings.get(A.J.Core),l=new qg({activeOperationLimit:s});e.dataCleanupService=l,r&&(e.dataEvictionService=new Jg(l,t,n,i));const d=yield m_(Object.assign(Object.assign({},e),{pulsar:this.createDataClientPulsarInstance(a,n,o)}),l,Rt.EntityType.default);e.client=d}))}createDataClientPulsarInstance(e,t,n){const{enablePulsarTelemetry:i,logToOTLCollector:a}=e.get(A.J.Pulsar),o=new Za(Ja.TEAMS_RESOLVER,{sessionId:n.host.sessionId,spanExporter:new eo,loggerFactory:t,logToOTLCollector:!!a});return i&&o.initialize(),o}}var b_,T_=n(64816);!function(e){e[e.NoOverride=0]="NoOverride",e[e.OverrideIntent=1]="OverrideIntent",e[e.OverrideUserContext=2]="OverrideUserContext",e[e.TerminateNavigation=3]="TerminateNavigation"}(b_||(b_={}));const w_={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}}]}}]}}]},__={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeAuthenticatedUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reason"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeAuthenticatedUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"reason"},value:{kind:"Variable",name:{kind:"Name",value:"reason"}}}]}]}}]},I_={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeWindow"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var A_,N_;!function(e){e[e.Other=1]="Other",e[e.Main=2]="Main",e[e.Flyout=3]="Flyout"}(A_||(A_={})),function(e){e.MatchingPendingIntentFound="MatchingPendingIntentFound",e.IntentOverriddenByOnBeforeAuth="IntentOverriddenByOnBeforeAuth",e.IntentOverriddenByOnAfterAuth="IntentOverriddenByOnAfterAuth"}(N_||(N_={}));const E_="intent-service",D_="none",F_=e=>e.activeWindows.some((e=>!e.isMainWindow));class P_{constructor(e,t,n,i,a,o,r,s,l){this.appsRegistryService=t,this.coreSettings=n,this.commandHandler=i,this.client=a,this.waitForRenderingContextReady=o,this.commandChangeReportingService=r,this.experienceChangeReportingService=s,this.scenarioFactory=l,this.pendingIntentMap=new Map,this.logger=e.newLogger("IntentService"),this.observeActiveWindows(),this.hasCreatedNonMainWindow=!1}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){let t,n,i;if(this.logInternal("execute: Original intent:",e),e.shouldRenderContent){i=this.getRenderingIntentType(e),yield this.cleanupActiveWindowsIfNeeded(i);const a=this.pendingIntentMap.get(i);a&&(t=a.windowId,n=N_.MatchingPendingIntentFound,this.logInternal(`execute: Replacing intent for window id: ${t} with layout type ${i}:`,e)),this.pendingIntentMap.set(i,{intent:(0,Z.cloneDeep)(e),windowId:t})}this.logInternal("execute: Intent for evaluation:",e),this.commandChangeReportingService.report({correlationId:e.scenarioCorrelation.correlation.id,type:Qe.B.IntentReceived,context:{target:E_,eventData:{mainEntityType:e.shouldRenderContent?e.entityCommand.entity.type:D_,mainEntityAction:e.shouldRenderContent?e.entityCommand.entity.action:D_,errorCode:n}}});const{intentExecuted:a,targetWindowId:o}=yield this.executeInternal(e,t);if(e.shouldRenderContent&&i)a?(this.logger.log("execute: Intent was not overriden and executed. Removing from state."),this.pendingIntentMap.delete(i)):(this.pendingIntentMap.set(i,{intent:(0,Z.cloneDeep)(e),windowId:o}),this.logInternal(`execute: updated window ID: ${o}: For pending intent:`,e));else if(!e.shouldRenderContent){const t=this.scenarioFactory.findScenario(ee.RG.ApplicationLaunchTime);null==t||t.stop({mainEntityType:D_,reason:"nrc_background_launch"}),this.commandChangeReportingService.report({type:Qe.B.Blanked,correlationId:e.scenarioCorrelation.correlation.id,context:{target:"intent-service",eventData:{systemInitiated:!0,mainEntityType:D_}}})}this.experienceChangeReportingService.report({correlationId:e.scenarioCorrelation.correlation.id,type:Tt.yU.NavigationIntentExecuted,context:{target:"intent-service",shouldRenderContent:e.shouldRenderContent}})}))}checkForPendingIntent(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){for(const[n,{intent:i,windowId:a}]of Array.from(this.pendingIntentMap)){const o=(0,Z.cloneDeep)(i);if(o){this.commandChangeReportingService.report({correlationId:e.id,type:Qe.B.IntentReceived,context:{target:E_,eventData:{mainEntityType:o.entityCommand.entity.type,mainEntityAction:o.entityCommand.entity.action}}}),o.entityCommand.command.visibilityState=Ae.fe.showWithoutFocusing,o.metadata.userContextId=t,o.entityCommand.command.correlation=e,o.scenarioCorrelation.correlation=e,this.logInternal("checkForPendingIntent: Executing pending intent:",o);const{intentExecuted:i}=yield this.executeInternal(o,a);i&&(this.logger.log("checkForPendingIntent: Intent was not overriden and executed. Removing from state."),this.pendingIntentMap.delete(n))}}}))}launchMainApp(e,t,n){return(0,c.mG)(this,void 0,void 0,(function*(){this.logger.log("launchMainApp"),yield this.execute({shouldRenderContent:!0,scenarioCorrelation:e,entityCommand:tt({entity:null!=n?n:{type:Ie.p.default,action:Ie.u.default},command:{visibilityState:Ae.fe.show,stateTransition:Ae.su.forceFlush,layoutMode:Ae.lO.standard,correlation:e.correlation}}),metadata:{allowAnonymous:!1,userContextId:t}})}))}prewarmFlyout(e){return(0,c.mG)(this,void 0,void 0,(function*(){this.logger.log("prewarmFlyout"),yield this.execute({shouldRenderContent:!0,scenarioCorrelation:e,entityCommand:tt({entity:{type:Ie.p.flyout,action:Ie.u.default},command:{visibilityState:Ae.fe.showWithoutFocusing,stateTransition:Ae.su.flush,layoutMode:Ae.lO.minimal,correlation:e.correlation}}),metadata:{allowAnonymous:!1}})}))}cleanupActiveWindowsIfNeeded(e){return(0,c.mG)(this,void 0,void 0,(function*(){try{switch(e){case A_.Other:const e=this.pendingIntentMap.get(A_.Main);e&&(this.logger.log(`Closing main window with id=${e.windowId}.`),yield this.client.mutate({mutation:I_,variables:{windowId:e.windowId}}));case A_.Main:const t=this.pendingIntentMap.get(A_.Other);t&&(this.logger.log(`Closing other window with id=${t.windowId}.`),yield this.client.mutate({mutation:I_,variables:{windowId:t.windowId}}))}}catch(t){this.logger.warn(`cleanupActiveWindowsIfNeeded: Failed to remove window of type ${e}: ${t.message}`)}}))}observeActiveWindows(){return(0,c.mG)(this,void 0,void 0,(function*(){this.client.watchQuery({query:w_}).subscribe((e=>(0,c.mG)(this,void 0,void 0,(function*(){var t,n,i,a,o;if(!e.loading&&!e.errors){const{data:r}=e;if(null===(n=null===(t=this.coreSettings)||void 0===t?void 0:t.get(A.J.Core))||void 0===n?void 0:n.enableAnonymousCallerSignout)if(this.hasCreatedNonMainWindow){const e=yield this.getUserContext(void 0);yield(i=r,a=this.client,o=(e=>{var t;return(null===(t=null==e?void 0:e.authenticationUser)||void 0===t?void 0:t.type)===Pr.Ch.Anonymous})(e),(0,c.mG)(void 0,void 0,void 0,(function*(){if(!F_(i)&&o){const e={id:(0,Ps.pW)(),source:"intent-service",scenarioName:ee.RG.AuthWebLogout};yield a.mutate({mutation:__,variables:{reason:"AnonymousSessionEnd"},context:{correlation:e}})}})))}else this.hasCreatedNonMainWindow=F_(r);this.checkAndCleanupIfWindowRemoved(r.activeWindows.map((e=>e.id)))}}))))}))}checkAndCleanupIfWindowRemoved(e){for(const[t,{intent:n,windowId:i}]of Array.from(this.pendingIntentMap))i&&!e.find((e=>e===i))&&(this.logInternal(`checkAndCleanupIfWindowRemoved: window id: ${i} no longer exists, removing intent:`,n),this.pendingIntentMap.delete(t))}getRenderingIntentType(e){return e.entityCommand.entity.type===Ie.p.flyout||e.entityCommand.command.layoutMode===Ae.lO.minimal?A_.Flyout:e.entityCommand.command.layoutMode===Ae.lO.focus?A_.Other:A_.Main}setWindowIdIfKnown(e,t){if(t){const n=(0,Z.cloneDeep)(e.entityCommand);return n.command.stateTransition=Ae.su.flush,n.command.__UNSAFE_windowId=t,n}return e.entityCommand}executeCommand(e,t,n,i){var a,o;return(0,c.mG)(this,void 0,void 0,(function*(){this.logger.log(`Executing Intent in windowId: ${n}`),e.entityCommand.entity.type===Ie.p.default&&(this.logger.log("checkForPendingIntent: Translating default entity to a real entity"),e.entityCommand.entity=null!==(o=this.appsRegistryService.getDefaultCommand(null!==(a=null==i?void 0:i.coreSettings)&&void 0!==a?a:this.coreSettings))&&void 0!==o?o:e.entityCommand.entity);const r=this.setWindowIdIfKnown(e,n),s=yield t(r,e.scenarioCorrelation.clientLaunchId);return this.logger.log(`Command execution happened in windowId: ${s}`),s}))}executeInternal(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){let n,i=this.commandHandler;this.logInternal(`executeInternal: windowId: ${t}: Original intent:`,e),this.commandChangeReportingService.report({type:Qe.B.OnBeforeIntentAuthenticatedStarted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:E_}});const{intentOverridenByHook:a,targetWindowId:o,errorCode:r,targetUserContextId:s}=yield this.evaluateHook("onBeforeIntentAuthenticated",{intent:(0,Z.cloneDeep)(e),context:{client:this.client,coreSettings:this.coreSettings,scenarioFactory:this.scenarioFactory}},i,t);if(n=r,this.commandChangeReportingService.report({type:Qe.B.OnBeforeIntentAuthenticatedCompleted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:E_,eventData:{errorCode:r}}}),a)return this.logger.log("executeInternal: Intent overriden by onBeforeIntentAuthenticated."),{intentExecuted:!1,targetWindowId:o};if(e.metadata.userContextId!==s&&(this.logger.log("executeInternal: userContextId overriden by onBeforeIntentAuthenticated."),e.metadata.userContextId=s),!e.shouldRenderContent&&!e.metadata.userContextId)return this.logger.log("executeInternal: userContextId is still undefined. Returning early."),{intentExecuted:!1,targetWindowId:o};let l,d;this.commandChangeReportingService.report({type:Qe.B.WaitForUserContextStarted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:E_}});try{l=yield this.getUserContext(e.metadata.userContextId)}catch(n){return{intentExecuted:!0,targetWindowId:yield this.logAndGoToErrorPage({error:new ze.G(ze.$.CREATE_USER_CONTEXT_FAILED_GENERIC,n,e.metadata.userContextId),errorInfo:Ke.y.CreateUserContextError,errorMessage:`getUserContext(${e.metadata.userContextId}) failed, executing original intent ${n}.`,fallbackError:new ze.G(ze.$.CREATE_USER_CONTEXT_FAILED_GENERIC,void 0,e.metadata.userContextId),intent:e,newCommandType:Qe.B.Failure,windowId:t})}}if(this.commandChangeReportingService.report({type:Qe.B.WaitForUserContextCompleted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:E_}}),null==l?void 0:l.authenticationUser){const a=l;i=(e,t)=>Pn(Object.assign(Object.assign({},a),{entityCommandInput:e,clientLaunchId:t})),this.commandChangeReportingService.report({type:Qe.B.OnAfterIntentAuthenticatedStarted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:E_}});const{intentOverridenByHook:o,targetWindowId:r,errorCode:s}=yield this.evaluateHook("onAfterIntentAuthenticated",{intent:(0,Z.cloneDeep)(e),context:{authenticatedUser:l.authenticationUser,client:l.client,localStorage:l.localStorage,coreSettings:this.coreSettings,experienceChangeReportingService:l.experienceChangeReportingService}},i,t);if(this.commandChangeReportingService.report({type:Qe.B.OnAfterIntentAuthenticatedCompleted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:E_,eventData:{errorCode:s}}}),s&&(n=s),o)return this.logger.log("executeInternal: Intent overriden by onAfterIntentAuthenticated."),{intentExecuted:!1,targetWindowId:r}}else this.logger.log(`executeInternal: user context / authentication user is not defined for userContextId: ${e.metadata.userContextId}  - skip execution of onAfterIntentAuthenticated`);return this.logInternal(`executeInternal: windowId: ${t}: Executing original intent:`,e),this.commandChangeReportingService.report({correlationId:e.scenarioCorrelation.correlation.id,type:Qe.B.IntentExecuted,context:{target:E_,eventData:{mainEntityType:e.shouldRenderContent?e.entityCommand.entity.type:D_,mainEntityAction:e.shouldRenderContent?e.entityCommand.entity.action:D_,errorCode:n}}}),e.shouldRenderContent&&(d=yield this.executeCommand(e,i,t,l)),{intentExecuted:!0,targetWindowId:d}}))}getUserContext(e){var t,n;return(0,c.mG)(this,void 0,void 0,(function*(){const i=!!(null===(n=null===(t=this.coreSettings)||void 0===t?void 0:t.get(A.J.Auth))||void 0===n?void 0:n.enableIntegratedAuthApp);return this.logger.log(`getUserContext(${e})`),this.waitForRenderingContextReady(i,e)}))}evaluateHook(e,t,n,i){return(0,c.mG)(this,void 0,void 0,(function*(){let a,o;this.logger.log(`evaluateHook(${e}): windowId: ${i}: Begin evaluation`);let r=!1;for(const s of this.filterMatchingApps(e,t.intent.shouldRenderContent?t.intent.entityCommand.entity.type:void 0)){this.logger.log(`evaluateHook(${e}) - Matching app found: ${s.manifest.id}`),this.commandChangeReportingService.report({correlationId:t.intent.scenarioCorrelation.correlation.id,type:Qe.B.IntentHookStarted,context:{target:E_,eventData:{"App.Id":s.manifest.id}}});try{const n=yield this.evaluateHookForApp(s,e,t);r=n.intentOverridenByHook,a=n.intent,o=r?"onBeforeIntentAuthenticated"===e?N_.IntentOverriddenByOnBeforeAuth:N_.IntentOverriddenByOnAfterAuth:void 0}catch(n){this.logger.warn(`evaluateHook(${e}) windowId: ${i}: - Evaluating hook threw an error: ${n}. Executing error intent.`),o="onBeforeIntentAuthenticated"===e?Ke.y.OnBeforeIntentAuthenticatedRejected:Ke.y.OnAfterIntentAuthenticatedRejected;return{intentOverridenByHook:!0,targetWindowId:yield this.logAndGoToErrorPage({error:n,errorInfo:o,errorMessage:`evaluateHook(${e}) windowId: ${i}: - Evaluating hook threw an error: ${n}. Falling back to original intent.`,fallbackError:new ze.G(ze.$.UNKNOWN),intent:t.intent,newCommandType:Qe.B.IntentHookRejected,windowId:i}),errorCode:o}}if(r){if(!a)return this.logger.warn(`evaluateHook(${e}) windowId: ${i}: - Hook overriden to undefined. Stopping further processing`),this.commandChangeReportingService.report({correlationId:t.intent.scenarioCorrelation.correlation.id,type:Qe.B.Failure,context:{target:E_,errorInfo:"onBeforeIntentAuthenticated"===e?Ke.y.OnBeforeIntentAuthenticatedReturnedUndefined:Ke.y.OnAfterIntentAuthenticatedReturnedUndefined}}),{intentOverridenByHook:!0,targetWindowId:i};if(t.intent.shouldRenderContent&&a.shouldRenderContent){this.logInternal(`evaluateHook(${e}), windowId: ${i}: - Executing overriden intent:`,a),this.commandChangeReportingService.report({correlationId:a.scenarioCorrelation.correlation.id,type:Qe.B.IntentExecuted,context:{target:E_,eventData:{mainEntityType:a.shouldRenderContent?a.entityCommand.entity.type:D_,mainEntityAction:a.shouldRenderContent?a.entityCommand.entity.action:D_,errorCode:o}}});return{intentOverridenByHook:r,targetWindowId:yield this.executeCommand(a,n,i),errorCode:o}}}}return this.logger.log(`evaluateHook(${e}): windowId: ${i}: Completing evaluation. Intent was not overriden.`),this.commandChangeReportingService.report({correlationId:t.intent.scenarioCorrelation.correlation.id,type:Qe.B.IntentHookCompleted,context:{target:E_}}),{intentOverridenByHook:!1,targetWindowId:i,errorCode:o,targetUserContextId:null==a?void 0:a.metadata.userContextId}}))}evaluateHookForApp(e,t,n){var i,a,o,r,s,l,d,u;return(0,c.mG)(this,void 0,void 0,(function*(){let c,m,g;switch(t){case"onBeforeIntentAuthenticated":c=yield null===(i=e.onBeforeIntentAuthenticated)||void 0===i?void 0:i.execute(n);break;case"onAfterIntentAuthenticated":c=yield null===(a=e.onAfterIntentAuthenticated)||void 0===a?void 0:a.execute(n);break;default:{const e=`evaluateHook(${t}): Unknown hook and options.`;throw null===(r=(o=this.logger).errorToTelemetry)||void 0===r||r.call(o,e,"webclient_framework_foundation_core_services_intent",void 0,!0),new Error(e)}}if(!c){const e=`evaluateHook(${t}): Undefined app hook response.`;throw null===(l=(s=this.logger).errorToTelemetry)||void 0===l||l.call(s,e,"webclient_framework_foundation_core_services_intent",void 0,!0),new Error(e)}switch(c.overrideType){case b_.NoOverride:g=!1,m=n.intent;break;case b_.OverrideIntent:g=!0,m=c.intent;break;case b_.OverrideUserContext:g=!1,m=Object.assign(Object.assign({},n.intent),{metadata:Object.assign(Object.assign({},n.intent.metadata),{userContextId:c.userContextId})});break;case b_.TerminateNavigation:g=!0,m=void 0;break;default:const e=`evaluateHook(${t}): Invalid app hook override type.`;throw null===(u=(d=this.logger).errorToTelemetry)||void 0===u||u.call(d,e,"webclient_framework_foundation_core_services_intent",void 0,!0),new Error(e)}if(this.commandChangeReportingService.report({correlationId:n.intent.scenarioCorrelation.correlation.id,type:Qe.B.IntentHookResolved,context:{target:E_}}),m&&n.intent.shouldRenderContent!==m.shouldRenderContent)throw new ze.G(ze.$.INVALID_INTENT_OVERRIDE);return{intentOverridenByHook:g,intent:m}}))}filterMatchingApps(e,t){const n=[];for(const i of this.appsRegistryService.registeredApps){const a=i[e];if(a)for(const e of Array.from(a.filter))"*"!==e&&e!==t||n.push(i)}return n}logInternal(e,t){this.logger.log(`${e} {${t.shouldRenderContent?`${t.entityCommand.entity.type}, ${t.entityCommand.entity.action}, ${t.entityCommand.command.layoutMode}, ${t.entityCommand.command.visibilityState}}`:"nrc"}`)}logAndGoToErrorPage({error:e,errorInfo:t,errorMessage:n,fallbackError:i,intent:a,newCommandType:o,windowId:r}){var s,l;return(0,c.mG)(this,void 0,void 0,(function*(){if(null===(l=(s=this.logger).errorToTelemetry)||void 0===l||l.call(s,n,"webclient_framework_foundation_core_services_intent"),this.commandChangeReportingService.report({type:o,correlationId:a.scenarioCorrelation.correlation.id,context:{target:E_,errorInfo:t,eventData:{errors:e instanceof je.G?e.toTelemetryEntry():`${e}`}}}),a.shouldRenderContent)return this.goToErrorPage(e,a,r,i)}))}goToErrorPage(e,t,n,i){var a,o;return(0,c.mG)(this,void 0,void 0,(function*(){let r;try{if(!(e instanceof je.G))throw e;r=e.serialize()}catch(e){null===(o=(a=this.logger).errorToTelemetry)||void 0===o||o.call(a,`Failed to serialize error: ${e}`,"webclient_framework_foundation_core_services_intent"),r=null==i?void 0:i.serialize()}const s=Object.assign(Object.assign({},t),{entityCommand:{entity:{type:Ie.p.error,action:Ie.u.view},entityOptions:{serializedError:r},command:Object.assign(Object.assign({},t.entityCommand.command),{layoutMode:Ae.lO.focus})}});return this.executeCommand(s,this.commandHandler,n)}))}}class M_{constructor(e,t,n,i,a,o,r,s,l,d,c,u,m,g,p){this._client=i,this._host=o,this._appsRegistryService=r,this._config=s,this._correlation=l,this._scenarioFactory=d,this._userBiService=c,this._commandChangeReportingService=u,this._hostComms=m,this._localStorage=g,this._experienceChangeReportingService=p,this._logger=e.newLogger("DeepLinkService"),this._intentService=new P_(e,this._appsRegistryService,t,n,this._client,a,this._commandChangeReportingService,this._experienceChangeReportingService,this._scenarioFactory),this._loggerFactory=e,this._coreSettings=t}init(){return(0,c.mG)(this,void 0,void 0,(function*(){return this._host.addEventListener("hashchange",(()=>{const e=function(e,t,n){return{clientLaunchId:_r({location:e,clientLaunchId:n}),correlation:Tr(e,t),deeplinkId:Ir(e,"deeplinkId")}}(this._host.location,I.D.ExternalCommand);return this._handleUrl(!1,e)})),this._handleUrl(!0,{clientLaunchId:_r({location:this._host.location}),correlation:Object.assign({scenarioName:ee.RG.ClientStart},this._correlation),deeplinkId:Ir(this._host.location,"deeplinkId")})}))}executeFromUrlAsync(e,t,n,i,a){return(0,c.mG)(this,void 0,void 0,(function*(){if(!this._isValidDeepLinkUrl(e))return!1;const o=new URL(e);try{const e={correlation:(null==t?void 0:t.correlation)?Xe(t.correlation):Tr(o,I.D.InternalDeeplink),clientLaunchId:i};i&&this.sendDeeplinkReceivedSignal(e,n);const r=yield this._getNavigationIntentAsync(o,!0,e,t,a);return r?(yield this._intentService.execute(r),!0):(this.stopNavigationScenarios(e,Qe.B.Incomplete,Ke.y.DeeplinkIntentParseFailure),!1)}catch(t){const n=`DeepLink:: ${Gt.ToNavigationIntentFailed} ${e} ${(0,R.u4)(t)}`;throw new Error(n)}}))}checkForPendingIntent(e,t,n){const i=Xe({source:e,scenarioName:ee.RG.NavigationCommand});return t&&this.sendDeeplinkReceivedSignal({clientLaunchId:t,correlation:i},{type:"pendingIntent"}),this._intentService.checkForPendingIntent(i,n)}launchMainApp(e,t,n,i){const a={correlation:Xe(Object.assign({scenarioName:ee.RG.NavigationCommand},e)),clientLaunchId:_r({clientLaunchId:t})};return a.clientLaunchId&&this.sendDeeplinkReceivedSignal(a,{type:"default"}),this._intentService.launchMainApp(a,n,i)}prewarmFlyout(e){const t={correlation:Xe({source:e,scenarioName:ee.RG.NavigationCommand}),clientLaunchId:_r({location:this._host.location})};return this.sendDeeplinkReceivedSignal(t,{type:"flyout"}),this._intentService.prewarmFlyout(t)}executeIntent(e){const t={correlation:Xe(Object.assign(Object.assign({},e.entityCommand.command.correlation),{scenarioName:ee.RG.NavigationCommand})),clientLaunchId:_r({})};return this.sendDeeplinkReceivedSignal(t,{type:`${e.entityCommand.entity.type}/${e.entityCommand.entity.action}`}),this._intentService.execute(Object.assign(Object.assign({},e),{entityCommand:Object.assign(Object.assign({},e.entityCommand),{command:Object.assign(Object.assign({},e.entityCommand.command),{correlation:t.correlation})}),scenarioCorrelation:t,shouldRenderContent:!0}))}_handleUrl(e,t){var n,i;return(0,c.mG)(this,void 0,void 0,(function*(){if(this._lastDesktopClientId&&this._lastDesktopClientId===t.clientLaunchId)return void(null===(i=(n=this._logger).errorToTelemetry)||void 0===i||i.call(n,"Navigation received with duplicate clientId. Terminating flow.","webclient_framework_foundation_core_services_deeplink",void 0,!0));this._lastDesktopClientId=t.clientLaunchId;const a=this._host.location;t.correlation.scenarioName&&t.clientLaunchId&&this.sendDeeplinkReceivedSignal(t);let o=yield this._getNavigationIntentAsync(a,!1,t);if(!o&&this._config.shouldExecuteDefaultCommand&&(o=vr(t,void 0,Ar(),Ae.lO.standard)),o)return yield this._notifyIntentHandled(),e&&this._experienceChangeReportingService.report({correlationId:t.correlation.id,type:Tt.yU.InitialDeeplinkResolved,context:{target:"deeplink-service-handle-url",shouldRenderContent:o.shouldRenderContent}}),this._intentService.execute(o);this.stopNavigationScenarios(t,Qe.B.Failure,Ke.y.DeeplinkIntentParseFailure)}))}_isValidDeepLinkUrl(e){var t,n;try{new URL(e)}catch(e){const i=`DeepLink:: ${Gt.InvalidDeepLinkUrl}::${null==e?void 0:e.name}`;return null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,i,"webclient_framework_foundation_core_services_deeplink",void 0,!0),!1}return!0}_notifyIntentHandled(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){try{const t=yield this._hostComms.loadModule("core");yield null===(e=null==t?void 0:t.intentHandled)||void 0===e?void 0:e.call(t)}catch(e){this._logger.warn("Failed to notify host that intent was handled")}}))}_getNavigationIntentAsync(e,t,n,i,a){var o,r;return(0,c.mG)(this,void 0,void 0,(function*(){let s;try{s=yield br({appsRegistryService:this._appsRegistryService,coreSettings:this._coreSettings,hostCommunicationService:this._hostComms,location:e,scenarioCorrelation:n,loggerFactory:this._loggerFactory,userBiService:this._userBiService,isInternalDeeplink:t,commandChangeReportingService:this._commandChangeReportingService,intentPersistenceService:new T_.I(this._localStorage),userContextId:a,client:this._client,preferredCommandInput:i,scenarioFactory:this._scenarioFactory})}catch(e){null===(r=(o=this._logger).errorToTelemetry)||void 0===r||r.call(o,`DeepLink:: ${Gt.ToNavigationIntentFailed}`,"webclient_framework_foundation_core_services_deeplink",void 0,!0)}return s}))}sendDeeplinkReceivedSignal({clientLaunchId:e,correlation:t,deeplinkId:n},i){this._commandChangeReportingService.report({type:Qe.B.NavigationCommandStart,correlationId:t.id,context:{target:"deeplink-service",clientLaunchId:e,correlation:t,eventData:Object.assign({deeplinkId:n,commandSource:t.source,scenarioPhase:"Core"},i)}})}stopNavigationScenarios(e,t,n){this._logger.warn("Navigation intent not found");const i=this._scenarioFactory.findScenario(ee.RG.ApplicationLaunchTime);null==i||i.fail({errorCode:n}),this._commandChangeReportingService.report({type:t,correlationId:e.correlation.id,context:{target:"deeplink-service-handle-url",errorInfo:n}})}}class j_ extends xe{constructor(){super(_.Yg.CreateDeeplinkService,["appsRegistryService","client","commandChangeReportingService","commandHandler","config","coreSettings","correlation","experienceChangeReportingService","hostCommunicationService","localStorage","loggerFactory","scenarioFactory","userBiService","waitForRenderingContextReady","windowProvider"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:n,commandChangeReportingService:i,commandHandler:a,config:o,coreSettings:r,correlation:s,experienceChangeReportingService:l,hostCommunicationService:d,localStorage:c,loggerFactory:u,scenarioFactory:m,userBiService:g,waitForRenderingContextReady:p,windowProvider:h}=e;e.deeplinkService=new M_(u,r,a,n,p,h,t,o,s,m,g,i,d,c,l)}))}}const R_="default";class x_ extends xe{constructor(){super(_.Yg.CreateDefaultCacheStorageAndCacheManagers,["config","loggerFactory","windowProvider","coreSettings","scenarioFactory"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{windowProvider:t,config:n,loggerFactory:i,coreSettings:a,scenarioFactory:o}=e,r=new fd(t.caches,R_,R_,n.experienceName);e.cacheStorage=r,e.offlineCacheManager=new yd(r,i);Oc(a)&&(e.workerCacheManager=Pc(n.experienceName,i.newLogger("CreateDefaultCacheStorageAndCacheManagersTask"),o))}))}}const O_="tmp";class L_{constructor(e,t,n,i,a){this.tid=e,this.oid=t,this.experienceName=n,this.windowProvider=i,this.logger=a.newLogger("LocalStorageService")}set(e,t,n=or.f.UserAndExperience){const i=this.getFormatKey(e,n);return this.windowProvider.localStorage.setItem(i,t)}setSafe(e,t,n=or.f.UserAndExperience){var i,a;try{return this.set(e,t,n),!0}catch(t){return null===(a=(i=this.logger).errorToTelemetry)||void 0===a||a.call(i,`Failed to set key '${e}'`,"webclient_framework_localstorage_setsafe",{errorCode:null==t?void 0:t.name,error:null==t?void 0:t.message},!0),!1}}get(e,t=or.f.UserAndExperience){const n=this.getFormatKey(e,t);return this.windowProvider.localStorage.getItem(n)}remove(e,t=or.f.UserAndExperience){const n=this.getFormatKey(e,t);return this.windowProvider.localStorage.removeItem(n)}clear(e){if(e){const t=e.map((e=>this.getFormatKey("",e)));Object.keys(this.windowProvider.localStorage).filter((e=>e.startsWith(O_)&&t.some((t=>e.startsWith(t))))).forEach((e=>this.windowProvider.localStorage.removeItem(e)))}else this.windowProvider.localStorage.clear()}getFormatKey(e,t){switch(t){case or.f.Experience:return`tmp.${this.experienceName}.${e}`;case or.f.User:return`tmp.${this.tid}.${this.oid}.${e}`;case or.f.Global:return`tmp.${e}`;case or.f.UserAndExperience:default:return`tmp.${this.tid}.${this.oid}.${this.experienceName}.${e}`}}}const U_="default";class B_ extends xe{constructor(){super(_.Yg.CreateDefaultLocalStorage,["config","loggerFactory","windowProvider"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:n,config:i}=e,a=new L_(U_,U_,i.experienceName,t,n);e.localStorage=a}))}}class W_ extends xe{constructor(){super(_.Yg.CreateDiscovery,[])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{onDiscoverSuccess:t,onDiscoverFail:n}=this.getDiscoverCallback(e),{authenticationService:i,loggerFactory:a,coreSettings:o,scenarioFactory:r,appStateService:s,networkState:l,authStateProvider:d,i18n:c}=e,u=(0,od.Gg)(s);e.discover=ad(i,a,ys.l,o,r,u,l,c,d,void 0,t,n,void 0,void 0)}))}getDiscoverCallback(e){var t;let n,i;return(null===(t=e.platformService)||void 0===t?void 0:t.config.hostingParent)===Fo.GJ.Outlook&&(n=()=>{e.windowProvider.sessionStorage.removeItem(kl.v4),e.windowProvider.sessionStorage.removeItem(kl.F_)},i=t=>{t||"true"!==e.windowProvider.sessionStorage.getItem(kl.F_)||(e.windowProvider.sessionStorage.setItem(kl.v4,"true"),e.windowProvider.location.reload())}),{onDiscoverSuccess:n,onDiscoverFail:i}}}var G_;!function(e){e[e.Success=0]="Success",e[e.InvalidArguments=1]="InvalidArguments",e[e.GroupNameExists=2]="GroupNameExists"}(G_||(G_={}));class V_{constructor(e){this.isCompleted=!1,this.subscriptions=new Set,this.observedValue=e,this.observable$=new Nd((e=>(this.subscriptions.add(e),()=>{this.subscriptions.has(e)&&this.subscriptions.delete(e)})))}get observable(){return this.observable$}subscribe(e,t){return this.isCompleted&&t.error("Subject: tried to subscribe to a complete observable"),this.observable$.subscribe(e)}onNext(e){this.observedValue=e,this.subscriptions.forEach((t=>{t.next(Object.assign({},e))}))}onComplete(){this.isCompleted=!0,this.subscriptions.forEach((e=>{e.closed||e.complete()}))}onError(e){this.isCompleted=!0,this.subscriptions.forEach((t=>{t.error(e)}))}get value(){return this.observedValue}}class H_{constructor(){this._endpointsHealthCache={},this._groupsHealthCache={},this.getEndpointHealth=(e,t)=>{if(e&&t){const n=this._endpointsHealthCache[this._getCacheKey(e,t)];return n?Object.assign({},n.value):void 0}},this.observeEndpointHealth=(e,t)=>e&&t?this._getHealthRecord(e,t).observable:void 0,this.observeAggregatedHealth=e=>e?this._getHealthRecord(e,void 0).observable:void 0,this.dumpState=()=>JSON.stringify(Object.assign(Object.assign({},this._endpointsHealthCache),this._groupsHealthCache),((e,t)=>t instanceof V_?t.value:t)),this.updateRemoteEndpointHealth=e=>{if(!e.serviceName)return;const t=this._getHealthRecord(e.serviceName,e.endpointName);t.value.isHealthy!==e.isHealthy&&(t.value.isHealthy=e.isHealthy,t.onNext(t.value))},this._getCacheKey=(e,t)=>`${e}_${t||""}`,this._getHealthRecord=(e,t)=>(t?this._endpointsHealthCache[this._getCacheKey(e,t)]:this._groupsHealthCache[this._getCacheKey(e,t)])||this._startTrackingHealth(e,t),this._startTrackingHealth=(e,t)=>{if(t){const n=new V_({serviceName:e,endpointName:t,isHealthy:void 0});return this._endpointsHealthCache[this._getCacheKey(e,t)]=n,n}{const n=new V_({groupName:e,isHealthy:void 0});return this._groupsHealthCache[this._getCacheKey(e,t)]=n,n}}}getAggregatedHealth(e){if(e){const t=this._groupsHealthCache[this._getCacheKey(e,void 0)];return t?Object.assign({},t.value):void 0}}dispose(){this._endpointsHealthCache={},this._groupsHealthCache={}}}class $_{constructor(e,t){this._endpointsManager=e,this._logger=t,this._subscriptions=[],this._aggregatedHealthMap=new Map,this._remoteEndpointsHealthCache=new H_,this.observeEndpointHealth=(e,t)=>this._getLocalEndpointHealth(e,t)?this._getLocalEndpointObservable(e,t):this._getRemoteEndpointHealth(e,t)?this._getRemoteEndpointObservable(e,t):this._getLocalEndpointObservable(e,t),this.getEndpointHealth=(e,t)=>this._getLocalEndpointHealth(e,t)||this._getRemoteEndpointHealth(e,t),this.observeAggregatedHealth=e=>{var t;return null===(t=this._aggregatedHealthMap.get(e))||void 0===t?void 0:t.healthSubject.observable},this.getAggregatedHealth=e=>this._getLocalAggregatedHealth(e)||this._getRemoteAggregatedHealth(e),this.dumpState=()=>(0,R.LQ)(`{ "aggregated endpoints health": [\n      ${this._printAggregatedHealth(this._aggregatedHealthMap)}\n    ],\n    "endpoints health": [\n      ${this._endpointsManager.health.dumpState()}\n    ]},\n    "remote endpoints health": ${this._remoteEndpointsHealthCache.dumpState()}`),this.getWorkerDumpState=()=>this._requestWorkerStateDumpCallback?(this._deferredWorkerStateDump=(0,Rd.P)(),this._requestWorkerStateDumpCallback(),this._deferredWorkerStateDump.promise):Promise.reject("Worker endpoints health snapshot can't be requested"),this.getEndpointsHealthUpdateHandler=()=>({handleEndpointHealthUpdate:this._remoteEndpointsHealthCache.updateRemoteEndpointHealth,handleStateDump:this._handleWorkerStateDumpResponse,onStateDumpRequest:this._setWorkerStateDumpRequestCallback}),this._getLocalEndpointHealth=(e,t)=>this._endpointsManager.health.getEndpointHealth(e,t),this._getLocalEndpointObservable=(e,t)=>this._endpointsManager.health.observeEndpointHealth(e,t),this._getRemoteEndpointHealth=(e,t)=>this._remoteEndpointsHealthCache.getEndpointHealth(e,t),this._getRemoteEndpointObservable=(e,t)=>this._remoteEndpointsHealthCache.observeEndpointHealth(e,t),this._updateAggregatedHealth=(e,t,n)=>{const i=e.healthSubject.value,a=[];if(i.endpoints)for(const e of i.endpoints)if(e.endpointName===t.endpointName&&e.serviceName===t.serviceName)a.push(t);else{const t=this._endpointsManager.health.getEndpointHealth(e.serviceName,e.endpointName);t&&a.push(t)}try{const t=n(a);t!==i.isHealthy&&(i.isHealthy=t,e.healthSubject.onNext(i))}catch(e){this._logger.error(`Error happened in aggregated group health policy. Group: ${i.groupName}. Error: ${JSON.stringify(e.reason||e)}`)}},this._printAggregatedHealth=e=>{let t="";return e.forEach((e=>{t=`${t},${JSON.stringify(e.healthSubject.value)}`})),t?(0,R.LQ)(t):""},this._handleWorkerStateDumpResponse=e=>{this._logger.log("Received worker endpoints health state dump."),this._deferredWorkerStateDump&&(this._deferredWorkerStateDump.resolve(e),this._deferredWorkerStateDump=void 0)},this._setWorkerStateDumpRequestCallback=e=>{this._requestWorkerStateDumpCallback=e}}createAggregatedHealthGroup(e,t,n){if(!e||0===e.length||!t||0===t.length)return this._logger.error(`createAggregatedHealthGroup: Group name is empty or no endpoints are provided. groupName: ${e}; endpoints: ${t&&JSON.stringify(t)}`),G_.InvalidArguments;if(this.getAggregatedHealth(e))return this._logger.error(`createAggregatedHealthGroup: Group name already exists. groupName: ${e}`),G_.GroupNameExists;const i={healthSubject:new V_({groupName:e,endpoints:t,isHealthy:void 0})};return this._aggregatedHealthMap.set(e,i),t.forEach((t=>{var i;const a=null===(i=this.observeEndpointHealth(t.serviceName,t.endpointName))||void 0===i?void 0:i.subscribe((t=>{const i=this._aggregatedHealthMap.get(e);i||this._logger.error(`Can't update group health. Group '${e}' is not registered`),i&&this._updateAggregatedHealth(i,t,n)}));a&&this._subscriptions.push(a)})),G_.Success}dispose(){var e;this._subscriptions.map((e=>e.unsubscribe())),this._subscriptions=[],this._aggregatedHealthMap.clear(),this._remoteEndpointsHealthCache.dispose(),this._requestWorkerStateDumpCallback=void 0,null===(e=this._deferredWorkerStateDump)||void 0===e||e.reject("CombinedEndpointsHealthService is disposed"),this._deferredWorkerStateDump=void 0}_getLocalAggregatedHealth(e){var t;return null===(t=this._aggregatedHealthMap.get(e))||void 0===t?void 0:t.healthSubject.value}_getRemoteAggregatedHealth(e){return this._remoteEndpointsHealthCache.getAggregatedHealth(e)}}class z_{constructor(e,t){this._endpointsManager=e,this._logger=t,this._subscriptions=[],this._aggregatedHealthMap=new Map,this.observeEndpointHealth=(e,t)=>this._endpointsManager.health.observeEndpointHealth(e,t),this.getEndpointHealth=(e,t)=>this._endpointsManager.health.getEndpointHealth(e,t),this.observeAggregatedHealth=e=>{var t;return null===(t=this._aggregatedHealthMap.get(e))||void 0===t?void 0:t.healthSubject.observable},this.getAggregatedHealth=e=>{var t;return null===(t=this._aggregatedHealthMap.get(e))||void 0===t?void 0:t.healthSubject.value},this.dumpState=()=>`{ "aggregated endpoints health": [\n      ${this._printAggregatedHealth(this._aggregatedHealthMap)}\n    ],\n    "endpoints health": [\n      ${this._endpointsManager.health.dumpState()}\n    ]}`,this._updateAggregatedHealth=(e,t,n)=>{const i=e.healthSubject.value,a=[];if(i.endpoints)for(const e of i.endpoints)if(e.endpointName===t.endpointName&&e.serviceName===t.serviceName)a.push(t);else{const t=this._endpointsManager.health.getEndpointHealth(e.serviceName,e.endpointName);t&&a.push(t)}try{const t=n(a);t!==i.isHealthy&&(i.isHealthy=t,e.healthSubject.onNext(i))}catch(e){this._logger.error(`Error happened in aggregated group health policy. Group: ${i.groupName}. Error: ${JSON.stringify(e.reason||e)}`)}},this._printAggregatedHealth=e=>{let t="";return e.forEach((e=>{t=`${t},${JSON.stringify(e.healthSubject.value)}`})),t?(0,R.LQ)(t):""}}createAggregatedHealthGroup(e,t,n){if(!e||0===e.length||!t||0===t.length)return this._logger.error(`createAggregatedHealthGroup: Group name is empty or no endpoints are provided. groupName: ${e}; endpoints: ${t&&JSON.stringify(t)}`),G_.InvalidArguments;if(this.getAggregatedHealth(e))return this._logger.error(`createAggregatedHealthGroup: Group name already exists. groupName: ${e}`),G_.GroupNameExists;const i={healthSubject:new V_({groupName:e,endpoints:t,isHealthy:void 0})};return this._aggregatedHealthMap.set(e,i),t.forEach((t=>{var i;const a=null===(i=this.observeEndpointHealth(t.serviceName,t.endpointName))||void 0===i?void 0:i.subscribe((t=>{const i=this._aggregatedHealthMap.get(e);i||this._logger.error(`Can't update group health. Group '${e}' is not registered`),i&&this._updateAggregatedHealth(i,t,n)}));a&&this._subscriptions.push(a)})),G_.Success}dispose(){this._subscriptions.map((e=>e.unsubscribe())),this._subscriptions=[],this._aggregatedHealthMap.clear()}}var q_=n(96514),J_=n(69887);const Q_=({url:e,method:t,body:n,headers:i,cancellationToken:a,credentials:o,timeout:r},s,l,d)=>{let c;if(a&&(c=l.get(a),null==c?void 0:c.signal.aborted))throw(0,ds.T)(ls.A.RequestCancelled);return cs(J_(e,{method:t,headers:i&&new Headers(i),body:n,signal:c&&c.signal,credentials:o}),s,null!=r?r:d.defaultRequestTimeoutInMs).then((e=>{var t;const n={};return null===(t=e.headers)||void 0===t||t.forEach(((e,t)=>n[t]=e)),{status:e.status,headers:n,body:e,url:e.url}}))};const K_=(e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){try{return yield t(e)}catch(e){throw(0,ds.T)(ls.A.AuthFailed,void 0,e)}})),Y_=(e,t,n)=>(0,c.mG)(void 0,void 0,void 0,(function*(){var i;const a=null===(i=t.operationLogger)||void 0===i?void 0:i.beginStep(Ts.nz.AuthResolve,t);try{const i=n(e,t);return i.then((t=>(a&&t&&a({result:Ts.qb[e.status]},e),t))),yield i}catch(t){throw(0,ds.T)(ls.A.AuthResolveFailed,e,t)}}));function X_(e,t=Ts.qb.NOT_FOUND){return Array.isArray(t)?t.some((t=>Z_(e,t))):Z_(e,t)}function Z_(e,t){return"string"==typeof t?new RegExp(t.replace(/x/gi,"\\d")).test(e.toString()):e===t}const eI=(e,t)=>t.indexOf(e)>-1||t.filter(tI).map((e=>new RegExp(e.replace(/x/gi,"\\d")))).some((t=>t.test(e.toString())));function tI(e){return"string"==typeof e}const nI=(e,t,n,{globalContext:i})=>a=>(0,c.mG)(void 0,void 0,void 0,(function*(){var o,r;let s=yield iI(e)(a);for(let l=0;;l++){const{response:d,error:c}=s,u=null==d?void 0:d.status,m=u||(null==c?void 0:c.reason)||ls.A.FailedToFetch,g=null==d?void 0:d.headers,p=n.get(m)||0;if(n.set(m,p+1),!t.shouldRetry(l,m,n,g)){if(c)throw c;return s.response}{const n=t.nextDelay(l,g,m),p=u&&Ts.qb[u]||void 0;null===(o=a.operationLogger)||void 0===o||o.nextStep(Ts.nz.RetryDelay,{result:p,resultError:c},void 0,d),yield us(n,i),null===(r=a.operationLogger)||void 0===r||r.nextStep(Ts.nz.Retry,{result:Ts.qb.OK.toString()},a),s=yield iI(e)(a)}}})),iI=e=>t=>(0,c.mG)(void 0,void 0,void 0,(function*(){try{return{response:yield e(t)}}catch(e){return{response:e.serverResponse,error:e}}}));const aI=(e,t,n,i)=>{const{cancellationMap:a}=i;let o=e;return n.authResource&&(o=((e,t)=>n=>(0,c.mG)(void 0,void 0,void 0,(function*(){var i,a;const o=null===(i=n.operationLogger)||void 0===i?void 0:i.logStep(Ts.nz.AuthDecorate),r=yield K_(n,t);if(o&&o({result:Ts.qb.OK.toString()}),!r)throw(0,ds.T)(ls.A.AuthFailed);const s=yield e(r.request),l=yield Y_(s,r.request,r.resolver);return l?(null===(a=l.operationLogger)||void 0===a||a.nextStep(Ts.nz.Auth,{result:Ts.qb[s.status]},l,s),e(l)):s})))(o,n.authResource)),o=((e,t,n)=>i=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{baseUrl:a,baseUrlPromise:o}=t,r=a||o&&(yield cs(o().catch((e=>{throw(0,ds.T)(ls.A.BaseUrlFailedToResolve,void 0,e)})),n.globalContext,n.configuration.baseUrlResolutionTimeoutInMs,ls.A.BaseUrlTimeout));try{if(r){const e=!r.endsWith("/")&&i.url.length>0?`${r}/`:r,t=i.url.startsWith("/")?i.url.substring(1):i.url;i.url=new URL(t,e).href}}catch(e){throw(0,ds.T)(ls.A.InvalidUrl)}return e(i)})))(o,n,i),o=((e,t,n)=>{if(!t.redirectPolicy)return e;const{maxRedirects:i,useAbsoluteRedirect:a,headers:o,redirectOn:r,onRedirect:s}=t.redirectPolicy;return t=>(0,c.mG)(void 0,void 0,void 0,(function*(){var l;const d=Object.assign(Object.assign({},t),{headers:Object.assign(Object.assign({},t.headers),o)});let c=yield e(d);for(let o=0;;o++){const{status:u,headers:{location:m}}=c;if(!(o<i&&X_(u,r)))return c;try{let e;if(s?e=s(m,u):m&&(e=new URL(m)),!e)return c;a?(n.baseUrl=e.origin,d.url=e.pathname):(d.url=t.url,n.baseUrl=e.href)}catch(e){throw(0,ds.T)(ls.A.InvalidUrl,void 0,e)}null===(l=d.operationLogger)||void 0===l||l.nextStep(Ts.nz.Redirect,{result:Ts.qb[c.status]},d,c),c=yield e(d)}}))})(o,t,n),t.rejectHttpError&&(o=function(e){return t=>(0,c.mG)(this,void 0,void 0,(function*(){const n=yield e(t);if(n.status>=Ts.qb.BAD_REQUEST)throw(0,ds.T)(ls.A.RequireStatusFailed,n);return n}))}(o)),t.allowedResponses&&(o=function(e,...t){return n=>e(n).then((e=>{if(eI(e.status,t))return e;const n=[Ts.qb[e.status]];throw(0,ds.T)(ls.A.RequireStatusFailed,e,n)}))}(o,...t.allowedResponses)),t.retryPolicy&&(o=function(e,t,n){const i=new Map;return a=>nI(e,t,i,n)(a)}(o,t.retryPolicy,i)),o=((e,t)=>n=>(0,c.mG)(void 0,void 0,void 0,(function*(){const{cancellationToken:i}=n;i&&t.set(i,new AbortController);try{return yield e(n)}finally{i&&t.delete(i)}})))(o,a),o},oI=e=>{const t=[];let n;const i=(e,n,i)=>{const a=new Date;return(o,r,s)=>{t.push({type:e,duration:o-n,result:r,request:rI(a,i,s)})}},a=(e,t)=>{const a=performance.now();return(o,r)=>{n(a,o,r),n=i(e,a,t)}};return n=i(Ts.nz.Initial,performance.now(),e),{nextStep:(e,t,n,i)=>{a(e,n)(t,i)},beginStep:a,logStep:(e,t,n)=>{const a=i(e,performance.now(),t);return e=>a(performance.now(),e,n)},complete:(e,i)=>(n(performance.now(),e,i),t)}};function rI(e,t,n){if(!t)return;const i=n?new URL(n.url).hostname:"";return{name:t.apiName||"",dateTime:e,method:t.method,hostname:i,requestHeaders:t.headers||{},responseHeaders:(null==n?void 0:n.headers)||{},status:null==n?void 0:n.status,performance:sI(null==n?void 0:n.url),authPerformanceLogs:t.authPerformanceLogs||{}}}function sI(e){if(e){const t=performance.getEntriesByName(e);if(t.length>0&&"resource"===t[t.length-1].entryType){const e=t[t.length-1],{name:n,entryType:i}=e;return(0,c._T)(e,["name","entryType"])}}}class lI{constructor(e){this.subscriptions=new Set,this.observedValue=e,this.observable$=new Nd((e=>(this.subscriptions.add(e),()=>{this.subscriptions.has(e)&&this.subscriptions.delete(e)})))}get observable(){return this.observable$}subscribe(e){return this.observable$.subscribe(e)}onNext(e){this.observedValue=e,this.subscriptions.forEach((t=>{t.next(e)}))}onComplete(){this.subscriptions.forEach((e=>{e.closed||e.complete()}))}onError(e){this.subscriptions.forEach((t=>{t.error(e)}))}get value(){return this.observedValue}}const dI=!0,cI=new lI(dI);const uI=()=>{const e=new Map,t=(t,n)=>e.get(pI(t,n))||((t,n)=>{const i={responseHistory:[],healthSubject:new lI({serviceName:t,endpointName:n,isHealthy:void 0})};return e.set(pI(t,n),i),i})(t,n),n=(e,n,i,a)=>{const o=t(n,e);((e,t,n)=>{e.responseHistory.push(t),e.responseHistory.length>n&&e.responseHistory.shift()})(o,i,a.historyLength);const r=a.isHealthy([...o.responseHistory]);if(o.healthSubject.value.isHealthy!==r){const t={serviceName:n,endpointName:e,isHealthy:r};o.healthSubject.onNext(t)}};return{trackHealth:(e,t,i)=>hI(e,n,t,mI(i)),observeEndpointHealth:(e,n)=>{if(!e||!n)return;return t(e,n).healthSubject.observable},getEndpointHealth:(t,n)=>gI(t,n,e),dumpState:()=>SI(e)}},mI=e=>Object.assign(Object.assign({},vI),e),gI=(e,t,n)=>{var i;const a=null===(i=n.get(pI(e,t)))||void 0===i?void 0:i.healthSubject.value;return a&&Object.assign({},a)},pI=(e,t)=>`${e}_${t}`,hI=(e,t,n,i)=>a=>(0,c.mG)(void 0,void 0,void 0,(function*(){return e(a).then((e=>(t(a.apiName||"",n,e.status,i),e))).catch((e=>{throw t(a.apiName||"",n,e.reason,i),e}))})),vI={isHealthy:e=>{if(e&&e.length>0){const t=e[e.length-1];if("number"!=typeof t&&t!==ls.A.RequestCancelled)return!1}return!0},historyLength:5};const SI=e=>{let t="";return e.forEach((e=>{t=`${t}${JSON.stringify(e.healthSubject.value)}`})),t?null==(n=t)||0===n.length?n:` ${n}`.substr(1):"";var n},fI=e=>t=>(0,c.mG)(void 0,void 0,void 0,(function*(){var n,i;try{if(e.transformResponse)return yield e.transformResponse(t);const a=e.responseType||function(e){if(e.headers){const t=e.headers["content-type"];if(t){if(-1!==t.indexOf("application/json"))return"json";if(-1!==t.indexOf("text/"))return"text"}if("0"===e.headers["content-length"])return"text"}return}(t)||"json";return yield t.body&&(null===(i=(n=t.body)[a])||void 0===i?void 0:i.call(n))}catch(e){throw"AbortError"===e.name?(0,ds.T)(ls.A.RequestCancelled):(0,ds.T)(ls.A.TransformFailed,t,e)}}));const yI=(e,t,n)=>{let i,a;return t.then((e=>{if(e.throttlePolicy){a=e.throttlePolicy;const t=null==a?void 0:a.throttleKey;t?(i=n.get(t)||[],n.has(t)||n.set(t,i)):i=[]}})),t=>a?n=>function n(o){var r;return(0,c.mG)(this,void 0,void 0,(function*(){const s=function(e,t){const{maxPerThrottleInterval:n,throttleInterval:i}=t,a=Date.now()-i;let o=e.length-1;for(;o>=0&&a<e[o];)o--;e.splice(0,o);const r=e.length-n;return r>=0?e[r]-a:0}(i,a);if(!s)return function(e){return i.push(Date.now()),t(e)}(o);const l=null===(r=o.operationLogger)||void 0===r?void 0:r.logStep(Ts.nz.Throttle);return yield us(s,e),l&&l({result:Ts.qb.OK.toString()}),n(o)}))}(n):t};function kI(e,t){const{globalContext:n}=t,i=new Map,a=new Map,{networkMonitor:o,networkState:r}=(()=>{const e=e=>cI.onNext(e);return{networkMonitor:{processResponse:t=>{void 0!==t.status&&e(dI)},processResponseError:t=>{t&&(t.reason===ls.A.RejectHttpError?e(!1):t.serverResponse&&e(dI))}},networkState:{observeIsOnline:()=>cI.observable,isOnline:()=>cI.value}}})(),s=((e,t)=>n=>(0,c.mG)(void 0,void 0,void 0,(function*(){return t(n).then((t=>(e.processResponse(t),t))).catch((t=>{throw e.processResponseError(t),t}))})))(o,function(e){return t=>(0,c.mG)(this,void 0,void 0,(function*(){var n;try{return yield e(t)}catch(e){if(e instanceof TypeError&&"failed to fetch"===(null===(n=e.message)||void 0===n?void 0:n.toLowerCase())){const n=t.headers&&t.headers.cache;if(n&&-1!==n.indexOf("only-if-cached"))return{status:Ts.qb.GATEWAY_TIMEOUT};e=(0,ds.T)(ls.A.RejectHttpError,void 0,e)}throw"AbortError"===e.name&&(e=(0,ds.T)(ls.A.RequestCancelled)),e}}))}(((e,t,n)=>i=>(0,c.mG)(void 0,void 0,void 0,(function*(){return Q_(i,e,t,n)})))(n,i,t.configuration))),l=uI(),{trackHealth:d}=l;return{createApi:n=>CI(n,e,Object.assign(Object.assign({},t),{cancellationMap:i,trackHealth:d,throttleMap:a}),s),createCancelToken:()=>{const e=(0,Je.v4)();return{token:e,cancel:()=>{const t=i.get(e);return t&&t.abort(),!t}}},networkState:r,health:(0,c._T)(l,["trackHealth"])}}const CI=(e,t,n,i)=>{const a={},o=e(t),{baseUrlPromise:r,models:s}=o;r&&r();for(const e in s){const t=s[e];a[e]=bI(e,t,o,n,i)}return a},bI=(e,t,n,i,a)=>{const{trackHealth:o,throttleMap:r,globalContext:s}=i,l=yI(s,t,r),{telemetryProvider:d}=i,{serviceName:u}=n;return(...r)=>(0,c.mG)(void 0,void 0,void 0,(function*(){var c,m;let g,p,h,v;const S=(new Date).toISOString(),f=performance.now();try{const y=yield cs(t.catch((e=>{throw(0,ds.T)(ls.A.ModelFailedToInitialize,void 0,e)})),s,i.configuration.modelInitializationTimeoutInMs,ls.A.ModelTimeOut);let k=aI(a,y,n,i);const C=y.constructRequest(...r);k=o(k,n.serviceName,y.healthPolicy),k=l(k),g=Object.assign(Object.assign({},C),{serviceName:n.serviceName,operationLogger:oI(C)});try{v=null===(c=y.customTelemetry)||void 0===c?void 0:c.call(y,...r)}catch(e){throw(0,ds.T)(ls.A.CustomTelemetryFailed,void 0,e)}return p=yield k(g),fI(y)(p)}catch(e){throw e.serverResponse&&(p=e.serverResponse),h=e,e}finally{const t=performance.now()-f,n=null==g?void 0:g.correlationId,i=null==p?void 0:p.status,a=i&&Ts.qb[i]||void 0,o=(null===(m=null==g?void 0:g.operationLogger)||void 0===m?void 0:m.complete({result:a,resultError:h},p))||[],r=(null==h?void 0:h.reason)||a||"";d({apiName:e,serviceName:u,createdTime:S,parameters:v,duration:t,result:r,innerError:null==h?void 0:h.innerException,operationLogs:o,correlationId:n})}}))};class TI extends xe{constructor(){super(_.Yg.CreateEndpointsManager,["coreSettings"])}execute(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const{loggerFactory:n,windowProvider:i,coreSettings:a}=e,{disableEndpointsHealthService:o,enableCombinedEndpointsHealthService:r}=a.get(A.J.Core);var s;e.endpointsManager=kI(e,{globalContext:i,telemetryProvider:(0,q_.YK)(i,n.newLogger("EPM"),null===(t=e.authenticationUser)||void 0===t?void 0:t.id),configuration:(s=a.get(A.J.Core),{modelInitializationTimeoutInMs:s.endpointsManagerModelInitializationTimeoutInMs||3e4,baseUrlResolutionTimeoutInMs:s.endpointsManagerBaseUrlResolutionTimeoutInMs||12e4,defaultRequestTimeoutInMs:s.endpointsManagerDefaultRequestTimeoutInMs||3e4})}),o?n.newLogger("EndpointsHealthService").log("Disabled by disableEndpointsHealthService feature flag"):(e.endpointsHealthService=r?new $_(e.endpointsManager,n.newLogger("CombinedEndpointsHealthService")):new z_(e.endpointsManager,n.newLogger("EndpointsHealthService")),(0,Jn.G)().setEndpointHealth(e.endpointsHealthService.getEndpointHealth))}))}}const wI={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CoreServicesTasksRemoveUserActiveWindowsMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeUserActiveWindows"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userContextId"},value:{kind:"Variable",name:{kind:"Name",value:"userContextId"}}}]}]}}]};class _I extends xe{constructor(){super(_.Yg.CreateEntityCommanding,[])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{client:t,commandHandler:n,commandDelegator:i,eventHandler:a,windowProvider:o,hostCommunicationService:r,scenarioFactory:s,loggerFactory:l,deeplinkService:d,coreSettings:u}=hm("CreateEntityCommandingTask",e,"client","commandHandler","commandDelegator","eventHandler","windowProvider","hostCommunicationService","scenarioFactory","loggerFactory","deeplinkService","coreSettings"),m=e.authenticationUser?(0,qe.b)(e.authenticationUser):void 0,{entityCommanding:g,eventing:p}=ha(n,i,a,t,u,o,s,l,d,r,m);return e.entityCommanding=g,e.eventing=p,e=>(0,c.mG)(this,void 0,void 0,(function*(){switch(e){case"signout":yield t.mutate({mutation:wI,variables:{userContextId:m}})}}))}))}}class II extends xe{constructor(){super(_.Yg.CreateEventHandler,["appsRegistryService","client","commandChangeReportingService","coreSettings","loggerFactory","scenarioFactory","userBiService"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:n,commandChangeReportingService:i,coreSettings:a,loggerFactory:o,scenarioFactory:r,userBiService:s}=e;e.eventHandler=(e,l,d)=>Ut({appsRegistryService:t,client:n,commandChangeReportingService:i,commandDelegator:d,commandHandler:l,coreSettings:a,eventInput:e,loggerFactory:o,scenarioFactory:r,userBiService:s})}))}}const AI={RejectIncomingCall:dr.Yu.toastCallingRejectIncomingCall,IgnoreIncomingCall:dr.Yu.toastCallingIgnoreIncomingCall,AcceptIncomingCallContentOnly:dr.Yu.toastCallingAcceptIncomingCallContentOnly,AcceptIncomingCallThroughPrejoin:dr.Yu.toastCallingAcceptIncomingCallThroughPrejoin,AcceptIncomingCallWithAudio:dr.Yu.toastCallingAcceptIncomingCallWithAudio,AcceptIncomingCallWithVideo:dr.Yu.toastCallingAcceptIncomingCallWithVideo,AcceptIncomingScreenshareOnlyCall:dr.Yu.toastCallingAcceptIncomingScreenshareOnlyCall,Error:dr.Yu.toastCallingError,NavigateToCallTab:dr.Yu.toastCallingNavigateToCallTab,ReplyIncomingCall:dr.Yu.toastCallingReplyIncomingCall,ResumeCallTransfer:dr.Yu.toastCallingResumeCallTransfer,TimeOut:dr.Yu.toastCallingTimeOut,Unknown:dr.Yu.toastCallingUnknown},NI={RejectIncomingCall:dr.rA.toastRejectIncomingCall,AcceptIncomingCallContentOnly:dr.rA.toastAcceptIncomingCall,AcceptIncomingCallThroughPrejoin:dr.rA.toastAcceptIncomingCall,AcceptIncomingCallWithAudio:dr.rA.toastAcceptIncomingCall,AcceptIncomingCallWithVideo:dr.rA.toastAcceptIncomingCall,AcceptIncomingScreenshareOnlyCall:dr.rA.toastAcceptIncomingCall,ReplyIncomingCall:dr.rA.toastReplyIncomingCall,ResumeCallTransfer:dr.rA.toastResumeCallTransfer},EI=(e,t)=>{const{dataOptions:n,entity:i}=t;(null==n?void 0:n.actionType)===Hn.quickReply&&e.recordPanelAction({actionGesture:dr.uS.click,actionScenario:dr.Tk.toastActivation,actionScenarioType:dr.Yu.quickReplyFromToast,moduleName:dr.rA.chatToastQuickreply}),i.action!==Ie.u.view||(null==n?void 0:n.actionType)||e.recordPanelAction({actionGesture:dr.uS.click,panelRegion:dr.Ai.toast,panelType:dr.wh.chatToast,actionScenario:dr.Tk.toastActivation,actionScenarioType:dr.Yu.openChatConversationFromToast})},DI=(e,t)=>{const{entity:n}=t;n.action===Ie.u.view&&e.recordPanelAction({actionGesture:dr.uS.click,panelRegion:dr.Ai.toast,panelType:dr.wh.channelsToast,actionScenario:dr.Tk.toastActivation,actionScenarioType:dr.Yu.openChannelsConversationFromToast})},FI=(e,t)=>{const{dataOptions:n,entity:i}=t,{toastType:a,teamId:o}=n;let r;e.createDatabag&&(r=e.createDatabag(),r.communitiesToastType=a),i.action===Ie.u.view&&e.recordPanelAction({actionGesture:dr.uS.click,panelRegion:dr.Ai.toast,panelType:dr.wh.communitiesToast,actionScenario:dr.Tk.toastActivation,actionScenarioType:dr.Yu.openCommunitiesConversationFromToast,teamId:o,dataBag:r})},PI=(e,t)=>{var n;const{dataOptions:i}=t;if(!i)return;const{actionType:a,toastType:o}=i,r=AI[a],s=NI[a];let l;e.createDatabag&&(l=e.createDatabag(),l.correlationId=null===(n=t.command)||void 0===n?void 0:n.correlation.id,l.callingToastType=o),r&&e.recordPanelAction({actionGesture:dr.uS.click,panelRegion:dr.Ai.toast,panelType:dr.wh.callingToast,actionScenario:dr.Tk.toastActivation,actionScenarioType:r,moduleName:s,dataBag:l}),null==l||l.dispose()};function MI(e,t,n,i,o){const r=e.newLogger("External Command Listener"),s=jI(r,o);if(t.opener.addEventListener("executeEntityCommand",s),i.get(A.J.Core).enableHostCommandListener){const e=e=>{const{entity:t}=e,{type:n}=t;switch(n){case a.calls:case a.chats:case a.toasts:case a.extensions:case a.channels:case a.reminders:case a.activity:case a.campaignnotifications:case a.communities:return s(Vu(e,r));case a.signout:return function(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){try{yield e(Object.assign(Object.assign({},Bu),{payload:{entity:{type:Ie.p.default,action:Ie.u.default},command:{visibilityState:Ae.fe.show,stateTransition:Ae.su.flush}}})),t.log("HostComms:: Executed default command"),yield e(Object.assign(Object.assign({},Bu),{payload:{entity:{type:Ie.p.signoutdialog,action:Ie.u.view},command:{visibilityState:Ae.fe.show,stateTransition:Ae.su.extend}}})),t.log("HostComms:: Executed signout modal command")}catch(e){throw t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: SignoutCommandFailed - ${(0,R.u4)(e)}`,"webclient_framework_host_comms",void 0,!0),e}}))}(s,r);default:return s(Bu)}};n.loadModule("core").then((t=>{var n;t&&(null===(n=t.registerForOnExecuteCommand)||void 0===n||n.call(t,e))})).catch((e=>{var t;null===(t=r.errorToTelemetry)||void 0===t||t.call(r,`Loading core host comms module failed with: ${(0,R.u4)(e)}`,"webclient_framework_host_comms",void 0,!0)}))}return Promise.resolve()}const jI=(e,t)=>({payload:n})=>(0,c.mG)(void 0,void 0,void 0,(function*(){const i=t=>{var n;return null===(n=e.errorToTelemetry)||void 0===n?void 0:n.call(e,t,"webclient_framework_foundation_external_command_listener",void 0,!0)};try{if(n&&n.entity&&n.command&&n.entity.type in Ie.p&&n.entity.action in Ie.u&&n.command.visibilityState in Ae.fe&&n.command.stateTransition in Ae.su){const{entity:a,entityOptions:o,dataOptions:r,command:s,windowOptions:l}=n,{linkedEntity:d}=a;if(d){if(!d.id||!(d.type in Ie.p))return i(`Missing id ${!d.id} or linked entity type ${d.type}`),Promise.reject()}else a.linkedEntity=null;s.correlation=s.correlation||{},s.correlation.source=s.correlation.source||I.D.ExternalCommand;const c=null==r?void 0:r.userContextId;e.debug(`got userContextId: ${c} from dataOptions`);const u=t(!1,c),m=1e4;(0,Oe.E)(u,m).catch((()=>{i(`waitForRenderingContextReady timed out after ${m}ms`)}));const g=yield u;e.debug(`got renderingContext for userContextId: ${c}`);const p={dataOptions:r,entity:a,entityOptions:o,command:nt(s),windowOptions:l};return((e,t,n)=>{if(!e)return void t.error("coreServicesEntityCommanding: UserBiService is not available.");const i={[Ie.p.chats]:EI,[Ie.p.channels]:DI,[Ie.p.calls]:PI,[Ie.p.communities]:FI}[n.entity.type];i&&i(e,n)})(g.userBiService,e,p),g.commandHandler(p)}const a=function(e){let t=`payload(${!!e})`;if(e){const{entity:n,command:i}=e;if(t+=` entity(${!!n}) command(${!!i})`,n&&i){const{type:e,action:a}=n,{visibilityState:o,stateTransition:r}=i;t+=` type(${e}) action(${a})`,t+=` visibilityState(${o}) stateTransition(${r})`}}return t}(n);return i(`Invalid payload for executeEntityCommand handler: ${a}`),Promise.reject()}catch(e){i(`Error thrown from external command listener: ${(0,R.u4)(e)}`)}}));class RI extends xe{constructor(){super(_.Yg.CreateExternalCommandListener,["windowProvider","loggerFactory","hostCommunicationService","coreSettings","waitForRenderingContextReady"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:n,hostCommunicationService:i,coreSettings:a,waitForRenderingContextReady:o}=e;return MI(n,t,i,a,o)}))}}class xI{constructor(){this.countBasedLogs=this.initializeLogs(),this.countBasedTotalLogs=[],this.currentBuffer=0}addOperation(e,t,n){if(t&&e)if(this.countBasedLogs[t][e]){const i=this.countBasedLogs[t][e];"Request"===n?i.requestCount++:i.responseCount++}else this.countBasedLogs[t][e]={requestCount:"Request"===n?1:0,responseCount:"Response"===n?1:0,errorCount:"Error"===n?1:0}}getLatestDataAndClear(){const e=(0,Z.clone)(this.countBasedLogs);return this.currentBuffer>=40&&(this.currentBuffer=0),this.countBasedTotalLogs[this.currentBuffer++]=e,this.countBasedLogs=this.initializeLogs(),e}getCompleteDataLogs(){return this.countBasedTotalLogs.length<40?this.countBasedTotalLogs:this.countBasedTotalLogs.slice(this.currentBuffer).concat(this.countBasedTotalLogs.slice(0,this.currentBuffer))}initializeLogs(){return{subscription:{},mutation:{},query:{}}}}class OI extends xe{constructor(){super(_.Yg.CreateGraphQlOpsService,["coreSettings"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{enableGraphQlOpsCount:t,enableGraphQlOpsCountInConsole:n}=e.coreSettings.get(A.J.Core);let i;if(t&&(i=new xI,e.graphqlOpsCountService=i),n){const e=window;e.hooks||(e.hooks={}),e.hooks.graphQlOpsCountServiceHook=i}}))}}var LI=n(98067);class UI{constructor(){this.stats={},this.counter=0,this.tracked={}}getTelemetry(){const e=this.stats;return this.stats={},e}trackCall(e,t){this.getOrCreateStore(e).methodCalls[t]++}trackSubscribeEvent(e){this.getOrCreateStore(e).subscribeEvents++}markReadStart(e,t){return this.mark(BI("read",e,t))}markReadEnd(e){this.markEnd(e)}markReadError(e){this.markError(e)}markDiffStart(e,t){return this.mark(BI("diff",e,t))}markDiffEnd(e){this.markEnd(e)}markDiffError(e){this.markError(e)}markWriteStart(e,t){return this.mark(BI("write",e,t))}markWriteEnd(e){this.markEnd(e)}markWriteError(e){this.markError(e)}mark(e){const t=""+this.counter++;return this.tracked[t]=e,t}markEnd(e){const t=this.tracked[e];if(delete this.tracked[e],t){const e=performance.now()-t.start;this.update("success",t,e)}}markError(e){const t=this.tracked[e];if(delete this.tracked[e],t){const e=performance.now()-t.start;this.update("error",t,e)}}update(e,t,n){const i=this.getOrCreateStore(t.storeType)[t.kind];i.count++,"error"===e&&i.errors++,i.min=Math.min(null!==i.min?i.min:Number.MAX_VALUE,n),(null==i.max||i.max<n)&&(i.max=n,i.slowestOperation=t.operationName),i.mean=null!==i.mean?(i.mean+n)/2:n}getOrCreateStore(e){let t=this.stats[e];return t||(t={type:e,read:WI(),write:WI(),diff:WI(),subscribeEvents:0,methodCalls:{[Kg.z.query]:0,[Kg.z.watchQuery]:0,[Kg.z.mutate]:0,[Kg.z.subscribe]:0,[Kg.z.readQuery]:0,[Kg.z.writeQuery]:0,[Kg.z.readFragment]:0,[Kg.z.writeFragment]:0}},this.stats[e]=t),t}}function BI(e,t,n){return{storeType:t,kind:e,operationName:"string"==typeof n?n:(0,LI.Ok)(n)||"unknown",start:performance.now()}}function WI(){return{min:null,max:null,mean:null,count:0,errors:0,slowestOperation:null}}class GI extends xe{constructor(){super(_.Yg.CreateGraphQLStoreStatsReporterService,["coreSettings","loggerFactory"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=e.loggerFactory.newLogger("CreateGraphQLStoreStatsReporterServiceTask"),{enableGraphQLStoreStatsReporterService:n}=e.coreSettings.get(A.J.Core);n&&(e.graphqlStoreStatsReporterService=new UI,t.log("GraphQLStoreStatsReporterService initialized"))}))}}var VI=n(25966);var HI=n(9566),$I=n(3984);class zI{constructor(e,t,n,i,a,o){this.aad=e,this.discover=t,this.coreSettings=n,this.loggerFactory=i,this.platformService=a,this.experienceConfig=o,this.skype=new bs.q(this.discover)}bind(e,t){switch(t){case"chatService":return this.chatServiceBind(e);case"cmdArtifactsService":return this.cmdArtifactsServiceBind(e);case"middleTier":case"userProfileService":case"userEntitlementService":return n=>(0,c.mG)(this,void 0,void 0,(function*(){return(0,VI.G)(yield function(e,t,n,i){return t.getUser().then((()=>{const a=vl(i),{requireSkypetokenForMT:o}=i.get(A.J.Auth),r=t.authorize(e,a);return o?n.authorize(r,"x-skypetoken"):r}))}(this.xMsClientInfoHeaders(e),this.aad,this.skype,this.coreSettings),yield this.discover.regionGtm(t))(n)}));case"unifiedPresence":return this.unifiedPresence||(this.unifiedPresence=this.unifiedPresenceBind(t)),this.unifiedPresence(e);case"urlp":case"urlpV2":case"ams":case"amsV2":return n=>(0,c.mG)(this,void 0,void 0,(function*(){return(0,VI.G)(this.skype.authorize(e,"Authorization"),yield this.discover.regionGtm(t))(n)}));case"mtImageService":return n=>(0,c.mG)(this,void 0,void 0,(function*(){const{mtImageServiceOverrideUrl:i}=this.coreSettings.get(A.J.Test),a=i||(yield this.discover.regionGtm(t));return(0,VI.G)(e,a)(n)}));default:return this.defaultBind(e,t)}}defaultBind(e,t){return n=>(0,c.mG)(this,void 0,void 0,(function*(){const i=yield this.discover.regionGtm(t);return(0,VI.G)(this.aad.authorize(e,i),i)(n)}))}unifiedPresenceBind(e){const{requireConsumerTypeHeader:t,requireSkypetoken:n}=this.coreSettings.get(A.J.Presence);return function(e,t){let n;return i=>a=>(0,c.mG)(this,void 0,void 0,(function*(){for(let o=0;;++o){n||(n=yield t());const r=yield(0,VI.G)(e(i,n),n)(Object.assign(Object.assign({},a),{headers:Object.assign(Object.assign({},a.headers),{BehaviorOverride:"redirectAs404"})})),{status:s,headers:{location:l}}=r;if(s!==Ts.qb.NOT_FOUND||!l||o>2)return r;n=new URL("/",l).href}}))}(((e,i)=>{const a=n?this.skype.authorize(e,"x-skypetoken"):this.aad.authorize(e,i);return t?e=>(0,c.mG)(this,void 0,void 0,(function*(){return e=Object.assign(Object.assign({},e),{headers:Object.assign(Object.assign({},e.headers),{"x-ms-client-consumer-type":"teams4life"})}),a(e)})):a}),(()=>this.discover.regionGtm(e)))}chatServiceBind(e){return this.chatService||(this.chatService=(0,HI.Db)((e=>this.skype.authorize(e)),(e=>this.discover.regionGtm(e)),this.coreSettings,this.loggerFactory)),this.chatService(e)}cmdArtifactsServiceBind(e){const{cmdMeetingArtifactsServiceEndpoint:t}=this.coreSettings.get(A.J.CMDMeetingArtifactsService);return n=>(0,c.mG)(this,void 0,void 0,(function*(){return(0,VI.G)(yield function(e,t,n){return t.getUser().then((()=>{const{cmdMeetingArtifactsServiceResource:i}=n.get(A.J.CMDMeetingArtifactsService);return t.authorize(e,null!=i?i:"")}))}(e,this.aad,this.coreSettings),null!=t?t:"")(n)}))}xMsClientInfoHeaders(e){if(this.coreSettings.get(A.J.Core).enableCommonMtHeadersWithSend){const t=(0,$I.h)(this.platformService,this.experienceConfig);return n=>e(Object.assign(Object.assign({},n),{headers:Object.assign(Object.assign(Object.assign({},t),{[os.f_.xMsRequestId]:n.correlationId||""}),n.headers)}))}return e}}class qI extends xe{constructor(){super(_.Yg.CreateGtmRegistry,["authenticationService","discover","coreSettings","loggerFactory","platformService","config"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){e.gtmRegistry=new zI(e.authenticationService,e.discover,e.coreSettings,e.loggerFactory,e.platformService,e.config)}))}}class JI{constructor(e,t,n,i,a){this.commandChangeReportingService=e,this.coreSettings=t,this.hostCommunicationService=n,this.scenarioFactory=i,this.logger=a.newLogger("HostCommandingListener")}init(){this.initCommandChangeReportingSubscription()}destroy(){var e;null===(e=this.commandChangeReportingSubscription)||void 0===e||e.unsubscribe(),this.commandChangeReportingSubscription=void 0}initCommandChangeReportingSubscription(){this.commandChangeReportingSubscription&&this.destroy(),this.commandChangeReportingSubscription=this.commandChangeReportingService.observeChanges().subscribe((e=>{e.type===Qe.B.NotHandled&&e.context.entityCommand&&this.sendHostEvent(e.context.entityCommand)}))}sendHostEvent(e){return(0,c.mG)(this,void 0,void 0,(function*(){!!this.coreSettings.get(A.J.Core).enableCommandToHostCommService&&(yield rm(e,this.hostCommunicationService,this.logger,this.scenarioFactory))}))}}class QI{constructor(){this.id=_.Yg.CreateHostCommandingListener}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{commandChangeReportingService:t,coreSettings:n,loggerFactory:i,scenarioFactory:a,hostCommunicationService:o}=hm("CreateHostCommandingListenerTask",e,"commandChangeReportingService","coreSettings","loggerFactory","scenarioFactory","hostCommunicationService");new JI(t,n,o,a,i).init()}))}}var KI;!function(e){e.chats="chats",e.unsupported="unsupported"}(KI||(KI={}));n(27996);const YI={web:{loadModule:(e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){return"auth"===e?(e=>({signInOnElectron:function(t){const n={options:t};return Promise.resolve(e.opener.postMessage("login",n))}}))(t):"calling"===e?(e=>({signalCallConnectionComplete:function(){return Promise.resolve(e.opener.postMessage("signalCallConnectionComplete",{}))}}))(t):"callingperf"===e?(e=>({callingPerfStatsAvailable:function(t){const n={callingPerfStats:t};return Promise.resolve(e.opener.postMessage("callingPerfStats",n))}}))(t):"core"===e?(e=>({registerForOnSubNavHoverChanged:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("showOrHideSubNav",n),()=>{e.opener.removeEventListener("showOrHideSubNav",n)}},setCoreInitialized:function(){return Promise.resolve(e.opener.postMessage("coreInitialized",{}))}}))(t):"embedcalendar"===e?(e=>({sendHeightOnResize:function(t){const n={embedCalendarHeight:t};return Promise.resolve(e.opener.postMessage("sendHeightOnResize",n))}}))(t):"search"===e?(e=>({registerForLogActivity:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("logActivity",n),()=>{e.opener.removeEventListener("logActivity",n)}}}))(t):"surveyform"===e?(e=>({registerForLogActivity:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("logActivity",n),()=>{e.opener.removeEventListener("logActivity",n)}}}))(t):void 0})),definedModules:["auth","calling","callingperf","core","embedcalendar","search","surveyform"]},edge:{loadModule:e=>(0,c.mG)(void 0,void 0,void 0,(function*(){return"appdevicepermission"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Appdevicepermission})):"appswitcher"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Appswitcher})):"auth"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Auth})):"brb"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Brb})):"calling"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Calling})):"core"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Core})):"customvideobackground"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Customvideobackground})):"ecs"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Ecs})):"globalshortcuts"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Globalshortcuts})):"heartbeat"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Heartbeat})):"hid"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Hid})):"moduleloader"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Moduleloader})):"officeintegration"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Officeintegration})):"osutils"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Osutils})):"profiler"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Profiler})):"scenario"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Scenario})):"sharetarget"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Sharetarget})):"taskbar"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Taskbar})):"telemetry"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Telemetry})):"tmapolicy"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Tmapolicy})):"toasts"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Toasts})):"updates"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Updates})):"webclientstates"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Webclientstates})):"windowcontrols"===e?(0,c.mG)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Windowcontrols})):void 0})),definedModules:["appdevicepermission","appswitcher","auth","brb","calling","core","customvideobackground","ecs","globalshortcuts","heartbeat","hid","moduleloader","officeintegration","osutils","profiler","scenario","sharetarget","taskbar","telemetry","tmapolicy","toasts","updates","webclientstates","windowcontrols"]},electron:{loadModule:(e,t)=>(0,c.mG)(void 0,void 0,void 0,(function*(){return"appdevicepermission"===e?(e=>({registerForHasDevicePermissions:function(t){const n=(e={})=>{t(e.eventId,e.webContentsId,e.permissionType,e.guid)};return e.opener.addEventListener("hasDevicePermissions",n),()=>{e.opener.removeEventListener("hasDevicePermissions",n)}},resolveDevicePermission:function(t,n,i){const a={message:t,permission:n,guid:i};return Promise.resolve(e.opener.postMessage("hasDevicePermissionsCallback",a))}}))(t):"auth"===e?(e=>({signInOnElectron:function(t){const n={options:t};return Promise.resolve(e.opener.postMessage("login",n))}}))(t):"callingperf"===e?(e=>({callingPerfStatsAvailable:function(t){const n={callingPerfStats:t};return Promise.resolve(e.opener.postMessage("callingPerfStats",n))}}))(t):"core"===e?(e=>({registerForOnSubNavHoverChanged:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("showOrHideSubNav",n),()=>{e.opener.removeEventListener("showOrHideSubNav",n)}},setCoreInitialized:function(){return Promise.resolve(e.opener.postMessage("coreInitialized",{}))},notifyCoreStateChanged:function(t){const n={childSettings:t};return Promise.resolve(e.opener.postMessage("updateWindowState",n))}}))(t):"hostedwebcontentlog"===e?(e=>({registerForReportAProblemLogUploadEvent:function(t){const n=(e={})=>{t(e.eventId)};return e.opener.addEventListener("reportAProblemLogUpload",n),()=>{e.opener.removeEventListener("reportAProblemLogUpload",n)}}}))(t):"m365link"===e?(e=>({getM365Link:function(t,n){const i={url:t,context:n};return e.opener.requestMessage("getM365Link",i)}}))(t):"search"===e?(e=>({registerForLogActivity:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("logActivity",n),()=>{e.opener.removeEventListener("logActivity",n)}}}))(t):"surveyform"===e?(e=>({registerForLogActivity:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("logActivity",n),()=>{e.opener.removeEventListener("logActivity",n)}}}))(t):"windowcontrols"===e?(e=>({swapMeetingRoomFrontOfRoomWindows:function(){return Promise.resolve(e.opener.postMessage("swapMeetingRoomFrontOfRoomWindows",{}))},getScreenshots:function(t,n){const i={width:t,height:n};return e.opener.requestMessage("getScreenshots",i)}}))(t):void 0})),definedModules:["appdevicepermission","auth","callingperf","core","hostedwebcontentlog","m365link","search","surveyform","windowcontrols"]}},XI=(e,t=!1)=>new ZI(YI.edge,e,void 0,t);class ZI{constructor(e,t,n,i=!1){this._internalLoadDefinition=e,this._logger=t,this._host=n,this._enableScenarioCache=i,this._hostCommsScenarioFactory=eA(this._enableScenarioCache)}loadModule(e){var t,n,i,a;return(0,c.mG)(this,void 0,void 0,(function*(){const o=this._hostCommsScenarioFactory.newScenario("host_comms_load_module");let r;try{this._logger.log(`Loading module: ${e}`),r=yield this._internalLoadDefinition.loadModule(e,null!==(t=this._host)&&void 0!==t?t:void 0)}catch(t){throw null===(i=(n=this._logger).errorToTelemetry)||void 0===i||i.call(n,"Error while loading module","webclient_framework_host_comms",void 0,!0),null==o||o.fail({reason:"Error while loading module",message:e}),t}return!r&&(null===(a=this._internalLoadDefinition.definedModules)||void 0===a?void 0:a.includes(e))?(this._logger.error(`Failed to load module. Module, undefined ${e}`),null==o||o.fail({reason:"Failed to load module",message:e})):(this._logger.log(`Module "${e}" loaded`),null==o||o.stop({message:e})),r}))}setScenarioFactory(e){this._hostCommsScenarioFactory.setScenarioFactory(e)}}const eA=e=>{let t;const n=[];return{newScenario:i=>{if(t)return t.newScenario(i);if(e){const e=nA(i);return n.push(e),e}},setScenarioFactory:e=>{t=e,tA(n,t)}}},tA=(e,t)=>{let n=e.pop();for(;n;){const i=t.newScenario(n.name,{startTime:n.time});"failed"===n.status&&i.fail(Object.assign({cached:!0},n.result)),"stopped"===n.status&&i.stop(Object.assign({cached:!0},n.result)),n=e.pop()}},nA=e=>{let t,n;return{name:e,time:Date.now(),fail:e=>{n="failed",t=e},stop:e=>{n="stopped",t=e},get result(){return t},get status(){return n}}};class iA extends xe{constructor(){super(_.Yg.CreateHostCommunication,["coreSettings","loggerFactory","platformService","windowProvider"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n,platformService:i,windowProvider:a}=e;e.hostCommunicationService=((e,t,n,i)=>{const{clientType:a}=e.config,o=i.newLogger("HostComms");return o.log(`Create HostComms for ${a}`),a===Fo.Bh.Maglev&&t.get(A.J.Core).enablePieCommunication?XI(o,!0):a===Fo.Bh.Desktop?new ZI(YI.electron,o,n,!0):new ZI(YI.web,o,n,!0)})(i,t,a,n)}))}}var aA=n(46862),oA=n(38692);class rA{constructor(e,t){this.options={},this.setOptions(t),this.logger=e("i18n:selective-icu"),this.name="selective-icu",this.type="postProcessor",this.icu=new oA.Z}setOptions(e){this.options=Object.assign(Object.assign({},this.options),e)}process(e,t,n,i){const a=Array.isArray(t)?t[t.length-1]:t;if(!this.options.filterRegex||!this.options.filterRegex.test(a))return e;try{return this.icu.parse(e,n,i.language,n.ns,a,!1)}catch(a){return this.logger.error(`ICU parse failed for namespace: "${n.ns||""}" key: "${t.toString()}" locale: "${i.language||""}"`),e}}}class sA{constructor(){this.name="simple-pseudo",this.type="postProcessor"}process(e){return`([{${e}}])`}}var lA=n(4266);class dA{constructor(e){this.entries={},this.logger=e("NamespaceLoader")}getState(e){const t=this.entries[e];return t?t.state:lA.i.Missing}waitForNamespace(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){const n=this.getState(t);if(n===lA.i.Loaded)return;if(n===lA.i.Failed)throw new Error(`Loading of namespace ${t} has previously failed`);const i=n===lA.i.Missing?this.load(e,t):this.entries[t];return i&&i.promise?i.promise:void 0}))}loadStatic(e,t){e.i18next.addResourceBundle(e.locale,t.namespace,t.translations),this.entries[t.namespace]={state:lA.i.Loaded,error:void 0,promise:void 0}}load(e,t,n){const i="en-us",a=n?i:e.locale,o=`${a}/${(0,Z.kebabCase)(t)}`,r=`./generated/resources/${o}`,s={state:lA.i.Loading,error:void 0,promise:void 0};this.entries[t]=s,e.logger.log("importing",r);const l=this.getNamespaceEntry(a,t).then((n=>{e.i18next.addResourceBundle(e.locale,t,n.default.translations),e.logger.log("imported",r),s.state=lA.i.Loaded,s.promise=void 0})).catch((l=>n||a===i?(this.failI18nLoad({error:l.message,origin:o}),e.logger.error("failed to import",r,l),s.state=lA.i.Failed,s.error=l.message,s.promise=void 0,Promise.reject(l)):(e.logger.log("trying fallback to the default locale as failed to import",r,l),this.failI18nLoad({fallbackLocale:i,error:l.message,origin:o}),this.load(e,t,!0).promise)));return s.promise=l,s}getNamespaceEntry(e,t){return(0,cd.mT)((()=>n(22057)(`./${e}/${(0,Z.kebabCase)(t)}.js`)),`${(0,Z.kebabCase)(t)}-locale-${e}`)}failI18nLoad(e){var t,n;null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,"Failed to import locale","namespace_loader",e)}}function cA(e){return e.includes("local")?"local":e.includes("-oncdn-")?"container":"production"}function uA(e,t){var n,i,a;try{const t=mA(e),i=null===(n=null==t?void 0:t.dataset)||void 0===n?void 0:n.config;return i?JSON.parse(decodeURIComponent(i)):{}}catch(e){const n=`Failed to parse head-data config with error: ${e}`;(null==t?void 0:t.errorToTelemetry)?null===(i=null==t?void 0:t.errorToTelemetry)||void 0===i||i.call(t,n,"webclient_framework_head_config",void 0,!0):null===(a=null==t?void 0:t.error)||void 0===a||a.call(t,n)}return{}}function mA(e){const t=null==e?void 0:e.document.getElementsByTagName("head");if(t)return t[0]}function gA(e){const t=e.navigator.userAgent.match(/maglev\/(\d+\.\d+\.\d+\.\d+)/);return t&&t.length>1?t[1]:void 0}function pA(e){var t,n;const i=null===(n=null===(t=e.navigator)||void 0===t?void 0:t.serviceWorker)||void 0===n?void 0:n.controller;return"activated"===(null==i?void 0:i.state)}var hA=n(95774),vA=n(30170);function SA(e){return e.navigator.language||_.ZW}function fA(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const n=yield e.loadModule("osutils"),i=yield null===(t=null==n?void 0:n.getAppLocale)||void 0===t?void 0:t.call(n);return null==i?void 0:i.localeName}))}function yA(e,t,n){const i=kA(e,t,n);return(0,vA.vw)(i).locale}function kA(e,t,n){const i=function({localeCode:e,language:t,setting:n}){if(e)return e;if(t)return t.toLowerCase();if(!n)return;let i;if(Array.isArray(n)){for(const e of n)if(e.startsWith("localeCode:")){i=e;break}}else n.startsWith("localeCode:")&&(i=n);if(i)return i.split(":")[1];return}(t.state.getSearchState()||{});if(i)return i;const a=e.getHostedWindowContext(),o="localeCode";return a&&a.localeCode?(e.localStorage.setItem(o,a.localeCode),a.localeCode):e.localStorage.getItem(o)||n||_.ZW}const CA=()=>{};class bA{constructor(e,t,n,i,a,o,r,s=n.config.localeCode,l,d){this.preloadNamespaces=e,this.coreSettings=i,this.staticNamespaces=o,this.originLocale=s,this.userLanguage=l,this.osLocale=d;const c=t("i18n"),u="pseudo"===s||"pseudo_rtl"===s;let m=(0,hA.Ax)(s,a,r);const g=A.J.Core&&this.coreSettings.get(A.J.Core);g&&g.useEnglishOnlyUI&&(m="en-us");const p=this.initPlugins(t,u,m,c);this.namespaceLoader=new dA(t),this.i18next=p,this.latestTranslation={},this.originLocale=s,this.logger=c,this.scenarioFactory=a,this.osPlatform=n.config.osPlatform,this.initOsDateTimeLocalization(i,a,n,c),this.initI18next(m,a,c),this._locale=m,this.loadLocales()}get locale(){return this._locale}get osLocaleInfo(){return this._osLocaleInfo}setOSLocaleInfo(e){this._osLocaleInfo=e}setLocale(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=A.J.Core&&this.coreSettings.get(A.J.Core);t&&t.useEnglishOnlyUI&&(e="en-us");const n=(0,hA.um)(this.scenarioFactory,e);this.i18next.changeLanguage(n),this._locale=n,yield this.loadLocales()}))}initPlugins(e,t,n,i){const a=[new rA(e,{filterRegex:/.*\_mf$/})];if(t){const e=new sA;a.push(e),n="en-us"}hA.cL.locale=n;let o=aA.Z.createInstance();for(const e of a)o=o.use(e);const r=this.getInitOptions(n,a);return o.init(r).catch((e=>i.error("The i18next initialization failed",e))),o}removeDefaultI18nNamespaces(e){var t;("string"==typeof this.i18next.options.ns?[this.i18next.options.ns]:null!==(t=this.i18next.options.ns)&&void 0!==t?t:[]).forEach((t=>this.i18next.removeResourceBundle(e,t))),this.i18next.setDefaultNamespace("")}setMissingHandlers(e,t){this.i18next.options.saveMissing=!0,this.i18next.options.missingKeyHandler=(n,i,a)=>{this.missingKeyHandler(e,t,this.i18next,n,i,a)},this.i18next.options.missingInterpolationHandler=n=>this.missingInterpolationHandler(e,t,this.latestTranslation)}initI18next(e,t,n){this.removeDefaultI18nNamespaces(e),this.setMissingHandlers(t,n)}initOsDateTimeLocalization(e,t,n,i){const a=A.J.Host&&e.get(A.J.Host),o=a&&a.enableOsDateTimeFormatting;o&&n.config.getLocaleInfoAsync().then((e=>{if(null==e?void 0:e.regionalFormat){const t="_",n="-";e.regionalFormat=e.regionalFormat.split(t).join(n).toLowerCase()}o&&this.setOSLocaleInfo(e)})).catch((e=>{var n;null===(n=i.errorToTelemetry)||void 0===n||n.call(i,`getLocaleInfoAsync failed for ${JSON.stringify(e)}`,"telemetry_i18next_wrapper");t.newScenario(ee.RG.I18nGetLocaleInfo).fail({errors:JSON.stringify(["getLocaleInfoAsync failed"])})}))}loadLocales(){const e=[];this.staticNamespaces&&this.namespaceLoader.loadStatic(this,this.staticNamespaces);for(const t of this.preloadNamespaces){const n=this.namespaceLoader.load(this,t);n.promise&&e.push(n.promise.catch(CA))}return Promise.all(e)}missingKeyHandler(e,t,n,i,a,o){const r="string"==typeof n.options.ns?[n.options.ns]:n.options.ns||[""];let s="",l="";r.indexOf(a)<0?(s=`The namespace "${a}" has not been loaded. The only loaded namespaces: "${r.join(", ")}"`,l=o):s=`The key "${o}" doesn't exist in namespace "${a}" for locale "${i[0]}"`;e.newScenario(ee.RG.I18nMissingKeyHandler).stop({message:s,origin:l}),t.error(s)}missingInterpolationHandler(e,t,n){var i;const a=`Undefined interpolation for namespace "${n.namespace}" and key "${n.key}"`;e.newScenario(ee.RG.I18nMissingInterpolationHandler).stop({message:a}),null===(i=t.errorToTelemetry)||void 0===i||i.call(t,a,"telemetry_i18next_wrapper")}getInitOptions(e,t){return{initImmediate:!1,interpolation:{escapeValue:!1},react:{bindI18n:"languageChanged",bindStore:"",nsMode:"default"},lng:e,fallbackLng:e,load:"currentOnly",lowerCaseLng:!0,postProcess:t.filter((e=>"postProcessor"===e.type)).map((e=>e.name))}}}class TA extends xe{constructor(){super(_.Yg.CreateI18NextWrapper,["loggerFactory","platformService","coreSettings","scenarioFactory","config","windowProvider","routingServices","hostCommunicationService"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t={windowProvider:e.windowProvider,routingServices:e.routingServices,hostCommunicationService:e.hostCommunicationService};e.i18NextWrapper=function(e,t,n,i,a,o,r,s){const{windowProvider:l,routingServices:d,hostCommunicationService:c}=o,u=kA(l,d,uA(l).localeCode),m=SA(l),g=c?fA(c):Promise.resolve(void 0);return new bA(e,t,n,i,a,r,s,u,m,g)}(e.config.preloadedI18nNamespaces||[],e.loggerFactory.newLogger,e.platformService,e.coreSettings,e.scenarioFactory,t,e.config.staticNamespaces,e.config.locale)}))}}var wA=n(31225);class _A extends xe{constructor(){super(_.Yg.CreateI18n,["i18NextWrapper"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){e.i18n=new wA.o(e.i18NextWrapper)}))}}class IA extends xe{constructor(){super(_.Yg.CreateInactiveGC,["clientState","coreSettings","profilerService"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{clientState:t,coreSettings:n,profilerService:i}=e;t.observe().subscribe((e=>(0,c.mG)(this,void 0,void 0,(function*(){if(e===Ve.pk.Inactive||e===Ve.pk.LongInactive){const{enableGCInInactive:e}=n.get(A.J.Core);e&&i.requestTriggerGC()}}))))}))}}class AA extends xe{constructor(){super(_.Yg.LeakDetector,["loggerFactory","coreSettings","windowProvider"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{loggerFactory:t,windowProvider:n,coreSettings:i}=e,a=t.newLogger("CreateLeakDetectorTask"),{enableObjectLeakDetection:o}=i.get(A.J.Core);if(a.log(`enableObjectLeakDetection ${o}`),!o)return;if(!n.WeakRef)return void a.log("windowProvider?.WeakRef is undefined");const r=new Po.E(i,n);e.leakDetectorService=r,a.log("leakDetectorService instantiated"),n.opener.addEventListener(K.rY.GetLeaks,(()=>this.sendLeaksStats(n,r,a))),this.initTestingMode(n,r,i.get(A.J.Host))}))}sendLeaksStats(e,t,n){let i=0;const a=e.parent;a.getAndClearAriTelemetry=void 0,a.getLeakDetectorService=void 0,a.gc?(n.log("executing gc() on experience renderer"),a.gc(),i=1e4):n.warn("gc() not defined on experience renderer");let o=0;o=e.setTimeout((()=>{e.clearTimeout(o);const n={leaks:t.getReachableObjectCountsByKey(),leaksTrackingInfo:t.getReachableObjectsTrackingInfo()};e.opener.postMessage(K.rY.GetLeaks,n)}),i)}initTestingMode(e,t,n){const{userType:i}=n;i&&i.indexOf("test")>-1&&!("getLeakDetectorService"in e.parent)&&(e.parent.getLeakDetectorService=()=>t)}}class NA extends xe{constructor(){super(_.Yg.CreateLocalStorage,["authenticationUser","config","coreSettings","loggerFactory","windowProvider"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{authenticationUser:t,config:n,windowProvider:i,loggerFactory:a}=e,o=new L_(t.profile.tenantId,t.profile.objectId,n.experienceName,i,a),r=a.newLogger("CreateLocalStorage");e.localStorage=o;const s=!e.coreSettings.get(A.J.Auth).isLegacyCleanupCodeFlag;return e=>(0,c.mG)(this,void 0,void 0,(function*(){if("signout"===e&&s){const e=yield function(e,t){const n={},i=["TflFreProfileCardDisplayed"],a=["mainAppWindowActiveEntities"];try{i.forEach((t=>{const i=e.get(t,or.f.UserAndExperience);i&&(n[t]=i)})),e.clear([or.f.UserAndExperience,or.f.User]),a.map((t=>e.remove(t,or.f.Experience)))}catch(e){t.warn(`Failed to clear local storage! ${e}`)}return n}(o,r);e&&function(e,t,n){const i=Object.keys(t);try{i.forEach((n=>{e.set(n,t[n],or.f.UserAndExperience)}))}catch(e){n.warn(`Failed to restore local storage values for ${i}: ${e}!`)}}(o,e,r)}switch(e){case"quit":case"signout":new T_.I(o).clear();break;default:return}}))}))}}function EA(){return Promise.all([n.e(1932),n.e(9650),n.e(8747),n.e(9527),n.e(371),n.e(4591)]).then(n.bind(n,77399))}function DA(){return(0,cd.mT)(EA,"nova-app-bar")}const FA={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CoreServicesTasksLockedTilesQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lockedTiles"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isSelected"}}]}}]}}]}}]}}]};const PA={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"CoreServicesTasksUpdateNovaAppSelectionFragment_tileWithSelection"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LaunchTile"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isSelected"}}]}}]},MA={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CoreServicesTasksUpdateNovaAppSelectionQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lockedTiles"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CoreServicesTasksUpdateNovaAppSelectionFragment_tilesWithSelectionStatus"}}]}},{kind:"Field",name:{kind:"Name",value:"pinnedTiles"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CoreServicesTasksUpdateNovaAppSelectionFragment_tilesWithSelectionStatus"}}]}},{kind:"Field",name:{kind:"Name",value:"mostRecentlyUsedTiles"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CoreServicesTasksUpdateNovaAppSelectionFragment_tilesWithSelectionStatus"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"CoreServicesTasksUpdateNovaAppSelectionFragment_tilesWithSelectionStatus"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"TileConnection"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"CoreServicesTasksUpdateNovaAppSelectionFragment_tileWithSelection"}}]}}]}}]}},...PA.definitions]}.definitions]};function jA(e,t,n){e.writeFragment({id:`LaunchTile:${t}`,fragment:PA,data:{__typename:"LaunchTile",id:t,isSelected:n}})}class RA extends xe{constructor(){super(_.Yg.CreateNovaAppBarUpdater,["authenticationUser","client","experienceChangeReportingService","coreSettings","loggerFactory"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{authenticationUser:t,client:n,experienceChangeReportingService:i,coreSettings:a,loggerFactory:o}=e,r=o.newLogger("NovaAppBarUpdater");let s;const l=this.subscribeToLockedTilesUpdates(n,r).then((e=>{s=e})).catch((e=>{var t;return null===(t=r.errorNoPii)||void 0===t?void 0:t.call(r,e)}));let d;if(a.get(A.J.Core).enableAppBarQueryUpdate){const e=(0,qe.b)(t);d=i.observeChanges().pipe((0,S.h)((t=>t.userContextId===e&&t.type===Tt.yU.AppSelectionChanged)),(0,h.U)((e=>e.type===Tt.yU.AppSelectionChanged?e.context.appId:void 0)),(0,Br.x)()).subscribe((e=>{!function(e,t,n){try{const t=e.readQuery({query:MA});if(t){let i,a;for(const[,e]of(0,Z.entries)(t))if(i||(i=e.edges.find((e=>e.node.isSelected))),a||(a=e.edges.find((e=>e.node.id===n))),i&&a)break;if((null==i?void 0:i.node.id)===(null==a?void 0:a.node.id))return;i&&jA(e,i.node.id,!1),a&&jA(e,a.node.id,!0)}}catch(e){t.error("Error thrown updating Nova AppBar selection.")}}(n.cache,r,e)}))}return()=>(0,c.mG)(this,void 0,void 0,(function*(){null==d||d.unsubscribe(),yield l,null==s||s.unsubscribe()}))}))}subscribeToLockedTilesUpdates(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){const{lockedTilesSubscription:n}=yield DA();return e.subscribe({query:n}).subscribe((n=>{n.data&&function(e,t,n){var i,a;(0,c.mG)(this,void 0,void 0,(function*(){try{const t=e.readQuery({query:FA});if(t){const{lockedTilesUpdateQuery:a}=yield DA(),o=null===(i=t.lockedTiles.edges.find((e=>e.node.isSelected)))||void 0===i?void 0:i.node.id,r=Object.assign({},n.lockedTilesUpdatedEvent.lockedTiles);for(const e of r.edges.map((e=>e.node)))e.isSelected=e.id===o;e.writeQuery({query:a,data:{lockedTiles:r}})}}catch(e){null===(a=t.errorNoPii)||void 0===a||a.call(t,e)}}))}(e,t,n.data)}))}))}}var xA,OA,LA,UA;!function(e){e.Cold="Cold",e.Warm="Warm",e.Rollback="Rollback",e.Update="Update",e.Local="Local",e.Container="Container",e.Unknown="Unknown"}(xA||(xA={})),function(e){e.SessionID="tmp.sessionId",e.DeviceID="tmp.deviceId",e.IsRelaunchFromOOPs="tmp.relaunchFromOOPs",e.PreAuthUserID="tmp.preAuthUserId"}(OA||(OA={})),function(e){e.IndexPageStart="execute-index-html-script",e.CoreModuleLoaded="exp_loader_core_module_loaded",e.NotifyDesktop="exp_loader_notified_desktop",e.ConfigLoaded="exp_loader_config_loaded",e.MainChunksLoadingStart="exp_loader_load_bundles_start",e.MainChunksLoadingStop="exp_loader_load_bundles_stop",e.IndexPageStop="exp_loader_index_stop",e.ClientStartStop="client_start_stop"}(LA||(LA={})),function(e){e.ExpLoaderFailure="ExpLoaderFailure",e.LoadBundlesFailure="LoadBundlesFailure",e.ParseIndexPageFailure="ParseIndexPageFailure",e.CoreStartTimeout="CoreStartTimeout"}(UA||(UA={}));class BA extends class{constructor(e){this.userAgent=e,this.UAParser=wl.getParser(e)}getBrowser(){switch(this.UAParser.getBrowserName()){case"Microsoft Edge":return Fo.AR.Edge;case"Safari":return Fo.AR.Safari;case"Chrome":return Fo.AR.Chrome;case"Firefox":return Fo.AR.Firefox;case"Electron":return Fo.AR.Electron;default:return Fo.AR.Unknown}}getBrowserVersion(){return this.UAParser.getBrowserVersion()}getRingConfig(e=bt.s.prod,t){switch(t){case"ring0_gcc":t="ring0",e=bt.s.gcc;break;case"general_gcc":t="general",e=bt.s.gcc}return{ring:t,environment:e}}getOsPlatform(){const e=this.getOsOverride();if(null!=e)return e;switch(this.UAParser.getOSName()){case"Windows":return Fo.NR.Windows;case"macOS":return Fo.NR.Mac;case"Linux":return Fo.NR.Linux;case"Chrome OS":return Fo.NR.ChromeOS;case"Android":return Fo.NR.Android;case"iOS":return Fo.NR.IOS;case"Windows Phone":return Fo.NR.WindowsPhone;default:return Fo.NR.Unknown}}getOSPlatformVersion(){return this.UAParser.getOSVersion()}getOsOverride(){return null}getPlatformId(e,t){let n=this.getClientType(e,t);const i=this.getMetaOsPlatformId(e);return i||(n===Fo.Bh.Desktop&&this.getOsPlatform()===Fo.NR.Mac&&(n="Mac"),n=`${n[0].toUpperCase()}${n.substr(1)}`,Fo.us[n])}getMetaOsPlatformId(e){var t;switch(null===(t=null==e?void 0:e.metaoshost)||void 0===t?void 0:t.toLowerCase()){case"office":return Fo.us.MetaOsOffice;case"outlook":return Fo.us.MetaOsOutlook}return null}getClientType(e,t){let n=e&&e.host;if(!n&&t){const e="host";n=t.localStorage.getItem(e)||""}return"outlookDesktop"===n?Fo.Bh.Desktop:"outlookWeb"===n?Fo.Bh.Web:this.getBrowser()===Fo.AR.Electron?Fo.Bh.Desktop:Fo.Bh.Web}}{constructor(e,t,n,i,a){super(n.navigator.userAgent),this.loggerFactory=e,this.routingServices=t,this.windowHost=n,this.hostSettings=i,this.getPlatformConfigurationOverrides=a,this.logger=this.loggerFactory.newLogger("PlatformService"),this.queryStringParameters=this.routingServices.state.getSearchState()||{},this.headConfig=uA(this.windowHost,this.logger),this.cachedConfig=this.computeConfig(),this.cachedEcsOverrides=this.computeEcsOverrides()}get config(){return this.cachedConfig}get ecsOverrides(){return this.cachedEcsOverrides}get host(){var e,t;const n=null===(t=null===(e=this.windowHost.loader)||void 0===e?void 0:e.getProperties)||void 0===t?void 0:t.call(e);return Object.assign({bootType:(null==n?void 0:n.bootType)||xA.Unknown,deviceId:(null==n?void 0:n.deviceId)||ct.get("deviceId"),deviceInfo:null==n?void 0:n.deviceInfo,hostAppVersion:gA(this.windowHost),sessionId:(null==n?void 0:n.sessionId)||ct.get("sessionId"),preAuthUserId:null==n?void 0:n.preAuthUserId},this.windowHost.getHostedWindowContext())}getOsOverride(){return this.windowHost.localStorage.getItem("platformOverride")}computeConfig(){var e,t,n;let i={};this.getPlatformConfigurationOverrides&&(i=this.getPlatformConfigurationOverrides(this.windowHost,this.queryStringParameters)),this.logger.log(`IPlatformConfiguration overrides: ${JSON.stringify(i)}`);const a=this.getBrowser(),o=null!==(e=i.clientType)&&void 0!==e?e:this.getClientType(this.queryStringParameters,this.windowHost),r=this.determinePlatformId(i);this.logger.log(`Determined PlatformID to be '${r}'`);const s=this.getHostingParent(),l=this.windowHost.__VERSION__,d=`${r}/${l}`,c=this.windowHost.__webpack_public_path__;let u="https://statics.teams.cdn.office.net";try{c&&(u=new URL(c).origin)}catch(e){this.logger.warn(`Failed to parse dynamic staticsPath origin from '${c}'`)}const m=this.windowHost.navigator.language||"en-us";return this.logger.log(`PlatformService: configuring with clientVersion: ${d}`),{browser:a,browserVersion:this.getBrowserVersion(),clientType:o,clientContext:this.getClientContext(s),currentUrl:null===(n=null===(t=this.windowHost)||void 0===t?void 0:t.location)||void 0===n?void 0:n.href,osPlatform:this.getOsPlatform(),osVersion:this.getOSPlatformVersion(),platformId:r,userAgent:this.userAgent,localeCode:this.getLocaleCode(),isInIframe:this.getIsInIframe(),isInCypressFrame:this.getIsInCypressFrame(),buildVersion:l,clientVersion:d,hostingParent:s,getLocaleInfoAsync:this.windowHost.getLocaleInfoAsync,userLanguage:m,publicPath:c,staticsPath:u,vdi:i.vdi,isInternalUser:this.headConfig.isInternalUser,buildType:cA(d)}}determinePlatformId(e){var t,n,i,a,o,r,s,l,d,c,u;const m=e.platformId,g=null===(n=null===(t=this.hostSettings)||void 0===t?void 0:t.hostSettings)||void 0===n?void 0:n.platformId;if(null===(a=(i=this.logger).logNoPii)||void 0===a||a.call(i,`Potential PlatformID sources: experienceOverrides='${m}', hostSettings='${g}', qsp='${JSON.stringify(this.queryStringParameters)}', windowHostHost='${null===(o=this.windowHost)||void 0===o?void 0:o.localStorage.getItem("host")}'`),m)return null===(s=(r=this.logger).logNoPii)||void 0===s||s.call(r,"Using PlatformID value from experience overrides"),m;if(g){const e=parseInt(g,10);if(e)return null===(d=(l=this.logger).logNoPii)||void 0===d||d.call(l,"Using PlatformID value from host settings"),e}return null===(u=(c=this.logger).logNoPii)||void 0===u||u.call(c,"Using PlatformID value from QSP/WindowHost/Browser"),this.getPlatformId(this.queryStringParameters,this.windowHost)}getHostUrl(){const e=this.windowHost.localStorage.getItem("ecsHostUrl")||this.headConfig.ecsHostUrl;if(e)return new URL(e,this.windowHost.location.origin).href}computeEcsOverrides(){const e=this.getHostUrl(),t=this.getEnvironmentOverride()||function(e,t){let n=(null==t?void 0:t.environment)||"prod";return"infer"===n&&(n=function(e){return e.location.origin.includes("gov")?"gcchigh":e.location.origin.includes("dod")?"dod":e.location.origin.includes("live")?"life":"prod"}(e)),n}(this.windowHost,this.headConfig),n=(0,Z.get)(bt.s,t),i=this.getRingOverride(),{originalRing:a,unauthenticated:o}=this.headConfig;return Object.assign(Object.assign({hostUrl:e},this.getRingConfig(n,i)),{originalRing:a,unauthenticated:o})}getEnvironmentOverride(){if(this.queryStringParameters.webinarRing)return this.queryStringParameters.webinarRing}getLocaleCode(){const e=this.getQspLocale();if(e)return e;const t=this.windowHost.getHostedWindowContext(),n="localeCode";return t&&t.localeCode?(this.windowHost.localStorage.setItem(n,t.localeCode),t.localeCode):this.windowHost.localStorage.getItem(n)||this.headConfig.localeCode||"en-us"}getQspLocale(){if(this.queryStringParameters.localeCode)return this.queryStringParameters.localeCode;if(this.queryStringParameters.language)return this.queryStringParameters.language.toLowerCase();if(!this.queryStringParameters.setting)return;const e=this.queryStringParameters.setting;let t;if(Array.isArray(e)){for(const n of e)if(n.startsWith("localeCode:")){t=n;break}}else e.startsWith("localeCode:")&&(t=e);return t?t.split(":")[1]:void 0}getRingOverride(){if(this.headConfig.isInternalUser&&this.queryStringParameters.ring)return this.queryStringParameters.ring;const e=this.windowHost.getHostedWindowContext();if(null==e?void 0:e.ring)return e.ring;const{ring:t}=this.headConfig;return t?"string"==typeof t?t:t.id:void 0}getHostingParent(){const e=mA(this.windowHost);return e&&e.dataset&&"outlook"===e.dataset.host?Fo.GJ.Outlook:Fo.GJ.Unknown}getClientContext(e){return e===Fo.GJ.Outlook?Fo.RY.Embed:void 0}getIsInIframe(){return!!this.windowHost.getHostedWindowContext().isInIframe}getIsInCypressFrame(){return!!this.windowHost.getHostedWindowContext().isInCypressFrame}}class WA extends xe{constructor(){super(_.Yg.CreatePlatform,["windowProvider","loggerFactory","routingServices"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:n,routingServices:i,hostSettings:a,getPlatformConfigurationOverrides:o}=e;e.platformService=new BA(n,i,t,a,o)}))}}var GA=n(46742);function VA(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=[],n=yield null==e?void 0:e.loadModule("heartbeat");if(!(null==n?void 0:n.getPerfMetrics))return t;try{const e=yield n.getPerfMetrics();for(const n of e){const e={processId:n.processId,name:n.name,type:n.type,utilitySubType:n.utilitySubType,embeddedBrowserWebView:n.embeddedBrowserWebView,cpuCycleTime:n.cpuCycleTime,workingSetSizeKB:(0,GA.kl)(n.workingSetSizeBytes),commitSizeKB:(0,GA.kl)(n.pageFileUsageBytes)};t.push(e)}}catch(e){console.error("get-webview-2-metrics, getMetrics: Failed to get metrics.")}return t}))}var HA,$A,zA,qA,JA;!function(e){e.LoadModuleProfilerFailed="LoadModuleProflierFailed",e.ExecuteCommandFailed="ExecuteCommandFailed"}(HA||(HA={})),function(e){e.LoadModuleProfilerSuccess="LoadModuleProfilerSuccess",e.ExecuteCommandSuccess="ExecuteCommandSuccess"}($A||($A={}));class QA{constructor(e,t){this.hostCommunicationService=t,this.logger=e.newLogger("ProfilerService"),this.exposeToCoreWindow()}getMemoryData(){return(0,c.mG)(this,void 0,void 0,(function*(){const e=yield VA(this.hostCommunicationService);return(0,GA.o4)(e)}))}getHeapSnapshot(e=!0){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const n=yield this.getProfilerModuleAsync();if(!n)return;e&&(yield this.requestTriggerGC());const i=yield null===(t=n.getHeapSnapshot)||void 0===t?void 0:t.call(n);return(null==i?void 0:i.snapshot)?i.snapshot:void 0}))}getMemoryTracing(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){const t=yield this.getProfilerModuleAsync();if(!t)return;const n=yield null===(e=t.getMemoryTracing)||void 0===e?void 0:e.call(t,{duration:5e3});return(null==n?void 0:n.data)?n.data:void 0}))}requestTriggerGC(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){const t=yield this.getProfilerModuleAsync();if(!t)return!1;const n=yield null===(e=t.triggerGC)||void 0===e?void 0:e.call(t);return!!(null==n?void 0:n.status)}))}startMemoryTracing(e=!0){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const n=yield this.getProfilerModuleAsync();if(!n)return!1;e&&(yield this.requestTriggerGC());const i=yield null===(t=n.startMemoryTracing)||void 0===t?void 0:t.call(n);return!!(null==i?void 0:i.status)}))}stopMemoryTracing(e=!0){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const n=yield this.getProfilerModuleAsync();if(!n)return;e&&(yield this.requestTriggerGC());const i=yield null===(t=n.stopMemoryTracing)||void 0===t?void 0:t.call(n);return(null==i?void 0:i.data)?i.data:void 0}))}getProfilerModuleAsync(){return(0,c.mG)(this,void 0,void 0,(function*(){let e;try{e=yield this.hostCommunicationService.loadModule("profiler"),this.logger.log(`Profiler:: ${$A.LoadModuleProfilerSuccess}`)}catch(e){this.logger.error(`Profiler:: ${HA.LoadModuleProfilerFailed} ${(0,R.u4)(e)}`)}return e}))}exposeToCoreWindow(){return(0,c.mG)(this,void 0,void 0,(function*(){const e=yield this.hostCommunicationService.loadModule("profiler"),t=yield this.hostCommunicationService.loadModule("heartbeat");e&&t?globalThis.window.profiler=Object.assign(Object.assign({},e),{getMemoryData:()=>this.getMemoryData(),getHeapSnapshot:(e=!1)=>this.getHeapSnapshot(e),getTotalWorkingSetSizeBytes:()=>this.getWorkingSetSizeFromProcesses(null==t?void 0:t.getPerfMetrics),getTotalCommitSizeBytes:()=>this.getCommitSizeFromProcesses(null==t?void 0:t.getPerfMetrics)}):this.logger.log("HostComms is unable to load profiler and/or heartbeat module. We are running on Web or Teams 1.0. Bailing out.")}))}getWorkingSetSizeFromProcesses(e){return(0,c.mG)(this,void 0,void 0,(function*(){if(e){const t=yield e();return null==t?void 0:t.reduce(((e,t)=>(e.workingSetSizeBytes+=t.workingSetSizeBytes,e)),{workingSetSizeBytes:0}).workingSetSizeBytes}return this.logger.warn("Unable to get perf metrics."),-1}))}getCommitSizeFromProcesses(e){return(0,c.mG)(this,void 0,void 0,(function*(){if(e){const t=yield e();return null==t?void 0:t.reduce(((e,t)=>(e.pageFileUsageBytes+=t.pageFileUsageBytes,e)),{pageFileUsageBytes:0}).pageFileUsageBytes}return this.logger.warn("Unable to get perf metrics."),-1}))}}class KA extends xe{constructor(){super(_.Yg.CreateProfiler,["loggerFactory","hostCommunicationService"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){e.profilerService=new QA(e.loggerFactory,e.hostCommunicationService)}))}}!function(e){e.incomplete="incomplete",e.success="success",e.failure="failure"}(zA||(zA={})),function(e){e.LifeCycleReport="life_cycle_report"}(qA||(qA={})),function(e){e.ExperienceLifeCycleManager="experience_life_cycle_manager",e.UserLifeCycleManager="user_life_cycle_manager"}(JA||(JA={}));class YA{constructor(e,t,n,i,a,o,r,s,l,d){this.loggerFactory=e,this.host=t,this.clientStateProvider=n,this.networkStateProvider=i,this.platformService=a,this.hostCommunicationService=s,this.localStorage=l,this.scenarioFactory=d,this.cleanupOnRebootArray=[],this.clientStateSubscription=null,this.expChangeSubscription=null,this.lcChangeSubscription=null,this.isRunningJobsInLongInactive=!1,this.rebootPending=void 0,this.registerCleanupCallback=e=>{this.cleanupOnRebootArray.push(e)},this.didUrlChange=e=>(0,Mo.IC)(e)!==(0,Mo.IC)(this.host.location.href),this.areMaxRetriesExhausted=(e,t)=>{if(null==t?void 0:t.maxRetries){const n=this.getRetryStorageKey(e),i=this.localStorage.get(n,or.f.Experience),a=i&&parseInt(i,10)||0,o=a>=t.maxRetries;return this.logger.warn(`Max retries exhausted for '${e}', retries: ${a}, maxRetries: ${t.maxRetries}`),this.localStorage.set(n,`${a+1}`,or.f.Experience),o}return!1},this.getRetryStorageKey=e=>`rebootRetries.${e}`,this.logger=this.loggerFactory.newLogger("rebootService"),this.expChangeSubscription=o.observeChanges().pipe((0,h.U)((e=>{this.isExperienceIdleStateChangedEvent(e)&&(this.isRunningJobsInLongInactive=!0)}))).subscribe(),this.lcChangeSubscription=r.observeChanges().pipe((0,h.U)((({context:e})=>{const{target:t,reportedChange:n}=e;if(this.isRunningJobsInLongInactive&&t===JA.UserLifeCycleManager&&this.isExperienceIdleStateChangedEvent(n)&&(this.isRunningJobsInLongInactive=!1,this.rebootPending)){this.host.clearTimeout(this.timeoutId),this.logger.log("Core finished running App jobs in LongInactive client state. Issuing pending reboot now...");const{reason:e,commandSource:t,options:n}=this.rebootPending;this.rebootApp(e,t,n)}}))).subscribe()}rebootApp(e,t,n){return(0,c.mG)(this,void 0,void 0,(function*(){if(yield this.cleanupBeforeReboot(),this.logger.log(`Reboot app triggered for ${e} from ${t} with options: ${(0,R.u4)(n)}`),this.areMaxRetriesExhausted(t,n))return!1;try{this.dispose();const i=this.scenarioFactory.findScenario(ee.RG.ClientStart);null==i||i.incomplete({commandSource:t,reason:e});const a=this.getReloadUrl(n,t,e);this.platformService.config.clientType===Fo.Bh.Maglev?yield this.rebootThroughDesktopApi(a,t,e):this.didUrlChange(a)?this.host.location.replace(a):this.host.location.reload()}catch(e){return this.logger.error("Reboot app failed"),!1}return!0}))}rebootWhenLongInactive(e,t,n){return this.clientStateSubscription?(this.logger.log(`Reboot subscription failed from ${t} with reason ${e}`),!1):(this.logger.log(`Reboot when longInactive is subscribed from ${t} with reason ${e}`),this.clientStateSubscription=this.clientStateProvider.observe().subscribe((i=>this.handleClientStateChange(i,e,t,n))),!0)}clearRetryCount(e){this.localStorage.remove(this.getRetryStorageKey(e),or.f.Experience)}dispose(){var e,t,n;this.isRunningJobsInLongInactive=!1,this.rebootPending=void 0,this.timeoutId&&(this.host.clearTimeout(this.timeoutId),this.timeoutId=void 0),null===(e=this.clientStateSubscription)||void 0===e||e.unsubscribe(),null===(t=this.expChangeSubscription)||void 0===t||t.unsubscribe(),null===(n=this.lcChangeSubscription)||void 0===n||n.unsubscribe()}cleanupBeforeReboot(){var e,t,n;return(0,c.mG)(this,void 0,void 0,(function*(){let i,a,o;for(;i=this.cleanupOnRebootArray.pop();)try{yield i("restart")}catch(e){a=a?a.concat(`${i.toString()}::${(0,R.u4)(e)}`):`${i.toString()}::${(0,R.u4)(e)}::`}a&&(o=new ze.G(ze.$.CLEANUP,new Error(a)),null===(t=(e=this.logger).errorToTelemetry)||void 0===t||t.call(e,`${o.code}${null===(n=o.prevError)||void 0===n?void 0:n.message}`,"webclient_framework_foundation_core_services",void 0,!0))}))}rebootThroughDesktopApi(e,t,n){var i;return(0,c.mG)(this,void 0,void 0,(function*(){const a=yield this.hostCommunicationService.loadModule("core");a?yield null===(i=a.relaunch)||void 0===i?void 0:i.call(a,{url:e,reason:`${n}; source: ${lr.d[t]}`}):this.logger.error("HostComms is unable to load core module.")}))}handleClientStateChange(e,t,n,i){this.networkStateProvider.getState()===Xr.G.Online?(this.logger.log(`Handling clientState change to ${e}.`),e===Ve.pk.LongInactive&&(this.rebootPending={reason:t,commandSource:n,options:i},this.isRunningJobsInLongInactive?this.waitForRunningJobsAndReboot():this.rebootApp(t,n,i))):this.logger.log(`Reboot skipped, network state is offline when client state change to ${e}.`)}getReloadUrl(e,t,n){var i;const a=new URL((null==e?void 0:e.customUrl)||this.host.location.href),o=a.searchParams;(null===(i=null==e?void 0:e.qsps)||void 0===i?void 0:i.hasOwnProperty("clearcontainer"))&&o.delete("container"),o.delete("tenantId"),a.hash=this.getReloadHash(t,n,a.hash);const r=(null==e?void 0:e.qsps)||{};return Object.keys(r).forEach((e=>{o.set(e,r[e])})),a.toString()}getReloadHash(e,t,n){if(this.platformService.config.clientType===Fo.Bh.Maglev){const i=wr(n);let a;if(i.deepLink===sr.core)a=sr.core;else switch(e){case lr.d.WebClientUpdateService:a=sr.core;break;case lr.d.ReloadAppTask:a=i.deepLink&&i.deepLink!==sr.flyout&&t===lr.Z.RingSwitch?encodeURIComponent(i.deepLink):sr.default;break;default:a=sr.default}return`deepLink=${a}&source=${lr.d[e]}`}return""}waitForRunningJobsAndReboot(){this.logger.log("Pending a reboot while waiting for Core to finish running App jobs in LongInactive client state. timeout=2000 ms"),this.timeoutId=this.host.setTimeout((()=>{if(this.host.clearTimeout(this.timeoutId),this.rebootPending){this.logger.log("Timeout waiting for Core to finish running App jobs in LongInactive client state. Rebooting now...");const{reason:e,commandSource:t,options:n}=this.rebootPending;this.rebootApp(e,t,n)}}),2e3)}isExperienceIdleStateChangedEvent(e){return e.type===Tt.yU.ExperienceIdleStateChanged&&e.context.isIdle}}class XA extends xe{constructor(){super(_.Yg.CreateReboot,["clientState","experienceChangeReportingService","hostCommunicationService","lifeCycleScopeChangeReportingService","localStorage","loggerFactory","networkState","platformService","scenarioFactory","windowProvider"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{clientState:t,experienceChangeReportingService:n,hostCommunicationService:i,lifeCycleScopeChangeReportingService:a,localStorage:o,loggerFactory:r,networkState:s,platformService:l,scenarioFactory:d,windowProvider:c}=e;e.rebootService=new YA(r,c,t,s,l,n,a,i,o,d)}))}}var ZA,eN,tN,nN=n(37701),iN=n(94333);class aN extends xe{constructor(){super(_.Yg.CreateRouting,[])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=e.config.forceUseBrowserHistory||!e.windowProvider||""===e.windowProvider.location.hash?(0,nN.lX)({basename:e.config.basePath}):(0,nN.q_)({basename:e.config.basePath});e.history=t,e.routingServices=(0,iN.I)(e.loggerFactory,e.history,e.windowProvider&&e.windowProvider.location)}))}}class oN{constructor(e,t){this._scheduler=e,this._logger=t.newLogger("SchedulerWithValidator"),this._uniqueJobIds=new Set}validateAndSchedule(e,t,n){const{id:i,runOncePerId:a}=t;if(this._uniqueJobIds.has(i)){if(a)return this._logger.debug(`Job by ID ${i} has already run once.`),Ia.o_}else this._uniqueJobIds.add(i);return this._scheduler.schedule(e,t,n)}}function rN(e){if(e.has(Tt.c4.ExperienceWarm))return;const t=lN(e,Tt.yU.NavigationIntentExecuted);let n=!1;t&&(n=!t.shouldRenderContent||function(e){var t;const n=lN(e,Tt.FV.LayoutRenderComplete);return null!==(t=n&&(null==n?void 0:n.mainEntityType)!==Rt.EntityType.pearnotdefaultapp)&&void 0!==t&&t}(e));const i=Array.from(e.values()).pop();return n&&(null==i?void 0:i.context)}function sN(e,t){if(e.has(Tt.c4.UserWarm))return;let n=!1;if(dN(e))if(t)if(function(e){var t;const n=lN(e,Tt.FV.LayoutRenderComplete);return null!==(t=n&&(null==n?void 0:n.mainEntityType)!==Rt.EntityType.identity&&(null==n?void 0:n.mainEntityType)!==Rt.EntityType.tflfre&&(null==n?void 0:n.mainEntityType)!==Rt.EntityType.pearnotdefaultapp)&&void 0!==t&&t}(e))n=!0;else{const t=lN(e,Tt.yU.NavigationIntentExecuted);t&&!t.shouldRenderContent&&(n=!0)}else n=!0;const i=Array.from(e.values()).pop();return n&&(null==i?void 0:i.context)}function lN(e,t){const n=e.get(t);return n&&n.context}function dN(e){return e.has(Tt.yU.UserAuthenticated)&&e.has(Tt.yU.UserConsentedToConsumeResources)}function cN(e,t){let n=[];const i=e[t.state];return i&&(n=n.concat(i({context:t.context}))),n}function uN(e,t,n){let i;if(e){const{app:a,state:o,callback:r}=e;let s=r();if(s){const e=s.length;if(e>0){t.log(`App:${a.manifest.id} supports the state: ${o}, job count returned from the app: ${e}.`),s=s.filter((e=>function(e,t,n){if(n===ZA.start)return!1;const i=t&&t[n];if(Array.isArray(i))return i.indexOf(e)>-1;if(n===ZA.onPreWarm||n===ZA.onExperienceWarm)return!1;return!0}(e.id,n,o)));const i=s.length;i!==e&&t.log(`Jobs filtering by permissions took place. Job count is now: ${i}`)}i={state:o,jobs:s}}}return i}function mN({app:e,currentChanges:t,change:n,getCachedSupportSet:i,sessionContext:a}){const o=function(e,t){if(t.has(Tt.c4.Initialized)||e.type===Tt.yU.ExperienceIdleStateChanged)return;const n=lN(t,Tt.yU.ActiveEntitiesResolved);return dN(t)&&n?n:void 0}(n,t);if(o)return{app:e,state:ZA.onPreInit,callback:()=>function(e,t,n){let i;const a=n(),{entities:o,target:r}=t,s=(0,c._T)(t,["entities","target"]);for(const t of o)if(t&&a&&a.has(t.type)){i=i||[];const n=cN(e,{context:Object.assign(Object.assign({},s),{entity:t}),state:ZA.onPreInit});i=i.concat(n)}return i}(e,Object.assign(Object.assign({},a),o),i)}}function gN({app:e,currentChanges:t,sessionContext:n}){const i=rN(t);if(i){const t=ZA.onExperienceWarm;return{app:e,state:t,callback:()=>cN(e,{context:Object.assign(Object.assign({},n),i),state:t})}}}function pN({app:e,currentChanges:t,sessionContext:n,change:i}){if(i.context.isIdle&&dN(t)){const t=ZA.onExperienceIdle;return{app:e,state:t,callback:()=>cN(e,{context:Object.assign({},n),state:t})}}}function hN({appId:e,jobState:t,change:n,currentChanges:i,logger:a}){let o;if(t){const{jobs:r,state:s}=t,l=function(e,t){let n;switch(e){case ZA.start:n=Tt.c4.Started;break;case ZA.onPreInit:n=Tt.c4.Initialized;break;case ZA.onExperienceWarm:n=Tt.c4.ExperienceWarm;break;case ZA.onPreWarm:n=Tt.c4.UserWarm;break;case ZA.onExperienceIdle:n=Tt.c4.ExperienceIdle}return function(e,{correlationId:t,windowId:n,context:{target:i}}){return{type:e,context:{target:i},correlationId:t,windowId:n}}(n,t)}(s,n);i.set(l.type,l),a.debug(`Life Cycle - Change type: ${n.type}, initiated by: ${n.context.target}. Resulted in app:${e} transition to state: ${s} and job count: ${r.length}`),o={change:l,jobs:r}}return o}function vN({application:e,appLifeCyclePermissions:t,change:n,currentChanges:i,getNextState:a,getCachedSupportSet:o,logger:r,sessionContext:s}){const l=uN(a({currentChanges:i,app:e,change:n,getCachedSupportSet:o,sessionContext:s}),r,t);return hN({appId:e.manifest.id,jobState:l,change:n,currentChanges:i,logger:r})}!function(e){e.start="start",e.onPreInit="onPreInit",e.onExperienceWarm="onExperienceWarm",e.onPreWarm="onPreWarm",e.onExperienceIdle="onExperienceIdle"}(ZA||(ZA={})),function(e){e.Experience="Experience"}(eN||(eN={})),function(e){e.FirstUserAtBoot="FirstUserAtBoot",e.Other="Other"}(tN||(tN={}));class SN{constructor(e,t,n){this._scope=e,this._appLifeCyclePermissions=t,this._sessionContext=n,this._currentChanges=new Map,this._logger=n.loggerFactory.newLogger("ApplicationLifeCycleManager")}get managedId(){var e;return null===(e=this._application)||void 0===e?void 0:e.manifest.id}manageApplication(e){this._application=e}onChange(e){const t=[];if(!this._application)return t;this._currentChanges.set(e.type,e);const n=(i=this._scope)===eN.Experience?[gN]:[mN,(a=i===tN.FirstUserAtBoot,({app:e,currentChanges:t,sessionContext:n})=>{const i=sN(t,a);if(i){const t=ZA.onPreWarm;return{app:e,state:t,callback:()=>cN(e,{context:Object.assign(Object.assign({},n),i),state:t})}}}),pN];var i,a;for(const i of n){const n=vN({application:this._application,appLifeCyclePermissions:this._appLifeCyclePermissions,change:e,currentChanges:this._currentChanges,getNextState:i,getCachedSupportSet:()=>this.supportedSets,logger:this._logger,sessionContext:this._sessionContext});n&&t.push(n)}return t}get supportedSets(){return this._supportedEntitySet=this._supportedEntitySet||this._application&&function(e){const t=e.manifest.supportedEntities,n=new Set;return t&&t.reduce(((e,t)=>e.add(t)),n),n}(this._application),this._supportedEntitySet}}function fN({applicationManagers:e,change:t,logger:n,schedulerWithValidator:i}){const a=[];return n.debug(`Change received: ${t.type}`),e.forEach((e=>{const o=e.managedId,r=e.onChange(t);o&&r.length>0&&r.forEach((e=>a.push(function(e,t,n,i){return(0,c.mG)(this,void 0,void 0,(function*(){const{jobs:a,change:o}=e,r=[];a.forEach((e=>{r.push(function(e,t,n){var{job:i}=e,a=(0,c._T)(e,["job"]);return new Promise(((e,o)=>{t.validateAndSchedule((()=>(0,c.mG)(this,void 0,void 0,(function*(){try{const t=yield i();return e(t),t}catch(e){throw o(e),e}}))),Object.assign(Object.assign({priority:Ia.vW.Macro},a),{scheduledById:"services-life-cycle-manager"}),n)===Ia.o_&&e(void 0)}))}(e,i,o.correlationId))}));const s=[];let l=zA.success;for(const e of r)try{const t=yield e;t&&s.push(t)}catch(e){const i=`Not all jobs scheduled by ${n} completely successfully. Continuing execution of remaining jobs. Error: ${e.message?e.message:e}`;t.errorToTelemetry&&t.errorToTelemetry(i,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0),l=zA.failure}return Promise.resolve({id:n,type:o.type,stateJobStatus:l,jobCount:a.length,cleanupJobs:s})}))}(e,n,o,i))))})),{change:t,lcChanges:a}}function yN({change:e,lcChanges:t}){return(0,c.mG)(this,void 0,void 0,(function*(){const n=yield Promise.all(t);return{change:e,lcChanges:n}}))}function kN({change:e,lcChanges:t},n,i){const{type:a}=e;0===t.length&&n.debug(`Experience change type: ${a} produced no application life cycle changes`);const o=i===eN.Experience?JA.ExperienceLifeCycleManager:JA.UserLifeCycleManager;return Object.assign(Object.assign({},e),{type:qA.LifeCycleReport,context:{apps:t,target:o,reportedChange:e}})}class CN{constructor(e,t,n,i,a,o,r){this._scope=t,this._sessionContext=i,this._lifeCycleChangeReportingService=a,this._loggerFactory=o,this._lifeCycleJobPermissions=r,this._cleanupJobs=[],this._applicationManagers=[],this._activelyManagedApplications=new Set,this._lifeCycleJobPermissions=this._lifeCycleJobPermissions||{},this._logger=this._loggerFactory.newLogger(`UserLifeCycleManager[${e}]`),this._schedulerWithValidator=new oN(n,o)}manageApplication(e){var t;if(this._activelyManagedApplications.has(e))return;this._activelyManagedApplications.add(e);const n=new SN(this._scope,null===(t=this._lifeCycleJobPermissions)||void 0===t?void 0:t.Application,this._sessionContext);n.manageApplication(e),this._applicationManagers.push(n)}notify(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=fN({applicationManagers:this._applicationManagers,change:e,logger:this._logger,schedulerWithValidator:this._schedulerWithValidator}),n=yield yN(t);for(const{cleanupJobs:e}of n.lcChanges)this._cleanupJobs.push(...e);const i=kN(n,this._logger,this._scope);this._lifeCycleChangeReportingService.report(i)}))}destroy(e){var t,n,i;return(0,c.mG)(this,void 0,void 0,(function*(){let a,o,r;for(;a=this._cleanupJobs.pop();)try{yield a(e)}catch(e){r=r?r.concat(`${a.toString()}::${(0,R.u4)(e)}`):`${a.toString()}::${(0,R.u4)(e)}::`}r&&(o=new ze.G(ze.$.CLEANUP,new Error(r)),null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,`${o.code}${null===(i=o.prevError)||void 0===i?void 0:i.message}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0))}))}}class bN{constructor(e,t,n,i,a,o){this._scheduler=e,this._experienceChangeReportingService=t,this._sessionContext=n,this._lifeCycleChangeReportingService=i,this._loggerFactory=a,this._lifeCycleJobPermissions=o,this._cleanupJobs=[],this._userLifecycleManagers=new Map,this.handleUserScopeChange=e=>{if(e.userContextId){const t=this._userLifecycleManagers.get(e.userContextId);t?t.notify(e):this._logger.error(`EXPECTED_USER_LIFECYCLE_MANAGER_NOT_FOUND[${e.userContextId}]`)}else this._userLifecycleManagers.forEach((t=>t.notify(e)))},this._applicationManagers=[],this._activelyManagedApplications=new Set,this._lifeCycleJobPermissions=this._lifeCycleJobPermissions||{},this._logger=this._loggerFactory.newLogger("ExperienceLifeCycleManager"),this._schedulerWithValidator=new oN(this._scheduler,a)}init(){const e=this._experienceChangeReportingService.observeChanges();this._subscription=e.pipe((0,y.b)(this.handleUserScopeChange),(0,h.U)((e=>fN({applicationManagers:this._applicationManagers,change:e,logger:this._logger,schedulerWithValidator:this._schedulerWithValidator}))),(0,fe.b)(yN),(0,y.b)((e=>{for(const{cleanupJobs:t}of e.lcChanges)this._cleanupJobs.push(...t)})),(0,h.U)((e=>kN(e,this._logger,eN.Experience))),(0,h.U)((e=>this._lifeCycleChangeReportingService.report(e)))).subscribe()}destroy(e){var t,n,i;return(0,c.mG)(this,void 0,void 0,(function*(){let a,o,r;for(;a=this._cleanupJobs.pop();)try{yield a(e)}catch(e){r=r?r.concat(`${a.toString()}::${(0,R.u4)(e)}`):`${a.toString()}::${(0,R.u4)(e)}::`}this._subscription&&this._subscription.unsubscribe(),this._scheduler.destroy(),r&&(o=new ze.G(ze.$.CLEANUP,new Error(r)),null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,`${o.code}${null===(i=o.prevError)||void 0===i?void 0:i.message}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0))}))}manageApplication(e){var t;if(!this._subscription)throw new Error("Unable to manage provided application prior to LifeCycleManager init.");if(this._activelyManagedApplications.has(e))return;this._activelyManagedApplications.add(e);const n=new SN(eN.Experience,null===(t=this._lifeCycleJobPermissions)||void 0===t?void 0:t.Application,this._sessionContext);n.manageApplication(e),this._applicationManagers.push(n)}manageUser(e,t){if(this._userLifecycleManagers.has(e))return void this._logger.error(`USER_LIFECYCLE_MANAGER_ALREADY_EXISTS[${e}]`);const n=new CN(e,this._userLifecycleManagers.size>0?tN.Other:tN.FirstUserAtBoot,this._scheduler,t,this._lifeCycleChangeReportingService,this._loggerFactory,this._lifeCycleJobPermissions);this._activelyManagedApplications.forEach((e=>n.manageApplication(e))),this._userLifecycleManagers.set(e,n)}removeUser(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){const n=this._userLifecycleManagers.get(t);n?(yield n.destroy(e),this._userLifecycleManagers.delete(t)):this._logger.warn(`USER_LIFECYCLE_MANAGER_NOT_FOUND_TO_DESTROY[${t}]`)}))}}const TN=(e,t,n,i)=>{const a=function(e,t,n){if(!n){const{context:{execution:n}}=e;t.error(`Received a scheduler change in state: ${Ia.Tf[n]} with no active scenario: ${JSON.stringify(e)}`)}return n}(e,t,i);if(a){const{context:{execution:t,handle:i,error:o}}=e;a.appendEventData({errorCode:null==o?void 0:o.code,message:null==o?void 0:o.message,context:null==o?void 0:o.context}),a.mark(`${ee.ck.ScheduledJobStateChange}_${Ia.Tf[t].toLocaleLowerCase()}_${i}`),n(a)}};class wN{constructor(e,t,n){this._schedulerChangeReporting=e,this._scenarioFactory=t,this._activeExpScenariosMap=new Map,this._activeAppScenariosMap=new Map,this._activeSchedulerScenariosMap=new Map,this._logger=n.newLogger("LifeCycleTelemetry")}init(){const e=e=>({change:e,scenarioFactory:this._scenarioFactory,activeAppScenariosMap:this._activeAppScenariosMap,activeExpScenariosMap:this._activeExpScenariosMap,activeSchedulerScenariosMap:this._activeSchedulerScenariosMap,logger:this._logger});this._schedulingChangeSubscription=this._schedulerChangeReporting.observeChanges().pipe((0,h.U)((t=>function({change:e,activeSchedulerScenariosMap:t,scenarioFactory:n,logger:i}){const{context:{execution:a}}=e,o=(({windowId:e,context:{handle:t}})=>`${t}:${e}`)(e);let r=t.get(o);switch(a){case Ia.Tf.Started:if(r)i.error(`Received a scheduler change in state: ${Ia.Tf[a]} with an active scenario already running. Change: ${JSON.stringify(e)}`);else{r=n.newScenario(ee.RG.ScheduledJobComplete),t.set(o,r);const{correlationId:i,context:{meta:{id:a,priority:s,scheduledById:l,runOncePerId:d},target:c},type:u}=e;r.appendEventData({"Job.Id":a,"Job.Priority":Ia.vW[s],"Job.ScheduledBy":l,"Job.RunOncePerId":d,target:c,correlationId:i,type:u})}break;case Ia.Tf.Canceled:TN(e,i,(e=>null==e?void 0:e.cancel()),r);break;case Ia.Tf.Complete:TN(e,i,(e=>null==e?void 0:e.stop()),r),t.delete(o);break;case Ia.Tf.Received:i.log(`Received a scheduler change in state: ${Ia.Tf[a]}: Change:${JSON.stringify(e)}`)}}(e(t))))).subscribe()}destroy(){this._schedulingChangeSubscription&&this._schedulingChangeSubscription.unsubscribe(),this._schedulingChangeSubscription=void 0}}var _N,IN;!function(e){e[e.SingleAccount=0]="SingleAccount",e[e.MultipleAccounts=1]="MultipleAccounts"}(_N||(_N={})),function(e){e.p720="720p",e.p1080="1080p",e.p2k="2k",e.p4k="4k",e.unkown="unkown"}(IN||(IN={}));const AN=2073600,NN=3686400,EN=8294400;function DN(e){var t,n,i;return(0,c.mG)(this,void 0,void 0,(function*(){const a={Perf_Screen:void 0};let o;const r=e.screen.availWidth*(null===(t=e.screen)||void 0===t?void 0:t.availHeight);return o=r<AN?IN.p720:r>=AN&&r<NN?IN.p1080:r>=NN&&r<EN?IN.p2k:r>=EN?IN.p4k:IN.unkown,a.Perf_Screen={width:null===(n=e.screen)||void 0===n?void 0:n.availWidth,height:null===(i=e.screen)||void 0===i?void 0:i.availHeight,resolution:o,dpr:e.devicePixelRatio},Promise.resolve(a)}))}var FN=n(13242);class PN{constructor(e){this.context=e,this.granularNativeMetrics=[],this.packedCallingData=new Map,this.heartbeatToGranularIndex=1,this.peakWorkingSetByProcess=new Map,this.peakUsedJSHeapSize=0,this.granularJSHeapMetrics=[],this.logger=e.loggerFactory.newLogger("Heartbeat")}static getInstance(){return PN.instance}get configuration(){return this._configuration}start(){return(0,c.mG)(this,void 0,void 0,(function*(){this.logger.debug("Starting the monitor..."),this.subscribeToCoreSettings(),this.initializedTime=(new Date).getTime(),yield this.registerScenarios(),PN.instance=this}))}stop(){var e;this.logger.debug("Stopping the monitor..."),this.isHeartbeatMonitorRunning()&&(null===(e=this.context.windowProvider)||void 0===e||e.clearTimeout(this.heartbeatTimeoutId),this.heartbeatTimeoutId=void 0,PN.instance=void 0,this.stopExtraIntervals())}subscribeToCoreSettings(){var e;const t=null===(e=this.context.coreSettings)||void 0===e?void 0:e.getObservable(A.J.Telemetry);null==t||t.subscribe((e=>{var t,n;const{enableHeartbeatMonitor:i,heartbeatConfiguration:a}=e;if(i||this.isHeartbeatMonitorRunning()||this.logger.warn("'enableHeartbeatMonitor' flag is NOT enabled"),!i&&this.isHeartbeatMonitorRunning()&&(this.logger.warn("'enableHeartbeatMonitor' flag was turned off"),this.stopHeartbeat()),a?(this._configuration=a,this.logger.debug("Configuration loaded...",this._configuration)):null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,"'heartbeatConfiguration' not found.","fundamentals_performance_heartbeat_monitor"),i&&this._configuration&&!this.isHeartbeatMonitorRunning()){this.logger.debug("'enableHeartbeatMonitor' flag is enabled");const{intervalInSeconds:e,memoryMetricsCollection:t}=this._configuration;e&&this.startHeartbeat(e*_.B.second),(null==t?void 0:t.enabled)&&(null==t?void 0:t.collectionIntervalInSeconds)?(this.heartbeatToGranularIndex=Math.floor(e/(t.collectionIntervalInSeconds||1))||1,this.startExtraInterval(t.collectionIntervalInSeconds*_.B.second)):this.stopExtraIntervals()}}))}startHeartbeat(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){this.heartbeatTimeoutId=null===(t=this.context.windowProvider)||void 0===t?void 0:t.setTimeout(this.createBeatTimeout.bind(this,e),e)}))}createBeatTimeout(e){return(0,c.mG)(this,void 0,void 0,(function*(){try{yield this.beat()}finally{this.startHeartbeat(e)}}))}stopHeartbeat(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){null===(e=this.context.windowProvider)||void 0===e||e.clearTimeout(this.heartbeatTimeoutId),this.heartbeatTimeoutId=void 0}))}beat(){return(0,c.mG)(this,void 0,void 0,(function*(){const e=yield this.collectData();e&&(0,le.aA)(e)}))}isHeartbeatMonitorRunning(){return void 0!==this.heartbeatTimeoutId}collectData(){return(0,c.mG)(this,void 0,void 0,(function*(){const e=this.getActions().map((e=>e()));return Object.assign.apply(Object,yield Promise.all(e))}))}getActions(){var e,t,n,i,a,o,r,s,l,d,c,u,m,g,p,h,v,S,f,y;const k=[];return(null===(t=null===(e=this._configuration)||void 0===e?void 0:e.memoryMetricsCollection)||void 0===t?void 0:t.enabled)&&k.push(this.getAverageMemoryMetrics.bind(this)),(null===(i=null===(n=this._configuration)||void 0===n?void 0:n.elapsedTimeTracking)||void 0===i?void 0:i.enabled)&&k.push(this.getElapsedTime.bind(this)),(null===(o=null===(a=this._configuration)||void 0===a?void 0:a.screenInfoCollection)||void 0===o?void 0:o.enabled)&&k.push(DN.bind(this,this.context.windowProvider)),(null===(s=null===(r=this._configuration)||void 0===r?void 0:r.ariMetricsCollection)||void 0===s?void 0:s.enabled)&&k.push(this.getAriMetrics.bind(this)),(null===(d=null===(l=this._configuration)||void 0===l?void 0:l.dataClientMetricsCollection)||void 0===d?void 0:d.enabled)&&k.push(this.getDataClientMetrics.bind(this)),(null===(u=null===(c=this._configuration)||void 0===c?void 0:c.windowMetricsCollection)||void 0===u?void 0:u.enabled)&&k.push(this.getWindowMetrics.bind(this)),(null===(g=null===(m=this._configuration)||void 0===m?void 0:m.clientStateMetricsCollection)||void 0===g?void 0:g.enabled)&&k.push(this.getClientStateMetrics.bind(this)),(null===(h=null===(p=this._configuration)||void 0===p?void 0:p.OLDMetricsCollection)||void 0===h?void 0:h.enabled)&&k.push(this.getObjectLeakDetectorMetrics.bind(this)),(null===(S=null===(v=this._configuration)||void 0===v?void 0:v.callingDataCollection)||void 0===S?void 0:S.enabled)&&k.push(this.getCallingData.bind(this)),(null===(y=null===(f=this._configuration)||void 0===f?void 0:f.graphqlStoreMetricsCollection)||void 0===y?void 0:y.enabled)&&k.push(this.getGraphQLStoreMetrics.bind(this)),k}collectCallingData(e,t){var n,i,a,o,r,s;const{enableCallingCDLTrackingNS:l}=(null===(n=this.context.coreSettings)||void 0===n?void 0:n.get(A.J.Calling))||{};if(l){const e=JSON.parse(t),n={cdlData:null===(i=this.context.graphqlOpsCountService)||void 0===i?void 0:i.getLatestDataAndClear()},a=Object.assign(e,n);t=JSON.stringify(a)}(null===(a=this.packedCallingData)||void 0===a?void 0:a.has(e))||null===(o=this.packedCallingData)||void 0===o||o.set(e,[]),null===(s=null===(r=this.packedCallingData)||void 0===r?void 0:r.get(e))||void 0===s||s.push(t)}startExtraInterval(e){var t,n;const i=null===(t=this.context.windowProvider)||void 0===t?void 0:t.setTimeout(this.createExtraIntervalTimeout.bind(this,e),e);i&&(null===(n=this.extraCollectionIntervalIds)||void 0===n||n.push(i))}createExtraIntervalTimeout(e){return(0,c.mG)(this,void 0,void 0,(function*(){try{yield this.collectGranularMemoryAndJSHeapData()}finally{this.startExtraInterval(e)}}))}stopExtraIntervals(){var e;if(this.extraCollectionIntervalIds&&this.extraCollectionIntervalIds.length>0){for(const t of this.extraCollectionIntervalIds)null===(e=this.context.windowProvider)||void 0===e||e.clearTimeout(t);this.extraCollectionIntervalIds=[]}}getElapsedTime(){const e=(new Date).getTime(),t=(null==this?void 0:this.initializedTime)||e;return{elapsed:Math.floor((e-t)/_.B.second)}}getAverageMemoryMetrics(){return(0,c.mG)(this,void 0,void 0,(function*(){const e=[];this.granularNativeMetrics.length&&this.granularNativeMetrics.reduce(((e,t)=>{var n;for(const i of t){const{processId:t}=i;e.set(t,(null!==(n=e.get(t))&&void 0!==n?n:[]).concat(i))}return e}),new Map).forEach(((t,n)=>{const i=(0,Z.meanBy)(t,(e=>e.workingSetSizeKB)),a=(0,Z.meanBy)(t,(e=>e.commitSizeKB)),o={processId:n,name:t[0].name,type:t[0].type,utilitySubType:t[0].utilitySubType,embeddedBrowserWebView:t[0].embeddedBrowserWebView,cpuCycleTime:t[0].cpuCycleTime,workingSetSizeKB:isNaN(i)?void 0:Math.round(i),commitSizeKB:isNaN(a)?void 0:Math.round(a)};e.push(o)}));const t=(0,GA.o4)(e,this.peakWorkingSetByProcess);let n={};if(this.granularJSHeapMetrics.length){const e={jsHeapSizeLimit:Math.round((0,Z.meanBy)(this.granularJSHeapMetrics,(e=>e.jsHeapSizeLimit||0))),totalJSHeapSize:Math.round((0,Z.meanBy)(this.granularJSHeapMetrics,(e=>e.totalJSHeapSize||0))),usedJSHeapSize:Math.round((0,Z.meanBy)(this.granularJSHeapMetrics,(e=>e.usedJSHeapSize||0)))};n=(0,GA.RQ)(e,this.peakUsedJSHeapSize)}return Object.assign(Object.assign({},t),n)}))}getAriMetrics(){return(0,c.mG)(this,void 0,void 0,(function*(){const e={Perf_Ari:""};if(this.context.appResponsivenessService){const t=this.context.appResponsivenessService.getTelemetry();e.Perf_Ari=t}return Promise.resolve(e)}))}getDataClientMetrics(){const e={Perf_ApolloCacheStats:void 0};if(this.context.dataClientTrackingService){const t=this.context.dataClientTrackingService.getTelemetry();e.Perf_ApolloCacheStats=t}return e}getWindowMetrics(){const e={Perf_WindowStats:void 0};if(this.context.windowTrackerService){const t=this.context.windowTrackerService.getTelemetry();e.Perf_WindowStats=t}return e}getObjectLeakDetectorMetrics(){const e={};return this.context.leakDetectorService&&(e.Perf_OLDStats=this.context.leakDetectorService.getTelemetry()),e}getClientStateMetrics(){const e={Perf_IsUserInCall:void 0};if(this.context.clientState){const t=this.context.clientState.getState()===Ve.pk.VeryActive;e.Perf_IsUserInCall=t}return e}getCallingData(){var e;const t={Perf_Calling_Data:void 0};return this.packedCallingData.forEach((e=>{t.Perf_Calling_Data?t.Perf_Calling_Data.push(...e):t.Perf_Calling_Data=e})),null===(e=this.packedCallingData)||void 0===e||e.clear(),t}getGraphQLStoreMetrics(){const e={};return this.context.graphqlStoreStatsReporterService&&(e.Perf_GraphQLStoreStats=this.context.graphqlStoreStatsReporterService.getTelemetry()),e}collectGranularMemoryAndJSHeapData(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){if(this.context.hostCommunicationService){const t=yield VA(this.context.hostCommunicationService);this.granularNativeMetrics=this.granularNativeMetrics.concat([t]).slice(-this.heartbeatToGranularIndex);for(const n of t){const{processId:t}=n,i=null===(e=this.peakWorkingSetByProcess)||void 0===e?void 0:e.get(t);this.peakWorkingSetByProcess.set(t,Math.max(i||0,n.workingSetSizeKB||0))}}else this.logger.error("Invalid hostCommunicationService, cannot get metrics from Desktop");if(this.context.windowProvider){const e=(0,FN.P)(this.context.windowProvider);this.peakUsedJSHeapSize=Math.max(this.peakUsedJSHeapSize,e.usedJSHeapSize||0),this.granularJSHeapMetrics=this.granularJSHeapMetrics.concat(e).slice(-this.heartbeatToGranularIndex)}}))}registerScenarios(){return(0,c.mG)(this,void 0,void 0,(function*(){if(this.context.hostCommunicationService){const e=yield this.context.hostCommunicationService.loadModule("heartbeat");if(null==e?void 0:e.registerForScenarioStart)try{e.registerForScenarioStart((e=>{}))}catch(e){this.logger.error("Failed to register for listening to host scenarios starting")}if(null==e?void 0:e.registerForScenarioStop)try{e.registerForScenarioStop((e=>{}))}catch(e){this.logger.error("Failed to register for listening to host scenarios stopping")}}}))}}PN.instance=void 0;const MN=1024,jN=1e3,RN=6e4,xN=36e5,ON=864e5,LN="memoryFeedbackService.lastDialogDate",UN="memoryFeedbackService.countOfDialogWithinDay",BN="memoryFeedbackService.countOfDialogWithinWeek";class WN{constructor(e,t,n,i,a,o,r){this.localStorage=e,this.entityCommanding=t,this.clientState=n,this.client=i,this.coreSettings=a,this.scenarioFactory=o,this.userTrackingService=r,this.timeWhenLastCallEnded=-1,this.countOfDialogWithinDay=0,this.countOfDialogWithinWeek=0,this.memoryFeedbackSettings=this.coreSettings.get(A.J.Diagnostics).memoryFeedbackSettings}start(){this.startClientStateSubscription(),this.intervalId||(this.intervalId=(0,Q.J)().setInterval((()=>this.beat()),this.memoryFeedbackSettings.verySlowSampleTime))}stop(){this.intervalId&&(0,Q.J)().clearInterval(this.intervalId),this.timeoutId&&(0,Q.J)().clearTimeout(this.timeoutId),this.clientStateSubscription&&this.clientStateSubscription.unsubscribe()}startClientStateSubscription(){let e=this.clientState.getState();this.clientStateSubscription=this.clientState.observe().subscribe({next:t=>{e===Ve.pk.VeryActive&&t!==Ve.pk.VeryActive&&(this.timeWhenLastCallEnded=Date.now()),e=t}})}beat(){var e,t;return(0,c.mG)(this,void 0,void 0,(function*(){if((null===(e=this.userTrackingService)||void 0===e?void 0:e.getAccountMode())===_N.MultipleAccounts)return void this.stop();const n=yield null===(t=PN.getInstance())||void 0===t?void 0:t.collectData();if(!n)return;if(void 0!==(null==n?void 0:n.Perf_Renderer_Count_Processes)&&(null==n?void 0:n.Perf_Renderer_Count_Processes)>1)return this.stop(),void this.newScenario(ee.RG.MemoryFeedbackStopBecauseOfDevtools);const i=new Date;(yield this.shouldShowBrbDialog(i,n))&&(this.openBrbDialog(),this.newScenario(ee.RG.MemoryFeedbackDialogOpen),this.dateOfBeginingHighMemory=void 0,this.localStorage.set(UN,(this.countOfDialogWithinDay+1).toString()),this.localStorage.set(BN,(this.countOfDialogWithinWeek+1).toString()),this.localStorage.set(LN,i.toString()))}))}openBrbDialog(){this.entityCommanding.brbFeedback.autoBrbConfirmationDialog({visibilityState:Ae.fe.show,stateTransition:Ae.su.new,correlation:{source:I.D.AutoBrb}},{feedbackText:`Detected high memory usage.\n${this.memoryDetailMessage||""}`})}shouldShowBrbDialog(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){const n=yield(0,Nr.jW)(this.client);if(!(null==n?void 0:n.isMainWindow))return!1;if(this.updateMemoryUsageData(t),!this.isMemoryHeavy)return this.dateOfBeginingHighMemory=void 0,!1;if(this.dateOfBeginingHighMemory=this.dateOfBeginingHighMemory||e,e.getTime()-this.dateOfBeginingHighMemory.getTime()<this.memoryFeedbackSettings.durationInMinuteOfConsecutiveHighMemoryState*RN)return!1;if(this.hasReachedDialogLimit(e))return!1;const i=this.clientState.getState();return!(!i||i===Ve.pk.VeryActive||i!==Ve.pk.Active)&&!this.wasInCallRecently(e)}))}updateMemoryUsageData(e){const t=this.getThresholds(),n=[],i=(null==e?void 0:e.Perf_Renderer_WorkingSet)||0,a=i>t.rendererWorkingSet*MN;this.isMemoryHeavy=a,n.push(`${this.markReachedThreshold(a)}RWS: ${this.convertKBtoMB(i)} MB`);const o=(null==e?void 0:e.Perf_JSHeap_UsedSize)||0,r=o>t.jsUsedHeapSize*MN;this.isMemoryHeavy=this.isMemoryHeavy||r,n.push(`${this.markReachedThreshold(r)}JSH: ${this.convertKBtoMB(o)} MB`),this.memoryDetailMessage=n.join(", ")}hasReachedDialogLimit(e){const t=new Date(this.localStorage.get(LN)||0);return e.getTime()-t.getTime()<this.memoryFeedbackSettings.gapInHourBetweenFeedbackDialogs*xN||(e.getTime()-t.getTime()>ON&&this.resetDialogDayCount(),this.countOfDialogWithinDay=parseInt(this.localStorage.get(UN)||"0",10),this.countOfDialogWithinDay>=this.memoryFeedbackSettings.limitOfFeedbackDialogsWithinDay||(e.getTime()-t.getTime()>7*ON&&this.resetDialogWeekCount(),this.countOfDialogWithinWeek=parseInt(this.localStorage.get(BN)||"0",10),this.countOfDialogWithinWeek>=this.memoryFeedbackSettings.limitOfFeedbackDialogsWithinWeek))}wasInCallRecently(e){const t=this.memoryFeedbackSettings.minimumSecondsPassedSinceLastCall*jN,n=this.timeWhenLastCallEnded>0&&e.getTime()-this.timeWhenLastCallEnded;return n&&t&&n<t}newScenario(e){this.scenarioFactory.newScenario(e).stop()}getThresholds(){return this.memoryFeedbackSettings.thresholdsInMB}resetDialogDayCount(){this.localStorage.set(UN,"0")}resetDialogWeekCount(){this.localStorage.set(BN,"0")}markReachedThreshold(e){return e?"#":""}convertKBtoMB(e){return(e/MN).toFixed(2)}}var GN,VN=n(91400);!function(e){e.LifeCycleScopeChange="LifeCycleScopeChange"}(GN||(GN={}));class HN extends xe{constructor(){super(_.Yg.Scheduling,["appsRegistryService","client","clientState","config","coreSecurityService","coreSettings","coreSettingsContext","coreUtilities","entityCommanding","experienceChangeReportingService","hostCommunicationService","i18n","i18NextWrapper","lifeCycleScopeChangeReportingService","localStorage","loggerFactory","networkState","platformService","rebootService","scenarioFactory","schedulerChangeReporting","userBiService","windowProvider"]),this.createCoreApplication=(e,t)=>({manifest:{name:"CoreTasks",id:"com.microsoft.teams.corescheduling"},onExperienceWarm:e=>[{id:"memory-feedback-service-start",job:()=>{const{context:{localStorage:t,entityCommanding:n,clientState:i,coreSettings:a,client:o,scenarioFactory:r,userTrackingService:s}}=e;if(!a.get(A.J.Diagnostics).enableMemoryFeedbackService)return;if(!t||!i||!a.get(A.J.Diagnostics).memoryFeedbackSettings)return;new WN(t,n,i,o,a,r,s).start()}}],onPreWarm:n=>[{id:"settings-ecs-fetch",job:()=>e.fetchEcsSettingsIfApplicable()},{id:"user-bi-initialize-smb-user-intent",job:()=>t.initializeAndSubscribeToSmbUserIntent&&t.initializeAndSubscribeToSmbUserIntent()},{id:"active-windows-history-job",job:()=>{const{context:{activeWindowsHistoryService:e}}=n;if(e)return e.initialize(),t=>{e.cleanup(t)}}},{id:"initialize-office-integration-service",job:()=>{const{context:{coreSettings:e,client:t,hostCommunicationService:i,loggerFactory:a,entityCommanding:o,authenticationUser:r,localStorage:s,windowProvider:l}}=n;e.get(A.J.People).enableOfficeIntegration&&VN.x.Instance(i,e,t,a,o,l,s,r).initialize()}}]})}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=e.config,n=e.coreSettings,i=e.coreSettingsContext,a=e.entityCommanding,o=e.experienceChangeReportingService,r=e.hostCommunicationService,s=e.i18n,l=e.lifeCycleScopeChangeReportingService,d=e.loggerFactory,u=e.networkState,m=e.platformService,g=e.scenarioFactory,p=e.schedulerChangeReporting,h=e.userBiService,v=e.clientState,S=e.localStorage,f=e.i18NextWrapper,y=e.windowProvider,k=e.rebootService,C=e.coreSecurityService;new wN(p,g,d).init();const b=new ja(p,window,d,_.QU),{isEntityInView:T}=e.coreUtilities,w=new bN(b,o,{client:e.client,coreSettings:n,entityCommanding:a,i18n:s,isEntityInView:T,loggerFactory:d,networkState:u,platformService:m,scenarioFactory:g,hostCommunicationService:r,clientState:v,localStorage:S,config:t,i18NextWrapper:f,windowProvider:y,rebootService:k,coreSecurityService:C},l,d,t.lifeCycleJobPermissions);return w.init(),e.appsRegistryService.registeredApps.forEach((e=>w.manageApplication(e))),w.manageApplication(this.createCoreApplication(i,h)),e.scheduler=b,e.experienceLifecycleManager=w,e=>(0,c.mG)(this,void 0,void 0,(function*(){switch(e){case"quit":case"signout":yield w.destroy(e);break;default:return}}))}))}}class $N{constructor(e,t,n,i,a,o,r){this.experienceChangeReportingService=e,this.commandChangeReportingService=t,this.appsRegistryService=n,this.scheduler=i,this.hostComms=a,this.userKey=o,this.context=r,this.mainWindowDisplayedChange={windowId:null,eventFired:!1},this.processExperienceChangeChange=e=>(0,c.mG)(this,void 0,void 0,(function*(){e.type===Tt.yU.UserConsentedToConsumeResources&&(this.layoutRenderedChange&&(this.layoutRenderedChange=void 0),this.userConsentedChange=e),e.type===Tt.FV.LayoutRenderComplete&&!0===e.isMainWindow&&(this.layoutRenderedChange=e),this.tryToSendSignal()})),this.onWindowVisibilityChanged=e=>(0,c.mG)(this,void 0,void 0,(function*(){var t;const n=yield this.isMainWindowForActiveUserContext(e.windowId);if(!e.visible||this.mainWindowDisplayedChange&&(null===(t=this.mainWindowDisplayedChange)||void 0===t?void 0:t.eventFired))e.visible||(n&&(this.mainWindowDisplayedChange.windowState=yield this.getWindowState(e.windowId)),this.mainWindowDisplayedChange.eventFired=!1,this.mainWindowDisplayedChange.windowId=null);else{if(!n)return;this.mainWindowDisplayedChange.windowId=e.windowId,this.tryToSendSignal()}}))}init(){var e;return(0,c.mG)(this,void 0,void 0,(function*(){this.experienceChangeReportingServiceSubscription=this.experienceChangeReportingService.observeChanges().pipe((0,S.h)((e=>e.userContextId===this.userKey))).subscribe(this.processExperienceChangeChange),this.commandChangeReportingServiceSubscription=this.commandChangeReportingService.observeChanges().pipe((0,S.h)((e=>e.userContextId===this.userKey&&!!e.isMainWindow&&e.type===Qe.B.WindowCreated&&e.context.layoutMode===Ae.lO.standard))).subscribe((e=>{this.mainWindowRenderedChange=e,this.tryToSendSignal()}));const t=yield this.hostComms.loadModule("windowcontrols");this.windowVisibilityChangeSubscription=null===(e=null==t?void 0:t.registerForWindowVisibilityChanged)||void 0===e?void 0:e.call(t,this.onWindowVisibilityChanged)}))}dispose(){this.experienceChangeReportingServiceSubscription&&this.experienceChangeReportingServiceSubscription.unsubscribe(),this.commandChangeReportingServiceSubscription&&this.commandChangeReportingServiceSubscription.unsubscribe(),this.windowVisibilityChangeSubscription&&this.windowVisibilityChangeSubscription()}tryToSendSignal(){if(!this.shouldSendSignal())return;const e=this.appsRegistryService.registeredApps;this.scheduler.schedule((()=>{e.forEach((e=>{e.UNSAFE_onSignal&&e.UNSAFE_onSignal({type:"main_window_rendered",userContextId:this.userKey},this.context)}))}),{id:"on-signal-job",priority:Ia.vW.Macro,scheduledById:"signal-processor"},(0,Je.v4)()),this.reset()}isMainWindowForActiveUserContext(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=yield(0,Nr.jW)(this.context.client);return e===(null==t?void 0:t.id)&&t.userContextId===this.userKey}))}getWindowState(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const n=yield this.hostComms.loadModule("windowcontrols");return null===(t=null==n?void 0:n.getWindowState)||void 0===t?void 0:t.call(n,e)}))}shouldSendSignal(){return this.windowHasBeenCreatedAndSignalsHaveFired()||this.windowHasToggledVisibilityAndWasNotMinimizedOrRestored()}windowHasBeenCreatedAndSignalsHaveFired(){return!!this.userConsentedChange&&!!this.mainWindowRenderedChange&&!!this.layoutRenderedChange}windowHasToggledVisibilityAndWasNotMinimizedOrRestored(){return!(!this.userConsentedChange||!this.mainWindowDisplayedChange.windowId||this.mainWindowDisplayedChange.eventFired||this.windowWasMinimized())}windowWasMinimized(){var e;return!0===(null===(e=this.mainWindowDisplayedChange.windowState)||void 0===e?void 0:e.minimized)}reset(){this.mainWindowRenderedChange=void 0,this.layoutRenderedChange=void 0,this.mainWindowDisplayedChange.eventFired=!0}}class zN extends xe{constructor(){super(_.Yg.CreateSignalProcessor,["appsRegistryService","experienceChangeReportingService","client","coreSettings","entityCommanding","loggerFactory","platformService","scenarioFactory","scheduler","hostCommunicationService","commandChangeReportingService","authenticationUser"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{appsRegistryService:t,experienceChangeReportingService:n,client:i,coreSettings:a,entityCommanding:o,loggerFactory:r,platformService:s,scenarioFactory:l,scheduler:d,hostCommunicationService:c,commandChangeReportingService:u,authenticationUser:m}=e,g=new $N(n,u,t,d,c,(0,qe.b)(m),{client:i,coreSettings:a,entityCommanding:o,loggerFactory:r,platformService:s,scenarioFactory:l});return g.init(),()=>{g.dispose()}}))}}class qN{constructor(e,t=""){e.debug("Initialized telemetry context service for "+(t?"user":"default context")),this.userId=t,this._telemetryProvider=(0,Jn.G)()}initialize(e){e.debug("Initialized telemetry context service"),this._telemetryProvider=(0,Jn.G)()}setContext(e,t,n,i=""){this._telemetryProvider.setContext(e,t,n,i||this.userId)}setCoreContext(e,t,n){this._telemetryProvider.setContext(e,t,n)}setDeviceAuthToken(e){this._telemetryProvider.setDeviceAuthToken(e)}setUserId(e){this.userId=e}setPrimaryUser(e,t){this._telemetryProvider.setPrimaryUser(e,t)}}class JN extends xe{constructor(){super(_.Yg.TelemetryContext,["loggerFactory"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=e.loggerFactory.newLogger("CreateTelemetryContextTask");e.telemetryContextService=new qN(t)}))}}class QN{constructor(){this._userContextIds=new Set,this._accountModeObservable=new u.X(_N.SingleAccount)}trackUser(e){this._userContextIds.add(e),this._accountModeObservable.next(this._userContextIds.size>1?_N.MultipleAccounts:_N.SingleAccount)}removeUser(e){this._userContextIds.delete(e),this._accountModeObservable.next(this._userContextIds.size>1?_N.MultipleAccounts:_N.SingleAccount)}getAuthenticatedUsers(){return this._userContextIds}has(e){return this._userContextIds.has(e)}getAccountMode(){return this._accountModeObservable.value}getAccountModeObservable(){return this._accountModeObservable}}class KN extends xe{constructor(){super(_.Yg.CreateTrackUserServiceTask,[])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){e.userTrackingService=new QN}))}}class YN extends xe{constructor(){super(_.Yg.CreateUserDataClient,["scenarioFactory","loggerFactory","windowProvider","coreSettings","client"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){if(!e.client)throw new Error("CreateUserDataClientTask: core data client doesn't exist, cannot initialize user client");const t=yield function(e,t,n){var i;return(0,c.mG)(this,void 0,void 0,(function*(){const{networkState:a,coreSettings:o,leakDetectorService:r,platformService:s,config:l,graphqlStoreStatsReporterService:d}=e,c=new Qg.pS,u=(0,od.UZ)(ys.l,a.observeIsOnline()),m=Object.assign(Object.assign({},e),{pubsub:c,send:u}),g=Cy.clientResolvers;if(!g)throw new Error("Client resolvers should be created at this point");const{maxApolloResultCacheSize:p,enableViewSchema:h}=o.get(A.J.Core),{enableApolloDevtools:v}=o.get(A.J.Diagnostics),S=null!=p?p:void 0,f=null==r?void 0:r.create(),y=(null==e?void 0:e.authenticationUser)&&(0,qe.b)(e.authenticationUser),k=p_({leakDetector:f,userContextId:y,windowId:_.ew,entityType:n,viewportContext:"cmd"},void 0,g,S,e.loggerFactory,e.scenarioFactory,void 0,v,Kg.t.cmd,d);sp(k,`mtma-cmd-${(null===(i=null==e?void 0:e.authenticationUser)||void 0===i?void 0:i.loginUserName)||"nouser"}`,Boolean(v),s,l.experienceName);const C=u_.createUserDataRequestContext(m,k),b=yield mh.createLink(Object.assign({contextValue:C},m));k.setLink(b);const T=g_(e,c,f,b,e.loggerFactory,e.scenarioFactory,g,y);let w;h&&(w=h_(e,0,f,mh.createViewSchemaLink(e),e.loggerFactory,e.scenarioFactory));const{dataOpsTracker:I,dataEvictionService:N}=t.getServices();return new wy({pubsub:c,leakDetector:f,scenarioFactory:C.scenarioFactory,coreSettings:C.coreSettings,dataOpsTracker:I,dataEvictionService:N,graphqlStoreStatsReporterService:e.graphqlStoreStatsReporterService},t,T,C,w)}))}(e,e.client,Rt.EntityType.default);return e.client=t,e=>{switch(e){case"signout":case"quit":t.destroy()}}}))}}const XN=12e4,ZN={"cdl-request":!0};var eE=n(93330);class tE{constructor(e,t,n={}){this.name=e,this.id=t,this.excludedTimings=n,this.previousMark=""}markPerformanceApi(e,t=""){if(performance&&performance.mark&&performance.measure&&this.shouldMark(this.name)){const n=`${e} ${this.name}-${this.id}`;if(performance.mark(n),e===ee.ck.Stop){let e=`start ${this.name}-${this.id}`;0===(performance.getEntriesByName(e,"mark")||[]).length&&(e="navigationStart");const i=[this.name,t&&`(${t})`].join(" ");performance.measure(i,e,n)}this.previousMark&&performance.measure(`${this.name} [${this.previousMark} <=> ${e}]`,`${this.previousMark} ${this.name}-${this.id}`,n),this.previousMark=e}}shouldMark(e){return!(e in this.excludedTimings)||this.excludedTimings[e]}}class nE{constructor(e,t,n,i,a,o,r=(0,Je.v4)(),s=ee.t7.Expanded,l="",d={}){this.name=e,this.clientId=t,this._eventData=n,this._timingData=i,this.startTime=a,this.timeoutMs=o,this.id=r,this.scenarioMode=s,this.userContextId=l,this.crossAccountScenarioOptions=d,this._isPaused=!1,this.previousStep=ee.ck.Unknown,this.sequence=1,this.active=!0,this.onStopCallbacks=[],this.__stepsPerfInfo__=[],this._testingMode=!1,this._steps=[],this._stepsEx=[],this.userIds=new Set,this.currentStep=ee.ck.Unknown,this.timestamps=[],this.intervalTimestamp=a,this.performanceMarker=new tE(this.name,this.id,ZN)}addPackedData(e,t){this._steps=this._steps.concat(e.map((e=>JSON.parse(e)))),this._stepsEx=this._stepsEx.concat(t.map((e=>JSON.parse(e))))}updateTimestamp(e,t){this.timingData[e]=t}addOnStopCallback(e){this.onStopCallbacks.push(e)}get timingData(){return this._timingData}get testingMode(){return this._testingMode}set testingMode(e){this._testingMode=e}get isPaused(){return this._isPaused}get eventData(){return this._eventData}get steps(){return this._steps}get stepsEx(){return this._stepsEx}get elapsed(){return this.calculateElapsed(Date.now())}get stepDelta(){return this.calculateStepDelta(Date.now())}get delta(){return this.calculateDelta(Date.now())}get isHoisted(){return!1}syncToState(e){this.previousStep=e.previousStep,this.intervalTimestamp=e.lastTimestamp,this.sequence=e.lastSequence}setCrossClientObservables(e){const t=e.mark.subscribe((e=>{this.mark(e.step,e.eventData,e.status)})),n=e.stop.subscribe((e=>{this.stop(e.eventData,e.status)})),i=e.appendEventData.subscribe((e=>{this.appendEventData(e.eventData)}));this.subscriptions={mark:t,stop:n,appendEventData:i}}appendEventData(e){this._eventData=Object.assign(Object.assign({},this._eventData),e)}pause(e){this._isPaused=!0,this.currentStep!==ee.ck.Unknown&&this.mark(this.currentStep)}resume(e={}){this._isPaused=!1}cancel(e={}){this.stop(e,"abandoned")}mark(e,t={},n="success"){if(!this.active)return;this.currentStep=ee.ck.Unknown;const{overrideTimestamp:i,offsetCurrentTimeInMs:a}=t,o=(0,c._T)(t,["overrideTimestamp","offsetCurrentTimeInMs"]),r=this.getBaseTimestamp(i,a),{delta:s,stepDelta:l,elapsed:d}=this.getBaseScenarioTimingData(r,t),u=e,m={"Scenario.Mode":this.scenarioMode,"Scenario.Name":this.name,"Scenario.Status":n,"Scenario.Step":u,InstanceId:this.id,sequence:this.sequence,delta:s,elapsed:d,stepDelta:l};let g;if(t=Object.assign(Object.assign({},this.eventData),o),this.scenarioMode===ee.t7.Packed&&(this.prepareAndStorePackedSteps(m),u===ee.ck.Stop&&(m["Scenario.Steps"]=JSON.stringify(this._steps),g={columnName:"Scenario.StepsEx",packedData:this._stepsEx})),this.scenarioMode===ee.t7.Expanded||u===ee.ck.Stop)if(this.isCrossAccountScenario)for(const e of this.userIds)(0,le.Yx)(this.name,t,this.finalizeScenarioData(r,m),void 0,g,e);else(0,le.Yx)(this.name,t,this.finalizeScenarioData(r,m),void 0,g,this.userContextId);this.performanceMarker.markPerformanceApi(u,this.clientName),this._testingMode&&this.__stepsPerfInfo__.push({name:u,delta:s,stepDelta:l,status:n}),this.updateScenarioStatePostMark(u,r)}stop(e={},t="success"){this.currentStep!==ee.ck.Unknown&&this.mark(this.currentStep,void 0,t),this.mark("stop",Object.assign({previousStep:this.previousStep},e),t),this.active=!1,this.subscriptions&&(this.subscriptions.appendEventData.unsubscribe(),this.subscriptions.mark.unsubscribe(),this.subscriptions.stop.unsubscribe()),this.onStopCallbacks.forEach((e=>e()))}fail(e={}){this.stop(e,"failure")}incomplete(e={}){this.stop(e,"incomplete")}startStep(e){const t=e;this.currentStep!==ee.ck.Unknown&&t!==this.currentStep&&this.mark(this.currentStep),this.currentStep=t}markAggregateStart(e){}markAggregateStop(e){}getTotalPauseDuration(){return 0}getPackedSteps(){return this._steps}addUser(e){this.userIds.add(e)}removeUser(e){this.userIds.delete(e)}get isCrossAccountScenario(){return!!this.crossAccountScenarioOptions.enabled&&!!this.userIds.size}finalizeScenarioData(e,t){const n=t;return n.elapsedSinceCoreInit=this.calculateElapsedSinceCoreInit(e),n}getBaseScenarioTimingData(e,t){return{delta:"number"==typeof t.delta?t.delta:this.calculateDelta(e),elapsed:"number"==typeof t.elapsed?t.elapsed:this.calculateElapsed(e),stepDelta:"number"==typeof t.stepDelta?t.stepDelta:this.calculateStepDelta(e)}}getBaseTimestamp(e,t){return(null!=e?e:Date.now())+(null!=t?t:0)}calculateElapsedSinceCoreInit(e){return this.timingData.coreInitTime?e-this.timingData.coreInitTime:void 0}calculateDelta(e){return e-this.startTime}calculateElapsed(e){return e-this.timingData.scenarioFactoryStartTime}calculateStepDelta(e){return e-this.intervalTimestamp}prepareAndStorePackedSteps(e){const t={"Scenario.Status":e["Scenario.Status"],"Scenario.Step":e["Scenario.Step"],delta:e.delta,elapsed:e.elapsed,sequence:e.sequence,stepDelta:e.stepDelta,previousStep:e.previousStep};this._steps.push(t)}updateScenarioStatePostMark(e,t){this.intervalTimestamp=t,this.previousStep=e,this.sequence++}}const iE=e=>e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.name]:t.value})),{});class aE{constructor(e,t,n,i,a={},o=""){this.timingData=e,this.logger=t,this.factoryFunctions=n,this.finalizeLegacyCrossClient=i,this.telemetryModeLookUp=a,this.userContextId=o,this.scenarioCreated$=new Te.xQ,this.scenarioStopped$=new we.y,this.scenarioMarked$=new we.y,this.appendEventData$=new we.y}loadCallbacks(e){if(e.marks){const{registerForScenarioStop:t,registerForScenarioMark:n,registerForScenarioStart:i}=e.marks;this.scenarioMarked$=new we.y((e=>{n(((t,n,i)=>{const a={step:n,status:i,scenarioName:t.scenarioName,eventData:iE(t.eventData),clientId:t.clientId};e.next(a)}))})),this.scenarioStopped$=new we.y((e=>{t(((t,n)=>{const i={step:"stop",status:n,scenarioName:t.scenarioName,eventData:iE(t.eventData),clientId:t.clientId};e.next(i)}))})),i(((e,t)=>this.onReceivedScenarioStart(e,t)))}if(e.appendEventData){const{appendEventData:t}=e;this.appendEventData$=new we.y((e=>{t((t=>e.next({scenarioName:t.scenarioName,clientId:t.clientId,eventData:iE(t.eventData)})))}))}}loadExistingScenarios(e){e.forEach((e=>this.OnExistingScenario(e)))}onReceivedScenarioStart(e,t){var n,i;const a=this.factoryFunctions.findScenarioByNameAndId(e.scenarioName,e.clientId);if(a)this.logger.debug(`Creating mark observable for existing scenario: name=${e.scenarioName}, clientid=${e.clientId}`),a.appendEventData({"Scenario.CrossClientMode":"existing"}),null===(n=a.setCrossClientObservables)||void 0===n||n.call(a,this.createObservablesForScenario(e.scenarioName,e.clientId));else{const n=this.factoryFunctions.findScenario(e.scenarioName);n?(this.logger.debug(`Creating mark observable for existing scenario (by name): name=${e.scenarioName}, clientid=${e.clientId}`),n.appendEventData({"Scenario.CrossClientMode":"existing"}),null===(i=n.setCrossClientObservables)||void 0===i||i.call(n,this.createObservablesForScenario(e.scenarioName,e.clientId))):this.onStartScenario(e,t)}}onStartScenario(e,t){var n;const i=e.scenarioName,a=t.time.getTime(),o=iE(e.eventData),r=this.createNewCrossClient(i,e.clientId,o,a,e.timeout,(0,Je.v4)(),null!==(n=this.telemetryModeLookUp[i])&&void 0!==n?n:ee.t7.Expanded);r.appendEventData({"Scenario.CrossClientMode":"pure"}),r.addOnStopCallback((()=>{this.factoryFunctions.clearScenario(r)})),r.setCrossClientObservables(this.createObservablesForScenario(r.name,r.clientId)),this.scenarioCreated$.next(r)}OnExistingScenario(e){var t,n,i,a,o,r;const s=null!==(t=e.clientId)&&void 0!==t?t:"",l=iE(null!==(n=e.eventData)&&void 0!==n?n:[]),d=this.createNewCrossClient(e.name,s,l,e.creationTime.time.getTime(),null!==(i=e.timeout)&&void 0!==i?i:XN,e.id,null!==(a=e.scenarioMode)&&void 0!==a?a:ee.t7.Expanded);d.addPackedData(null!==(o=e.steps)&&void 0!==o?o:[],null!==(r=e.stepsEx)&&void 0!==r?r:[]),d.appendEventData({"Scenario.CrossClientMode":"transferred"}),d.addOnStopCallback((()=>{this.factoryFunctions.clearScenario(d)}));const c=this.finalizeLegacyCrossClient;if(c&&d.addOnStopCallback((()=>{c({scenarioName:d.name})})),d.setCrossClientObservables(this.createObservablesForScenario(d.name,d.clientId)),e.lastMarkStep){const t={previousStep:e.lastMarkStep,lastTimestamp:e.lastMarkTime.time.getTime(),lastSequence:e.sequence};d.syncToState(t)}this.scenarioCreated$.next(d),this.logger.debug(`Created scenario from previous client: name=${e.name}, clientid=${s}`)}createObservablesForScenario(e,t){const n=this.scenarioStopped$.pipe((0,S.h)((n=>n.scenarioName===e&&n.clientId===t)),(0,eE.q)(1));return{mark:this.scenarioMarked$.pipe((0,S.h)((n=>n.scenarioName===e&&n.clientId===t)),(0,S.h)((e=>-1===["stop","start"].indexOf(e.step))),(0,_n.R)(n)),stop:n,appendEventData:this.appendEventData$.pipe((0,S.h)((n=>n.scenarioName===e&&n.clientId===t)),(0,_n.R)(n))}}createNewCrossClient(e,t,n,i,a,o,r){return new nE(e,t,n,this.timingData,i,a,o,r,this.userContextId)}}class oE{constructor(e){this._name=e}get id(){return"noop"}get name(){return this._name}get delta(){return 0}get timeoutMs(){return 0}get eventData(){return{}}set eventData(e){}get timestamps(){return[]}get isPaused(){return!1}set isHoisted(e){}get isHoisted(){return!1}appendEventData(e){}pause(e){}resume(e){}cancel(e){}mark(e,t,n){}startStep(e){}stop(e,t){}fail(e){}incomplete(e){}markAggregateStart(e){}markAggregateStop(e){}getTotalPauseDuration(){return 0}setCrossClientMarkObservables(e){}setCoreInitTime(e){}addUser(e){}removeUser(e){}}const rE="Scenario.Step",sE="Scenario.Name";class lE{constructor(e,t,n,i,a,o,r,s,l,d=!1,c=!1,u=ee.t7.Expanded,m=0,g,p,h,v,S="",f={}){var y,k,C;this._id=e,this._name=t,this.scenarioFactory=a,this.logger=o,this.timeout=r,this.callback=s,this.memoryAnalyzer=l,this.markStepsInTrace=d,this.showAllConsoleLogs=c,this.scenarioMode=u,this._sequence=m,this.reportActivity=g,this.hostCommunicationService=p,this.crossClientOptions=h,this.clientId=v,this.userContextId=S,this.crossAccountScenarioOptions=f,this.steps=[],this.stepsEx=[],this.__stepsPerfInfo__=[],this.performanceMarksToCleanup=[],this.userIds=new Set,this.getTotalPauseDuration=()=>this.pauseInfo.totalTime,this._currentStep=ee.ck.Unknown,this._previousStep=ee.ck.Unknown,this._timestamps=[],this._isHoisted=!1,this.active=!0,this.pauseInfo={reason:"",startTime:0,totalTime:0,eventData:void 0,monitoringData:void 0};let b=0;const{overrideTimestamp:T,offsetCurrentTimeInMs:w}=i;T?b=T-Date.now():w&&(b=-w),this._eventData=n,this._absoluteStartTime=Date.now()+b,this.intervalTimestamp=this.relativeTimestamp=this.scenarioFactory.timestamp({isCrossClient:null===(y=this.crossClientOptions)||void 0===y?void 0:y.enabled})+b,this.memoryDataInitial=null===(k=this.memoryAnalyzer)||void 0===k?void 0:k.snapshotMemoryUsage(),(null===(C=this.crossClientOptions)||void 0===C?void 0:C.enabled)&&this.syncStateToCrossClientStart(this.crossClientOptions)}get id(){return this._id}get name(){return this._name}get absoluteStartTime(){return this._absoluteStartTime}get delta(){return this.scenarioFactory.timestamp()-this.relativeTimestamp}get timeoutMs(){return this.timeout}set timeoutMs(e){this.timeout=e}get eventData(){return this._eventData}set eventData(e){this._eventData=e}get timestamps(){return this._timestamps}get currentStep(){return this._currentStep}get isPaused(){return!!this.pauseInfo.startTime}set isHoisted(e){this._isHoisted=e}get isHoisted(){return this._isHoisted}appendEventData(e){this.eventData=Object.assign(Object.assign({},this.eventData),e)}markAggregateStart(e){this.active?this.isPaused?this.logger.debug(`[Scenario]${this.name} - ignoring aggregated start step [${e}] due to paused state`):(this.aggregateStepStartTime||(this.aggregateStepStartTime={}),this.aggregateStepStartTime[e]||(this.aggregateStepStartTime[e]=performance.now())):this.logger.debug(`[Scenario]${this.name} - ignoring aggregated start step [${e}] due to inactive`)}markAggregateStop(e){this.active&&this.aggregateStepStartTime[e]&&(this.aggregateStepTotalTime||(this.aggregateStepTotalTime={}),this.aggregateStepTotalTime[e]||(this.aggregateStepTotalTime[e]=0),this.aggregateStepTotalTime[e]+=performance.now()-this.aggregateStepStartTime[e],this.aggregateStepStartTime[e]=void 0)}pause(e,t){if(!this.active||this.isPaused)return;this._currentStep!==ee.ck.Unknown&&this.mark(this._currentStep);const{reason:n}=e,i=(0,c._T)(e,["reason"]);this.startStep(ee.ck.Pause),this.pauseInfo=Object.assign(Object.assign({},this.pauseInfo),{reason:n,startTime:Date.now(),eventData:i,monitoringData:t})}resume(e,t){if(!this.active||!this.isPaused)return;const n=this.pauseInfo.startTime?Date.now()-this.pauseInfo.startTime:0;this.pauseInfo.totalTime=(this.pauseInfo.totalTime||0)+n,this.mark(ee.ck.Pause,Object.assign(Object.assign({pauseReason:this.pauseInfo.reason},e),this.pauseInfo.eventData),void 0,t||this.pauseInfo.monitoringData),this._currentStep=ee.ck.Unknown,this.pauseInfo.reason="",this.pauseInfo.startTime=0}stop(e,t="success",n){this._currentStep!==ee.ck.Unknown&&this.mark(this._currentStep,void 0,t,n),this.aggregateStepTotalTime&&((0,Z.each)(Object.keys(this.aggregateStepTotalTime),(e=>{const t=parseInt(this.aggregateStepTotalTime[e].toString(),10);this.mark(e,{stepDelta:t},void 0,n)})),this.aggregateStepTotalTime=null,this.aggregateStepStartTime=null),this.createMark(ee.ck.Stop,t,!0,e,n).then((()=>{var e;if(this.active&&(this.active=!1),this.markSubscription&&!this.markSubscription.closed&&this.markSubscription.unsubscribe(),this.stopSubscription&&!this.stopSubscription.closed&&this.stopSubscription.unsubscribe(),this.callback&&(this.callback(t),this.callback=void 0),this.hostCommunicationService&&(null===(e=this.crossClientOptions)||void 0===e?void 0:e.enabled)){const e={scenarioName:this.name};this.hostCommunicationService.loadModule("scenario").then((t=>{t&&t.setScenarioCompletion&&t.setScenarioCompletion(e)}))}this.scenarioFactory.clearScenario(this)}))}updateTimestamp(e,t){"coreInitTime"===e&&(this.coreInitTimestamp=t)}fail(e,t){this.stop(e,"failure",t)}cancel(e,t){this.stop(e,"abandoned",t)}incomplete(e,t){this.stop(e,"incomplete",t)}mark(e,t,n="success",i){var a;this.isPaused&&e!==ee.ck.Pause?this.logger.debug(`[Scenario]${this.name} - ignoring mark step [${e}] due to paused state`):(this.createMark(e,n,!1,t,i),this._currentStep=ee.ck.Unknown,(null===(a=this.crossClientOptions)||void 0===a?void 0:a.enabled)&&this.crossClientOptions.previousStep&&e===ee.ck.Start&&(this._previousStep=this.crossClientOptions.previousStep))}startStep(e){this.isPaused?this.logger.debug(`[Scenario]${this.name} - ignoring start step [${e}] due to paused state`):(this._currentStep!==ee.ck.Unknown&&e!==this._currentStep&&this.mark(this._currentStep),this._currentStep=e)}setCrossClientObservables(e){this.markSubscription=e.mark.subscribe((e=>this.mark(e.step,e.eventData,e.status))),this.stopSubscription=e.stop.subscribe((e=>{this.stop(e.eventData,e.status)}))}addUser(e){this.userIds.add(e)}removeUser(e){this.userIds.delete(e)}prepareAndSendTelemetry(e,t,n){this.eventData&&this.eventData!==e&&(e=Object.assign(Object.assign({},this.eventData),e)),e.InstanceId=this.id,this.computeScenarioData(e,t);const i=!!this.scenarioFactory.findScenario(ee.RG.WindowLaunchTime);e=Object.assign(Object.assign({},e),{isInEst:i});const a=t[rE];if(a!==ee.ck.Start){let i;this.scenarioMode!==ee.t7.Expanded&&(this.prepareAndStorePackedSteps(t),a===ee.ck.Stop&&(t["Scenario.Steps"]=JSON.stringify(this.steps),i={columnName:"Scenario.StepsEx",packedData:this.stepsEx})),this.sendScenario(e,t,a,i,n)}this.logScenarioPerf(t)}syncStateToCrossClientStart(e){if(e.existingEventData){const t=e.existingEventData.reduce(((e,t)=>Object.assign({[t.name]:t.value},e)),{});this.appendEventData(t)}e.previousStep&&(this._previousStep=e.previousStep),this.intervalTimestamp=this.relativeTimestamp+e.previousStepTimestamp-this._absoluteStartTime,this.active=!0}sendScenario(e,t,n,i,a){if(this.scenarioMode!==ee.t7.Packed||n===ee.ck.Stop){const o=()=>{if(!this.isCrossAccountScenario)return(0,le.Yx)(this.name,e,t,a,i,this.userContextId);for(const n of this.userIds)(0,le.Yx)(this.name,e,t,a,i,n)};n!==ee.ck.Stop?o():Promise.all([this.updateEventDataMemory(e)]).then((()=>{o()})).catch((()=>{o()}))}}get isCrossAccountScenario(){return!!this.crossAccountScenarioOptions.enabled&&!!this.userIds.size}prepareAndStorePackedSteps(e){const t={"Scenario.Status":e["Scenario.Status"],"Scenario.Step":e["Scenario.Step"],delta:e.delta,elapsed:e.elapsed,sequence:e.sequence,stepDelta:e.stepDelta,previousStep:e.previousStep};this.steps.push(t)}logScenarioPerf(e){if(this.showAllConsoleLogs){const t=e[rE],n=t===ee.ck.Start?`[step](${this._sequence})${t}`:t===ee.ck.Stop?`[step](${this._sequence})${t} (${e.stepDelta}ms/${e.delta}ms)`:`[step](${this._sequence})${t} (${e.stepDelta}ms)`;this.logger&&this.logger.log(`[Scenario]${this.name} ${n}`),this.__stepsPerfInfo__.push({name:t,stepDelta:e.stepDelta,delta:e.delta,status:e["Scenario.Status"]})}}updateEventDataMemory(e){return this.memoryAnalyzer?this.memoryAnalyzer.snapshotMemoryUsageAsync().then((t=>{var n,i,a;t&&(t.jsHeapStatistics&&(e.jsUsedHeapSize=t.jsHeapStatistics.used_heap_size,e.jsUsedHeapSizeDelta=(null===(n=this.memoryDataInitial)||void 0===n?void 0:n.jsHeapStatistics)?this.memoryDataInitial.jsHeapStatistics.used_heap_size-t.jsHeapStatistics.used_heap_size:void 0),t.processMemoryInfo&&(e.workingSet=t.processMemoryInfo.workingSetSize,e.workingSetDelta=(null===(i=this.memoryDataInitial)||void 0===i?void 0:i.processMemoryInfo)?t.processMemoryInfo.workingSetSize-this.memoryDataInitial.processMemoryInfo.workingSetSize:void 0,e.privateBytes=t.processMemoryInfo.privateBytes,e.privateBytesDelta=(null===(a=this.memoryDataInitial)||void 0===a?void 0:a.processMemoryInfo)?t.processMemoryInfo.privateBytes-this.memoryDataInitial.processMemoryInfo.privateBytes:void 0))})):Promise.resolve()}computeScenarioData(e,t){var n,i;const{overrideTimestamp:a,offsetCurrentTimeInMs:o}=e,r=this.intervalTimestamp;let s;(0,Z.isNumber)(a)?(s=this.relativeTimestamp+a-this._absoluteStartTime,e.overrideTimestamp=void 0):o?(s=this.scenarioFactory.timestamp({isCrossClient:null===(n=this.crossClientOptions)||void 0===n?void 0:n.enabled})-o,e.offsetCurrentTimeInMs=void 0):s=t[rE]===ee.ck.Start?this.relativeTimestamp:this.scenarioFactory.timestamp({isCrossClient:null===(i=this.crossClientOptions)||void 0===i?void 0:i.enabled}),this._timestamps.push(s),this.intervalTimestamp=s;const l=(0,Z.isNumber)(e.stepDelta)?e.stepDelta:s-r,d=(0,Z.isNumber)(e.delta)?e.delta:s-this.relativeTimestamp-this.getTotalPauseDuration(),c=(0,Z.isNumber)(e.elapsed)?e.elapsed:s,u=this._sequence,m="number"==typeof this.coreInitTimestamp?Date.now()-this.coreInitTimestamp:void 0;t.elapsedSinceCoreInit=m,t.delta=d,t.elapsed=c,t.sequence=u,t.stepDelta=l}getMonitoringDataOverride(e){let t=e;return this.name!==ee.RG.WindowLaunchTime&&this.name!==ee.RG.ExperienceReady||(t=e?(0,Z.cloneDeep)(e):{scenarioPriority:"P0",data:[]},t.data.push({key:"App",value:this.eventData.contentSlotApp})),t}createMark(e,t,n,i={},a){var o;return(0,c.mG)(this,void 0,void 0,(function*(){if(!e||!this.active)return;e!==ee.ck.Start&&this.scenarioMode!==ee.t7.Expanded&&this.stepsEx.push((0,Z.cloneDeep)(Object.assign(Object.assign({},this.eventData),i))||{});const r={"Scenario.Status":t,"Scenario.Mode":this.scenarioMode,[sE]:this.name,[rE]:e};e===ee.ck.Stop&&(r.previousStep=this._previousStep);const s=this.getMonitoringDataOverride(a);this.markPerformanceApi(r),this.prepareAndSendTelemetry(null!==(o=i)&&void 0!==o?o:{},r,s),this.active=this.active&&!n,this.reportActivity&&this.reportActivity(r),this._previousStep=e,this._sequence+=1}))}markPerformanceApi(e){if(performance&&performance.mark&&performance.measure&&!ZN.hasOwnProperty(this.name)){const t=`${e[rE]} ${e[sE]}-${this.id}`;if(performance.mark(t),this.performanceMarksToCleanup.push(t),this.markStepsInTrace){if(this.previousMark){const t=`${e[sE]} [${this.previousMark} <=> ${e[rE]}]`,n=`${this.previousMark} ${e[sE]}-${this.id}`,i=`${e[rE]} ${e[sE]}-${this.id}`;performance.measure(t,n,i),performance.clearMeasures(t)}this.previousMark=e[rE]}if(e[rE]===ee.ck.Stop){let n=`start ${e[sE]}-${this.id}`;0===(performance.getEntriesByName(n,"mark")||[]).length&&(n="navigationStart");const i=this.clientName?` (${this.clientName})`:"",a=this.eventData.reason?`-(${this.eventData.reason})`:"",o=`${e[sE]}${i}${a}`;performance.measure(o,n,t),performance.clearMeasures(o);for(const e of this.performanceMarksToCleanup)performance.clearMarks(e);this.performanceMarksToCleanup=[]}}}}const dE="scenarioBuffer";class cE{constructor(e,t,n,i,a,o,r=!1,s,l,d,c={},u=""){var m,g,p,h,v,S,f,y;this.context=e,this.memoryAnalyzer=n,this.windowId=i,this.clientId=a,this.payload=s,this.finalizeLegacyCrossClient=d,this.eventContextData=c,this.userContextId=u,this.crossClientScenarioList=new Set,this.allowedScenarios=new Set,this.scenarioTimeoutMs=XN,this.telemetryModeLookUp={},this.__isTestingMode__=!1,this.__testingBuffer__=[],this.newScenario=(e,t)=>{if(this.isCrossClientScenarioEnabled(e)){let n;if((null==t?void 0:t.clientId)&&(n=this.findScenarioByNameAndId(e,t.clientId)),n||(n=this.findScenario(e)),n)return n.appendEventData({"Scenario.CrossClientMode":"transferred"}),n}const n=this.createScenarioWithoutStarting(e,t);return n.mark(ee.ck.Start,t&&{overrideTimestamp:t.overrideTimestamp},void 0,t&&t.monitoringData),n},this.createScenarioWithoutStarting=(e,t={})=>{var n;if(0===this.factoryTimestamps.scenarioFactoryStartTime||!this.isAllowedScenario(e))return new oE(e);const i=void 0===t.captureMemoryUsage||t.captureMemoryUsage,{userObjectId:a,correlationId:o,commandSource:r,tenantId:s}=this.getContextData(),l=(0,Z.cloneDeep)(this.eventContextData);l["Panel.WindowID"]=this.windowId,l["UserInfo.Id"]=a,l["UserInfo.TenantId"]=s,l["EventInfo.CorrelationId"]=o,l.commandSource=r;const d=t.scenarioId||(0,Je.v4)(),{showAllConsoleLogs:c}=this.context.coreSettings.get(A.J.Telemetry),u=this.context.coreSettings.get(A.J.Host).showScenarioStepsInPerfTrace||this.context.coreSettings.get(A.J.Core).showScenarioStepsInPerfTrace,m=this.telemetryModeLookUp?this.telemetryModeLookUp[e]||(this.telemetryModeLookUp["*"]?this.telemetryModeLookUp["*"]:ee.t7.Expanded):ee.t7.Expanded,g=new lE(d,e,l,{overrideTimestamp:t.startTime},this,this.logger,t.timeoutMs||this.scenarioTimeoutMs,t.callback,i?this.memoryAnalyzer:void 0,!!u,!!c,m,t.sequence||0,this.reportActivity,this.context.hostCommunicationService,t.crossClientOptions,void 0,this.userContextId,this.crossAccountScenarioOptions);e===ee.RG.NavigationCommand?g.clientId=null!==(n=t.clientId)&&void 0!==n?n:this.clientId:g.clientId=t.clientId,this.factoryTimestamps.coreInitTime&&g.updateTimestamp("coreInitTime",this.factoryTimestamps.coreInitTime);const p=this.setupScenarioTimeout(g);return this.getActiveScenarios(g.name).push({scenario:g,timeoutId:p}),g},this.cancelExistingAndCreateScenario=(e,t,n,i,a,o)=>{let r=this.findScenario(e);if(r){const e=[{reason:t}];r.cancel({errors:JSON.stringify(e)})}return r=this.newScenario(e,Object.assign(Object.assign({},o),{timeoutMs:n,callback:i,monitoringData:a})),r},this.stopScenarioIfActive=(e,t,n,i)=>{const a=this.findScenario(e);a&&a.stop(t,n,i)},this.markStep=(e,t,n)=>{const i=this.findScenario(e);i&&i.mark(t,n&&n.eventData,n&&n.status,n&&n.monitoringData)},this.startStep=(e,t)=>{const n=this.findScenario(e);n&&n.startStep(t)},this.findScenario=e=>{var t;if(!e)return null;const n=this.activeScenariosMap.get(e);let i=null;n&&(i=(null===(t=(0,Z.find)(n,(t=>t&&t.scenario.name===e||t.scenario.clientId===e)))||void 0===t?void 0:t.scenario)||null);const{parentScenarioFactory:a}=this.context;return null==i&&a&&a!==this&&(i=a.findScenario(e)),i},this.findScenarioByNameAndId=(e,t)=>{const n=this.activeScenariosMap.get(e);let i=null,a=null;n&&(i=(0,Z.find)(n,(n=>n.scenario.name===e&&n.scenario.clientId===t))||null);const{parentScenarioFactory:o}=this.context;return null==i&&o&&o!==this&&(a=o.findScenarioByNameAndId(e,t)),i&&i.scenario||a},this.clearScenario=e=>{const t=this.activeScenariosMap.get(e.name);if(t){const n=(0,Z.findIndex)(t,(t=>t.scenario===e));if(n>-1){this.__saveForTestingMode__(e,this.context.coreSettings.get(A.J.Test));const i=t.splice(n,1)[0];0===t.length&&this.activeScenariosMap.delete(i.scenario.name),this.context.windowProvider.clearTimeout(i.timeoutId)}}const{parentScenarioFactory:n}=this.context;e.isHoisted&&n&&this!==n&&(n.clearScenario(e),e.isHoisted=!1)},this.setContext=e=>{this.eventContextData=Object.assign(Object.assign({},this.eventContextData),e),this.activeScenariosMap.forEach((t=>{t.forEach((t=>t.scenario.appendEventData(e)))}))},this.hoistScenarioToCore=e=>{const{parentScenarioFactory:t}=this.context;if(t&&t!==this)t.hoistScenarioToCore&&t.hoistScenarioToCore(e);else if(!e.isHoisted){this.getActiveScenarios(e.name).push({scenario:e,timeoutId:0}),e.isHoisted=!0}},this.findAllScenariosByName=e=>this.getActiveScenarios(e).map((e=>e.scenario)),this.changeTimeout=(e,t)=>{var n;const i=null===(n=this.activeScenariosMap.get(e.name))||void 0===n?void 0:n.find((t=>t.scenario.name===e.name&&t.scenario.id===e.id));i&&(i.scenario.timeoutMs=t,this.context.windowProvider.clearTimeout(i.timeoutId),i.timeoutId=this.setupScenarioTimeout(i.scenario))},this.setupScenarioTimeout=(e,t)=>{const n=e.timeoutMs;return this.context.windowProvider.setTimeout((()=>{const n=this.context.coreSettings.get(A.J.Telemetry)||{},{scenariosNotToTimeoutIfPaused:i}=n;e.isPaused&&(null==i?void 0:i.includes(e.name))||e.stop(void 0,"timeout",t)}),n)},this.getContextData=()=>{var e,t,n,i;return{userObjectId:this.environment===bt.s.life?null===(e=this.context.authenticationUser)||void 0===e?void 0:e.profile.paddedMsaId:null===(t=this.context.authenticationUser)||void 0===t?void 0:t.profile.objectId,tenantId:null===(i=null===(n=this.context.authenticationUser)||void 0===n?void 0:n.profile)||void 0===i?void 0:i.tenantId,correlationId:this.context.correlation.id,commandSource:this.context.correlation.source}},this.getActiveScenarios=e=>{let t=this.activeScenariosMap.get(e);return t||(t=[],this.activeScenariosMap.set(e,t)),t},this.reportActivity=e=>{var t;const n=e["Scenario.Name"];n&&this.isWhitelistedActivity(n)&&(null===(t=this.context.windowProvider.opener)||void 0===t||t.postMessage(K.rY.ActivityEvent,{action:"er:rendererActivityEvents",data:{activityEvents:[{sourceId:this.windowId,events:[`${n}:${e["Scenario.Step"]}`]}]}}))},this.isWhitelistedActivity=e=>{switch(e){case ee.RG.WindowLaunchTime:case ee.RG.ChatSendMessage:case ee.RG.CentralDataLayerRequest:case ee.RG.UnhandledRejection:case ee.RG.FatalError:case ee.RG.GlobalWindowError:return!0;default:return!1}},this.isAllowedScenario=e=>!this.coreAllowListEnabled||this.allowedScenarios.has(e),this.isCrossClientScenarioEnabled=e=>this.clientType===Fo.Bh.Maglev&&this.crossClientScenarioList.has(e)&&void 0!==this.context.hostCommunicationService,this.initializeCrossClientScenarios=(e,t)=>{var n,i;const a=null!==(n=e.scenarios)&&void 0!==n?n:[],o=null!==(i=e.crossClientScenarioList)&&void 0!==i?i:[],r=this.context.loggerFactory.newLogger("CrossClientCoordinator");o.forEach((e=>{this.crossClientScenarioList.add(e)}));const s={scenarioFactoryStartTime:e.scenarioFactoryStartTime.time.getTime(),coreInitTime:this.factoryTimestamps.coreInitTime};this.crossClientCoordinator=new aE(s,r,this,this.finalizeLegacyCrossClient,this.telemetryModeLookUp,this.userContextId),this.crossClientCoordinator.scenarioCreated$.subscribe((e=>{this.onScenarioFromCoordinator(e)})),t&&(this.crossClientCoordinator.loadCallbacks(t),this.logger.debug("Cross client initializing with callbacks")),this.crossClientCoordinator.loadExistingScenarios(a),this.logger.debug("Cross client coordinator initialized")},this.getTimestamp=e=>{const t=Date.now();return(null==e?void 0:e.isCrossClient)&&this.factoryTimestamps.desktopFactoryStartTime?t-this.factoryTimestamps.desktopFactoryStartTime:(null==e?void 0:e.isFromCoreInit)&&this.factoryTimestamps.coreInitTime?t-this.factoryTimestamps.coreInitTime:t-this.factoryTimestamps.scenarioFactoryStartTime},this.setUpHostListeners=()=>{this.context.windowProvider.addEventListener&&this.context.windowProvider.addEventListener("beforeunload",(()=>{this.incompleteRunningScenarios()}))},this.factoryTimestamps={scenarioFactoryStartTime:t,desktopFactoryStartTime:null===(m=this.payload)||void 0===m?void 0:m.scenarioFactoryStartTime.time.getTime(),coreInitTime:o},this.activeScenariosMap=new Map,this.environment=this.context.coreSettings.get(A.J.Metadata).environment,this.coreAllowListEnabled=null!==(g=this.context.coreSettings.get(A.J.Telemetry).coreAllowListEnabled)&&void 0!==g&&g,this.allowedScenarios=new Set(null!==(p=this.context.coreSettings.get(A.J.Telemetry).coreAllowList)&&void 0!==p?p:[]),this.scenarioIncompleteOnShutdown=null!==(h=this.context.coreSettings.get(A.J.Telemetry).scenarioIncompleteOnShutdown)&&void 0!==h&&h,this.scenarioIncompleteOnShutdownBlockList=null!==(v=this.context.coreSettings.get(A.J.Telemetry).scenarioIncompleteOnShutdownBlockList)&&void 0!==v?v:[],this.clientType=null===(f=null===(S=e.platformService)||void 0===S?void 0:S.config)||void 0===f?void 0:f.clientType,this.telemetryModeSubscription=this.context.coreSettings.getObservable(A.J.Telemetry).subscribe((e=>this.onReceiveTelemetrySettings(e)));const k=this.context.coreSettings.get(A.J.Telemetry);this.crossAccountScenarioOptions={enabled:null!==(y=k.enableCrossAccountScenario)&&void 0!==y&&y},this.__initTestingMode__(this.context.coreSettings.get(A.J.Host)),this.timestamp=this.getTimestamp;const C=i?`ScenarioFactory-${i}`:"ScenarioFactory";this.logger=this.context.loggerFactory.newLogger(C),this.context.windowProvider&&this.setUpHostListeners(),this.payload&&this.initializeCrossClientScenarios(this.payload,l),this.startWindowLaunchTimeScenario(r,t),this.logger.debug("Initialized ScenarioFactory")}incompleteRunningScenarios(){this.scenarioIncompleteOnShutdown&&this.activeScenariosMap.forEach((e=>{e.forEach((e=>{this.scenarioIncompleteOnShutdownBlockList.includes(e.scenario.name)||(e.scenario.incomplete({reason:"shutdown"}),clearTimeout(e.timeoutId))}))}))}destroy(){this.telemetryModeSubscription.unsubscribe(),this.incompleteRunningScenarios()}setCoreInitTime(e){this.factoryTimestamps.coreInitTime=e,this.activeScenariosMap.forEach((t=>{t.forEach((t=>{var n,i;return null===(i=(n=t.scenario).updateTimestamp)||void 0===i?void 0:i.call(n,"coreInitTime",e)}))}))}doesScenariosExist(e){const t=[];for(const n of e){const e=this.activeScenariosMap.get(n);(null==e?void 0:e.length)&&t.push(n)}return t}startWindowLaunchTimeScenario(e,t){var n;if(e){const e=this.newScenario(ee.RG.WindowLaunchTime,{startTime:t,timeoutMs:6e4});e.appendEventData({workerEnabled:Oc(this.context.coreSettings)}),null===(n=this.hoistScenarioToCore)||void 0===n||n.call(this,e)}}__initTestingMode__(e){if(e){const t=e.userType;t&&t.indexOf("test")>-1&&(this.__isTestingMode__=!0,dE in window?this.__testingBuffer__=window.scenarioBuffer:this.__testingBuffer__=window.scenarioBuffer=[])}}__saveForTestingMode__(e,t){this.__isTestingMode__&&this.__testingBuffer__&&(t&&t.scenarioBufferList&&t.scenarioBufferList.length>0?t.scenarioBufferList.indexOf(e.name)>-1&&this.__pushScenarioBuffer__(e):this.__pushScenarioBuffer__(e))}__pushScenarioBuffer__(e){e.isHoisted&&this.__testingBuffer__.length>0&&this.__testingBuffer__[this.__testingBuffer__.length-1].id===e.id||(this.__testingBuffer__.push(e),this.__testingBuffer__.length>100&&this.__testingBuffer__.shift())}onReceiveTelemetrySettings(e){var t;this.telemetryModeLookUp=e.scenarioModes,this.coreAllowListEnabled=Boolean(e.coreAllowListEnabled),this.allowedScenarios=new Set(null!==(t=e.coreAllowList)&&void 0!==t?t:[])}onScenarioFromCoordinator(e){this.crossClientScenarioList.add(e.name);const{showAllConsoleLogs:t}=this.context.coreSettings.get(A.J.Telemetry);e.testingMode=Boolean(t);const{userObjectId:n,correlationId:i,commandSource:a,tenantId:o}=this.getContextData(),r=(0,Z.cloneDeep)(this.eventContextData);r["Panel.WindowID"]=this.windowId,r["UserInfo.Id"]=n,r["UserInfo.TenantId"]=o,r["EventInfo.CorrelationId"]=i,r.commandSource=a,e.appendEventData(r),this.factoryTimestamps.coreInitTime&&e.updateTimestamp("coreInitTime",this.factoryTimestamps.coreInitTime);const s=this.setupScenarioTimeout(e);this.getActiveScenarios(e.name).push({scenario:e,timeoutId:s})}}var uE,mE,gE=n(15496);!function(e){e[e.Legacy=1]="Legacy",e[e.Store=2]="Store",e[e.InContextGalleryDialogFromChannel=3]="InContextGalleryDialogFromChannel",e[e.InContextGalleryDialogFromGroupChat=4]="InContextGalleryDialogFromGroupChat",e[e.InContextGalleryDialogMoreAppsFromChannel=5]="InContextGalleryDialogMoreAppsFromChannel",e[e.InContextGalleryDialogMoreAppsFromGroupChat=6]="InContextGalleryDialogMoreAppsFromGroupChat",e[e.Flyout=7]="Flyout",e[e.AppsManagementTabView=8]="AppsManagementTabView",e[e.GroupChatAppsManagementView=9]="GroupChatAppsManagementView",e[e.MoreAppFromSamePublisher=10]="MoreAppFromSamePublisher",e[e.MessagingExtensionFlyoutFromChannel=11]="MessagingExtensionFlyoutFromChannel",e[e.MessagingExtensionFlyoutFromChat=12]="MessagingExtensionFlyoutFromChat",e[e.StoreSideload=13]="StoreSideload",e[e.DeepLink=14]="DeepLink",e[e.ConnectorManagementDialog=15]="ConnectorManagementDialog",e[e.AppsManagementTabUpgrade=16]="AppsManagementTabUpgrade",e[e.GroupChatAppsManagementUpgrade=17]="GroupChatAppsManagementUpgrade",e[e.AppsList=18]="AppsList",e[e.TabSdkSideload=19]="TabSdkSideload",e[e.AppsManagementTabFromTeam=20]="AppsManagementTabFromTeam",e[e.AppsManagementTabFromGroupChat=21]="AppsManagementTabFromGroupChat",e[e.AppSuggestionInEmptyChannel=22]="AppSuggestionInEmptyChannel",e[e.MeetingFromGroupchat=23]="MeetingFromGroupchat",e[e.MeetingFromTeam=24]="MeetingFromTeam",e[e.MessagingExtensionFeaturedItem=25]="MessagingExtensionFeaturedItem",e[e.NewMessageUpgrade=26]="NewMessageUpgrade",e[e.AtMentionDirectInstallationFromTeam=27]="AtMentionDirectInstallationFromTeam",e[e.AtMentionDirectInstallationFromGroupChat=28]="AtMentionDirectInstallationFromGroupChat",e[e.PersonalAppBannerUpgrade=29]="PersonalAppBannerUpgrade",e[e.AppBarNew=30]="AppBarNew",e[e.AppsListNew=31]="AppsListNew",e[e.MessagingExtensionFlyoutV2=34]="MessagingExtensionFlyoutV2",e[e.AppsManagementTabFromTeamSideload=35]="AppsManagementTabFromTeamSideload",e[e.AppsManagementTabFromGroupChatSideload=36]="AppsManagementTabFromGroupChatSideload",e[e.PersonalFlyoutAppSearch=37]="PersonalFlyoutAppSearch",e[e.PersonalAppAbout=38]="PersonalAppAbout",e[e.PersonalFlyoutAppSuggestions=39]="PersonalFlyoutAppSuggestions",e[e.ChannelInfoPaneAppWidgetView=40]="ChannelInfoPaneAppWidgetView",e[e.ChannelInfoPaneAppWidgetUpgrade=41]="ChannelInfoPaneAppWidgetUpgrade",e[e.MoreAppsUsedTogether=42]="MoreAppsUsedTogether",e[e.PowerBar=43]="PowerBar",e[e.StageDeepLink=44]="StageDeepLink",e[e.ManageAppsInstalledApp=45]="ManageAppsInstalledApp",e[e.ManageAppsInstalledAppUpgrade=46]="ManageAppsInstalledAppUpgrade",e[e.LobNotifications=47]="LobNotifications",e[e.OnboardingNotifications=48]="OnboardingNotifications",e[e.StoreEditorialArticles=49]="StoreEditorialArticles",e[e.DiscoverAppsNotifications=50]="DiscoverAppsNotifications",e[e.StoreWorkflows=51]="StoreWorkflows",e[e.JITInstallFromPersonalFlyout=52]="JITInstallFromPersonalFlyout",e[e.AutoInstallAppsNotification=53]="AutoInstallAppsNotification",e[e.MessageExtensionFlyout=100]="MessageExtensionFlyout",e[e.Meeting=101]="Meeting",e[e.JITInstallCardAction=102]="JITInstallCardAction",e[e.CardHeaderInstallAction=103]="CardHeaderInstallAction",e[e.ScenePicker=104]="ScenePicker",e[e.MeetingFromChannel=105]="MeetingFromChannel",e[e.Url=106]="Url",e[e.JITInstallConsentOnCard=107]="JITInstallConsentOnCard",e[e.StoreFREDialog=108]="StoreFREDialog",e[e.AdaptiveCard=109]="AdaptiveCard",e[e.MessageExtensionFlyoutSuggestedCollection=110]="MessageExtensionFlyoutSuggestedCollection",e[e.ProactiveMessageForBots=111]="ProactiveMessageForBots",e[e.JITInstallTaskModule=112]="JITInstallTaskModule",e[e.ExposeBotActions=113]="ExposeBotActions",e[e.MessageExtensionCard=114]="MessageExtensionCard",e[e.MeetingFromDeepLink=115]="MeetingFromDeepLink",e[e.UrlPersonalUpgrade=116]="UrlPersonalUpgrade",e[e.MeetingAppsFlyout=117]="MeetingAppsFlyout",e[e.MeetingAppsFlyoutFromChannel=118]="MeetingAppsFlyoutFromChannel",e[e.ReactMessageExtensionFlyoutFromChannel=119]="ReactMessageExtensionFlyoutFromChannel",e[e.ShareFormDialog=120]="ShareFormDialog",e[e.PlatformAppConsentDialog=121]="PlatformAppConsentDialog",e[e.PlatformTabButtonGroupChat=122]="PlatformTabButtonGroupChat",e[e.PlatformTabButtonTeam=123]="PlatformTabButtonTeam",e[e.InContextStorePersonal=150]="InContextStorePersonal",e[e.MEInContextStoreGroupChat=151]="MEInContextStoreGroupChat",e[e.MEInContextStoreTeam=152]="MEInContextStoreTeam",e[e.TabsInContextStoreGroupChat=153]="TabsInContextStoreGroupChat",e[e.TabsInContextStoreTeam=154]="TabsInContextStoreTeam",e[e.BotsInContextStoreGroupChat=155]="BotsInContextStoreGroupChat",e[e.BotsInContextStoreTeam=156]="BotsInContextStoreTeam",e[e.PlatformAppScopeInstall=157]="PlatformAppScopeInstall"}(uE||(uE={})),function(e){e.InContext="InContext",e.Update="Update",e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meeting="Meeting",e.RequestAccess="RequestAccess"}(mE||(mE={}));const pE="reactWebClient",hE="maglev",vE="prod",SE="general";function fE(e,t,n){let i,a,o;if(n){const e=n.expConfigMetadata.find((e=>e.client===pE)),t=n.expConfigMetadata.find((e=>e.client===hE));i=null==e?void 0:e.config.eTag,a=null==t?void 0:t.config.eTag,o=n.expConfigMetadata.map((e=>e.config.expIds)).filter((e=>e.length>0)).join(",")}else i=e.eTag||void 0,a=e.hostETag||void 0,e.configIds&&e.configIds.experiments&&(o=e.configIds.experiments.join(","));const r=function(e,t){var n;const i=e.ring&&e.ring.id||SE;if(t)return i;const a=null===(n=e.region)||void 0===n?void 0:n.toLowerCase(),o="gcc"===a?a:e.environment||vE;switch(o){case vE:return i;case"gcc":return`${i}_gcc`;default:return`${o}-${i}`}}(e,t);return{ring:r,eTag:i,hostETag:a,expIds:o,environment:e.environment||void 0}}class yE{constructor(e){this._top=-1,this._isFilled=!1,this._buffer=new Array(e),this.capacity=e}add(e){this._top=(this._top+1)%this.capacity,this._buffer[this._top]=e,this._top===this.capacity-1&&(this._isFilled=!0)}getItemFromLast(e){if(-1===this._top||e>=this.capacity||!this._isFilled&&this._top-e<0)return;const t=this._top-e>=0?this._top-e:this.capacity- -1*(this._top-e);return this._buffer[t]}}class kE{constructor(e){this.eventMarks=new yE(e&&e>0?e:100)}markEvent(e){this.markEventOverrideTimestamp(e,Date.now())}markEventOverrideTimestamp(e,t){var n;null===(n=this.eventMarks)||void 0===n||n.add({ts:t,name:e})}getEventsBetweenStartAndLast(e){if(!this.eventMarks)return[];const t=[];let n;for(let i=1;n=this.eventMarks.getItemFromLast(i),n&&!(n.ts<e);i++)t.push(n.name);return t}getEventsBetween(e,t){if(!this.eventMarks)return[];const n=[];let i;for(let a=0;i=this.eventMarks.getItemFromLast(a),i&&!(i.ts<e);a++)i.ts<t&&n.push(i.name);return n}}function CE(e){return new kE(e)}var bE;!function(e){e.Action="panelaction",e.View="panelview"}(bE||(bE={}));class TE{constructor(e,t=""){this.contextData=e,this.userContextId=t,this.clickStreamBatchInSeconds=75,this.clickStreamMaxBatchSize=15,this.getBatchNumber=()=>this.userBiCache.batchNumber,this.emptyCacheWithoutRestarting=()=>{this.recordClickStreamEvent({isTimeOut:!1,isBatchSize:!1,disableSetTimeout:!0})},this.addEventToUserBiCache=(e,t)=>{"panelaction"===t?(this.userBiCache.actionCount=this.userBiCache.actionCount+1,e["EventInfo.BaseType"]=bE.Action):(this.userBiCache.viewCount=this.userBiCache.viewCount+1,e["EventInfo.BaseType"]=bE.View),this.userBiCache.events.push(e),this.userBiCache.events.length>=this.clickStreamMaxBatchSize&&this.recordClickStreamEvent({isTimeOut:!1,isBatchSize:!0})},this.cacheClickStreamToLocalStorage=()=>{var e;this.userBiCache.events.length>0&&this.telemetrySettings.enableClickStreamUnloadCache&&(null===(e=this.contextData.localStorage)||void 0===e||e.set("clickstream_cache",JSON.stringify(this.userBiCache)))},this.setUpHostListeners=()=>{this.host.addEventListener("beforeunload",(()=>(0,c.mG)(this,void 0,void 0,(function*(){this.cacheClickStreamToLocalStorage(),this.emptyCacheWithoutRestarting(),yield this.telemetryProvider.flush()}))))},this.localStorageFlush=()=>{var e,t;if(this.telemetrySettings.enableClickStreamUnloadCache){const n=null===(e=this.contextData.localStorage)||void 0===e?void 0:e.get("clickstream_cache"),i=JSON.parse(n);n&&(0,le.P3)(se.x.ClickStream,"clickstream_cached",i,void 0,{columnName:"events",packedData:i.events},void 0,this.userContextId),null===(t=this.contextData.localStorage)||void 0===t||t.remove("clickstream_cache")}},this.setBatchTimeandSize=e=>{e===(Fo.Bh.Desktop||Fo.Bh.Maglev)?(this.clickStreamBatchInSeconds=this.telemetrySettings.clickStreamBatchInSeconds||75,this.clickStreamMaxBatchSize=this.telemetrySettings.clickStreamMaxBatchSize||15):(this.clickStreamBatchInSeconds=this.telemetrySettings.clickStreamBatchInSecondsWeb||30,this.clickStreamMaxBatchSize=this.telemetrySettings.clickStreamMaxBatchSizeWeb||5)},this.setupClickStreamTimeout=()=>this.contextData.windowProvider.setTimeout((()=>{this.recordClickStreamEvent({isTimeOut:!0,isBatchSize:!1})}),1e3*this.clickStreamBatchInSeconds),this.recordClickStreamEvent=e=>{if(this.userBiCache.actionCount>0||this.userBiCache.viewCount>0){this.userBiCache.batchFlushed=e.isBatchSize,this.userBiCache.timeoutFlushed=e.isTimeOut;const t=this.userBiCache;this.telemetrySettings.disable1DSBatching&&(t.latency=4),(0,le.P3)(se.x.ClickStream,"clickstream",t,void 0,{columnName:"events",packedData:t.events},void 0,this.userContextId),this.userBiCache={events:[],batchStartTime:(new Date).toISOString(),viewCount:0,actionCount:0,batchNumber:t.batchNumber+1,batchFlushed:!1,timeoutFlushed:!1}}this.contextData.windowProvider.clearTimeout(this.currentTimeoutId),e.disableSetTimeout||(this.currentTimeoutId=this.setupClickStreamTimeout())},this.userBiCache={events:[],batchStartTime:(new Date).toISOString(),viewCount:0,actionCount:0,batchNumber:1,batchFlushed:!1,timeoutFlushed:!1},this.telemetrySettings=this.contextData.coreSettings.get(A.J.Telemetry);const n=this.contextData.platformService.config.clientType;this.setBatchTimeandSize(n),this.currentTimeoutId=this.setupClickStreamTimeout(),this.host=this.contextData.windowProvider,this.localStorageFlush(),this.host&&this.setUpHostListeners(),this.telemetryProvider=(0,Jn.G)()}}var wE=n(30358);class _E{constructor(e,t){var n,i;if(this.context=e,this.windowId=t,this.biEventObserver=new Te.xQ,this.experimentationEventData={},this.telemetrySettings={},this.panelContextData={},this.dataBagContextData={},this.windowSlotContext={},this.userContextId="",this._dataBags=[],this.recordPanelView=(e,t,n)=>{const i=this.getCombinedDataBagData(n);this.recordBiEvent({eventName:"panelview",data:Object.assign(Object.assign(Object.assign({},this.windowSlotContext),i),NE(e))},t)},this.recordPanelAction=(e,t,n)=>{var i;const a=this.getCombinedContextData(n),o=this.getCombinedDataBagData(n);this.recordBiEvent({eventName:"panelaction",data:Object.assign(Object.assign(Object.assign({},this.windowSlotContext),o),IE(Object.assign(Object.assign({},a),e)))},t),null===(i=this.eventTimeTracker)||void 0===i||i.markEvent(`${e.actionOutcome}-${e.actionScenario}-${e.panelType}-${e.threadType}`)},this.setBISlotContext=e=>{this.windowSlotContext=Object.assign(Object.assign({},this.windowSlotContext),e)},this.createDatabag=()=>{const e=new wE.S;return this._dataBags.push(e),e.setDispose((()=>(0,c.mG)(this,void 0,void 0,(function*(){yield(0,Gl._)(0);const t=this._dataBags.findIndex((t=>t.id===e.id));this._dataBags.splice(t,1)})))),e},this.appendBiData=(e,t)=>{const{dataBag:n}=t,i=(0,c._T)(t,["dataBag"]),a=EE(dr.sz,e);this.dataBagContextData[a]=Object.assign(Object.assign({},this.dataBagContextData[a]),null==n?void 0:n.data),this.panelContextData[a]=Object.assign(Object.assign({},this.panelContextData[a]),i)},this.removeBiData=(e,t)=>{var n,i;const a=EE(dr.sz,e);if(t)for(const e of t)this.dataBagContextData&&(null===(n=this.dataBagContextData[a])||void 0===n||delete n[e]),this.panelContextData&&(null===(i=this.panelContextData[a])||void 0===i||delete i[e]);else delete this.dataBagContextData[a],delete this.panelContextData[a]},this.recordTestOnlyTelemetry=()=>{var e;const t=null===(e=this.context)||void 0===e?void 0:e.coreSettings.get(A.J.Telemetry).testOnlyUserbiTelemetry;t&&this.recordPanelAction(JSON.parse(t))},(null===(n=this.context)||void 0===n?void 0:n.authenticationUser)&&(this.userContextId=this.context.authenticationUser.id),null===(i=this.context)||void 0===i?void 0:i.coreSettings){const{disableRingNamePrefixing:e}=this.context.coreSettings.get(A.J.Telemetry),{enableSmbUserIntentUserBiTelemetry:t}=this.context.coreSettings.get(A.J.Growth),{enableCallingPerfCollectorService:n,enableCallingLongTasksTracking:i,enableCallingLongTasksTriggerFinder:a}=this.context.coreSettings.get(A.J.Calling);this.includeSmbUserIntentData=Boolean(t);const o=this.context.coreSettings.getObservable(A.J.Metadata);this.metadataSubscription=o.subscribe((t=>{var n;this.experimentationEventData=function(e,t,n){const i={},a=fE(e,t,n);return i["UserInfo.Ring"]=a.ring,i["UserInfo.ETag"]=a.eTag,i["UserInfo.HostETag"]=a.hostETag,i["AppInfo.ExpIds"]=a.expIds,i["AppInfo.Environment"]=a.environment,i}(t,!!e,null===(n=this.context)||void 0===n?void 0:n.experimentationService)})),this.environment=this.context.coreSettings.get(A.J.Metadata).environment,this.telemetrySettingsSubscription=this.context.coreSettings.getObservable(A.J.Telemetry).subscribe((e=>this.onReceiveTelemetrySettings(e))),this.clientType=this.context.platformService.config.clientType,this.clientType===Fo.Bh.Maglev&&this.windowId!==_.ew&&this.subscribeToMaglevWindowState(),n&&i&&a&&(this.eventTimeTracker=CE()),this.context.coreSettings.get(A.J.Telemetry).enableTestOnlyTelemetry&&this.recordTestOnlyTelemetry()}}getEventsWithinTimeframe(e,t){var n;return(null===(n=this.eventTimeTracker)||void 0===n?void 0:n.getEventsBetween(e,t))||[]}getWindowId(){return this.windowId}destroy(){var e;this.metadataSubscription&&this.metadataSubscription.unsubscribe(),this.telemetrySettingsSubscription&&this.telemetrySettingsSubscription.unsubscribe(),this.clickStreamService&&this.clickStreamService.emptyCacheWithoutRestarting(),this.windowStateSubcription$&&this.windowStateSubcription$.unsubscribe(),this.unregisterForWindowStateChanged&&this.unregisterForWindowStateChanged(),(null===(e=this.smbUserIntentSubcription)||void 0===e?void 0:e.unsubscribe)&&this.smbUserIntentSubcription.unsubscribe(),this._dataBags.length&&(this._dataBags=[])}initializeAndSubscribeToSmbUserIntent(){var e,t;if(this.environment===bt.s.life&&this.includeSmbUserIntentData&&(null===(e=this.context)||void 0===e?void 0:e.client)){const{smbUserIntentUserBiTelemetryPollInterval:e}=null===(t=this.context)||void 0===t?void 0:t.coreSettings.get(A.J.Growth),i=36e5,a=null!=e?e:i;return(()=>(0,c.mG)(this,void 0,void 0,(function*(){var e,t;const i=yield(0,cd.mT)((()=>n.e(9342).then(n.bind(n,43089))),"services-io-data-smb-user-intent").then((e=>e.smbUserIntentDocument));this.smbUserIntentSubcription=null===(t=null===(e=this.context)||void 0===e?void 0:e.client)||void 0===t?void 0:t.watchQuery({query:i,pollInterval:Number(a),fetchPolicy:"no-cache"}).subscribe((e=>{var t;(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.smbUserIntent)&&(this.smbUserIntent=e.data.smbUserIntent)}))})))(),()=>{var e;"function"==typeof(null===(e=this.smbUserIntentSubcription)||void 0===e?void 0:e.unsubscribe)&&this.smbUserIntentSubcription.unsubscribe()}}}getDataFromBaseInstance(){var e,t,n;return{"UserInfo.SmbUserIntent.Intent":null===(e=this.smbUserIntent)||void 0===e?void 0:e.smbUserIntent,"UserInfo.SmbUserIntent.IntentScore":null===(t=this.smbUserIntent)||void 0===t?void 0:t.smbUserIntentScore,"UserInfo.SmbUserIntent.ConfidenceScore":null===(n=this.smbUserIntent)||void 0===n?void 0:n.smbConfidenceScore}}bubbleUpObservable(e){var t,n,i;this.biEventObserver.next(e),null===(i=null===(n=null===(t=this.context)||void 0===t?void 0:t.parentUserBiService)||void 0===n?void 0:n.bubbleUpObservable)||void 0===i||i.call(n,e)}observe(){return this.biEventObserver.asObservable()}onReceiveTelemetrySettings(e){this.telemetrySettings=e,this.context&&this.telemetrySettings.enableClickStreamEvents&&!this.clickStreamService&&(this.clickStreamService=new TE({coreSettings:this.context.coreSettings,windowProvider:this.context.windowProvider,platformService:this.context.platformService,localStorage:this.context.localStorage},this.userContextId))}recordBiEvent(e,t){this._applyContextData(e),this.includeSmbUserIntentData&&this.applySmbUserIntentData(e);const n=function(e){const t={};return Object.keys(e).forEach((n=>{(0,Z.isNil)(e[n])||(t[n]=e[n])})),t}(e.data),i="EventInfo.Identifier"in e.data?e.data["EventInfo.Identifier"]:void 0;if(this.telemetrySettings.enableClickStreamEvents&&this.clickStreamService){const t=(e.eventName,n);this.telemetrySettings.enableDualClickStreamEvents&&(n.batchNumber=this.clickStreamService.getBatchNumber(),(0,le.P3)(se.x.UserBI,e.eventName,n,void 0,void 0,this.telemetrySettings.enableUserBiEventIdentifiers?i:void 0,this.userContextId)),this.clickStreamService.addEventToUserBiCache(t,e.eventName)}else(0,le.P3)(se.x.UserBI,e.eventName,n,void 0,void 0,this.telemetrySettings.enableUserBiEventIdentifiers?i:void 0,this.userContextId);t&&(t.debug(`Analytics: EventType: ${e.eventName}`),t.debug(`Analytics: Type: ${n["Panel.Type"]}`),t.debug("Analytics: Payload:",n)),this.bubbleUpObservable({eventName:e.eventName,data:n})}_applyContextData(e){var t,n,i,a,o,r,s,l,d,c,u;e.data["Panel.WindowID"]=this.windowId,e.data["EventInfo.CorrelationId"]=null===(n=null===(t=this.context)||void 0===t?void 0:t.correlation)||void 0===n?void 0:n.id;const m=null!==(i=this.windowIsVisible)&&void 0!==i?i:null===(a=this.context)||void 0===a?void 0:a.windowProvider.isFocused();e.data["Window.Focus"]=m?Es.cb.foreground:Es.cb.background;const g=m?Es.Lv.maximized:Es.Lv.minimized;if(e.data["Window.Status"]=g,e.data["Window.Height"]=null===(o=this.context)||void 0===o?void 0:o.windowProvider.innerHeight,e.data["Window.Width"]=null===(r=this.context)||void 0===r?void 0:r.windowProvider.innerWidth,e.data["Window.ViewportContext"]=null===(s=this.context)||void 0===s?void 0:s.windowProvider.viewportContext,null===(l=this.context)||void 0===l?void 0:l.authenticationUser){const t=this.environment===bt.s.life?null===(d=this.context)||void 0===d?void 0:d.authenticationUser.profile.paddedMsaId:null===(c=this.context)||void 0===c?void 0:c.authenticationUser.profile.objectId;e.data["UserInfo.Id"]=t,e.data["UserInfo.TenantId"]=null===(u=this.context)||void 0===u?void 0:u.authenticationUser.profile.tenantId}e.data=Object.assign(Object.assign({},e.data),this.experimentationEventData)}getCombinedContextData(e){let t={};if(e)for(const n of e){const e=EE(dr.sz,n);t=Object.assign(Object.assign({},t),this.panelContextData[e])}return t}getCombinedDataBagData(e){let t={};if(e)for(const n of e){const e=EE(dr.sz,n);t=Object.assign(Object.assign({},t),this.dataBagContextData[e])}return t}subscribeToMaglevWindowState(){return(0,c.mG)(this,void 0,void 0,(function*(){if(!this.windowControlsModule&&this.context){this.windowControlsModule=yield this.context.hostCommunicationService.loadModule("windowcontrols"),this.windowState$=new we.y((e=>{var t;this.windowControlsModule&&this.windowControlsModule.registerForWindowStateChanged&&(this.unregisterForWindowStateChanged=null===(t=this.windowControlsModule)||void 0===t?void 0:t.registerForWindowStateChanged((t=>{if(!t.windowId||this.windowId&&t.windowId===this.windowId){const n=!t.placement.minimized;e.next(n)}})))}));const e=e=>{this.windowIsVisible=e};this.windowStateSubcription$=this.windowState$.subscribe(e)}}))}applySmbUserIntentData(e){var t,n,i,a;const o="function"==typeof(null===(n=null===(t=this.context)||void 0===t?void 0:t.parentUserBiService)||void 0===n?void 0:n.getDataFromBaseInstance)?null===(a=null===(i=this.context)||void 0===i?void 0:i.parentUserBiService)||void 0===a?void 0:a.getDataFromBaseInstance():void 0;o&&(e.data["UserInfo.SmbUserIntent.Intent"]=o["UserInfo.SmbUserIntent.Intent"],e.data["UserInfo.SmbUserIntent.IntentScore"]=o["UserInfo.SmbUserIntent.IntentScore"],e.data["UserInfo.SmbUserIntent.ConfidenceScore"]=o["UserInfo.SmbUserIntent.ConfidenceScore"])}}function IE(e){const{appName:t,actionGesture:n,actionOutcome:i,actionOutcomeNew:a,actionScenario:o,actionScenarioType:r,actionWorkload:s,actionSubworkload:l,actionInputDelay:d,moduleName:c,moduleNameNew:u,moduleType:m,moduleTypeNew:g,extensibilityData:p,tabId:h,tabIdNew:v,tabOrdinal:S,tabType:f,tabTypeNew:y,callId:k,eventIdentifier:C}=e,b=EE(dr.rA,c),T=EE(dr.PO,m),w=EE(dr.uS,n),_=EE(dr.Tk,o),I=(0,Z.isNil)(C)?[b,T,w,_].filter(Boolean).join("_"):EE(dr.b6,C),A=Object.assign(Object.assign({"Action.Gesture":n,"Action.Outcome":i,"Action.OutcomeNew":a,"Action.Scenario":o,"Action.ScenarioType":r,"Action.WorkLoad":s,"Action.SubWorkLoad":l,"Module.Name":c,"Module.Type":m,"Module.NameNew":u,"Module.TypeNew":g,"Tab.Id":h,"Tab.Type":f,"Tab.IdNew":v,"Tab.TypeNew":y,"Tab.Ordinal":S,"App.Name":t,"Call.Id":k},NE(e)),AE(p));return(0,Z.isNil)(I)||(A["EventInfo.Identifier"]=I),(0,Z.isNil)(d)||(A["Action.InputDelay"]=d),A}function AE(e){if(e&&!(0,Z.isEmpty)(e))return{"App.Id":e.id,"App.Name":e.name,"App.Scope":EE(gE.Mv,e.scope),"App.ScenarioCapability":EE(gE.Ky,e.scenarioCapability),"App.EntryPoint":EE(gE.sG,e.entryPoint),"App.ExternalId":e.externalId,"App.IsTenantApp":e.isTenantApp,"App.CapabilityId":e.capabilityId,"App.SceneId":e.sceneId,"Bot.Id":e.botId,"App.MsftPartnerAppID":e.mpnId,"App.Source":EE(uE,e.appDetailsEntryPoint),"App.FromSectionName":e.fromSectionName,"App.Capabilities":e.capabilities,"App.BotScopes":e.botScopes,"App.GalleryTabScopes":e.galleryTabScopes,"App.StaticTabScopes":e.staticTabScopes,"App.StaticTabName":e.staticTabName,"App.ConnectorScopes":e.connectorScopes,"App.ConnectorId":e.connectorId,"App.Version":e.version,"App.ManifestVersion":e.manifestVersion,"App.Categories":e.categories,"App.IsHostedApp":e.isHostedApp}}function NE(e){const{panelRegion:t,panelRegionNew:n,panelType:i,panelTypeNew:a,threadId:o,teamId:r,threadMembers:s,threadType:l,panelLaunchMethod:d,panelUri:c,dataBag:u,extensibilityData:m,eventIdentifier:g,entityType:p,mainSlotApp:h,mainEntityType:v,mainEntityAction:S}=e,f=EE(dr.Ai,t),y=EE(dr.wh,i),k=(0,Z.isNil)(g)?[f,y].filter(Boolean).join("_"):EE(dr.b6,g);return Object.assign(Object.assign(Object.assign({"Panel.LaunchMethod":d,"Panel.Region":t,"Panel.Type":i,"Panel.RegionNew":n,"Panel.TypeNew":a,"Panel.Uri":c,"Thread.Id":o,"Team.Id":r,"Thread.Type":l,"Thread.Members":s,"TargetThread.Id":o,"TargetThread.Type":l,"EventInfo.Identifier":k,"Entity.Type":p},u&&u.data),AE(m)),{"UserInfo.ChannelResourceTenant.Id":e["UserInfo.ChannelResourceTenant.Id"],"SlotConfig.MainSlotApp":h,"SlotConfig.MainEntityType":v,"SlotConfig.MainEntityAction":S})}function EE(e,t){return t?e[t]:void 0}class DE{create(e,t,n,i,a,o){const r=new pe(i),s=new cE(Object.assign(Object.assign({},e),{loggerFactory:r}),n,a,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,o),l=new _E(t),d=new qN(r.newLogger("SetUserOnTelemetryContextTask"),o),c={coreScenarioFactory:s,userBiService:l,loggerFactory:r,telemetryContext:d,telemetryService:new FE(s,d,a)};return DE._cache.set(o,c),c}destroy(e){var t,n,i,a;if(e){const o=DE._cache.get(e);o&&(null===(n=(t=o.coreScenarioFactory).destroy)||void 0===n||n.call(t),null===(a=(i=o.userBiService).destroy)||void 0===a||a.call(i),DE._cache.delete(e))}}get(e){let t;return e&&(t=DE._cache.get(e)),t}clear(){DE._cache.clear()}}DE._cache=new Map;class FE{constructor(e,t,n){this.coreScenarioFactory=e,this.coreTelemetryContext=t,this.memoryAnalyzer=n,this.newCoreScenario=(e,t)=>this.coreScenarioFactory.newScenario(e,t),this.stopCoreScenarioIfActive=(e,t,n)=>this.coreScenarioFactory.stopScenarioIfActive(e,t,n),this.createScenarioFactory=(e,t,n,i,a,o="")=>{const{coreSettings:r}=e,{enableCreateWindowLaunchScenarioOnMainWindow:s}=r.get(A.J.Core);return new cE({parentScenarioFactory:e.scenarioFactory,coreSettings:e.coreSettings,platformService:e.platformService,loggerFactory:e.loggerFactory,hostCommunicationService:e.hostCommunicationService,windowProvider:e.windowProvider,authenticationUser:e.authenticationUser,correlation:n},parseInt(n.startTimestamp,10)||Date.now(),this.memoryAnalyzer,t,i,this.coreInitTimestamp,!!s||t!==_.ew,void 0,void 0,void 0,{"Window.ViewportContext":a},o||this.coreTelemetryContext.userId)},this.createUserBiService=(e,t,n)=>new _E({authenticationUser:e.authenticationUser,coreSettings:e.coreSettings,windowProvider:e.windowProvider,platformService:e.platformService,experimentationService:e.experimentationService,hostCommunicationService:e.hostCommunicationService,client:e.client,localStorage:e.localStorage,parentUserBiService:e.userBiService,correlation:n},t),this.setCoreContext=(e,t,n)=>{this.coreTelemetryContext.setContext(e,t,n)},this.setContext=(e,t,n,i="")=>{this.coreTelemetryContext.setContext(e,t,n,i)},this.setDeviceAuthToken=e=>{this.coreTelemetryContext.setDeviceAuthToken(e)},this.setUserId=e=>{this.coreTelemetryContext.setUserId(e)},this.getTelemetryContextService=()=>this.coreTelemetryContext,this.setTelemetryContextService=e=>{this.coreTelemetryContext=e},this.logOutUser=e=>{(0,Jn.G)().logOutUser(e)},FE._telemetryServicesCache||(FE._telemetryServicesCache=new DE)}getMemoryAnaylzer(){return this.memoryAnalyzer}setCoreInitTime(e){var t,n;this.coreInitTimestamp=e,null===(n=(t=this.coreScenarioFactory).setCoreInitTime)||void 0===n||n.call(t,e)}getTelemetryServicesCache(){return FE._telemetryServicesCache}}class PE extends xe{constructor(){super(_.Yg.SetUserOnTelemetryContext,["telemetryService","authenticationUser","coreSettings","loggerFactory","diagnosticsService","config","correlation","authenticationService","telemetryContextService","windowProvider","hostCommunicationService","platformService","scenarioFactory"])}execute(e){var t,n,i,a,o;return(0,c.mG)(this,void 0,void 0,(function*(){const{authenticationUser:r,coreSettings:s,loggerFactory:l,authenticationService:d,correlation:u,telemetryContextService:m,telemetryService:g}=e,p=l.newLogger("SetUserOnTelemetryContextTask");let h;if(s.get(A.J.Telemetry).useTelemetryServicesCache&&(h=g.getTelemetryServicesCache().get(r.id)),h)e.loggerFactory=h.loggerFactory,e.scenarioFactory=h.coreScenarioFactory,e.telemetryService=h.telemetryService,e.userBiService=h.userBiService,e.telemetryContextService=h.telemetryContext;else{const i=r.type===Pr.Ch.MsaLife||s.get(A.J.Metadata).environment===bt.s.life,a=new qN(p,r.id);e.loggerFactory=new pe(e.diagnosticsService,e.correlation.id,r.id);const o=new cE({parentScenarioFactory:e.scenarioFactory,coreSettings:e.coreSettings,platformService:e.platformService,loggerFactory:e.loggerFactory,hostCommunicationService:e.hostCommunicationService,windowProvider:e.windowProvider,authenticationUser:e.authenticationUser,correlation:e.correlation},e.config.startTimeMS,null===(t=e.telemetryService)||void 0===t?void 0:t.getMemoryAnaylzer(),void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,r.id);e.scenarioFactory=o,e.telemetryService=new FE(o,a,null===(n=e.telemetryService)||void 0===n?void 0:n.getMemoryAnaylzer()),i&&(r.profile.paddedMsaId=this.getPaddedMsaId(r.profile.objectId,p)),this.setAuthUserOnTelemetryContext(e.telemetryService,r,i)}const v=null!==(i=s.get(A.J.Telemetry).disableMTMAPrimaryId)&&void 0!==i&&i;Oa(v,m,d,u,p),null===(o=(a=e.authenticationService).registerEndTelemetryTask)||void 0===o||o.call(a,(e=>(0,c.mG)(this,void 0,void 0,(function*(){var t;g.setContext("UserInfo.IsMRU",void 0,void 0,e);try{yield Oa(v,m,d,u,p)}catch(e){null===(t=p.errorToTelemetry)||void 0===t||t.call(p,"Failed to update MRU or sync mtma context","telemetry_instrumentation_update_user_context")}(0,Jn.G)().logOutUser(e),s.get(A.J.Telemetry).useTelemetryServicesCache&&g.getTelemetryServicesCache().destroy(e)}))))}))}setAuthUserOnTelemetryContext(e,t,n){n&&t.profile.paddedMsaId&&this.setUserContext(e,t.profile.paddedMsaId);const i=n&&t.profile.paddedMsaId?t.profile.paddedMsaId:t.profile.objectId;e.setContext("UserInfo.Id",i),e.setContext("UserInfo.TenantId",t.profile.tenantId),e.setContext("UserInfo.Type",t.type),e.setContext("UserInfo.Role",t.role)}setUserContext(e,t){const n=t.slice(19).replace("-","");e.setUserId(t),e.setContext("UserInfo.Id",t),e.setContext("userId",n)}getPaddedMsaId(e,t){try{if(/(\w{8})-(\w{4})-(\w{4})-(\w{4})-(\w{12})/.exec(e)&&e.startsWith("00000000-0000-0000-"))return e;{const t=(0,Z.padStart)(e,32,"0"),n=/(\w{8})(\w{4})(\w{4})(\w{4})(\w{12})/;return t.replace(n,"$1-$2-$3-$4-$5")}}catch(e){return void t.error("failed_user_padding")}}}class ME extends xe{constructor(){super(_.Yg.CreateUserTelemetryServicesTask,["telemetryService","authenticationUser","diagnosticsService","coreSettings","loggerFactory","windowProvider","correlation","platformService","experimentationService","hostCommunicationService","client","scenarioFactory"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{authenticationUser:t,diagnosticsService:n,telemetryService:i,coreSettings:a,loggerFactory:o,windowProvider:r,correlation:s,platformService:l,experimentationService:d,hostCommunicationService:c,client:u,scenarioFactory:m}=e;a.get(A.J.Telemetry).useTelemetryServicesCache&&!i.getTelemetryServicesCache().get(t.id)&&i.getTelemetryServicesCache().create({coreSettings:a,loggerFactory:o,windowProvider:r,correlation:s,parentScenarioFactory:m},{authenticationUser:t,coreSettings:a,windowProvider:r,platformService:l,experimentationService:d,hostCommunicationService:c,client:u},Date.now(),n,i.getMemoryAnaylzer(),t.id)}))}}const jE="serviceWorkerDeferInstallDurationInMs",RE="enableServiceWorkerIntegrityCheck",xE="enableServiceWorkerDynamicManifest",OE="localeSettingValue",LE="environment",UE="clientType",BE="swHandleCdlHashRoute",WE="platformId",GE="teams-service-worker-telemetry-v2",VE="1",HE="LogEvents",$E="timestamp",zE="teams-service-worker-v2",qE="2",JE="SwState",QE="key";var KE,YE,XE,ZE;!function(e){e.Install="install",e.Activate="activate",e.Fetch="fetch"}(KE||(KE={})),function(e){e.Intermediate="intermediate",e.Old="old"}(YE||(YE={})),function(e){e.Info="sw_info",e.InstallSuccess="sw_install_success",e.InstallFailure="sw_install_failure",e.ActivateSuccess="sw_activate_success",e.ActivateFailure="sw_activate_failure",e.FetchCacheMiss="sw_fetch_cache_miss",e.CleanupCacheSuccess="sw_cleanup_cache_success",e.CleanupCacheFailure="sw_cleanup_cache_failure",e.CleanupCacheRetry="sw_cleanup_cache_retry",e.CleanupNotRun="sw_cleanup_cache_not_run",e.CleanupNotRequired="sw_cleanup_cache_not_required",e.CorruptCache="sw_corrupt_cache",e.CorruptCacheDeleteSuccess="sw_corrupt_cache_delete_success",e.CorruptCacheDeleteFailure="sw_corrupt_cache_delete_failure",e.DeferInstallStarted="sw_install_defer_started",e.DeferInstallCancelled="sw_install_defer_cancelled",e.DeferInstallCancelledOnMaxIncomplete="sw_install_defer_cancelled_max_incomplete",e.DeferInstallOldCacheCleanupInProgress="sw_install_defer_old_cache_cleanup_inprogress",e.DeferInstallTimerCompleted="sw_install_defer_timer_completed",e.DeferInstallRetryAttempted="sw_install_defer_retry",e.ResetInstallIncompleteCounterFailure="sw_install_reset_counter_failure",e.ResetCacheCleanupStateFailure="sw_reset_cache_cleanup_state_failure",e.InstallIntegrityCheckPerformed="sw_install_integrity_check_performed",e.ReadIndexedDbFailure="sw_read_indexeddb_failure",e.AssetSetGenerationFailure="sw_asset_set_generation_failure",e.WriteIndexedDbFailure="sw_write_indexeddb_failure",e.FetchSWAssetsUsingSendMessage="sw_fetch_assets_using_send_message"}(XE||(XE={})),function(e){e.Start="start",e.Success="success",e.Failure="failure",e.CacheMiss="cache_miss",e.HighLatency="high_latency",e.CDNAssetNotInManifest="cdn_asset_not_in_manifest",e.OfflineAssetStart="offline_asset_start",e.OfflineAssetSuccess="offline_asset_success",e.OfflineAssetFailure="offline_asset_failure",e.OfflineAssetCacheMiss="offline_asset_cache_miss"}(ZE||(ZE={}));const eD=3e5,tD=18e4,nD=72e5,iD="serviceWorkerCheckingForUpdates",aD="serviceWorkerUnregisterSuccess",oD="serviceWorkerUnregisterFailure",rD="serviceWorkerMaxUpdateFailureCountReached",sD="serviceWorkerRegistrationNotFound",lD=5;var dD=n(40178);class cD{constructor(e){var t,n,i,a,o;this.context=e,this.fetchTelemetryStore=new Map,this.swEnableIntegrityCheck=!1,this.isSwInstalling=!1,this.isSwWaiting=!1,this.serviceWorkerUpdateFailureCount=0,this.basePath=this.context.config.basePath,this.loggerFactory=this.context.loggerFactory,this.logger=this.loggerFactory.newLogger("WebClientUpdateService"),this.rebootService=this.context.rebootService,this.host=this.context.windowProvider,this.scenarioFactory=this.context.scenarioFactory,this.coreSecurityService=this.context.coreSecurityService;try{this.swRegisterUrlPolicy=this.coreSecurityService.getTrustedTypePolicy("@msteams/services-io-browser-web-client-update#register-service-worker"),this.trustedScriptUrl=null===(t=this.swRegisterUrlPolicy)||void 0===t?void 0:t.createScriptURL(`/${this.basePath}/serviceworker.js`,this.host.location.origin)}catch(e){e instanceof fm.Y?null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,e.toTelemetryEntry(),"fundamental_performance_trusted_sw_scripturl"):null===(o=(a=this.logger).errorToTelemetry)||void 0===o||o.call(a,"create register service worker url trustedtype policy failed",e)}this.enableSWSubscription=this.context.coreSettings.getObservable(A.J.Core).subscribe((e=>{this.registerOrUnregisterServiceWorker(!!e.enableServiceWorker)}))}cleanup(){this.enableSWSubscription.unsubscribe(),this.clearTimer()}checkForUpdateAndRestartWebClient(){this.configureServiceWorkerEvents(),this.addUpdateServiceWorkerSettings(!0),this.registerAndCheckForServiceWorkerUpdates()}sendMessageToServiceWorker(e,t){return new Promise(((n,i)=>{const a=new MessageChannel;a.port1.onmessage=e=>{e.data.error?i(e.data.error):n(e.data)},e.postMessage(t,[a.port2])}))}handleOnStateChange(e,t,n,i){switch(this.sendServiceWorkerLifeCycleEventTelemetry(),t){case"installed":this.logger.log("Service worker got installed"),this.handleInstalledSWState(i);break;case"activated":this.logger.log("Service worker got activated"),this.isSwWaiting=!1,this.setServiceWorkerContextForScenarios(!0);case"redundant":this.handleRedundantSWState(e,n)}e={state:t}}SendIncompleteEvent(e,t){this.fetchTelemetryStore.set(e.url,e),this.sendServiceWorkerFetchEventTelemetryInCompleteEvent(t)}setServiceWorkerContextForScenarios(e=!1){e?this.setScenarioContext(e):this.getServiceWorkerRegistration().then((e=>{this.setScenarioContext(!!e)}))}unregisterServiceWorker(e){"serviceWorker"in this.host.navigator&&(this.getServiceWorkerRegistration().then((t=>{t&&t.unregister().then((t=>{this.logger.log(aD,e)}))})).catch((e=>{this.logger.error(oD,e)})),this.deleteCacheStorage(e),this.clearTimer())}handleRedundantSWState(e,t){"installing"===e.state?(this.isSwInstalling=!1,this.scenarioFactory.markStep(ee.RG.SwStateChange,ee.ck.SwInstallFailure),t.fail(),this.serviceWorkerUpdateFailureCount++,this.triggerForceUpdate()):"installed"===e.state&&(this.isSwWaiting=!1),this.setServiceWorkerContextForScenarios(!0)}triggerForceUpdate(){this.serviceWorkerUpdateFailureCount>=lD&&(this.logger.error("Will force an update when the app is idle as SW update failed repeatedly with",rD),this.handleUpdateReady())}handleInstalledSWState(e){this.isSwInstalling=!1,this.isSwWaiting=!0,this.setServiceWorkerContextForScenarios(!0),this.scenarioFactory.markStep(ee.RG.SwStateChange,ee.ck.SwInstalled),"storage"in this.host.navigator&&"estimate"in this.host.navigator.storage&&this.host.navigator.storage.estimate().then((e=>{var t,n;const i=e.usageDetails,a={storageUsage:e.usage,storageQuota:e.quota,cacheStorageSize:null==i?void 0:i.caches,indexedDBSize:null==i?void 0:i.indexedDB,swRegSize:null==i?void 0:i.serviceWorkerRegistrations};null===(n=(t=this.logger).infoToTelemetry)||void 0===n||n.call(t,"Teams disk footprint","fundamentals_performance_user_storage_info",a)})),this.scenarioFactory.stopScenarioIfActive(ee.RG.SwStateChange),e||this.handleUpdateReady(),this.serviceWorkerUpdateFailureCount=0}logServiceWorkerTelemetry(){this.sendServiceWorkerFetchEventTelemetry(),this.recurringSendSWFetchEventTelemetryInterval=this.host.setInterval(this.sendServiceWorkerFetchEventTelemetry.bind(this),eD),this.sendServiceWorkerLifeCycleEventTelemetry()}sendServiceWorkerLifeCycleEventTelemetry(){const e=parseInt(VE,10);(0,dD.q8)(GE,e,HE,$E,this.scenarioFactory,!0).then((e=>{var t;if(void 0!==e){let n=0;const i=null!==(t=this.recentProcessedLifeCycleEventTimestamp)&&void 0!==t?t:-1;e.map((e=>{var t;const a=null!==(t=e.timestamp)&&void 0!==t?t:0;a>i&&(this.sendServiceWorkerLifeInfoAndInstallTelemetry(e),n=Math.max(n,a))})),this.recentProcessedLifeCycleEventTimestamp=n}})).catch((e=>{this.logger.error("Error fetching service worker state telemetry. Error:",e)})).then((()=>(0,dD.dR)(GE,e,HE,$E,this.scenarioFactory).catch((e=>{this.logger.error("Error deleting service worker state telemetry. Error:",e)}))))}sendServiceWorkerLifeInfoAndInstallTelemetry(e){var t,n,i,a,o,r,s,l,d,c;const u={message:e.message,version:e.version,type:e.type};switch(e.type){case XE.InstallSuccess:null===(n=(t=this.logger).infoToTelemetry)||void 0===n||n.call(t,"success","fundamentals_performance_sw_install",u);break;case XE.InstallFailure:null===(a=(i=this.logger).errorToTelemetry)||void 0===a||a.call(i,"failure","fundamentals_performance_sw_install",u);break;case XE.ActivateSuccess:null===(r=(o=this.logger).infoToTelemetry)||void 0===r||r.call(o,"success","fundamentals_performance_sw_activate",u);break;case XE.ActivateFailure:null===(l=(s=this.logger).errorToTelemetry)||void 0===l||l.call(s,"failure","fundamentals_performance_sw_activate",u);break;default:null===(c=(d=this.logger).infoToTelemetry)||void 0===c||c.call(d,"success","fundamentals_performance_sw_state_info",u)}}registerServiceWorker(){const{enableTrustedSWScriptUrl:e}=this.context.coreSettings.get(A.J.Core),t=e&&this.trustedScriptUrl?this.trustedScriptUrl:`/${this.basePath}/serviceworker.js`,n=this.scenarioFactory.newScenario(ee.RG.SwRegistration);this.host.navigator.serviceWorker.register(t,{updateViaCache:"all"}).then((e=>{n.stop(),this.attachEventsToInstallingServiceWorker(e,!0)})).catch((e=>{n.fail({message:`Error: ${e}`})}))}handleUpdateReady(){this.skipWaitingServiceWorkerIfNeeded(),this.rebootService.rebootWhenLongInactive(lr.Z.AppUpdatedUsingServiceWorker,lr.d.WebClientUpdateService)}deleteCacheStorage(e){if(void 0!==this.host.caches){const t=this.scenarioFactory.newScenario(ee.RG.SwCleanupSwCache);this.host.caches.delete(_.eL).then((n=>{n?t.stop({reason:e}):t.fail({reason:"cache not found"})}))}}registerAndCheckForServiceWorkerUpdates(){this.getServiceWorkerRegistration().then((e=>{e?(this.logger.log(iD),e.update()):(this.logger.log(sD),this.registerServiceWorker())})).catch((e=>{this.logger.error(`Error getting Service Worker registration object: ${e}`)}))}configureServiceWorkerEvents(){"serviceWorker"in this.host.navigator&&this.getServiceWorkerRegistration().then((e=>{e?(this.attachEventsToInstallingServiceWorker(e),e.onupdatefound=()=>{this.attachEventsToInstallingServiceWorker(e)}):this.logger.log(sD)}))}registerServiceWorkerAndLogTelemetry(){this.addUpdateServiceWorkerSettings(),this.registerServiceWorker(),this.logServiceWorkerTelemetry()}addUpdateServiceWorkerSettings(e=!1){var t,n;const i=[],{serviceWorkerDeferInstallDurationInMs:a,enableServiceWorkerDynamicManifest:o,handleCdlHashRouteInServiceWorkerInstall:r,enableServiceWorkerIntegrityCheck:s}=this.context.coreSettings.get(A.J.Core);a&&Number.isInteger(a)&&this.swDeferInstallDurationInMs!==a&&(this.swDeferInstallDurationInMs=a,i.push({key:jE,value:this.swDeferInstallDurationInMs})),this.swEnableDynamicManifest!==o&&(this.swEnableDynamicManifest=null!=o&&o,i.push({key:xE,value:this.swEnableDynamicManifest})),this.swEnableIntegrityCheck!==s&&(this.swEnableIntegrityCheck=null!=s&&s,i.push({key:RE,value:this.swEnableIntegrityCheck})),this.swhandleCdlHashRoute!==r&&(this.swhandleCdlHashRoute=null!=r&&r,i.push({key:BE,value:this.swhandleCdlHashRoute}));const l=null!==(n=null===(t=this.context.i18NextWrapper)||void 0===t?void 0:t.locale)&&void 0!==n?n:"en-us";if(this.localeSetting!==l&&(this.localeSetting=l,i.push({key:OE,value:this.localeSetting})),!e){i.push({key:LE,value:this.context.platformService.ecsOverrides.environment.toString()});const e=this.context.platformService.config.clientType===Fo.Bh.Maglev?"desktop":this.context.platformService.config.clientType.toString();i.push({key:UE,value:e})}i.push({key:WE,value:this.context.platformService.config.platformId.toString()}),i.length&&this.writeSettingsInServiceWorkerDb(i)}writeSettingsInServiceWorkerDb(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=parseInt(qE,10);yield(0,dD.Zl)(zE,t,JE,QE,e,this.scenarioFactory).then((()=>{this.logger.log("Successfully updated service worker settings in Indexed DB")})).catch((e=>{this.logger.error("Error updating service worker settings in Indexed DB. Error:",e)}))}))}sendServiceWorkerFetchEventTelemetry(){this.host.navigator.serviceWorker.controller&&this.sendMessageToServiceWorker(this.host.navigator.serviceWorker.controller,"getFetchTelemetryEvents").then((e=>{e.forEach((e=>{this.sendServiceWorkerFetchEventTelemetryCompletedEvent(e)}))})).catch((e=>{this.logger.error("Error getting service worker fetch telemetry. Error:",e)})),this.sendServiceWorkerFetchEventTelemetryInCompleteEvent(eD)}sendServiceWorkerFetchEventTelemetryInCompleteEvent(e){const t=Date.now();this.fetchTelemetryStore.forEach(((n,i)=>{if(void 0===e||t-n.timestamp>e){const e={endpointUrl:n.url,fetchTelemetryEventDelta:t-n.timestamp,operationType:n.type,version:n.version,message:n.message},a=n.type===ZE.OfflineAssetStart?ee.RG.SwOfflineAssetFetchEvent:ee.RG.SwFetchEvent;this.scenarioFactory.newScenario(a).cancel(e),this.fetchTelemetryStore.delete(i)}}))}sendServiceWorkerFetchEventTelemetryCompletedEvent(e){const t={endpointUrl:e.url,operationType:e.type,message:e.message,version:e.version};if(this.captureFetchEvent(e,t)){let n=ee.RG.SwFetchEvent;this.isOfflineFetchOperation(e.type)&&(n=ee.RG.SwOfflineAssetFetchEvent);const i=this.scenarioFactory.newScenario(n);this.sendFetchEvent(i,e.type,t)}}isOfflineFetchOperation(e){let t;switch(e){case ZE.OfflineAssetSuccess:case ZE.OfflineAssetFailure:case ZE.OfflineAssetCacheMiss:t=!0;break;default:t=!1}return t}sendFetchEvent(e,t,n){switch(t){case ZE.Success:case ZE.OfflineAssetSuccess:case ZE.CacheMiss:case ZE.OfflineAssetCacheMiss:e.stop(n);break;case ZE.Failure:case ZE.OfflineAssetFailure:e.fail(n);break;default:e.incomplete(n)}}captureFetchEvent(e,t){switch(e.type){case ZE.Start:case ZE.OfflineAssetStart:return this.fetchTelemetryStore.set(e.url,e),!1;case ZE.Failure:case ZE.Success:case ZE.OfflineAssetFailure:case ZE.OfflineAssetSuccess:case ZE.CDNAssetNotInManifest:case ZE.CacheMiss:case ZE.OfflineAssetCacheMiss:const n=this.fetchTelemetryStore.get(e.url);return n?(t.fetchTelemetryEventDelta=e.timestamp-n.timestamp,this.fetchTelemetryStore.delete(e.url)):t.reason="orphan",!0;case void 0:return this.logger.error("unexpected fetch event type:",e.type),!1}return!1}clearTimer(){this.host.clearInterval(this.recurringCheckForUpdateInterval),this.host.clearTimeout(this.registerSWAndLogTelemetryTimer),this.host.clearInterval(this.recurringSendSWFetchEventTelemetryInterval)}registerOrUnregisterServiceWorker(e){if(e){if(!this.recurringCheckForUpdateInterval){this.recurringCheckForUpdateInterval=this.host.setInterval((()=>this.checkForUpdateAndRestartWebClient()),nD);const{serviceWorkerRegistrationDelayInMs:e}=this.context.coreSettings.get(A.J.Core),t=e&&Number.isInteger(e)?e:tD;this.registerSWAndLogTelemetryTimer=this.host.setTimeout((()=>this.registerServiceWorkerAndLogTelemetry()),t)}}else this.unregisterServiceWorker("Service Worker is not enabled");this.setServiceWorkerContextForScenarios()}setScenarioContext(e){var t,n;null===(n=(t=this.scenarioFactory).setContext)||void 0===n||n.call(t,{isServiceWorkerRegistered:e,isServiceWorkerActive:pA(this.host),isServiceWorkerInstalling:this.isSwInstalling,isServiceWorkerWaiting:this.isSwWaiting})}attachEventsToInstallingServiceWorker(e,t=!1){if(!e||!e.installing)return;const n=this.scenarioFactory.newScenario(ee.RG.SwStateChange);this.scenarioFactory.markStep(ee.RG.SwStateChange,ee.ck.SwInstalling);const i=e.installing,a={state:i.state};this.isSwInstalling=!0,this.setServiceWorkerContextForScenarios(!0),i.onstatechange=()=>this.handleOnStateChange(a,i.state,n,t)}skipWaitingServiceWorkerIfNeeded(){"serviceWorker"in this.host.navigator&&this.getServiceWorkerRegistration().then((e=>{e&&e.waiting&&e.waiting.postMessage("skipWaiting")}))}getServiceWorkerRegistration(){return this.host.navigator.serviceWorker.getRegistration(`/${this.basePath}/serviceworker.js`)}}class uD extends xe{constructor(){super(_.Yg.CreateWebClientUpdate,["coreSettings"])}execute(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){t.webClientUpdateService=new cD(e);const{isUnRegisterSWOnLogoutEnabled:n}=e.coreSettings.get(A.J.Core);if(n)return e=>(0,c.mG)(this,void 0,void 0,(function*(){switch(e){case"signout":yield t.webClientUpdateService.unregisterServiceWorker(e);break;default:return}}))}))}}var mD=n(45657);class gD extends xe{constructor(){super(_.Yg.CreateWindow,["config","diagnosticsService","logsCollectorService"]),this.registerShellHandlers=(e,t,n)=>{e.opener.addEventListener(K.rY.GetLogs,(()=>(0,c.mG)(this,void 0,void 0,(function*(){const i=yield t.getDiagnosticsEvents(),a=yield n.getSystemInfo();let o="System Info: ";a&&a.size>0?a.forEach(((e,t)=>{o+=`${t}: ${e}\n`})):o+="No system info collected",i.unshift({message:`${o}`,level:D.i.Debug,levelName:D.i[D.i.Debug],timeStamp:new Date,isPiiFree:!0}),e.opener.postMessage(K.rY.GetLogs,{logs:i})}))))}}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=mD.n.getInstance(),n=t.config.hostedWindowContext,i=t.window;t.opt={postMessageConfig:e.config.postMessageConfig},i.onAppStart();const{diagnosticsService:a,logsCollectorService:o}=e;this.registerShellHandlers(i,a,o),e.hostedWindowContext=n,e.windowProvider=i}))}}class pD extends xe{constructor(){super(_.Yg.DisableExperience,["platformService","coreSettings","loggerFactory"])}execute(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const{platformService:n,coreSettings:i,loggerFactory:a}=e,o=null===(t=n.config)||void 0===t?void 0:t.browser,{supportedBrowsers:r}=i.get(A.J.Core);if(o&&r){if(!!!(null==r?void 0:r.find((e=>e===o))))throw(0,he.Tr)(_.w5.Core,_.jK.Disabled,"DisableUnsupportedBrowsersTask",void 0,`Browser "${o}" is not supported.`)}else o||a.newLogger("DisableUnsupportedBrowsersTask").warn("Unable to detect Browser.")}))}}class hD extends xe{constructor(){super(_.Yg.DiscoverUser,["discover"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){e.user=yield e.discover.getUser()}))}}class vD extends xe{constructor(){super(_.Yg.FetchCriticalDynamicImportsTask,["criticalDynamicImports","loggerFactory","scenarioFactory"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{criticalDynamicImports:t,loggerFactory:n,scenarioFactory:i}=e;t&&0!==t.length&&t.forEach((({importFunc:e,chunkName:t})=>{(0,cd.mT)(e,t,i).catch((e=>{var i,a;return null===(a=(i=n.newLogger("FetchCriticalDynamicImportsTask")).errorToTelemetry)||void 0===a?void 0:a.call(i,`Failed to preload chunk ${t} this will regress performance of first load: ${e}`,"webclient_framework_foundation_core_services_tasks",void 0,!0)}))}))}))}}class SD extends xe{constructor(){super(_.Yg.InitApiServiceProvider,["coreSettingsContext"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){yield e.coreSettingsContext.initializeApiServiceProvider()}))}}class fD extends xe{constructor(){super(_.Yg.InitAsyncMediaAuthService,["mediaAuthService"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{mediaAuthService:t}=e;return t.initAsyncMediaAuthService(),e=>(0,c.mG)(this,void 0,void 0,(function*(){switch(e){case"signout":yield t.logout();break;default:return}}))}))}}var yD=n(667);class kD extends xe{constructor(){super(_.Yg.InitATPPolicyTask,["authenticationService","coreSettings","gtmRegistry","scenarioFactory","localStorage","loggerFactory"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,gtmRegistry:i,scenarioFactory:a,localStorage:o,loggerFactory:r}=e,{enableFastSharepointSafelinks:s}=n.get(A.J.Messaging),l=r.newLogger("InitATPPolicyTask");if(!(null==s?void 0:s.enabled))return void l.log("InitATPPolicyTask - Do nothing, FF is disabled");const d=new yD.c(i.bind(ys.l,E.Pn.middleTier),t,n,a,r,o);l.log("Getting ATP Safelinks policy"),d.initPolicy()}))}}const CD={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeAuthenticatedUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reason"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeAuthenticatedUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"reason"},value:{kind:"Variable",name:{kind:"Name",value:"reason"}}}]}]}}]};let bD;class TD{constructor(e,t,n,i,a,o,r,s){var l,d;this._auth=e,this._client=t,this._discover=n,this._networkStateProvider=i,this._windowProvider=o,this._keepTokenActive=!1,this._keepCheckingSignInRestrictions=!1,this._isLoginRequired=void 0,this._tokenIntervalId=void 0,this._logger=r.newLogger("AuthTokenStoreService"),this._mtResourceKey=(null===(l=null==s?void 0:s.get(A.J.Auth))||void 0===l?void 0:l.mtResource)||ni.ej.MT_AAD_KEY,this._tokenWarmingIntervalInMs=(null===(d=null==s?void 0:s.get(A.J.Auth))||void 0===d?void 0:d.tokenWarmingIntervalInMs)||xs.lP.MT_TOKEN_INTERVAL,this._subscriptions=new Map,this.observeIsLoginRequired(),this.observeAppOnlineState()}observe(e){let t=this._subscriptions.get(e);return t||(t=this.createSubscription(e),this._subscriptions.set(e,t)),t}createSubscription(e){let t;switch(e){case ni.ej.MT_KEY:this._keepTokenActive=!0,t=this._auth.observeMiddleTierToken(),this.keepTokenActive();break;case ni.ej.SIGNIN_RESTRICTIONS_KEY:this._keepCheckingSignInRestrictions=!0,this.keepTokenActive();break;default:this._logger.error("Unable to create subscription, token key %s is not supported",e)}return t}keepTokenActive(){this._tokenIntervalId||(this._keepTokenActive||this._keepCheckingSignInRestrictions)&&(this._tokenIntervalId=this._windowProvider.setInterval((()=>{if(this._keepCheckingSignInRestrictions){let e=(0,Ps.pW)();e=`sign${e.substr(ni.uI.FOUR)}`,this._auth.acquireToken(ni.ej.SIGNIN_RESTRICTIONS_KEY,{correlationId:e}).catch((e=>{this.handleSignInRestrictionsError(e)}))}this._keepTokenActive&&this._auth.acquireToken(this._mtResourceKey).then((()=>this._discover.validateSkypeToken())).catch((e=>{this._logger.error("Error occurred in keeping MT token active.",e)}))}),this._tokenWarmingIntervalInMs))}handleSignInRestrictionsError(e){if(this._logger.error(`Error occurred in keeping SignInRestrictions token active. ErrorCode: ${null==e?void 0:e.errorCode}`,e),(null==e?void 0:e.errorCode)===ni.SM.SignInRestrictions){this._logger.error("Sign in restrictions was enabled and caught by the periodic check. Forcibly signing out the user");const e={id:(0,Ps.pW)(),source:"auth-token-store",scenarioName:ee.RG.AuthWebLogout},[t,n]=(0,Cl.OU)({options:{correlation:e},scenarioName:e.scenarioName,source:e.source,subContext:"auth-token-store::handleSignInRestrictionsError"});t.appendScenarioEventData({operationType:ni.SM.SignInRestrictions}),this._client.mutate({mutation:CD,variables:{reason:ni.SM.SignInRestrictions},context:{correlation:e}}),n()}else this._logger.error("Sign in restrictions token acquisition threw an unexpected error",e)}observeIsLoginRequired(){this._auth.isLoginRequired.subscribe((e=>{if(this._isLoginRequired===e)return;const t=void 0===this._isLoginRequired;this._isLoginRequired=e,t||(this._isLoginRequired?this._tokenIntervalId&&(this._windowProvider.clearInterval(this._tokenIntervalId),this._tokenIntervalId=void 0):this.replayKeepTokenActiveState())}))}observeAppOnlineState(){this._networkStateProvider.observeIsOnline().subscribe((e=>{e?this.replayKeepTokenActiveState():this._tokenIntervalId&&(this._windowProvider.clearInterval(this._tokenIntervalId),this._tokenIntervalId=void 0)}))}replayKeepTokenActiveState(){if(0===this._subscriptions.size)return;const e=this._subscriptions.keys();let t=e.next();for(;!t.done;)this.keepTokenActive(),t=e.next()}}class wD extends xe{constructor(){super(_.Yg.InitAuthenticationService,[])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{client:t,discover:n,authenticationUser:i,authenticationService:a,networkState:o,loggerFactory:r,coreSettings:s,scenarioFactory:l}=e,{enableSignInRestrictions:d,prefetchTokens:c,disableTokenWarming:u}=s.get(A.J.Auth);if(!i)return;const m=((e,t,n,i,a,o,r)=>(bD||(bD=new TD(n,e,t,i,a,(0,Q.J)(),o,r)),bD))(t,n,a,o,l,r,s);d&&m.observe(ni.ej.SIGNIN_RESTRICTIONS_KEY),!u&&m.observe(ni.ej.MT_KEY),null==c||c.forEach((e=>e&&a.acquireToken(e).catch((()=>{}))))}))}}class _D{constructor(e){this.coreSettings=e,this.brbServiceMap=new Map}registerUserBrbService(e,t){this.brbServiceMap.set(e,t)}unregisterUserBrbService(e){return this.brbServiceMap.delete(e)}getBrbFormData(){return(0,c.mG)(this,void 0,void 0,(function*(){const{categories:e,disclaimer:t}=this.coreSettings.get(A.J.Brb),n=[];return null==e||e.forEach((e=>{e&&n.push({id:e.id,name:e.name})})),{disclaimer:t||_.bA,categories:n}}))}getBrbScreenshots(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){const n=yield this.getOrCreateUserBrbService(e);return null==n?void 0:n.getBrbScreenshots(t)}))}createBrbItem(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){const n=this.getOrCreateUserBrbService(e),i=yield(null==n?void 0:n.createBrbItem(t))||void 0;if(!i)return!1;const{enableMTMA:a}=this.coreSettings.get(A.J.Core);if(a){Array.from(this.brbServiceMap.keys()).filter((t=>t!==e)).forEach((e=>{const n=this.getOrCreateUserBrbService(e);null==n||n.extendBrbReports(t,i)}))}return!0}))}getOrCreateUserBrbService(e){const t=this.brbServiceMap.get(e);if(t&&t instanceof Function){const n=t();return this.brbServiceMap.set(e,n),n}return t}}class ID extends xe{constructor(){super(_.Yg.InitBrbServiceManagerTask,["coreSettings"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{coreSettings:t}=e;e.brbServiceManager=new _D(t)}))}}class AD extends xe{constructor(){super(_.Yg.InitDesktopEcsContext,["primaryUser","coreSettings","loggerFactory","platformService","hostCommunicationService"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{primaryUser:t,coreSettings:n,loggerFactory:i,platformService:a,hostCommunicationService:o}=e,r=yield o.loadModule("ecs");if(null==r?void 0:r.setEcsContext){const e=yield this.getDesktopEcsFilters(t,n,i,a);r.setEcsContext(e)}}))}getDesktopEcsFilters(e,t,n,i){var a,o;return(0,c.mG)(this,void 0,void 0,(function*(){const{ring:r,environment:s}=t.get(A.J.Metadata),{isInternalUser:l}=i.config,{originalRing:d}=i.ecsOverrides;return s||null===(o=(a=n.newLogger("InitPolicyProviderTask")).errorToTelemetry)||void 0===o||o.call(a,"Environment is undefined","webclient_framework_foundation_core_services_tasks",void 0,!0),{ring:(null==r?void 0:r.id)||"general",cloud:s||"",userId:e.profile.objectId,tenantId:e.profile.tenantId,isInternalUser:l,originalRing:d}}))}}class ND{constructor(e,t){var n,i,a,o,r,s,l,d;this.coreSettings=e,this.hostCommunicationService=t;const c=this.coreSettings.get(A.J.Metadata);this.expConfigMetadata=[{client:pE,config:{expIds:null!==(a=null===(i=null===(n=c.configIds)||void 0===n?void 0:n.experiments)||void 0===i?void 0:i.join(","))&&void 0!==a?a:"",rolloutIds:null!==(s=null===(r=null===(o=c.configIds)||void 0===o?void 0:o.rollouts)||void 0===r?void 0:r.join(","))&&void 0!==s?s:"",eTag:null!==(l=c.eTag)&&void 0!==l?l:""}},{client:hE,config:{expIds:"",rolloutIds:"",eTag:null!==(d=c.hostETag)&&void 0!==d?d:""}}],this.subject=new u.X(this.expConfigMetadata),this.ecmObservable=this.subject.asObservable(),this.registerSyncHostEcm()}updateHostExperimentConfigMetadata(e){const t=e.find((e=>e.client===hE)),n=this.expConfigMetadata.findIndex((e=>e.client===hE));t&&n>-1&&(this.expConfigMetadata[n]=t,this.subject.next(this.expConfigMetadata))}updateWebExperimentConfigMetadata(e){var t;const n=null===(t=this.expConfigMetadata.find((e=>e.client===pE)))||void 0===t?void 0:t.config;n&&e.eTag&&e.configIds&&e.configIds.experiments&&(n.eTag=e.eTag,n.expIds=e.configIds.experiments.join(","))}communicateWithHost(){var e,t;return(0,c.mG)(this,void 0,void 0,(function*(){const n=null===(e=this.expConfigMetadata.find((e=>e.client===pE)))||void 0===e?void 0:e.config;if(!n)return;const i=yield this.hostCommunicationService.loadModule("ecs");if(!i)return;const a=yield null===(t=i.syncEcm)||void 0===t?void 0:t.call(i,[{client:pE,config:n}]);if(a&&a.client===hE){const e=[{client:hE,config:{eTag:a.config.eTag,expIds:a.config.expIds,rolloutIds:a.config.rolloutIds}}];this.updateHostExperimentConfigMetadata(e)}}))}registerSyncHostEcm(){this.hostCommunicationService.loadModule("ecs").then((e=>{var t;null===(t=null==e?void 0:e.registerForOnSyncEcm)||void 0===t||t.call(e,(e=>{this.updateHostExperimentConfigMetadata(e)}))}))}}class ED extends xe{constructor(){super(_.Yg.InitExperimentation,["coreSettings","hostCommunicationService"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{coreSettings:t,hostCommunicationService:n}=e;e.experimentationService=new ND(t,n)}))}}class DD extends xe{constructor(){super(_.Yg.InitializePulsarTask,["coreSettings","loggerFactory","platformService"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n,platformService:i}=e,a=new Za(Ja.TEAMS_CORE,{sessionId:i.host.sessionId,spanExporter:new eo,loggerFactory:n,logToOTLCollector:!!t.get(A.J.Pulsar).logToOTLCollector});t.get(A.J.Pulsar).enablePulsarTelemetry&&(yield a.initialize()),e.pulsar=a}))}}class FD{constructor(e,t,n,i,a,o,r){this.scenarioFactory=a,this.host=o,this.clientStateProvider=r,this.namespacesToFetch=[],this.settings={},this.refreshIntervalInMs=36e5,this.fetch=()=>{if(0===this.namespacesToFetch.length)return this.logger.debug("Skipping fetch() as no namespacesToFetch registered."),Promise.resolve();const e=this.scenarioFactory.newScenario(this.getScenarioName());return this.validateEnvironment().then((()=>this.fetchPolicies(e))).catch((t=>{e.stop({errors:t},"abandoned"),this.logger.warn(`Error fetching policies: ${t}`)}))},this.validateEnvironment=()=>new Promise(((e,t)=>{this.clientStateProvider.getState()===Ve.pk.VeryActive&&(this.logger.log("Cancel policy fetching, due to app being in a very active state."),t("very active")),e()})),this.cleanupClientStateSubscription=()=>{var e;null===(e=this.clientStateSubscription)||void 0===e||e.unsubscribe(),this.clientStateSubscription=void 0},this.logger=e.newLogger(`CoreSettings/${t}`),this.namespacesToFetch=n("policies").namespaces||[],this.namespacesToFetch.forEach((e=>{this.settings[e]={}})),this.updateConfigs(i)}initialize(e=!0){return(0,c.mG)(this,void 0,void 0,(function*(){this.isInitialized=!0,yield this.fetchAndSetRefreshCadence()}))}subscribeForSettingsUpdates(e){this.settingsChangedCallbackFunction=e}cleanup(){var e;this.cleanupClientStateSubscription(),this.settingsChangedCallbackFunction=void 0,null===(e=this.coreSubscription)||void 0===e||e.unsubscribe(),this.coreSubscription=void 0}notifySettingsChanged(){const e=()=>{var e;this.cleanupClientStateSubscription(),null===(e=this.settingsChangedCallbackFunction)||void 0===e||e.call(this,this.settings),this.logger.debug("Notified about policy change")};return this.clientStateProvider.getState()!==Ve.pk.VeryActive?(e(),!0):(this.clientStateSubscription||(this.clientStateSubscription=this.clientStateProvider.observe().subscribe((t=>{t!==Ve.pk.VeryActive&&e()}))),!1)}handleError(e){this.logger.error(`Failed to fetch tenant settings with error: ${e}`)}updateConfigs(e){const t=e.getObservable(A.J.Core);this.coreSubscription=t.subscribe((e=>{e.policyRefreshIntervalInMs&&this.updateRefreshCadence(e.policyRefreshIntervalInMs)}))}updateRefreshCadence(e){this.refreshIntervalInMs=e,this.isInitialized&&this.queueNextPolicyFetch()}fetchAndSetRefreshCadence(){return this.fetch().then((()=>{this.queueNextPolicyFetch()})).catch((e=>{this.logger.error(`Error fetching policies: ${e}`)}))}queueNextPolicyFetch(){if(!this.isInitialized)throw new Error("Service not initialized to queue the fetch.");this.setIntervalHandle&&(this.host.clearInterval(this.setIntervalHandle),this.setIntervalHandle=void 0,this.logger.debug("clearInterval() called.")),this.refreshIntervalInMs>0?(this.setIntervalHandle=this.host.setInterval(this.fetch,this.refreshIntervalInMs),this.logger.debug("setInterval() called.")):this.logger.error(`Refresh interval not valid: ${this.refreshIntervalInMs}`)}}class PD extends FD{constructor(e,t,n,i,a,o){super(e,"PoliciesIpcDataProvider",t,n,i,a,o),this.handleSetAggregatedSettings=e=>{const{payload:t}=e;Object.keys(t).length>0?(this.logger.log(`handleSetAggregatedSettings() called: ${Object.keys(t).join(", ")}.`),this.parsePolicies(t),this.notifySettingsChanged()):this.logger.log("handleSetAggregatedSettings() called with empty payload.")},this.windowOpener=a.opener}initialize(e=!0){const t=Object.create(null,{initialize:{get:()=>super.initialize}});return(0,c.mG)(this,void 0,void 0,(function*(){return this.windowOpener.addEventListener(K.rY.SetAggregatedSettings,this.handleSetAggregatedSettings),t.initialize.call(this)}))}cleanup(){super.cleanup(),this.windowOpener.removeEventListener(K.rY.SetAggregatedSettings,this.handleSetAggregatedSettings)}getScenarioName(){return ee.RG.IPCPolicyFetch}fetchPolicies(e){return this.windowOpener.requestMessage(K.rY.GetAggregatedSettings).then((t=>{let n=!1,i="success";const a=null==t?void 0:t.data;a&&0!==Object.keys(a).length?(this.logger.log(`fetchPolicies: Got policies for namespaces: ${Object.keys(a).join(", ")}.`),this.parsePolicies(a),n=this.notifySettingsChanged()):(this.logger.log("Failed to fetch policies via IPC, got empty payload data response."),i="incomplete"),e.stop({message:(0,R.u4)({notified:n})},i)})).catch((t=>{var n;this.handleError(t),e.fail({errors:null!==(n=t.message)&&void 0!==n?n:"Failed to fetch policies via IPC."})}))}parsePolicies(e){this.namespacesToFetch.forEach((t=>{e[t]&&e[t].hasOwnProperty("value")&&(this.settings[t]=e[t].value)}))}}const MD={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"policies"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"correlationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"namespaces"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"policies"},arguments:[{kind:"Argument",name:{kind:"Name",value:"correlationId"},value:{kind:"Variable",name:{kind:"Name",value:"correlationId"}}},{kind:"Argument",name:{kind:"Name",value:"namespaces"},value:{kind:"Variable",name:{kind:"Name",value:"namespaces"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"jsonData"}}]}}]}}]},jD={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"policiesUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"policiesUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"jsonData"}}]}}]}}]};class RD extends FD{constructor(e,t,n,i,a,o,r){super(e,"PoliciesResolversDataProvider",t,n,i,a,r),this.apolloClient=o,this.handlePoliciesUpdatedEvent=e=>{this.logger.log("handlePoliciesUpdatedEvent() called.");try{void 0!==e&&this.parsePolicies(e)?this.notifySettingsChanged():this.logger.log(`handlePoliciesUpdatedEvent(): policiesString is ${void 0===e?"undefined":"empty"}.`)}catch(e){this.logger.error(`handlePoliciesUpdatedEvent(): ${e.message}`)}}}initialize(e=!0){const t=Object.create(null,{initialize:{get:()=>super.initialize}});return(0,c.mG)(this,void 0,void 0,(function*(){const e=this;return this.policiesApolloSubscription=this.apolloClient.subscribe({query:jD}).subscribe({next(t){var n,i,a;e.handlePoliciesUpdatedEvent(null!==(a=null===(i=null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.policiesUpdatedEvent)||void 0===i?void 0:i.jsonData)&&void 0!==a?a:void 0)}}),t.initialize.call(this)}))}cleanup(){var e;super.cleanup(),null===(e=this.policiesApolloSubscription)||void 0===e||e.unsubscribe(),this.policiesApolloSubscription=void 0}getScenarioName(){return ee.RG.PoliciesFetchDataResolvers}fetchPolicies(e){return this.apolloClient.query({query:MD,variables:{correlationId:e.id,namespaces:this.namespacesToFetch},fetchPolicy:"no-cache"}).then((t=>{var n,i,a,o,r;(null==t?void 0:t.error)&&(null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,`fetchPolicies:then: Message: ${t.error.message}.`,"webclient_framework_policies_resolvers_fetch_failed_event",void 0,!0)),(null==t?void 0:t.errors)&&t.errors.forEach((e=>{var t,n;null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`fetchPolicies:then: Errors:Message: ${e.message}.`,"webclient_framework_policies_resolvers_fetch_failed_event",void 0,!0)}));const s=null!==(r=null===(o=null===(a=null==t?void 0:t.data)||void 0===a?void 0:a.policies)||void 0===o?void 0:o.jsonData)&&void 0!==r?r:void 0;let l=!1,d="success";void 0!==s&&this.parsePolicies(s)?l=this.notifySettingsChanged():(this.logger.log(`fetchPolicies(): Failed to fetch policies, got ${void 0===s?"undefined":"empty"} response.`),d="incomplete"),e.stop({message:(0,R.u4)({notified:l})},d)})).catch((t=>{var n;this.handleError(t),e.fail({errors:null!==(n=t.message)&&void 0!==n?n:"Failed to fetch policies via resolvers."})}))}parsePolicies(e){let t={};try{t=JSON.parse(e)}catch(e){throw new Error("parsePolicies(): Unable to parse policies string.")}return 0!==Object.keys(t).length&&(this.namespacesToFetch.forEach((e=>{t[e]&&(this.settings[e]=t[e])})),!0)}}class xD extends xe{constructor(){super(_.Yg.InitSettingsPolicyProvider,["authenticationUser","coreSettings","coreSettingsContext","loggerFactory"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettings:n,coreSettingsContext:i,loggerFactory:a}=e,{disableNonBlockingPolicyProviderInit:o,disablePolicyProvider:r}=n.get(A.J.Core);if(r)return;if(!t||t.role===Pr.w4.Anonymous)return;const s=this.createPoliciesDataProvider(e),{enableMainWindowPolicyFetch:l}=n.get(A.J.Host);if(l||o)yield i.initializePolicyProvider(s);else{const e=a.newLogger("InitPolicyProviderTask");i.initializePolicyProvider(s).then((()=>{e.log("Initialized policy provider successfully.")})).catch((t=>{e.errorToTelemetry&&e.errorToTelemetry(`Initialization of policy provider failed. ${t}`,"webclient_framework_foundation_core_services",void 0,!0)}))}return e=>{switch(e){case"signout":s.cleanup()}}}))}createPoliciesDataProvider(e){const{client:t,clientState:n,configLoader:i,coreSettings:a,loggerFactory:o,scenarioFactory:r,windowProvider:s}=e;let l;const{enableMainWindowPolicyFetch:d}=a.get(A.J.Host);return l=d?new PD(o,i,a,r,s,n):new RD(o,i,a,r,s,t,n),l}}class OD extends xe{constructor(){super(_.Yg.InitPreAuthSettingsEcsProvider,[])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=hm("InitPreAuthSettingsEcsProvider",e,"coreSettings","coreSettingsContext","loggerFactory","scenarioFactory","networkState","clientState","windowProvider","endpointsManager"),{coreSettings:n,coreSettingsContext:i,loggerFactory:a}=t,o=(0,c._T)(t,["coreSettings","coreSettingsContext","loggerFactory"]),{enablePreAuthEcsFetch:r}=n.get(A.J.Core);if(!r)return;const s=i;yield s.initializeEcsProvider(Object.assign({},o))}))}}const LD="preReleaseFeaturesAllowed";class UD extends xe{constructor(){super(_.Yg.InitSettingsClientFiltersProvider,["authenticationService","authenticationUser","config","coreSettings","coreSettingsContext","discover","endpointsManager","localStorage","loggerFactory","platformService","windowProvider"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{authenticationService:t,authenticationUser:n,config:i,coreSettings:a,coreSettingsContext:o,discover:r,endpointsManager:s,localStorage:l,loggerFactory:d,platformService:c,windowProvider:u}=e;let m={};const{enablePreReleaseClientFilter:g}=a.get(A.J.Core);if(g){const e=yield this.getPreReleaseUserInfo({authenticationService:t,authenticationUser:n,config:i,coreSettings:a,endpointsManager:s,localStorage:l,loggerFactory:d,platformService:c,windowProvider:u});m=Object.assign(Object.assign({},m),{preReleaseFeaturesAllowed:e})}const p=o;yield p.initializeClientFiltersProvider(r,m)}))}getPreReleaseUserInfo({authenticationService:e,authenticationUser:t,config:{experienceName:n},coreSettings:i,endpointsManager:a,localStorage:o,loggerFactory:r,platformService:s,windowProvider:l}){var d;return(0,c.mG)(this,void 0,void 0,(function*(){const u=r.newLogger("InitSettingsClientFiltersProviderTask"),{preReleaseFeaturesAllowed:m}=i.get(A.J.Metadata);if(!m)return u.log("No pre release features are allowed."),!1;if(yield function(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){const n=yield hu(e);return!!n&&n.id===t.id}))}(e,t))return u.log(`Returning preReleaseAllowed filter for primary user: ${m}`),!!m;try{const e=o.get(LD);if(null!=e)return u.log(`Cached preReleaseAllowed filter loaded: ${e}`),JSON.parse(e);const d=Em({coreSettings:i,experienceName:n,platformService:s,logger:u,authenticationUser:t}),c=new pg.X(d,"ClientFilters",a,l,r),m=yield c.getConfigurationAsync(),g=this.getValueFromPayload(m,d);return void 0!==g?(u.log(`Storing preReleaseAllowed filter in cache: ${g}`),o.set(LD,g.toString())):u.log("Could not get preReleaseAllowed filter from ECS."),!!g}catch(e){null===(d=u.errorToTelemetry)||void 0===d||d.call(u,(0,Ps.u4)(e),"web_infra_determine_pre_release_filter_failed")}return!1}))}getValueFromPayload(e,t){var n;if(e.requestStatus===Am.m1.Success)return null===(n=t.namespaces)||void 0===n?void 0:n.some((t=>{var n,i;const a=null===(n=e.ecsConfiguration)||void 0===n?void 0:n[t];return!!(null===(i=null==a?void 0:a.metadata)||void 0===i?void 0:i.preReleaseFeaturesAllowed)}))}}class BD extends xe{constructor(){super(_.Yg.InitSettingsEcsProvider,["coreSettings","coreSettingsContext","authenticationService","loggerFactory","scenarioFactory","networkState","clientState","windowProvider","endpointsManager"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{coreSettings:t,coreSettingsContext:n,authenticationService:i,loggerFactory:a,scenarioFactory:o,networkState:r,clientState:s,windowProvider:l,endpointsManager:d}=e,u=n,m=()=>(0,c.mG)(this,void 0,void 0,(function*(){p||(yield u.fetchEcsSettingsIfApplicable())})),{enablePreAuthEcsFetch:g}=t.get(A.J.Core),p=yield this.getPrimaryUser(i,a);yield u.setPrimaryUser(p),g||(yield u.initializeEcsProvider({scenarioFactory:o,networkState:r,clientState:s,windowProvider:l,endpointsManager:d,authenticationUser:p})),yield m()}))}getPrimaryUser(e,t){var n;return(0,c.mG)(this,void 0,void 0,(function*(){let i;try{const t=yield null===(n=e.getCachedUsers)||void 0===n?void 0:n.call(e,{id:(0,Ps.pW)(),scenarioName:ee.RG.AuthWebCachedUser,source:"init-settings-ecs-provider-task"},{isPrimaryUser:!0});t&&t.length>0&&(i=(0,qe.K)(t[0]))}catch(e){t.newLogger("InitSettingsEcsProviderTask").warn("No primary user returned from authentication: ",e)}return i}))}}class WD extends xe{constructor(){super(_.Yg.InitSettingsMaglevHostProvider,["coreSettingsContext","hostCommunicationService"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{coreSettingsContext:t,hostCommunicationService:n}=e,{enableMaglevHostProvider:i}=t.getCoreSettings().get(A.J.Core);i&&(yield t.initializeMaglevHostProvider(n))}))}}class GD extends xe{constructor(){super(_.Yg.SetPrimaryUserOnCoreSettingsTask,["primaryUser","coreSettingsContext"])}execute({primaryUser:e,coreSettingsContext:t}){return(0,c.mG)(this,void 0,void 0,(function*(){return yield t.setPrimaryUser(e),()=>(0,c.mG)(this,void 0,void 0,(function*(){yield t.setPrimaryUser(void 0)}))}))}}var VD,HD,$D,zD;!function(e){e[e.ComposeMessageTyping=0]="ComposeMessageTyping",e[e.MessageListScroll=1]="MessageListScroll",e[e.PowerbarTyping=2]="PowerbarTyping",e[e.VirtualTreeListScroll=3]="VirtualTreeListScroll",e[e.FeedsFilterTyping=4]="FeedsFilterTyping",e[e.PeoplePickerTyping=5]="PeoplePickerTyping",e[e.SearchBoxTyping=6]="SearchBoxTyping",e[e.FloodgatePopup=7]="FloodgatePopup",e[e.ChatListSearchFilterTyping=8]="ChatListSearchFilterTyping",e[e.ChannelListSearchFilterTyping=9]="ChannelListSearchFilterTyping",e[e.CallingPerfSample=10]="CallingPerfSample",e[e.AllChannelSystemMessagesScroll=11]="AllChannelSystemMessagesScroll",e[e.AllPinnedPostsScroll=12]="AllPinnedPostsScroll",e[e.DiscoverSurfaceFeedListScroll=13]="DiscoverSurfaceFeedListScroll",e[e.TeamsAndChannelsTableScroll=14]="TeamsAndChannelsTableScroll",e[e.PostComposeTyping=15]="PostComposeTyping"}(VD||(VD={})),function(e){e.ComposeMessage="composeMessage",e.PostCompose="postCompose",e.MessageList="messageList",e.Powerbar="powerbar",e.VirtualTreeList="virtualTreeList",e.FeedsFilter="feedsFilter",e.PeoplePicker="peoplePicker",e.SearchBox="searchBox",e.Floodgate="floodgate",e.ChatListSearchFilter="chatListSearchFilter",e.ChannelListSearchFilter="channelListSearchFilter",e.CallingPerf="callingPerf",e.TeamsAndChannelsTable="teamsAndChannelsTable",e.DiscoverSurfaceFeedList="discoverSurfaceFeedList",e.AllChannelSystemMessages="channelInfoPaneAllSystemMessages",e.AllPinnedPosts="channelInfoPaneAllPinnedPosts"}(HD||(HD={})),function(e){e.CallingScreen="callingScreen",e.Chat="chat",e.ChannelL1="channelL1",e.ChannelL2="channelL2",e.ChannelSettings="channelSettings",e.ChatList="chatList",e.DialPad="dialpad",e.FeedList="feedlist",e.FlyoutChatList="flyoutChatList",e.GroupChat="groupChat",e.MeetingChat="meetingChat",e.MessageEscalation="messageEscalation",e.NewChat="newChat",e.PeopleSearch="peopleSearch",e.Floodgate="floodgate",e.ChannelList="ChannelList",e.ManageThreadMembers="manageThreadMembers",e.ManageTeams="manageTeams",e.ChannelInvitationsTab="channelInvitationsTab",e.DiscoverSurface="discoverSurface",e.ThreadMembersSearch="threadMembersSearch",e.SharedChannelPendingInvites="sharedChannelPendingInvites",e.PendingJoinRequests="pendingJoinRequests",e.SelectPeoplePickerExtensibility="selectPeoplePickerExtensibility",e.ChannelsTable="channelsTable"}($D||($D={})),function(e){e.HeartbeatMonitor="HeartbeatMonitor",e.CallingPerfMonitor="CallingPerfMonitor"}(zD||(zD={}));const qD="getAndClearAriTelemetry";class JD{constructor(e,t){this.host=e,this.context=t,this.startSlot=0,this.blinkInterval=100,this.trailingTimespan=_.B.second,this.rafRecords=new Map,this.activeUserActionType=void 0,this.userActions=new Map,this.validActions=new Map,this.lastEventTimeSlot=this.startSlot,this.isDebugging=!1,this.strategies=[{name:"TwoRafAndLimitedStopTimeStrategy",lowestAllowedRafs:2,allowStopTimeOverwrite:!0}],this.logger=t.loggerFactory.newLogger("ARI"),this.initializeOnAppLaunchAndReinit(),this.__initTestingMode__(this.context.coreSettings.get(A.J.Host)),this.defaultHost=e}trackEvent(e,t,n,i,a){const o=this.getUserActionType(e,t),{isDebugging:r,logger:s}=this;if(void 0===o||!(o in VD))return void(r&&s.debug(`[${this.formatActionKey(e,t)}] TrackEvent | No action found`));const l=this.getMeasurementName(o),d=i.performance.now();if(r&&s.debug(`[${l} TrackEvent | [${Math.round(n)}...${Math.round(d)}] ${Math.round(d-n)}ms`),void 0===this.activeUserActionType)r&&s.debug(`[${l}] track-start`),this.startMeasurement(o,n,i,a);else if(this.activeUserActionType!==o||this.host!==i||this.actionLocation!==a)r&&s.debug(`[${l}] track-stop`),this.stopMeasurement(i),r&&s.debug(`[${l}] track-start`),this.startMeasurement(o,n,i,a);else{if(r){const e=`[${l}] track-continue`;s.debug(e),function(e,t,n){e.mark(t,n),e.clearMarks(t)}(this.host.performance,e,{startTime:n})}this.continueMeasurement(n)}}handleUnmount(e){this.stopMeasurement(e)}getTelemetry(e=zD.HeartbeatMonitor){return this.getTelemetryFilteredByType(e)}getTelemetryTypeForAction(e){return e===VD.CallingPerfSample?zD.CallingPerfMonitor:zD.HeartbeatMonitor}isActionOfTelemetryType(e,t){return this.getTelemetryTypeForAction(e)===t}getTelemetryFilteredByType(e){void 0!==this.activeUserActionType&&this.isActionOfTelemetryType(this.activeUserActionType,e)&&this.stopMeasurement();const t={};let n=!1;const i={totalIntervalCount:0,passIntervalCount:0};this.userActions.forEach(((a,o)=>{if(void 0!==VD[a.type]&&this.isActionOfTelemetryType(a.type,e)){const e={};a.scores.forEach(((t,n)=>{(e=>{e&&(i.passIntervalCount+=e.passIntervalCount,i.totalIntervalCount+=e.totalIntervalCount)})(t),e[n]=this.getAri(t)})),t[o]=e,n=!0,this.userActions.delete(o),this.isDebugging&&this.logger.debug(`[AppResponsivenessService]: clear action for type ${VD[a.type]}`)}})),t.Total=this.getAri(i);let a="";if(n)try{a=JSON.stringify(t)}catch(e){this.logger.error("[AppResponsivenessService]: unexpected error parsing log object. Likely because of circular reference.")}return a}clearTelemetry(){this.userActions.clear(),this.clearTelemetryTimeoutId&&this.context.windowProvider.clearTimeout(this.clearTelemetryTimeoutId),this.clearTelemetryTimeoutId=this.context.windowProvider.setTimeout((()=>{this.clearTelemetry()}),_.B.tenMinutes,!1)}initializeOnAppLaunchAndReinit(){this.initSettings(),this.registerValidActions(),this.clearTelemetry()}__initTestingMode__(e){if(e){const t=e.userType;t&&t.indexOf("test")>-1&&(this.isDebugging=!0,qD in window||(window.getAndClearAriTelemetry=()=>{const e=this.getTelemetry();return this.clearTelemetry(),e}))}}registerValidActions(){this.validActions.set(this.formatActionKey(HD.Floodgate,_.f_.System),VD.FloodgatePopup),this.validActions.set(this.formatActionKey(HD.ComposeMessage,_.f_.Keyup),VD.ComposeMessageTyping),this.validActions.set(this.formatActionKey(HD.MessageList,_.f_.Scroll),VD.MessageListScroll),this.validActions.set(this.formatActionKey(HD.Powerbar,_.f_.Keyup),VD.PowerbarTyping),this.validActions.set(this.formatActionKey(HD.VirtualTreeList,_.f_.Scroll),VD.VirtualTreeListScroll),this.validActions.set(this.formatActionKey(HD.FeedsFilter,_.f_.Keyup),VD.FeedsFilterTyping),this.validActions.set(this.formatActionKey(HD.PeoplePicker,_.f_.Keyup),VD.PeoplePickerTyping),this.validActions.set(this.formatActionKey(HD.PostCompose,_.f_.Keyup),VD.PostComposeTyping),this.validActions.set(this.formatActionKey(HD.SearchBox,_.f_.Keyup),VD.SearchBoxTyping),this.validActions.set(this.formatActionKey(HD.ChatListSearchFilter,_.f_.Keyup),VD.ChatListSearchFilterTyping),this.validActions.set(this.formatActionKey(HD.ChannelListSearchFilter,_.f_.Keyup),VD.ChannelListSearchFilterTyping),this.validActions.set(this.formatActionKey(HD.CallingPerf,_.f_.Sample),VD.CallingPerfSample),this.validActions.set(this.formatActionKey(HD.DiscoverSurfaceFeedList,_.f_.Scroll),VD.DiscoverSurfaceFeedListScroll),this.validActions.set(this.formatActionKey(HD.AllPinnedPosts,_.f_.Scroll),VD.AllPinnedPostsScroll),this.validActions.set(this.formatActionKey(HD.AllChannelSystemMessages,_.f_.Scroll),VD.AllChannelSystemMessagesScroll),this.validActions.set(this.formatActionKey(HD.TeamsAndChannelsTable,_.f_.Scroll),VD.TeamsAndChannelsTableScroll)}getUserActionType(e,t){const n=this.formatActionKey(t,e);return this.validActions.get(n)}formatActionKey(e,t){return`${e}_${t}`}registerRafCallback(){this.rafCallbackId||(this.rafCallbackId=this.host.requestAnimationFrame((()=>this.measureRaf())))}unregisterRafCallback(){this.rafCallbackId&&(this.host.cancelAnimationFrame(this.rafCallbackId),this.clearRaf())}clearRaf(){this.rafCallbackId=void 0,this.rafRecords.clear()}getAri(e){return e&&0!==e.totalIntervalCount?Math.round(e.passIntervalCount/e.totalIntervalCount*_.B.second)/_.B.second:0}initSettings(){const{enableAriDebugging:e,appResponsivenessConstants:t}=this.context.coreSettings.get(A.J.Telemetry),n=this.context.coreSettings.get(A.J.Host).showScenarioStepsInPerfTrace||this.context.coreSettings.get(A.J.Core).showScenarioStepsInPerfTrace;this.isDebugging=e||n||!1,this.blinkInterval=t&&t.blinkInterval||100,this.trailingTimespan=t&&t.trailingTimespan||_.B.second}startMeasurement(e,t,n,i){this.assignHost(n),this.actionLocation=i,this.activeUserActionType=e,this.eventStartTime=t||this.host.performance.now(),this.lastEventTimeSlot=this.getTimeSlot(this.eventStartTime);const a=this.getMeasurementName(e);if(this.isDebugging){const e=`[${a}] START`,t=`${e} | ${this.host.performance.now()} | Event: ${this.eventStartTime}`;this.host.performance.mark(e,{startTime:this.eventStartTime}),this.logger.debug(t)}this.registerRafCallback();let o=this.userActions.get(a);void 0===o&&(o={scores:new Map,startTime:this.startSlot,type:e},this.userActions.set(a,o)),o.startTime=this.eventStartTime}stopMeasurement(e=this.host){if(void 0===this.activeUserActionType)return;const t=this.getMeasurementName(this.activeUserActionType),n=this.userActions.get(t);if(void 0!==n){if(this.isDebugging){const e=`[${t}] END`;this.host.performance.mark(e),this.logger.debug(`${e} | ${this.host.performance.now()}`)}this.finalizeMeasurement(n)}this.unregisterRafCallback(),this.activeUserActionType=void 0,this.actionLocation=void 0,e===this.host&&this.assignHost(this.defaultHost)}continueMeasurement(e){this.lastEventTimeSlot=this.getTimeSlot(e)}finalizeMeasurement(e,t){this.strategies.forEach((n=>{const i=t&&n.allowStopTimeOverwrite?t:this.getCurrentTimeSlot(),a=this.getResponsivenessScore(this.startSlot,i,n),o=e.scores.get(n.name);o?(o.passIntervalCount+=a.passIntervalCount,o.totalIntervalCount+=a.totalIntervalCount):e.scores.set(n.name,{totalIntervalCount:a.totalIntervalCount,passIntervalCount:a.passIntervalCount});const r=(a.passIntervalCount/a.totalIntervalCount).toFixed(2);if(this.logger.log(`[${this.getMeasurementName(e.type)}] duration: ${Math.round(this.host.performance.now()-e.startTime)}ms measurement: ${a.passIntervalCount}/${a.totalIntervalCount} (${r})`),this.isDebugging){const t=this.getMeasurementName(e.type),n={name:t,pass:a.passIntervalCount,total:a.totalIntervalCount,result:r},i=`ari-measurement => ${JSON.stringify(n)}`,o=`[${t}] START`,s=`[${t}] END`;Jc(this.host.performance,i,o,s)}}))}measureRaf(){const e=this.getCurrentTimeSlot();let t=this.rafRecords.get(e);void 0===t?t=1:t++,e-this.lastEventTimeSlot>=this.trailingTimespan?this.stopMeasurement():(this.rafRecords.size>1e3&&(this.stopMeasurement(),this.rafRecords.clear()),this.rafRecords.set(e,t),this.rafCallbackId=this.host.requestAnimationFrame((()=>this.measureRaf())))}getCurrentTimeSlot(){const e=this.host.performance.now();return this.getTimeSlot(e)}getTimeSlot(e){const t=void 0!==this.eventStartTime?e-this.eventStartTime:-1;return t<0?-1:Math.floor(t/this.blinkInterval)*this.blinkInterval}getResponsivenessScore(e,t,n){let i=0,a=0;for(;e<t;){const t=this.rafRecords.get(e);this.isDebugging&&this.logger.debug(`${e}: ${void 0===t?0:t}`),a+=void 0!==t&&t>=n.lowestAllowedRafs?1:0,i++,e+=this.blinkInterval}return{passIntervalCount:a,totalIntervalCount:i}}assignHost(e){this.host=e}getMeasurementName(e){let t=VD[e];return this.actionLocation&&(t+=`-${this.actionLocation}`),t}}class QD{constructor(e){var t,n;if(this.context=e,null===(t=this.context.host)||void 0===t?void 0:t.performance){this.deprecatedNavigationTiming=this.context.host.performance.timing,this.navigationStart=null===(n=this.deprecatedNavigationTiming)||void 0===n?void 0:n.navigationStart;const e=this.context.host.performance.getEntriesByType("navigation");e&&e[0]&&(this.navigationTiming=e[0]),this.init()}}get altScenario(){return this._altScenario}get clientStartScenario(){return this._clientStartScenario}markCoreInitSteps(){const e=this.context.host.performance.getEntriesByType("mark");e&&this.navigationStart&&(this._altScenario&&this.processCoreInitPerfMarks(this._altScenario,this.navigationStart,e),this._clientStartScenario&&(this._clientStartScenario.appendEventData({scenarioPhase:Ou.Core}),this.processCoreInitPerfMarks(this._clientStartScenario,this.navigationStart,e)))}processCoreInitPerfMarks(e,t,n){const i=n;for(const n of i)switch(n.name){case`${k}${_.sM.Initialization}`:e.mark(ee.ck.PreCoreInitializationTasks,{overrideTimestamp:Math.round(n.startTime)+t});continue;default:n.name.startsWith(C)&&e.mark(n.name.replace("_end_","_"),{overrideTimestamp:Math.round(n.startTime)+t})}}markAltExpLoaderSteps(e,t){this.markNavigationSteps(e,t);const n=this.context.host.performance.getEntriesByName("start-execute-main-bundle","mark");n&&n[0]&&e.mark(ee.ck.MainBundleDownloadParse,{overrideTimestamp:Math.round(n[0].startTime)+t})}markClientStartExpLoaderSteps(e,t){e.appendEventData({scenarioPhase:Ou.ExpLoader}),this.markNavigationSteps(e,t);const n=[LA.IndexPageStart,LA.CoreModuleLoaded,LA.NotifyDesktop,LA.ConfigLoaded,LA.MainChunksLoadingStart,LA.MainChunksLoadingStop,LA.IndexPageStop,ee.ck.MainBundleDownloadParse,"start-execute-main-bundle"],i=this.context.host.performance.getEntriesByType("mark");i&&i.filter((e=>n.includes(e.name)||e.name.startsWith("exp_loader_err_"))).forEach((n=>{e.mark(n.name,{overrideTimestamp:Math.round(n.startTime)+t})}))}markNavigationSteps(e,t){var n,i,a,o;(null===(n=this.navigationTiming)||void 0===n?void 0:n.workerStart)&&e.mark(ee.ck.IndexServiceWorkerStartup,{overrideTimestamp:t+Math.round(this.navigationTiming.workerStart)}),(null===(i=this.deprecatedNavigationTiming)||void 0===i?void 0:i.fetchStart)&&e.mark(ee.ck.IndexFetchIPC,{overrideTimestamp:this.deprecatedNavigationTiming.fetchStart}),(null===(a=this.deprecatedNavigationTiming)||void 0===a?void 0:a.requestStart)&&e.mark(ee.ck.IndexFetchIPCWait,{overrideTimestamp:this.deprecatedNavigationTiming.requestStart}),(null===(o=this.deprecatedNavigationTiming)||void 0===o?void 0:o.responseStart)&&e.mark(ee.ck.IndexFetchProcessing,{overrideTimestamp:this.deprecatedNavigationTiming.responseStart})}init(){var e,t;this.navigationStart&&(this._altScenario=null===(e=this.context.scenarioFactory)||void 0===e?void 0:e.newScenario(ee.RG.ApplicationLaunchTime,{startTime:this.navigationStart}),this._clientStartScenario=null===(t=this.context.scenarioFactory)||void 0===t?void 0:t.newScenario(ee.RG.ClientStart,{startTime:this.navigationStart}),this._altScenario&&this.markAltExpLoaderSteps(this._altScenario,this.navigationStart),this._clientStartScenario&&this.markClientStartExpLoaderSteps(this._clientStartScenario,this.navigationStart),this.markCoreInitSteps())}}class KD{constructor(e,t){this.isScenarioMemorySnapshotEnabled=e,this.globalWindow=t,this.cachedMemoryData={},this.cacheToExpireTime=0}snapshotMemoryUsage(){return this.isScenarioMemorySnapshotEnabled?(this.cacheToExpireTime<Date.now()&&this.snapshot(),this.cachedMemoryData):{}}snapshotMemoryUsageAsync(){if(!this.isScenarioMemorySnapshotEnabled)return Promise.resolve({});if(this.ongoingPromise)return this.ongoingPromise;const e=this.cacheToExpireTime-Date.now();return e>0?(this.ongoingPromise=new Promise((t=>{this.globalWindow.setTimeout((()=>{this.snapshot(),t(this.cachedMemoryData),this.ongoingPromise=void 0}),e)})),this.ongoingPromise):(this.snapshot(),Promise.resolve(this.cachedMemoryData))}snapshot(){this.cachedMemoryData={jsHeapStatistics:this.globalWindow.envPerformance.getJSHeapStatistics()||this.cachedMemoryData.jsHeapStatistics,processMemoryInfo:this.globalWindow.envPerformance.getProcessMemoryInfo()||this.cachedMemoryData.processMemoryInfo},this.cacheToExpireTime=Date.now()+3e4}}var YD=n(81328),XD=n(67929);class ZD{constructor(e){this.eventTimeTracker=CE(e&&e>0?e:100)}markResponse(e){return this.eventTimeTracker.markEvent(e)}getResponsesBetweenStartAndLast(e){return this.eventTimeTracker.getEventsBetweenStartAndLast(e)}getResponsesBetween(e,t){return this.eventTimeTracker.getEventsBetween(e,t)}}const eF=e=>{var t;const{apolloLeakInfoViewportContext:n,apolloLeakInfoEntityType:i=""}=null!==(t=e.apolloLeakInfo)&&void 0!==t?t:{};return n===ft.R.primary?`main:${i}`:i},tF=e=>e.reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{});class nF{constructor(e,t,n,i){this.coreSettings=e,this.leakDetectorService=t,this.userTrackingService=n,this.shouldCollectStats=i,this.measurementTimeOverflow=!1,this.resultMeasurementTimeOverflow=!1,this.isLeakingUser=e=>e&&this.userTrackingService&&!this.userTrackingService.has(e);const{apolloCacheStatsThrottleTime:a,logCdlOperationsDuringWaitSettings:o}=e.get(A.J.Core);var r;this.getTelemetry=a?(0,Z.throttle)((()=>this.getTelemetryInternal()),a,{leading:!0,trailing:!1}):this.getTelemetryInternal,o&&(o.enableTrackingCdlOperationsDuringWait||o.enableLoggingCdlOperationsDuringWait)&&(this.cdlResponseTracker=(r=o.trackingCdlOperationsDuringWaitBufferSize,new ZD(r)))}getTelemetryInternal(){var e,t,n,i,a,o;const{enableApolloCacheStats:r,enableApolloCacheSizeStats:s,enableApolloResultCacheSizeStats:l,enableApolloDataEviction:d}=this.coreSettings.get(A.J.Core);if(!r)return;const c=null!==(t=null===(e=this.leakDetectorService)||void 0===e?void 0:e.getReachableObjects(Po.I.DataClient).size)&&void 0!==t?t:0,u=Array.from(null!==(i=null===(n=this.leakDetectorService)||void 0===n?void 0:n.getReachableObjects(Po.I.ApolloCache))&&void 0!==i?i:[]),m=[...Array.from(null!==(o=null===(a=this.leakDetectorService)||void 0===a?void 0:a.getReachableObjects(Po.I.UnwrappedWindow))&&void 0!==o?o:[]).map((e=>{var t;return null===(t=e.windowLeakInfo)||void 0===t?void 0:t.windowLeakInfoWindowId})).filter((e=>!!e)),_.ew],g=e=>!e||!m.includes(e),p=u.filter((e=>{const{apolloLeakInfo:{apolloLeakInfoWindowId:t}={}}=e;return g(t)})),h=this.getLeakedUserCaches(u),v=u.map(eF),S=p.map(eF),f=s&&!this.measurementTimeOverflow&&this.shouldCollectStats(),y=l&&!this.resultMeasurementTimeOverflow&&this.shouldCollectStats(),k={clientsCount:c,cacheCount:u.length,allEntityTypes:Array.from(new Set(v)),entityTypeStats:tF(v),leakedCacheCount:S.length,leakedEntityTypes:Array.from(new Set(S)),leakedEntityTypeStats:tF(S),leakedUserCachesCount:h.length,caches:u.map((e=>{const{apolloLeakInfo:{apolloLeakInfoWindowId:t,apolloLeakInfoEntityType:n,apolloLeakInfoViewportContext:i}={}}=e,a={windowId:t,isLeaking:g(t),entityType:n,viewportContext:i};if(f){const{cacheSize:t,measuringTime:n}=(0,YD.T)(e);a.cacheSize=t,a.measuringTime=n}if(y){const{cacheSize:t,measuringTime:n}=(0,XD.TP)(e);a.resultCacheSize=t,a.resultMeasuringTime=n}return a})),enableApolloDataEviction:null!=d?d:void 0},C=k.caches.reduce(((e,t)=>({cacheSize:void 0===t.cacheSize||void 0===e.cacheSize?void 0:e.cacheSize+t.cacheSize,measuringTime:void 0===t.measuringTime||void 0===e.measuringTime?void 0:e.measuringTime+t.measuringTime,resultCacheSize:void 0===t.resultCacheSize||void 0===e.resultCacheSize?void 0:e.resultCacheSize+t.resultCacheSize,resultMeasuringTime:void 0===t.resultMeasuringTime||void 0===e.resultMeasuringTime?void 0:e.resultMeasuringTime+t.resultMeasuringTime})),{cacheSize:0,measuringTime:0,resultCacheSize:0,resultMeasuringTime:0});return C.measuringTime&&C.measuringTime>500&&(this.measurementTimeOverflow=!0),C.resultMeasuringTime&&C.resultMeasuringTime>500&&(this.resultMeasurementTimeOverflow=!0),Object.assign(Object.assign({},k),C)}unthrottle(){"function"==typeof this.getTelemetry.cancel&&this.getTelemetry.cancel()}markResponse(e){var t;null===(t=this.cdlResponseTracker)||void 0===t||t.markResponse(e)}getResponsesBetweenStartAndLast(e){var t;return(null===(t=this.cdlResponseTracker)||void 0===t?void 0:t.getResponsesBetweenStartAndLast(e))||[]}getResponsesBetween(e,t){var n;return(null===(n=this.cdlResponseTracker)||void 0===n?void 0:n.getResponsesBetween(e,t))||[]}getLeakedUserCaches(e){return e.filter((e=>{const{apolloLeakInfo:{apolloLeakInfoUserContextId:t}={}}=e;return this.isLeakingUser(t)}))}}const iF={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]},aF=(e,t,n)=>{const i=void 0!==e[t]||Object.keys(e).length<n?t:"other";return e[i]=(e[i]||0)+1,i},oF=new Set([Ie.p.breakoutroomspanel,Ie.p.calendar,Ie.p.callablechannels,Ie.p.callsmain,Ie.p.chats,Ie.p.channels,Ie.p.schedulingform,Ie.p.search,Ie.p.store,Ie.p.transcriptcontent]);var rF;!function(e){e.mainActive="mainActive",e.mainContentRecord="mainContentRecord"}(rF||(rF={}));class sF{constructor(e){this.entityTypeLimit=e,this.active={},this.record={},this.allEntityTypes=new Set,this.usedEntityTypes=new Set,this.activeWindowIds=new Set}update(e,t){Object.keys(this.active).forEach((e=>{this.active[e]=0})),this.activeWindowIds.clear(),e.forEach((e=>{const n=e.activeEntities.mainEntity.type;this.allEntityTypes.add(n),this.activeWindowIds.add(e.id),aF(this.active,n,this.entityTypeLimit),oF.has(n)&&this.usedEntityTypes.add(n),!this.isFirstUse(n)&&this.wasInPreviousUpdate(e,t)||aF(this.record,n,this.entityTypeLimit)}))}getStats(){return{mainActive:this.active,mainContentRecord:this.record,allEntityTypes:Array.from(this.allEntityTypes),usedEntityTypes:Array.from(this.usedEntityTypes),activeWindowIds:Array.from(this.activeWindowIds)}}isFirstUse(e){return!this.record[e]}wasInPreviousUpdate(e,t){const n=t.find((t=>t.id===e.id));return!!n&&n.activeEntities.mainEntity.type===e.activeEntities.mainEntity.type&&n.activeEntities.mainEntity.id===e.activeEntities.mainEntity.id&&n.correlation.id===e.correlation.id}}const lF=new Set([Ie.p.calls,Ie.p.chats,Ie.p.channels,Ie.p.extensions,Ie.p.schedulingform]);var dF;!function(e){e.popOutActive="popOutActive",e.popOutRecord="popOutRecord"}(dF||(dF={}));class cF{constructor(e){this.entityTypeLimit=e,this.active={},this.record={},this.allEntityTypes=new Set,this.usedEntityTypes=new Set,this.activeWindowIds=new Set}update(e,t){Object.keys(this.active).forEach((e=>{this.active[e]=0})),this.activeWindowIds.clear(),e.forEach((e=>{const n=e.activeEntities.mainEntity.type;this.allEntityTypes.add(n),this.activeWindowIds.add(e.id),aF(this.active,n,this.entityTypeLimit),lF.has(n)&&this.usedEntityTypes.add(n),!this.isFirstUse(n)&&this.wasInPreviousUpdate(e,t)||aF(this.record,n,this.entityTypeLimit)}))}getStats(){return{popOutActive:this.active,popOutRecord:this.record,allEntityTypes:Array.from(this.allEntityTypes),usedEntityTypes:Array.from(this.usedEntityTypes),activeWindowIds:Array.from(this.activeWindowIds)}}isFirstUse(e){return!this.record[e]}wasInPreviousUpdate(e,t){const n=t.find((t=>t.id===e.id));return!!n&&n.activeEntities.mainEntity.type===e.activeEntities.mainEntity.type}}const uF=e=>Object.keys(e).reduce(((t,n)=>t+e[n]),0),mF=(e,t)=>{const n=Array.from(e).filter((e=>{var n;return!(null===(n=e.windowLeakInfo)||void 0===n?void 0:n.windowLeakInfoWindowId)||!t.includes(e.windowLeakInfo.windowLeakInfoWindowId)})).map((e=>{var t;const{windowLeakInfoEntityType:n=""}=null!==(t=e.windowLeakInfo)&&void 0!==t?t:{};return e.viewportContext===ft.R.primary?`main:${n}`:n}));return{allEntityTypes:Array.from(new Set(n)),memActive:n.reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{})}};class gF{constructor({client:e,leakDetectorService:t,entityTypeStatsLimit:n}){this.isBackInMain=!1,this.main=new sF(null!=n?n:20),this.popOut=new cF(null!=n?n:20),this._activeWindowsSubscription=_e(e.watchQuery({query:iF})).pipe((0,S.h)((({errors:e,loading:t})=>void 0===e&&!t)),(0,h.U)((({data:{activeWindows:e}})=>(this.isBackInMain=e.some((e=>e.id===_.ew)),e))),(0,An.G)()).subscribe((([e,t])=>{this.update(e,t)})),this.leakDetectorService=t}destroy(){this._activeWindowsSubscription.unsubscribe()}getStats(){var e,t,n;const i=null===(e=this.leakDetectorService)||void 0===e?void 0:e.getReachableObjects(Po.I.UnwrappedWindow),a=this.main.getStats(),{activeWindowIds:o}=a,r=(0,c._T)(a,["activeWindowIds"]),s=this.popOut.getStats(),{activeWindowIds:l}=s,d=(0,c._T)(s,["activeWindowIds"]),u=uF(d.popOutActive),m={backInMain:this.isBackInMain?{allEntityTypes:r.allEntityTypes,usedEntityTypes:r.usedEntityTypes,backInMainActive:r.mainActive,backInMainActiveCount:uF(r.mainActive),backInMainContentRecord:r.mainContentRecord}:void 0,t2main:this.isBackInMain?void 0:{allEntityTypes:r.allEntityTypes,usedEntityTypes:r.usedEntityTypes,t2MainActive:r.mainActive,t2MainActiveCount:uF(r.mainActive),t2MainContentRecord:r.mainContentRecord},popOut:Object.assign(Object.assign({},d),{popOutActiveCount:u,hasActivePopout:u>0}),windowCount:null==i?void 0:i.size,inMem:i?mF(i,[...o,...l]):void 0,windows:i?Array.from(i).map((e=>{var t;const{windowLeakInfoEntityType:n,windowLeakInfoWindowId:i}=null!==(t=e.windowLeakInfo)&&void 0!==t?t:{};return{windowLeakInfoWindowId:i,windowLeakInfoEntityType:n,viewportContext:e.viewportContext}})):void 0};return Object.assign(Object.assign({},m),{windowLeaks:void 0===m.windowCount?void 0:m.windowCount-(null!==(n=null===(t=m.t2main)||void 0===t?void 0:t.t2MainActiveCount)&&void 0!==n?n:0)-m.popOut.popOutActiveCount})}update(e,t){this.main.update(t.filter((e=>e.isMainWindow)),e.filter((e=>e.isMainWindow))),this.popOut.update(t.filter((e=>!e.isMainWindow)),e.filter((e=>!e.isMainWindow)))}}class pF{constructor(e){this.context=e,this.inited=!1,this.logger=e.loggerFactory.newLogger("WindowTrackerService")}init(){var e;if(!this.inited){const{client:t,leakDetectorService:n,coreSettings:i}=this.context,a=(null!==(e=this.logger.errorToTelemetry)&&void 0!==e?e:this.logger.error).bind(this.logger);if(t){this.inited=!0;try{this.windowEntityTypeStats=new gF({client:t,leakDetectorService:n,entityTypeStatsLimit:null==i?void 0:i.get(A.J.Core).entityTypeStatsLimit})}catch(e){a("Failed to initialize WindowEntityTypeStats","webclient_framework_window_tracker_service")}}else a("Failed to initialize WindowEntityTypeStats - missing client","webclient_framework_window_tracker_service")}}getTelemetry(){var e;return this.inited||this.init(),null===(e=this.windowEntityTypeStats)||void 0===e?void 0:e.getStats()}}function hF(e,t){const n=e.location.hostname;return t&&t!==n}var vF=n(63945);function SF(e,t,n,i,a,o){const r=o&&o.delta||0,s=function(e,t,n){let i;switch(e){case"share-to-teams":i=function(e,t){let n;if(t.performance&&t.performance.navigation&&0===t.performance.navigation.type){const{s:i}=e.getSearchState();if(i)n=parseInt(i,10);else{const e="outlook"===t.document.head.dataset.host,i=t.localStorage.getItem(vF.qB.STT_START_TIME);e&&i&&(n=parseInt(i,10),t.localStorage.removeItem(vF.qB.STT_START_TIME))}}return n}(t,n)}return i}(e,i,a),l=s?{name:ee.ck.ClickTimeAction,timestamp:n-r}:void 0,d=l?[l]:[];o&&d.push({name:o.name,timestamp:n});const c=s||n-r,u=t.newScenario(ee.RG.ExperienceReady,{startTime:c});d.forEach((e=>{u.mark(e.name,{overrideTimestamp:e.timestamp})}))}function fF(e,t,n,i,a,o,r={cached:!1}){const s={name:e,delta:0},l=qc(e,t,n,i.performance,o);return void 0!==l&&(s.delta=l,a.createScenarioWithoutStarting(e).stop({delta:l,cached:r.cached})),s}var yF=n(55097);class kF{constructor(e){this.telemetrySettings=null,this.disableColumnBlocker=!1,this.fixedColumnRules={},this.blockedColumnRules={},this.columnBlockingRules={},this.wildCardMergedTables={},this.wildCardTableEmpty=!0,this.updateColumnBlockingSettings=e=>{if(e){if(this.telemetrySettings=e,this.disableColumnBlocker=e.disableColumnBlocker||!1,this.disableColumnBlocker)return this.columnBlockingRules={},this.wildCardMergedTables={},void(this.wildCardTableEmpty=!0);let t={};e.blockedColumnRules&&(t=e.blockedColumnRules),this.blockedColumnRules=t;let n={};e.fixedColumnRules&&(n=e.fixedColumnRules),this.fixedColumnRules=n,this.generateRuleSet()}};e.getObservable(A.J.Telemetry).subscribe(this.updateColumnBlockingSettings),this.telemetrySettings=e.get(A.J.Telemetry),this.updateColumnBlockingSettings(this.telemetrySettings)}isContextColumnOk(e){return(0,Z.isEmpty)(this.columnBlockingRules)||(0,Z.isEmpty)(this.columnBlockingRules["*"])||(0,Z.isEmpty)(this.columnBlockingRules["*"]["*"])||!this.columnBlockingRules["*"]["*"][e]}applyColumnBlockingRules(e,t,n,i){try{if(this.wildCardTableEmpty||this.wildCardMergedTables[e]||(this.columnBlockingRules[e]=(0,Z.merge)(this.columnBlockingRules[e],this.columnBlockingRules["*"]),this.wildCardMergedTables[e]=!0),(0,Z.isEmpty)(this.columnBlockingRules[e]))return;(0,Z.isEmpty)(this.columnBlockingRules[e][t])?(0,Z.isEmpty)(this.columnBlockingRules[e]["*"])||this.blockEventPropertyColumn(this.columnBlockingRules[e]["*"],n,i):this.blockEventPropertyColumn(this.columnBlockingRules[e][t],n,i)}catch(e){return void n.setProperty("diagBlockedColumns",(0,R.XC)({parseFailed:!0}))}}blockEventPropertyColumn(e,t,n){const i=t.properties,a={},o=null==n?void 0:n.packedData;(0,Z.forEach)(e,((e,t)=>{(0,Z.isEmpty)(i[t])||(i[t].value="",a[t]=e),o&&o.forEach((n=>{n[t]&&(n[t]=void 0,a[t]=e)}))})),(0,Z.isEmpty)(a)||t.setProperty("diagBlockedColumns",(0,R.XC)(a))}generateRuleSet(){try{this.columnBlockingRules={},this.wildCardMergedTables={};const e=this.blockedColumnRules["*"],t=this.fixedColumnRules["*"];(0,Z.forEach)(this.blockedColumnRules,((n,i)=>{if((0,Z.isEmpty)(n))return;(0,Z.isEmpty)(e)||"*"===i||(n=(0,Z.merge)(n,e));!(0,Z.isEmpty)(this.fixedColumnRules)&&!(0,Z.isEmpty)(this.fixedColumnRules[i])&&!(0,Z.isEmpty)(t)&&"*"!==i&&(this.fixedColumnRules[i]=(0,Z.merge)(this.fixedColumnRules[i],t)),this.columnBlockingRules[i]={};const a={};(0,Z.isEmpty)(n["*"])||this.mergeBlockedColumnsRulesForAllEventType(n,i,a),(0,Z.isEmpty)(a)||(this.columnBlockingRules[i]["*"]=a),this.mergeBlockedColumnsRulesForEveryEventType(n,i,a),(0,Z.isEmpty)(this.columnBlockingRules[i])?delete this.columnBlockingRules[i]:this.wildCardMergedTables[i]=!0})),this.wildCardTableEmpty=(0,Z.isEmpty)(this.columnBlockingRules["*"])}catch(e){return}}mergeBlockedColumnsRulesForAllEventType(e,t,n){(0,Z.forEach)(e["*"],((e,i)=>{e>(this.fixedColumnRules[t]&&this.fixedColumnRules[t]["*"]&&this.fixedColumnRules[t]["*"][i]||0)&&(n[i]=e)}))}mergeBlockedColumnsRulesForEveryEventType(e,t,n){(0,Z.forEach)(e,((e,i)=>{"*"!==i&&((0,Z.isEmpty)(this.fixedColumnRules[t])||(0,Z.isEmpty)(this.fixedColumnRules[t][i])?this.columnBlockingRules[t][i]=(0,Z.merge)(e,n):(this.columnBlockingRules[t][i]={},(0,Z.forEach)(e,((e,n)=>{e>(this.fixedColumnRules[t][i][n]||0)&&(this.columnBlockingRules[t][i][n]=e)})),this.columnBlockingRules[t][i]=(0,Z.merge)(this.columnBlockingRules[t][i],n),(0,Z.isEmpty)(this.columnBlockingRules[t][i])&&delete this.columnBlockingRules[t][i]))}))}}var CF=n(21643),bF=n(53818);const TF="Teams",wF=/(windows|win32)/i,_F=/ arm;/i,IF=/windows\sphone\s\d+\.\d+/i,AF=/(macintosh|mac os x|mac)/i,NF=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,EF=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,DF=/android/i,FF=(e,t)=>{var n,i;if(t){const a=null!==(n=e.get(A.J.Telemetry).workerEnabled)&&void 0!==n&&n,o=null!==(i=e.get(A.J.Telemetry).enableSharedWorker)&&void 0!==i&&i,r=a?o?"shared":"dedicated":"embed",{coreSecurityService:s,windowBaseUrl:l}=t,d=s.getTrustedTypePolicy("@msteams/core-services-telemetry-worker#TelemetryWorker");return{workerType:r,workerUrlCallback:e=>d.createScriptURL(e,l)}}return{workerType:"embed",workerUrlCallback:e=>e}},PF=(e,t,n)=>{yF.H.getInstance().initialize(t);const i=new kF(t);return le.ip.getInstance().initialize(e,n),{eventSuppression:yF.H.getInstance(),columnSuppression:i,telemetrySender:le.ip.getInstance()}},MF=(e,t,n,i)=>{var a;const{clientType:o,userAgent:r}=n.config,{deviceId:s,sessionId:l,sessionStartTime:d}=n.host,c=i.get(A.J.Telemetry),{defaultToken:u,enableSharedWorker:m,isSilent:g,telemetryServer:p,enableCustomCacheSize:h,eventsLimitInMem:v,normalPrioritySendTimeInSecs:S,highPrioritySendTimeInSecs:f,autoFlushPercent:y,enableOneDsSdkNs:k,oneDsCollectorUrl:C,enableCompression:b,enablePrivacyGuard:T,enableLoggingGlobalDeviceId:w,privacyGuardIngestionToken:I,disableMTMAPrimaryId:N,debugMenuCaptureContext:E,debugMenuCaptureEvents:D}=c,{sharedWorkerUrl:F}=i.get(A.J.Host),P=null===(a=null==i?void 0:i.get(A.J.Core))||void 0===a?void 0:a.enableMTMA;if(!p||!u)throw t.error("Telemetry server url or app token not supplied. This is required by Aria"),(0,he.Tr)("telemetry-initialization",_.jK.Undefined,"init");const M=(e=>{let t=e;return t||(t=(0,Je.v4)()),t})(s),j=e.windowType!==bF.N.Anglr?"NS":"",R={userAgent:r,firstLaunchTime:e.appStartTime,tablePostfix:j,deviceId:M},x={debugMenuCaptureContext:!!E,debugMenuCaptureEvents:!!D},O=new CF.Mk;return O.collectorUrl=p,h&&v&&(O.eventsLimitInMem=v),{config:O,appTokens:{default:u},documentInfo:R,debugMenuSettings:x,isSilent:!!g,sessionId:l||void 0,sessionStartTime:d,clientType:o,sharedWorkerUrl:F||void 0,enableSharedWorker:!!m,eventsLimitInMem:v||3e3,normalPrioritySendTimeInSecs:S||15,highPrioritySendTimeInSecs:f||15,autoFlushPercent:y||.33,enableOneDsSdkNs:!!k,oneDsCollectorUrl:C||void 0,enableCompression:!!b,enablePrivacyGuard:!!T,enableLoggingGlobalDeviceId:!!w,privacyGuardIngestionToken:I||void 0,enableMTMA:P||void 0,disableMTMAPrimaryId:!!N}},jF=(e,t,n,i,a,o,r,s,l)=>{var d;const{browser:c,browserVersion:u,clientContext:m,clientType:g,clientVersion:p,osPlatform:h,osVersion:v,platformId:S}=n.config,{bootType:f,panelContext:y,sessionId:k,startReason:C}=n.host,b=i.get(A.J.Telemetry),{defaultToken:T,telemetryServer:w,disableRingNamePrefixing:I,disablePlatformServiceOsVersion:N}=b,E=i.get(A.J.Metadata),{hostAppWebVersion:D}=i.get(A.J.Host);if(!w||!T)throw t.error("Telemetry server url or app token not supplied. This is required by Aria"),(0,he.Tr)("telemetry-initialization",_.jK.Undefined,"init");const F=E.environment===bt.s.life?Es.OV.Life:Es.OV.Work,P=fE(E,RF(!!I,e,o),l).ring,M=WF(a.userAgent),j=VF(a.userAgent),R=HF(!!b.enableRegexRemoval,h),x=$F(h),O=qF();r.setContext("AppInfo.ClientType",null!==(d=e.clientTypeTelemetry)&&void 0!==d?d:g),r.setContext("AppInfo.ClientContext",m),r.setContext("AppInfo.HostAppVersion",M),r.setContext("AppInfo.ProcessArchitecture",j),r.setContext("AppInfo.WebVersion",D),D&&r.setContext("AppInfo.HostAppWebVersion",BF(D)),r.setContext("AppInfo.Language",s.localeCode),r.setContext("AppInfo.Locale",s.localeCode),r.setContext("AppInfo.PlatformId",S);const L=GF(p,D);b.enableEnhancedTelemetry?r.setContext("AppInfo.Version",L):r.setContext("AppInfo.Version",p),r.setContext("AppInfo.VersionNew",L),r.setContext("AppInfo.ReactAppVersion",p),r.setContext("AppInfo.ExperienceName",e.experienceName),r.setContext("DeviceInfo.OsName",x),N||r.setContext("DeviceInfo.OsVersion",v),r.setContext("DeviceInfo.OsFamily",R),r.setContext("EventInfo.isNS",!0),r.setContext("Panel.Context",y),r.setContext("Session.Id",k),r.setContext("startReason",C),r.setContext("UserInfo.Language",s.userLanguage),r.setContext("UserInfo.Ring",P),r.setContext("UserInfo.TimeZone",O),r.setContext("userAgent",a.userAgent),r.setContext("Window.Type",e.windowType),r.setContext("DeviceInfo.BrowserName",c),r.setContext("DeviceInfo.BrowserVersion",u),r.setContext("DeviceInfo.Id",a.deviceId),r.setContext("Tenant.Model",F),r.setContext("Session.TelemetryContext","web"),r.setContext("AppInfo.BootType",f),r.setContext("UserInfo.UserLocale",s.originLocaleCode),r.setContext("UserInfo.OSorBrowserLocale",Fo.Bh.Desktop===g||Fo.Bh.Maglev===g?s.osLocale:s.userLanguage),r.setContext("telemetryRegionFetchComplete",b.telemetryRegionFetchComplete),r.setContext("UserInfo.TelemetryRegion",b.telemetryRegion),xF(i,r,e,o,l),OF(i,r),LF(L,i,r)},RF=(e,t,n)=>!(!n||"react-web-client"!==t.experienceName)||e,xF=(e,t,n,i,a)=>{const o=e.getObservable(A.J.Metadata),{disableRingNamePrefixing:r}=e.get(A.J.Telemetry);if(o.subscribe((e=>{null==a||a.updateWebExperimentConfigMetadata(e),null==a||a.communicateWithHost();const o=fE(e,RF(!!r,n,i),a);t.setContext("UserInfo.Ring",o.ring),t.setContext("UserInfo.ETag",o.eTag),t.setContext("UserInfo.HostETag",o.hostETag),t.setContext("AppInfo.ExpIds",o.expIds),t.setContext("AppInfo.Environment",o.environment)})),a){a.ecmObservable.subscribe((e=>{const n=e.find((e=>e.client===hE)),i=e.map((e=>e.config.expIds)).filter((e=>e.length>0)).join(",");t.setContext("UserInfo.HostETag",null==n?void 0:n.config.eTag),t.setContext("AppInfo.ExpIds",i)}))}},OF=(e,t)=>{e.getObservable(A.J.UserResources).subscribe((e=>{const n=e.licenseType||void 0;t.setContext("UserInfo.LicenseType",n)}))},LF=(e,t,n)=>{t.getObservable(A.J.Host).subscribe((i=>{i&&UF(e,t,n,i)}))},UF=(e,t,n,i)=>{const{enableEnhancedTelemetry:a,enableGetUserTypeFromHost:o}=t.get(A.J.Telemetry),r=i.desktopVersion||void 0,s=r?e.concat(",",r):e;r&&n.setContext("AppInfo.DesktopVersion",r),n.setContext("AppInfo.VersionNew",s),i.systemManufacturer&&n.setContext("DeviceInfo.Make",i.systemManufacturer),i.systemProductName&&n.setContext("DeviceInfo.Model",i.systemProductName),n.setContext("rendererCount",i.rendererCount),a&&n.setContext("AppInfo.Version",s),n.setContext("AppInfo.WebVersion",i.hostAppWebVersion),i.hostAppWebVersion&&n.setContext("AppInfo.HostAppWebVersion",BF(i.hostAppWebVersion)),o&&i.userType&&n.setContext("userType",i.userType)},BF=e=>{let t="";const n=e.indexOf("/");return n>-1&&(t=e.substring(n+1,e.length)),t},WF=e=>{let t;const n=e.indexOf(TF);if(n>-1){t=e.substring(n+TF.length+1);const i=t.indexOf(" ");t=t.substring(0,i)}return t},GF=(e,t)=>t?e.concat(",",t):e,VF=e=>{let t=Es.Wz.unknown;return zF(e,Es.Wz.x64)?t=Es.Wz.x64:zF(e,Es.Wz.x86)?t=Es.Wz.x86:zF(e,Es.Wz.ia32)&&(t=Es.Wz.ia32),t},HF=(e,t)=>{if(!e){let e=Es.Zc.UNKNOWN;const n=(null==t?void 0:t.match(wF))||(null==t?void 0:t.match(_F))||(null==t?void 0:t.match(IF)),i=(null==t?void 0:t.match(EF))||(null==t?void 0:t.match(DF)),a=(null==t?void 0:t.match(AF))||(null==t?void 0:t.match(NF));return n?e=Es.Zc.WINDOWS:i?e=Es.Zc.UNIX:a&&(e=Es.Zc.MACOSX),e}switch(t){case Fo.NR.Windows:case Fo.NR.WindowsPhone:return Es.Zc.WINDOWS;case Fo.NR.ChromeOS:case Fo.NR.Android:case Fo.NR.Linux:return Es.Zc.UNIX;case Fo.NR.IOS:case Fo.NR.Mac:return Es.Zc.MACOSX;default:return Es.Zc.UNKNOWN}},$F=e=>{switch(e){case Fo.NR.Windows:return"Windows";case Fo.NR.Mac:return"Mac OS X";case Fo.NR.Linux:return"Linux";case Fo.NR.ChromeOS:return"Chrome OS";case Fo.NR.Android:return"Android";case Fo.NR.IOS:return"iOS";case Fo.NR.WindowsPhone:return"Windows Phone";case Fo.NR.Unknown:return"Unknown";default:return e}},zF=(e,t)=>!!(e.indexOf(t)>-1),qF=()=>{const e=(new Date).getTimezoneOffset();let t=e%60,n=(e-t)/60;const i=n>0?"-":"+";t=Math.abs(t),n=Math.abs(n);const a=t<10?`0${t}`:t.toString();return`${i}${n<10?`0${n}`:n.toString()}:${a}`};class JF extends xe{constructor(){super(_.Yg.InitTelemetry,["coreSettings","diagnosticsService","windowProvider","telemetryContextService","loggerFactory"])}execute(e){var t,n,i,a;return(0,c.mG)(this,void 0,void 0,(function*(){const o=e.loggerFactory.newLogger("init-telemetry-task"),r=e.coreSettings.get(A.J.Telemetry),s=this.createMemoryAnalyzer(e.windowProvider,r);r.disableAriService||(e.appResponsivenessService=new JD(e.windowProvider,{loggerFactory:e.loggerFactory,windowProvider:e.windowProvider,coreSettings:e.coreSettings})),e.dataClientTrackingService=this.createDataClientTrackerService(e),this.createWindowTrackerService(e),yield this.createHeartbeatMonitor(e);const{crossClientRegistrationMethods:l,desktopActiveScenarios:d,desktopContext:c,deviceInfo:u,finalizeLegacyCrossClient:m,notifyDesktopScenarioFactoryReady:g,systemCpuInfo:p,systemMemoryInfo:h}=yield this.initializeCrossClientTelemetry(o,e.hostCommunicationService),v={deviceInfo:u,systemCpuInfo:p,systemMemoryInfo:h},S=this.createCoreScenarioFactory(e,s,m,d,l);null==g||g(),null===(t=e.hostCommunicationService)||void 0===t||t.setScenarioFactory(S),e.diagnosticsService.setScenarioFactory(S),yield this.createCoreTelemetryService(e,s,S,v,e.telemetryContextService,c),null===(a=null===(i=null===(n=e.windowProvider)||void 0===n?void 0:n.loader)||void 0===i?void 0:i.stopPieTimer)||void 0===a||a.call(i),this.createCoreUserBiService(e),this.startAppStartScenarios(e,S),e.altScenarioService=new QD({host:e.windowProvider,loggerFactory:e.loggerFactory,coreSettings:e.coreSettings,scenarioFactory:S});const f=new FE(S,e.telemetryContextService,s);e.hostCommunicationService&&(yield this.handOffContextCommsCallback(e.hostCommunicationService,e.coreSettings,f))}))}initializeCrossClientTelemetry(e,t){var n,i,a,o;return(0,c.mG)(this,void 0,void 0,(function*(){const r={};if(t){try{const e=yield t.loadModule("scenario");e&&(e.getActiveScenarios&&(r.desktopActiveScenarios=yield e.getActiveScenarios({})),e.setScenarioCompletion&&(r.finalizeLegacyCrossClient=e.setScenarioCompletion),r.crossClientRegistrationMethods={},e.registerForScenarioMark&&e.registerForScenarioStart&&e.registerForScenarioStop&&(r.crossClientRegistrationMethods.marks={registerForScenarioStart:e.registerForScenarioStart,registerForScenarioMark:e.registerForScenarioMark,registerForScenarioStop:e.registerForScenarioStop}),e.registerForScenarioAppendEventData&&(r.crossClientRegistrationMethods.appendEventData=e.registerForScenarioAppendEventData),r.notifyDesktopScenarioFactoryReady=()=>{var t;null===(t=e.setWebAvailability)||void 0===t||t.call(e,!0)})}catch(t){e.errorToTelemetry&&e.errorToTelemetry(Jr.LoadModuleScenarioFailed,"webclient_framework_host_comms",void 0,!0)}try{const e=yield t.loadModule("osutils");e&&(r.deviceInfo=yield null===(n=e.getDeviceInfo)||void 0===n?void 0:n.call(e),r.systemCpuInfo=yield null===(i=e.getSystemCpuInfo)||void 0===i?void 0:i.call(e),r.systemMemoryInfo=yield null===(a=e.getSystemMemoryInfo)||void 0===a?void 0:a.call(e))}catch(t){e.errorToTelemetry&&e.errorToTelemetry(Jr.LoadModuleOsUtilsFailed,"webclient_framework_host_comms",void 0,!0)}try{const e=yield t.loadModule("telemetry");r.desktopContext=yield null===(o=null==e?void 0:e.getContext)||void 0===o?void 0:o.call(e,{columns:["launchIntent","desktopVersion","deviceAuthToken","windowsChannel","windowsSku","storageInfo","outOfProcState"]})}catch(t){e.errorToTelemetry&&e.errorToTelemetry(Jr.LoadModuleTelemetryFailed,"webclient_framework_host_comms",void 0,!0)}}return r}))}handOffContextCommsCallback(e,t,n){var i,a;return(0,c.mG)(this,void 0,void 0,(function*(){const o=yield e.loadModule("telemetry"),r=yield null===(i=null==o?void 0:o.getPreAuthUserSamplingId)||void 0===i?void 0:i.call(o);if(r&&(null===(a=this.setPreAuthUserId)||void 0===a||a.call(this,t,n,r)),o&&o.setContext){const e=o.setContext;(0,Jn.G)().setMultiContextCallback(((t,n,i)=>e([{column:t,value:n,userContextId:i}])))}}))}createMemoryAnalyzer(e,t){const{enableDesktopMemoryAnalyzer:n,isScenarioMemorySnapshotEnabled:i}=t;return n?new KD(!!i,e):void 0}createCoreScenarioFactory(e,t,n,i,a){const o=new cE({parentScenarioFactory:e.scenarioFactory,coreSettings:e.coreSettings,platformService:e.platformService,loggerFactory:e.loggerFactory,hostCommunicationService:e.hostCommunicationService,windowProvider:e.windowProvider,authenticationUser:e.authenticationUser,correlation:e.correlation},e.config.startTimeMS,t,void 0,void 0,void 0,void 0,i,a,n);return e.scenarioFactory=o,o}createHeartbeatMonitor(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=new PN(e);yield t.start(),e.heartbeatMonitor=t}))}createDataClientTrackerService(e){const t=e.platformService.config.clientType===Fo.Bh.Maglev?()=>!!e.clientState&&[Ve.pk.Inactive,Ve.pk.LongInactive].includes(e.clientState.getState()):()=>!!e.appStateService&&[_.eT.Inactive,_.eT.LongInactive].includes(e.appStateService.getState());return new nF(e.coreSettings,e.leakDetectorService,e.userTrackingService,t)}createWindowTrackerService(e){e.windowTrackerService=new pF(e)}createCoreTelemetryService(e,t,n,i,a,o){return(0,c.mG)(this,void 0,void 0,(function*(){const{config:r,coreSettings:s,coreSecurityService:l,experimentationService:d,hostCommunicationService:c,loggerFactory:u,platformService:m,routingServices:g,windowProvider:p}=e,h=yield fA(c),v=uA(p),S={osLocale:h,userLanguage:SA(p),localeCode:yA(p,g,v.localeCode),originLocaleCode:kA(p,g,v.localeCode)},{telemetryContext:f}=((e,t,n,i,a,o,r,s)=>{const l=t.newLogger("Telemetry"),d=MF(e,l,n,i),c=r||new qN(l),{columnSuppression:u}=PF(t.newLogger("TelemetrySender"),i,d.documentInfo.tablePostfix),m=FF(i,o);return(0,Jn.G)().initialize(d,l,i,m,u),jF(e,l,n,i,d.documentInfo,!1,c,a,s),{telemetryContext:c}})({appStartTime:r.startTimeMS,experienceName:r.experienceName,windowType:r.windowType,clientTypeTelemetry:r.clientTypeTelemetry},u,m,s,S,{coreSecurityService:l,windowBaseUrl:p.document.location.origin},a,d),y=new FE(n,f,t);if(p.localStorage){const e=p.localStorage.getItem("ts.latestOid");null==y||y.setContext("UserInfo.Id",e)}r.externalCorrelationId&&y.setCoreContext("EventInfo.ExternalCorrelationId",r.externalCorrelationId),r.embedContext&&(y.setCoreContext("Window.EmbedContext",r.embedContext),y.setCoreContext("AppInfo.EmbedReferrer",function(e,t){try{const{referrer:n}=t.getSearchState(),i=e.document.referrer,a=e.parent.opener;let o=n;return hF(e,o)||(o=i&&(0,Mo.Lp)(i),hF(e,o)||(o=a&&a.location&&a.location.hostname,!hF(e,o)&&e.location.ancestorOrigins&&e.location.ancestorOrigins.length>0&&(o=e.location.ancestorOrigins[0]))),o||""}catch(e){return""}}(p,g.state))),this.setTelemetryContext(y,i,o),y.setCoreContext("AppInfo.ArchVersion","V2"),e.telemetryService=y}))}setPreAuthUserId(e,t,n){const i=e.get(A.J.Telemetry);n&&i.enablePreAuthIdSampling&&(t.setCoreContext("AppInfo.PreAuthUserSamplingId",n),yF.H.getInstance().setSamplingByPreAuthId(n))}createCoreUserBiService(e){var t;const{config:n}=e,i=null===(t=e.telemetryService)||void 0===t?void 0:t.createUserBiService(e,_.ew,{id:(0,Je.v4)(),source:I.D.StandAlone,startTimestamp:n.startTimeMS});e.userBiService=i}setTelemetryContext(e,t,n){const{deviceInfo:i,systemCpuInfo:a,systemMemoryInfo:o}=t;if(i&&(e.setCoreContext("DeviceInfo.Make",i.make),e.setCoreContext("DeviceInfo.Model",i.model),e.setCoreContext("DeviceInfo.CpuArchitecture",i.cpuArchitecture),e.setCoreContext("DeviceInfo.OsVersion",i.osVersion)),a&&(e.setCoreContext("CpuInfo.Cores",a.cpuCores.length.toString()),e.setCoreContext("CpuInfo.Model",a.cpuCores[0].model),e.setCoreContext("CpuInfo.Speed",a.cpuCores[0].speed)),o&&e.setCoreContext("DeviceInfo.TotalMemory",o.totalPhysicalMemoryBytes),n&&0!==n.length){const t=n.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.column]:t.value})),{}),i=t.launchIntent,a=t.desktopVersion,o=t.deviceAuthToken,r=t.windowsChannel,s=t.windowsSku,l=t.storageInfo,d=t.outOfProcState;i&&e.setCoreContext("AppInfo.LaunchIntent",i),a&&e.setCoreContext("AppInfo.DesktopVersion",a),d&&e.setCoreContext("AppInfo.OutOfProcState",d),o&&e.setDeviceAuthToken(o),r&&e.setCoreContext("DeviceInfo.WindowsChannel",r),s&&e.setCoreContext("DeviceInfo.WindowsSku",s),l&&e.setCoreContext("DeviceInfo.StorageInfo",l)}}startAppStartScenarios(e,t){const{config:n,loggerFactory:i,routingServices:a,telemetryService:o,windowProvider:r}=e,s=this.getDownloadAndParseStepData(i,t,r);null==o||o.newCoreScenario(ee.RG.AppStart,{startTime:n.startTimeMS}),SF(n.experienceName,t,n.startTimeMS,a.state,r,s)}getDownloadAndParseStepData(e,t,n){let i;if(n.performance){const a=e.newLogger("InitTelemetryTask");n.performance.timing&&t.createScenarioWithoutStarting(ee.RG.DomLoadingStart,{startTime:n.performance.timing.domLoading}).stop();const o=n.performance.getEntriesByType("resource").find((e=>"script"===e.initiatorType&&e.name.indexOf("main")>=0)),r=void 0!==o&&0===o.transferSize;i=fF(ee.RG.DownloadAndParse,"execute-index-html-script","start-execute-main-bundle",n,t,a,{cached:r}),fF(ee.RG.ResolveMainImports,"start-execute-main-bundle","resolve-main-imports-end",n,t,a)}return i}}var QF=n(7254);class KF extends xe{constructor(){super(_.Yg.InitUserBrbServiceTask,["scenarioFactory","loggerFactory","coreSettings","logsCollectorService","authenticationService","authenticationUser","platformService","discover","hostCommunicationService","endpointsManager","brbServiceManager","client","i18n"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,coreSettings:i,logsCollectorService:a,authenticationService:o,authenticationUser:r,platformService:s,discover:l,hostCommunicationService:d,endpointsManager:c,brbServiceManager:u,client:m,i18n:g}=e;if(!r)throw new Error("authenticationUser is invalid, cannot register user brb service.");const p=(0,qe.b)(r);return u.registerUserBrbService(p,(()=>new QF.w(n,i,a,o,s,l,d,c,t,g,r,m))),e=>{switch(e){case"signout":u.unregisterUserBrbService(p);break;default:return}}}))}}class YF extends xe{constructor(){super(_.Yg.RegisterCustomFrameThemes,["coreSettings","hostCommunicationService"])}execute(e){var t,n;return(0,c.mG)(this,void 0,void 0,(function*(){const{coreSettings:i,hostCommunicationService:a}=e,{primaryWindowTitleBarHeightPx:o,secondaryWindowTitleBarHeightPx:r}=i.get(A.J.Core),s=yield a.loadModule("windowcontrols");o&&r&&(null===(t=null==s?void 0:s.defineCustomFrameTheme)||void 0===t||t.call(s,"main",{buttonHeight:o,buttonWidth:44}),null===(n=null==s?void 0:s.defineCustomFrameTheme)||void 0===n||n.call(s,"default",{buttonHeight:r,buttonWidth:44}))}))}}class XF extends xe{constructor(){super(_.Yg.ReloadExperience,["coreSettings","platformService","rebootService","loggerFactory","scenarioFactory","windowProvider"]),this.isReloadRequired=(e,t)=>e&&t&&e!==t}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{coreSettings:t,platformService:n,rebootService:i,loggerFactory:a,scenarioFactory:o,windowProvider:r}=e,s=a.newLogger("ReloadExperienceTask"),{buildRing:l,assignedRing:d}=this.getRings(n,t);if(this.isReloadRequired(l,d)&&d){s.log(`Reload required: Assigned: ${d}, Build: ${l}`);return(yield i.rebootApp(lr.Z.RingSwitch,lr.d.ReloadAppTask,{qsps:{ring:d},maxRetries:1}))?this.deleteEcsCaches(r):this.reportReloadNotTriggered(l,d,s,o),e=>{switch(e){case"signout":i.clearRetryCount(lr.d.ReloadAppTask);break;default:return}}}s.debug(`No reload required: Assigned: ${d}, Build: ${l}`),i.clearRetryCount(lr.d.ReloadAppTask)}))}getRings(e,t){const{ring:n}=t.get(A.J.Metadata);return{assignedRing:(null==n?void 0:n.id)||void 0,buildRing:e.ecsOverrides.ring||void 0}}reportReloadNotTriggered(e,t,n,i){n.warn(`Ring Discrepancy: Assigned: ${t}, Build: ${e} `),i.createScenarioWithoutStarting(ee.RG.BuildRingDiscrepancy).fail({message:e})}deleteEcsCaches(e){Object.keys(e.localStorage).filter((e=>e.endsWith(Xm.EcsCache))).forEach((t=>e.localStorage.removeItem(t)))}}class ZF extends xe{constructor(){super(_.Yg.SetRingFinderCookieTask,["authenticationUser","coreSettings","loggerFactory","windowProvider","discover"]),this.setAuthCookie=(e,t,n,i)=>{var a;if(void 0===(null===(a=e.document)||void 0===a?void 0:a.cookie))return void t.warn(`Cannot set cookie: '${n}'.`);t.log(`Setting '${n}' cookie.`);const o=new Date,r=o.setMonth(o.getMonth()+5);e.document.cookie=`${n}=${i};expires=${new Date(r).toUTCString()};path=/;secure;samesite=none`},this.cleanUpCookie=(e,t,n)=>{var i;void 0!==(null===(i=e.document)||void 0===i?void 0:i.cookie)&&(t.log(`Expiring '${n}' cookie.`),e.document.cookie=`${n}=;max-age=0;path=/;secure;samesite=none`)}}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettings:n,discover:i,loggerFactory:a,windowProvider:o}=e,r=a.newLogger("SetRingFinderCookieTask");try{const{windowsInsiderChannel:e}=n.get(A.J.Host),{enableRegionParamForPDS:a}=n.get(A.J.Core);let s;a&&(s=yield i.getRegion({id:t.id,tenantId:t.profile.tenantId,oid:t.profile.objectId,accountType:t.type,userName:t.loginUserName||""}));const l={oid:t.profile.objectId,tid:t.profile.tenantId,wip:e,region:s},d="ringFinder";return this.setAuthCookie(o,r,d,encodeURIComponent((0,R.u4)(l))),e=>{switch(e){case"signout":this.cleanUpCookie(o,r,d);break;default:return}}}catch(e){r.error(`Failed to set ring finder cookie: ${(0,he.VK)(e)}`)}}))}}class eP extends xe{constructor(){super(_.Yg.SetPrimaryUserOnTelemetry,["primaryUser","loggerFactory","telemetryContextService","hostCommunicationService"])}execute(e){var t,n,i;return(0,c.mG)(this,void 0,void 0,(function*(){const{primaryUser:a,loggerFactory:o,telemetryContextService:r,hostCommunicationService:s}=e;try{const e=(0,qe.b)(a),n=a.profile.tenantId;r.setPrimaryUser(e,n);const i=yield s.loadModule("telemetry");null===(t=null==i?void 0:i.setPrimaryUser)||void 0===t||t.call(i,e,n)}catch(e){const t=new ze.G(ze.$.TELEMETRY_PRIMARY_USER_SET_FAILURE,e,(0,qe.b)(a));null===(i=(n=o.newLogger("SetUserOnTelemetryContext")).error)||void 0===i||i.call(n,t.toTelemetryEntry())}}))}}class tP{constructor(){this.id=_.Yg.SetUserOnDiagnosticsService}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettings:n,diagnosticsService:i,logsCollectorService:a,platformService:o}=hm("SetUserOnDiagnosticsServiceTask",e,"authenticationUser","coreSettings","diagnosticsService","logsCollectorService","platformService");a.setPrimaryUserID(t.id);const{enableMTMA:r}=n.get(A.J.Core);if(r){const n=i.createUserDiagnosticsService(t.profile.tenantId,t.profile.objectId,o.host.sessionId,t.id);n&&(e.diagnosticsService=n,e.loggerFactory=new pe(n,e.loggerFactory.cID))}else i.updateDiagnosticInfo(t.profile.tenantId,t.profile.objectId,o.host.sessionId);return e=>{switch(e){case"signout":t.id&&a.handleUserLogout(t.id),i.handleUserLogout(t.id)}}}))}}function nP(e){return!!(null==e?void 0:e.isAuthenticated)}function iP(e,t){const{enableTflFreProfileConsentDialog:n}=e.get(A.J.Fre);return!(!n||t&&"true"===t.get("TflFreProfileCardDisplayed"))}class aP extends xe{constructor(){super(_.Yg.SignalCoreLifecycleChangesTask,["authenticationUser","client","clientState","config","coreSecurityService","coreSettings","coreUtilities","correlation","entityCommanding","experienceChangeReportingService","experienceLifecycleManager","hostCommunicationService","i18n","i18NextWrapper","localStorage","loggerFactory","networkState","platformService","rebootService","scenarioFactory","userBiService","windowProvider"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{activeWindowsHistoryService:t,authenticationUser:n,client:i,clientState:a,config:o,coreSecurityService:r,coreSettings:s,coreUtilities:{isEntityInView:l},correlation:d,entityCommanding:u,experienceChangeReportingService:m,experienceLifecycleManager:g,hostCommunicationService:p,i18n:h,i18NextWrapper:v,localStorage:S,loggerFactory:f,networkState:y,platformService:k,rebootService:C,scenarioFactory:b,userBiService:T,userTrackingService:w,windowProvider:_}=e,I=f.newLogger("SignalCoreLifecycleChangesTask");if(!n||!nP(n))return void I.warn("Not creating user lifecycle manager as authenticated user is not available.");const{disableExperience:N}=s.get(A.J.Core);if(N)return void I.warn("Not creating user lifecycle manager as experience is disabled.");const E=d.id,D=(0,qe.b)(n);return g.manageUser(D,{activeWindowsHistoryService:t,authenticationUser:n,client:i,clientState:a,config:o,coreSecurityService:r,coreSettings:s,entityCommanding:u,i18n:h,i18NextWrapper:v,isEntityInView:l,loggerFactory:f,networkState:y,platformService:k,rebootService:C,scenarioFactory:b,hostCommunicationService:p,userTrackingService:w,windowProvider:_,localStorage:S,userBiService:T}),m.report({correlationId:E,userContextId:D,type:Tt.yU.UserAuthenticated,context:{target:"core-tasks-signal-core-lifecycle-changes-task"}}),iP(s,S)||m.report({correlationId:E,type:Tt.yU.UserConsentedToConsumeResources,userContextId:D,context:{target:"core-tasks-signal-core-lifecycle-changes-task"}}),e=>(0,c.mG)(this,void 0,void 0,(function*(){switch(e){case"quit":case"signout":yield g.removeUser(e,D);break;default:return}}))}))}}class oP extends xe{constructor(){super(_.Yg.StoreBuildInfoTask,["localStorage","platformService"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{localStorage:t,platformService:n}=e,i=n.config.buildVersion;i&&!i.toLocaleLowerCase().startsWith("local")&&t.set("buildNumber",i,or.f.Experience)}))}}class rP extends xe{constructor(){super(_.Yg.TrackExperienceIdle,["clientState","correlation","coreSettings","experienceChangeReportingService"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{clientState:t,correlation:n,coreSettings:i,experienceChangeReportingService:a}=e,{enableExperienceIdleStateManagement:o}=i.get(A.J.Core);if(!o)return;const r=t.observe().subscribe((e=>(0,c.mG)(this,void 0,void 0,(function*(){const t=e===Ve.pk.LongInactive;a.report({correlationId:n.id,type:Tt.yU.ExperienceIdleStateChanged,context:{target:"core-tasks-signal-core-lifecycle-changes-task",isIdle:t}})}))));return e=>{switch(e){case"signout":case"quit":r.unsubscribe()}}}))}}class sP extends xe{constructor(){super(_.Yg.TrackUserTask,["authenticationUser","userTrackingService"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const t=(0,qe.b)(e.authenticationUser);return e.userTrackingService.trackUser(t),n=>{switch(n){case"signout":e.userTrackingService.removeUser(t)}}}))}}class lP extends xe{constructor(){super(_.Yg.UpdateDataClientContext,[])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){!function(e,t){var n,i,a;const o=Object.assign(Object.assign({},t),{pubsub:e.getServices().pubsub,send:(0,od.UZ)(ys.l,t.networkState.observeIsOnline())}),r=mh.singletonLink,s=Cy.clientResolvers;if(!r||!s)throw new Error("Link and client resolvers should be created at this point");const{maxApolloResultCacheSize:l}=t.coreSettings.get(A.J.Core),{enableApolloDevtools:d}=t.coreSettings.get(A.J.Diagnostics),c=null!=l?l:void 0,u=null===(n=t.leakDetectorService)||void 0===n?void 0:n.create(),m=p_({leakDetector:u,windowId:null===(i=e.cache.apolloLeakInfo)||void 0===i?void 0:i.apolloLeakInfoWindowId,entityType:null===(a=e.cache.apolloLeakInfo)||void 0===a?void 0:a.apolloLeakInfoEntityType,viewportContext:"cmd"},void 0,s,c,t.loggerFactory,t.scenarioFactory,void 0,d,Kg.t.cmd,t.graphqlStoreStatsReporterService);sp(m,"cmdApolloClient",Boolean(d),t.platformService,t.config.experienceName);const g=u_.createUserDataRequestContext(o,m),p=f_(g,r);e.updateContext(g,p),m.setLink(p)}(e.client,e)}))}}class dP extends xe{constructor(){super(_.Yg.UpdateNetworkStateDetection,[])}execute(e){var t,n;return(0,c.mG)(this,void 0,void 0,(function*(){const i=e.authenticationUser&&(0,qe.b)(e.authenticationUser)||"",a=null===(n=(t=e.networkState).subscribeToEndpointsNetworkStateTracking)||void 0===n?void 0:n.call(t,i,e.endpointsManager.networkState);return e=>{switch(e){case"signout":a();break;default:return}}}))}}class cP extends xe{constructor(){super(_.Yg.UpdateUserMetadataProperties,["coreSettingsContext","user","localStorage"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{coreSettingsContext:t,user:n,localStorage:i}=e;i.setSafe("cachedUser",(0,R.u4)(n),or.f.User),t.updateUserMetadataProperties(n)}))}}class uP extends xe{constructor(){super(_.Yg.WaitForCDLWorkerTask,["loggerFactory","coreSettings"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{loggerFactory:t,coreSettings:n}=e,{cdlWorkerService:i}=e,a=t.newLogger("WaitForCDLWorkerTask");if(!Oc(n))return;const{isCDLWorkerCriticalToStartup:o}=n.get(A.J.Core);if(i){a.log("Waiting for CDL worker to finish initialization");if(!(yield i.getCDLWorkerManager())&&(a.error("CDL worker manager not initialized."),o))throw new ze.G(ze.$.CDL_WORKER_FAILURE)}else if(a.warn("CDL worker service not present in core context."),o)throw new ze.G(ze.$.CDL_WORKER_FAILURE)}))}}class mP extends xe{constructor(){super(_.Yg.WrapChangeReportingServicesTask,["commandChangeReportingService","experienceChangeReportingService","authenticationUser"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{commandChangeReportingService:t,experienceChangeReportingService:n,authenticationUser:i}=e,a=(0,qe.b)(i);return e.commandChangeReportingService=Object.assign(Object.assign({},e.commandChangeReportingService),{report:e=>{t.report(Object.assign({userContextId:a},e))},observeChanges:t.observeChanges.bind(t)}),e.experienceChangeReportingService=Object.assign(Object.assign({},e.experienceChangeReportingService),{report:e=>{n.report(Object.assign({userContextId:a},e))},observeChanges:n.observeChanges.bind(n)}),Promise.resolve()}))}}class gP extends xe{constructor(){super(_.Yg.ClearHostSettingsTask,["loggerFactory"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{loggerFactory:t}=e,n=t.newLogger("ClearHostSettingsTask");e.hostSettings=void 0,n.log("ClearHostSettingsTask: Host settings cleared from task init context.")}))}}class pP extends xe{constructor(){super(_.Yg.CreateHostedWindowContext,["hostedWindowContext","hostSettings"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{hostedWindowContext:t,hostSettings:n}=e,i=n.hostSettings;i&&(t.sessionStartTime=i.createdTime,t.localeCode=i.localeCode,t.ring=i.hostRingId),"general_gcc"===t.ring&&(null==i?void 0:i.enableDevTools)&&(t.ring="ring0_gcc")}))}}class hP extends xe{constructor(){super(_.Yg.FetchHostSettingsTask,["config","hostedWindowContext","loggerFactory","windowProvider"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{config:t,hostedWindowContext:n,loggerFactory:i,windowProvider:a}=e,{isInCypressFrame:o,isInIframe:r}=n,s=i.newLogger("FetchHostSettingsTask");if(t.shouldFetchBootstrapData&&r&&!o)try{s.log("Hosted in web. Fetching host settings from host over IPC.");const t=yield a.opener.requestMessage(K.rY.GetStateData,{requestType:"hostSettings"});s.log("Host settings fetched, setting context.hostSettings"),e.hostSettings=Object.assign({},t.hostSettings)}catch(e){s.errorToTelemetry&&s.errorToTelemetry(`Error fetching host settings over IPC ${e}`,"webclient_framework_foundation_core_services_tasks",void 0,!0)}else{s.log("Hosted in desktop. Getting host settings from window object.");const t=window;t.hostSettings&&(s.log("Found window.hostSettings."),e.hostSettings=Object.assign({},t.hostSettings),delete t.hostSettings)}}))}}var vP;!function(e){e[e.Unknown=5e4]="Unknown",e[e.GetSingletonStoreFailed=4e4]="GetSingletonStoreFailed",e[e.CreateStoreFailed=40001]="CreateStoreFailed",e[e.ActionNotSupported=40002]="ActionNotSupported"}(vP||(vP={}));var SP=n(70162),fP=n(3886),yP=n(79970);const kP={code:vP.CreateStoreFailed,message:"Store is not available"};function CP(e){return new bP(e)}class bP extends we.y{constructor(e){const t=e?TP(e):(0,SP._)(kP);super((e=>t.subscribe(e))),this._dispatcher=e?Promise.resolve(e):Promise.reject(kP)}dispatch(e){return(0,c.mG)(this,void 0,void 0,(function*(){return(yield this._dispatcher).dispatch(e)}))}}const TP=e=>(0,p.D)(Promise.resolve(e)).pipe((0,Ct.w)((e=>new we.y((t=>e.subscribe((e=>t.next(e))))))),(0,fP._)(1),(0,yP.x)());class wP extends we.y{constructor(e,t){const n=t.pipe((0,h.U)((t=>{var n;return null===(n=null==t?void 0:t.windows[e])||void 0===n?void 0:n.lifecycle})),(0,Br.x)(Z.isEqual),(0,S.h)((e=>void 0!==e)),(0,In.o)((e=>void 0===e.closedTime),!0));super((e=>n.subscribe(e))),this._id=e,this._dispatcher=t}pushWltMarks(e){return this._dispatcher.dispatch({type:"RECORD_WINDOW_LIFECYCLE_MARKS",windowId:this._id,markers:e})}}var _P=n(78372),IP=n(50706);class AP{constructor(e,t,n){if(this.exitFullscreen=e=>this._observableStore.dispatch((e=>({type:"SET_FULLSCREEN",windowId:e,fullscreen:!1}))(e)),this.focus=e=>this._observableStore.dispatch((e=>({type:"FOCUS_WINDOW",windowId:e}))(e)),this.maximize=e=>this._observableStore.dispatch((e=>({type:"TOGGLE_MAXIMIZE_WINDOW",windowId:e}))(e)),this.minimize=e=>this._observableStore.dispatch((e=>({type:"MINIMIZE_WINDOW",windowId:e}))(e)),this.requestFullscreen=e=>this._observableStore.dispatch((e=>({type:"SET_FULLSCREEN",windowId:e,fullscreen:!0}))(e)),this.show=e=>this._observableStore.dispatch((e=>({type:"SHOW_WINDOW",windowId:e}))(e)),this.windowTitleDblClick=e=>this._observableStore.dispatch((e=>({type:"INVOKE_DOUBLE_CLICK",windowId:e}))(e)),e.createInterprocessStore){const i=e.createInterprocessStore({logDebug:(...e)=>t.debug(...e),logError:(...e)=>t.error(...e),logInfo:(...e)=>t.log(...e),logScenario:e=>{n.newScenario(e.name).stop(void 0,e.status)}});this._observableStore=CP(i)}else this._observableStore=CP(null)}onWindowFullscreen(e){return this._observableStore.pipe((0,_P.j)("windows",e),(0,IP.n)((e=>void 0===e)),(0,In.o)((e=>{var t;return void 0===(null===(t=e.lifecycle)||void 0===t?void 0:t.closedTime)})),(0,_P.j)("layout","fullscreen"),(0,Br.x)())}onLifecycleMarks(e){return new wP(e,this._observableStore)}}class NP extends xe{constructor(){super(_.Yg.InitInterprocessStore,["windowProvider","loggerFactory","scenarioFactory","coreSettings"])}execute(e){return(0,c.mG)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:n,scenarioFactory:i,coreSettings:a}=e;a.get(A.J.Core).disableInterprocessStore||(e.interprocessStoreService=new AP(t,n.newLogger("InterProcessStore"),i)),delete t.createInterprocessStore}))}}class EP extends xe{constructor(){super(_.Yg.Polyfills,[])}execute(){return(0,c.mG)(this,void 0,void 0,(function*(){this.applyAsyncIteratorPolyfillIfNeeded()}))}applyAsyncIteratorPolyfillIfNeeded(){void 0===Symbol.asyncIterator&&(Symbol.asyncIterator=Symbol.asyncIterator||n(12673).$$asyncIterator)}}class DP extends xe{constructor(){super(_.Yg.ReinitSettingsEcsProvider,["authenticationUser","coreSettingsContext"])}execute({coreSettingsContext:e,authenticationUser:t}){return(0,c.mG)(this,void 0,void 0,(function*(){yield e.reinitializeEcsProvider(t)}))}}class FP{constructor(e,t){this.host=t,this.logsProviderTimeoutMs=2e4,this.coreLogsKey="Core",this.providersMap=new Map,this.primaryUserID="",this.mtmaEnabled=!1,this.allowZipLogFiles=!1,this.environmentName="",this.providersMap.set(this.coreLogsKey,[]),this.logger=e.newLogger("LogsCollectorService")}subscribeToCoreSettings(e){if(!e)return void this.logger.error("Failed to subscribe to core settings");this.mtmaEnabled=!!e.get(A.J.Core).enableMTMA;e.getObservable(A.J.Diagnostics).subscribe((e=>{const{logsProviderTimeoutMs:t,shouldZipLogFiles:n}=e;t&&(this.logsProviderTimeoutMs=t),this.allowZipLogFiles=!!n}));e.getObservable(A.J.Metadata).subscribe((e=>{e.environment&&(this.environmentName=e.environment)}))}registerCoreLogsProvider(e){this.registerUserLogsProvider(this.coreLogsKey,e)}registerUserLogsProvider(e,t){this.primaryUserID&&!e&&(e=this.primaryUserID);let n=this.providersMap.get(e);void 0===n&&(n=[],this.providersMap.set(e,n)),this.registerLogsProvider(n,t)}handleUserLogout(e){this.providersMap.delete(e)}callOnLogsFiles(e,t=!1){return(0,c.mG)(this,void 0,void 0,(function*(){return this.callOnUserLogsFiles(Array.from(this.providersMap.keys()).filter((e=>e!==this.coreLogsKey)),e,t)}))}callOnUserLogsFiles(e,t,i=!1){var a,o,r;return(0,c.mG)(this,void 0,void 0,(function*(){let s;if(i&&this.allowZipLogFiles)try{const e=null===(a=yield n.e(1578).then(n.t.bind(n,36776,23)))||void 0===a?void 0:a.default;e&&(s=new e)}catch(e){null===(r=(o=this.logger).errorToTelemetry)||void 0===r||r.call(o,`Load jszip failed - ${e}`,"logs_loading_jszip")}const l={fileName:"summary.txt",content:"",isPiiFree:!0},d=yield this.callOnOnlyCoreLogsFiles((null==s?void 0:s.file)?this.addFileIntoZip.bind(void 0,s):t,l),c=yield this.callOnOnlyUserLogsFiles(e,(null==s?void 0:s.file)?this.addFileIntoZip.bind(void 0,s):t,l),u=yield this.createSummaryFile((null==s?void 0:s.file)?this.addFileIntoZip.bind(void 0,s):t,l);if(s){const e=yield s.generateAsync({type:"blob",compression:"DEFLATE"}),n=this.environmentName?`${this.environmentName.toUpperCase()}-`:"";return t({fileName:`${n}WebLogs-${(new Date).toISOString()}.zip`,content:e,isPiiFree:!0})}return d&&c&&u}))}getSystemInfo(){return(0,c.mG)(this,void 0,void 0,(function*(){let e=new Map;try{const t=this.providersMap.get(this.coreLogsKey);if(t&&t.length>0){const n=t.map((e=>{let t;return Promise.race([e.getSystemInfo(),new Promise((n=>{t=this.host.setTimeout((()=>{this.logger.error(`Timed out fetching system info from logs provider - ${e.logsProviderName}`),n(new Map)}),this.logsProviderTimeoutMs)}))]).then((e=>(void 0!==t&&this.host.clearTimeout(t),e)))})),i=yield Promise.all(n);i&&i.length>0&&(e=i.reduce(((e,t)=>new Map([...Array.from(e.entries()),...Array.from(t.entries())]))))}}catch(e){this.logger.error("Fetching system info from logs providers failed with error:",e)}return e}))}setPrimaryUserID(e){if(e&&!this.primaryUserID){this.primaryUserID=e;const t=this.providersMap.get("");t&&(this.providersMap.set(this.primaryUserID,t),this.providersMap.delete(""))}}setGetSummaryFunction(e){this.generateSummary=e}registerLogsProvider(e,t){this.logger.log(`Register logsProvider: ${t.logsProviderName}`);const n=e.findIndex((e=>e.logsProviderName===t.logsProviderName));n>-1?e[n]=t:e.push(t)}callOnOnlyCoreLogsFiles(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){try{const n=this.providersMap.get(this.coreLogsKey)||[];this.logger.log(`Fetching files from providers: ${n.reduce(((e,t)=>e+`${null==t?void 0:t.logsProviderName}, `),"")}`);const i=n.findIndex((e=>e.logsProviderName===w.DIAGNOSTICSSERVICE)),a=n.filter(((e,t)=>t!==i)),o=yield this.callOnLogsFilesOfLogsProviders(a,e,t);let r=!0;return i>-1&&(r=yield this.callOnLogsFilesOfLogsProviders([n[i]],e,t)),o&&r}catch(e){return this.logger.error("Error calling callback on logs files from all logs providers - error:",e),!1}}))}callOnOnlyUserLogsFiles(e,t,n){return(0,c.mG)(this,void 0,void 0,(function*(){const i=[];return e.length>0&&e.forEach((e=>{const a=this.providersMap.get(e);a&&a.length>0&&i.push(this.callOnLogsFilesOfLogsProviders(a,t,n,e))})),(yield Promise.all(i)).every(Boolean)}))}timeoutSafeGetLogsFiles(e){let t;return Promise.race([e.getLogsFiles(),new Promise((n=>{t=this.host.setTimeout((()=>{this.logger.error(`Timed out fetching logs files from logs provider - ${e.logsProviderName}`),n([])}),this.logsProviderTimeoutMs)}))]).then((e=>(void 0!==t&&this.host.clearTimeout(t),e)))}callOnLogsFilesOfLogsProviders(e,t,n,i){return(0,c.mG)(this,void 0,void 0,(function*(){const a=e.map((e=>this.timeoutSafeGetLogsFiles(e))),o=yield Promise.all(a),r=[];o.forEach((e=>{e&&e.length>0&&r.push(...e)}));const s=r.map((e=>{try{return"latestErrors"===e.fileName?(n.content=`${n.content}${e.content}\r\n`,Promise.resolve(!0)):(i&&this.mtmaEnabled&&(e.fileName=`${i}-${e.fileName}`),t(e))}catch(t){return this.logger.error(`Error calling callback on logs file, ${null==e?void 0:e.fileName} - error:`,t),!1}}));return(yield Promise.all(s)).every((e=>e))}))}createSummaryFile(e,t){var n;return(0,c.mG)(this,void 0,void 0,(function*(){const i=yield null===(n=this.generateSummary)||void 0===n?void 0:n.call(this);return i&&(t.content=`${i}\r\n${t.content}`),e(t)}))}addFileIntoZip(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){return e.file(t.fileName,t.content),!0}))}}var PP=n(52961);class MP{constructor(e,t){this.coreTaskManager=e,this.userRenderingContextMap=new Map,this.logger=t.newLogger("RenderingContextManager")}cleanupWithPriority(e){return(0,c.mG)(this,void 0,void 0,(function*(){if(!this.defaultRenderingContext)return Promise.reject(new ze.G(ze.$.RENDERING_CONTEXT_DOES_NOT_EXIST));const t=this.userRenderingContextMap.keys(),n=Array.from(t).map((t=>()=>this.cleanupActiveWindowsHistoryService(e,t)));yield xP(n,this.defaultRenderingContext)}))}createCoreServices(){return(0,c.mG)(this,void 0,void 0,(function*(){this.logger.log("createCoreServices: start");const e=yield this.coreTaskManager.notifyLifeCycleEvent(_.sM.Initialization),{coreTaskErrors:t}=e,n=(0,c._T)(e,["coreTaskErrors"]);return this.defaultRenderingContext=n,this.logger.log("createCoreServices: done"),Object.assign(Object.assign({},n),{error:RP(t,n)})}))}executePrimaryUserTasks(e){return(0,c.mG)(this,void 0,void 0,(function*(){if(!this.defaultRenderingContext)return Promise.reject(new ze.G(ze.$.RENDERING_CONTEXT_DOES_NOT_EXIST));this.logger.log(`executePrimaryUserTasks(${null==e?void 0:e.id}): start`);const t=yield this.coreTaskManager.notifyLifeCycleEvent(_.sM.OnPrimaryUser,Object.assign(Object.assign({},this.defaultRenderingContext),{primaryUser:e,authenticationUser:e})),{coreTaskErrors:n}=t,i=(0,c._T)(t,["coreTaskErrors"]),a=RP(n,this.defaultRenderingContext);if(delete i.authenticationUser,this.primaryUserContext=i,a)throw a;return this.logger.log(`executePrimaryUserTasks(${null==e?void 0:e.id}): done`),this.primaryUserContext}))}removeAllRenderingContexts(e){return(0,c.mG)(this,void 0,void 0,(function*(){if(!this.defaultRenderingContext)return Promise.reject(new ze.G(ze.$.RENDERING_CONTEXT_DOES_NOT_EXIST));const t=this.userRenderingContextMap.keys(),n=Array.from(t).map((t=>()=>this.removeUserRenderingContext(e,t)));yield xP(n,this.defaultRenderingContext),this.primaryUserContext&&(yield this.coreTaskManager.destroyContext(this.primaryUserContext,e)),yield this.coreTaskManager.destroyContext(this.defaultRenderingContext,e)}))}getUserRenderingContext(e){return this.userRenderingContextMap.get(e)}getDefaultRenderingContext(){return this.defaultRenderingContext}getOrCreateUserRenderingContext(e){const t=(0,qe.b)(e);return this.defaultRenderingContext?(this.userRenderingContextMap.get(t)||this.userRenderingContextMap.set(t,this.createUserContextWithTelemetry(e,this.defaultRenderingContext)),this.userRenderingContextMap.get(t)):Promise.reject(new ze.G(ze.$.RENDERING_CONTEXT_DOES_NOT_EXIST,void 0,t))}removeUserRenderingContext(e,t){var n,i,a,o;return(0,c.mG)(this,void 0,void 0,(function*(){const r=this.userRenderingContextMap.get(t);if(r){let s;"unknown_destroy"===e&&(null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,"Removing user context due to unknown.","webclient_framework_foundation_core_services",void 0,!0)),this.userRenderingContextMap.delete(t);try{s=yield r}catch(e){let t;return t=e instanceof je.G?e.toTelemetryEntry():e&&`${e.name}::${e.message}`,null===(o=(a=this.logger).errorToTelemetry)||void 0===o||o.call(a,`${ze.$.CLEANUP}::contextPromise::${t}`,"webclient_framework_foundation_core_services",void 0,!0),!1}return this.cleanupUserRenderingContext(s,"unknown_destroy"===e?"signout":e)}return this.logger.warn("RenderingContextManager::contextPromise is not defined"),!1}))}createUserContextWithTelemetry(e,t){var n;return(0,c.mG)(this,void 0,void 0,(function*(){const{scenarioFactory:i}=t,a=!!(null===(n=t.coreSettings.get(A.J.Core))||void 0===n?void 0:n.enableMTMA),o=i.findScenario(ee.RG.GetAuthUser),[r,s]=rt(i);null==r||r.mark(ee.ck.CoreUserContextStart);const l=Date.now(),d=(0,qe.b)(e);try{const t=yield this.createUserRenderingContext(e,a);return this.reportUserContextSuccess({getUserAuthScenario:o,expReadyScenario:s,clientStartScenario:r,scenarioStartTime:l,userContextId:d,isMTMAEnabled:a,scenarioFactory:t.scenarioFactory}),t}catch(e){const n=st(e,d);throw this.reportUserContextFailure({getUserAuthScenario:o,expReadyScenario:s,scenarioStartTime:l,error:n,userContextId:d,isMTMAEnabled:a,scenarioFactory:t.scenarioFactory}),n}}))}reportUserContextSuccess({getUserAuthScenario:e,expReadyScenario:t,clientStartScenario:n,scenarioStartTime:i,userContextId:a,isMTMAEnabled:o,scenarioFactory:r}){var s;e&&e.stop(),null==t||t.mark(ee.ck.GetAuthUser),null==n||n.mark(ee.ck.CoreUserContextStop),o&&jP(r,a,i,null===(s=this.defaultRenderingContext)||void 0===s?void 0:s.windowProvider.performance).stop(void 0,"success")}reportUserContextFailure({getUserAuthScenario:e,expReadyScenario:t,scenarioStartTime:n,error:i,userContextId:a,isMTMAEnabled:o,scenarioFactory:r}){var s;e&&e.fail(),null==t||t.mark(ee.ck.GetAuthUser,void 0,"failure"),o&&jP(r,a,n,null===(s=this.defaultRenderingContext)||void 0===s?void 0:s.windowProvider.performance).fail({message:`Failed to create user context for ${a}`,errorCode:i.toTelemetryEntry()})}cleanupActiveWindowsHistoryService(e,t){var n,i,a;return(0,c.mG)(this,void 0,void 0,(function*(){let o;try{o=yield this.getUserRenderingContext(t)}catch(e){return}try{null===(n=null==o?void 0:o.activeWindowsHistoryService)||void 0===n||n.cleanup(e)}catch(e){const t=new ze.G(ze.$.CLEANUP,e);null===(a=(i=this.logger).errorToTelemetry)||void 0===a||a.call(i,t.toTelemetryEntry(),"webclient_framework_foundation_core_services_active_windows_history",void 0,!0)}}))}cleanupUserRenderingContext(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){return yield this.coreTaskManager.destroyContext(e,t),!0}))}createUserRenderingContext(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){const n=(0,qe.b)(e);this.logger.log(`createUserContext(${n}): start`);const i=yield this.coreTaskManager.notifyLifeCycleEvent(t?_.sM.OnUserAuthenticated_MTMA:_.sM.OnUserAuthenticated,Object.assign(Object.assign({},this.defaultRenderingContext),{authenticationUser:e}),(e=>{var i,a;return t&&(null===(i=this.defaultRenderingContext)||void 0===i?void 0:i.windowProvider.performance)&&function(e,t,n){const i=`mtma_core_task_end_${t}`;n.mark(i,{detail:{taskId:_.Yg[e]}})}(e,n,null===(a=this.defaultRenderingContext)||void 0===a?void 0:a.windowProvider.performance)})),{coreTaskErrors:a}=i,o=(0,c._T)(i,["coreTaskErrors"]),r=RP(a,this.defaultRenderingContext);if(r)throw r;return this.logger.log(`createUserContext(${n}): done`),o}))}}function jP(e,t,n,i){const a=e.createScenarioWithoutStarting(ee.RG.CoreUserContextCreate,{startTime:n});return i&&function(e,t,n,i){const a=i.timeOrigin,o=i.getEntriesByName(t,"mark")||[];for(const t of o){const i=t.detail.taskId;e.mark(`${n}${i}`,{overrideTimestamp:Math.round(t.startTime+a)})}i.clearMarks(t)}(a,`mtma_core_task_end_${t}`,"core_task_",i),a}function RP(e,t){let n;return e&&(null==e?void 0:e.length)>0&&(n=(null==t?void 0:t.coreSettings.get(A.J.Core).strictErrorMode)?e[0]:e.find((e=>e instanceof ze.G||e instanceof nd.l||e instanceof Re&&(e.prevError instanceof ze.G||e.prevError instanceof nd.l)))),n}function xP(e,t){var n;return(0,c.mG)(this,void 0,void 0,(function*(){if(null===(n=null==t?void 0:t.coreSettings.get(A.J.Core))||void 0===n?void 0:n.readInSequence)for(const t of e)yield t();else yield Promise.all(e.map((e=>e())))}))}const OP="authenticated_user_subscription_failed",LP="create_user_context_failed",UP="init_core_service_failure",BP="show_taskbar_caution_indicator_failed",WP="user_data_undefined",GP="user_renderingContext_generation_error",VP=(e,t,n)=>{e.errorToTelemetry&&e.errorToTelemetry(t,n,void 0,!0)};class HP{constructor(e){var t,n,i,a;this._activeWindows=new u.X([]),this._contextSubject=new m.t(1),this._isCleanupRunning=!1,this.AppStateToCleanupReasonMap=new Map([[l.quit,"quit"],[l.restart,"restart"]]),this.cleanupOnAppStateChangedCallback=e=>(0,c.mG)(this,void 0,void 0,(function*(){const{appState:t}=e;if(!ut.has(t))return;if(this._isCleanupRunning){const e=new ze.G(ze.$.CLEANUP,new Error(`cleanupOnAppStateChangedCallback run more than once ${t}`));return void(this._logger.warnToTelemetry&&this._logger.warnToTelemetry(e.toTelemetryEntry(),"webclient_framework_foundation_core_services",void 0,!0))}this._isCleanupRunning=!0;const n=this.AppStateToCleanupReasonMap.get(t);if(!n){const e=new ze.G(ze.$.CLEANUP,new Error(`cleanupOnAppStateChangedCallback has undefined reason from ${t}`));throw VP(this._logger,e.toTelemetryEntry(),"webclient_framework_foundation_core_services"),e}yield mt({hostCommunicationService:this.coreServices.hostCommunicationService,logger:this._logger,reason:n,renderingContextManager:this._renderingContextManager})})),this.trackAuthUsers=e=>{const t=this.isMTMACoreEnabled(e.coreSettings);return(0,g.z)((0,h.U)((e=>t?e:e.slice(0,1))),(0,h.U)((e=>e.map((e=>Object.assign(Object.assign({},e),{id:(0,qe.b)(e)}))))),ye((e=>(0,c.mG)(this,void 0,void 0,(function*(){return this.onUserAuthenticated(e)}))),(e=>(0,c.mG)(this,void 0,void 0,(function*(){return this.onUserDestroy(yield e)}))),((e,t)=>(0,c.mG)(this,void 0,void 0,(function*(){return t}))),((e,n)=>{if(!t)throw n})))};const o=(0,Q.J)(),r=(null==o?void 0:o.defaultConsoleLogLevel)||(null===(n=null===(t=null==o?void 0:o.loader)||void 0===t?void 0:t.getInitConsoleLogLevel)||void 0===n?void 0:n.call(t)),s=new oe(e.config.experienceName,d.DiagnosticsLogsMain,null==r?void 0:r.preECSConsoleLogLevel,null==r?void 0:r.userConsoleLogLevel),p=new pe(s,"00000000-0000-0000-0000-000000000000");this._config=e.config;const v=new Me(p,this._config,e.apps);this._logger=p.newLogger("Core");const S=new FP(p,o);o.addEventListener("downloadLogs",(()=>(0,c.mG)(this,void 0,void 0,(function*(){const e=new PP.N(p,S);yield e.downloadLogsFiles(o)})))),S.registerCoreLogsProvider(s);const f=null===(a=null===(i=null==o?void 0:o.loader)||void 0===i?void 0:i.getLogsProvider)||void 0===a?void 0:a.call(i);f&&S.registerCoreLogsProvider(f);const y=e.config.useReactWebClientCoreTasks?{Initialization:()=>[new ku,new JN,new gD,new aN,new WA,new B_,new _u,new bg,new DD,new Im,new iA,new WD,new pD,new KN,new AA,new ED,new JF,new QI,new TA,new TI,new fs,new OD,new XA,new ld,new GI,new OI,new pd,new ID,new W_,new qI,new yl,new BD,new SD,new x_,new yu,new Su,new vD,new vm,new _A,new C_,new Au,new Iu,new II,new _g,new j_,new _I,new Sm,new RI,new Ig,new HN,new YF,new oP,new Sd,new KA,new IA],OnPrimaryUser:()=>[new tP,new eP,new PE,new ZF,new GD,new AD,new XF],OnUserAuthenticated:()=>[new tP,new PE,new rd,new wD,new NA,new kd,new mP,new lP,new Wc,new Bc,new xD,new uD,new kD,new Mr,new zN,new aP,new hD,new cP,new UD,new Sm,new RA,new xr,new KF,new Cs,new fD,new rP,new uP],OnUserAuthenticated_MTMA:()=>[new tP,new ME,new PE,new NA,new sP,new Tg,new rd,new qI,new yl,new TI,new vd,new dP,new mP,new hD,new cP,new UD,new kd,new vu,new YN,new Au,new _g,new _I,new Sm,new wD,new Wc,new Bc,new xD,new uD,new kD,new Mr,new zN,new aP,new RA,new xr,new KF,new Cs,new fD,new rP,new uP]}:{Initialization:()=>[new EP,new ku,new JN,new gD,new aN,new hP,new pP,new WA,new B_,new _u,new bg,new DD,new Im,new iA,new pD,new AA,new JF,new TA,new TI,new fs,new gP,new XA,new GI,new OI,new ld,new pd,new ID,new W_,new qI,new yl,new BD,new x_,new yu,new Su,new vm,new _A,new C_,new Au,new Iu,new II,new j_,new _I,new Ig,new HN,new RI,new NP,new Sd,new KA,new IA],OnUserAuthenticated:()=>[new tP,new PE,new ZF,new DP,new UD,new wD,new NA,new kd,new lP,new Wc,new xD,new kD,new aP,new hD,new cP,new KF,new uP]};this._taskManagerService=new Le(p,v,e.config,e.loadConfigs,this.getDefaultCorrelation(),y,s,S,this.waitForRenderingContextReady.bind(this),this.isEntityInView.bind(this),e.criticalDynamicImports,e.getPlatformConfigurationOverrides),this._templateGenerator=e.generateChildWindowTemplate,this._trackWindowsOperator=zo,this._renderingContextManager=new MP(this._taskManagerService,p)}get activeWindows(){return this._activeWindows}init(){var e,t;return(0,c.mG)(this,void 0,void 0,(function*(){try{const n=yield this.initializeCoreServices();!function(e){const{coreSettings:t,logsCollectorService:n}=e,{testAutomation:i}=t.get(A.J.Test);if(i){const e=window;e.WeakRef&&(e.hooks||(e.hooks={}),e.hooks.__TEST_ONLY_LOGS_COLLECTOR_SERVICE_REF=new e.WeakRef(n))}}(n),this._config.supportsAsyncUserContext||(yield this.awaitUserContextIfAvailable()),this.signalCoreInitSuccess(n);const i={logger:this._logger,renderingContextManager:this._renderingContextManager};null===(t=null===(e=n.authenticationService)||void 0===e?void 0:e.registerCleanUpOnLogoutCallback)||void 0===t||t.call(e,(e=>gt(Object.assign(Object.assign({},i),{coreSettings:n.coreSettings,reason:"signout",user:e&&(0,qe.K)(e)})))),this.registerForAppStateChanged(n.hostCommunicationService)}catch(e){throw this.reportCoreInitError(e,this._coreServices),e}}))}get coreServices(){if(!this._coreServices)throw(0,he.Tr)("Entry",_.jK.NotPresent,"CoreServices not available");return this._coreServices}getDefaultCorrelation(){const e=Xe({source:I.D.ExternalCommand,externalId:this._config.externalCorrelationId});return e.id=`Core-${e.id}`,e}initializeCoreServices(){return(0,c.mG)(this,void 0,void 0,(function*(){const e=yield this._renderingContextManager.createCoreServices(),{error:t}=e,n=(0,c._T)(e,["error"]);return this._coreServices=n,this.initializeKPIs(n.scenarioFactory),t&&this.handleError(t),this.setupNavigationHandling(n),this.observeAuthenticatedUsers(n),n}))}signalCoreInitSuccess(e){var t,n,i,a,o,r,s;const[l,d]=rt(e.scenarioFactory);null==d||d.mark(ee.ck.InitCoreServicesComplete),null==l||l.mark(ee.ck.CoreInitStop),l&&(null===(i=null===(n=null===(t=(0,Q.J)())||void 0===t?void 0:t.loader)||void 0===n?void 0:n.stopPieTimer)||void 0===i||i.call(n)),this._logger.log("hostComms::setCoreInitialized"),e.hostCommunicationService.loadModule("core").then((e=>{var t;null===(t=null==e?void 0:e.setCoreInitialized)||void 0===t||t.call(e)})),this.markCoreInitCompleteInAltScenario(e.altScenarioService);const c=Date.now();e.telemetryService.setCoreInitTime(c),e.logsCollectorService.setGetSummaryFunction(lt(null===(a=this._coreServices)||void 0===a?void 0:a.platformService,null===(o=this._coreServices)||void 0===o?void 0:o.i18n,null===(r=this._coreServices)||void 0===r?void 0:r.authenticationService,null===(s=this._coreServices)||void 0===s?void 0:s.coreSettings))}handleError(e){if(this.reportCoreInitError(e,this._coreServices),!this.canDisplayCriticalErrorPage(this._coreServices))throw e;this._contextSubject.error(st(e))}setupNavigationHandling(e){if(!this.canHandleNavigationIntents(e))throw(0,he.Tr)(_.w5.Core,_.jK.CoreNavigationServicesMissing,"Unable to process navigation intents");e.coreSettings.get(A.J.Core).enableIframeTracking&&(this._trackWindowsOperator=ko),this.observeWindows(e).subscribe(this._activeWindows),((e,t)=>{const{windowProvider:n,loggerFactory:i,clientState:a,dataClientTrackingService:o,windowTrackerService:r,graphqlOpsCountService:s,leakDetectorService:l}=e,d=i.newLogger("Main-Window-Event-Listeners");(0,Io.R)(n.opener,K.rY.ShouldShowChatNotification).pipe((0,Ao.M)(t,a.observe())).subscribe((([i])=>(0,c.mG)(void 0,void 0,void 0,(function*(){try{if(!i||!i.payload||!i.payload.convId)throw new Error(`Invalid payload for shouldShowChatNotification with ${JSON.stringify(i)}`);let a=Rt.EntityType.chats;i.payload.entityType?a=i.payload.entityType:d.log(`null entityType received: ${i.payload.entityType}`),d.log(`Received shouldShowNotification request for conv ${i.payload.convId} with entityType ${a}`);const o=yield it({action:Ie.u.view,id:i.payload.convId,linkedEntity:null,type:a},e.client,d),r=!at(o,t,e.clientState);No(n,r,o),d.log(`Sending windowid: ${o} and shouldShowChatNotification: ${r} for conv ${i.payload.convId}`)}catch(e){d.error(`Failed to query window for entity with error ${e}`),No(n,!0,void 0)}})))),null==r||r.init(),(0,Io.R)(n.opener,K.rY.GetWindowEntityTypeStats).subscribe((()=>{n.opener.postMessage(K.rY.GetWindowEntityTypeStats,{windowEntityTypeStats:null==r?void 0:r.getTelemetry()})})),(0,Io.R)(n.opener,K.rY.GetApolloCacheStats).subscribe((()=>{n.opener.postMessage(K.rY.GetApolloCacheStats,{apolloCacheStats:null==o?void 0:o.getTelemetry()})})),s&&(0,Io.R)(n.opener,K.rY.GetCdlStats).subscribe((()=>{n.opener.postMessage(K.rY.GetCdlStats,{cdlStats:null==s?void 0:s.getLatestDataAndClear()})}));(0,Io.R)(n.opener,K.rY.GetHeartbeat).subscribe((()=>{let t="";e.appResponsivenessService&&(t=e.appResponsivenessService.getTelemetry()),n.opener.postMessage(K.rY.GetHeartbeat,{windowEntityTypeStats:null==r?void 0:r.getTelemetry(),apolloCacheStats:null==o?void 0:o.getTelemetry(),ariTelemetry:t,OLDStats:null==l?void 0:l.getTelemetry()})}))})(e,this.activeWindows),e.deeplinkService.init()}awaitUserContextIfAvailable(){return(0,c.mG)(this,void 0,void 0,(function*(){yield this._contextSubject.pipe((0,v.P)()).toPromise()}))}initializeKPIs(e){var t,n,i;if(e){const a=e.findScenario(ee.RG.ClientStart),o=null===(i=null===(n=null===(t=(0,Q.J)())||void 0===t?void 0:t.loader)||void 0===n?void 0:n.getProperties)||void 0===i?void 0:i.call(n);(null==o?void 0:o.deeplinkId)&&(null==a||a.appendEventData({deeplinkId:o.deeplinkId})),(null==o?void 0:o.RelaunchReason)&&(null==a||a.appendEventData({RelaunchReason:o.RelaunchReason})),null==a||a.mark(ee.ck.CoreInitStart)}const a=null==e?void 0:e.findScenario(ee.RG.ExperienceReady);null==a||a.mark(ee.ck.InitCoreServices),null==a||a.startStep(ee.ck.GetAuthUser)}reportCoreInitError(e,t={}){var n,i,a,o,r,s,l,d,u;const m=e instanceof je.G?(e=>e.prevError||(0,he.Tr)(_.w5.Core,_.jK.NotInitialized,e.code,void 0,e.message))(e):e,g=m.context===_.w5.Core?m:(0,he.Tr)(_.w5.Core,m.code||_.jK.NotInitialized,m.context,{innerError:m}),p=g.subContext||"UnknownCoreInitFailure",h=(0,me.A)((0,he.B9)(g));this._logger.warn(`Initializing Core failed. Message: ${h}, subContext: ${p}`);const[v,S]=rt(t.scenarioFactory);null==v||v.fail({errorCode:e instanceof je.G?e.toTelemetryEntry():null!==(n=g.code)&&void 0!==n?n:_.jK.CoreInitFailure}),v&&(null===(o=null===(a=null===(i=(0,Q.J)())||void 0===i?void 0:i.loader)||void 0===a?void 0:a.stopPieTimer)||void 0===o||o.call(a)),null==S||S.fail({contentType:(0,me.A)(`${g.context}-${g.subContext}`),errorCode:(0,he.qZ)(g),errors:h,reason:UP}),null===(s=null===(r=null==t?void 0:t.altScenarioService)||void 0===r?void 0:r.altScenario)||void 0===s||s.fail({reason:_.jK.CoreInitFailure}),null===(l=null==t?void 0:t.windowProvider)||void 0===l||l.opener.postMessage(N.W.CoreInitializationFailed,{errorDescription:p}),(null===(u=null===(d=null==t?void 0:t.coreSettings)||void 0===d?void 0:d.get(A.J.Core))||void 0===u?void 0:u.enableTaskbarIconOnCoreInitFailure)&&function(e,t){var n;(0,c.mG)(this,void 0,void 0,(function*(){try{const t=yield null==e?void 0:e.loadModule("taskbar");null===(n=null==t?void 0:t.showBadge)||void 0===n||n.call(t,{icon:{glyphBadge:{glyph:T.attention}}})}catch(e){VP(t,`${BP}: ${e}`,"webclient_framework_foundation_core_services")}}))}(null==t?void 0:t.hostCommunicationService,this._logger)}markCoreInitCompleteInAltScenario(e){var t,n;null===(t=null===performance||void 0===performance?void 0:performance.mark)||void 0===t||t.call(performance,b),null===(n=null==e?void 0:e.altScenario)||void 0===n||n.mark(ee.ck.PostCoreInitializationTasks)}waitForRenderingContextReady(e,t){var n;return(0,c.mG)(this,void 0,void 0,(function*(){return this.isMTMACoreEnabled(null===(n=this._coreServices)||void 0===n?void 0:n.coreSettings)?this.getOrCreateRenderingContextForId(t):this._contextSubject.pipe((0,S.h)((t=>{var n;return!e||!!(null===(n=t.authenticationUser)||void 0===n?void 0:n.isAuthenticated)})),(0,v.P)()).toPromise()}))}getExistingContextForId(e){if(!e){const e=this._renderingContextManager.getDefaultRenderingContext();return e&&Promise.resolve(e)||Promise.reject(new ze.G(ze.$.RENDERING_CONTEXT_DOES_NOT_EXIST))}return this._renderingContextManager.getUserRenderingContext(e)}getContextObservable(e,t){var n;return e?(0,p.D)(null!==(n=this.getExistingContextForId(t))&&void 0!==n?n:Promise.reject(new ze.G(ze.$.RENDERING_CONTEXT_DOES_NOT_EXIST))):this._contextSubject}getOrCreateRenderingContextForId(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){const n=yield this.getExistingContextForId(e);if(n)return n;const i=e&&this._coreServices&&(yield function(e,t,n){return(0,c.mG)(this,void 0,void 0,(function*(){const i=yield n.getUser({correlation:e,accountId:t});return i&&i.isAuthenticated?(0,qe.K)(i):void 0}))}(Object.assign(Object.assign({},Xe({source:I.D.Core})),{scenarioName:ee.RG.AuthWebCachedUser}),e,null===(t=this._coreServices)||void 0===t?void 0:t.authenticationService));return i?(yield this.tryExecutePrimaryUserTasks(),this._renderingContextManager.getOrCreateUserRenderingContext(i)):Promise.reject(new ze.G(ze.$.USER_DOES_NOT_EXIST,void 0,e))}))}isMTMACoreEnabled(e){var t;return!!(null===(t=null==e?void 0:e.get(A.J.Core))||void 0===t?void 0:t.enableMTMA)&&!!this._config.supportsAsyncUserContext}tryExecutePrimaryUserTasks(){var e,t,n,i;return(0,c.mG)(this,void 0,void 0,(function*(){if(!this._taskManagerService.hasTasks(_.sM.OnPrimaryUser))return;if(null===(e=this._coreServices)||void 0===e?void 0:e.primaryUser)return;if(this._primaryUserTasksPromise)return this._primaryUserTasksPromise;const a=null===(t=this._coreServices)||void 0===t?void 0:t.authenticationService,o=yield null===(n=null==a?void 0:a.getCachedUsers)||void 0===n?void 0:n.call(a,Object.assign(Object.assign({},Xe({source:I.D.Core})),{scenarioName:ee.RG.AuthWebCachedUser}),{isPrimaryUser:!0,isAuthenticated:!0}),r=null===(i=null==o?void 0:o.filter((e=>!0===e.isAuthenticated)))||void 0===i?void 0:i[0];return r&&!this._primaryUserTasksPromise&&(this._primaryUserTasksPromise=this._renderingContextManager.executePrimaryUserTasks((0,qe.K)(r)).then((e=>{this._coreServices=e}))),this._primaryUserTasksPromise}))}observeAuthenticatedUsers(e){this.observeUsers(e,this._logger).pipe(this.trackAuthUsers(e),(0,f.K)((t=>{var n,i,a;null===(i=(n=this._logger).errorToTelemetry)||void 0===i||i.call(n,`Core Initialization: ${GP}`,"webclient_framework_foundation_core_services",{errorCode:t.toTelemetryEntry(),message:t.message},!0);const o=(0,he.Tr)("Core",_.jK.NotInitialized,null===(a=t.prevError)||void 0===a?void 0:a.context,{innerError:t.prevError});throw e.errorState.error=o,e.coreSettings.get(A.J.Core).enableCoreErrorsV2?t:o})),(0,y.b)((()=>{const[t,n]=rt(e.scenarioFactory);null==t||t.mark(ee.ck.CoreRenderingContextReady)})),(0,h.U)((e=>e.length>0?e[0]:this._renderingContextManager.getDefaultRenderingContext()))).subscribe(this._contextSubject)}canDisplayCriticalErrorPage(e){return!!((null==e?void 0:e.rebootService)&&e.i18n&&e.scenarioFactory&&e.coreSettings&&e.hostCommunicationService&&e.coreSettings.get(A.J.Core).enableCoreErrorsV2)}canHandleNavigationIntents(e){return!!((null==e?void 0:e.client)&&e.deeplinkService&&e.entityCommanding)}registerForAppStateChanged(e){var t;return(0,c.mG)(this,void 0,void 0,(function*(){let n;try{n=yield e.loadModule("core")}catch(e){const t=`HostComms:: ${Jr.LoadModuleCoreFailed} registerForAppStateChanged`;return void VP(this._logger,t,"webclient_framework_host_comms")}try{null===(t=null==n?void 0:n.registerForAppStateChanged)||void 0===t||t.call(n,this.cleanupOnAppStateChangedCallback)}catch(e){const t=`HostComms:: ${Jr.RegisterForAppStateChangedFailed}`;return void VP(this._logger,t,"webclient_framework_host_comms")}}))}observeWindows(e){const t=this.isMTMACoreEnabled(e.coreSettings);return _e(e.client.watchQuery({query:Be})).pipe((0,S.h)((({errors:e,loading:t})=>void 0===e&&!t)),(0,h.U)((({data:{activeWindows:e}})=>e.map((t=>Object.assign(Object.assign({},t),{screenState:{numOpenWindows:e.length}}))))),this._trackWindowsOperator(this.getContextObservable.bind(this,t),e,this._templateGenerator))}observeUsers(e,t){const n=this.observeUsersEvents(e.client);return _e(n).pipe((0,h.U)((e=>this.toUserContexts(e,t))),(0,f.K)((e=>{var t,n;const i=`Core Initialization: ${OP}`;throw null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,i,"webclient_framework_foundation_core_services",{errorCode:e.code,context:e.context,message:e.message,errors:`${null==e?void 0:e.reason}-${(0,R.u4)(null==e?void 0:e.serverResponse)}`},!0),st(e)})))}observeUsersEvents(e){const t={filter:{isAuthenticated:!0}},n=e.watchQuery({query:Ge,variables:t});return n.subscribeToMore({document:We,variables:t,updateQuery:(e,t)=>t.subscriptionData.data.authenticationUsersEvent}),n}onUserAuthenticated(e){return(0,c.mG)(this,void 0,void 0,(function*(){return yield this.tryExecutePrimaryUserTasks(),this._renderingContextManager.getOrCreateUserRenderingContext(e)}))}onUserDestroy(e){const t={logger:this._logger,renderingContextManager:this._renderingContextManager},n=e.authenticationUser;n&&gt(Object.assign(Object.assign({},t),{coreSettings:e.coreSettings,reason:"unknown_destroy",user:n}))}toUserContexts({data:e,loading:t,errors:n},i){var a;if(n)throw VP(i,LP,"webclient_framework_foundation_core_services"),(0,ve.E6)({graphQLErrors:n.concat(),extraInfo:void 0,networkError:null,name:"AuthenticationUsers subscription error",message:"Error in authentication users subscription"});if(!t){if(!e)return VP(i,WP,"webclient_framework_foundation_core_services"),[];return(null!==(a=e.authenticationUsers)&&void 0!==a?a:[]).filter((e=>!0===e.isAuthenticated)).map(this.toUserContext)}return[]}toUserContext(e){const{id:t,isAuthenticated:n,cloud:i,profile:{tenantId:a,objectId:o,puid:r},role:s,type:l,subType:d,loginUserName:c}=e;return{id:t,isAuthenticated:n,profile:{tenantId:a,objectId:o,puid:r},cloud:i,role:s,type:l,subType:d,loginUserName:c}}isEntityInView(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){if(!this._coreServices)return Promise.resolve(!1);const{clientState:n}=this._coreServices;return function(e,t,n,i,a){return(0,c.mG)(this,void 0,void 0,(function*(){return at(yield it(e,t,a),i,n)}))}(e,t,n,this._activeWindows,this._logger)}))}}},50112:(e,t,n)=>{"use strict";n.d(t,{q:()=>d});var i,a=n(13637),o=n(55997),r=n(75068),s=n(38923),l=n(34255);!function(e){e[e.clean=0]="clean",e[e.registrationToken=1]="registrationToken",e[e.skypeToken=2]="skypeToken"}(i||(i={}));class d{constructor(e){this.discover=e}authorizeRequest(e,t="Authentication"){return(0,a.mG)(this,void 0,void 0,(function*(){let n,i;const r=(e,o)=>(0,a.mG)(this,void 0,void 0,(function*(){const a=Object.assign({},e.headers);if(this.registrationToken)a.RegistrationToken=this.registrationToken;else{n=i;const r=performance.now(),s=yield this._validateSkypeToken({invalidSkypeToken:i,forceRenew:o});i=s.skypeToken,yield this.validateAndThrowIfTokensAreSameOrInvalid("Skype::authorizeRequest",i,n,o),e.authPerformanceLogs=Object.assign(Object.assign({},e.authPerformanceLogs),{skypeTokenDelta:performance.now()-r,skypeTokenFromCache:s.fromCache}),a[t]=this.formatAuthHeader(t,i)}return e.headers=a,e}));return{request:yield r(e),resolver:(e,t)=>(0,a.mG)(this,void 0,void 0,(function*(){const{status:i,headers:{"set-registrationtoken":a}}=e;if(i===o.qb.NOT_AUTHORIZED){if(this.registrationToken&&delete this.registrationToken,!n)return r(t,!0)}else a&&i!==o.qb.NOT_FOUND&&this.parseToken(a)}))}}))}authorize(e,t="Authentication"){return n=>(0,a.mG)(this,void 0,void 0,(function*(){let a,r,s=!1,l=i.clean;for(let d=0;d<=2;++d){const d=Object.assign({},n.headers),c=this.registrationToken;if(c)d.RegistrationToken=c;else{const e=performance.now(),i=yield this._validateSkypeToken({invalidSkypeToken:a,forceRenew:s});yield this.validateAndThrowIfTokensAreSameOrInvalid("Skype::authorize",null==i?void 0:i.skypeToken,a,s),a=i.skypeToken,n.authPerformanceLogs=Object.assign(Object.assign({},n.authPerformanceLogs),{skypeTokenDelta:performance.now()-e,skypeTokenFromCache:i.fromCache}),d[t]=this.formatAuthHeader(t,a)}n.headers=d,r=yield e(n);const{status:u,headers:{"set-registrationtoken":m}}=r;if(u===o.qb.NOT_AUTHORIZED)if(c){if(c===this.registrationToken&&delete this.registrationToken,l===i.clean){a=void 0,l=i.registrationToken;continue}}else if(!s&&l!==i.skypeToken){s=!0,l=i.skypeToken;continue}return m&&u!==o.qb.NOT_FOUND&&this.parseToken(m),r}return this.validateResponse(r)}))}validateAndThrowIfTokensAreSameOrInvalid(e,t,n,i){var o;return(0,a.mG)(this,void 0,void 0,(function*(){const a=t===n;if(this.discover.getSettingToDisableSkypeTokenValidation&&this.discover.getSettingToDisableSkypeTokenValidation(i,a))return;const d=this.discover.shouldThrowErrorIfSkypeTokenIsEmpty&&this.discover.shouldThrowErrorIfSkypeTokenIsEmpty(),c=!t||(0,l.isEmpty)(t.trim());if(a||d&&c){const n=yield this.discover.skypeid();throw(0,s.Tr)("Discover",r.jK.FailedToUpdate,e,void 0,`Failed to update token. skypeId startsWith: ${null===(o=null==n?void 0:n.split(":"))||void 0===o?void 0:o[1]}, new token: ${+!!t}, isTokenSame: ${a}, isNewTokenEmptyOrUndefined: ${c}, forceRenew: ${i}`)}}))}_validateSkypeToken(e){return(0,a.mG)(this,void 0,void 0,(function*(){return this.discover.validateSkypeTokenV2?this.discover.validateSkypeTokenV2(e):{skypeToken:yield this.discover.validateSkypeToken(e)}}))}validateResponse(e){if(!e)throw(0,s.Tr)(r.w5.Authentication,r.jK.UndefinedGlobalError,"",void 0,"Failed to authenticate response");return e}formatAuthHeader(e,t){return"Authentication"===e?`skypetoken=${t}`:"x-skypetoken"===e?t:`skype_token ${t}`}parseToken(e){const t=(0,l.fromPairs)(e.split(";").map((e=>e.split("=",2).map((e=>e.trim()))))),{expires:n}=t,i=(0,a._T)(t,["expires"]);i.endpointId&&(this.registrationToken=(0,l.toPairs)(i).map((e=>e.join("="))).join("; "))}}},6766:(e,t,n)=>{"use strict";var i,a,o,r,s,l,d,c,u,m,g,p,h,v,S,f,y,k,C,b,T,w,_,I,A,N,E,D,F,P,M,j,R,x,O,L,U,B,W,G,V,H,$,z,q,J,Q,K,Y,X,Z,ee,te,ne,ie,ae,oe,re,se,le,de,ce,ue,me,ge,pe,he,ve,Se,fe;n.d(t,{zH:()=>i,jE:()=>r,Yl:()=>s,Pn:()=>W,gG:()=>V,TB:()=>J,m1:()=>ee,vG:()=>te,$w:()=>pe,oj:()=>ve}),function(e){e.Adult="Adult",e.MinorNoParentalConsentRequired="MinorNoParentalConsentRequired",e.MinorWithMsaParentalConsent="MinorWithMsaParentalConsent",e.MinorWithoutMsaParentalConsent="MinorWithoutMsaParentalConsent",e.NotAdult="NotAdult"}(i||(i={})),function(e){e.Msa="Msa",e.Aad="Aad"}(a||(a={})),function(e){e.Skype="Skype",e.AAD="AAD",e.CAE="CAE"}(o||(o={})),function(e){e.Discoverable="Discoverable",e.Undiscoverable="Undiscoverable",e.Unknown="Unknown"}(r||(r={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.ForceEnabled="ForceEnabled",e.ForceDisabled="ForceDisabled"}(s||(s={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(l||(l={})),function(e){e.EveryoneInCompany="EveryoneInCompany",e.Everyone="Everyone"}(d||(d={})),function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Local="Local",e.Microsoft="Microsoft",e.Preview="Preview",e.Production="Production",e.Staging="Staging",e.SyntheticTraffic="SyntheticTraffic"}(c||(c={})),function(e){e.cancel="cancel",e.fail="fail",e.incomplete="incomplete",e.success="success"}(u||(u={})),function(e){e.PowerPoint="PowerPoint",e.Excel="Excel",e.Word="Word",e.Visio="Visio",e.OneNote="OneNote",e.Whiteboard="Whiteboard",e.Undefined="Undefined"}(m||(m={})),function(e){e.Present="Present",e.Collaboration="Collaboration",e.None="None"}(g||(g={})),function(e){e.NoPermission="NoPermission",e.SingleStepPermission="SingleStepPermission",e.MultiStepPermission="MultiStepPermission",e.None="None"}(p||(p={})),function(e){e.AlwaysEnabled="AlwaysEnabled",e.AlwaysDisabled="AlwaysDisabled",e.UserOverride="UserOverride"}(h||(h={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.UserOverride="UserOverride"}(v||(v={})),function(e){e.DisabledUserOverride="DisabledUserOverride",e.Disabled="Disabled"}(S||(S={})),function(e){e.DisabledUserOverride="DisabledUserOverride",e.Disabled="Disabled"}(f||(f={})),function(e){e.Disabled="Disabled",e.Enabled="Enabled"}(y||(y={})),function(e){e.horizontal="horizontal",e.horizontalEnd="horizontalEnd",e.overflow="overflow",e.indicators="indicators"}(k||(k={})),function(e){e.Compact="Compact",e.Inline="Inline",e.Split="Split",e.Stacked="Stacked"}(C||(C={})),function(e){e.None="None",e.FreeTask="FreeTask",e.Idle="Idle"}(b||(b={})),function(e){e.AlwaysKeep="AlwaysKeep",e.MergeWithNext="MergeWithNext",e.MergeWithPrevious="MergeWithPrevious"}(T||(T={})),function(e){e.Disabled="Disabled",e.Enabled="Enabled"}(w||(w={})),function(e){e.NotificationOnly="NotificationOnly",e.ConferenceMuted="ConferenceMuted",e.ConferenceUnMuted="ConferenceUnMuted"}(_||(_={})),function(e){e.v0="v0",e.v1="v1",e.international="international"}(I||(I={})),function(e){e.Disabled="Disabled",e.SingleApplication="SingleApplication",e.EntireScreen="EntireScreen"}(A||(A={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.EnabledExceptAnonymous="EnabledExceptAnonymous"}(N||(N={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(E||(E={})),function(e){e.Unknown="Unknown",e.Online="Online",e.OnPrem="OnPrem"}(D||(D={})),function(e){e.Immediate="Immediate",e.Simultaneous="Simultaneous",e.Unanswered="Unanswered"}(F||(F={})),function(e){e.Voicemail="Voicemail",e.SingleTarget="SingleTarget",e.MyDelegates="MyDelegates",e.DoNothing="DoNothing",e.Group="Group"}(P||(P={})),function(e){e.Ring="Ring",e.Mute="Mute"}(M||(M={})),function(e){e.BackgroundEffect="BackgroundEffect",e.BackgroundAPL="BackgroundAPL"}(j||(j={})),function(e){e.Cameo="Cameo",e.ContentOnly="ContentOnly",e.Weatherperson="Weatherperson",e.SideBySide="SideBySide",e.NewsAnchor="NewsAnchor"}(R||(R={})),function(e){e.Disabled="Disabled",e.ReceiveOnly="ReceiveOnly",e.SendOnly="SendOnly",e.Inactive="Inactive",e.Bidirectional="Bidirectional"}(x||(x={})),function(e){e.fail="fail",e.incomplete="incomplete",e.cancel="cancel"}(O||(O={})),function(e){e.Grid="Grid",e.SpeakerView="SpeakerView",e.MixedGridView="MixedGridView"}(L||(L={})),function(e){e.sendMessage="sendMessage"}(U||(U={})),function(e){e.Mac="Mac",e.Windows="Windows"}(B||(B={})),function(e){e.ams="ams",e.amsV2="amsV2",e.appMonetizationService="appMonetizationService",e.appService="appService",e.calling_registrarUrl="calling_registrarUrl",e.calling_trouterUrl="calling_trouterUrl",e.chatService="chatService",e.chatServiceAfd="chatServiceAfd",e.chatSvcAggAfd="chatSvcAggAfd",e.cmdArtifactsService="cmdArtifactsService",e.consumerLicenses="consumerLicenses",e.groupsServiceV2="groupsServiceV2",e.middleTier="middleTier",e.mtImageService="mtImageService",e.powerPointStateService="powerPointStateService",e.search="search",e.teamsAndChannelsProvisioningService="teamsAndChannelsProvisioningService",e.teamsEventsIntegration="teamsEventsIntegration",e.teamsPushServiceAfd="teamsPushServiceAfd",e.unifiedPresence="unifiedPresence",e.urlp="urlp",e.urlpV2="urlpV2",e.userEntitlementService="userEntitlementService",e.userProfileService="userProfileService",e.virtualEventsService="virtualEventsService"}(W||(W={})),function(e){e.UserChoice="UserChoice",e.AdminDisabled="AdminDisabled",e.MicrosoftChoice="MicrosoftChoice"}(G||(G={})),function(e){e.Disabled="Disabled",e.DryRun="DryRun",e.DryRunQuiet="DryRunQuiet",e.Enabled="Enabled",e.EnabledQuiet="EnabledQuiet"}(V||(V={})),function(e){e.None="None",e.Error="Error",e.Warn="Warn",e.Info="Info",e.Debug="Debug",e.Verbose="Verbose",e.Max="Max"}(H||(H={})),function(e){e.team="team",e.personal="personal",e.groupChat="groupChat",e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat"}($||($={})),function(e){e.query="query",e.action="action",e.Query="Query",e.Action="Action"}(z||(z={})),function(e){e.Rating="Rating",e.Verbatim="Verbatim"}(q||(q={})),function(e){e.Petrol="Petrol",e.ODS="ODS"}(J||(J={})),function(e){e.Legacy="Legacy",e.Graph="Graph",e.Vroom="Vroom"}(Q||(Q={})),function(e){e.Osearch="Osearch",e.AllFiles="AllFiles"}(K||(K={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.EnabledUserOverride="EnabledUserOverride",e.DisabledUserOverride="DisabledUserOverride"}(Y||(Y={})),function(e){e.Full="Full",e.Limited="Limited",e.Restricted="Restricted"}(X||(X={})),function(e){e.Everyone="Everyone",e.None="None",e.UserPreference="UserPreference"}(Z||(Z={})),function(e){e.Strict="Strict",e.Moderate="Moderate",e.NoRestriction="NoRestriction"}(ee||(ee={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(te||(te={})),function(e){e.Chat="Chat",e.FlyoutInlineChat="FlyoutInlineChat",e.ChannelPost="ChannelPost",e.ChannelReply="ChannelReply",e.DiscoverSurfacePost="DiscoverSurfacePost"}(ne||(ne={})),function(e){e.Staging="Staging",e.Dogfood="Dogfood",e.Prod="Prod"}(ie||(ie={})),function(e){e.fixedByHost="fixedByHost",e.grow="grow",e.growHeight="growHeight"}(ae||(ae={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(oe||(oe={})),function(e){e.small="small",e.medium="medium",e.large="large"}(re||(re={})),function(e){e.Discoverable="Discoverable",e.Undiscoverable="Undiscoverable",e.Unknown="Unknown"}(se||(se={})),function(e){e.bubble="bubble",e.flat="flat"}(le||(le={})),function(e){e.df="df",e.msit="msit"}(de||(de={})),function(e){e.inTenantResults="inTenantResults",e.federatedAndBotResults="federatedAndBotResults",e.teamTagResults="teamTagResults",e.groupChatResults="groupChatResults",e.pstnResults="pstnResults"}(ce||(ce={})),function(e){e.Disabled="Disabled",e.EnabledTeamOwner="EnabledTeamOwner",e.EnabledTeamOwnerMember="EnabledTeamOwnerMember"}(ue||(ue={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(me||(me={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(ge||(ge={})),function(e){e.None="None",e.CitrixXenDesktop="CitrixXenDesktop",e.CitrixXenApp="CitrixXenApp",e.VMWare="VMWare",e.WVD="WVD"}(pe||(pe={})),function(e){e.Web="Web",e.Desktop="Desktop",e.Rigel="Rigel",e.SurfaceHub="SurfaceHub"}(he||(he={})),function(e){e.Unknown="Unknown",e.Teacher="Teacher",e.Student="Student",e.Anonymous="Anonymous"}(ve||(ve={})),function(e){e.Everyone="Everyone",e.EveryoneInCompanyExcludingGuests="EveryoneInCompanyExcludingGuests"}(Se||(Se={})),function(e){e.SingleChoice="SingleChoice",e.MultiChoice="MultiChoice",e.SingleLineText="SingleLineText",e.MultiLineText="MultiLineText"}(fe||(fe={}))},59270:(e,t,n)=>{"use strict";var i;n.d(t,{hO:()=>i,K$:()=>a,v4:()=>o,F_:()=>r,jq:()=>s,QI:()=>l}),function(e){e.POP="pop",e.BEARER="Bearer"}(i||(i={}));const a="https://api.spaces.skype.com",o="ForceFallbackToWebAuth",r="ForceReloadIfSkypeAuthFail";var s,l;!function(e){e.AADReconnecting="AADReconnecting",e.InteractionRequired="InteractionRequired",e.SkypeReconnecting="SkypeReconnecting",e.Up="Up"}(s||(s={})),function(e){e.Failure="Failure",e.InteractionRequired="InteractionRequired",e.Success="Success",e.Unknown="Unknown"}(l||(l={}))},66927:(e,t,n)=>{"use strict";var i;n.d(t,{l:()=>i,Q:()=>a}),function(e){e[e.UNKNOWN=-1]="UNKNOWN",e[e.ONLINE=1]="ONLINE",e[e.OFFLINE=0]="OFFLINE"}(i||(i={}));const a=["ChatSync","Presence","Files","OneNote","Groups","Video","MasterTab","IndexDb","AdalTokens","AdalLogin","AdalReauth","SkypeTokens","SkypeLicense","SupportedBrowser","MSAGuestLicense","AppSession","CSAStartup"]},40797:(e,t,n)=>{"use strict";var i;n.d(t,{B:()=>i}),function(e){e.Abandoned="Abandoned",e.AfterOnCommandReceived="AfterOnCommandReceived",e.AfterOnEventReceived="AfterOnEventReceived",e.AlreadyFocused="AlreadyFocused",e.ApplicationHookReceivedCommand="ApplicationHookReceivedCommand",e.ApplicationHookContinuedCommand="ApplicationHookContinuedCommand",e.BeforeOnCommandReceived="BeforeOnCommandReceived",e.BeforeOnEventReceived="BeforeOnEventReceived",e.Blanked="Blanked",e.ChunkLoadStarted="ChunkLoadStarted",e.ChunkLoadSucceeded="ChunkLoadSucceeded",e.Close="Close",e.CommandAfterGetAppViewEntitiesSucceeded="CommandAfterGetAppViewEntitiesSucceeded",e.CommandBeforeGetAppViewEntities="CommandBeforeGetAppViewEntities",e.CommandHandledByOnCommandReceived="CommandHandledByOnCommandReceived",e.CommandHandledPriorToResolution="CommandHandledPriorToResolution",e.CommandMetaDataAdded="CommandMetaDataAdded",e.CommandReceived="CommandReceived",e.CommandReportingTimedOut="CommandReportingTimedOut",e.CommandResolutionStarted="CommandResolutionStarted",e.CommandStart="CommandStart",e.DeeplinkReceived="DeeplinkReceived",e.DeeplinkParsed="DeeplinkParsed",e.DelegatedCommandReceived="DelegatedCommandReceived",e.EventBubbled="EventBubbled",e.EventHandled="EventHandled",e.Hidden="Hidden",e.IntentReceived="IntentReceived",e.OnBeforeIntentAuthenticatedStarted="OnBeforeIntentAuthenticatedStarted",e.OnBeforeIntentAuthenticatedCompleted="OnBeforeIntentAuthenticatedCompleted",e.WaitForUserContextStarted="WaitForUserContextStarted",e.WaitForUserContextCompleted="WaitForUserContextCompleted",e.OnAfterIntentAuthenticatedStarted="OnAfterIntentAuthenticatedStarted",e.OnAfterIntentAuthenticatedCompleted="OnAfterIntentAuthenticatedCompleted",e.IntentHookStarted="IntentHookStarted",e.IntentHookResolved="IntentHookResolved",e.IntentHookRejected="IntentHookRejected",e.IntentHookCompleted="IntentCompleted",e.IntentExecuted="IntentExecuted",e.Failure="Failure",e.Focus="Focus",e.Incomplete="Incomplete",e.LayoutRendered="LayoutRendered",e.LayoutRenderUpdated="LayoutRenderUpdated",e.NavigationCommandStart="NavigationCommandStart",e.NotHandled="NotHandled",e.Rendered="Rendered",e.RenderStarted="RenderStarted",e.ScenarioEventDataAppended="ScenarioEventDataAppended",e.ScenarioMarked="ScenarioMarked",e.SlotPhasedRenderingTimedOut="SlotPhasedRenderingTimedOut",e.Toggled="Toggled",e.UnmountStarted="UnmountStarted",e.WindowCreated="WindowCreated",e.WindowUpdated="WindowUpdated",e.WindowNotUpdated="WindowNotUpdated"}(i||(i={}))},35228:(e,t,n)=>{"use strict";var i;n.d(t,{y:()=>i}),function(e){e.AlreadyRendered="AlreadyRendered",e.CallHistoryContainerError="CallHistoryContainerError",e.CommandGetAppViewEntitiesFailure="CommandGetAppViewEntitiesFailure",e.ChannelDashboardHeader="ChannelDashboardHeader",e.ChannelDashboardView="ChannelDashboardView",e.ChannelHeader="ChannelHeader",e.ChannelHeaderBoundaryError="ChannelHeaderBoundaryError",e.CommunitiesHeader="CommunitiesHeader",e.ChannelHeaderTitle="ChannelHeaderTitle",e.ChannelHeaderTitleBoundaryError="ChannelHeaderTitleBoundaryError",e.ChannelListContainerError="ChannelListContainerError",e.CreateWindowError="CreateWindowError",e.CreateUserContextError="CreateUserContextError",e.DeeplinkIntentParseFailure="DeeplinkIntentParseFailure",e.DelegatedCommandError="DelegatedCommandError",e.EmptyWindowError="EmptyWindowError",e.ErrorAppError="ErrorAppError",e.ErrorBoundaryError="ErrorBoundaryError",e.EventError="EventError",e.GetCommandScenarioNameHookFailed="GetCommandScenarioNameHookFailed",e.GuardiansError="GuardiansError",e.MessagePaneBoundaryError="MessagePaneBoundaryError",e.NetworkOffline="NetworkOffline",e.OnBeforeIntentAuthenticatedReturnedUndefined="OnBeforeIntentAuthenticatedReturnedUndefined",e.OnBeforeIntentAuthenticatedRejected="OnBeforeIntentAuthenticatedRejected",e.OnAfterIntentAuthenticatedReturnedUndefined="OnAfterIntentAuthenticatedReturnedUndefined",e.OnAfterIntentAuthenticatedRejected="OnAfterIntentAuthenticatedRejected",e.OnBeforeCommandHandledRejected="OnBeforeCommandHandledRejected",e.PlatformErrorBoundaryError="PlatformErrorBoundaryError",e.RenderingError="RenderingError",e.SlotPhasedRenderingTimedOut="SlotPhasedRenderingTimedOut",e.TimeoutRunningApp="TimeoutRunningApp",e.TimeoutRunningCore="TimeoutRunningCore",e.UnknownCommandError="UnknownCommandError",e.UserContextMismatch="UserContextMismatch",e.WindowCacheFailedToUpdate="WindowCacheFailedToUpdate",e.WindowCloseRunningApp="WindowCloseRunningApp",e.WindowCloseRunningCore="WindowCloseRunningCore"}(i||(i={}))},43768:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{yU:()=>i,FV:()=>a,c4:()=>o}),function(e){e.ActiveEntitiesResolved="active_entities_resolved",e.ActiveEntitiesDestroyed="active_entities_destroyed",e.AppSelectionChanged="app_selection_changed_resolved",e.ExperienceIdleStateChanged="experience_idle_state_changed",e.InitialDeeplinkResolved="initial_deep_link_resolved",e.NavigationIntentExecuted="navigation_intent_executed",e.UserAuthenticated="user_authenticated",e.UserConsentedToConsumeResources="user_consented_to_consume_resources"}(i||(i={})),function(e){e.LayoutRenderComplete="layout_render_complete",e.WindowStateChange="window_state_change",e.WindowOptionsChange="window_options_change"}(a||(a={})),function(e){e.Started="app_started",e.Initialized="app_initialized",e.ExperienceWarm="experience_warm",e.UserWarm="user_warm",e.ExperienceIdle="experience_idle"}(o||(o={}))},21580:(e,t,n)=>{"use strict";var i,a,o,r;n.d(t,{pk:()=>i,kZ:()=>a,UV:()=>o,V9:()=>r}),function(e){e.Initializing="Initializing",e.Unrecoverable="Unrecoverable",e.LongInactive="LongInactive",e.Inactive="Inactive",e.Active="Active",e.VeryActive="VeryActive"}(i||(i={})),function(e){e.Minimized="Minimized",e.Background="Background",e.InFocus="InFocus"}(a||(a={})),function(e){e.Locked="Locked",e.Active="Active"}(o||(o={})),function(e){e.Suspending="Suspending",e.Resumed="Resumed"}(r||(r={}))},6866:(e,t,n)=>{"use strict";var i;n.d(t,{D:()=>i}),function(e){e.AccessibilitySettingsPanelButton="AccessibilitySettingsPanelButton",e.ActivityFeed="ActivityFeed",e.ActivityFeedBellClick="ActivityFeedBellClick",e.AddAccountFromMeMenu="AddAccountFromMeMenu",e.AddAccountFromSettings="AddAccountFromSettings",e.AltTextMenuItem="AltTextMenuItem",e.AnalyticsChannelDropdown="AnalyticsChannelDropdown",e.AnalyticsButtonCrossTeamName="AnalyticsButtonCrossTeamName",e.AnalyticsButtonCrossTeamPeopleCount="AnalyticsButtonCrossTeamPeopleCount",e.AnalyticsButtonPerTeamToCross="AnalyticsButtonPerTeamToCross",e.AnalyticsButtonChannelToTeam="AnalyticsButtonChannelToTeam",e.AppBar="AppBar",e.AppearanceSettings="AppearanceSettings",e.AppProfileCard="AppProfileCard",e.AppSwitchConfirmationPage="AppSwitchConfirmationPage",e.AppSwitcher="AppSwitcher",e.AuthApp="AuthApp",e.Authentication="Authentication",e.AutoBrb="AutoBrb",e.Autosuggest="Autosuggest",e.Avatar="Avatar",e.BannerNotification="BannerNotification",e.BlockChat="BlockChat",e.BrbForm="BrbForm",e.Breadcrumb="Breadcrumb",e.BreakoutRoomsCreateButton="BreakoutRoomsCreateButton",e.BreakoutRoomsPanel="BreakoutRoomsPanel",e.BreakoutRoomsRecreateButton="BreakoutRoomsRecreateButton",e.BreakoutRoomsSettingPresenter="BreakoutRoomsSettingPresenter",e.BroadcastInfoPanelButton="BroadcastInfoPanelButton",e.BroadcastInfoPanelContainer="BroadcastInfoPanelContainer",e.BroadcastLeaveScreen="BroadcastLeaveScreen",e.BroadcastQnaPanelButton="BroadcastQnaPanelButton",e.BroadcastQnaPanelWrapper="BroadcastQnaPanelWrapper",e.Calendar="Calendar",e.CalendarAnswer="CalendarAnswer",e.CalendarEventAction="CalendarEventAction",e.CalendarSettings="CalendarSettings",e.CalendarSyncBanner="CalendarSyncBanner",e.CallDebug="CallDebug",e.CallHealthButton="CallHealthButton",e.CallSettings="CallSettings",e.Calling="Calling",e.CallingAlert="CallingAlert",e.CallingAppEvent="CallingAppEvent",e.CallingBreakoutRoomsWrapper="CallingBreakoutRoomsWrapper",e.CallingCameraEffectsPanelWrapper="CallingCameraEffectsPanelWrapper",e.CallingCustomVideoBackgroundsPanelContainer="CallingCustomVideoBackgroundsPanelContainer",e.CallingCustomVideoBackgroundsPanelWrapper="CallingCustomVideoBackgroundsPanelWrapper",e.CallingDevicesPanelWrapper="CallingDevicesPanelWrapper",e.CallingEndScreen="CallingEndScreen",e.CallingEndScreenPostMeetingChat="CallingEndScreenPostMeetingChat",e.CallingOnBeforeDeeplinkParsed="CallingOnBeforeDeeplinkParsed",e.CallingPreJoinEffectsAndAvatarsButton="CallingPreJoinEffectsAndAvatarsButton",e.CallingPreJoinScreenCancelButton="CallingPreJoinScreenCancelButton",e.CallingPrejoinScreenHideAllPanels="CallingPrejoinScreenHideAllPanels",e.CallingPreJoinScreenVideoEffectsButton="CallingPreJoinScreenVideoEffectsButton",e.CallingRosterWrapper="CallingRosterWrapper",e.CallingScreen="CallingScreen",e.CallingScreenHideAllPanels="CallingScreenHideAllPanels",e.CallMonitor="CallMonitor",e.CallsHeaderRenderer="CallsHeaderRenderer",e.CallTransferButton="CallTransferButton",e.CameraEffectsButton="CameraEffectsButton",e.CameraEffectsPrejoinPanelButton="CameraEffectsPrejoinPanelButton",e.CameraEffectsVideoPreviewButton="CameraEffectsVideoPreviewButton",e.CampaignNotification="CampaignNotification",e.Card="Card",e.CastWizard="CastWizard",e.CDLWorker="CDLWorker",e.ChannelContextualSearch="ChannelContextualSearch",e.ChannelDashboardHeader="ChannelDashboardHeader",e.ChannelDeleteOrUserNotMember="ChannelDeleteOrUserNotMember",e.ChannelEmail="ChannelEmail",e.ChannelHeader="ChannelHeader",e.ChannelInfoPane="ChannelInfoPane",e.ChannelInfoPaneExpanded="ChannelInfoPaneExpanded",e.ChannelList="ChannelList",e.ChannelListItem="ChannelListItem",e.ChannelPostMessage="ChannelPostMessage",e.ChannelPreStateScheduleMeetingDetailsMenuContextButton="ChannelPreStateScheduleMeetingDetailsMenuContextButton",e.ChannelRepliesPane="ChannelRepliesPane",e.ChannelSettings="ChannelSettings",e.ChatAddMembers="ChatAddMembers",e.ChatBubbles="ChatBubbles",e.ChatButton="ChatButton",e.ChatCallButton="ChatCallButton",e.ChatClaimed="ChatClaimed",e.ChatClaimLink="ChatClaimLink",e.ChatContextualSearch="ChatContextualSearch",e.ChatDeprovisioned="ChatDeprovisioned",e.ChatDisabledComposeLink="ChatDisabledComposeLink",e.ChatDiscardConversation="ChatDiscardConversation",e.ChatEmbedSdk="ChatEmbedSdk",e.ChatError="ChatError",e.ChatEscalation="ChatEscalation",e.ChatHeader="ChatHeader",e.ChatInfoPane="ChatInfoPane",e.ChatInfoPaneButton="ChatInfoPaneButton",e.ChatInfoPaneDetails="ChatInfoPaneDetails",e.ChatInviteLink="ChatInviteLink",e.ChatJoinShareButton="ChatJoinShareButton",e.ChatListFilterItem="ChatListFilterItem",e.ChatListItem="ChatListItem",e.ChatListItemBlockChatButton="ChatListItemBlockChatButton",e.ChatListItemDeleteChatButton="ChatListItemDeleteChatButton",e.ChatListItemDiscardButton="ChatListItemDiscardButton",e.ChatListItemInviteLinkButton="ChatListItemInviteLinkButton",e.ChatListItemMenuLeaveButton="ChatListItemMenuLeaveButton",e.ChatListItemMenuPinButton="ChatListItemMenuPinButton",e.ChatListMeetingItem="ChatListMeetingItem",e.ChatListSuggestedContact="ChatListSuggestedContact",e.ChatMeetingChiclet="ChatMeetingChiclet",e.ChatPane="ChatPane",e.ChatPopOutNewChat="ChatPopOutNewChat",e.ChatRailHeader="ChatRailHeader",e.ChatResolveConversationLie="ChatResolveConversationLie",e.ChatRoster="ChatRoster",e.ChatSendMessage="ChatSendMessage",e.ChatSendMessageRetry="ChatSendMessageRetry",e.ChatWith="ChatWith",e.ChatWithUser="ChatWithUser",e.ClosedCaptionsSettingsPanelWrapper="ClosedCaptionsSettingsPanelWrapper",e.CodeSnippetDiscardButton="CodeSnippetDiscardButton",e.CommunitiesInviteLink="CommunitiesInviteLink",e.CommunitiesShareFeedbackButton="CommunitiesShareFeedbackButton",e.ComposeChat="ComposeChat",e.ComposeChatDisabled="ComposeChatDisabled",e.ConnectedCalendarStatusBanner="ConnectedCalendarStatusBanner",e.ContactsSyncBanner="ContactsSyncBanner",e.ContactsSyncDialog="ContactsSyncDialog",e.ContactsSyncMobileSyncDialog="ContactsSyncMobileSyncDialog",e.ContentCameraSettingsButton="ContentCameraSettingsButton",e.ConveneOnBeforeDeeplinkParsed="ConveneOnBeforeDeeplinkParsed",e.Conversation="Conversation",e.Core="Core",e.CoreResolvers="CoreResolvers",e.CrossPostDeleteDialogButton="CrossPostDeleteDialogButton",e.CrossPostSelectChannelsButton="CrossPostSelectChannelsButton",e.CustomVideoBackgroundsPanelButton="CustomVideoBackgroundsPanelButton",e.CustomVideoBackgroundsPrejoinPanelButton="CustomVideoBackgroundsPrejoinPanelButton",e.CustomVideoBackgroundsVideoPreviewButton="CustomVideoBackgroundsVideoPreviewButton",e.DebugPanel="DebugPanel",e.DefaultChatNewChat="DefaultChatNewChat",e.DefaultChatNewGroup="DefaultChatNewGroup",e.DevicePanelButton="DevicePanelButton",e.DiscoverSurface="DiscoverSurface",e.DiscoverSurfaceDislikeFeedItemButton="DiscoverSurfaceDislikeFeedItemButton",e.DiscoverSurfaceEntry="DiscoverSurfaceEntry",e.DiscoverSurfaceL2BackButton="DiscoverSurfaceL2BackButton",e.Dlp="Dlp",e.DocumentCameraSharingButton="DocumentCameraSharingButton",e.DropInSpaces="DropInSpaces",e.EducationGuardians="EducationGuardians",e.Esp="Esp",e.ExtensionCommanding="ExtensionCommanding",e.ExternalCommand="ExternalCommand",e.FaceEnrollmentGetStartedButton="FaceEnrollmentGetStartedButton",e.FileDialog="FileDialog",e.FileViewer="FileViewer",e.FluidAltText="FluidAltText",e.FluidDiscardButton="FluidDiscardButton",e.FluidShareServicePermissionsCallback="FluidShareServicePermissionsCallback",e.Flyout="Flyout",e.FlyoutAuthLanding="FlyoutAuthLanding",e.FlyoutOnExperienceWarmJob="FlyoutOnExperienceWarmJob",e.FlyoutPrewarmJob="FlyoutPrewarmJob",e.GalleryImage="GalleryImage",e.GeneralSettings="GeneralSettings",e.GetLinkToCommunityButton="GetLinkToCommunityButton",e.GetTenantsFromSettings="GetTenantsFromSettings",e.GiveFeedbackChoices="GiveFeedbackChoices",e.GoogleAuthOnBeforeDeepLinkParsed="GoogleAuthOnBeforeDeepLinkParsed",e.HangupButton="HangupButton",e.InContextStore="InContextStore",e.InsertHyperlink="InsertHyperlink",e.InternalDeeplink="InternalDeeplink",e.KeyboardShortcut="KeyboardShortcut",e.KeypadButton="KeypadButton",e.LayoutError="LayoutError",e.LeaveGroupAndBlockUser="LeaveGroupAndBlockUser",e.LivePersonaCard="LivePersonaCard",e.LmsCourseCalendar="LmsCourseCalendar",e.LmsCourseTeams="LmsCourseTeams",e.ManageTeams="ManageTeams",e.ManageUserApps="ManageUserApps",e.ManageTeamDashboard="ManageTeamDashboard",e.MediaStreamsButton="MediaStreamsButton",e.MeetApp="MeetApp",e.MeetingBot="MeetingBot",e.MeetingCollabButton="MeetingCollabButton",e.MeetingDetailsButton="MeetingDetailsButton",e.MeetingDetailsPanelWrapper="MeetingDetailsPanelWrapper",e.MeetingInfoButton="MeetingInfoButton",e.MeetingInfoPanelWrapper="MeetingInfoPanelWrapper",e.MeetingNotesButton="MeetingNotesButton",e.MeetingOptions="MeetingOptions",e.MeetingRecapChatNavButton="MeetingRecapChatNavButton",e.MeetingRoomConsole="MeetingRoomConsole",e.MeetingRoomFrontOfRoom="MeetingRoomFrontOfRoom",e.MeetingRoomFrontOfRoomCallPanelsManager="MeetingRoomFrontOfRoomCallPanelsManager",e.MeetingRoomJoinByCodeButton="MeetingRoomJoinByCodeButton",e.MeetLauncher="MeetLauncher",e.MeshAvatarPanel="MeshAvatarPanel",e.MessageAction="MessageAction",e.MessageDraftDiscardButton="MessageDraftDiscardButton",e.MessageExtensionFlyout="MessageExtensionFlyout",e.MessageGiphyConsent="MessageGiphyConsent",e.MessageLeaveChatButton="MessageLeaveChatButton",e.MessageReaction="MessageReaction",e.MessageReadReceipt="MessageReadReceipt",e.MessageRemoveChatUserButton="MessageRemoveChatUserButton",e.MessageShareChatButton="MessageShareChatButton",e.MoreAvatarSettingsButton="MoreAvatarSettingsButton",e.MoreOptionsMenu="MoreOptionsMenu",e.MTMAChildWindowTenantName="MTMAChildWindowTenantName",e.MTMANotificationCard="MTMANotificationCard",e.NewChat="NewChat",e.Notifications="Notifications",e.NotificationSettings="NotificationSettings",e.Nova="Nova",e.OfficeIntegration="OfficeIntegration",e.OfficeIntegrationChat="OfficeIntegrationChat",e.OofSettings="OofSettings",e.OSFileShareEvent="OSFileShareEvent",e.PinUnpinPostConfirmButton="PinUnpinPostConfirmButton",e.PlatformAppDetailsDialog="PlatformAppDetailsDialog",e.PlatformExtension="PlatformExtension",e.PlatformPersonalAppHeader="PlatformPersonalAppHeader",e.PlatformPersonalAppDeepLink="PlatformPersonalAppDeepLink",e.PlatformTabHeader="PlatformTabHeader",e.PopOutButton="PopOutButton",e.PresenterToolbar="PresenterToolbar",e.PreviewButton="PreviewButton",e.RecordButton="RecordButton",e.ReplaceChatItemButton="ReplaceChatItemButton",e.ReportConcernCommunitiesButton="ReportConcernCommunitiesButton",e.ReportConcernCommunitiesDialog="ReportConcernCommunitiesDialog",e.RosterButton="RosterButton",e.SchedulingFormHeader="SchedulingFormHeader",e.SchoolTeams="SchoolTeams",e.Search="Search",e.SendChannelPost="SendChannelPost",e.SendChannelReply="SendChannelReply",e.SendChat="SendChat",e.Settings="Settings",e.SettingsHeader="SettingsHeader",e.ShareMeetingInviteDialog="ShareMeetingInviteDialog",e.ShareToTeamsMultiWindow="ShareToTeamsMultiWindow",e.ShellAuthState="ShellAuthState",e.ShellCDLServicesState="ShellCDLServicesState",e.ShellNetworkState="ShellNetworkState",e.SideloadedAppUploadButton="SideloadedAppUploadButton",e.SignOutEmbedClient="SignOutEmbedClient",e.SignOutLink="SignOutLink",e.SmartDeviceAvatarButton="SmartDeviceAvatarButton",e.SmartDeviceJoinByCodeBackButton="SmartDeviceJoinByCodeBackButton",e.SmartDeviceJoinByCodeButton="SmartDeviceJoinByCodeButton",e.StagingAppUploadButton="StagingAppUploadButton",e.StandAlone="StandAlone",e.StopMdpDataCollectionButton="StopMdpDataCollectionButton",e.Store="Store",e.StreamCameraButton="StreamCameraButton",e.Survey="Survey",e.SwitchAccountFromMeMenu="SwitchAccountFromMeMenu",e.SwitchAccountFromSettings="SwitchAccountFromSettings",e.TabConfigurationDialog="TabConfigurationDialog",e.TabInfoButton="TabInfoButton",e.TagCard="TagCard",e.TakeSnapshot="TakeSnapshot",e.TeamChannels="TeamChannels",e.TeamDashboardHeader="TeamDashboardHeader",e.TeamsGallery="TeamsGallery",e.TenantAppUploadButton="TenantAppUploadButton",e.TflFre="TflFre",e.Toast="Toast",e.TranscriptButton="TranscriptButton",e.TranscriptPanelButton="TranscriptPanelButton",e.TranscriptPanelWrapper="TranscriptPanelWrapper",e.TwoWaySmsFriendlyName="TwoWaySmsFriendlyName",e.UbarAccessibilityCoachmark="UbarAccessibilityCoachmark",e.UnifiedConsent="UnifiedConsent",e.UnifiedSearch="UnifiedSearch",e.Unknown="Unknown",e.UnlockTeam="UnlockTeam",e.UnpinChatItemButton="UnpinChatItemButton",e.UpdateGroupChatAvatarButton="UpdateGroupChatAvatarButton",e.VideoCallPreviewPopup="VideoCallPreviewPopup",e.VideoEffectsAndAvatarButton="VideoEffectsAndAvatarButton",e.VideoEffectsAndAvatarPanel="VideoEffectsAndAvatarPanel",e.VideoEffectsButton="VideoEffectsButton",e.VideoEffectsCustomizationButton="VideoEffectsCustomizationButton",e.VideoEffectsMoreViewPanel="VideoEffectsMoreViewPanel",e.VideoEffectsPickerMoreButton="VideoEffectsPickerMoreButton",e.VideoEffectsVideoAppPanel="VideoEffectsVideoAppPanel",e.VideoPreviewDeviceSettingsButton="VideoPreviewDeviceSettingsButton",e.VideoSharingButton="VideoSharingButton",e.VirtualEventDetails="VirtualEventDetails",e.VirtualEventsListItem="VirtualEventsListItem",e.WhiteboardCameraSharingButton="WhiteboardCameraSharingButton",e.YammerQnaButton="YammerQnaButton",e.YammerQnaContainer="YammerQnaContainer"}(i||(i={}))},16552:(e,t,n)=>{"use strict";n.d(t,{ab:()=>i,Xt:()=>a,fe:()=>o,su:()=>r,oz:()=>s,oq:()=>l,lO:()=>d});const i="com.microsoft.teams.corelayout",a="com.microsoft.teams.entitymoreinfo";var o,r,s,l,d;!function(e){e.show="show",e.showWithoutFocusing="showWithoutFocusing",e.hide="hide",e.toggle="toggle"}(o||(o={})),function(e){e.none="none",e.flush="flush",e.forceFlush="forceFlush",e.flow="flow",e.forceFlow="forceFlow",e.new="new",e.extend="extend"}(r||(r={})),function(e){e.organization="organization",e.privacyManageVisibility="privacy_manage_visibility",e.linkedin="linkedin"}(s||(s={})),function(e){e.Cancelled="Cancelled",e.Closed="Closed",e.Confirmed="Confirmed",e.Error="Error",e.Open="Open"}(l||(l={})),function(e){e.minimal="minimal",e.focus="focus",e.standard="standard"}(d||(d={}))},84361:(e,t,n)=>{"use strict";var i,a;n.d(t,{u:()=>i,p:()=>a}),function(e){e.config="config",e.create="create",e.tenantLogin="tenantLogin",e.default="default",e.delete="delete",e.error="error",e.health="health",e.info="info",e.infoDetails="infoDetails",e.join="join",e.list="list",e.signin="signin",e.update="update",e.view="view",e.manage="manage",e.mutate="mutate",e.share="share",e.leave="leave",e.confirm="confirm",e.empty="empty"}(i||(i={})),function(e){e.accessibilitypanel="accessibilitypanel",e.accounts="accounts",e.activity="activity",e.addchannel="addchannel",e.addmember="addmember",e.addmembernewteam="addmembernewteam",e.agendapage="agendapage",e.aiinsightscontent="aiinsightscontent",e.alttext="alttext",e.activecalldialog="activecalldialog",e.attendancereport="attendancereport",e.annotation="annotation",e.appdetails="appdetails",e.attendeeview="attendeeview",e.autobrbconfirmationdialog="autobrbconfirmationdialog",e.autoinstallnotification="autoinstallnotification",e.bannerNotification="bannerNotification",e.blank="blank",e.blockChat="blockChat",e.brbfeedbackdialog="brbfeedbackdialog",e.breakoutrooms="breakoutrooms",e.breakoutroomsassignment="breakoutroomsassignment",e.breakoutroomsassignmenttype="breakoutroomsassignmenttype",e.breakoutroomscreaterooms="breakoutroomscreaterooms",e.breakoutroomsdeleteroom="breakoutroomsdeleteroom",e.breakoutroomsdeleterooms="breakoutroomsdeleterooms",e.breakoutroomseditroom="breakoutroomseditroom",e.breakoutroomssettings="breakoutroomssettings",e.breakoutroomspanel="breakoutroomspanel",e.broadcastfeedback="broadcastfeedback",e.broadcastliveevent="broadcastliveevent",e.broadcastqna="broadcastqna",e.broadcasts="broadcasts",e.calendar="calendar",e.callablechannels="callablechannels",e.callingconfirmdialog="callingconfirmdialog",e.callingalertdialog="callingalertdialog",e.callingbannernotification="callingbannernotification",e.callingdeeplink="callingdeeplink",e.callingprotocoldeeplinkdialog="callingprotocoldeeplinkdialog",e.calls="calls",e.callscontent="callscontent",e.callsgallery="callsgallery",e.callsgalleryandcontent="callsgalleryandcontent",e.callskeypad="callskeypad",e.callsmain="callsmain",e.callsmonitor="callsmonitor",e.callstransfer="callstransfer",e.cameraeffects="cameraeffects",e.cast="cast",e.channelcalendar="channelcalendar",e.channelconnectors="channelconnectors",e.channeldeeplink="channeldeeplink",e.channeldelete="channeldelete",e.channeledit="channeledit",e.channelemail="channelemail",e.channelemailv2="channelemailv2",e.channelinvitations="channelinvitations",e.channelanalytics="channelanalytics",e.channelmanage="channelmanage",e.channelmembers="channelmembers",e.channelmoderators="channelmoderators",e.channelsettings="channelsettings",e.channeltags="channeltags",e.channelnotificationsettings="channelnotificationsettings",e.channelroster="channelroster",e.channels="channels",e.channelsPinnedPost="channelsPinnedPost",e.channelsSystemMessage="channelsSystemMessage",e.channelcontextualsearch="channelcontextualsearch",e.chats="chats",e.chatContextualSearch="chatContextualSearch",e.chatsInfo="chatsInfo",e.chatsInfoView="chatsInfoView",e.closedcaptionssettings="closedcaptionssettings",e.classesintegrationcontent="classesintegrationcontent",e.coachreport="coachreport",e.connectedcalendardialog="connectedcalendardialog",e.codesnippet="codesnippet",e.communities="communities",e.communitiesonboarding="communitiesonboarding",e.contactssync="contactssync",e.contentcamerasetup="contentcamerasetup",e.coursecalendar="coursecalendar",e.courseteams="courseteams",e.crosspostchannelselectiondialog="crosspostchannelselectiondialog",e.crosspostdeletedialog="crosspostdeletedialog",e.crossTeamAnalytics="crossTeamAnalytics",e.customapp="customapp",e.default="default",e.deletechat="deletechat",e.deleteActivityFeedItem="deleteActivityFeedItem",e.devicesettings="devicesettings",e.discoversurface="discoversurface",e.dlp="dlp",e.discoverappsnotifications="discoverappsnotifications",e.eduteamcreate="eduteamcreate",e.email="email",e.esp="esp",e.error="error",e.example="example",e.extensions="extensions",e.externalnavigation="externalnavigation",e.faceenrollment="faceenrollment",e.file="file",e.filepicker="filepicker",e.fileopensettings="fileopensettings",e.filesoneupviewer="filesoneupviewer",e.fluid="fluid",e.floodgate="floodgate",e.flyout="flyout",e.framework="framework",e.freemiumupgrade="freemiumupgrade",e.gallery="gallery",e.galleryImages="galleryImages",e.giphyconsent="giphyconsent",e.givefeedbackchoices="givefeedbackchoices",e.guardians="guardians",e.help="help",e.hostedincontextstore="hostedincontextstore",e.hybridplaceholder="hybridplaceholder",e.hyperlink="hyperlink",e.identity="identity",e.identitydialog="identitydialog",e.inAppToast="inAppToast",e.incontextstore="incontextstore",e.invisionwhiteboard="invisionwhiteboard",e.joinlinkdialog="joinlinkdialog",e.leavechat="leavechat",e.leaveGroupAndBlockUser="leaveGroupAndBlockUser",e.lobnotifications="lobnotifications",e.locationapi="locationapi",e.officeintegrationfredialog="officeintegrationfredialog",e.onboardingnotifications="onboardingnotifications",e.selectpeoplepicker="selectpeoplepicker",e.selectMediaApi="selectMediaApi",e.viewImagesApi="viewImagesApi",e.licenses="licenses",e.linkedin="linkedin",e.livepersonacard="livepersonacard",e.locationnotification="locationnotification",e.manageapps="manageapps",e.manageappswebhook="manageappswebhook",e.meetingcollaboration="meetingcollaboration",e.meetingcollaborationcontent="meetingcollaborationcontent",e.mediastreams="mediastreams",e.meetinganalytics="meetinganalytics",e.meetingdetails="meetingdetails",e.meetingoptionscreatedialog="meetingoptionscreatedialog",e.meetingrecap="meetingrecap",e.meetingrecaptab="meetingrecaptab",e.meetingroomconsolecall="meetingroomconsolecall",e.meetingroomfrontofroom="meetingroomfrontofroom",e.meetingroomfrontofroomcontent="meetingroomfrontofroomcontent",e.meetingroomfrontofroomgallery="meetingroomfrontofroomgallery",e.meet="meet",e.meetingapis="meetingapis",e.meetings="meetings",e.meetingsettings="meetingsettings",e.meetingstream="meetingstream",e.meshavatar="meshavatar",e.messagedraft="messagedraft",e.messages="messages",e.campaignnotifications="campaignnotifications",e.updatemsaprofileavatardialog="updatemsaprofileavatardialog",e.updatemsaprofilenamedialog="updatemsaprofilenamedialog",e.notes="notes",e.oauthcode="oauthcode",e.open3sfeedback="open3sfeedback",e.optionssettingsdialog="optionssettingsdialog",e.pearnotdefaultapp="pearnotdefaultapp",e.pinnedchatsmaxreached="pinnedchatsmaxreached",e.pinnedconversationitems="pinnedconversationitems",e.pinunpinpost="pinunpinpost",e.platformapp="platformapp",e.platformsubscriptionplans="platformsubscriptionplans",e.platformappdetails="platformappdetails",e.platformappconsent="platformappconsent",e.platformappdevicepermissions="platformappdevicepermissions",e.platformtab="platformtab",e.platformapps="platformapps",e.stagedapps="stagedapps",e.platformauthconsentdialog="platformauthconsentdialog",e.platformStage="platformStage",e.platformstageinactivemeeting="platformstageinactivemeeting",e.platformTabGallery="platformTabGallery",e.prejoinoverlaydialog="prejoinoverlaydialog",e.presentertoolbar="presentertoolbar",e.ptzextension="ptzextension",e.registration="registration",e.removechannelemail="removechannelemail",e.removechatuser="removechatuser",e.reportConcern="reportConcern",e.reportconcerncommunities="reportconcerncommunities",e.reportConcernForTFW="reportConcernForTFW",e.restartrecomendeddialog="restartrecomendeddialog",e.restorechannel="restorechannel",e.roomremote="roomremote",e.roster="roster",e.schedulingform="schedulingform",e.schoolteams="schoolteams",e.hwctaskmodule="hwctaskmodule",e.search="search",e.settingsdialog="settingsdialog",e.settingsstore="settingsstore",e.sharedchannelspendinginvites="sharedchannelspendinginvites",e.sharedchannelacceptinvitation="sharedchannelacceptinvitation",e.sharedchanneldeclineinvitation="sharedchanneldeclineinvitation",e.sharechatlink="sharechatlink",e.sharecommunitieslink="sharecommunitieslink",e.shareformdialog="shareformdialog",e.shareMeetingInfo="shareMeetingInfo",e.showformemberdialog="showformemberdialog",e.signoutdialog="signoutdialog",e.smartdeviceagendapage="smartdeviceagendapage",e.smartdevicelogin="smartdevicelogin",e.smartdevicelogoutdialog="smartdevicelogoutdialog",e.spaces="spaces",e.standaloneapp="standaloneapp",e.stagecontent="stagecontent",e.stagingroomstartmeetingconfirmationdialog="stagingroomstartmeetingconfirmationdialog",e.store="store",e.storefre="storefre",e.streamcamera="streamcamera",e.survey="survey",e.tabapps="tabapps",e.taskmodule="taskmodule",e.teamarchive="teamarchive",e.teamanalytics="teamanalytics",e.teamchannels="teamchannels",e.teamcreate="teamcreate",e.teamdeeplink="teamdeeplink",e.teamdiscover="teamdiscover",e.teamedit="teamedit",e.teamsgallery="teamsgallery",e.teamjoin="teamjoin",e.teamjoincode="teamjoincode",e.teamleave="teamleave",e.teammanage="teammanage",e.teammanageapps="teammanageapps",e.teammanagetags="teammanagetags",e.teampendingrequests="teampendingrequests",e.teampicture="teampicture",e.teamrenewal="teamrenewal",e.teamrestore="teamrestore",e.teams="teams",e.teamslist="teamslist",e.teamsettings="teamsettings",e.tflfre="tflfre",e.toasts="toasts",e.tpndialog="tpndialog",e.transcript="transcript",e.transcriptcontent="transcriptcontent",e.transcripttab="transcripttab",e.translationfeedback="translationfeedback",e.twowaysmsfriendlyname="twowaysmsfriendlyname",e.unparkcalldialog="unparkcalldialog",e.unifiedconsentdialog="unifiedconsentdialog",e.unsupporteddeeplinkdialog="unsupporteddeeplinkdialog",e.updategroupchatavatar="updategroupchatavatar",e.usermediadialog="usermediadialog",e.videobackgrounds="videobackgrounds",e.videoeffectsandavatar="videoeffectsandavatar",e.videoeffectscustomization="videoeffectscustomization",e.videoeffectsmoreview="videoeffectsmoreview",e.virtualevents="virtualevents",e.voiceenrollment="voiceenrollment",e.wiki="wiki",e.windowingerrordialog="windowingerrordialog",e.workflows="workflows",e.yammerqna="yammerqna"}(a||(a={}))},75068:(e,t,n)=>{"use strict";n.d(t,{eT:()=>i,L3:()=>o,B:()=>s,jK:()=>l,w5:()=>d,lX:()=>c,sM:()=>u,Yg:()=>m,f_:()=>g,ew:()=>p,QU:()=>h,ZW:()=>v,eL:()=>f,bA:()=>y});var i,a,o,r=n(55997);!function(e){e[e.Presenting=0]="Presenting",e[e.InCall=1]="InCall",e[e.InBroadcast=2]="InBroadcast",e[e.Interactive=3]="Interactive",e[e.Inactive=4]="Inactive",e[e.LongInactive=5]="LongInactive",e[e.Disabled=6]="Disabled",e[e.Disconnected=7]="Disconnected",e[e.Offline=8]="Offline",e[e.Uninitialized=9]="Uninitialized"}(i||(i={})),function(e){e.AppLogout="appLogout"}(a||(a={})),function(e){e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=2]="info",e[e.verbose=3]="verbose"}(o||(o={}));const s={second:1e3,minute:6e4,tenMinutes:6e5};var l,d;!function(e){e.Deserialization="Deserialization",e.Unknown="Unknown",e.Undefined="Undefined",e.TimedOut="TimedOut",e.AlreadyInitialized="AlreadyInitialized",e.NotImplemented="NotImplemented",e.NotPresent="NotPresent",e.ResourceNotFound="ResourceNotFound",e.Unauthorized="Unauthorized",e.ProxyAuthenticationRequired="ProxyAuthenticationRequired",e.UserNotAuthorizedToPerformAppOperationOnGroupChat="UserNotAuthorizedToPerformAppOperationOnGroupChat",e.AlreadyPresent="AlreadyPresent",e.FileLocked="FileLocked",e.SpQuotaReached="SpQuotaReached",e.FailedToLazyLoadService="FailedToLazyLoadService",e.FileAccessDenied="FileAccessDenied",e.FileNameTooLong="FileNameTooLong",e.InvalidAudienceUri="InvalidAudienceUri",e.InvalidResponse="InvalidResponse",e.RemoteOperationFailed="RemoteOperationFailed",e.UnknownRenderer="UnknownRenderer",e.UnknownRequestId="UnknownRequestId",e.UnknownDocumentOperation="UnknownDocumentOperation",e.UrlUndefined="UrlUndefined",e.UserConsentRequired="UserConsentRequired",e.InvalidRequestFormat="InvalidRequestFormat",e.MaxLimitReached="MaxLimitReached",e.NotAFileLink="NotAFileLink",e.ApolloError="ApolloError",e.InvalidInput="InvalidInput",e.ThirdPartyError="ThirdPartyError",e.AlreadyInProgress="AlreadyInProgress",e.NotInitialized="NotInitialized",e.UnhandledRuntimeException="UnhandledRuntimeException",e.Paused="Paused",e.WaitingForResponse="WaitingForResponse",e.PollCreationFailure="PollCreationFailure",e.PollRuntimeFailure="PollRuntimeFailure",e.PreviousFailure="PreviousFailure",e.FeatureNotSupported="FeatureNotSupported",e.IndexDbException="IndexDbException",e.MultipleUsersPresentWithSpecifiedIdentifier="MultipleUsersPresentWithSpecifiedIdentifier",e.FailedToCreate="FailedToCreate",e.FailedToFetch="FailedToFetch",e.FailedToUpdate="FailedToUpdate",e.FailedToGet="FailedToGet",e.FailedToDelete="FailedToDelete",e.FailedToSubscribe="FailedToSubscribe",e.UndefinedGlobalError="UndefinedGlobalError",e.UndefinedWindowError="UndefinedWindowError",e.UnhandledPromiseRejection="UnhandledPromiseRejection",e.UndefinedDependencies="UndefinedDependencies",e.DuplicateFound="DuplicateFound",e.Empty="Empty",e.MissingParameter="MissingParameter",e.MaxCallCountReached="MaxCallCountReached",e.PayloadTooBig="PayloadTooBig",e.BotError="BotError",e.WriteToStoreFailed="WriteToStoreFailed",e.CorruptedSyncState="CorruptedSyncState",e.CorruptedConversation="CorruptedConversation",e.Aborted="Aborted",e.Forbidden="Forbidden",e.WaitToFetchMore="WaitToFetchMore",e.AuthSafariITPBlocked="AuthSafariITPBlocked",e.AuthSafariITPBlockedAlways="AuthSafariITPBlockedAlways",e.ScriptLoadError="ScriptLoadError",e.ScriptEvalError="ScriptEvalError",e.ScriptCodeError="ScriptCodeError",e.CSSLoadError="CSSLoadError",e.Disabled="Disabled",e.AuthPopupWindowClosed="AuthPopupWindowClosed",e.AuthPopupWindowBlocked="AuthPopupWindowBlocked",e.NetworkOffline="NetworkOffline",e.DBCleanupError="DBCleanupError",e.DBUnexpectedClosureError="DBUnexpectedClosureError",e.DBExpectedClosureError="DBExpectedClosureError",e.ComponentLoadError="ComponentLoadError",e.ChunkLoadTimedOut="ChunkLoadTimedOut",e.Throttled="Throttled",e.ServiceUnavailable="ServiceUnavailable",e.ExperienceDisabled="ExperienceDisabled",e.CallingServiceStateQueryError="CallingServiceStateQueryError",e.CallingServiceStateFailed="CallingServiceStateFailed",e.ShadowTokenRevoked="ShadowTokenRevoked",e.ShadowTokenExpired="ShadowTokenExpired",e.ShadowRefreshTokenExpired="ShadowRefreshTokenExpired",e.ShadowMailboxDeleted="ShadowMailboxDeleted",e.TrouterClient="TrouterClient",e.ConnectedAccountNotFound="ConnectedAccountNotFound",e.ErrorParsingQueryParams="ErrorParsingQueryParams",e.InvalidUrl="InvalidUrl",e.HTTPMethodNotSupportedForDownload="HTTPMethodNotSupportedForDownload",e.InvalidDomReference="InvalidDomReference",e.VersionMismatch="VersionMismatch",e.CoreInitFailure="CoreInitFailure",e.ConversationSyncFailure="ConversationSyncFailure",e.CoreServiceMissing="CoreServiceMissing",e.CoreNavigationServicesMissing="CoreNavigationServicesMissing",e.Authentication="Authentication",e.LayoutPhaseStateMachineTimeoutError="LayoutPhaseStateMachineTimeoutError",e.SignInRestrictions="SignInRestrictions",e.UndefinedExternalEntityKey="UndefinedExternalEntityKey",e.InvalidLoggedInUser="InvalidLoggedInUser",e.InvalidOrganizer="InvalidOrganizer",e.PeopleProviderFailure="PeopleProviderFailure",e.MaxTenantWideTeamLimitExceeded="MaxTenantWideTeamLimitExceeded",e.StandupCallingJobError="StandupCallingJobError",e.SetupCallingAppEventsJobError="SetupCallingAppEventsJobError",e.CallingCallsViewCommandError="CallingCallsViewCommandError",e.HandleCallingAppEventError="HandleCallingAppEventError",e.LayoutError="LayoutError",e.TerminalError="TerminalError",e.EmbedClientError="EmbedClientError",e.PolicyCheckFailed="PolicyCheckFailed",e.PolicyMissing="PolicyMissing",e.RejectedByPolicy="RejectedByPolicy",e.GatewayTimeout="GatewayTimeout",e.ChannelRosterSizeExceeded="ChannelRosterSizeExceeded"}(l||(l={})),function(e){e.AddShareUrlOnSendMessage="AddShareUrlOnSendMEssage",e.Apollo="Apollo",e.Authentication="Authentication",e.CmdArtifactsServiceClient="CmdArtifactsServiceClient",e.Commanding="Commanding",e.Core="Core",e.CSAService="CSAService",e.DataLayerClient="DataLayerClient",e.Discover="Discover",e.DiscoverSurfaceService="DiscoverSurfaceService",e.DistributionListService="DistributionListService",e.DriveDetailsService="DriveDetailsService",e.DriveItemShareService="DriveItemShareService",e.EmbedClient="EmbedClient",e.ErrorInRootLayout="ErrorInRootLayout",e.FileDownloadManagerService="FileDownloadManagerService",e.IndexDb="IndexDb",e.ItemDeleteService="ItemDeleteService",e.ItemDetailsService="ItemDetailsService",e.ItemUploadService="ItemUploadService",e.LayoutErrorInSlot="LayoutErrorInSlot",e.LayoutPhaseStateMachine="LayoutPhaseStateMachine",e.LazyComponentRenderer="LazyComponentRenderer",e.LongPoll="LongPoll",e.PeopleTargetingService="PeopleTargetingService",e.PostMessageClient="PostMessageClient",e.RejectHttpError="RejectHttpError",e.RequireStatus="RequireStatus",e.RequireStatusWithSsm="RequireStatusWithSsm",e.ServicesTasks="ServicesTasks",e.SettingsService="SettingsService",e.ShellService="ShellService",e.Tasks="Tasks",e.Theme="Theme",e.Timed="Timed"}(d||(d={}));const c=new Map([[r.qb.BAD_REQUEST,l.InvalidRequestFormat],[r.qb.NOT_AUTHORIZED,l.Unauthorized],[r.qb.FORBIDDEN,l.Forbidden],[r.qb.NOT_FOUND,l.ResourceNotFound],[r.qb.NOT_ALLOWED,l.InvalidRequestFormat],[r.qb.NOT_ACCEPTABLE,l.InvalidRequestFormat],[r.qb.PROXY_AUTHENTICATION_REQUIRED,l.ProxyAuthenticationRequired],[r.qb.CONFLICT,l.InvalidRequestFormat],[r.qb.GONE,l.ResourceNotFound],[r.qb.LENGTH_REQUIRED,l.InvalidRequestFormat],[r.qb.PRECONDITION_FAILED,l.InvalidRequestFormat],[r.qb.REQUEST_ENTITY_TOO_LARGE,l.PayloadTooBig],[r.qb.UNSUPPORTED_MEDIA_TYPE,l.InvalidRequestFormat],[r.qb.REQUEST_RANGE_NOT_SATISFIABLE,l.InvalidRequestFormat],[r.qb.UNPROCESSABLE_ENTITY,l.InvalidRequestFormat],[r.qb.THROTTLED,l.Throttled],[r.qb.SERVER_ERROR,l.RemoteOperationFailed],[r.qb.NOT_IMPLEMENTED,l.FeatureNotSupported],[r.qb.SERVICE_UNAVAILABLE,l.ServiceUnavailable],[r.qb.GATEWAY_TIMEOUT,l.GatewayTimeout],[r.qb.INSUFFICIENT_STORAGE,l.SpQuotaReached],[r.qb.BANDWIDTH_LIMIT_EXCEEDED,l.MaxCallCountReached]]);var u,m,g;!function(e){e.Initialization="Initialization",e.OnPrimaryUser="OnPrimaryUser",e.OnUserAuthenticated="OnUserAuthenticated",e.OnUserAuthenticated_MTMA="OnUserAuthenticated_MTMA"}(u||(u={})),function(e){e[e.ClearHostSettingsTask=0]="ClearHostSettingsTask",e[e.ConfigOverride=1]="ConfigOverride",e[e.CreateActiveWindowsHistoryTask=2]="CreateActiveWindowsHistoryTask",e[e.CreateAppBarServiceTask=3]="CreateAppBarServiceTask",e[e.CreateAppState=4]="CreateAppState",e[e.CreateAsyncMediaAuth=5]="CreateAsyncMediaAuth",e[e.CreateAuth=6]="CreateAuth",e[e.CreateAuthenticationResources=7]="CreateAuthenticationResources",e[e.CreateAuthMTMA=8]="CreateAuthMTMA",e[e.CreateAuthStateTask=9]="CreateAuthStateTask",e[e.CreateAuthTenants=10]="CreateAuthTenants",e[e.CreateCacheClearing=11]="CreateCacheClearing",e[e.CreateCacheStorageAndCacheManagers=12]="CreateCacheStorageAndCacheManagers",e[e.CreateCDLWorkerAppServiceTask=13]="CreateCDLWorkerAppServiceTask",e[e.CreateCDLWorkerAuthTask=14]="CreateCDLWorkerAuthTask",e[e.CreateCDLWorkerOnAuthUserTask=15]="CreateCDLWorkerOnAuthUserTask",e[e.CreateCDLWorkerOnInitTask=16]="CreateCDLWorkerOnInitTask",e[e.CreateCDLWorkerRegistrarServiceTask=17]="CreateCDLWorkerRegistrarServiceTask",e[e.CreateCDLWorkerTask=18]="CreateCDLWorkerTask",e[e.CreateChangeReporting=19]="CreateChangeReporting",e[e.CreateClientPreferences=20]="CreateClientPreferences",e[e.CreateCommandDelegator=21]="CreateCommandDelegator",e[e.CreateCommandHandler=22]="CreateCommandHandler",e[e.CreateCommandReportingService=23]="CreateCommandReportingService",e[e.CreateCommandResultHooksService=24]="CreateCommandResultHooksService",e[e.CreateCoreSecurityTask=25]="CreateCoreSecurityTask",e[e.CreateCoreShortcutService=26]="CreateCoreShortcutService",e[e.CreateCoreUtilities=27]="CreateCoreUtilities",e[e.CreateDataClient=28]="CreateDataClient",e[e.CreateDeeplinkService=29]="CreateDeeplinkService",e[e.CreateDefaultCacheStorageAndCacheManagers=30]="CreateDefaultCacheStorageAndCacheManagers",e[e.CreateDefaultLocalStorage=31]="CreateDefaultLocalStorage",e[e.CreateDiscovery=32]="CreateDiscovery",e[e.CreateEndpointsManager=33]="CreateEndpointsManager",e[e.CreateEntityCommanding=34]="CreateEntityCommanding",e[e.CreateEventHandler=35]="CreateEventHandler",e[e.CreateExternalCommandListener=36]="CreateExternalCommandListener",e[e.CreateGraphQlOpsService=37]="CreateGraphQlOpsService",e[e.CreateGraphQLStoreStatsReporterService=38]="CreateGraphQLStoreStatsReporterService",e[e.CreateGtmRegistry=39]="CreateGtmRegistry",e[e.CreateHostCommandingListener=40]="CreateHostCommandingListener",e[e.CreateHostCommunication=41]="CreateHostCommunication",e[e.CreateHostedWindowContext=42]="CreateHostedWindowContext",e[e.CreateI18n=43]="CreateI18n",e[e.CreateI18NextWrapper=44]="CreateI18NextWrapper",e[e.CreateInactiveGC=45]="CreateInactiveGC",e[e.CreateLocalStorage=46]="CreateLocalStorage",e[e.CreateLpc=47]="CreateLpc",e[e.CreateNovaAppBarUpdater=48]="CreateNovaAppBarUpdater",e[e.CreatePlatform=49]="CreatePlatform",e[e.CreateProfiler=50]="CreateProfiler",e[e.CreateReboot=51]="CreateReboot",e[e.CreateRouting=52]="CreateRouting",e[e.CreateSettings=53]="CreateSettings",e[e.CreateSettingsUserContext=54]="CreateSettingsUserContext",e[e.CreateSignalProcessor=55]="CreateSignalProcessor",e[e.CreateTrackUserServiceTask=56]="CreateTrackUserServiceTask",e[e.CreateUserDataClient=57]="CreateUserDataClient",e[e.CreateUserOnContextContext=58]="CreateUserOnContextContext",e[e.CreateUserTelemetryServicesTask=59]="CreateUserTelemetryServicesTask",e[e.CreateWebClientUpdate=60]="CreateWebClientUpdate",e[e.CreateWindow=61]="CreateWindow",e[e.DisableExperience=62]="DisableExperience",e[e.DiscoverUser=63]="DiscoverUser",e[e.EnableHostRouting=64]="EnableHostRouting",e[e.FetchBootstrapData=65]="FetchBootstrapData",e[e.FetchCriticalDynamicImportsTask=66]="FetchCriticalDynamicImportsTask",e[e.FetchHostSettingsTask=67]="FetchHostSettingsTask",e[e.GeneralizedLogActivityTask=68]="GeneralizedLogActivityTask",e[e.InitApiServiceProvider=69]="InitApiServiceProvider",e[e.InitAsyncMediaAuthService=70]="InitAsyncMediaAuthService",e[e.InitATPPolicyTask=71]="InitATPPolicyTask",e[e.InitAuthenticationService=72]="InitAuthenticationService",e[e.InitBrbServiceManagerTask=73]="InitBrbServiceManagerTask",e[e.InitDesktopEcsContext=74]="InitDesktopEcsContext",e[e.InitExperimentation=75]="InitExperimentation",e[e.InitializePulsarTask=76]="InitializePulsarTask",e[e.InitInterprocessStore=77]="InitInterprocessStore",e[e.InitPreAuthSettingsEcsProvider=78]="InitPreAuthSettingsEcsProvider",e[e.InitSettingsClientFiltersProvider=79]="InitSettingsClientFiltersProvider",e[e.InitSettingsEcsProvider=80]="InitSettingsEcsProvider",e[e.InitSettingsMaglevHostProvider=81]="InitSettingsMaglevHostProvider",e[e.InitSettingsPolicyProvider=82]="InitSettingsPolicyProvider",e[e.InitTelemetry=83]="InitTelemetry",e[e.InitUserBrbServiceTask=84]="InitUserBrbServiceTask",e[e.LeakDetector=85]="LeakDetector",e[e.LogActivityTask=86]="LogActivityTask",e[e.Polyfills=87]="Polyfills",e[e.RegisterCustomFrameThemes=88]="RegisterCustomFrameThemes",e[e.ReinitSettingsEcsProvider=89]="ReinitSettingsEcsProvider",e[e.ReloadExperience=90]="ReloadExperience",e[e.Scheduling=91]="Scheduling",e[e.SetPrimaryUserOnCoreSettingsTask=92]="SetPrimaryUserOnCoreSettingsTask",e[e.SetPrimaryUserOnTelemetry=93]="SetPrimaryUserOnTelemetry",e[e.SetRingFinderCookieTask=94]="SetRingFinderCookieTask",e[e.SetUserOnDiagnosticsService=95]="SetUserOnDiagnosticsService",e[e.SetUserOnTelemetryContext=96]="SetUserOnTelemetryContext",e[e.SignalCoreLifecycleChangesTask=97]="SignalCoreLifecycleChangesTask",e[e.StoreBuildInfoTask=98]="StoreBuildInfoTask",e[e.TelemetryContext=99]="TelemetryContext",e[e.TrackExperienceIdle=100]="TrackExperienceIdle",e[e.TrackUserTask=101]="TrackUserTask",e[e.UpdateDataClientContext=102]="UpdateDataClientContext",e[e.UpdateNetworkStateDetection=103]="UpdateNetworkStateDetection",e[e.UpdateUserMetadataProperties=104]="UpdateUserMetadataProperties",e[e.UserSettings=105]="UserSettings",e[e.WaitForCDLWorkerTask=106]="WaitForCDLWorkerTask",e[e.WindowDebugEvents=107]="WindowDebugEvents",e[e.WrapChangeReportingServicesTask=108]="WrapChangeReportingServicesTask"}(m||(m={})),function(e){e.Blur="blur",e.Click="click",e.Focus="focus",e.Keydown="keydown",e.Keyup="keyup",e.Keypress="keypress",e.Mousedown="mousedown",e.Mousemove="mousemove",e.Mouseup="mouseup",e.Mouseleave="mouseleave",e.Touchstart="touchstart",e.Touchmove="touchmove",e.Touchend="touchend",e.Paste="paste",e.Resize="resize",e.Scroll="scroll",e.System="system",e.Sample="sample"}(g||(g={}));const p="main",h="core",v="en-us";var S;!function(e){e.CDN="CDN",e.Shared="Shared",e.Browser="Browser",e.None="None"}(S||(S={}));const f="teams-precache-v2",y='NOTE: Data sent in feedback submissions will be "Support Data" under your agreement for Microsoft 365, including any information that would otherwise be considered "Customer Data" or "Personal Data". Please do not submit feedback that may include data you do not wish to provide to Microsoft as "Support Data".'},3847:(e,t,n)=>{"use strict";var i;n.d(t,{i:()=>i}),function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warn=2]="Warn",e[e.Info=3]="Info",e[e.Debug=4]="Debug",e[e.Verbose=5]="Verbose",e[e.Max=6]="Max"}(i||(i={}))},98995:(e,t,n)=>{"use strict";var i;n.d(t,{f:()=>i}),function(e){e.Experience="Experience",e.Global="Global",e.User="User",e.UserAndExperience="UserAndExperience"}(i||(i={}))},31821:(e,t,n)=>{"use strict";var i;n.d(t,{J:()=>i}),function(e){e.Activity="activity",e.ActivityNotification="activityNotification",e.AgeConsent="ageConsent",e.ArtifactsPlatform="artifactsPlatform",e.Auth="auth",e.Autosuggest="autosuggest",e.BiometricEnrollment="biometricEnrollment",e.Brb="brb",e.BreakoutRoom="breakoutRoom",e.Broadcast="broadcast",e.Calendar="calendar",e.Calling="calling",e.Cdl="cdl",e.CdlWorker="cdlWorker",e.Chat="chat",e.ChatList="chatList",e.ChatService="chatService",e.Channels="channels",e.CMDMeetingArtifactsService="cmdMeetingArtifactsService",e.MeetingCatchupService="meetingCatchupService",e.Coach="coach",e.Communities="communities",e.Compose="compose",e.Core="core",e.Cortana="cortana",e.ConsumerGroups="consumerGroups",e.ConversationsReminder="conversationsReminder",e.CsaService="csaService",e.Default="default",e.Diagnostics="diagnostics",e.DiscoverSurface="discoverSurface",e.DistributionLists="distributionLists",e.DropInSpaces="dropInSpaces",e.DynamicsMarketing="dynamicsMarketing",e.Edu="edu",e.EmbedClient="embedClient",e.Esp="esp",e.Extensibility="extensibility",e.ExternalAccounts="externalAccounts",e.Federated="federated",e.Feedback="feedback",e.Files="files",e.Flyout="flyout",e.Fre="fre",e.Freemium="freemium",e.Gallery="gallery",e.Giphy="giphy",e.Growth="growth",e.Guardians="guardians",e.Host="host",e.ImageCache="imageCache",e.Immersive="immersive",e.InviteLinks="inviteLinks",e.LiveStateService="liveStateService",e.Localization="localization",e.LmsIntegration="lmsIntegration",e.Meet="meet",e.MeetingArtifacts="meetingArtifacts",e.MeetingCollaboration="meetingCollaboration",e.MeetingBot="meetingBot",e.MeetingExtensibility="meetingExtensibility",e.MeetingOptions="meetingOptions",e.MeetingRecap="meetingRecap",e.MeetingStream="meetingStream",e.MeetingTemplates="meetingTemplates",e.Meetup="meetup",e.Messaging="messaging",e.Metadata="metadata",e.Mobile="mobile",e.Notifications="notifications",e.Organization="organization",e.Outlook="outlook",e.People="people",e.PeopleTargeting="peopleTargeting",e.PhoneLinkSms="phoneLinkSms",e.Platform="platform",e.Presence="presence",e.Pulsar="pulsar",e.Sdk="sdk",e.Search="search",e.SearchCommon="searchCommon",e.Security="security",e.SensitivityLabel="sensitivityLabel",e.Serp="serp",e.Shortcuts="shortcuts",e.SurveyForm="surveyForm",e.Sync="sync",e.TeamsAndChannels="teamsAndChannels",e.TeamsPushService="teamsPushService",e.Telemetry="telemetry",e.Tenant="tenant",e.Test="test",e.TrouterService="trouterService",e.Ufd="ufd",e.UserResources="userResources",e.VirtualAppointments="virtualAppointments",e.VirtualEvents="virtualEvents",e.WebinarRegistration="webinarRegistration",e.WhatsNew="whatsNew",e.Wiki="wiki",e.WindowsSignatureExperiences="windowsSignatureExperiences"}(i||(i={}))},20448:(e,t,n)=>{"use strict";var i,a;n.d(t,{EJ:()=>i,f_:()=>a}),function(e){e.AiInsightsFeedbackService="AiInsightsFeedbackService",e.AppService="appservice",e.Attendee="attendee",e.AllFiles="allFiles",e.Auth="auth",e.BRB="brb",e.ECS="ecs",e.CDN="cdn",e.CNS="cns",e.ChatService="chatservice",e.CMDArtifactsService="cmdArtifactsService",e.CmdMeetingIntelligenceService="cmdMeetingIntelligenceService",e.CMDServices="cmdServices",e.CSA="csa",e.CXCS="cxcs",e.DynamicsMarketing="dynamicsMarketing",e.DynamicsVirtualEvents="dynamicsVirtualEvents",e.Graph="graph",e.GroupsServiceV2="groupsServiceV2",e.Vroom="vroom",e.MeetingArtifacts="meetingArtifacts",e.MeetingIntelligenceService="meetingIntelligenceService",e.MeetingRecapService="meetingRecapService",e.MeetingTemplates="meetingTemplates",e.MiddleTier="mt",e.MsaContacts="msaContacts",e.MSGraph="msGraph",e.MeetingRecapSwa="meetingRecapSwa",e.Payment="payment",e.PowerApps="powerapps",e.Sharepoint="sharepoint",e.Skype="skype",e.Substrate="substrate",e.Suggestion="suggestion",e.TeamsAndChannelsProvisioningService="teamsAndChannelsProvisioningService",e.TeamsPushService="teamsPushService",e.UnifiedPresence="unifiedPresence",e.UserEntitlement="ues",e.LokiWrapper="lokiWrapper",e.NetworkPing="networkPing",e.OCV="ocv",e.ODS="ods",e.InstantAnswers="instantanswers",e.OSearch="osearch",e.PPTCast="pptcast",e.Webinar="webinar",e.Workflows="workflows",e.Ocws="ocws",e.CollabCloudService="collabCloudService",e.UnifiedConsent="unifiedConsent",e.VivaInsights="vivaInsights",e.VivaInsightsMT="vivaInsightsMt"}(i||(i={})),function(e){e.xMsClientType="x-ms-client-type",e.xMsClientVersion="x-ms-client-version",e.xMsSessionId="x-ms-session-id",e.xMsRequestId="x-ms-request-id",e.xMsClientCaller="x-ms-client-caller"}(a||(a={}))},4266:(e,t,n)=>{"use strict";var i;n.d(t,{i:()=>i}),function(e){e[e.Missing=0]="Missing",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.Failed=3]="Failed"}(i||(i={}))},6137:(e,t,n)=>{"use strict";var i;n.d(t,{vW:()=>i,o_:()=>a,Tf:()=>o}),function(e){e[e.Macro=0]="Macro",e[e.RenderBlocking=1]="RenderBlocking"}(i||(i={}));const a=-1;var o;!function(e){e[e.None=0]="None",e[e.Canceled=1]="Canceled",e[e.Received=2]="Received",e[e.Started=3]="Started",e[e.Complete=4]="Complete"}(o||(o={}))},39874:(e,t,n)=>{"use strict";var i,a;n.d(t,{G:()=>i,T:()=>a}),function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online"}(i||(i={})),function(e){e.Offline="Offline",e.Online="Online",e.Unknown="Unknown",e.SuspectedOffline="Suspected Offline"}(a||(a={}))},54808:(e,t,n)=>{"use strict";var i;n.d(t,{s:()=>i}),function(e){e.ag08="ag08",e.ag09="ag09",e.dod="dod",e.gallatin="gallatin",e.gcc="gcc",e.gcchigh="gcchigh",e.life="life",e.prod="prod"}(i||(i={}))},96825:(e,t,n)=>{"use strict";var i,a;n.d(t,{Z:()=>i,d:()=>a}),function(e){e.AppUpdatedUsingServiceWorker="AppUpdatedUsingServiceWorker",e.ClearContainer="ClearContainer",e.CloudMismatchOnLogIn="CloudMismatchOnLogIn",e.ErrorPageReboot="ErrorPageReboot",e.ErrorPageSignOut="ErrorPageSignOut",e.RemoveAuthenticatedUser="RemoveAuthenticatedUser",e.RingSwitch="RingSwitch",e.LanguageSwitch="LanguageSwitch"}(i||(i={})),function(e){e.Auth="Auth",e.DeveloperSwitchersService="DeveloperSwitchersService",e.ReloadAppTask="ReloadAppTask",e.WebClientUpdateService="WebClientUpdateService",e.RemoveAuthenticatedUserResolver="RemoveAuthenticatedUserResolver",e.Core="Core"}(a||(a={}))},82372:(e,t,n)=>{"use strict";var i,a,o,r,s,l,d,c,u,m,g,p,h,v,S,f,y,k,C;n.d(t,{OV:()=>i,Ml:()=>o,Wz:()=>l,Zc:()=>d,XR:()=>c,cb:()=>u,Lv:()=>m}),function(e){e.Work="",e[e.Freemium=2]="Freemium",e[e.Life=3]="Life"}(i||(i={})),function(e){e.Personal="personal",e.Channel="channel",e.Unknown="unknown"}(a||(a={})),function(e){e.GuardianChat="GuardianChat"}(o||(o={})),function(e){e[e.anonymous=0]="anonymous",e[e.default=1]="default",e[e.guest=2]="guest",e[e.msaGuest=3]="msaGuest",e[e.msaMember=4]="msaMember",e[e.otpGuest=5]="otpGuest",e[e.otpMember=6]="otpMember"}(r||(r={})),function(e){e[e.Admin=0]="Admin",e[e.Anonymous=1]="Anonymous",e[e.Guest=2]="Guest",e[e.Regular=3]="Regular"}(s||(s={})),function(e){e.x64="x64",e.ia32="ia32",e.x86="x86",e.unknown="unknown"}(l||(l={})),function(e){e.MACOSX="UNIX/MACINTOSH",e.UNIX="UNIX",e.UNKNOWN="Unknown",e.WINDOWS="Windows"}(d||(d={})),function(e){e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(c||(c={})),function(e){e.background="background",e.foreground="foreground"}(u||(u={})),function(e){e.maximized="maximized",e.minimized="minimized",e.systray="systray"}(m||(m={})),function(e){e.copy="Copy"}(g||(g={})),function(e){e.nav="nav",e.notification="notification"}(p||(p={})),function(e){e.Cold="cold",e.Warm="warm"}(h||(h={})),function(e){e.TopLevel="L1",e.DrillDown="L2"}(v||(v={})),function(e){e.SettingsPrivacyPage="SettingsPrivacyPage",e.LpcMeProfileCard="LpcMeProfileCard"}(S||(S={})),function(e){e.tflExternal="TFLExternal",e.tfwUser="TFWUser"}(f||(f={})),function(e){e.addMembers="addMembers",e.pinChannel="pinChannel",e.unpinChannel="unpinChannel",e.favoriteChannel="favoriteChannel",e.manageChannel="manageChannel",e.getChannelEmail="getChannelEmail",e.getChannelLink="getChannelLink",e.editChannel="editChannel",e.editChannelConnectors="editChannelConnectors",e.deleteChannel="deleteChannel"}(y||(y={})),function(e){e.pinned="pinned",e.shown="shown",e.hidden="hidden"}(k||(k={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(C||(C={}))},15496:(e,t,n)=>{"use strict";var i,a,o,r,s;n.d(t,{Mv:()=>i,Ky:()=>a,sG:()=>o}),function(e){e[e.general=0]="general",e[e.team=1]="team",e[e.personal=2]="personal",e[e.group=4]="group",e[e.meeting=8]="meeting"}(i||(i={})),function(e){e[e.na=0]="na",e[e.bots=1]="bots",e[e.tabs=2]="tabs",e[e.messaging=3]="messaging",e[e.connectors=4]="connectors",e[e.videoExtensibility=5]="videoExtensibility"}(a||(a={})),function(e){e[e.na=0]="na",e[e.card=1]="card",e[e.deepLink=2]="deepLink",e[e.messageExtension=3]="messageExtension",e[e.platformExtensionTab=4]="platformExtensionTab",e[e.contentBubble=5]="contentBubble",e[e.shareToOutlook=6]="shareToOutlook",e[e.adaptiveCardTab=7]="adaptiveCardTab",e[e.botConfig=8]="botConfig"}(o||(o={})),function(e){e.bot="bot",e.inputextension="inputextension",e.connectors="connectors"}(r||(r={})),function(e){e.carousel="carousel",e.list="list"}(s||(s={}))},37814:(e,t,n)=>{"use strict";var i,a;n.d(t,{t:()=>i,z:()=>a}),function(e){e.core="core",e.window="window",e.mtmaCore="mtmaCore",e.mtmaUser="mtmaUser",e.mtmaWindow="mtmaWindow",e.viewSchema="viewSchema",e.embed="embed",e.cmd="cmd",e.other="other"}(i||(i={})),function(e){e.query="query",e.watchQuery="watchQuery",e.mutate="mutate",e.subscribe="subscribe",e.readQuery="readQuery",e.writeQuery="writeQuery",e.readFragment="readFragment",e.writeFragment="writeFragment"}(a||(a={}))},21826:(e,t,n)=>{"use strict";var i;n.d(t,{x:()=>i}),function(e){e[e.Perf=0]="Perf",e[e.Scenario=1]="Scenario",e[e.Logging=2]="Logging",e[e.Heartbeat=3]="Heartbeat",e[e.Http=4]="Http",e[e.UserBI=5]="UserBI",e[e.Endpoint=6]="Endpoint",e[e.ClickStream=7]="ClickStream"}(i||(i={}))},41656:(e,t,n)=>{"use strict";var i;n.d(t,{R:()=>i}),function(e){e.flyout="flyout",e.iFrame="iFrame",e.primary="primary",e.secondary="secondary"}(i||(i={}))},53818:(e,t,n)=>{"use strict";var i,a;n.d(t,{Q:()=>i,N:()=>a}),function(e){e.Unknown="unknown",e.Prod="prod"}(i||(i={})),function(e){e.MW="MW",e.Anglr="Anglr",e.ShareToTeams="ShareToTeams",e.Files="Files",e.Calendar="Calendar",e.MtgOpt="MtgOpt",e.EmbedClient="EmbedClient",e.LmsIntegration="LmsIntegration",e.CallingEmbed="CallingEmbed",e.ReactWebClient="ReactWebClient",e.Example="Example"}(a||(a={}))},7042:(e,t,n)=>{"use strict";var i;n.d(t,{W:()=>i}),function(e){e.WindowReady="windowReady",e.WindowUnloaded="windowUnloaded",e.WindowAppStart="windowAppStart",e.CoreInitialized="coreInitialized",e.CommandChangeType="commandEvent",e.ExperienceStarted="experienceStarted",e.CoreInitializationFailed="coreInitializationFailed",e.ExtendedEntityContainerState="extendedEntityContainerState",e.MainWindowBlockedState="mainWindowBlockedState"}(i||(i={}))},19898:(e,t,n)=>{"use strict";var i,a,o,r,s,l;n.d(t,{NR:()=>i,Bh:()=>a,RY:()=>o,GJ:()=>r,AR:()=>s,us:()=>l}),function(e){e.Windows="windows",e.Mac="mac",e.Linux="linux",e.ChromeOS="chromeos",e.Android="android",e.IOS="ios",e.WindowsPhone="windowsphone",e.Unknown="unknown"}(i||(i={})),function(e){e.Web="web",e.Desktop="desktop",e.CDLWorker="cdlworker",e.Embed="embed",e.Maglev="maglev",e.OutlookWeb="Outlook Web",e.OutlookDesktop="Outlook Desktop",e.OfficeWeb="Office Web",e.OfficeDesktop="Office Desktop"}(a||(a={})),function(e){e.Embed="embed"}(o||(o={})),function(e){e.Outlook="outlook",e.Unknown="unknown"}(r||(r={})),function(e){e.Edge="edge",e.Safari="safari",e.Chrome="chrome",e.Firefox="firefox",e.Electron="electron",e.Unknown="unknown"}(s||(s={})),function(e){e[e.Web=1415]="Web",e[e.Desktop=27]="Desktop",e[e.Mac=28]="Mac",e[e.Linux=41]="Linux",e[e.Rigel=34]="Rigel",e[e.SurfaceHub=35]="SurfaceHub",e[e.SurfaceHub2=38]="SurfaceHub2",e[e.Maglev=48]="Maglev",e[e.MaglevT21=49]="MaglevT21",e[e.MaglevMacT21=50]="MaglevMacT21",e[e.MetaOsOffice=5500]="MetaOsOffice",e[e.MetaOsOutlook=5501]="MetaOsOutlook",e[e.TV=3623]="TV",e[e.Automotive=3624]="Automotive",e[e.SttOutlookWeb=5600]="SttOutlookWeb"}(l||(l={}))},19635:(e,t,n)=>{"use strict";var i,a;n.d(t,{B:()=>i,_:()=>a}),function(e){e.OpenOnMainRenderer="main"}(i||(i={})),function(e){e.DeepLink="deepLink",e.ImmersiveReader="immersiveReader",e.MeetingNotes="meetingNotes",e.Transcript="Transcript",e.JoinBroadcastAsAttendee="joinBroadcastAsAttendee"}(a||(a={}))},67424:(e,t,n)=>{"use strict";var i,a,o,r;n.d(t,{QP:()=>i,d:()=>a,zF:()=>r}),function(e){e.standAlone="main",e.iframe="iFrame",e.secondary="MW",e.embedded="EDOM",e.worker="Worker"}(i||(i={})),function(e){e.flyout="flyout",e.main="main"}(a||(a={})),function(e){e.owa="OWA",e.outlook="Outlook",e.officeOnline="OfficeOnline",e.wordWeb="WordWeb",e.word="Word",e.excelWeb="ExcelWeb",e.excel="Excel",e.powerPointWeb="PowerPointWeb",e.powerPoint="PowerPoint",e.lmsBlackBoard="BlackBoard",e.lmsCanvas="Canvas",e.lmsMoodle="Moodle",e.lmsBrightspace="Brightspace",e.lmsOther="OtherLMS",e.lmsOpenLMS="OpenLMS",e.lmsSchoology="Schoology",e.unknown="unknown",e.thirdParty="ThirdParty",e.dynamics="Dynamics",e.onePlayer="OnePlayer",e.devHost="DevHost",e.edge="Edge"}(o||(o={})),function(e){e.userInitiated="userInitiated"}(r||(r={}))},9940:(e,t,n)=>{"use strict";var i,a,o,r,s;n.d(t,{rY:()=>i,cr:()=>a,Gx:()=>o,H:()=>s}),function(e){e.ExpandTab="expandTab",e.UndoExpandTab="undoExpandTab",e.MaximizeTab="maximizeTab",e.UndoMaximizeTab="undoMaximizeTab",e.WindowInitialized="windowInitialized",e.WindowErrored="windowErrored",e.GetAadToken="aadGetToken",e.Login="login",e.GetDriveItemResponse="getDriveItemResponse",e.GetAadCurrentUser="aadCurrentUser",e.AadClearCacheForResource="aadClearCache",e.GetStateData="getStateData",e.GetLogs="getLogs",e.GetSettings="getSettings",e.TriggerAutoBrb="triggerAutoBrb",e.ShouldShowChatNotification="shouldShowChatNotification",e.GetLeaks="getLeaks",e.GetMemory="getMemory",e.UpdateWindowState="updateWindowState",e.AppStateSyncMessage="appStateSyncMessage",e.CentralDataLayerRequest="centralDataLayer:request",e.CentralDataLayerResponse="centralDataLayer:response",e.ScreenSharingControlMessage="screenSharing:controlMessage",e.HideFileViewerLoader="hideFileViewerLoader",e.StopDocStageScenario="stopDocStageScenario",e.AddScenarioMarker="addScenarioMarker",e.FilesExperienceSendData="filesExperience:sendData",e.FilesExperienceRequestData="filesExperience:requestData",e.ActivityEvent="activityEvent",e.GetAggregatedSettings="getAggregatedSettings",e.SetAggregatedSettings="setAggregatedSettings",e.GetWindowLaunchSubSteps="getWindowLaunchSubSteps",e.CreateWebview="createWebview",e.UnhandledMouseEvent="unhandledMouseEvent",e.GetHeartbeat="getHeartbeat",e.GetApolloCacheStats="getApolloCacheStats",e.GetCdlStats="getCdlStats",e.GetWindowEntityTypeStats="getWindowEntityTypeStats",e.SetTouchBar="set-touch-bar",e.ClearTouchBar="clear-touch-bar",e.LayoutChangeMessage="layoutChangeMessage",e.UnhandledShortcut="unhandledShortcut",e.NavigateToOpenerLandmark="NavigateToOpenerLandmark",e.NavigateToLandmark="NavigateToLandmark",e.HybridRouteNavigation="hybridRouteNavigation",e.FocusManagementEvent="focusManagementEvent",e.FocusResetEvent="focusResetEvent",e.CdlRegistration="cdlRegistration",e.NotificationBannerUpdate="NotificationBannerUpdate",e.EntityCommandTimedOutAtHost="entityCommandTimedOutAtHost",e.ActivateOutlook="activateOutlook",e.RequestTabMetrics="requestTabMetrics",e.SendWebviewIdentity="sendWebviewIdentity",e.HasDevicePermissions="hasDevicePermissions",e.HasDevicePermissionsCallback="hasDevicePermissionsCallback"}(i||(i={})),function(e){e.GlobalWindowError="error",e.UnhandledRejection="unhandledrejection"}(a||(a={})),function(e){e.Create="createIframe",e.Destroy="destroyIframe",e.ChildReady="iframeReady",e.Acquired="iframeAcquired",e.ToggleMinimized="toggleChatMinimize"}(o||(o={})),function(e){e.ConversationOpened="conversationOpened",e.CreateNewConversation="createNewConversation",e.EmbedClientInitializationSuccess="embedClientInitializationSuccess",e.EmbedClientInitializationFail="embedClientInitializationFail",e.NewConversationResolved="newConversationResolved",e.SetFocusOnChatList="setFocusOnChatList",e.UpdateSettings="UpdateSettings"}(r||(r={})),function(e){e.LogoutSuccess="logoutSuccessful",e.LogoutFailed="logoutFailed",e.Logout="logout"}(s||(s={}))},64816:(e,t,n)=>{"use strict";n.d(t,{I:()=>o});var i=n(98995);const a="IntentPersistenceService";class o{constructor(e){this._localStorage=e}getAllStoredDeeplinks(){const e=this._localStorage.get(a,i.f.Experience);return this.jsonParseSafe(e)||{}}storeDeeplink(e,t){const n=this.getAllStoredDeeplinks();n[e]=t.toString(),this.persist(n)}deleteDeeplink(e){const t=this.getAllStoredDeeplinks();delete t[e],this.persist(t)}clear(){this._localStorage.remove(a,i.f.Experience)}persist(e){this._localStorage.set(a,JSON.stringify(e),i.f.Experience)}jsonParseSafe(e){if(e)try{return JSON.parse(e)}catch(e){return}}}},59754:(e,t,n)=>{"use strict";var i;n.d(t,{f:()=>i}),function(e){e.AssignedPriorityStatusToToast="AssignedPriorityStatusToToast",e.CallsActionTypeToNotificationActionFailed="CallsActionTypeToNotificationActionFailed",e.CallingToastActionMutationFailed="CallingToastActionMutationFailed",e.ChatActionTypeToNotificationActionFailed="ChatActionTypeToNotificationActionFailed",e.ChatTabsFetchFailed="ChatTabsFetchFailed",e.ChatToastActionMutationFailed="ChatToastActionMutationFailed",e.ChatToastEmoticonsQueryFailed="ChatToastEmoticonsQueryFailed",e.ChannelToastEmoticonsQueryFailed="ChannelToastEmoticonsQueryFailed",e.CollectionIdUndefined="CollectionIdUndefined",e.ConversionToHostEntityOptionsFailed="ConversionToHostEntityOptionsFailed",e.ConversationAlerts="ConversationAlerts",e.ConversationIsMuted="ConversationIsMuted",e.DateConversionFailed="DateConversionFailed",e.DefinedIfToastCanIgnoreConversationMuted="DefinedIfToastCanIgnoreConversationMuted",e.EmptyEvent="EmptyEvent",e.ImageFetchFailed="ImageFetchFailed",e.ImageUrlGenerationFailed="ImageUrlGenerationFailed",e.NoAutheticatedUserOrTrackingService="NoAutheticatedUserOrTrackingService",e.NotEnabled="NotEnabled",e.PriorityAssignmentSkipped="PriorityAssignmentSkipped",e.RequiredFieldMissing="RequiredFieldMissing",e.ReturningFetchedImage="ReturningFetchedImage",e.ReturningHardcodedImage="ReturningHardcodedImage",e.ReturningUserKeyForToastCollection="ReturningUserKeyForToastCollection",e.SkippingPriorityMessageFromLongpoll="SkippingPriorityMessageFromLongpoll",e.SubscriptionFailed="SubscriptionFailed",e.ToastCommandSent="ToastCommandSent",e.ToastEventIsAlreadyRead="ToastEventIsAlreadyRead",e.ToastEventReceivedInJob="ToastEventReceivedInJob",e.ToastEventReceivedInWorkerResolver="ToastEventReceivedInWorkerResolver",e.ToastImageAsDataUriIsUndefined="ToastImageAsDataUriIsUndefined",e.ToastNavigationDataNotFound="ToastNavigationDataNotFound",e.ToastSuppressedForWindowInFocus="ToastSuppressedForWindowInFocus",e.UnhandledType="UnhandledType",e.UnhandledSubtype="UnhandledSubtype",e.YieldingToastFromWorkerResolver="YieldingToastFromWorkerResolver"}(i||(i={}))},18541:(e,t,n)=>{"use strict";n.d(t,{E:()=>s,z:()=>l});var i=n(13637),a=n(38923),o=n(75068);let r;const s=e=>t=>(0,i.mG)(void 0,void 0,void 0,(function*(){if(!r)return e(t);return e(t).then((e=>(null==r||r.processResponse(e),e))).catch((e=>{throw null==r||r.processError(e),e}))}));function l(e,t){if(r){throw(0,a.Tr)(o.w5.Tasks,o.jK.AlreadyInitialized,"subscribeToSendNetworkTracking",void 0,"subscription exists")}r={processResponse:e,processError:t};return()=>{r=void 0}}},94333:(e,t,n)=>{"use strict";n.d(t,{I:()=>j,s:()=>R});var i,a,o=n(13637);!function(e){e.apps="apps",e.broadcasts="broadcasts",e.chats="chats",e.calls="calls",e.calendars="calendars",e.extensions="extensions",e.files="files",e.licenses="licenses",e.meetings="meetings",e.teamgallery="teamgallery"}(i||(i={})),function(e){e.list="list",e.create="create",e.join="join",e.error="error",e.view="view"}(a||(a={}));var r=n(39843),s=n(34255);const l=new Map,d=/^\/|\/$/g;function c(e,t){const n=t?":":"",i=e.id?`/${n}${e.id}`:"",a=e.action?`/${e.action}`:"";return`${e.resource}${i}${a}`}function u(e){const{descriptor:t,asPath:n,stem:i=""}=e,a=(0,o._T)(e,["descriptor","asPath","stem"]);let r=i;const s=t?t.resources:void 0;if(s&&s.length>0)for(const e of s)r=`${r}/${c(e,n)}`;return Object.assign(Object.assign({},a),{descriptor:t,asPath:n,stem:r})}function m(...e){return e.reduce(((e,t)=>(e.resources=e.resources.concat(t.resources),e.search=Object.assign(Object.assign({},e.search),t.search),e)),{resources:[],search:{}})}function g(e){return(0,s.flow)([u,S,f])(e).stem}function p(e){if(!e||0===e.length)return[];const t=l.get(e);if(t)return t;let n=[];const o=e.replace(d,"");if(0===o.length)return n;const r=o.split("/");try{const t=function(e){const t=[];let n=-1;for(const a of e){const e=a;i[e]&&(n++,t[n]=[]),n>=0&&t[n].push(e)}return t}(r);return t&&(n=t.map((e=>{let t;const n=2,i=3;switch(e.length){case i:t={resource:e[0],id:e[1],action:e[n]};break;case n:{const n=e[1];t=a[n]?{resource:e[0],action:e[1]}:{resource:e[0],id:e[1]};break}default:throw new Error("Invalid resource fragment format found, id or action is required.")}return t}))),l.size<1e3&&l.set(e,n),n}catch(e){throw new Error(`Unable to parse path into proper resources. ${e.message}`)}}function h(e){return(0,r.Qc)(e||"")}function v(e){return(0,r.Pz)(e||{})}function S(e){const{context:t,asPath:n,stem:i=""}=e;let a=i;if(t){const e=t.router;if(!e)throw new Error("Cannot generate a relative path without a context. Verify a context was added provided");{const t=n?e.route.match.path:e.route.match.url;a="/"!==t?`${t}${a}`:a}}return Object.assign(Object.assign({},e),{stem:a})}function f(e){const{descriptor:t,asPath:n,stem:i=""}=e;let a=i;if(t){const e=v(t.search);e&&(a=`${a}${n?`/:${e}`:`?${e}`}`)}return Object.assign(Object.assign({},e),{stem:a})}function y(e){const{pathname:t,search:n}=e;return{resources:p(t),search:h(n)}}class k{constructor(e,t){this.history=t,this._logger=e.newLogger("Routing Service")}navigate(e){const t=function(e){const{search:t}=e,n=(0,o._T)(e,["search"]),i=v(t);return{pathname:g({descriptor:n}),search:i}}(e);this.execute(t)}execute(e){this.history?this.history.push(e):this._logger.error("Unable to route using history. History initialized with undefined")}}class C{constructor(e,t,n){this._location=t,this._history=n,this._logger=e.newLogger("State Routing Service")}getSearchState(){const e=this.getLocation();if(!e)return{};const t=e.search;return t!==this._previousSearch&&(this._previousSearch=t,this._currentState=h(t)),this._currentState||{}}getOrigin(){const e=this.getLocation();return e&&e.origin}getHost(){const e=this.getLocation();return e&&e.host}getPathname(){const e=this.getLocation();return e&&e.pathname}getLocation(){if(this._location||this._logger.error("Unable to execute on location. Location initialized with undefined"),this._location&&this._history&&this._history.location){const{search:e,pathname:t}=this._history.location;return Object.assign(Object.assign({},this._location),{search:e,pathname:t})}return this._location}}var b;!function(e){e.OrgChart="organization"}(b||(b={}));class T{constructor(e,t){this.routingService=e,this.rootRoutingService=t}toCreateChatWithUsers(e){this.routingService.navigate(this.createChatWithUsersDescriptor(e))}toChatById(e){this.routingService.navigate(this.chatByIdDescriptor(e))}toOrgChart(e){this.routingService.navigate(this.orgChartDescriptor(e))}toChatList(){this.routingService.navigate(this.chatListDescriptor())}chatByIdDescriptor(e){return this.concatToAppDescriptor({resources:[{resource:i.chats,id:e}]})}createChatWithUsersDescriptor(e){const t=JSON.stringify(e&&e.length>0?e.sort():[]);return this.concatToAppDescriptor({resources:[{resource:i.chats,action:a.create,id:t}]})}chatListDescriptor(){return this.concatToAppDescriptor({resources:[{resource:i.chats,action:a.list}]})}orgChartDescriptor(e){return m(this.createChatWithUsersDescriptor([e]),{resources:[{resource:i.extensions,id:b.OrgChart}]})}concatToAppDescriptor(e){return m(this.rootRoutingService.chatAppDescriptor(),e)}}class w{constructor(e,t){this.routingService=e,this.rootRoutingService=t}toCallById(e){this.routingService.navigate(this.callByIdDescriptor(e))}toCallList(){this.routingService.navigate(this.callsListDescriptor())}callByIdDescriptor(e){return this.concatToAppDescriptor({resources:[{resource:i.calls,id:e}]})}callsListDescriptor(){return this.concatToAppDescriptor({resources:[{resource:i.calls,action:a.list}]})}concatToAppDescriptor(e){return m(this.rootRoutingService.callingAppDescriptor(),e)}}class _{constructor(e){this._routingService=e}toAppById(e){this._routingService.navigate(this.appDescriptor(e))}chatAppDescriptor(){return this.appDescriptor("com.microsoft.teams.chat")}callingAppDescriptor(){return this.appDescriptor("com.microsoft.teams.calling")}meetingOptionsAppDescriptor(){return this.appDescriptor("com.microsoft.teams.meetingOptions")}fileAppDescriptor(){return this.appDescriptor("com.microsoft.teams.files")}appDescriptor(e,t){return{resources:[{resource:i.apps,id:e,action:t}]}}}var I;!function(e){e[e.Allow=0]="Allow",e[e.Block=1]="Block"}(I||(I={}));class A{constructor(){this._taps=[]}tap(e){return this._taps.push(e),()=>{this._taps=this._taps.filter((t=>t!==e))}}call(e){let t;for(const n of this._taps){const i=n({data:e,previousResult:t});void 0!==i&&(t=i)}return t}}class N{constructor(e){this._history=e,this.onNavigationBlocked=new A,this.onNavigationStart=new A,this.onNavigationSucceeded=new A,this._handleNavigationStart=e=>{if(!this._history||!this._history.location)return;const t=y(this._history.location),n=y(e);return this.onNavigationStart.call({from:t,to:n})===I.Block?(this.onNavigationBlocked.call({to:n}),!1):void 0},this._handleNavigationSuccess=e=>{const t=y(e);this.onNavigationSucceeded.call({to:t})},this._history&&this._history.block&&this._history.block(this._handleNavigationStart),this._history&&this._history.listen&&this._history.listen(this._handleNavigationSuccess)}}var E=n(38923),D=n(75068);class F{meetingOptionsPageDescriptor(e){const{tenantId:t,organizerId:n,threadId:a,messageId:o,additionalMessageId:r,search:s}=e;return{resources:[{resource:i.meetings,id:JSON.stringify({tenantId:t,organizerId:n,threadId:a,messageId:o,additionalMessageId:r})}],search:s}}meetingOptionsLicenseDescriptor(e){return{resources:[{resource:i.licenses,action:a.list}],search:e?e.search:void 0}}}class P{constructor(e,t){this._history=t,this._logger=e.newLogger("External Routing Service")}serializeToPath(e){const{descriptor:t,exact:n}=e;let i="";return t&&(i=g({descriptor:t})),this._history?n||(i=this._history.createHref({pathname:i}).toString()):n&&this._logger.error("Unable to execute on history to generate absolute path. History initialized with undefined"),i}}let M;const j=(e,t,n)=>{const i=new k(e,t),a=new _(i),o={state:new C(e,n,t),root:a,call:new w(i,a),chat:new T(i,a),meeting:new F,external:new P(e,t),hooks:new N(t)};return M=o,M},R=()=>{if(!M)throw(0,E.Tr)("RoutingServices",D.jK.NotInitialized,"getInstance");return M}},96514:(e,t,n)=>{"use strict";n.d(t,{YK:()=>k,Lk:()=>b});var i,a=n(21826),o=n(55997),r=n(82372);!function(e){e.HEALTHY="healthy",e.UNHEALTHY="unhealthy",e.UNKNOWN="unknown"}(i||(i={}));var s=n(95868),l=n(51581),d=n(89812),c=n(24211),u=n(38923);const m={headers:{sharePoint:{SPRequestGuid:"SPRequestGuid",SPClientServiceRequestDuration:"SPClientServiceRequestDuration",SPRequestDuration:"SPRequestDuration"}}},g="cache",p="cache-control",h="x-cache",v="electron";var S;!function(e){e.CDN="CDN",e.Shared="Shared",e.Browser="Browser",e.None="None"}(S||(S={}));let f="";function y(e){return e.map((e=>{if(e.request){const{status:t,responseHeaders:n,requestHeaders:i}=e.request;e.request.responseHeaders=function(e,t){if(!t)return{};return{contentLength:t["content-length"]||"-1",serverRequestId:t.contextid||t["x-serverrequestid"]||t["request-id"]||w(t),[g]:_(e,t),requestId:t["x-ms-request-id"],invalidToken:t["x-invalid-token"],afdCorrelationId:t["x-msedge-ref"],serverLatency:t["x-end2endlatencyms"]}}(t,n),e.request.requestHeaders=function(e,t){const n={};return t&&e.forEach((e=>{t[e]&&(n[e]=t[e])})),n}(["clientRequestId","x-ms-request-id"],i)}return e}))}const k=(e,t,n="")=>o=>{var r,m;const{serviceName:g,apiName:p,createdTime:h,duration:v,parameters:S,result:k,innerError:b}=o;if(b&&(0,u.Wc)(b))return;f=n;const w=o.correlationId||(0,c.v4)(),_=A(g,p);t.log(`Data call ${_} is completed with ${k}. CorrelationId: ${w}`),o.operationLogs.forEach((t=>{if(t.request){const{name:n,method:i}=t.request;T(e,I(g,n,i),"EM",t,w)}})),o.operationLogs=y(o.operationLogs);const N={userAgent:e.navigator.userAgent,createdTime:h,result:k,innerError:(0,l.u4)(b),correlationId:w,totalDuration:v,ECT:null===(m=null===(r=e.navigator)||void 0===r?void 0:r.connection)||void 0===m?void 0:m.effectiveType,parameters:S,operationLogs:(0,l.u4)(o.operationLogs)};(0,s.P3)(a.x.Http,_,N,void 0,void 0,void 0,f),function(e,t,n){var o,r;const{serviceName:c,apiName:u,createdTime:m,duration:g,parameters:p,result:h,innerError:v,operationLogs:S}=e,y=function(e,t){const n=(0,d.G)().getEndpointHealth(e,t);return void 0===n?i.UNKNOWN:n?i.HEALTHY:i.UNHEALTHY}(c,u);null==S||S.forEach((e=>{if(e.request){const{method:t}=e.request;!function(e,t,n,i,o,r,d){if(t.request){const{duration:c,result:u}=t,{method:m,hostname:g,performance:p,responseHeaders:h,requestHeaders:v,dateTime:S,authPerformanceLogs:y}=t.request,k={apiName:i,serviceName:o,duration:c,result:C(u),correlationId:n,method:m,hostname:g,responseHeaders:(0,l.u4)(h),requestHeaders:(0,l.u4)(v),healthState:r,timestamp:S.toISOString(),hasInnerError:!!d};p&&(p.duration&&(k.perf_duration=p.duration.toString()),k.perf_details=(0,l.u4)(Object.assign(Object.assign(Object.assign({},p),y),{name:void 0}))),(0,s.P3)(a.x.Endpoint,e,k,void 0,void 0,void 0,f)}}(I(c,u,t),e,n,u,c,y,v)}}));const k={apiName:u,serviceName:c,duration:g,result:h,innerError:(0,l.u4)(v),correlationId:n,userAgent:t.navigator.userAgent,timestamp:m,operationLogs:(0,l.u4)(S),parameters:(0,l.u4)(p),ECT:null===(r=null===(o=t.navigator)||void 0===o?void 0:o.connection)||void 0===r?void 0:r.effectiveType,healthState:y},b=A(c,u);(0,s.P3)(a.x.Endpoint,b,k,void 0,void 0,void 0,f)}(o,e,w)};function C(e){const{result:t,resultError:n}=e;let i;return n&&(i=n.innerException?`${n.reason} / ${(0,l.u4)(n.innerException)}`:n.reason),i||t||""}const b=(e,t,n,i,a,r,s)=>{const l=s||o.qb[null==i?void 0:i.status]||"",d=function(e){const t={};if(e)for(const n of Object.keys(e.headers)){t[n.toLowerCase()]=e.headers[n]}return t}(i),{serviceName:c,apiName:u,method:m,authPerformanceLogs:g}=n;T(r,I(c,u,m),"SEND",{type:o.nz.Initial,duration:e,result:{result:l},request:{name:u||"undefined",dateTime:t,method:n.method,hostname:i&&new URL(i.url).hostname,status:null==i?void 0:i.status,requestHeaders:n.headers||{},responseHeaders:d,performance:a,authPerformanceLogs:g}},n.correlationId)};const T=({navigator:e},t,n,i,d)=>{var c;if(i.request){const{dateTime:u,method:m,hostname:g,status:p,requestHeaders:h,responseHeaders:S,performance:y,authPerformanceLogs:k}=i.request,b={ECT:null===(c=null==e?void 0:e.connection)||void 0===c?void 0:c.effectiveType,hostname:g,transport:n,requestCreatedTime:u.toISOString(),networkState:e.onLine?r.XR.ONLINE:r.XR.OFFLINE,method:m,resultCode:p,requestResult:C(i.result),contentLength:S["content-length"]||-1,serverRequestId:S.contextid||S["x-serverrequestid"]||S["request-id"]||w(S),correlationId:d,duration:i.duration,authPerformanceLogs:(0,l.u4)(k)};!function(e,t,n,i,a){const r=i&&i.clientRequestId,s=n["x-ms-request-id"]||i["x-ms-request-id"];e.requestId=s,r&&(e.clientRequestId=r);n["x-invalid-token"]&&(e.invalidToken=n["x-invalid-token"]);t!==o.qb.OK&&(e.afdCorrelationId=n["x-msedge-ref"]);e.hasClaims=!!a&&!!a.hasClaims}(b,p,S,h,k),b.cache=_(p,S),function(e,t,n){if(n){const i=n.domainLookupEnd-n.domainLookupStart,a=n.connectEnd-n.connectStart,o=n.redirectEnd-n.redirectStart;if(i>0&&(e.dns=i),a>0&&(e.tcp=a),o>0&&(e.redirect=o),e.size=n.transferSize,e.payload=n.encodedBodySize,e.start=n.startTime,e.reqStart=n.requestStart,e.respStart=n.responseStart,n.duration){const i=n.duration;(-1===t.userAgent.toLowerCase().indexOf(v)||e.duration&&i>e.duration)&&(e.duration=i)}}}(b,e,y),(0,s.P3)(a.x.Http,t,b,void 0,void 0,void 0,f)}};function w(e){let t=e[m.headers.sharePoint.SPRequestGuid.toLowerCase()]||"";return"[object String]"===Object.prototype.toString.call(t)&&t.length>0&&(t=[`${m.headers.sharePoint.SPRequestGuid}=${t}`,`${m.headers.sharePoint.SPClientServiceRequestDuration}=${e[m.headers.sharePoint.SPClientServiceRequestDuration.toLowerCase()]||""}`,`${m.headers.sharePoint.SPRequestDuration}=${e[m.headers.sharePoint.SPRequestDuration.toLowerCase()]||""}`].join(";")),t}function _(e,t){let n=S.None;if(t.hasOwnProperty(p)){const i=t[p];e===o.qb.NOT_MODIFIED?n=S.Browser:i.includes("no-store")||i.includes("no-cache")||(n=S.Browser,i.includes("public")&&(n+=", ".concat(S.Shared)))}else t.hasOwnProperty("expires")&&(n=S.Browser);if(t.hasOwnProperty(h)){t[h].toLowerCase().includes("hit")&&(n===S.None?n=S.CDN:n+=", ".concat(S.CDN))}return n}function I(e,t,n){return`${e}_${t||"undefined"}_${n}`}function A(e,t){return`${t}_${e}`}},55097:(e,t,n)=>{"use strict";n.d(t,{k:()=>o,H:()=>r});var i=n(31821),a=n(39419);const o=-1;class r{constructor(){this.FractionalBuckets=1e3,this.ConvertToWholeDeviser=10,this.WholeNumberBuckets=100,this.DefaultCohort=0,this.DefaultSampleRate=100,this.rulesLookup={},this.cohortBoundary=this.DefaultCohort,this.telemetrySettings={},this.deviceId=null,this.userId=null,this.blockZeroSampleRate=!1,this.preAuthUserSamplingId=null,this.updateSamplingSettings=e=>{if(e){this.telemetrySettings=e;let t={};e.samplingRules&&(t=e.samplingRules,this.rulesLookup=t),this.setCohortBoundry(),this.blockZeroSampleRate=e.enableBlockZeroSampleRate}}}initialize(e){e.getObservable(i.J.Telemetry).subscribe(this.updateSamplingSettings),this.telemetrySettings=e.get(i.J.Telemetry),this.updateSamplingSettings(this.telemetrySettings)}static getInstance(){return this.eventSuppressionService||(this.eventSuppressionService=new r),this.eventSuppressionService}setSamplingByUser(e){this.userId||(this.userId=e,this.setCohortBoundry())}setSamplingByPreAuthId(e){this.preAuthUserSamplingId=e,this.setCohortBoundry()}setSamplingByDevice(e){this.deviceId=e,this.setCohortBoundry()}getCurrentCohort(){return this.cohortBoundary}shouldSuppressEvent(e,t="*"){return this.getSampleRate(e,t,"*")===o}getSampleRate(e,t="*",n="*"){const i=this.rulesLookup[e];if(void 0!==i){const e=void 0!==i[`${t}|${n}`]?i[`${t}|${n}`]:void 0!==i[t]?i[t]:void 0!==i[`*|${n}`]?i[`*|${n}`]:void 0!==i["*"]?i["*"]:this.DefaultSampleRate;if(0===e&&this.blockZeroSampleRate)return o;if(this.cohortBoundary!==this.DefaultCohort)return this.cohortBoundary>e?o:e}return this.DefaultSampleRate}setCohortBoundaryByIdType(e,t){return t&&t>o&&t<=this.DefaultSampleRate?void(this.cohortBoundary=t):e}setCohortBoundry(){if(this.cohortBoundary!==this.DefaultCohort)return;let e=null;const t=this.telemetrySettings;!this.userId&&t.enablePreAuthIdSampling?e=this.preAuthUserSamplingId:t.enableDeviceIdSampling?e=this.setCohortBoundaryByIdType(this.deviceId,this.telemetrySettings.deviceIdSampleCohort):t.enableUserIdSamplingV2&&(e=this.setCohortBoundaryByIdType(this.userId,this.telemetrySettings.userIdSampleCohort)),t.enablePreAuthIdSampling||t.enableDeviceIdSampling||t.enableUserIdSamplingV2?e&&(this.cohortBoundary=((0,a.E)(e)%this.FractionalBuckets+1)/this.ConvertToWholeDeviser):this.userId&&(this.cohortBoundary=(0,a.E)(this.userId)%this.WholeNumberBuckets+1)}}},92655:(e,t,n)=>{"use strict";var i;n.d(t,{hy:()=>i}),function(e){e.default="default",e.skypeConCore="conCore"}(i||(i={}))},89812:(e,t,n)=>{"use strict";n.d(t,{G:()=>H});var i,a,o,r=n(13637),s=n(21643),l=n(71503),d=n(79154),c=n(85259),u=null;class m{constructor(){this.key=null,this.value=null,this.pii=null}static _isPii(e){if(e==l.A4.NotSet)return!1;var t=!1;for(var n in l.A4)isNaN(n)||n==e&&(t=!0);return t}}class g{constructor(){this.name=null,this.timestamp=null,this.properties=[],this.eventType=null}setProperty(e,t,n){if(!e||!this.properties[e]&&!g._propertyNameRegex.test(e))throw new p(i.INVALID_PROPERTY_NAME);this.properties[e]={key:e,value:t,pii:n!=l.A4.NotSet?n:null}}unsetProperty(e){if(!e)throw new p(i.INVALID_PROPERTY_NAME);void 0!==this.properties[e]&&(this.properties[e]=void 0,delete this.properties[e])}}g._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$/,function(e){e[e.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN",e[e.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME",e[e.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME",e[e.INVALID_COLLECTOR_URL=4]="INVALID_COLLECTOR_URL",e[e.MISSING_FAILURE_SIGNATURE=5]="MISSING_FAILURE_SIGNATURE",e[e.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL",e[e.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID",e[e.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME",e[e.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE"}(i||(i={}));class p{constructor(e){this.errorCode=null,this.errorCode=e}ErrorCode(){return this.errorCode}toString(){switch(this.errorCode){case i.INVALID_TENANT_TOKEN:return"Invalid tenant token";case i.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty";case i.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$";case i.INVALID_COLLECTOR_URL:return"Collector url can't be null or empty.";case i.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty.";case i.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty.";case i.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty.";case i.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty.";case i.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum.";default:return"Unknown error"}}}class h{constructor(e){this.contextMap=new d.D,this.piiKind=l.A4.NotSet,this._allowDeviceInfoFields=!1,this._allowDeviceInfoFields=e}setAppId(e){e&&this.contextMap.Add("AppInfo.Id",e)}setAppVersion(e){e&&this.contextMap.Add("AppInfo.Version",e)}setAppClientType(e){e&&this.contextMap.Add("AppInfo.ClientType",e)}setAppLanguage(e){e&&this.contextMap.Add("AppInfo.Language",e)}setDeviceId(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.Id",e)}setDeviceOsName(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsName",e)}setDeviceOsVersion(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsVersion",e)}setDeviceBrowserName(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserName",e)}setDeviceBrowserVersion(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserVersion",e)}setUserId(e,t){e&&this.contextMap.Add("UserInfo.Id",e),m._isPii(t)&&(this.piiKind=t)}setUserMsaId(e){e&&this.contextMap.Add("UserInfo.MsaId",e)}setUserANID(e){e&&this.contextMap.Add("UserInfo.ANID",e)}setUserAdvertisingId(e){e&&this.contextMap.Add("UserInfo.AdvertisingId",e)}setUserTimeZone(e){e&&this.contextMap.Add("UserInfo.TimeZone",e)}setUserLanguage(e){e&&this.contextMap.Add("UserInfo.Language",e)}setUserRing(e){e&&this.contextMap.Add("UserInfo.Ring",e)}setUserTenantId(e){e&&this.contextMap.Add("UserInfo.TenantId",e)}}class v{static initialize(e){v.documentInfo=e;var t=e.appLanguage;t&&v.semanticContext.setAppLanguage(t);var n=e.userLanguage;n&&v.semanticContext.setUserLanguage(n);var i=(new Date).getTimezoneOffset(),a=i%60,o=(i-a)/60,r="+";o>0&&(r="-"),a=Math.abs(a);var s=r+((o=Math.abs(o))<10?"0"+o:o.toString())+":"+(a<10?"0"+a:a.toString());v.semanticContext.setUserTimeZone(s),v.semanticContext.setDeviceBrowserName(v._getBrowserName()),v.semanticContext.setDeviceBrowserVersion(v._getBrowserVersion()),v.semanticContext.setDeviceOsName(v._getOsName()),v.semanticContext.setDeviceOsVersion(v._getOsVersion()),v.semanticContext.setDeviceId(e.deviceId),v.firstLaunchTime=e.firstLaunchTime,v.semanticContext.setAppVersion(e.appVersion)}static _getUserAgent(){return v.documentInfo.userAgent}static _userAgentContainsString(e){return v._getUserAgent().indexOf(e)>-1}static _isIe(){return v._userAgentContainsString("Trident")}static _isEdge(){return v._userAgentContainsString(v.BROWSERS.EDGE)}static _isEdgeAnaheim(){return v._userAgentContainsString("Edg/")}static _isOpera(){return v._userAgentContainsString("OPR/")}static _getBrowserName(){return v._isOpera()?v.BROWSERS.UNKNOWN:v._userAgentContainsString(v.BROWSERS.PHANTOMJS)?v.BROWSERS.PHANTOMJS:v._isEdge()?v.BROWSERS.EDGE:v._isEdgeAnaheim()?v.BROWSERS.EDGEANAHEIM:v._userAgentContainsString(v.BROWSERS.ELECTRON)?v.BROWSERS.ELECTRON:v._userAgentContainsString(v.BROWSERS.CHROME)?v.BROWSERS.CHROME:v._userAgentContainsString(v.BROWSERS.FIREFOX)?v.BROWSERS.FIREFOX:v._userAgentContainsString(v.BROWSERS.SAFARI)?v.BROWSERS.SAFARI:v._userAgentContainsString(v.BROWSERS.SKYPE_SHELL)?v.BROWSERS.SKYPE_SHELL:v._isIe()?v.BROWSERS.MSIE:v.BROWSERS.UNKNOWN}static _getBrowserVersion(){return v._isIe()?function(){var e,t=v._getUserAgent(),n=t.match(new RegExp(v.BROWSERS.MSIE+" "+v.REGEX_VERSION));if(n)return n[1];if(e=t.match(new RegExp("rv:"+v.REGEX_VERSION)))return e[1]}():function(e){var t;e===v.BROWSERS.SAFARI?e="Version":e===v.BROWSERS.EDGEANAHEIM&&(e="Edg");if(t=v._getUserAgent().match(new RegExp(e+"/"+v.REGEX_VERSION)))return t[1];return v.UNKNOWN_VERSION}(v._getBrowserName())}static _getOsName(){return v._getUserAgent().match(/windows\sphone\s\d+\.\d+/i)?v.OPERATING_SYSTEMS.WINDOWS_PHONE:v._getUserAgent().match(/ arm;/i)?v.OPERATING_SYSTEMS.WINDOWS_RT:v._getUserAgent().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?v.OPERATING_SYSTEMS.IOS:v._getUserAgent().match(/android/i)?v.OPERATING_SYSTEMS.ANDROID:v._getUserAgent().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i)?v.OPERATING_SYSTEMS.LINUX:v._getUserAgent().match(/(macintosh|mac os x)/i)?v.OPERATING_SYSTEMS.MACOSX:v._getUserAgent().match(/(windows|win32)/i)?v.OPERATING_SYSTEMS.WINDOWS:v.OPERATING_SYSTEMS.UNKNOWN}static _getOsVersion(){return v._getOsName()===v.OPERATING_SYSTEMS.WINDOWS?function(){var e=v._getUserAgent().match(new RegExp("Windows NT "+v.REGEX_VERSION));if(e&&v.VERSION_MAPPINGS[e[1]])return v.VERSION_MAPPINGS[e[1]];return v.UNKNOWN_VERSION}():v._getOsName()===v.OPERATING_SYSTEMS.MACOSX?function(){var e=v._getUserAgent().match(new RegExp(v.OPERATING_SYSTEMS.MACOSX+" "+v.REGEX_VERSION_MAC));if(e){var t=e[1].replace(/_/g,".");if(t){var n=function(e){if(e.indexOf(".")>-1)return".";if(e.indexOf("_")>-1)return"_";return null}(t);return n?t.split(n)[0]:t}}return v.UNKNOWN_VERSION}():v.UNKNOWN_VERSION}}v.semanticContext=new h(!0),v.firstLaunchTime=-1,v.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",EDGEANAHEIM:"EdgeAnaheim",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"},v.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},v.VERSION_MAPPINGS={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},v.REGEX_VERSION="([\\d,.]+)",v.REGEX_VERSION_MAC="([\\d,_,.]+)",v.UNKNOWN_VERSION="Unknown",v.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId",v.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime",function(e){e[e.STARTED=0]="STARTED",e[e.ENDED=1]="ENDED"}(a||(a={}));class S{static initialize(e,t){if(!S._initialized){if(!t)throw new p(i.INVALID_TENANT_TOKEN);S._defaultToken=t,S._config.collectorUrl||(S._config.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/"),u||(u=s.sE.CreateTelemetryManager()).Initialize(S._config),u.Start(),v.initialize(e),S._initialized=!0}}static initializeWithConfiguration(e,t,n){if(!n.collectorUrl)throw new p(i.INVALID_COLLECTOR_URL);S._config.collectorUrl=n.collectorUrl,S.initialize(e,t)}static flush(e){u.Flush(e)}static addCallbackListener(e){S._initialized&&u.AddListener(e)}static setContext(e,t,n){""!==t&&"null"!==t&&"undefined"!==t?S._contextProperties.setProperty(e,t,n):S._contextProperties.unsetProperty(e)}static isInitialized(){return S._initialized}static getDefaultToken(){return S._defaultToken}static getSemanticContext(){return S._semanticContext}static __addTestHookListener(e){S._initialized&&u.__AddTestHookListener(e)}static __clearTestHookListener(){S._initialized&&u.__ClearTestHookListener()}static __backToUninitialized(){S._config=new s.Mk,S._semanticContext=new h(!0),S._contextProperties=new g,u=s.sE.CreateTelemetryManager(),S._initialized=!1}}S._initialized=!1,S._defaultToken=null,S._config=new s.Mk,S._contextProperties=new g,S._semanticContext=new h(!0);class f{constructor(e){this._initId=l.P6.GetGuid(),this._sequence=0,this._tenantToken=null,this._contextProperties=new g,this._semanticContext=new h(!1),this._sessionStartTime=0,this._sessionId=null,this._tenantToken=e||S.getDefaultToken()}logEvent(e){if(!e.name)throw new p(i.MISSING_EVENT_PROPERTIES_NAME);var t=this._createEventRecord(e.name,e.eventType);this._addCustomPropertiesToEvent(t,e),this._sendRecord(t)}logFailure(e,t,n,a,o){if(!e)throw new p(i.MISSING_FAILURE_SIGNATURE);if(!t)throw new p(i.MISSING_FAILURE_DETAIL);var r=this._createEventRecord("failure","failure");r.Extension.Add("Failure.Signature",e),r.Extension.Add("Failure.Detail",t),n&&r.Extension.Add("Failure.Category",n),a&&r.Extension.Add("Failure.Id",a),this._addCustomPropertiesToEvent(r,o),this._sendRecord(r)}logPageView(e,t,n,a,o,r){if(!e)throw new p(i.MISSING_PAGEVIEW_ID);if(!t)throw new p(i.MISSING_PAGEVIEW_NAME);var s=this._createEventRecord("pageview","pageview");s.Extension.Add("PageView.Id",e),s.Extension.Add("PageView.Name",t),n&&s.Extension.Add("PageView.Category",n),a&&s.Extension.Add("PageView.Uri",a),o&&s.Extension.Add("PageView.ReferrerUri",o),this._addCustomPropertiesToEvent(s,r),this._sendRecord(s)}logSession(e,t,n,o){if(e!==a.STARTED&&e!==a.ENDED)throw new p(i.INVALID_SESSION_STATE);var r=this._createEventRecord("session","session");if(e===a.STARTED){if(this._sessionStartTime>0)return;this._sessionStartTime=o||(new Date).getTime(),this._sessionId=n||l.P6.GetGuid(),r.Extension.Add("Session.Id",this._sessionId),r.Extension.Add("Session.State","Started")}else if(e===a.ENDED){if(0==this._sessionStartTime)return;var s=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);r.Extension.Add("Session.Duration",s.toString()),r.Extension.Add("Session.DurationBucket",this._getSessionDurationFromTime(s)),r.Extension.Add("Session.Id",this._sessionId),r.Extension.Add("Session.State","Ended"),this._sessionId=null,this._sessionStartTime=0}r.Extension.Add("Session.FirstLaunchTime",new Date(v.firstLaunchTime).toISOString()),this._addCustomPropertiesToEvent(r,t),this._sendRecord(r)}getSessionId(){return this._sessionId}setContext(e,t,n){this._contextProperties.setProperty(e,t,n)}getSemanticContext(){return this._semanticContext}_getSessionDurationFromTime(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"}_createEventRecord(e,t){var n=new l.WV;t||(t="custom"),n.EventType=e.toLowerCase(),n.Type=t.toLowerCase(),n.Extension.Add("EventInfo.Source","JS_default_source"),n.Extension.Add("EventInfo.InitId",this._initId),this._sequence++,n.Extension.Add("EventInfo.Sequence",this._sequence.toString()),n.Extension.Add("EventInfo.Name",e.toLowerCase());var i=new Date;return n.Timestamp=l.P6.GetTimeStampWithValue(i.getTime()),n.Extension.Add("EventInfo.Time",i.toISOString()),n.Extension.Add("EventInfo.SdkVersion","ACT-Web-JS-"+c.w.version),n}_addCustomPropertiesToEvent(e,t){this._addSemanticContext(e,v.semanticContext),this._addSemanticContext(e,S._semanticContext),this._addSemanticContext(e,this._semanticContext),this._sessionId&&e.Extension.Add("Session.Id",this._sessionId),this._addEventPropertiesToEvent(e,S._contextProperties),this._addEventPropertiesToEvent(e,this._contextProperties),this._addEventPropertiesToEvent(e,t)}_addSemanticContext(e,t){if(t&&t.contextMap.Count()>0)for(var n=t.contextMap.GetBuffer(),i=0;i<n.length;i++)"UserInfo.Id"==n[i].Key&&t.piiKind!=l.A4.NotSet?e.AddOrReplacePII(n[i].Key,n[i].Value,t.piiKind):e.Extension.AddOrReplace(n[i].Key,n[i].Value)}_addEventPropertiesToEvent(e,t){if(t){t.timestamp&&t.timestamp>=new Date("1/1/2000").getTime()&&(e.Timestamp=l.P6.GetTimeStampWithValue(t.timestamp),e.Extension.AddOrReplace("EventInfo.Time",new Date(t.timestamp).toISOString())),t.name&&(e.EventType=t.name.toLowerCase(),e.Extension.AddOrReplace("EventInfo.Name",t.name.toLowerCase()));var n=t.properties;if(n)for(var i in n)n[i].key&&"string"==typeof n[i].key&&(n[i].value||0==n[i].value||0==n[i].value||""==n[i].value)&&(m._isPii(n[i].pii)?(e.AddOrReplacePII(n[i].key,n[i].value.toString(),n[i].pii),e.Extension.Remove(n[i].key)):(e.Extension.AddOrReplace(n[i].key,n[i].value.toString()),e.PIIExtensions.Remove(n[i].key)))}}_sendRecord(e){S.isInitialized()&&u.SendAsync(this._tenantToken,[e])}}!function(e){e.default="default"}(o||(o={}));class y{constructor(){this.messageHandlers={},this.registerMessageHandler("batch",(e=>{for(const t of e)if(t&&t.name){const e=this.messageHandlers[t.name];e&&e(t.params)}this.postMessage("batchDone")}))}registerMessageHandler(e,t){this.messageHandlers[e]?console.warn(`message handler already registered for - ${e}`):this.messageHandlers[e]=t}unregisterMessageHandler(e){delete this.messageHandlers[e]}}class k extends y{constructor(e){super(),this.worker=this.hookUpWebWorker(e)}postMessage(e,t){this.worker.postMessage({name:e,params:t})}hookUpWebWorker(e){return e.onmessage=e=>{const t=e;if(!t||!t.data)return;const n=this.messageHandlers[t.data.name];n&&n(t.data.params)},e}}class C extends y{constructor(e,t){super(),this.sharedWorkerUrl=t,this.worker=this.createSharedWorker(e,this.sharedWorkerUrl)}initialize(){}postMessage(e,t){try{this.worker.port.postMessage({name:e,params:t})}catch(e){console.warn(e)}}createSharedWorker(e,t){const n=t?new SharedWorker(t):e;return n.port.onmessage=e=>{if(!e||!e.data||!e.data.name)return;const t=this.messageHandlers[e.data.name];t&&t(e.data.params)},n}}function b(){return new Worker("/statics/teams-modular-packages/hashed-assets/precompiled-telemetry-web-worker-e83a7bb55179ad56.js")}function T(){return new SharedWorker("/statics/teams-modular-packages/hashed-assets/precompiled-telemetry-shared-worker-cf8efeaa7877fcc6.js")}const w=(e,t)=>class{constructor(n){return new e(t(n))}};class _{constructor(){var e;this.telemetry=s.sE.CreateTelemetryManager(),this.ariaLoggers={},this.statusParams={active:!0,firstPartyLoggerTokens:{},secondPartyLoggerTokens:{}},this.mainContextMap={},e=this.telemetry,u=e}initialize(e){this.initParams=e,this.telemetry.Initialize(e.config),S.initialize(e.documentInfo,e.appTokens.default)}start(){this.telemetry.Start(),this.statusParams.active=!0}stop(){this.telemetry.Stop(),this.statusParams.active=!1}flush(e,t){let n=8;const i=()=>{const t=this.telemetry._eventsCache.IsEmpty(),a=0==--n;t||a?e.postMessage("flushed"):this.telemetry.Flush(i)};i()}flushForReinit(e){let t=8;const n=()=>{const i=this.telemetry._eventsCache.IsEmpty(),a=0==--t;i||a?(e.postMessage("flushedForReinit"),this.stop()):this.telemetry.Flush(n)};n()}createNewLogger(e,t){this.statusParams.firstPartyLoggerTokens[e]=t,this.ariaLoggers[e]=new f(t)}logEvent(e,t){if(!e)return;const n=this.ariaLoggers[e];n&&n.logEvent(t)}logSession(e,t){const n=this.ariaLoggers[t.name];if(!n)return;const i=t.state;n.logSession(i,t.properties,t.sessionId,t.sessionStartTime),e.postMessage("sessionId",{key:t.name,value:n.getSessionId()})}createNewSecondPartyLogger(e,t,n){this.statusParams.secondPartyLoggerTokens[e]=t}logSecondPartyEvent(e,t){}setContext(e){this.mainContextMap[e.key]={value:e.value},S.setContext(e.key,e.value,e.pii)}setUserId(e){S.getSemanticContext().setUserId(e)}setUserTenantId(e){S.getSemanticContext().setUserTenantId(e)}setUserRing(e){S.getSemanticContext().setUserRing(e)}setAppClientType(e){S.getSemanticContext().setAppClientType(e)}setDeviceAuthToken(e){}setPrivacyGuardSensitiveInformation(e){}updateSDKWithPrivacyGuard(e){}logOutUser(e){}setPrimaryUser(e){}}var I=n(46819),A=n(51735),N=n(8380);const E=["admin","Admin","ADMIN","administrator","Administrator","ADMINISTRATOR","automation","Automation","AUTOMATION","client","Client","CLIENT","limited","Limited","LIMITED","office","Office","OFFICE","services","Services","SERVICES","user","User","USER"],D={"appinfo.id":"ext.app.id","appinfo.env":"ext.app.env","appinfo.version":"ext.app.ver","appinfo.versionnew":"ext.app.ver","appinfo.language":"ext.app.locale","userinfo.language":"ext.user.locale","userinfo.timezone":"ext.location.tz","userinfo.id":"ext.user.id","deviceinfo.id":"ext.device.localid","deviceinfo.make":"ext.device.make","deviceinfo.model":"ext.device.model","deviceinfo.networktype":"ext.net.type","deviceinfo.browsername":"ext.web.browser","deviceinfo.browserversion":"ext.web.browserversion"};class F{constructor(){this.oneDsLoggers={},this.contextCallbacks={},this.secondPartyLoggers={},this.oneDsManager=new I.Z,this.sharedConfig={},this.privacyGuardContext={},this.userContextMap={},this.mainContextMap={},this.commonSchemaContextMap={},this.statusParams={active:!0,firstPartyLoggerTokens:{},secondPartyLoggerTokens:{}}}initialize(e){var t;this.initParams=e,this.sharedConfig={instrumentationKey:e.appTokens.default,endpointUrl:e.oneDsCollectorUrl,extensions:[],extensionConfig:[],propertyConfiguration:{populateBrowserInfo:!0,populateOperatingSystemInfo:!0,sessionAsGuid:!0},channelConfiguration:{payloadPreprocessor:e.enableCompression?(e,t)=>{this.gzipPayload(e,t)}:void 0,eventsLimitInMem:e.eventsLimitInMem,autoFlushEventsLimit:e.eventsLimitInMem*e.autoFlushPercent,ignoreMc1Ms0CookieProcessing:!0,enableCompoundKey:!0}},this.privacyGuard=new A.q,this.sharedConfig.extensionConfig||(this.sharedConfig.extensionConfig=[]),this.privacyGuardContext.IgnoredNameParts=E,this.sharedConfig.extensionConfig[null===(t=this.privacyGuard)||void 0===t?void 0:t.identifier]={context:this.privacyGuardContext,iKey:this.initParams.privacyGuardIngestionToken,useEventFieldPrefix:!0,useAbsoluteFieldName:!0},this.oneDsManager.create(this.sharedConfig,[this.privacyGuard]),this.initParams.enablePrivacyGuard&&this._initializePrivacyGuard(),this.contextCallbacks["DeviceInfo.OsVersion"]=this.onOsVersion.bind(this)}updateSDKWithPrivacyGuard(e){e?this._initializePrivacyGuard():this._stopPrivacyGuard()}setPrivacyGuardSensitiveInformation(e){if(this.privacyGuard){const t=e.userNames,n=e.upns;t&&(this.privacyGuardContext.UserNames=t),n&&(this.privacyGuardContext.UserAliases=[],n.forEach((e=>{var t;const n=e.split("@")[0];n&&(null===(t=this.privacyGuardContext.UserAliases)||void 0===t||t.push(n))}))),this.privacyGuard.updateCommonContext(this.privacyGuardContext)}}start(){this.resume()}stop(){this.pause()}pause(){this.oneDsManager.getPostChannel().pause(),this.statusParams.active=!1}resume(){this.oneDsManager.getPostChannel().resume(),this.statusParams.active=!0}setDeviceAuthToken(e){var t;(null===(t=this.initParams)||void 0===t?void 0:t.enableLoggingGlobalDeviceId)&&this.oneDsManager.getPostChannel().setMsaAuthTicket(e)}flush(e,t){this.oneDsManager.getPostChannel().flush(!!t,(()=>{e.postMessage("flushed")}))}flushForReinit(e){this.oneDsManager.getPostChannel().flush(!1,(()=>{e.postMessage("flushedForReinit"),this.pause()}))}createNewLogger(e,t){if(e&&(this.statusParams.firstPartyLoggerTokens[e]=""),e&&t&&this.initParams){const n=this.oneDsManager.newInst(t);if(!n)return;this.oneDsLoggers[e]=n,this.statusParams.firstPartyLoggerTokens[e]=t;const i="MSTeamsFix15SecondsProfile";this.oneDsManager.getPostChannel()._loadTransmitProfiles({[i]:[this.initParams.normalPrioritySendTimeInSecs,this.initParams.highPrioritySendTimeInSecs]}),this.oneDsManager.getPostChannel()._setTransmitProfile(i)}}logEvent(e,t,n){var i;if(!e||!t)return;const a=this.oneDsLoggers[e];if(!a)return;const o=t.properties,r={};for(const e in o)if(Object.prototype.hasOwnProperty.call(o,e)){const t=o[e],n={value:t.value,kind:t.pii};r[e]=n}const s=new Date(t.timestamp).toISOString();if(null===(i=this.initParams)||void 0===i?void 0:i.enableMTMA){const e=!n&&this.primaryUser?this.userContextMap[this.primaryUser]:this.userContextMap[n],i={name:t.name,baseType:t.eventType,time:s,data:Object.assign(Object.assign(Object.assign({},r),this.mainContextMap),e)};a.track(i)}else{const e={name:t.name,baseType:t.eventType,time:s,data:Object.assign(Object.assign({},r),this.mainContextMap)};a.track(e)}}createNewSecondPartyLogger(e,t,n=!1){const i=this.oneDsManager.newInst(t);this.secondPartyLoggers[e]={logger:i,useTeamsContext:n},this.statusParams.secondPartyLoggerTokens[e]=t}logSecondPartyEvent(e,t){if(!e||!t)return;const n=this.secondPartyLoggers[e];n&&(n.useTeamsContext&&(t.data=Object.assign(Object.assign({},t.data),this.commonSchemaContextMap)),n.logger.track(t))}setContext(e){var t;const n={value:e.value};(null===(t=this.initParams)||void 0===t?void 0:t.enableMTMA)?("UserInfo.Id"===e.key&&e.userContextId&&(this.userContextMap[e.userContextId]||(this.userContextMap[e.userContextId]={})),e.userContextId?(this.userContextMap[e.userContextId]||(this.userContextMap[e.userContextId]={}),this.userContextMap[e.userContextId][e.key]=n):this.mainContextMap[e.key]=n,this._setToCommonSchemaPropMap(e.key,n)):(this.mainContextMap[e.key]=n,this._setToCommonSchemaPropMap(e.key,n)),e.key in this.contextCallbacks&&this.contextCallbacks[e.key](e.key,e.value)}setUserId(e){var t;const n="UserInfo.Id",i={value:e,kind:void 0};(null===(t=this.initParams)||void 0===t?void 0:t.enableMTMA)?this.setContext({key:n,value:e,userContextId:e}):(this.mainContextMap[n]=i,this._setToCommonSchemaPropMap(n,i))}logOutUser(e){var t;(null===(t=this.initParams)||void 0===t?void 0:t.enableMTMA)&&(this.userContextMap[e]={})}logSession(e,t){t.sessionId&&this.oneDsManager.getPropertyManager().getPropertiesContext().session.setId(t.sessionId)}setPrimaryUser(e){this.primaryUser||(this.primaryUser=e,this.userContextMap[e]||(this.userContextMap[e]={}))}setUserTenantId(e){}setUserRing(e){}setAppClientType(e){}gzipPayload(e,t){e.data=(0,N.gzip)(e.data),e.urlString+="&content-encoding=gzip",t(e)}_setToCommonSchemaPropMap(e,t){const n=D[e.toLowerCase()];n&&(this.commonSchemaContextMap[n]=t)}_initializePrivacyGuard(){var e;null===(e=this.privacyGuard)||void 0===e||e.setEnabled(!0),this.intervalId||(this.intervalId=setInterval((()=>{var e;null===(e=this.privacyGuard)||void 0===e||e.sendSummaryEvent(!0)}),6e5))}_stopPrivacyGuard(){var e;this.intervalId&&clearInterval(this.intervalId),null===(e=this.privacyGuard)||void 0===e||e.setEnabled(!1)}onOsVersion(e,t){this.oneDsManager.getPropertyManager().getPropertiesContext().os.ver=t}}class P{constructor(){this.enableOneDsSdk=!1,this.existingTransports={},this.secondPartyLoggers={},this.firstPartyLoggers={},this.contextMap={},this.userContextMap={},this.primaryUser=""}initialize(e){if(!e)throw new Error("WebWorkerRouter did not exist.");this.router=e,this._registerMessageHandlers(e)}Verbose(e){this.router&&this.router.postMessage("verbose",e)}Error(e){this.router&&this.router.postMessage("error",e)}Info(e){this.router&&this.router.postMessage("info",e)}_registerMessageHandlers(e){e.registerMessageHandler("initialize",(t=>{this.initTelemetryTransport(t),e.postMessage("workerInitialized")})),e.registerMessageHandler("start",(()=>{var e;null===(e=this.telemetryTransport)||void 0===e||e.start()})),e.registerMessageHandler("stop",(()=>{var e;null===(e=this.telemetryTransport)||void 0===e||e.stop()})),e.registerMessageHandler("flush",(()=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.flush(e)})),e.registerMessageHandler("flushForReinit",(t=>{this.reinitTelemetryTransport(t,e)})),e.registerMessageHandler("newLogger",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.createNewLogger(e.key,e.value),this.firstPartyLoggers[e.key]=e.value})),e.registerMessageHandler("logEvent",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.logEvent(e.key,e.value,e.userContextId)})),e.registerMessageHandler("newSecondPartyOneDsLogger",(e=>{this.createSecondPartyLogger(e.key,e.value.ingestionToken,e.value.useTeamsContext)})),e.registerMessageHandler("setPrimaryUser",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.setPrimaryUser(e.userContextId)})),e.registerMessageHandler("logSecondPartyEvent",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.logSecondPartyEvent(e.key,e.value)})),e.registerMessageHandler("logSession",(t=>{var n;t.sessionId&&(this.contextMap["Session.Id"]=t.sessionId),null===(n=this.telemetryTransport)||void 0===n||n.logSession(e,t)})),e.registerMessageHandler("setUserId",(e=>{var t;this.contextMap["UserInfo.Id"]=e,null===(t=this.telemetryTransport)||void 0===t||t.setUserId(e)})),e.registerMessageHandler("setUserTenantId",(e=>{var t;this.contextMap["UserInfo.TenantId"]=e,null===(t=this.telemetryTransport)||void 0===t||t.setUserTenantId(e)})),e.registerMessageHandler("setUserRing",(e=>{var t;this.contextMap["UserInfo.Ring"]=e,null===(t=this.telemetryTransport)||void 0===t||t.setUserRing(e)})),e.registerMessageHandler("setDeviceAuthToken",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.setDeviceAuthToken(e)})),e.registerMessageHandler("setAppClientType",(e=>{var t;this.contextMap["AppInfo.ClientType"]=e,null===(t=this.telemetryTransport)||void 0===t||t.setAppClientType(e)})),e.registerMessageHandler("setContext",(e=>{var t;this.contextMap[e.key]=e.value,this.enableMTMA?("UserInfo.Id"===e.key&&e.userContextId&&(this.userContextMap[e.userContextId]||(this.userContextMap[e.userContextId]={}),this.primaryUser||(this.primaryUser=e.userContextId)),e.userContextId?(this.userContextMap[e.userContextId]||(this.userContextMap[e.userContextId]={}),this.userContextMap[e.userContextId][e.key]=e.value):this.contextMap[e.key]=e.value):this.contextMap[e.key]=e.value,null===(t=this.telemetryTransport)||void 0===t||t.setContext(e)})),e.registerMessageHandler("setPrivacyGuardUserInfo",(e=>{var t;this.enableOneDsSdk&&(null===(t=this.telemetryTransport)||void 0===t||t.setPrivacyGuardSensitiveInformation(e))})),e.registerMessageHandler("updateSDKWithPrivacyGuard",(e=>{var t;this.enableOneDsSdk&&(null===(t=this.telemetryTransport)||void 0===t||t.updateSDKWithPrivacyGuard(e))})),e.registerMessageHandler("logOutUser",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.logOutUser(e)})),e.registerMessageHandler("pulsarSignal",(e=>(0,r.mG)(this,void 0,void 0,(function*(){if(!this.pulsarSignalProcessor){const{ProcessorFactory:e}=yield n.e(9016).then(n.bind(n,85674));this.pulsarSignalProcessor=e.getInstance().createDefaultProcessor({notify:this.notifyPulsarConsumer.bind(this)})}if(e.span&&e.type)switch(e.type){case"onStart":this.pulsarSignalProcessor.onStart(e.span.name,e.span);break;case"onEnd":this.pulsarSignalProcessor.onEnd(e.span.name,e.span)}}))))}notifyPulsarConsumer(e){var t;null===(t=this.router)||void 0===t||t.postMessage("pulsarSignal",e)}createSecondPartyLogger(e,t,n){var i;this.secondPartyLoggers[e]={token:t,useTeamsContext:n},null===(i=this.telemetryTransport)||void 0===i||i.createNewSecondPartyLogger(e,t,n)}reinitTelemetryTransport(e,t){var n,i,r;null===(n=this.telemetryTransport)||void 0===n||n.flushForReinit(t);const s=e.enableOneDsSdkNs?e.oneDsCollectorUrl||"":e.config.collectorUrl||"",l=this.existingTransports[s];l?l.statusParams.active?this.telemetryTransport=l:(this.telemetryTransport=l,Object.keys(this.firstPartyLoggers).forEach((e=>{var t,n,i;(null===(t=this.telemetryTransport)||void 0===t?void 0:t.statusParams.firstPartyLoggerTokens[e])&&(null===(n=this.telemetryTransport)||void 0===n?void 0:n.statusParams.firstPartyLoggerTokens[e])===this.firstPartyLoggers[e]||null===(i=this.telemetryTransport)||void 0===i||i.createNewLogger(o[e],this.firstPartyLoggers[e])})),Object.keys(this.secondPartyLoggers).forEach((e=>{var t,n,i;(null===(t=this.telemetryTransport)||void 0===t?void 0:t.statusParams.secondPartyLoggerTokens[e])&&(null===(n=this.telemetryTransport)||void 0===n?void 0:n.statusParams.secondPartyLoggerTokens[e])===this.secondPartyLoggers[e].token||null===(i=this.telemetryTransport)||void 0===i||i.createNewSecondPartyLogger(e,this.secondPartyLoggers[e].token,this.secondPartyLoggers[e].useTeamsContext)})),Object.keys(this.contextMap).forEach((e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.setContext({key:e,value:this.contextMap[e]})})),this.telemetryTransport.start()):(this.initTelemetryTransport(e),null===(i=this.telemetryTransport)||void 0===i||i.createNewLogger(e.defaultLoggerName||o.default,e.appTokens.default),null===(r=this.telemetryTransport)||void 0===r||r.logSession(t,{name:e.defaultLoggerName||o.default,state:a.STARTED,sessionId:e.sessionId,sessionStartTime:e.sessionStartTime}),Object.keys(this.firstPartyLoggers).forEach((e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.createNewLogger(o[e],this.firstPartyLoggers[e])})),Object.keys(this.secondPartyLoggers).forEach((e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.createNewSecondPartyLogger(e,this.secondPartyLoggers[e].token,this.secondPartyLoggers[e].useTeamsContext)})),Object.keys(this.contextMap).forEach((e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.setContext({key:e,value:this.contextMap[e]})})))}initTelemetryTransport(e){e.enableDebugTrace?e.config.log=this:e.config.log=void 0,e.enableOneDsSdkNs?(this.enableOneDsSdk=!0,this.telemetryTransport=new F,this.existingTransports[e.oneDsCollectorUrl||"defaultOneDsUrl"]=this.telemetryTransport):(this.telemetryTransport=new _,this.existingTransports[e.config.collectorUrl||"defaultAriaUrl"]=this.telemetryTransport),this.telemetryTransport.initialize(e)}}class M extends y{constructor(){super(),this.telemetryWorker=new P,this.telemetryWorker.initialize(this)}postMessage(e,t){const n=this.messageHandlers[e];n&&n(t)}}var j,R=n(82250);!function(e){e.Desktop="Desktop",e.Messaging="Messaging",e.Files="Files",e.Apps="Apps",e.Activity="Activity",e.Feeds="Feeds",e.Teams="Teams",e.CMD="CMD",e.Notifications="Notifications",e.Foundation="Foundation"}(j||(j={}));const x=new Map;x.set(R.RG.WindowLaunchTime,{featureArea:j.Foundation,customDimensions:["App"]});var O=n(31821),L=n(51581),U=n(54405),B=n(55097);class W{constructor(){this.propagators={}}addCallback(e,t){const n=this.propagators[e];this.propagators[e]=n?Object.assign(Object.assign({},n),{callbacks:[...n.callbacks,t]}):{filters:void 0,usingCache:!1,cache:{},callbacks:[t]};const i=this.propagators[e];if(i){const{cache:e,usingCache:n}=i;n&&Object.keys(e).forEach((n=>{const i=e[n];i&&t(n,i[0],i[1])}))}}updateFilter(e,t,n=!1){const i=this.propagators[e];i?(i.filters=t,i.usingCache=n):this.propagators[e]={filters:t,usingCache:n,cache:{},callbacks:[]}}send(e,t,n){Object.keys(this.propagators).forEach((i=>{var a,o;const r=this.propagators[i];if(r){const s=r.filters;s?s.has(e)&&(r.usingCache&&(r.cache[e]=[t,n]),null===(a=this.propagators[i])||void 0===a||a.callbacks.forEach((i=>i(e,t,n)))):null===(o=this.propagators[i])||void 0===o||o.callbacks.forEach((i=>i(e,t,n)))}}))}}const G="default";class V{constructor(){this._contextPropagator=new W,this._sessionId="",this._silent=!1,this._sharedWorkerOptions={delayLoadingWorker:!1,isSharedWorkerEnabled:!1,isWorkerEnabled:!1},this._cachedOperation=[],this._workerInited=!1,this._capturingEventsForDiagnosticPanel=!1,this._capturingContextForDiagnosticPanel=!1,this._capturedEvents={},this._capturedContext={},this._primaryUserId="",this._primaryTenantId="",this._users=new Set,this.defaultLoggerName=o.default,(0,U.Y)((()=>{this._cachedOperation=[],this._sharedWorkerOptions.sharedWorkerUrl=void 0}))}getUsers(){return this._users}getPrimaryUserId(){return this._primaryUserId}getPrimaryTenantId(){return this._primaryTenantId}get sessionId(){return this._sessionId}startCapturingEventsAndContext(){this._capturingContextForDiagnosticPanel=!0,this._capturingEventsForDiagnosticPanel=!0}stopCapturingEventsAndContext(){this._capturingContextForDiagnosticPanel=!1,this._capturingEventsForDiagnosticPanel=!1}get capturedContext(){return this._capturedContext}get capturedEvents(){return this._capturedEvents}clearCapturedEvents(){this._capturedEvents={[G]:[]}}setCdlContextCallback(e){this._contextPropagator.addCallback("cdl",((t,n,i)=>{var a;e(t,null!==(a=null==n?void 0:n.toString())&&void 0!==a?a:"",i)}))}setMultiContextCallback(e){this._contextPropagator.addCallback("maglev",((t,n,i)=>{var a;e(t,null!==(a=null==n?void 0:n.toString())&&void 0!==a?a:"",i)}))}setEndpointHealth(e){this._getEndpointHealth=e}getEndpointHealth(e,t){var n;return this._getEndpointHealth?null===(n=this._getEndpointHealth(e,t))||void 0===n?void 0:n.isHealthy:void 0}setupReinitSubscriptions(e){var t;if(!this._initializeParams||!e.enableTelemetryRegionReinit)return;let n=!1;e.oneDsCollectorUrl&&this._initializeParams.oneDsCollectorUrl!==e.oneDsCollectorUrl&&(this._initializeParams.oneDsCollectorUrl=e.oneDsCollectorUrl,n=!0),e.telemetryServer&&this._initializeParams.config.collectorUrl!==e.telemetryServer&&(this._initializeParams.config.collectorUrl=e.telemetryServer,n=!0),void 0!==e.enableOneDsSdkNs&&this._initializeParams.enableOneDsSdkNs.toString()!==(null===(t=e.enableOneDsSdkNs)||void 0===t?void 0:t.toString())&&(this._initializeParams.enableOneDsSdkNs=e.enableOneDsSdkNs||!1,n=!0),e.defaultToken&&this._initializeParams.appTokens.default!==e.defaultToken&&(this._initializeParams.appTokens.default=e.defaultToken,n=!0),n&&(this._sendOrCacheOperation("flushForReinit",this._initializeParams),this.logReinitEvent()),void 0!==e.telemetryRegionFetchComplete&&null!==e.telemetryRegionFetchComplete&&this.setContext("telemetryRegionFetchComplete",e.telemetryRegionFetchComplete),e.telemetryRegion&&this.setContext("UserInfo.TelemetryRegion",e.telemetryRegion)}initialize(e,t,n,i,o){var r,s,l,d,c;this._initializeParams=e,this._initializeParams.defaultLoggerName=this.defaultLoggerName,this._silent=e.isSilent,this._sharedWorkerOptions.delayLoadingWorker=null!==(r=e.delayLoadingWorker)&&void 0!==r&&r,this._sharedWorkerOptions.isSharedWorkerEnabled=null!==(s=e.enableSharedWorker)&&void 0!==s&&s,this._capturingEventsForDiagnosticPanel=null===(l=e.debugMenuSettings)||void 0===l?void 0:l.debugMenuCaptureEvents,this._capturingContextForDiagnosticPanel=null===(d=e.debugMenuSettings)||void 0===d?void 0:d.debugMenuCaptureContext,t&&(this._consoleLogger=t,e.config.log=void 0,e.enableDebugTrace=!0);const{workerType:u,workerUrlCallback:m}=i;this.columnSuppressionService=o,this._router="shared"===u||"dedicated"===u?((e,t,n)=>{if(e){const e=SharedWorker;SharedWorker=w(e,t);const i=n?new C(void 0,n):new C(new T);return SharedWorker=e,i}{const e=Worker;Worker=w(e,t);const n=new k(new b);return Worker=e,n}})(!1,m):new M,this._setupWorker(this._router),this._sendOrCacheOperation("newLogger",{key:this.defaultLoggerName,value:e.appTokens.default}),this._sendOrCacheOperation("logSession",{name:this.defaultLoggerName,state:a.STARTED,sessionId:e.sessionId,sessionStartTime:e.sessionStartTime}),this._sendOrCacheOperation("sessionId",e.sessionId),this._router.postMessage("initialize",e);const g=n.get(O.J.Telemetry),p=new Set(null!==(c=g.multiContextColumns)&&void 0!==c?c:[]),h=new Set(g.cdlMultiContextColumns);this._contextPropagator.updateFilter("maglev",p),this._contextPropagator.updateFilter("cdl",h,!0),e.documentInfo.deviceId&&B.H.getInstance().setSamplingByDevice(e.documentInfo.deviceId);n.getObservable(O.J.Telemetry).subscribe((e=>{this._updateSDKwithPrivacyGuard(e),this._updateSecondPartyTelemetryFlag(e),this.setupReinitSubscriptions(e)})),this.setContext("Session.TelemetryWorkerType",u)}createEvent(e,t,n,i,a,o){var r;const s=new g;return s.name=e,s.eventType=t,s.timestamp=Date.now(),s.setProperty("EventInfo.BaseType",t),n&&(this._copyEventProperties(s,n,i),null===(r=this.columnSuppressionService)||void 0===r||r.applyColumnBlockingRules(e,null!=o?o:t,s,a),a&&s.setProperty(a.columnName,(0,L.XC)(a.packedData))),o&&s.setProperty("EventInfo.Identifier",o),s}flush(){return(0,r.mG)(this,void 0,void 0,(function*(){return this._silent?new Promise(((e,t)=>{t()})):new Promise(((e,t)=>{this._router?(this._router.registerMessageHandler("flushed",(()=>{this._router&&this._router.unregisterMessageHandler("flushed"),e()})),this._router.postMessage("flush")):t()}))}))}logEvent(e,t,n=""){this._silent||(this._sendOrCacheOperation("logEvent",{key:e,value:t,userContextId:n}),this._addCapturedEvent(t,n))}initializeSecondPartyLogger(e,t,n=!1){this.enableSecondPartyTelemetry&&this._sendOrCacheOperation("newSecondPartyOneDsLogger",{key:e,value:{ingestionToken:t,useTeamsContext:n}})}logSecondPartyEvent(e,t){this.enableSecondPartyTelemetry&&!this._silent&&this._sendOrCacheOperation("logSecondPartyEvent",{key:e,value:t})}initializeLogger(e,t){this._sendOrCacheOperation("newLogger",{key:e,value:t})}logOutUser(e){e&&(this._sendOrCacheOperation("logOutUser",{userContextId:e}),this._users.delete(e))}setPrimaryUser(e,t){e&&(this._primaryUserId=e,this._primaryTenantId=t,this._users.has(e)||this._users.add(e),this._sendOrCacheOperation("setPrimaryUser",{userContextId:e,userTenantId:t}))}setContext(e,t,n,i){var a;if("UserInfo.Id"===e&&"string"==typeof t&&(B.H.getInstance().setSamplingByUser(t),t&&!this._users.has(t)&&this._users.add(t)),!(null===(a=this.columnSuppressionService)||void 0===a?void 0:a.isContextColumnOk(e)))return;const o=(0,L.XC)(null!=t?t:"");this._sendOrCacheOperation("setContext",{key:e,value:o,pii:n,userContextId:i}),this._addCapturedContext(e,o,i),this._contextPropagator.send(e,t,i)}setPrivacyGuardUserInfo(e,t){this._sendOrCacheOperation("setPrivacyGuardUserInfo",{userNames:e,upns:t})}setDeviceAuthToken(e){this._sendOrCacheOperation("setDeviceAuthToken",e)}start(){this._silent||this._sendOrCacheOperation("start")}stop(){this._silent||this._sendOrCacheOperation("stop")}sendPulsarSignal(e){this._sendOrCacheOperation("pulsarSignal",e)}registerPulsarBackchannelListener(e){var t;null===(t=this._router)||void 0===t||t.registerMessageHandler("pulsarSignal",e)}Verbose(e){this._consoleLogger&&this._consoleLogger.debug(e)}Error(e){this._consoleLogger&&this._consoleLogger.error(e)}Info(e){this._consoleLogger&&this._consoleLogger.debug(e)}_addCapturedEvent(e,t){const n=5e3;this._capturingEventsForDiagnosticPanel&&(t&&!this._capturedEvents[t]?this._capturedEvents[t]=[]:t||this._capturedEvents.default||(this._capturedEvents.default=[]),this._capturedEvents[t||G].unshift(e),this._capturedEvents[t||G].length>=n&&(this._capturedEvents[t||G].length=n-Math.floor(500)))}_addCapturedContext(e,t,n){this._capturingContextForDiagnosticPanel&&e&&(n&&!this._capturedContext[n]?this._capturedContext[n]={}:n||this._capturedContext.default||(this._capturedContext.default={}),this._capturedContext[n||G][e]=t)}_setupWorker(e){return e.registerMessageHandler("sessionId",(e=>{this._sessionId=null==e?void 0:e.value})),e.registerMessageHandler("batchDone",(()=>{this._workerInited=!0})),e.registerMessageHandler("workerInitialized",(()=>{this._cachedOperation.length>0&&this._router&&(this._router.postMessage("batch",this._cachedOperation),this._cachedOperation=[])})),e.registerMessageHandler("error",(e=>{this.Error(e)})),e.registerMessageHandler("info",(e=>{this.Info(e)})),e.registerMessageHandler("verbose",(e=>{this.Verbose(e)})),e}logReinitEvent(){const e="loggingns",t="instrumentation_reinit",n="info",i=B.H.getInstance().getSampleRate(e,t,n);if(i===B.k)return;const a=this.createEvent(e,t,{message:"Triggering logger reinit",sampleRate:i,"EventInfo.Identifier":t,logLevel:n});this.logEvent(o.default,a)}static getInstance(){return this.telemetryProviderInstance||(this.telemetryProviderInstance=new V),this.telemetryProviderInstance}_sendOrCacheOperation(e,t){this._workerInited&&this._router?(this._cachedOperation.length>0&&(this._router.postMessage("batch",this._cachedOperation),this._cachedOperation=[]),this._router.postMessage(e,t)):this._cachedOperation.push({name:e,params:t})}_copyEventProperties(e,t,n){let i=null;for(const n in t)t.hasOwnProperty(n)&&(i=t[n],null!=i&&""!==i&&("object"==typeof i&&i.hasOwnProperty("piiKind")&&i.hasOwnProperty("value")&&i.piiKind in l.A4?e.setProperty(n,(0,L.XC)(i.value),i.piiKind):e.setProperty(n,(0,L.XC)(i))));if(n){const t=x.get(e.eventType);t&&this._copyMonitoringData(e,t,n)}}_copyMonitoringData(e,t,n){const i=[void 0,void 0,void 0],a=t.customDimensions.length;e.setProperty("Scenario.Priority",n.scenarioPriority),n.scenarioErrorCode&&e.setProperty("Scenario.ErrorCode",n.scenarioErrorCode),n.data.forEach((n=>{n.value&&e.setProperty(this._createMonitoringKey(t.featureArea,n.key),n.value);const a=t.customDimensions.findIndex((e=>e===n.key));a>0&&a<3&&(i[a]=n.value)}));let o="";for(let e=0;e<a;e++){const t=void 0===i[e]?"":i[e];o=e===a-1?`${o}${t}`:`${o}${t},`}e.setProperty("CombinedMonitoringDimensions",o)}_createMonitoringKey(e,t){return`QoS.${e}_${t}`}_updateSecondPartyTelemetryFlag(e){this.enableSecondPartyTelemetry=Boolean(e.enableSecondPartyTelemetry)}_updateSDKwithPrivacyGuard(e){var t,n;if(e&&(null===(t=this._initializeParams)||void 0===t?void 0:t.enableOneDsSdkNs)){const t=!!e.enablePrivacyGuard;t!==(null===(n=this._initializeParams)||void 0===n?void 0:n.enablePrivacyGuard)&&(this._initializeParams.enablePrivacyGuard=t,this._sendOrCacheOperation("updateSDKWithPrivacyGuard",t))}}}const H=()=>V.getInstance()},95868:(e,t,n)=>{"use strict";n.d(t,{ip:()=>c,Yx:()=>u,MI:()=>m,P3:()=>g,aA:()=>p});var i=n(89812),a=n(92655),o=n(54405),r=n(21826),s=n(55097),l=n(55997);const d="heartbeat";class c{constructor(){this.initialized=!1,this.eventDecoratorCallbacks=[],this.flush=()=>this.telemetryProvider.flush(),this.telemetryProvider=(0,i.G)(),(0,o.Y)((()=>{this.initialized=!1,this.eventDecoratorCallbacks=[]}))}get sessionId(){return this.telemetryProvider.sessionId}initialize(e,t){this.initialized||(this.consoleLogger=e,this.consoleLogger.debug("TelemetrySender initialized."),this._tablePostfix=t,this.initialized=!0)}static getInstance(){return this.telemetrySender||(this.telemetrySender=new c),this.telemetrySender}registerEventDecorator(e){this.eventDecoratorCallbacks.push(e)}sendTelemetry(e,t,n={},i,o,d,c=""){if(!this.initialized)return;t=t.replace(/\-/g,"_").toLowerCase();const u=`${r.x[e]}${this._tablePostfix}`.toLowerCase(),m=e===r.x.Http?n.resultCode:e===r.x.Endpoint&&n.result&&l.qb[n.result]?l.qb[n.result].toString():e===r.x.Endpoint&&n.hasInnerError?"fail":"success",g=s.H.getInstance().getSampleRate(u,null!=d?d:t,m);if(g===s.k)return;this.decorateEvent(t,n);const p=this.telemetryProvider.createEvent(u,t,n,i,o,d);p.setProperty("sampleRate",g),this.telemetryProvider.logEvent(a.hy.default,p,c)}sendScenarioEvent(e,t,n,i,o,l=""){if(!this.initialized)return;const d=e.replace(/\-/g,"_").toLowerCase(),c=`${r.x[r.x.Scenario]}${this._tablePostfix}`.toLowerCase(),u=s.H.getInstance().getSampleRate(c,d,n["Scenario.Status"]);if(u===s.k)return;this.decorateEvent(d,t);const m=Object.assign(Object.assign({},n),t),g=this.telemetryProvider.createEvent(c,e,m,i,o);g.setProperty("sampleRate",u),this.telemetryProvider.logEvent(a.hy.default,g,l)}sendHeartbeatEvent(e){if(!this.initialized)return;const t=`${r.x[r.x.Heartbeat]}${this._tablePostfix}`.toLowerCase();this.decorateEvent(d,e);const n=this.telemetryProvider.createEvent(t,d,e);this.telemetryProvider.logEvent(a.hy.default,n,void 0)}sendLoggingEvent(e,t,n,i,o,l){if(!this.initialized)return;e=e.replace(/\-/g,"_").toLowerCase();const d=`${r.x[r.x.Logging]}${this._tablePostfix}`.toLowerCase(),c=s.H.getInstance().getSampleRate(d,n,t.logLevel);if(c===s.k)return;this.decorateEvent(e,t);const u=this.telemetryProvider.createEvent(d,e,t,o,l,n);u.setProperty("sampleRate",c),this.telemetryProvider.logEvent(a.hy.default,u,i)}decorateEvent(e,t){this.eventDecoratorCallbacks.forEach((n=>n(e,t)))}}function u(e,t,n,i,a,o=""){c.getInstance().sendScenarioEvent(e,t,n,i,a,o)}function m(e,t,n,i,a,o=""){c.getInstance().sendLoggingEvent(e,t,n,o,i,a)}function g(e,t,n,i,a,o,r=""){c.getInstance().sendTelemetry(e,t,n,i,a,o,r)}function p(e){c.getInstance().sendHeartbeatEvent(e)}},82250:(e,t,n)=>{"use strict";var i;function a(e={},t){return new Proxy(e,{get:(e,n)=>t?n in e?e[n]:t(String(n)):String(n)})}n.d(t,{t7:()=>i,RG:()=>r,ck:()=>s}),function(e){e[e.Expanded=1]="Expanded",e[e.ExpandedAndPacked=2]="ExpandedAndPacked",e[e.Packed=3]="Packed"}(i||(i={}));const o=e=>e.replace(/[A-Z]/g,((e,t)=>0===t?e.toLowerCase():`_${e.toLowerCase()}`)),r=a({FeedListRendered:"feeds_focused_load",FeedListLoadNext:"feeds_focused_load_more",ActivityNameSpaceLoadScenario:"feeds_store_feed_item_namespace_load",GetAppPreviewResult:"ext_get_app_preview_result_appbasedlink",AppBasedLink:"ext_app_based_link",AppBasedLinkChangedTooSoon:"ext_app_based_link_changed_too_soon",HowlingSuppressionUFD:"howling_suppression_ufd",CallHighFidelityMusicModeSetSetting:"call_high_fidelity_music mode_set_setting",CallHighFidelityMusicModeLoadSetting:"call_high_fidelity_music mode_load_setting",CallNSMidCallSetSetting:"call_ns_mid_call_set_setting",CallNSLoadSetting:"call_ns_load_setting",CallNSSetSetting:"call_ns_set_setting",AuthStart:"auth_web_initialization",AuthUserInit:"auth_web_user_initialization",AuthWebSetUpTenants:"auth_web_setup_tenants",GetGoogleAuthCode:"google_auth_get_auth_code",AuthGetUserSubType:"auth_get_user_subtype",AuthWebCachedUser:"auth_web_cacheduser",AuthWebHostCommAuthModule:"auth_web_hostcomm_authmodule",AuthWebMeControlRender:"auth_web_mecontrol_render",BiometricVoiceEnrollment:"voice_enrollment",BiometricFaceEnrollment:"face_enrollment",BreakoutRoomPreMeetingAssignmentTypeDialog:"breakout_rooms_assignment_type_dialog",BreakoutRoomTakeControlAction:"breakout_rooms_take_control",BreakoutRoomsPreMeetingTabLoad:"load_breakout_rooms_tab",CalendarSurfaceLoad:"cal_surface_load",CalNewEventUsingTemplate:"cal_new_event_from_top_bar",AddEntireClass:"lms_integration_course_calendar_add_entire_class",LaunchLmsCourseCalendar:"lms_launch_course_calendar",ChannelCalendarLoad:"cal_channel_calendar_load",ConnectedCalendarDialogLoad:"cal_connected_calendar_dialog_load",ConnectedCalendarSettingDelete:"connected_calendar_settings_delete",CalendarEventsSyncWorflow:"calendar_events_sync_workflow",MultiCalendarEventsSyncWorflow:"multi_calendar_events_sync_workflow",CalendarTeamEventCancelWorkflow:"calendar_team_cancel_workflow",CalendarTeamEventCancelJob:"calendar_team_cancel_job",CalendarBYGCRoutingConsent:"calendar_bygc_routing_consent",MaGetActionItems:"ai_insights_ma_get_action_items",MaGetNotes:"ai_insights_ma_get_notes",MaSendSignalFeedback:"ai_insights_ma_send_signal_feedback",SdsGetActionItems:"ai_insights_sds_get_action_items",SdsEditActionItems:"ai_insights_sds_edit_action_items",SdsAddActionItems:"ai_insights_sds_add_action_items",SdsDeleteActionItems:"ai_insights_sds_delete_action_items",SdsGetNotes:"ai_insights_sds_get_notes",SdsEditNotes:"ai_insights_sds_edit_notes",SdsDeleteNotes:"ai_insights_sds_delete_notes",SdsAddNotes:"ai_insights_sds_add_notes",SdsCreateCollection:"ai_insights_sds_create_collection",SdsCreateCollectionItem:"ai_insights_sds_create_collection_item",SdsUpdateCollectionItem:"ai_insights_sds_update_collection_item",SdsGetCollectionItems:"ai_insights_sds_get_collection_items",SdsGetCollectionItem:"ai_insights_sds_get_collection_item",RosterSubPanelFullRender2:"roster_subpanel_full_render2",VideoEffectsCustomizationPanel:"vide_effects_customization_panel",CallTranscriptPanel:"transcript_panel",CallsAltScenario:"calls_app_launch_time",ExtBotsMessageBack:"ext_bots_messageback",ExtAppDefinitionForMECard:"ext_app_definition_for_me_card",ExtAdaptiveCardHtmlTransformationOnUpdate:"ext_ac_html_transformation_on_update",ExtAdaptiveCardRender:"ext_ac_render",AppProfileCardGetAppDefinition:"ext_app_profile_card_get_app_definition",AppProfileCardStartAudioCall:"ext_app_profile_card_get_start_audio_call",AppProfileCardStartChat:"ext_app_profile_card_get_start_chat",AppProfileCardStartVideoCall:"ext_app_profile_card_get_start_video_call",UseOneOnOneAndDisabledByTenantChecker:"ext_app_profile_card_one_on_one_and_disabled_by_tenant_checker",AppProfileCardSendQuickMessage:"ext_app_profile_card_send_quick_message",UseDisabledByUserChecker:"ext_app_profile_card_use_disabled_by_user_checker",ExtBotsCardO365HttpPOST:"ext_bots_actionable_card_http_post",ExtBotsAdaptiveCardImageExpand:"ext_bots_ac_image_expand",GroupChatsSyncWorkflow:"group_chat_sync_workflow",CentralDataLayerSubscription:"cdl_subscription_agg",CentralDataLayerWaitOnAuthUp:"cdl_wait_on_auth_up",CentralDataLayerBootstrapAuthGetUser:"cdl_bootstrap_auth_get_user",CentralDataLayerRequest:"cdl_request",CentralDataLayerWorkerStartup:"cdl_worker_startup",CentralDataLayerWorkerManagerStartup:"cdl_worker_manager_startup",CentralDataLayerDataStoreCreate:"cdl_data_store_create",CentralDataLayerDataStoreReinitDb:"cdl_data_store_reinit_db",CentralDataLayerDataStoreRemoveAllData:"cdl_data_store_remove_all_data",CentralDataLayerDataStoreRemoveUserData:"cdl_data_store_remove_user_data",MissingNotifications:"gap_detection_missing_notifications",ClearHistoryPruningJob:"clearhistory_pruning_job",ReplyChainSyncJob:"replychain_sync_job",ReplyChainManagerGetReplyChain:"reply_chain_manager_get_single_reply_chain",InMemoryCleanupJob:"inmemory_cleanup_job",OutOfOrderMessages:"gap_detection_out_of_order_messages",MissingMessages:"gap_detection_missing_messages",MessagesGapAboveThreshold:"gap_detection_messages_gap_above_threshold",IndexedDBConnectionClosure:"indexed_db_connection_closure",TPSNotificationEvent:"tps_notification_event",TPSSaveSyncStateToCache:"tps_save_sync_state_to_cache",TPSGetPushUpdates:"tps_get_push_updates",MTMAAggregatorUserDataWrite:"mtma_aggregator_user_data_write",MTMAAggregatorUserDataRead:"mtma_aggregator_user_data_read",CentralDataLayerCoreGraphqlStartup:"cdl_core_graphql_startup",CentralDataLayerLazyStrategyStartup:"cdl_lazy_strategy_startup",ChannelInfoPaneDataLoad:"channel-info-pane-data-load",ChannelInfoPaneDataAllPinnedPostsLoad:"channel-info-pane-data-all-pinned-posts-load",ChannelInfoPaneDataAllSystemMessagesLoad:"channel-info-pane-data-all-system-messages-load",MessageClearCrossPostJob:"message_clear_cross_post_failure_job",AddContactToFavorite:"people_add_contact_to_favorite",GetMeetingArtifacts:"get_meeting_artifacts_artifacts",ReadCollabObject:"read_from_collab_object",ReadCollabObjectBatchRequest:"read_from_collab_object_batch_request",GetMeetingRecommendedArtifacts:"get_meeting_recommended_artifacts_hook",SubmitReportConcernCommunities:"communities_report_concern",CreateCommunityDialog:"communities_create_community_dialog",ComposeAddonsLoadLatency:"compose-addons-load-latency",MTMATenantName:"mtma_tenant_name",EmptyCortexTopic:"cortex_empty_topic_manual_annotation",DiscoverSurfaceFeedsCDLProcessing:"discover_surface_feeds_cdl_processing",DiscoverSurfaceSendFeedbackSignal:"discover_surface_feed_send_feedback_signal",GetStoreEditorialArticlesAppItem:"ext_store_editorial_articles_app_get_item",ViewStoreEditorialArticlesAppItemDetail:"ext_store_editorial_articles_app_view_detail",PlatformAppsFlyoutFetchGridApps:"platform_apps_flyout_grid_apps",PlatformAppFlyoutJITInstallApp:"platform_app_flyout_jit_install_app",ExtMessageExtensionUninstallApp:"ext_me_uninstall_app",ExtSilentInstallPreConsentedApps:"ext_silent_install_preconsented_apps",ExtMessageExtensionPostInstallGetFlyoutApp:"ext_me_post_install_get_flyout_app",ExtMeetingFlyoutPreConsentedApps:"ext_meeting_flyout_silent_install_preconsented_apps",ExtMessageExtensionInstallApp:"ext_me_install_app",ExtAppsUsageGetAppsUsage:"ext_get_apps_usage",ExtMECardAction:"ext_me_card_action",ExtGetFlyoutFilteredME:"ext_get_flyout_filtered_me",ExtMessageExtensionQueryCommand:"ext_me_queryCommand",ExtGetFlyoutFilteredSectionsME:"ext_get_flyout_filtered_sections_me",ExtMessageExtensionGetSections:"ext_me_get_sections",UpgradeApp:"ext_upgrade_app",LaunchAppInstall:"ext_launch_app_install",LaunchAppConfig:"ext_launch_app_config",InstallSideLoadApp:"ext_install_side_load_app",InstallTrustedSideLoadApp:"ext_install_trusted_side_load_app",ExtGetLocation:"ext_location_api_get_location",ExtShowLocation:"ext_location_api_show_location",ExtSelectPeopleContextSearch:"ext_select_people_contextual_search",ExtTaskModuleJITInstall:"ext_task_module_jit_install",ExtMessageExtensionAppInstallation:"ext_me_app_installation",PlatformFetchTabInfo:"platform_fetch_tab_information",ExtMessageExtensionAppOpen:"ext_me_app_open",GetDefaultUrlPreview:"ext_get_default_url_preview_appbasedlink",GetRichUrlPreview:"ext_get_rich_url_preview_appbasedlink",ExtAdaptiveCardActionExecuteSSO:"ext_action_execute_sso",ExtAdaptiveCardActionExecuteOAuth:"ext_action_execute_oauth",ExtAdaptiveCardActionExecuteAuthJIT:"ext_action_execute_authentication_jit",AdaptiveCardsV2ManagerWarmUpAuthBlockUsageMap:"adaptive_cards_v2_manager_warmup_auth_block_usage_map",AppProfileCardInstallApp:"ext_app_profile_card_install_app",DeepLinkToMeetingTabSidePanel:"deeplink_to_meeting_tab_sidepanel",FetchChannelSiteInfoV2:"fetch-channel-site-info-v2",ChooseFileShareMedium:"documents_choose_file_share_medium",QueryItemDetailsService:"documents_query_item_details_service",FetchOneDriveDetails:"documents_fetch_onedrive_details",FetchNativeEntrypointAvailability:"documents_filespolicy_nativeFileEntryPoints",ChooseFileFromOsDialog:"documents_choose_file_from_os",FilesAMSImageUpload:"documents_ams_image_upload",FileUploadChat:"documents_upload_file_chat",FileAttachSuggestionsFetch:"documents_file_attach_suggestions_fetch",UserFileAttach:"documents_user_file_attach",P2PFilesListFetchJob:"documents_p2p_files_list_fetch_job",FileRemoveChat:"documents_remove_file_chat",FileOpenOnline:"documents_action_open_file_online",InsecureFileChiclet:"documents_insecure_file_chiclet",FileInfoValidation:"documents_file_info_validation",FileGetP2PFilesList:"documents_get_p2p_files_list",P2PFilesListFetchWorkflow:"documents_p2p_files_list_fetch_workflow",RefreshSiteUrl:"documents_refresh_site_url_ns",FileRedeem:"documents_file_redeem",FileRedeemByFileId:"documents_file_redeem_file_id",AddFileToMessage:"documents_share_file_message",ChooseFileFromOnedrive:"documents_choose_file_from_onedrive",QueryLegacyVroomService:"documents_query_legacy_vroom_service",FilesCreateShareLink:"documents_create_share_link",FetchPersonalSiteInfo:"documents_fetch_personal_site_info",FetchChannelSiteInfo:"fetch-channel-site-info",FetchThreadSharepointIds:"fetch-thread-sharepoint-ids",FetchOneDriveDetailsFromCDL:"documents_fetch_onedrive_details_from_cdl_v2",CreateFileChiclet:"documents_create_file_chiclet_on_link_paste",AsyncLinkToChiclet:"documents_async_link_to_chiclet",FileUploadChannel:"documents_upload_file_channel",FileRemoveChannel:"documents_remove_file_channel",FileAttachChat:"documents_attach_file_chat",FileAttachChannel:"documents_attach_file_channel",FileChicletDefaultPermission:"documents_share_link_chiclet_default_permission",FileChicletExistingPermission:"documents_share_link_chiclet_existing_permission",FileShareDialogAudience:"documents_share_dialog_audience",FileShareLinkCopyToClipboard:"documents_share_link_copy_to_clipboard",FileSharingCopyLinkDialog:"documents_share_link_copy_dialog",FileSharingPermissionDialog:"documents_share_link_permission_dialog",FileOpenInDesktopApp:"documents_action_open_office_file_app",FileDownload:"documents_action_download_file",FileEditInTeams:"documents_action_edit_file_in_teams",FileOpenSuggestionQuery:"documents_file_open_suggestion_query",FileChangeDefaultAppQuery:"documents_change_default_app_query",FilesAppSwitch:"documents_files_app_switch",RefreshSiteUrlPersonal:"documents_refresh_site_url_personal_ns",FilesRenderExternalProviders:"render_files_external_providers",FilesRenderExternalProviderContent:"render_files_external_provider_content",FileOneUpViewer:"file_oneup_viewer",BootStrapFloodgate:"bootstrap_floodgate",FlyoutStartWebcam:"flyout-start-webcam",FlyoutStopWebcam:"flyout-stop-webcam",WindowVisibilityRegistration:"flyout-register-visibility-handler",unregisterVisibilityScenario:"flyout-unregister-visibility-hander",GetMeetingLink:"flyout-get-link-l1",GetMeetingObjects:"flyout-get-meeting-objects",StartMeetingFromLink:"flyout-start-meeting-from-link",ToggleWebcam:"flyout-toggle-webcam",StartCallWithUsers:"flyout-L2-start-call",startMeetingAndSendLink:"flyout-callingL2-send-link",flyoutVisibilityChangedHandler:"flyout-visiblity-changed-handler",TFLConsentLaunch:"consent_launch",QueryExecution:"query_exec",GlobalErrorPage:"global_error_page_display",UnhandledRejection:"unhandled_rejection_error",GroupTemplateCTARendered:"group_template_cta_rendered",GroupTemplateInfoPaneFiles:"group_template_infopane_files",MessageMeetingChicletJoinMeeting:"msg_meeting_chiclet_join_meeting",MessageMeetingChicletAddToMyCalendar:"msg_meeting_chiclet_add_to_my_calendar",MessageMeetingChicletImportCalendarEvent:"msg_meeting_chiclet_import_calendar_event",MessageMeetingChicletImportGoogleCalendarEvent:"msg_meeting_chiclet_import_bygc_calendar_event",MessageMeetingChicletDeleteFromCalendar:"msg_meeting_chiclet_delete_from_calendar",MessageMeetingChicletAcceptRsvp:"msg_meeting_chiclet_accept_rsvp",MessageMeetingChicletViewEventDetails:"msg_meeting_chiclet_view_event_details",MeetingInviteOffNetworkPhone:"invite_offnetwork_phone_to_meeting",MeetingChatInviteOffNetworkPhone:"invite_offnetwork_phone_to_meetingchat",ChatInfoPaneOpen:"chat_infopane_open",ChatInfoPaneMedia:"chat_infopane_media",ChatInfoPaneFiles:"chat_infopane_files",ChatInfoPaneTabs:"chat_infopane_tabs",NoopScenario:"noop",AppLogout:"authenticationService_appLogout",IndexedDBDelete:"indexed_db_delete",IndexedDBFetch:"indexed_db_fetch",IndexedDBWrite:"indexed_db_write",ContactsSyncPopoutOpened:"contacts_sync_popout",RenderCallingPreJoin:"render_calling_prejoin",GetPost:"csa_get_post",GetRepliesInChain:"csa_get_replies_in_chain",GetPostAuthorMris:"csa_get_post_authors",FilePreviewLayoutToJsApiScriptLoad:"file_preview_layout_to_jsapi_script_load",JsApiScriptLoad:"jsapi_script_load",JsApiFirstStep:"jsapi_first_step",JsApiSecondStep:"jsapi_second_step",RoomRemoteMeetingRoomSendCommandLeaveMeeting:"room_remote_meeting_room_send_command_leaveMeeting",OfflineCacheStorageImageUpload:"ocm_image_upload",OnDemandTranslation:"on_demand_translate_message",DetectLanguagePrompt:"show_switch_language_prompt",ATPGetPolicy:"atp_get_policy",ATPGetPolicyTask:"atp_get_policy_task",ATPGetUrlReputation:"atp_get_url_reputation",CreateWiki:"wikiv2_create_wiki",LoadWiki:"wikiv2_load_wiki",DeleteWiki:"wikiv2_delete_wiki",SavePageTitleWiki:"wikiv2_save_page_title",LockSectionWiki:"wikiv2_lock_section",SaveSectionWiki:"wikiv2_save_section",AddPageWiki:"wikiv2_add_page",DeletePageWiki:"wikiv2_delete_page",MovePageWiki:"wikiv2_move_page",MoveSectionWiki:"wikiv2_move_section",DeleteSectionWiki:"wikiv2_delete_section",ForceUnlockWiki:"wikiv2_force_unlock",AddSectionWiki:"wikiv2_add_section",DiscardSectionWiki:"wikiv2_discard_section",LoadPageWiki:"wikiv2_load_page",FocusSectionWiki:"wikiv2_focus_section",LoadPagesForSidebarWiki:"wikiv2_load_pages_for_sidebar",LoadPageWithoutSectionWiki:"wikiv2_load_page_without_section",LoadSectionWiki:"wikiv2_load_section",NoOpSyncJob:"noop_sync_job",AddMembersToThreadJob:"AddMembersToThreadJob",BuddyListAddWorkflow:"buddylist_add_workflow",GetTeamsChannelsFromIndexedDB:"get_teams_channels_from_indexeddb",StoTaskModuleDeleteDraft:"sto_delete_email",ExtMessageExtensionAuthAndConfig:"ext_me_authAndConfig",ExtPinOrUnpinMessageExtension:"ext_pin_or_unpin_message_extensions",ExtBotsCardExecute:"ext_bots_execute",ExtBotsPinAsTab:"ext_bots_pinAsTab",ExtBotsCardMessageUpdate:"ext_bots_update_mediacard",ExtBotsJITInstall:"ext_bots_jit_install",ExtTflAdaptiveCardAction:"ext_tfl_ac_action",ExtAdaptiveCardTabAuth:"ext_act_authAndConfig",ExtInstalledAppsV2:"ext_installed_apps_V2",ExtInstalledAppsUpdateEventV2Success:"ext_installed_apps_update_event_V2_success",ExtInstalledAppsUpdateEventV2Failure:"ext_installed_apps_update_event_V2_failure",STTOutlookAddInNavigation:"stt_outlook_add_in_navigation",STTOutlookAddInStartup:"stt_outlook_add_in_startup",STTOutlookAuthStrap:"stt_outlook_auth_strap",STTOutlookPopulateUsage:"stt_outlook_populate_usage",STTRecentChannels:"stt_recent_channels",STTRecentChats:"stt_recent_chats",STTRecentRecipients:"stt_recent_recipients",STTOutlookZeroStateSuggestions:"stt_outlook_zero_state_suggestions",ChangeRoleRender:"change_role_latency",OpenShareInviteDialog:"openShareInviteDialog",SendMeetingReaction:"meeting_reactions_send_reaction",GetUpgradePolicyFromUserProfileOrDefault:"load_loggedin_user_policy_from_userprofile_or_default",InstallAppMessageExtensionJit:"ext_install_app_message_ext_jit",LaunchLmsCourseTeam:"lms_launch_course_team",GetTeamsForCourse:"lms_get_teams_for_course",LmsLaunchSchedulingFormCreate:"lms_integration_launch_scheduling_form_create",AppBasedLinkAuthOrConfig:"ext_do_auth_or_config_appbasedlink",AppBasedLinkAadAuth:"ext_do_aad_auth_appbasedlink",RemoveUrlPreview:"ext_remove_url_preview",FetchDynamicCommands:"ext_fetch_dynamic_commands",Unified3SSearch:"unified_3s_search",UnifiedChannelSearch:"channel_search",UnifiedChatsByTitleSearch:"chats_by_title_search",UnifiedChatsByMembersSearch:"chats_by_members_search",UnifiedPeopleSearch:"people_search",TeamSettingsTabLoad:"teamdashboard_settingstab_load",GetOfficeStoreAppDetails:"app_details_get_office_store_app_details",StartScenarioStepSuffix:"_start",PersistDataInIndexdb:"persist_data_in_indexed_db",STTOutlookAtMention:"stt_outlook_at_mention",STTOutlookMWAtMention:"stt_outlook_mw_at_mention",STTAtMention:"stt_at_mention",RemoveMemberFailure:"remove_member_failure_due_to_chat_permissions",LeaveChatFailure:"leave_chat_failure_due_to_chat_permissions",LpcGetPersonaInfo:"lpc_persona_data_callback",LpcGetPersonaInfoSC:"lpc_persona_data_callback_sc",LpcGetHeaderInfo:"lpc_header_info_data_callback",LpcGetHeaderInfoSC:"lpc_header_info_data_callback_sc",LpcGetHeaderActionsPolicy:"lpc_header_actions_data_callback",LpcGetRichPresence:"lpc_rich_presence_data_callback",LpcGetImageUri:"lpc_image_data_callback",LpcGetImageUriSC:"lpc_image_data_callback_sc",SwCleanupSwCache:"sw_cleanup_cache",AppInstallationDialogGetAppDefinition:"app_installation_dialog_getappdefinition",AppIntallationDialogInstallApp:"app_installation_dialog_installapp",ChatRosterRendered:"chat_roster_rendered_mw",AdaptiveCardsV2ManagerPopulateUserSpecificContent:"adaptive_cards_v2_manager_populate_userSpecific_content",GetUserInfo:"use_user_container_get_user_info",UnPinChannel:"unpin_channel",FRELogOutError:"fre_auth_signout_failure",FREFetchProfileError:"fetch_ephemeral_profile_failure",SCISFilesRecommendations:"scis_files_recommendations",GetLoBNotificationItem:"ext_lob_notifications_get_item",ViewLoBNotificationItemDetail:"ext_lob_notifications_view_detail",LpcGetPersonaProfiles:"lpc_persona_profiles_data_callback",LinkedInRender:"linkedin_render",ShowInMeetingReportToggled:"toggle_show_in_meeting_report_enbaled",CommitCollabNote:"commit_collab_notes",MeetingPropertiesFromCallFluidContext:"get_meeting_properties_from_call",MrGet3SRRecommendations:"mr_get_3sr_recommendations",MeetAppCreateMeetingLink:"meet_app_create_meeting_link_event",MeetAppScheduleMeetingCreateSSEvent:"meet_app_schedule_meeting_create_ss_event",MeetAppRenderSpeedDialList:"meet_app_render_speeddial_list",getDeepLinkedTranscript:"get_deepLinked_transcript",hasTranscriptMW:"has_transcript_MW",getDeepLinkedTranscriptMW:"get_deepLinked_transcript_MW",RaiseHandE2eLatency:"raise_hand_received_e2e_latency",UnmutedWithPushToTalk:"push_to_talk_scenario",RemoteMuteRender:"server_mute_latency",PlatformTabSdkGetAppContentStageSharingState:"platform_tab_get_app_content_stage_sharing_state",PlatformTabSdkRaiseHandStateChangedSubscription:"platform_tab_raise_hand_state_changed_subscription",PlatformTabSdkMeetingReactionReceivedSubscription:"platform_tab_meeting_reaction_received_subscription",DeepLinkShareAppToStage:"deeplink_share_app_to_stage",ReactionsOverlayScreen:"meeting_reactions_overlay",StageContentPopout:"stage_content_pop_out",ShowMeetingBrandingLogo:"meeting_branding_show_logo",SendSmartReplyMessage:"chat_send_sr_message",SendSmartRepliesFeedback:"send_sr_feedback",DeleteChat:"messaging_delete_chat",ATPFastSharepointSafelinksClick:"atp_fast_sharepoint_safelinks_click",DeleteMessage:"messaging_delete_message",AdminDeleteMessage:"messaging_admin_delete_message",UndeleteMessage:"messaging_undo_delete",DeleteMessageSaveId:"messaging_delete_message_save_current_session",DeletionInfoUpdate:"messaging_deletion_info_update",ReadReceiptsEnabledToggled:"toggle_read_receipts_enbaled",AckUrgentMessage:"messaging_ack_urgent_message",UpToEditBegin:"messaging_up_to_edit_message",VirtualListInitialStableView:"vl_initial_stable_view",VirtualListLoadMore:"vl_load_more",VirtualListNewRenderBounds:"vl_new_render_bounds",VirtualListScrollToStart:"vl_scroll_to_start",P2PSendNewMessageSfB:"chat_send_message_sfb",P2PSendNewMessageSfC:"chat_send_message_sfc",P2PSendNewMessageFederated:"chat_send_message_federated",P2PSendNewMessageNativeFederated:"chat_send_message_nativefederated",P2PSendNewMessageTfw:"chat_send_message_tfw",P2PSendNewMessageTfl:"chat_send_message_tfl",MessageReactionUpdate:"messaging_update_message_reaction",MessageReactionAdd:"messaging_add_message_reaction",MessageReactionRemove:"messaging_remove_message_reaction",ReplyChainManagerGetPreviousAndNextMessagesForChat:"reply_chain_manager_get_previous_next_messages_for_chat",ReportConcernTFW:"report_concern_TFW",ReportConcernTFL:"report_concern_TFL",MTMAAggregatorMissedNotificationsData:"mtma_aggregator_missed_notifications_data",MTMAAggregatorMissedNotificationsDataWriteToCache:"mtma_aggregator_missed_notifications_data_write_to_cache",MTMAAggregatorMissedNotificationsDataReadFromCache:"mtma_aggregator_missed_notifications_data_read_from_cache",notificationBadgeMounter:"notifications_badge_mounter",notificationDropdownRender:"notifications_dropdown_render",missedMTMANotificationsRefetchAuthQuery:"missed_mtma_notifications_refetch_auth_query",ConversationsReminderCDLWorkflow:"conversations_reminder_manager_CDL_workflow",ConversationsReminderSubscriptionJob:"conversations_reminder_manager_subscription_job",GetOnboardingNotificationItem:"ext_onboarding_notifications_get_item",ViewOnboardingNotificationItemDetail:"ext_onboarding_notifications_view_detail",OsFileShare:"OsFileShare",P2PFilesListSwitch:"documents_p2p_files_list_switch",P2PFilesListAllFiles:"documents_p2p_files_list_allfiles",P2PFilesListAllFilesFast:"documents_p2p_files_list_allfiles_fast",RemoveParticipantRender:"remove_participant_latency",ReportMisrecognizedParticipantRender:"report_misrecognized_participant_latency",NudgeParticipantRender:"nudge_participant_latency",MembersTabSearchFetchTags:"people_targeting_members_tab_search_fetch_tags",MembersTabFetchTags:"people_targeting_members_tab_fetch_tags",ManageTagsFetchTags:"people_targeting_manage_tags_fetch_tags",ManageTagsFetchDeletedTags:"people_targeting_manage_tags_fetch_deleted_tags",ManageTagsCreateTag:"people_targeting_manage_tags_create_tag",ManageTagsUpdateTag:"people_targeting_manage_tags_update_tag",ManageTagsAddTagMember:"people_targeting_manage_tags_add_tag_member",ManageTagsRemoveTagMember:"people_targeting_manage_tags_remove_tag_member",ManageTagsRestoreTag:"people_targeting_manage_tags_restore_tag",ManageTagsDeleteTag:"people_targeting_manage_tags_delete_tag",ManageTagsStartChatWithTag:"people_targeting_manage_tags_start_chat_with_tag",ManageTagsGetTagDetails:"people_targeting_manage_tags_get_tag_details",ManageTagsGetTeamTagSettings:"people_targeting_manage_tags_get_team_tag_settings",PeoplePickerTagInitialization:"people_targeting_people_picker_tag_initialization",PeoplePickerGetDLMembers:"people_targeting_people_picker_get_dl_members",PeoplePickerAadDomain:"people_picker_aad_domain_lookup",PeoplePickerCustomProvider:"people_picker_load_results_custom_provider",PeoplePickerPeopleCacheSearch:"people_picker_search_people_cache",PeoplePickerRawContactsCacheSearch:"people_picker_search_raw_contacts_cache",PeoplePickerMfuContactsCacheSearch:"people_picker_search_mfu_contacts_cache",PeoplePickerGroupChatSearch:"people_picker_search_group_chats",PeoplePicker3SSearch:"people_picker_3s_search",PeoplePicker3SFallbackSearch:"people_picker_3s_fallback_search",PeoplePickerPeopleTFLZeroState:"people_picker_people_tfl_zero_state",PeoplePickerMfuContactsSearchTFLZeroState:"people_picker_mfu_tfl_zero_state",TFLZeroStateSuggestions:"tfl_zero_state_suggestions",PeoplePickerCache:"people_picker_load_results_clientonly",PeoplePickerPstnAssignmentRemote:"people_picker_pstn_resolve_user_remote",PeoplePickerRemote:"people_picker_load_results",PeoplePickerIDB:"people_picker_indexeddb",PeoplePicker3S:"people_picker_3s",PeoplePickerInstantScd:"people_picker_load_results_scd",PeoplePickerTFLSms:"people_picker_load_results_sms",PeoplePickerOffNetwork:"people_picker_load_results_off_network",PeoplePickerXTap:"people_picker_load_results_xTap",PeoplePickerAAD:"people_picker_aad",SharedChannelProfileFetchMultiple:"shared_channel_batch_profile_fetch",TFLClientProfileFetchJob:"tfl_client_profile_fetch_job",TFLConsumerProfileFetchJob:"tfl_consumer_profile_fetch_job",ExternalSearchJob:"people_picker_external_search_job",ContactsSyncSuggestedRawContacts:"contacts_sync_suggested_rawContacts",AtMentionsPostResult:"people_at_mentions_post_result",EmptyAtMentions:"people_empty_at_mentions",AtMentions:"people_at_mentions",BuddyListSyncJob:"buddylist_sync_job",EditAvatar:"edit_avtar",MSASearchability:"msa_searchability",MSAAliasVisibility:"msa_alias_visibility",ProfileFetchSingle:"single_profile_fetch",BuddyListSyncWorkflow:"buddylist_sync_workflow",ProfileFetchMultiple:"multiple_profile_fetch",BuddyListAddMemberToGroup:"buddylist_add_member_to_group",ProfileFetchMultipleConversation:"multiple_profile_fetch_conversation",BuddyListGetBlockedContacts:"people_get_blocked_contacts",ProfileFetchME:"me_profile_fetch",BuddyListUpdateBlockedContacts:"people_update_blocked_contacts",ContactsSyncSUggestedContactsSubscription:"contacts_sync_suggested_contacts_subscription",ContactsSyncSettingsCleanUp:"contacts_sync_settings_cleanup",AcceptBlockMSAUser:"block-unblock-msa-user",AcceptBlockSfCChat:"accept-block-sfc-chat",ExtendedDirectoryOnly:"extended-directory-only-fetch",PostALT:"post_application_launch_time",AddAppDialogFetchAppDefinition:"ext_add_app_dialog_fetch_app_definition",AddAppDialogFetchTeamsOrChats:"ext_add_app_dialog_fetch_teams_or_chats",AddAppDialogFetchDiscoverMoreAppsData:"ext_add_app_dialog_fetch_discover_more_apps_data",AddAppDialogFetchAppStoreRating:"ext_add_app_dialog_fetch_app_store_rating",AddAppDialogGetInstallOptions:"ext_add_app_dialog_get_install_options",AddAppDialogFetchAdminAppRequestConfig:"ext_add_app_dialog_fetch_admin_app_request_config",AddAppDialogInstall:"ext_add_app_dialog_install",AddAppDialogUpgrade:"ext_add_app_dialog_upgrade",AddAppDialogRequestAccess:"ext_add_app_dialog_request_access",AddAppDialogPostInstall:"ext_add_app_dialog_post_install",AddAppDialogPopulateContent:"ext_add_app_dialog_populate_content",AddAppDialogShareAppDeepLink:"ext_add_app_dialog_share_app_deep_link",InstallApp:"ext_install_app",InstallAppResultCacheUpdate:"ext_install_app_result_cache_update",AppsPlatformServiceGetInstalledApps:"ext_apps_platform_service_get_installed_apps",AppsPlatformServiceGetInstalledApp:"ext_apps_platform_service_get_installed_app",ExtractAppDefinitionJob:"ext_extract_app_definition_job",TenantStagedAppsSyncJob:"ext_tenant_staged_apps_sync_job",TenantStagedAppsDeleteJob:"ext_tenant_staged_apps_delete_job",TenantStagedAppsSyncWorkflow:"ext_tenant_staged_apps_sync_workflow",TenantStagedAppsDeleteWorkflow:"ext_tenant_staged_apps_delete_workflow",TenantStagedAppsManagerSyncTenantStagedApps:"ext_tenant_staged_apps_manager_sync_staged_apps",TenantStagedAppsManagerDeleteTenantStagedApp:"ext_tenant_staged_apps_manager_delete_staged_app",TenantStagedAppsManagerGetTenantStagedApps:"ext_tenant_staged_apps_manager_get_staged_apps",GetUserInstalledAppsJob:"ext_get_user_installed_apps_job",GetChatInstalledAppsJob:"ext_get_chat_installed_apps_job",GetAggregatedAppEntitlementsSyncJob:"ext_get_aggregated_app_entitlements_sync_job",TeamInstalledAppsManagerGetFavTeamIdsWithNoCache:"team_installed_apps_manager_get_fav_teamIds_with_no_cache",AppDefinitionsManagerGetAppDefinitionsForAppIds:"app_definitions_manager_get_app_definitions_for_appIds",GetAppDefinitionsJob:"ext_get_app_definitions_job",GetBatchAppDefinitionsJob:"ext_get_batch_app_definitions_job",InstallUserAppJob:"ext_install_user_app_job",InstallAppJob:"ext_install_app_job",InstallChatAppJob:"ext_install_chat_app_job",DeleteAppJob:"ext_delete_app_job",AppsPlatformServiceGetAppDefinition:"ext_apps_platform_service_get_app_definition",AppsPlatformServiceGetBatchAppDefinition:"ext_apps_platform_service_get_batch_app_definition",AppsPlatformServiceInstallApp:"ext_apps_platform_service_install_app",AppsPlatformServiceUpgradeApp:"ext_apps_platform_service_upgrade_app",AppsPlatformServiceCreateAppEntitlement:"ext_apps_platform_service_create_app_entitlement",AppsPlatformServiceReadAppDefinitions:"ext_apps_platform_service_read_app_definitions",AppsPlatformServiceReadAppEntitlements:"ext_apps_platform_service_read_app_entitlements",AppsPlatformServiceWriteAppDefinitions:"ext_apps_platform_service_write_app_definitions",AppsPlatformServiceWriteAppEntitlements:"ext_apps_platform_service_write_app_entitlements",AppsPlatformServiceResetAppEntitlementCache:"ext_apps_platform_service_reset_app_entitlement_cache",AppsPlatformServiceCheckAppDefinitionsCacheExpiration:"ext_apps_platform_service_check_app_definitions_cache_expiration",AppsPlatformServiceCheckAppEntitlementsCacheExpiration:"ext_apps_platform_service_check_app_entitlements_cache_expiration",ExtGetAppImpression:"ext_get_app_impressions",UpdateAllPlatformAppsFetchPolicies:"ext_apps_update_all_fetch_policies",GetTeamInstalledAppDefinitionFromCache:"ext_get_installed_app_definition_from_teams_manager_cache",GetChatInstalledAppDefinitionFromCache:"ext_get_installed_app_definition_from_chat_manager_cache",GetUserInstalledAppDefinitionFromCache:"ext_get_installed_app_definition_from_user_manager_cache",UserInstalledAppsManagerGetInstalledAppsForAppBar:"ext_user_installed_apps_manager_get_installed_apps_for_appBar",StoreServiceGetCollections:"ext_store_service_get_collections",StoreServiceGetItems:"ext_store_service_get_items",StoreServiceGetHeroItems:"ext_store_service_get_hero_items",StoreServiceQueryItems:"ext_store_service_query_items",StoreServiceQueryExtItems:"ext_store_service_query_ext_items",StoreServiceSuggestItems:"ext_store_service_suggest_items",StoreServiceContentRequest:"ext_store_service_content_request",StoreServiceArticleContentRequest:"ext_store_service_article_content_request",StoreServiceAppsRestore:"ext_store_service_apps_restore",StoreServiceAppsUpdateStartupCategories:"ext_store_service_apps_update_startup_categories",StoreServiceAppCategoriesDictionaryRequest:"ext_store_service_app_categories_dictionary_request",StoreServiceBatchedDefinitionsRequest:"ext_store_service_batched_definitions_request",StoreServiceGetCollectionsCache:"ext_store_service_get_collections_cache",StoreServiceInitTemplates:"ext_store_service_init_templates",StoreServiceTemplatedAppsRequest:"ext_store_service_templated_apps_request",StoreServiceGetTemplatedAppItems:"ext_store_service_get_templated_app_items",StoreServiceGetMoreTemplatedAppItems:"ext_store_service_get_more_templated_app_items",StoreServiceRefreshTemplatedAppItems:"ext_store_service_refresh_templated_app_items",StoreServiceCacheManagerGet:"ext_store_service_cache_manager_get",StoreServiceCacheManagerGetMultiple:"ext_store_service_cache_manager_get_multiple",StoreServiceLaunchFailuresCheck:"ext_store_service_launch_failures_check",StoreEntry:"ext_store_entry",StoreSwitchFeed:"ext_store_switch_feed",StoreSwitchCollection:"ext_store_switch_collection",StoreSwitchSearch:"ext_store_switch_search",StoreSwitchManageApps:"ext_store_switch_manage_apps",StoreSwitchArticle:"ext_store_switch_article",StoreCollectionLoadMore:"ext_store_collection_load_more",ManageAppsUninstall:"ext_manage_apps_uninstall",StoreFREDialogDisplay:"store_fre_dialog_display",InContextStoreDialogFetchInstalledAppsInScope:"ext_in_context_store_dialog_fetch_installed_apps",InContextStoreDialogCheckIfUserIsAllowedToInstall:"ext_in_context_store_dialog_check_if_user_is_allowed_to_install",InContextStoreDialogPostInstall:"ext_in_context_store_dialog_post_install",InContextStoreDialogPopulateFeedCollectionContent:"ext_in_context_store_dialog_populate_feed_collection_content",InContextStoreDialogPopulateSearchCollectionContent:"ext_in_context_store_dialog_populate_search_collection_content",InContextStoreDialogPopulateAppsGridContent:"ext_in_context_store_dialog_populate_apps_grid_content",PlatformHubSdkApiNotifyFailure:"platform_tab_hub_sdk_authentication_notify_failure",PlatformHubSdkApiNotifySuccess:"platform_hub_sdk_api_authentication_notify_success",PlatformHubSdkApiOpenConversation:"platform_hub_sdk_api_chat_open_conversation",PlatformHubSdkApiCloseConversation:"platform_hub_sdk_api_chat_close_conversation",PlatformHubSdkApiGetChatMembers:"platform_hub_sdk_api_chat_get_chat_members",PlatformHubSdkApiExecuteDeepLink:"platform_hub_sdk_api_deepLinks_execute_deep_link",PlatformHubSdkApiShareDeepLink:"platform_hub_sdk_api_deepLinks_share_deep_link",PlatformHubSdkApiGetLocation:"platform_hub_sdk_api_location_get_location",PlatformHubSdkApiShowLocation:"platform_hub_sdk_api_location_show_location",PlatformHubSdkApiGetMedia:"platform_hub_sdk_api_media_get_media",PlatformHubSdkApiSelectMedia:"platform_hub_sdk_api_media_select_media",PlatformHubSdkApiViewImages:"platform_hub_sdk_api_media_view_images",PlatformHubSdkApiGetAuthenticationTokenForAnonymousUser:"platform_hub_sdk_api_meeting_get_authentication_token_for_anonymous_user",PlatformHubSdkApiGetIncomingClientAudioState:"platform_hub_sdk_api_meeting_get_incoming_client_audio_state",PlatformHubSdkApiGetMeetingDetails:"platform_hub_sdk_api_meeting_get_meeting_details",PlatformHubSdkApiToggleIncomingClientAudio:"platform_hub_sdk_api_meeting_toggle_incoming_client_audio",PlatformHubSdkApiGetAppContentStageSharingCapabilities:"platform_hub_sdk_api_meeting_get_app_content_stage_sharing_capabilities",PlatformHubSdkApiGetAppContentStageSharingState:"platform_hub_sdk_api_meeting_get_app_content_stage_sharing_state",PlatformHubSdkApiGetLiveStreamState:"platform_hub_sdk_api_meeting_get_live_stream_state",PlatformHubSdkApiRequestStartLiveStreaming:"platform_hub_sdk_api_meeting_request_start_live_streaming",PlatformHubSdkApiRequestStopLiveStreaming:"platform_hub_sdk_api_meeting_request_stop_live_streaming",PlatformHubSdkApiShareAppContentToStage:"platform_hub_sdk_api_meeting_share_app_content_to_stage",PlatformHubSdkApiStopSharingAppContentToStage:"platform_hub_sdk_api_meeting_stop_sharing_app_content_to_stage",PlatformHubSdkApiGetConfig:"platform_hub_sdk_api_pages_config_get_config",PlatformHubSdkApiSetConfig:"platform_hub_sdk_api_pages_config_set_config",PlatformHubSdkApiRemoveFailure:"platform_hub_sdk_api_pages_config_remove_failure",PlatformHubSdkApiRemoveSuccess:"platform_hub_sdk_api_pages_config_remove_success",PlatformHubSdkApiSaveFailure:"platform_hub_sdk_api_pages_config_save_failure",PlatformHubSdkApiSaveSuccess:"platform_hub_sdk_api_pages_config_save_success",PlatformHubSdkApiSetValidityState:"platform_hub_sdk_api_pages_config_set_validity_state",PlatformHubSdkApiNavigateBack:"platform_hub_sdk_api_pages_navigate_back",PlatformHubSdkApiEnterFullscreen:"platform_hub_sdk_api_pages_enter_fullscreen",PlatformHubSdkApiExitFullscreen:"platform_hub_sdk_api_pages_exit_fullscreen",PlatformHubSdkApiNavigateCrossDomain:"platform_hub_sdk_api_pages_navigate_cross_domain",PlatformHubSdkApiReturnFocus:"platform_hub_sdk_api_pages_return_focus",PlatformHubSdkApiGetMruTabInstances:"platform_hub_sdk_api_pages_get_mru_tab_instances",PlatformHubSdkApiGetTabInstances:"platform_hub_sdk_api_pages_get_tab_instances",PlatformHubSdkApiNavigateToTab:"platform_hub_sdk_api_pages_navigate_to_tab",PlatformHubSdkApiNavigateToApp:"platform_hub_sdk_api_pages_navigate_to_app",PlatformHubSdkApiGetPermissionStatus:"platform_hub_sdk_api_permissions_get_permission_status",PlatformHubSdkApiRequestUserConsentForPermission:"platform_hub_sdk_api_permissions_request_user_consent_for_permission",PlatformHubSdkApiSelectPeople:"platform_hub_sdk_api_people_select_people",PlatformHubSdkApiGetUserJoinedTeams:"platform_hub_sdk_api_fulltrust_get_user_joined_teams",PlatformHubSdkApiGetConfigSetting:"platform_hub_sdk_api_fulltrust_get_config_setting",PlatformHubSdkApiSdkSelectAppEntity:"platform_hub_sdk_api_select_app_entity",ATPGetSafeUrl:"platform_tab_atp_get_safe_url",PlatformTabSdkGetAuthenticationTokenForAnonymousUser:"platform_tab_sdk_get_authentication_token_for_guest_user",PlatformTabSDKRequestAppAudioHandling:"platform_tab_sdk_request_app_audio_handling",PlatformTabSDKRegisterMicStateChanged:"platform_tab_sdk_register_mic_state_changed",PlatformTabSDKMicStateUpdateFlow:"platform_tab_sdk_mic_state_update_flow",PlatformTabSDKSendMicMuteStatusResponse:"platform_tab_sdk_send_mic_mute_status_response",PowerbarFirstQuery:"powerbar_query_first",PowerbarZeroQuery:"powerbar_query_zerostate",TopNIDBPopulate:"topn_idb_populate",GetTopNSuggestions:"get_topn_suggestions",AutoSuggestNameSpaceRetryLoadScenario:"autosuggest_retry_namespace_load",PptSharingCreateWebView:"ppt_sharing_create_webview",PptSharingPresentationUrlReady:"ppt_sharing_pres_url_ready",PptSharingReloadScreenDisplayed:"ppt_sharing_reload_error_screen_displayed",PreJoinRoomSearchJoin:"prejoin_room_search_join",PreJoinRender:"calling_prejoin_render",PresenceCreateEndpointScenario:"unified_presence_t2_create_endpoint",PresenceCreateEndpointWorkflow:"unified_presence_t2_create_endpoint_workflow",PresenceCreateEndpointJob:"unified_presence_t2_create_endpoint_job",PresenceDeleteEndpointScenario:"unified_presence_t2_delete_endpoint",PresenceGetUsersBatchPresenceScenario:"unified_presence_t2_get_user_batch_presence",PresenceSyncPresenceScenario:"unified_presence_t2_sync_presence",SetUserInitiatedPresenceScenario:"unified_presence_t2_set_user_initiated_presence",PresencePublishPresenceScenario:"unified_presence_t2_publish_presence",PresenceSubscribePresenceScenario:"unified_presence_t2_subscribe_presence",PresencePostHeartbeatScenario:"unified_presence_t2_post_heartbeat",PresencePostHeartbeatWorkflow:"unified_presence_t2_post_heartbeat_workflow",PresencePostHeartbeatJob:"unified_presence_t2_post_heartbeat_job",SetStatusNoteScenario:"unified_presence_t2_set_status_note",TrouterUserActivityScenario:"unified_presence_t2_post_active_w_trouter",GetPriorityContacts:"people_get_priority_contacts",AddPriorityContact:"people_add_priority_contact",RemovePriorityContact:"people_remove_priority_contact",OfficeIntegrationFreDialog:"t2_office_integration_fre_dialog",GetOofSettings:"get_oof_settings_t2.1",SetOofMessage:"set_oof_message_t2.1",SenstivityLabelSync:"sensitivity_label_sync",SenstivityLabelPolicySettingsSync:"sensitivity_label_policy-settings_sync",SensitivityLabelPolicySettingsFetch:"sensitivity_label_policy_setting_query",AllSearch:"search_all",MessageSearch:"search_message",FilesSearch:"search_files",PeopleSearch:"search_people",EmailSearch:"search_email",MeetingSearch:"search_meeting",ContextualSearchChat:"search_contextual_chat",ContextualSearchChannel:"search_contextual_channel",CustomSearch:"search_custom",CustomSearchPreFetch:"custom_search_pre-fetch",EmailSearch3S:"search_email_3s",Search3SPrefetch:"search_3s_prefetch",ContextualSearchStart:"search_contextual_start",InstallAppDeeplinkShareToStage:"ext_install_app_deeplink_share_to_stage",FloatingShareTrayRender:"floating_sharetray_render",SttExistingChatOrChannelSelection:"stt_existing_chat_channel_selection",SttExistingChatByUsersSearch:"stt_existing_chat_byusers_search",GetTeamByGroupId:"get_team_by_groupid",SetChannelShowForMember:"set_channel_as_default",SetCollapsedConversationPropertyV2:"set_collapsed_conversation_property",UpdateManageTeamSettingsTags:"updatge_manage_team_settings_tags",RemoveThreadMembershipMutation:"remove_thread_membership",StopSharingChannelWithTeamMutation:"stop_sharing_channel_with_team",GetSharedWithTeamsConnectionQuery:"get_shared_with_teams_connection",MembersConnectionQuery:"members_connection",UpdateThreadMembershipMutation:"update_thread_membership",AddThreadMembershipMutation:"add_thread_membership",RestoreChannelMutation:"restore_deleted_channel",SMSThreadSearchJob:"sms_thread_search_job",FreFetchEphemeralMsaProfile:"fre_fetch_ephemeral_profile",FreStampProfile:"fre_enable_profile_searchability",ClaimInviteLink:"claim-invite-link",CreateOneOnOne2WaySms:"create-one-on-one-2-way-sms",SearchPhone2waySms:"search_phone_2way_sms",GroupInviteOffNetwork:"group_invite_OffNetwork",RedeemInviteLink:"redeem-invite-link",ScheduledMeetingChicletGetCalendarEvent:"scheduled-meeting-chiclet-get-calendar-event",ScheduledMeetingChicletGetOccurrenceEvent:"scheduled-meeting-chiclet-get-occurrence-event",SlimcoreVDIInit:"slimcore_vdi_init",VDIBridgeStopped:"vdi_bridge_stopped",SetTouchUpStrenght:"set_touch_up_strength",VideoMessageBlobsGC:"video_message_blobs_gc",OnePlayerLoaderFetch:"oneplayer_loader_fetch",IPCPolicyFetch:"policy_service_fetch_ipc",NetworkPolicyFetch:"policy_service_fetch_network",UserPreferencesManagerGetByCategoy:"user_preferences_manager_get_by_category",UserPreferencesWorkerResolverQuery:"user_preferences_worker_resolvers_query",UserPreferencesWorkerResolverQueryCategoryBased:"user_preferences_worker_resolvers_query_category_based",UserPreferencesWorkerResolverMutation:"user_preferences_worker_resolvers_mutation",DiagnosticsGetLogsFromLocalStorage:"diagnostics_logs_get_from_local_storage",DiagnosticsAddLogsIntoIDB:"diagnostics_logs_adding_into_IDB",DiagnosticsClearIDBStore:"diagnostic_logs_clear_IDB_store",DiagnosticsCreateIDBStore:"diagnostics_logs_create_IDB_store",DiagnosticsDeleteIDB:"diagnostics_logs_delete_IDB_DB",DiagnosticsDeleteLogsInIDB:"diagnostics_logs_delete_IDB_item",DiagnosticsDisableIDB:"diagnostics_logs_disable_IDB",DiagnosticsOpenIDB:"diagnostics_logs_open_IDB",DiagnosticsGetAllLogsFromIDB:"diagnostics_logs_get_all_items_from_IDB",DiagnosticsGetAllKeysFromIDB:"diagnostics_logs_get_all_keys_from_IDB",DiagnosticsSaveIDBItemMain:"diagnostics_logs_save_IDB_item_main",DiagnosticsUpdateIDBItem:"diagnostics_logs_updating_IDB_item",DiagnosticsUpdateIDBKey:"diagnostics_logs_updating_IDB_key",RetrieveRegistrationReport:"retrieveRegistrationReport",WikiMigrationStart:"wiki_migration_migration_start",WikiMigrationCompleted:"wiki_migration_migration_complete",extendedContactsStats:"extended_contacts_statistics",UnifiedConsentLoadHostApp:"uc_load_host_app",UnifiedConsentRequestConsent:"uc_request_consent",UnifiedConsentAccepted:"uc_accept_consent"},o),s=a({ActivityFeedMetaDataInsertedIntoStore:"activity_feed_metadata_inserted_into_store",ActivityManagerGetMessagesFromReplyChainStarted:"activity_manager_get_messages_from_reply_chains_started",AuthStartUpdateMruStart:"auth_web_initialization_update_mru_start",AuthStartUpdateMruStop:"auth_web_initialization_update_mru_stop",AuthWebAuthAppReAuthenticateStart:"auth_web_auth_app_reauthenticate_start",AuthWebAuthAppReAuthenticateStop:"auth_web_auth_app_reauthenticate_stop",AuthServiceLogoutCleanupStop:"auth_service_logout_cleaup_stop",AuthServiceBaseLogoutUserMismatch:"user-misMatch",AuthServiceBaseProviderFail:"provider_fail",AuthServiceBaseProviderStart:"provider_start",AuthServiceBaseProviderStop:"provider_end",AuthWebUpdateMru:"auth_web_update_mru_start",AuthWebMru:"auth_web_module_end",AuthWebView2UpdateMostRecentUserFail:"auth_webview2_update_most_recent_user_fail",AuthWebView2UpdateMostRecentUserFailGenericCatch:"auth_webview2_update_mru_generic_catch",AuthWebInitializeAccountsDisableMAStart:"auth_web_initialize_accounts_disable_ma_start",AuthWebInitializeAccountsDisableMAStop:"auth_web_initialize_accounts_disable_ma_stop",AuthWebGetUserAuthStateResolverStop:"auth_web_get_user_auth_state_stop",BreakoutRoomAnnouncementSendMessageResultProcessing:"send_message_result_processing",BreakoutRoomAnnouncementSendMessageListBreakoutRoomsQuery:"list_breakout_rooms_query",BreakoutRoomAnnouncementCoordinatesRoomQuery:"room_coordinates_query",BreakoutRoomButtonCheckMeetingType:"check_meeting_type",BreakoutRoomButtonFetchListBreakoutRooms:"fetch_list_breakout_rooms",BreakoutRoomCreateDialogListBreakoutRoomsQuery:"list_breakout_rooms_query",BreakoutRoomCreateDialogGetParticipants:"breakout_rooms_creation_get_participants",BreakoutRoomCreateDialogCreateBreakoutRoomsMutation:"create_breakout_rooms_mutation",BreakoutRoomCreateDialogTakeControlMutation:"take_control_mutation",BreakoutRoomCreateDialogWaitFullRoster:"wait_full_roster",BreakoutRoomCreateDialogPreserveRoomsParticipants:"preserve_rooms_participants",BreakoutRoomCreationListBreakoutRoomsQuery:"list_breakout_rooms_query",BreakoutRoomCreationGetParticipants:"breakout_rooms_creation_get_participants",BreakoutRoomCreationCreateBreakoutRoomsMutation:"create_breakout_rooms_mutation",BreakoutRoomEnableRoomsMutation:"enable_rooms_mutation",BreakoutRoomDisableRoomsMutation:"disable_rooms_mutation",BreakoutRoomCreationWaitFullRoster:"wait_full_roster",BreakoutRoomCreationPreserveRoomsParticipants:"preserve_rooms_participants",BreakoutRoomsFinishedFetchingConversationData:"finished_fetching_conversation_data",BreakoutRoomsFinishFetchingCalendarData:"finished_fetching_calendar_data",BreakoutRoomsFinishFetchingTeamMembers:"finished_fetching_team_members",BreakoutRoomsFinishedFetchingAssignees:"finished_fetching_assignees",BreakoutRoomSettingsStored:"breakout_rooms_settings_stored",BreakoutRoomsOpenRightRailFetchData:"fetch_data",ListOfRoomsInTabFetched:"breakout_rooms_list_of_rooms_in_tab_fetched",ParticipantsInTabFetched:"breakout_rooms_participants_in_tab_fetched",BroadcastPlaybackRetried:"Retry",LiveStreamTick:"Tick",CalendarTrackingScenarioStarted:"cal_tracking_scenario_started",CalendarRootContainerLoadStarted:"cal_root_container_load_started",CalendarRootContainerLoaded:"cal_root_container_loaded",CalendarViewBundleLoadStarted:"cal_view_bundle_load_started",CalendarViewBundleLoaded:"cal_view_bundle_loaded",CalendarAppHostBundleLoadStarted:"cal_app_host_bundle_load_started",CalendarAppHostBundleLoaded:"cal_app_host_container_loaded",CalendarAgendaViewBundleLoadStarted:"cal_agenda_view_bundle_load_started",CalendarAgendaViewBundleLoaded:"cal_agenda_view_container_loaded",FetchCalendarEvents:"fetch_calendar_events_start",FetchCalendarLeftRailSettingsSuccess:"fetch_cal_left_rail_settings_success",FetchMeetingArtifactsSuccess:"fetch_meeting_artefacts_success",FetchMeetingArtifactsError:"fetch_meeting_artefacts_error",RosterParticipantsNGCSearch:"roster_participants_ngc_search",SlimCoreWebView2Loaded:"slim_core_web_view_2_loaded",ExtAppForBotCardChatQuery:"ext_app_definitions_for_bot_card_chat_query",ExtAppForBotCardAppQuery:"ext_app_definitions_for_bot_card_app_query",ConversationFetchJobInit:"init",ConversationFetchWorkflowInit:"init",ConversationFetchWorkflowValidated:"validated",ConversationFetchWorkflowJobComplete:"job_complete",ConversationFetchWorkflowProcessedResults:"processed_results",ChannelInfoPaneAllSystemMessageLoading:"channel_info_pane_all_system_messages_loading",GetChannelSystemMessagesFromCSA:"get_channel_system_messages_from_csa",GetChannelSystemMessagesFromCSACompleted:"get_channel_system_messages_from_csa_completed",GetChannelPinnedPostsFromCSA:"get_channel_pinned_posts_from_csa",GetChannelPinnedPostsFromCSACompleted:"get_channel_pinned_posts_from_csa_completed",FetchChannelMembersFromCS:"fetch_channel_members_from_cs",FetchChannelMembersFromCSCompleted:"fetch_channel_members_from_cs_completed",ChannelHeaderRenderComplete:"render_channel_header_complete",ChannelHeaderRenderFail:"render_channel_header_fail",ChannelHeaderTitleRendering:"rendering_channel_header_title",ChannelListRenderComplete:"render_channel_list_complete",ChannelListRenderFail:"render_channel_list_fail",ChannelListPinnedChannelsUpdate:"channel_list_pinned_channel_update",PinnedPostsCdlFetch:"pinned_post_cdl_fetch",PinnedPostsProcessMessages:"pinned_post_process_messages",PinnedPostsBuildResponse:"pinned_post_build_response",DiscoverSurfaceFeedsFetchedFromPPS:"discover_surface_feeds_fetched_from_pps",ResolverStartedRetrySendCsaRequest:"resolver_started_csa_request",ResolverCompletedRetrySendCsaRequest:"resolver_completed_csa_request",ExtMECardFetchAppDefinition:"ext_me_card_fetch_app_definition",ExtMECardPolicyCheck:"ext_me_card_policy_check",ExtMECardGetInstalledApp:"ext_me_card_get_installed_app",ExtMECardInstallApp:"ext_me_card_install_app",ExtMECardExecuteAction:"ext_me_card_execute_action",ExtACMediaCreateEmbedLink:"ext_ac_media_create_embed_link",ExtACMediaLoadMediaFile:"ext_ac_media_load_media_file",ExtMessageExtensionQueryCommandInit:"ext_me_queryCommand_init",PlatformFetchTabInfo:"platform_fetch_tab_information",FileOneUpViewerRedeemCall:"file_oneup_viewer_redeem_call",FileOneUpViewerEmbedParamsConstructed:"file_oneup_viewer_embed_params_constructed",BindingUserMediaWithFlyoutVideo:"binding-user-media-with-flyout-video",AttemptingToGetUserMedia:"attempting-to-get-user-media",ReceivedUserMediaOrNull:"received-user-media-or-null",GetConversationByIdToStartCall:"get-conv-by-userId-start-call",CreateChatWithUsers:"fetch-convo-for-users",getFireCallingIntentMutationVariables:"get-FireCalling-Intention",StartCallWithUsersById:"start-call-with-users-by-id",GetConversationByIdToSendLink:"get-conv-by-userId-send-link",CreateMeetingLinkMutationDocument:"create-meeting-link-Mutation",CreateChatMutationDocument:"create-Chat-Mutation",SendNewMessage:"send-new-message",CreateMeetingObject:"create-meeting-object",WebcamNotEnabledAndSetLoadingVideoFalse:"webcam-not-enabled-and-set-loading-video-false",FlyoutLaunched:"flyout-launched",ShouldStartWebcamOnLaunch:"should-start-webcam-on-launch",FlyoutDismissed:"flyout-dismissed",ExpLoaderIndexStart:"execute-index-html-script",ApplicationLifeCycleStateChange:"application_life_cycle_change",ThirdPartyContactsSyncSettingsCleanUp:"third_party_contacts_sync_settings_cleanUp",ExtAppsQueryInstalledAppsWithPreCheck:"ext_apps_fetch_installed_apps_with_pre_check",AppCacheMainJS:"appcache_main",AppCacheVendorJS:"appcache_vendor",ClickTimeAction:"click-time-action",DownloadMainJs:"main",DownloadVendorJs:"vendor",EncodedBodySizeMainJS:"encoded_body_size_main",EncodedBodySizeVendorJS:"encoded_body_size_vendor",STTDialogTriggered:"stt_dialog_triggered",STTOutlookAuthStrapOpen:"stt_outlook_auth_strap_open",STTOutlookAuthStrapRedirect:"stt_outlook_auth_strap_redirect",STTOutlookCallbackTokenComplete:"stt_outlook_callback_token_complete",STTOutlookMTCachedTokenComplete:"stt_outlook_mt_cached_token_complete",STTOutlookOpen:"stt_outlook_open",STTOutlookSSOComplete:"stt_outlook_sso_complete",RequestSentMT:"request_sent_mt",ResponseSuccessMT:"response_success_mt",InvalidConvId:"invalid_convId",NoHitInMainChatMessage:"no_hit_main_chat",MainChatMessageFound:"main_chat_found",OnBehalfOfUserResolveNameFromMessage:"onbehalfof_user_resolve_name_from_message",OnBehalfOfUserResolveNameFromUserQuery:"onbehalfof_user_resolve_name_from_user_query",MessageIdFetched:"messageId_retrieved",ExtAppsQueryInstalledAppsV2:"ext_apps_fetch_installed_apps_v2",ExtAdaptiveCardSDKParse:"ext_ac_sdk_parse",ExtAdaptiveCardSDKRender:"ext_ac_sdk_render",ExtAdaptiveCardHtmlTransformation:"ext_ac_html_transformation",ExtBotsSignInOnLaunchWebflow:"ext_bots_signin_webflow_started",ExtBotsSignInOnSdkNotifySuccess:"ext_bots_signin_sdk_notify_success",ExtBotsSignInOnSdkNotifyFailure:"ext_bots_signin_sdk_notify_failure",ExtBotsSignInOnInvokStateVerificationDone:"ext_bots_signin_invoke_state_done",ExtBotsSignInOnInvokStateVerificationFailed:"ext_bots_signin_invoke_state_failed",ExtCardCopyPreProcessing:"ext_bots_card_copy_preprocess",ExtCardCopyUISlotReady:"ext_bots_card_copy_ui_slot_ready",ExtCardCopyGenerateMetaInfoHtml:"ext_bots_card_copy_gen_html_meta_info",ExtCardCopyGenerateSharingHtml:"ext_bots_card_copy_gen_html_sharing",ExtCardCopyGenerateTextPreview:"ext_bots_card_copy_gen_text_preview",ExtCardCopyToClipboard:"ext_bots_card_copy_to_clipboard",ExtCardCopyDone:"ext_bots_card_copy_done",ExtAppDefinitionFetched:"ext_app_defintion_fetched",MicPropsChanged:"mic_prop_changed",Channel3SResolved:"3s_channel_resolved",Chat3SResolved:"3s_chat_resolved",People3SResolved:"3s_people_resolved",IndexedDBUpgrade:"indexed_db_upgrade",ChatRosterRenderedMembersLoaded:"members_loaded",ChatRosterRenderedMembersRenderedInVList:"members_rendered_in_vlist",LinkedInCheckVersionOverride:"linkedin_checkversionoverride",LinkedInLoadMain:"linkedin_loadmain",ConstructedResult:"search_meeting_summary_constructed_result",QuestionRendered:"meeting_collab_question_rendered",AnswerRendered:"meeting_collab_answer_rendered",CallingCalendarQuery_ChatLoaded:"calling_calendar_query_chat_loaded",CallingCalendarQuery_TeamChannelLoaded:"calling_calendar_query_team_channel_loaded",MeetingPropertiesFromCallingCalendar:"meeting_properties_from_callingcalendar",MeetAppScheduleMeetingCreateSSEventInitializationComplete:"meet_app_schedule_meeting_create_ss_event_initialization_complete",MeetAppScheduleMeetingGetUserTimeZoneNameResponseFunction:"meet_app_schedule_meeting_get_user_time_zone_response_function",MeetAppSpeedDialListRenderComplete:"meet_app_speeddial_list_render_complete",MeetAppSpeedDialListQueryLoaded:"meet_app_speeddial_list_query_loaded",ModernStageRender_Join:"modern_stage_render_join",ModernStageRender_Swap:"modern_stage_render_swap",ModernStageRender_Pinning:"modern_stage_render_pinning",ModernStageRender_Spotlighting:"modern_stage_render_spotlighting",ModernStageRender_FocusingOnInterpreter:"modern_stage_render_focusing_on_interpreter",ModernStageRender_DisablingParticipantVideo:"modern_stage_render_disabling_participant_video",ModernStageRender_VBSS:"modern_stage_render_vbss",ModernStageRender_BotView:"modern_stage_render_botview",ModernStageRender_PPT:"modern_stage_render_ppt",ModernStageRender_Holographic:"modern_stage_render_holographic",ModernStageRender_Whiteboard:"modern_stage_render_whiteboard",ModernStageRender_HostMode:"modern_stage_render_hostmode",ModernStageRender_Resize:"modern_stage_render_resize",ModernStageRender_CallParticipantsResponse:"modern_stage_render_call_participants_response",VideoContainerMounted:"video_container_rendered",CompositorCreating:"video_compositor_creating",SwitchTmLatencyInvitingBotToCall:"invite_bot_to_call",SwitchTmLatencyBotJoinedCall:"bot_joined_call",SwitchTmLatencyStartStreamInitiated:"start_stream_initiated",SwitchTmLatencyRendererCreated:"renderer_created",SwitchLgLatencyInvitingBotToCall:"invite_bot_to_call",SwitchLgLatencyBotJoinedCall:"bot_joined_call",SwitchLgLatencyStartStreamInitiated:"start_stream_initiated",SwitchLgLatencyRendererCreated:"renderer_created",VideoStreamRenderingRendererCreated:"renderer_created",ChatPaneChatAwaitQueryStart:"chat_pane_chat_query_start",ChatPaneChatAwaitQueryEnd:"chat_pane_chat_query_end",WhiteboardUrlReceived:"whiteboard_url_change_received",WhiteboardUrlSending:"whiteboard_url_change_sending",LoadExtensibleAppRetryAppDefinitionForAttendee:"LoadExtensibleApp_Retry_App_definition_for_attendee",CallHangupLatency_StoppingCall:"stopping_call",CallHangupLatency_RosterHidden:"roster_hidden",CallHangupLatency_ChatPaneHidden:"chatPane_hidden",CallHangupLatency_MeetingDetailsPanelHidden:"meeting_details_hidden",CallHangupLatency_Disconnecting:"disconnecting",CallHangupLatency_Disconnected:"disconnected",CallHangupLatency_CompositorUnmounted:"compositor_unmounted",PostGuardiansAnnouncementToConversation:"post_guardians_announcements_to_conversation",PostCrossPostMessageToConversation:"post_crosspost_message_to_conversation",EditScheduledMessageInDraftStream:"edit_scheduled_in_draft_stream",EditCrossPostMessage:"edit_crosspost_message",ConvertToCrossPostMessage:"convert_to_crosspost_message",DeeplinkParamsReceived:"params_received",DeeplinkIncomingData:"incoming_data",DeeplinkLoadingMore:"loading_more",DeeplinkVirtualListLoadMore:"virtual_list_load_more",DeeplinkLoadedMore:"loaded_more",DeeplinkLoadedAll:"loaded_all",DeeplinkScrollToIndex:"scroll_to_index",DeeplinkHighlightVisible:"highlight_visible",DeeplinkScrollComplete:"scroll_complete",FluidFetchComposeManifestCacheHit:"A cached version has been hit",NoPreviousAndNextMessage:"no_previous_next_message",GetMTMANotificationsInitiated:"get_mtma_notifications_initiated",ConversationsReminderManagerShowreminderSent:"conversations_reminder_manager_event__show_remindersent",P2PFilesListRendererError:"p2p_files_list_renderer_error",P2PFilesListRendererEmptyList:"p2p_files_list_renderer_empty_list",P2PFilesListRendererFilesList:"p2p_files_list_renderer_files_list",P2PFilesListAllFilesCallStart:"p2p_files_list_allfiles_call_start",P2PFilesListAllFilesCallCompleted:"p2p_files_list_allfiles_call_completed",P2PFilesListAllFilesCallFailed:"p2p_files_list_allfiles_call_failed",P2PFilesListAllFilesFastCallStart:"p2p_files_list_allfiles_fast_call_start",P2PFilesListAllFilesFastCallCompleted:"p2p_files_list_allfiles_fast_call_completed",P2PFilesListAllFilesFastCallFailed:"p2p_files_list_allfiles_fast_call_failed",MembersTabSearchFetchTagsError:"people_targeting_members_tab_search_fetch_tags_error",MembersTabSearchFetchTagsComplete:"people_targeting_members_tab_search_fetch_tags_complete",MembersTabFetchTagsComplete:"people_targeting_members_tab_fetch_tags_complete",MembersTabFetchTagsError:"people_targeting_members_tab_fetch_tags_error",ManageTagsFetchTagsComplete:"people_targeting_manage_tags_fetch_tags_complete",ManageTagsFetchTagsError:"people_targeting_manage_tags_fetch_tags_error",ManageTagsFetchDeletedTagsComplete:"people_targeting_manage_tags_fetch_deleted_tags_complete",ManageTagsFetchDeletedTagsError:"people_targeting_manage_tags_fetch_deleted_tags_error",ManageTagsCreateTagComplete:"people_targeting_manage_tags_create_tag_complete",ManageTagsCreateTagError:"people_targeting_manage_tags_create_tag_error",ManageTagsUpdateTagComplete:"people_targeting_manage_tags_update_tag_complete",ManageTagsUpdateTagError:"people_targeting_manage_tags_update_tag_error",ManageTagsAddTagMemberComplete:"people_targeting_manage_tags_add_tag_member_complete",ManageTagsAddTagMemberError:"people_targeting_manage_tags_add_tag_member_error",ManageTagsRemoveTagMemberComplete:"people_targeting_manage_tags_remove_tag_member_complete",ManageTagsRemoveTagMemberError:"people_targeting_manage_tags_remove_tag_member_error",ManageTagsRestoreTagComplete:"people_targeting_manage_tags_restore_tag_complete",ManageTagsRestoreTagError:"people_targeting_manage_tags_restore_tag_error",ManageTagsDeleteTagComplete:"people_targeting_manage_tags_delete_tag_complete",ManageTagsDeleteTagError:"people_targeting_manage_tags_delete_tag_error",ManageTagsStartChatWithTagCancelled:"people_targeting_manage_tags_start_chat_with_tag_cancelled",ManageTagsStartChatWithTagComplete:"people_targeting_manage_tags_start_chat_with_tag_complete",ManageTagsStartChatWithTagFetchTagMembersSucceed:"people_targeting_manage_tags_start_chat_with_tag_fetch_tag_members_succeed",ManageTagsStartChatWithTagError:"people_targeting_manage_tags_start_chat_with_tag_error",ManageTagsGetTagDetailsComplete:"people_targeting_manage_tags_get_tag_details_complete",ManageTagsGetTagDetailsError:"people_targeting_manage_tags_get_tag_details_error",ManageTagsGetTeamTagSettingsComplete:"people_targeting_manage_tags_get_team_tag_settings_complete",ManageTagsGetTeamTagSettingsError:"people_targeting_manage_tags_get_team_tag_settings_error",FilterFedAndBots:"filter_federated_users_and_bots",IndexFetchIPC:"index_fetch_ipc",IndexFetchIPCWait:"index_fetch_ipc_wait",FetchWaitRequestIPC:"fetch_wait_request_ipc",FetchWaitResponseIPC:"fetch_wait_response_ipc",FetchWaitIPC:"fetch_wait_ipc",ExtractAppDefinitionJobStarted:"ext_extract_app_definition_job_started",ExtractAppDefinitionJobComplete:"ext_extract_app_definition_job_complete",StoreEntryProviderLoaded:"provider_loaded",StoreEntryItemsQueryCompleted:"items_query_completed",StoreEntryItemsDetailQueryStarted:"items_detail_query_started",PlatformTabInitInvoke:"platform_tab_initialize_invoked",PlatformTabAppLoadedInvoke:"platform_tab_appLoaded_invoked",PlatformTabNotifySuccessInvoke:"platform_tab_success_invoked",PlatformTabNotifyFailureInvoke:"platform_tab_failure_invoked",PlatformTabNotifyExpectedFailureInvoke:"platform_tab_expected_failure_invoked",PlatformTabSidePanelLoadStart:"platform_tab_sidepanel_load_start",PlatformTabFetchUbarIsMemberSuccess:"platform_tab_fetch_ubar_isMember_success",PlatformTabFetchUbarIsMemberNotSet:"platform_tab_fetch_ubar_isMember_notSet",PlatformTabFetchUbarDroppedTabsDueToMeetingContext:"platform_tab_fetch_ubar_droppedTabs_meetingContext",IdbPeopleAndChatStart:"indexeddb_people_chat_start",IdbPeopleAndChatEnd:"indexeddb_people_chat_end",SuggestionTCCIdbStart:"suggestion_tcc_idb_start",SuggestionTCCIdbStop:"suggestion_tcc_idb_stop",Suggestion3SStart:"suggestion_3s_start",Suggestion3SStop:"suggestion_3s_stop",Suggestion3SProcessComplete:"suggestion_3s_process_complete",PeopleTopNIdbStop:"people_topn_idb_stop",ConversionStart:"suggestion_conversion_start",ConversionStop:"suggestion_conversion_stop",ConversationFallbackToPeopleHydration:"suggestion_conversation_fallback_hydration",JoinByRoomInitiated:"initiated_join_by_room",BeginRegisterImProvider:"t2_office_integration_begin_register_im_provider",FinalizeRegisterImProvider:"t2_office_integration_finalize_register_im_provider",CacheWait3S:"cache_wait_3s",PrefetchResponse3S:"prefetch_response_3s",Get3SCallMetaData:"get_3s_call_metadata",RequestSent3S:"request_sent_3s",ResponseSuccess3S:"response_success_3s",UIResultsProcessed:"render_begin",FetchedFromServiceCache:"fetched_from_cache",ForcedTimedOut3S:"forced_timeout_3s",Failure3S:"failure_3s",Retry3S:"retry_3s",STTGetAggregatedSuggestions:"stt_get_aggregated_suggestions",STTProcessPeopleResults:"stt_process_people_results",STTProcessGroupChatResults:"stt_process_group_chat_results",STTProcessChannelResults:"stt_process_channel_results",CreateTeamRenderError:"render_create_team_error",CreateTeamRenderComplete:"render_create_team_complete",SensitivityLabelsRendered:"render_sensitivity_labels_complete",MyGroupSettingsLoaded:"group_settings_loaded",UpdateManageTeamSettingsTagsError:"render_team_settings_tab_error",UpdateManageTeamSettingsTagsComplete:"render_team_settings_tab_complete",RenderChannelInvitationsTabRequestFinished:"render_channel_invitations_tab_request_done",RenderChannelInvitationsTabStandardComplete:"render_channel_invitations_tab_complete",RenderTeamsGalleryPaneEmptyResults:"render_teams_gallery_pane_teams_empty_results",RenderPendingInvitationsTabRequestsFetched:"render_pending_invitation_tab_requests_fetched",RenderPendingInvitationsTabRequestsProcessed:"render_pending_invitation_tab_requests_processed",RenderPendingInvitationsTabRequestsFetchedError:"render_pending_invitation_tab_requests_fetched_error",RenderPendingInvitationsTabEmpty:"render_pending_invitation_tab_empty",SlimcoreVDIModuleLoadSuccess:"slimcore_vdi_module_load_success",SlimcoreVDIModuleLoadFailed:"slimcore_vdi_module_load_failed",VDIBridgeStarted:"vdi_bridge_started",VDIBridgeConnected:"vdi_bridge_connected",VDIBridgeDownloadSlimcore:"vdi_bridge_download_slimcore",VDIBridgeDisconnected:"vdi_bridge_disconnected",VDIBridgeConnectedNoPlugin:"vdi_bridge_connected_no_plugin",ScreenRecorderUnmounted:"screen_recorder_dialog_unmounted",MessageLieUpdateFailed:"msg_lie_update_failed",VideoContainerLazyLoaded:"video_container_lazy_loaded ",OnePlayerLoaderBundleFetchedFromCDN:"one_player_loader_bundle_fetched_from_cdn",OnePlayerFactoryFetchedFromCDN:"one_player_factory_fetched_from_cdn"},o)},85762:(e,t,n)=>{"use strict";function i(e={},t){return new Proxy(e,{get:(e,n)=>t?n in e?e[n]:t(String(n)):String(n)})}n.d(t,{wh:()=>a,Ai:()=>o,Th:()=>r,rA:()=>s,PO:()=>l,Tk:()=>d,Yu:()=>c,$K:()=>u,sz:()=>m,eD:()=>g,uS:()=>p,b6:()=>h});const a=i({}),o=i({}),r=i({}),s=i({}),l=i({}),d=i({}),c=i({}),u=i({}),m=i({}),g=i({}),p=i({}),h=i({})},30358:(e,t,n)=>{"use strict";n.d(t,{S:()=>a});var i=n(24211);class a{constructor(){this._id=(0,i.v4)(),this._dispose=null,this._data={}}get id(){return this._id}get data(){return this._data}set alertName(e){this._data["DataBag.alertName"]=e}set allAliasesTurnedOff(e){this._data["DataBag.allAliasesTurnedOff"]=e}set allAliasesWithPrivateVisibility(e){this._data["DataBag.allAliasesWithPrivateVisibility"]=e}set tabAppCount(e){this._data["DataBag.tabAppCount"]=e}set appId(e){this._data["DataBag.appId"]=e}set appInstallScope(e){this._data["DataBag.appInstallScope"]=e}set appStoreOriginSource(e){this._data["DataBag.appStoreOriginSource"]=e}set isUserPartOfMeetingAttendeesCount(e){this._data["DataBag.activeCallsCount"]=e}set setIsMeetingGame(e){this._data["DataBag.isMeetingGame"]=e}set autoreconnectShown(e){this._data["DataBag.autoreconnectShown"]=e}set backSpaceCount(e){this._data["DataBag.backSpaceCount"]=e}set bannerScenario(e){this._data["DataBag.bannerScenario"]=e}set bannerPageIndex(e){this._data["DataBag.bannerPageIndex"]=e}set callId(e){this._data["DataBag.callId"]=e}set callParticipantUserRole(e){this._data["DataBag.callParticipantUserRole"]=e}set callType(e){this._data["DataBag.callType"]=e}set callHistoryItemFetched(e){this._data["Calling.callHistoryItemFetched"]=e}set callHistoryItemDisplayed(e){this._data["Calling.callHistoryItemDisplayed"]=e}set callHistoryItemUiLimit(e){this._data["Calling.callHistoryItemUiLimit"]=e}set callHistoryItemCountIsBelowLimit(e){this._data["Calling.callHistoryItemCountIsBelowLimit"]=e}set callHistoryDelegatorId(e){this._data["Calling.callHistoryDelegatorId"]=e}set cardHasMentions(e){this._data["DataBag.cardHasMentions"]=e}set cardSenderType(e){this._data["DataBag.cardSenderType"]=e}set cardSenderUserId(e){this._data["DataBag.cardSenderUserId"]=e}set cardType(e){this._data["DataBag.cardType"]=e}set cardAggregatedCount(e){this._data["DataBag.cardAggregatedCount"]=e}set category(e){this._data["DataBag.category"]=e}set chatDensity(e){this._data["DataBag.chatDensity"]=e}set chatMembersCount(e){this._data["DataBag.chatMembersCount"]=e}set channelView(e){this._data["DataBag.channelView"]=e}set dataFetched(e){this._data["DataBag.dataFetched"]=e}set displayMode(e){this._data["DataBag.displayMode"]=e}set eventOrigin(e){this._data["DataBag.eventOrigin"]=e}set isChannelsV2(e){this._data["DataBag.isChannelsV2"]=e}set teamId(e){this._data["DataBag.teamId"]=e}set channelId(e){this._data["DataBag.channelId"]=e}set dwellTime(e){this._data["DataBag.dwellTime"]=e}set hasNewUpdates(e){this._data["DataBag.hasNewUpdates"]=e}set teamOfficeGroupId(e){this._data["Channels.teamOfficeGroupId"]=e}set deeplinkId(e){this._data["DataBag.deeplinkId"]=e}set dialIn(e){this._data["DataBag.dialIn"]=e}set dialOut(e){this._data["DataBag.dialOut"]=e}set eventType(e){this._data["DataBag.eventType"]=e}set hasAttachments(e){this._data["DataBag.hasAttachments"]=e}set isAllDayEvent(e){this._data["DataBag.isAllDayEvent"]=e}set isCancelled(e){this._data["DataBag.isCancelled"]=e}set isGroupChatRenamed(e){this._data["DataBag.isGroupChatRenamed"]=e}set newChatIntentId(e){this._data["DataBag.newChatIntentId"]=e}set isMeetingLive(e){this._data["DataBag.isMeetingLive"]=e}set isNetworkIssue(e){this._data["DataBag.isNetworkIssue"]=e}set isNewToVideoFilter(e){this._data["DataBag.isNewToVideoFilter"]=e}set isOwnInvite(e){this._data["DataBag.isOwnInvite"]=e}set isUserPartOfMeetingAttendees(e){this._data["DataBag.isUserPartOfMeetingAttendees"]=e}set isUnSupportedCard(e){this._data["DataBag.isUnSupportedCard"]=e}set isWXPFile(e){this._data["DataBag.isWXPFile"]=e}set isRequestWithAdminConfigUrl(e){this._data["PlatformUserLifeCycle.isRequestWithAdminConfigUrl"]=e}set isInstalledApp(e){this._data["PlatformUserLifeCycle.isInstalledApp"]=e}set subscriptionButtonType(e){this._data["AppMonetization.subscriptionButtonType"]=e}set joinLinkChatType(e){this._data["DataBag.joinLinkChatType"]=e}set joinLinkId(e){this._data["DataBag.joinLinkId"]=e}set joinLinkRedeemFailureReason(e){this._data["DataBag.joinLinkRedeemFailureReason"]=e}set joinLinkType(e){this._data["DataBag.joinLinkType"]=e}set joinLinkVariant(e){this._data["DataBag.joinLinkVariant"]=e}set wasShared(e){this._data["DataBag.wasShared"]=e}set sharedBy(e){this._data["DataBag.sharedBy"]=e}set mediaElementSource(e){this._data["Extensibility.mediaElementSource"]=e}set userType(e){this._data["Extensibility.userType"]=e}set meetingType(e){this._data["DataBag.meetingType"]=e}set meetingChatType(e){this._data["DataBag.meetingChatType"]=e}set meetingChatRegion(e){this._data["DataBag.meetingChatRegion"]=e}set meetingParticipants(e){this._data["DataBag.meetingParticipants"]=e}set shareWindowsCount(e){this._data["DataBag.shareWindowsCount"]=e}set shareScreensCount(e){this._data["DataBag.shareScreensCount"]=e}set meetingDuration(e){this._data["DataBag.meetingDuration"]=e}set totalCallParticipants(e){this._data["DataBag.totalCallParticipants"]=e}set isXboxWatchParty(e){this._data["DataBag.isXboxWatchParty"]=e}set meetingRecurrence(e){this._data["DataBag.meetingRecurrence"]=e}set meetingScheduledEndTime(e){this._data["DataBag.meetingScheduledEndTime"]=e}set meetingScheduledStartTime(e){this._data["DataBag.meetingScheduledStartTime"]=e}set mentionType(e){this._data["DataBag.mentionType"]=e}set participantId(e){this._data["DataBag.participantId"]=e}set participantCount(e){this._data["DataBag.participantCount"]=e}set pickerUsageArea(e){this._data["DataBag.pickerUsageArea"]=e}set previousCallId(e){this._data["DataBag.previousCallId"]=e}set previousParticipantId(e){this._data["DataBag.previousParticipantId"]=e}set roomIndex(e){this._data["DataBag.roomIndex"]=e}set actionableAppProfileCard(e){this._data["GrowthPlatform.actionableAppProfileCard"]=e}set actionType(e){this._data["DataBag.actionType"]=e}set suggestionSecondaryActionType(e){this._data["Powerbar.suggestionSecondaryActionType"]=e}set fromExposeBotActions(e){this._data["DataBag.fromExposeBotActions"]=e}set didRenderChatOpenAppAction(e){this._data["Extensibility.didRenderChatOpenAppAction"]=e}set fromDeepLink(e){this._data["Extensibility.fromDeepLink"]=e}set installedAppsCount(e){this._data["DataBag.installedAppsCount"]=e}set isStaticTab(e){this._data["DataBag.isStaticTab"]=e}set isPreconsentedApp(e){this._data["DataBag.isPreconsentedApp"]=e}set atMentions(e){this._data["DataBag.atmentions"]=e}set attachmentIds(e){this._data["DataBag.attachmentIds"]=e}set attachments(e){this._data["DataBag.attachments"]=e}set autoDetectedLang(e){this._data["DataBag.autoDetectedLang"]=e}set avatarBackgroundId(e){this._data["DataBag.avatarBackgroundId"]=e}set avatarId(e){this._data["DataBag.avatarId"]=e}set isBrandedBackground(e){this._data["CMD.isBrandedBackground"]=e}set isBrandedColor(e){this._data["CMD.isBrandedColor"]=e}set isBrandedLogo(e){this._data["CMD.isBrandedLogo"]=e}set isVideoOn(e){this._data["CMD.isVideoOn"]=e}set joinWithOutgoingAudio(e){this._data["DataBag.joinWithOutgoingAudio"]=e}set joinWithOutgoingVideo(e){this._data["DataBag.joinWithOutgoingVideo"]=e}set joinWithIncomingAudio(e){this._data["DataBag.joinWithIncomingAudio"]=e}set wasAutomuteTriggered(e){this._data["DataBag.wasAutomuteTriggered"]=e}set wasRoomLoudSpeakerInTheMeetingTriggered(e){this._data["DataBag.wasRoomLoudSpeakerInTheMeetingTriggered"]=e}set wasRoomBluetoothProximityTriggered(e){this._data["DataBag.wasRoomBluetoothProximityTriggered"]=e}set raisedHandWithSkinTone(e){this._data["DataBag.raisedHandWithSkinTone"]=e}set botmentionedMriCollection(e){this._data["DataBag.botmentionedMriCollection"]=e}set botMentions(e){this._data["DataBag.botMentions"]=e}set breakoutRoomsAssignablePeopleCount(e){this._data["DataBag.breakoutRoomsAssignablePeopleCount"]=e}set breakoutRoomsAssignmentType(e){this._data["DataBag.breakoutRoomsAssignmentType"]=e}set breakoutRoomsAssignmentsCount(e){this._data["DataBag.breakoutRoomsAssignmentsCount"]=e}set breakoutRoomsAssignmentPerRoom(e){this._data["DataBag.breakoutRoomsAssignmentPerRoom"]=e}set breakoutRoomsAssignmentSortBy(e){this._data["DataBag.breakoutRoomsAssignmentSortBy"]=e}set breakoutRoomsExperience(e){this._data["DataBag.breakoutRoomsExperience"]=e}set breakoutRoomsCount(e){this._data["DataBag.breakoutRoomsCount"]=e}set breakoutRoomsEndpointsCount(e){this._data["DataBag.breakoutRoomsEndpointsCount"]=e}set isRecreation(e){this._data["BreakoutRooms.isRecreation"]=e}set panelContent(e){this._data["BreakoutRooms.panelContent"]=e}set breakoutRoomsPreMeetingSessionId(e){this._data["DataBag.breakoutRoomsPreMeetingSessionId"]=e}set breakoutRoomsSupportedEndpointsCount(e){this._data["DataBag.breakoutRoomsSupportedEndpointsCount"]=e}set broadcastDeviceId(e){this._data["DataBag.broadcastDeviceId"]=e}set broadcastPlatform(e){this._data["DataBag.broadcastPlatform"]=e}set broadcastOrganizerTenantId(e){this._data["DataBag.broadcastOrganizerTenantId"]=e}set broadcastRole(e){this._data["VirtualEvent.broadcastRole"]=e}set brSettingsAllowJoinBackToMainMeeting(e){this._data["DataBag.brSettingsAllowJoinBackToMainMeeting"]=e}set brSettingsAllowMoveParticipantsAutomatically(e){this._data["DataBag.brSettingsAllowMoveParticipantsAutomatically"]=e}set brSettingsAllowUsersToSelectBreakoutRoom(e){this._data["DataBag.brSettingsAllowUsersToSelectBreakoutRoom"]=e}set brSettingsManagers(e){this._data["DataBag.brSettingsManagers"]=e}set brSettingsRoomDuration(e){this._data["DataBag.brSettingsRoomDuration"]=e}set cachedPeopleResultsCount(e){this._data["DataBag.cachedPeopleResultsCount"]=e}set calendarSource(e){this._data["DataBag.calendarSource"]=e}set calendarType(e){this._data["DataBag.calendarType"]=e}set castSharePTT(e){this._data["DataBag.castSharePTT"]=e}set castShareScreen(e){this._data["DataBag.castShareScreen"]=e}set castComputerSound(e){this._data["DataBag.castComputerSound"]=e}set chainId(e){this._data["DataBag.chainid"]=e}set canSupportBreakoutRooms(e){this._data["DataBag.canSupportBreakoutRooms"]=e}set channelCount(e){this._data["DataBag.channelCount"]=e}set channelMentions(e){this._data["DataBag.channelmentions"]=e}set cleanupEnabled(e){this._data["DataBag.cleanupEnabled"]=e}set clickFromCTA(e){this._data["DataBag.clickFromCTA"]=e}set codeSnippets(e){this._data["DataBag.codeSnippets"]=e}set column(e){this._data["DataBag.column"]=e}set commandId(e){this._data["Databag.commandId"]=e}set commandSource(e){this._data["DataBag.commandSource"]=e}set containsTflSMSMember(e){this._data["DataBag.containsTflSMSMember"]=e}set contentCameraScanType(e){this._data["DataBag.contentCameraScanType"]=e}set contentType(e){this._data["DataBag.contentType"]=e}set videoEnvironment(e){this._data["DataBag.videoEnvironment"]=e}set countOfEdits(e){this._data["DataBag.countOfEdits"]=e}set campaignId(e){this._data["DataBag.campaignId"]=e}set dialogState(e){this._data["DataBag.dialogState"]=e}set dialogType(e){this._data["DataBag.dialogType"]=e}set dismissType(e){this._data["DataBag.dismissType"]=e}set directSubstrateCallEnabled(e){this._data["DataBag.directSubstrateCallEnabled"]=e}set edgeDetectionEnabled(e){this._data["DataBag.edgeDetectionEnabled"]=e}set editAge(e){this._data["DataBag.editAge"]=e}set emoji(e){this._data["DataBag.emoji"]=e}set emojiCategory(e){this._data["DataBag.emojiCategory"]=e}set emojiList(e){this._data["DataBag.emojiList"]=e}set entityId(e){this._data["DataBag.entityId"]=e}set entityType(e){this._data["DataBag.entityType"]=e}set entryPoint(e){this._data["DataBag.entryPoint"]=e}set endpointId(e){this._data["DataBag.endpointId"]=e}set federatedAndBotsResultsCount(e){this._data["DataBag.federatedAndBotsResultsCount"]=e}set feedId(e){this._data["DataBag.feedId"]=e}set offNetworkContactsSelected(e){this._data["DataBag.offNetworkContactsSelected"]=e}set sentGIFsInMessage(e){this._data["DataBag.GIF"]=e}set sentStickersInMessage(e){this._data["DataBag.Sticker"]=e}set originatedTimeStamp(e){this._data["DataBag.originatedTimeStamp"]=e}set fileAction(e){this._data["DataBag.fileAction"]=e}set fileControl(e){this._data["DataBag.fileControl"]=e}set fileId(e){this._data["DataBag.fileId"]=e}set fileSource(e){this._data["DataBag.fileSource"]=e}set suggestedFileContext(e){this._data["Files.suggestedFileContext"]=e}set fileViewerType(e){this._data["Files.fileViewerType"]=e}set fileViewerAppId(e){this._data["Files.fileViewerAppId"]=e}set fileExtension(e){this._data["DataBag.fileExtension"]=e}set fileTypeList(e){this._data["DataBag.fileTypeList"]=e}set filterApplied(e){this._data["DataBag.filterApplied"]=e}set renderableItemsCount(e){this._data["DataBag.renderableItemsCount"]=e}set filterType(e){this._data["DataBag.filterType"]=e}set folderLevel(e){this._data["DataBag.folderLevel"]=e}set giphy(e){this._data["DataBag.giphy"]=e}set groupType(e){this._data["DataBag.groupType"]=e}set groupTemplateType(e){this._data["DataBag.groupTemplateType"]=e}set hasAADFederatedMembers(e){this._data["DataBag.hasAADFederatedMembers"]=e}set hasMSAFederatedMembers(e){this._data["DataBag.hasMSAFederatedMembers"]=e}set importantflag(e){this._data["DataBag.importantflag"]=e}set insightType(e){this._data["AiInsights.insightType"]=e}set inlineImages(e){this._data["DataBag.inlineImages"]=e}set inputExtensionAppNameCollection(e){this._data["DataBag.inputExtensionAppNameCollection"]=e}set inputExtensionMrisCollection(e){this._data["DataBag.inputExtensionMrisCollection"]=e}set installDialogResult(e){this._data["DataBag.installDialogResult"]=e}set isActionOnSeries(e){this._data["DataBag.isActionOnSeries"]=e}set isContextMenuVisible(e){this._data["DataBag.isContextMenuVisible"]=e}set mtmaAccountNotificationsCount(e){this._data["DataBag.mtmaAccountNotificationsCount"]=e}set missedMtmaTotalNotificationsCount(e){this._data["DataBag.missedMtmaTotalNotificationsCount"]=e}set accountNotificationPositionInList(e){this._data["DataBag.accountNotificationPositionInList"]=e}set totalMtmaAccountsHavingNotifications(e){this._data["DataBag.totalMtmaAccountsHavingNotifications"]=e}set totalMtmaTenantsHavingNotifications(e){this._data["DataBag.totalMtmaTenantsHavingNotifications"]=e}set appBootType(e){this._data["DataBag.appBootType"]=e}set notificationSignalsList(e){this._data["DataBag.notificationSignalsList"]=e}set mostRecentNotificationSignal(e){this._data["DataBag.mostRecentNotificationSignal"]=e}set callingToastType(e){this._data["DataBag.callingToastType"]=e}set communitiesToastType(e){this._data["DataBag.communitiesToastType"]=e}set isDefaultFileOpenEndPointUsed(e){this._data["DataBag.isDefaultFileOpenEndPointUsed"]=e}set isGalleryEmpty(e){this._data["DataBag.isGalleryEmpty"]=e}set isLastKeyDownBackSpace(e){this._data["DataBag.isLastKeyDownBackSpace"]=e}set isModified(e){this._data["DataBag.isModified"]=e}set isNewChat(e){this._data["DataBag.isNewChat"]=e}set isOnlineMeeting(e){this._data["DataBag.isOnlineMeeting"]=e}set isPasted(e){this._data["DataBag.isPasted"]=e}set isPrivate(e){this._data["DataBag.isPrivate"]=e}set isReplyToEmailMessage(e){this._data["DataBag.isReplyToEmailMessage"]=e}set itemsCount(e){this._data["DataBag.itemsCount"]=e}set language(e){this._data["DataBag.language"]=e}set Latency(e){this._data["DataBag.Latency"]=e}set leftRailDirective(e){this._data["DataBag.leftRailDirective"]=e}set links(e){this._data["DataBag.links"]=e}set meetingCategories(e){this._data["DataBag.meetingCategories"]=e}set messageId(e){this._data["DataBag.messageID"]=e}set messageLength(e){this._data["DataBag.messagelength"]=e}set messageType(e){this._data["DataBag.messageType"]=e}set mriCollection(e){this._data["DataBag.mricollection"]=e}set mtResultCount(e){this._data["DataBag.mtResultCount"]=e}set name(e){this._data["DataBag.name"]=e}set namedGroupChatsResultsCount(e){this._data["DataBag.namedGroupChatsResultsCount"]=e}set negativeType(e){this._data["AiInsights.negativeType"]=e}set negativeReason(e){this._data["AiInsights.negativeReason"]=e}set newReaction(e){this._data["DataBag.newReaction"]=e}set newSettingsValue(e){this._data["DataBag.newSettingsValue"]=e}set netTimeTaken(e){this._data["DataBag.netTimeTaken"]=e}set networkSearchCount(e){this._data["DataBag.networkSearchCount"]=e}set nextView(e){this._data["DataBag.nextView"]=e}set notifyOrganizer(e){this._data["DataBag.notifyOrganizer"]=e}set numberOfAliases(e){this._data["DataBag.numberOfAliases"]=e}set numberOfAliasesTurnedOn(e){this._data["DataBag.numberOfAliasesTurnedOn"]=e}set numberOfAliasesTurnedOff(e){this._data["DataBag.numberOfAliasesTurnedOff"]=e}set numberOfAliasVisibilitySettings(e){this._data["DataBag.numberOfAliasVisibilitySettings"]=e}set referrer(e){this._data["DataBag.referrer"]=e}set numberOfAliasesWithPublicVisibility(e){this._data["DataBag.numberOfAliasesWithPublicVisibility"]=e}set numberOfAliasesWithPrivateVisibility(e){this._data["DataBag.numberOfAliasesWithPrivateVisibility"]=e}set newAliasVisibilityValue(e){this._data["DataBag.newAliasVisibilityValue"]=e}set numberOfEvents(e){this._data["DataBag.numberOfEvents"]=e}set numberOfEventsWithArtifacts(e){this._data["DataBag.numberOfEventsWithArtifacts"]=e}set numberOfAppointments(e){this._data["DataBag.numberOfAppointments"]=e}set numberOfEncryptedEvents(e){this._data["DataBag.numberOfEncryptedEvents"]=e}set totalMeetingMinutes(e){this._data["DataBag.totalMeetingMinutes"]=e}set totalAppointmentMinutes(e){this._data["DataBag.totalAppointmentMinutes"]=e}set numberOfCategorizedEvents(e){this._data["DataBag.numberOfCategorizedEvents"]=e}set oldSettingsValue(e){this._data["DataBag.oldSettingsValue"]=e}set numUsersSelectedViaPicker(e){this._data["DataBag.numUsersSelectedViaPicker"]=e}set optionsAvailable(e){this._data["DataBag.optionsAvailable"]=e}set optionsChanged(e){this._data["DataBag.optionsChanged"]=e}set meetingOptionsPresenterCount(e){this._data["DataBag.meetingOptionsPresenterCount"]=e}set meetingOptionsCoorganizerCount(e){this._data["DataBag.meetingOptionsCoorganizerCount"]=e}set meetingOptionsCoorganizerPromoteCount(e){this._data["DataBag.meetingOptionsCoorganizerPromoteCount"]=e}set meetingOptionsCoorganizerDemoteCount(e){this._data["DataBag.meetingOptionsCoorganizerDemoteCount"]=e}set meetingOptionsActedFrom(e){this._data["DataBag.meetingOptionsActedFrom"]=e}set meetingOptionsSkinType(e){this._data["DataBag.meetingOptionsSkinType"]=e}set order(e){this._data["DataBag.order"]=e}set organizerId(e){this._data["DataBag.organizerId"]=e}set personType(e){this._data["DataBag.personType"]=e}set pinned(e){this._data["DataBag.pinned"]=e}set position(e){this._data["DataBag.position"]=e}set postType(e){this._data["DataBag.postType"]=e}set previousReaction(e){this._data["DataBag.previousReaction"]=e}set producerLayout(e){this._data["DataBag.producerLayout"]=e}set producerSourceTypes(e){this._data["DataBag.producerSourceTypes"]=e}set quadDetected(e){this._data["DataBag.quadDetected"]=e}set queryLength(e){this._data["DataBag.queryLength"]=e}set reactionScenario(e){this._data["DataBag.reactionScenario"]=e}set read(e){this._data["DataBag.Read"]=e}set reportType(e){this._data["DataBag.reportType"]=e}set richText(e){this._data["DataBag.richText"]=e}set RelatedMesaageID(e){this._data["DataBag.RelatedMesaageID"]=e}set rightClickAction(e){this._data["DataBag.rightClickAction"]=e}set rosterSize(e){this._data["DataBag.rostersize"]=e}set serpFromState(e){this._data["DataBag.serpFromState"]=e}set serpToState(e){this._data["DataBag.serpToState"]=e}set searchResultPage(e){this._data["DataBag.searchResultPage"]=e}set searchResultPosition(e){this._data["DataBag.searchResultPosition"]=e}set searchResultPositionInGroup(e){this._data["DataBag.searchResultPositionInGroup"]=e}set searchSessionId(e){this._data["DataBag.searchSessionId"]=e}set serpEntryUserAction(e){this._data["DataBag.serpEntryUserAction"]=e}set searchTermLength(e){this._data["DataBag.searchTermLength"]=e}set searchTextLength(e){this._data["DataBag.searchTextLength"]=e}set isLongSearchText(e){this._data["Powerbar.isLongSearchText"]=e}set selectedAudienceScene(e){this._data["DataBag.selectedAudienceScene"]=e}set selectedCustomVideoBackground(e){this._data["DataBag.selectedCustomVideoBackground"]=e}set selectedView(e){this._data["DataBag.selectedView"]=e}set sharedContent(e){this._data["DataBag.sharedContent"]=e}set substrateCallResultCount(e){this._data["DataBag.substrateCallResultCount"]=e}set syncSource(e){this._data["DataBag.syncSource"]=e}set provider(e){this._data["DataBag.provider"]=e}set sfbInteropMessage(e){this._data["DataBag.sfbInteropMessage"]=e}set size(e){this._data["DataBag.size"]=e}set SmartReplyClickPosition(e){this._data["DataBag.SmartReplyClickPosition"]=e}set SmartReplyLength(e){this._data["DataBag.SmartReplyLength"]=e}set SmartReplyTTR(e){this._data["DataBag.SmartReplyTTR"]=e}set smartReplySuggestionType(e){this._data["DataBag.smartReplySuggestionType"]=e}set ContainsEmoji(e){this._data["Messaging.ContainsEmoji"]=e}set ContainsEmojiList(e){this._data["Messaging.ContainsEmojiList"]=e}set ContainsRenderedEmoji(e){this._data["Messaging.ContainsRenderedEmoji"]=e}set ContainsRenderedEmojiList(e){this._data["Messaging.ContainsRenderedEmojiList"]=e}set emojiIndex(e){this._data["Messaging.emojiIndex"]=e}set SmartReplyWhisperId(e){this._data["DataBag.SmartReplyWhisperId"]=e}set SmartReplySettingEnabled(e){this._data["DataBag.SmartReplySettingEnabled"]=e}set SmartReplySuggestionIds(e){this._data["DataBag.SmartReplySuggestionIds"]=e}set SmartReplyFileSuggestionCount(e){this._data["DataBag.SmartReplyFileSuggestionCount"]=e}set codeSnippetLength(e){this._data["DataBag.Source"]=e}set reactionSource(e){this._data["DataBag.source"]=e}set serviceName(e){this._data["DataBag.serviceName"]=e}set selectedId(e){this._data["DataBag.selectedId"]=e}set selectedIndex(e){this._data["DataBag.selectedIndex"]=e}set storeItemIds(e){this._data["PlatformUserLifeCycle.storeItemIds"]=e}set isCTA(e){this._data["PlatformUserLifeCycle.isCTA"]=e}set CTAType(e){this._data["PlatformUserLifeCycle.CTAType"]=e}set zeroStateSuggestionsDiscardedByTabCount(e){this._data["DataBag.zeroStateSuggestionsDiscardedByTabCount"]=e}set zeroStateSuggestionSelectedAtUserCount(e){this._data["DataBag.zeroStateSuggestionSelectedAtUserCount"]=e}set zeroStateSuggestionsDiscardedByEscCount(e){this._data["DataBag.zeroStateSuggestionsDiscardedByEscCount"]=e}set selectionType(e){this._data["DataBag.selectionType"]=e}set sourceMessageId(e){this._data["DataBag.sourceMessageId"]=e}set sourceThreadId(e){this._data["DataBag.sourceThreadId"]=e}set stateBookmark(e){this._data["DataBag.state_bookmark"]=e}set stateBookmarkDuration(e){this._data["DataBag.state_bookmarkDuration"]=e}set subjectPresent(e){this._data["DataBag.subjectpresent"]=e}set subType(e){this._data["DataBag.subType"]=e}set suggestionSource(e){this._data["DataBag.suggestionSource"]=e}set suggestedActionTypes(e){this._data["DataBag.suggestedActionTypes"]=e}set suggestedFile(e){this._data["DataBag.suggestedFile"]=e}set synthNotificationUserNeverTriedApp(e){this._data["DataBag.synthNotificationUserNeverTriedApp"]=e}set tabType(e){this._data["DataBag.tabType"]=e}set tagged(e){this._data["DataBag.Tagged"]=e}set tagResultsCount(e){this._data["DataBag.tagResultsCount"]=e}set teamMentions(e){this._data["DataBag.teammentions"]=e}set tflOffNetworkEmailCount(e){this._data["DataBag.tflOffNetworkEmailCount"]=e}set tflOffNetworkOneWayPhoneCount(e){this._data["DataBag.tflOffNetworkOneWayPhoneCount"]=e}set tflSMSMembersCount(e){this._data["DataBag.tflSMSMembersCount"]=e}set timeFromFirstInput(e){this._data["DataBag.timeFromFirstInput"]=e}set totalKeyStrokes(e){this._data["DataBag.totalKeyStrokes"]=e}set trackSummary(e){this._data["DataBag.trackSummary"]=e}set transcriptId(e){this._data["DataBag.transcriptId"]=e}set type(e){this._data["DataBag.type"]=e}set unreadIncomingMessagesCount(e){this._data["DataBag.unreadIncomingMessagesCount"]=e}set userMeetingRole(e){this._data["DataBag.userMeetingRole"]=e}set usermentionMris(e){this._data["DataBag.usermentionMris"]=e}set userHasSearched(e){this._data["DataBag.userHasSearched"]=e}set userTypeSelected(e){this._data["DataBag.userTypeSelected"]=e}set TFLUserEDState(e){this._data["DataBag.TFLUserEDState"]=e}set TFLUserInED(e){this._data["DataBag.TFLUserInED"]=e}set EDInviteFree(e){this._data["DataBag.EDInviteFree"]=e}set isSelectAddedUserViaMention(e){this._data["DataBag.isSelectAddedUserViaMention"]=e}set identifier(e){this._data["DataBag.Identifier"]=e}set dateRangeType(e){this._data["DataBag.dateRangeType"]=e}set isActive(e){this._data["DataBag.isActive"]=e}set tabSubmenuItem(e){this._data["DataBag.tabSubmenuItem"]=e}set tabSubmenuTrigger(e){this._data["DataBag.tabSubmenuTrigger"]=e}set urlAppTipShown(e){this._data["DataBag.urlAppTipShown"]=e}set acAppTipShown(e){this._data["DataBag.acAppTipShown"]=e}set videoRotation(e){this._data["DataBag.videoRotation"]=e}set wasReply(e){this._data["DataBag.wasReply"]=e}set WhisperId(e){this._data["DataBag.WhisperId"]=e}set wrap(e){this._data["DataBag.wrap"]=e}set webinarId(e){this._data["DataBag.webinarId"]=e}set webinarQuestions(e){this._data["DataBag.webinarQuestions"]=e}set webinarCustomQuestionsCountDelta(e){this._data["DataBag.webinarCustomQuestionsCountDelta"]=e}set webinarQuestionCountDelta(e){this._data["DataBag.webinarQuestionCountDelta"]=e}set webinarSpeakerCountDelta(e){this._data["DataBag.webinarSpeakerCountDelta"]=e}set webinarAccessPolicy(e){this._data["DataBag.webinarAccessPolicy"]=e}set collaborativeState(e){this._data["DataBag.collaborativeState"]=e}set correlationId(e){this._data["DataBag.correlationId"]=e}set isACv2Card(e){this._data["DataBag.isACv2Card"]=e}set hasACv2Refresh(e){this._data["DataBag.hasACv2Refresh"]=e}set hasIncomingScreenshare(e){this._data["DataBag.hasIncomingScreenshare"]=e}set hasParentTeacherMeetingPolicies(e){this._data["DataBag.hasParentTeacherMeetingPolicies"]=e}set acv2RefreshUserIdCount(e){this._data["DataBag.acv2RefreshUserIdCount"]=e}set acv2RefreshForAll(e){this._data["DataBag.acv2RefreshForAll"]=e}set acv2RefreshTeamSize(e){this._data["DataBag.acv2RefreshTeamSize"]=e}set espActionId(e){this._data["DataBag.espActionId"]=e}set irisCampaignId(e){this._data["ESP.irisCampaignId"]=e}set executeTrigger(e){this._data["DataBag.executeTrigger"]=e}set actionExecuteResponseStatus(e){this._data["DataBag.actionExecuteResponseStatus"]=e}set actionExecuteResponseType(e){this._data["DataBag.actionExecuteResponseType"]=e}set actionExecuteCallTime(e){this._data["DataBag.actionExecuteCallTime"]=e}set actionExecuteCacheReadTime(e){this._data["DataBag.actionExecuteCacheReadTime"]=e}set actionExecuteErrorCode(e){this._data["DataBag.actionExecuteErrorCode"]=e}set reportReason(e){this._data["DataBag.reportReason"]=e}set reportHasDetails(e){this._data["DataBag.reportHasDetails"]=e}set appName(e){this._data["DataBag.appName"]=e}set isLOBApp(e){this._data["DataBag.isLOBApp"]=e}set showMap(e){this._data["DataBag.showMap"]=e}set allowChooseLocation(e){this._data["DataBag.allowChooseLocation"]=e}set errorCode(e){this._data["DataBag.errorCode"]=e}set selectedAplBackgroundId(e){this._data["DataBag.selectedAplBackgroundId"]=e}set presenterMode(e){this._data["DataBag.presenterMode"]=e}set attachmentLayout(e){this._data["DataBag.attachmentLayout"]=e}set isSyncContactsSelected(e){this._data["DataBag.isSyncContactsSelected"]=e}set isPhoneStamped(e){this._data["DataBag.isPhoneStamped"]=e}set isEmailStamped(e){this._data["DataBag.isEmailStamped"]=e}set isEmailGmail(e){this._data["DataBag.isEmailGmail"]=e}set videoApp(e){this._data["VideoExt.videoApp"]=e}set videoAppId(e){this._data["VideoExt.videoAppId"]=e}set videoEffectId(e){this._data["VideoExt.videoEffectId"]=e}set videoEffectName(e){this._data["VideoExt.videoEffectName"]=e}set videoEffectCategory(e){this._data["VideoExt.videoEffectCategory"]=e}set videoFileId(e){this._data["DataBag.videoFileId"]=e}set computerSound(e){this._data["DataBag.computerSound"]=e}set isRegisteredAttendee(e){this._data["DataBag.isRegisteredAttendee"]=e}set isPublicEvent(e){this._data["DataBag.isPublicEvent"]=e}set lmsCourseId(e){this._data["DataBag.lmsCourseId"]=e}set lmsUserRoles(e){this._data["DataBag.lmsUserRoles"]=e}set messageActionIndex(e){this._data["DataBag.messageActionIndex"]=e}set isCoreMessageAction(e){this._data["DataBag.isCoreMessageAction"]=e}set messageActionType(e){this._data["DataBag.messageActionType"]=e}set messageActionMenuLevel(e){this._data["DataBag.messageActionMenuLevel"]=e}set guardiansChatMemberTypeCount(e){this._data["DataBag.guardiansChatMemberTypeCount"]=e}set guardiansChatEmailInviteCount(e){this._data["DataBag.guardiansChatEmailInviteCount"]=e}set guardiansChatSmsInviteCount(e){this._data["DataBag.guardiansChatSmsInviteCount"]=e}set guardiansChatFallbackEmailInviteCount(e){this._data["DataBag.guardiansChatFallbackEmailInviteCount"]=e}set guardiansChatNoInviteCount(e){this._data["DataBag.guardiansChatNoInviteCount"]=e}set launchTileId(e){this._data["NovaAppBar.launchTileId"]=e}set launchTilePosition(e){this._data["NovaAppBar.launchTilePosition"]=e}set launchTileEventType(e){this._data["NovaAppBar.launchTileEventType"]=e}set launchTileAppName(e){this._data["NovaAppBar.launchTileAppName"]=e}set numParentsWithEmails(e){this._data["DataBag.numParentsWithEmails"]=e}set numParentsWithValidPhones(e){this._data["DataBag.numParentsWithValidPhones"]=e}set numParentsWithInvalidPhones(e){this._data["DataBag.numParentsWithInvalidPhones"]=e}set numTotalParents(e){this._data["DataBag.numTotalParents"]=e}set preferredContactMethod(e){this._data["DataBag.preferredContactMethod"]=e}set isBackedBySubstrateGroup(e){this._data["DataBag.isBackedBySubstrateGroup"]=e}set totalStoreItemsCount(e){this._data["DataBag.totalStoreItemsCount"]=e}set totalStoreBlockedItemsCount(e){this._data["PlatformUserLifeCycle.totalStoreBlockedItemsCount"]=e}set isFrequentCollaborators(e){this._data["PlatformUserLifeCycle.isFrequentCollaborators"]=e}set totalFrequentCollaboratorsStoreItemsCount(e){this._data["PlatformUserLifeCycle.totalFrequentCollaboratorsStoreItemsCount"]=e}set totalFrequentCollaboratorsCount(e){this._data["PlatformUserLifeCycle.totalFrequentCollaboratorsCount"]=e}set suggestedSource(e){this._data["PlatformUserLifeCycle.suggestedSource"]=e}set collectionId(e){this._data["DataBag.collectionId"]=e}set articleId(e){this._data["DataBag.articleId"]=e}set storeFilterSelectedItems(e){this._data["DataBag.storeFilterSelectedItems"]=e}set storeItemTemplate(e){this._data["DataBag.storeItemTemplate"]=e}set storeItemIsBlocked(e){this._data["DataBag.storeItemIsBlocked"]=e}set teamSensitivity(e){this._data["DataBag.teamSensitivity"]=e}set teamsPerGridViewSection(e){this._data["DataBag.teamsPerGridViewSection"]=e}set teamVisibility(e){this._data["DataBag.teamVisibility"]=e}set templateId(e){this._data["DataBag.templateId"]=e}set templateUri(e){this._data["DataBag.templateUri"]=e}set isExitModal(e){this._data["DataBag.isExitModal"]=e}set searchResultView(e){this._data["DataBag.searchResultView"]=e}set usersSuggestionsCount(e){this._data["DataBag.usersSuggestionsCount"]=e}set isLeavingPinnedTogetherMode(e){this._data["DataBag.isLeavingPinnedTogetherMode"]=e}set isLeavingSignLanguageView(e){this._data["DataBag.isLeavingSignLanguageView"]=e}set countTeamMembers(e){this._data["DataBag.countTeamMembers"]=e}set countTeamMembersAndInvitees(e){this._data["DataBag.countTeamMembersAndInvitees"]=e}set countChatMembers(e){this._data["DataBag.countChatMembers"]=e}set countInvitees(e){this._data["DataBag.countInvitees"]=e}set countAssignedInvitees(e){this._data["DataBag.countAssignedInvitees"]=e}set countAssignedTeamMembers(e){this._data["DataBag.countAssignedTeamMembers"]=e}set countAssignedTeamMembersAndInvitees(e){this._data["DataBag.countAssignedTeamMembersAndInvitees"]=e}set countUnassignedInvitees(e){this._data["DataBag.countUnassignedInvitees"]=e}set countUnassignedTeamMembers(e){this._data["DataBag.countUnassignedTeamMembers"]=e}set countUnassignedTeamMembersAndInvitees(e){this._data["DataBag.countUnassignedTeamMembersAndInvitees"]=e}set countOfAssignmentsNotInMeeting(e){this._data["BreakoutRooms.countOfAssignmentsNotInMeeting"]=e}set implicitContactsCount(e){this._data["DataBag.implicitContactsCount"]=e}set implicitContactsRate(e){this._data["DataBag.implicitContactsRate"]=e}set googleImplicitContactsCount(e){this._data["DataBag.googleImplicitContactsCount"]=e}set chatType(e){this._data["DataBag.chatType"]=e}set isPanelAutoOpened(e){this._data["DataBag.isPanelAutoOpened"]=e}set isOrganizer(e){this._data["DataBag.isOrganizer"]=e}set hasMultipleUserEndpoints(e){this._data["DataBag.hasMultipleUserEndpoints"]=e}set isRecurrent(e){this._data["DataBag.isRecurrent"]=e}set isEventEncrypted(e){this._data["DataBag.isEventEncrypted"]=e}set isEventDecryptionFailed(e){this._data["DataBag.isEventDecryptionFailed"]=e}set isCopyDisabledBySensitivity(e){this._data["DataBag.isCopyDisabledBySensitivity"]=e}set isForwardDisabledBySensitivity(e){this._data["DataBag.isForwardDisabledBySensitivity"]=e}set autoCreatedCollabNotes(e){this._data["DataBag.autoCreatedCollabNotes"]=e}set numberOfRequiredAttendees(e){this._data["DataBag.numberOfRequiredAttendees"]=e}set isSensitivityLabelPresent(e){this._data["DataBag.isSensitivityLabelPresent"]=e}set numberOfOptionalAttendees(e){this._data["DataBag.numberOfOptionalAttendees"]=e}set numberOfAttendeesWithDifferentTimezone(e){this._data["DataBag.numberOfAttendeesWithDifferentTimezone"]=e}set numberOfLocation(e){this._data["DataBag.numberOfLocation"]=e}set numberOfClassicalAttachments(e){this._data["DataBag.numberOfClassicalAttachments"]=e}set numberOfCloudAttachments(e){this._data["DataBag.numberOfCloudAttachments"]=e}set isFormEdited(e){this._data["DataBag.isFormEdited"]=e}set providerType(e){this._data["DataBag.providerType"]=e}set tabId(e){this._data["DataBag.tabId"]=e}set teamCardNotificationCount(e){this._data["DataBag.teamCardNotificationCount"]=e}set notesCreateTime(e){this._data["DataBag.notesCreateTime"]=e}set fluidCorrelationId(e){this._data["Messaging.fluidCorrelationId"]=e}set fluidIsFromCurrentUser(e){this._data["Messaging.fluidIsFromCurrentUser"]=e}set fluidMessageId(e){this._data["Messaging.fluidMessageId"]=e}set isFluidOpenedFromExtensibilityFlyout(e){this._data["Messaging.isFluidOpenedFromExtensibilityFlyout"]=e}set campaignType(e){this._data["GrowthPlatform.campaignType"]=e}set meetAppCalendarType(e){this._data["DataBag.meetAppCalendarType"]=e}set meetAppScenarioName(e){this._data["MeetApp.meetAppScenarioName"]=e}set meetAppEventType(e){this._data["MeetApp.meetAppEventType"]=e}set meetAppEventName(e){this._data["MeetApp.meetAppEventName"]=e}set meetAppEventId(e){this._data["MeetApp.meetAppEventId"]=e}set meetAppSessionId(e){this._data["MeetApp.meetAppSessionId"]=e}set eventId(e){this._data["VirtualEvent.eventId"]=e}set meetingCoorganizerCount(e){this._data["DataBag.meetingCoorganizerCount"]=e}set meetingPresenterCount(e){this._data["DataBag.meetingPresenterCount"]=e}set meetingTimezone(e){this._data["DataBag.meetingTimezone"]=e}set featureId(e){this._data["WhatsNew.featureId"]=e}set featuresCount(e){this._data["WhatsNew.featuresCount"]=e}set trigger(e){this._data["WhatsNew.trigger"]=e}set redDotShown(e){this._data["WhatsNew.redDotShown"]=e}set chatHasMissedCall(e){this._data["ChatList.chatHasMissedCall"]=e}set chatHasMissedMention(e){this._data["ChatList.chatHasMissedMention"]=e}set chatHasMissedReaction(e){this._data["ChatList.chatHasMissedReaction"]=e}set chatIsUnread(e){this._data["ChatList.chatIsUnread"]=e}set isEmptyState(e){this._data["Flyout.isEmptyState"]=e}get isEmptyState(){return this._data["Flyout.isEmptyState"]}set pageName(e){this._data["Flyout.pageName"]=e}set deviceType(e){this._data["DataBag.deviceType"]=e}set permissions(e){this._data["DataBag.permissions"]=e}set collabStageViewChildWindowOpenDuration(e){this._data["DataBag.collabStageViewChildWindowOpenDuration"]=e}set channelMemberCount(e){this._data["TeamsAndChannels.channelMemberCount"]=e}set channelPosition(e){this._data["TeamsAndChannels.channelPosition"]=e}set channelState(e){this._data["TeamsAndChannels.channelState"]=e}set channelType(e){this._data["TeamsAndChannels.channelType"]=e}set dndSortedItemOldPosition(e){this._data["TeamsAndChannels.dndSortedItemOldPosition"]=e}set dndSortedItemNewPosition(e){this._data["TeamsAndChannels.dndSortedItemNewPosition"]=e}set dndSortedItemsTotalCount(e){this._data["TeamsAndChannels.dndSortedItemsTotalCount"]=e}set sharedChannelTeamRelationship(e){this._data["TeamsAndChannels.sharedChannelTeamRelationship"]=e}set hostTeamInheritance(e){this._data["TeamsAndChannels.hostTeamInheritance"]=e}set sharedChannelTeamCount(e){this._data["TeamsAndChannels.sharedChannelTeamCount"]=e}set hostTeamId(e){this._data["TeamsAndChannels.hostTeamId"]=e}set teamMembershipType(e){this._data["TeamsAndChannels.teamMembershipType"]=e}set sensitivity(e){this._data["TeamsAndChannels.sensitivity"]=e}set teamType(e){this._data["TeamsAndChannels.teamType"]=e}set visibility(e){this._data["TeamsAndChannels.visibility"]=e}set atMentionBadgeCount(e){this._data["TeamsAndChannels.atMentionBadgeCount"]=e}set isFavDefault(e){this._data["TeamsAndChannels.isFavDefault"]=e}set isChannelNew(e){this._data["TeamsAndChannels.isChannelNew"]=e}set isTeamNew(e){this._data["TeamsAndChannels.isTeamNew"]=e}set teamPrivateChannelCount(e){this._data["TeamsAndChannels.teamPrivateChannelCount"]=e}set teamSharedChannelCount(e){this._data["TeamsAndChannels.teamSharedChannelCount"]=e}set teamStandardChannelCount(e){this._data["TeamsAndChannels.teamStandardChannelCount"]=e}set updatedUserRole(e){this._data["TeamsAndChannels.updatedUserRole"]=e}set channelAction(e){this._data["TeamsAndChannels.channelAction"]=e}set channelSetting(e){this._data["TeamsAndChannels.channelSetting"]=e}set channelSettingValue(e){this._data["TeamsAndChannels.channelSettingValue"]=e}set teamSetting(e){this._data["TeamsAndChannels.teamSetting"]=e}set teamSettingValue(e){this._data["TeamsAndChannels.teamSettingValue"]=e}set mbScenarioName(e){this._data["DataBag.mbScenarioName"]=e}set mbEventType(e){this._data["DataBag.mbEventType"]=e}set mbEventName(e){this._data["DataBag.mbEventName"]=e}set mbEventId(e){this._data["DataBag.mbEventId"]=e}set mbActionValue(e){this._data["DataBag.mbActionValue"]=e}set numberOfTotalAttendeesEmailsPasted(e){this._data["DataBag.numberOfTotalAttendeesEmailsPasted"]=e}set numberOfInvalidAttendeesEmailsPasted(e){this._data["DataBag.numberOfInvalidAttendeesEmailsPasted"]=e}set delimitersUsedToSeparateEmails(e){this._data["DataBag.delimitersUsedToSeparateEmails"]=e}set hasSuggestedSendTime(e){this._data["VivaInsights.hasSuggestedSendTime"]=e}set scheduleSuggestionNudgeCount(e){this._data["VivaInsights.scheduleSuggestionNudgeCount"]=e}set scheduleSuggestionNudgeTTR(e){this._data["VivaInsights.scheduleSuggestionNudgeTTR"]=e}set numChatSpaces(e){this._data["Spaces.numChatSpaces"]=e}set numChannelSpaces(e){this._data["Spaces.numChannelSpaces"]=e}set numActiveSpaces(e){this._data["Spaces.numActiveSpaces"]=e}set currentSubtitlesLanguage(e){this._data["DataBag.currentSubtitlesLanguage"]=e}set currentSubtitlesSource(e){this._data["DataBag.currentSubtitlesSource"]=e}set beforeSubtitlesLanguage(e){this._data["DataBag.beforeSubtitlesLanguage"]=e}set beforeSubtitlesSource(e){this._data["DataBag.beforeSubtitlesSource"]=e}set currentSpokenLanguage(e){this._data["DataBag.currentSpokenLanguage"]=e}set isWithinComposition(e){this._data["DataBag.isWithinComposition"]=e}set frameContext(e){this._data["DataBag.frameContext"]=e}set unifiedConsentEventCode(e){this._data["UnifiedConsent.eventCode"]=e}set unifiedConsentEventName(e){this._data["UnifiedConsent.eventName"]=e}set unifiedConsentEventMessage(e){this._data["UnifiedConsent.eventMessage"]=e}set unifiedConsentFormFactor(e){this._data["UnifiedConsent.formFactor"]=e}set unifiedConsentSurface(e){this._data["UnifiedConsent.consentSurface"]=e}set unifiedConsentType(e){this._data["UnifiedConsent.consentType"]=e}set unifiedConsentModelVersion(e){this._data["UnifiedConsent.modelVersion"]=e}set unifiedConsentModelType(e){this._data["UnifiedConsent.modelType"]=e}set unifiedConsentModelId(e){this._data["UnifiedConsent.modelId"]=e}set unifiedConsentReconsentReason(e){this._data["UnifiedConsent.reconsentReason"]=e}set unifiedConsentCorrelationId(e){this._data["UnifiedConsent.correlationId"]=e}set tagMemberCount(e){this._data["PeopleTargeting.tagMemberCount"]=e}set hasDescription(e){this._data["PeopleTargeting.hasDescription"]=e}set canPostToChannel(e){this._data["PeopleTargeting.canPostToChannel"]=e}set postToChannel(e){this._data["PeopleTargeting.postToChannel"]=e}set hasCustomMessage(e){this._data["PeopleTargeting.hasCustomMessage"]=e}set isFromCopy(e){this._data["PeopleTargeting.isFromCopy"]=e}set EDUserState(e){this._data["DataBag.EDUserState"]=e}set isEDUser(e){this._data["DataBag.isEDUser"]=e}set togetherEmojisInteractionType(e){this._data["TogetherEmojis.interactionType"]=e}set userBiTestOnly(e){this._data["Instrumentation.UserBiTestOnly"]=e}set inviteAllMembers(e){this._data["DataBag.inviteAllMembers"]=e}set sensitivityLabelDowngradeJustification(e){this._data["DataBag.sensitivityLabelDowngradeJustification"]=e}set sensitivityLabelDowngradeDialogSkin(e){this._data["DataBag.sensitivityLabelDowngradeDialogSkin"]=e}set onboardingIsUnifiedConsentApproved(e){this._data["Onboarding.isUnifiedConsentApproved"]=e}setDispose(e){this._dispose=e}dispose(){this._dispose&&this._dispose()}}},5102:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(15317),a=n(71503);var o;!function(e){e[e["3mf"]=0]="3mf",e[e.cool=1]="cool",e[e.glb=2]="glb",e[e.gltf=3]="gltf",e[e.obj=4]="obj",e[e.stl=5]="stl",e[e.movie=6]="movie",e[e.pages=7]="pages",e[e.pict=8]="pict",e[e.sketch=9]="sketch",e[e.ai=10]="ai",e[e.pdf=11]="pdf",e[e.psb=12]="psb",e[e.psd=13]="psd",e[e["3g2"]=14]="3g2",e[e["3gp"]=15]="3gp",e[e.asf=16]="asf",e[e.bmp=17]="bmp",e[e.hevc=18]="hevc",e[e.m2ts=19]="m2ts",e[e.m4v=20]="m4v",e[e.mov=21]="mov",e[e.mp3=22]="mp3",e[e.mp4=23]="mp4",e[e.mp4v=24]="mp4v",e[e.mts=25]="mts",e[e.ts=26]="ts",e[e.wmv=27]="wmv",e[e.dwg=28]="dwg",e[e.fbx=29]="fbx",e[e.erf=30]="erf",e[e.zip=31]="zip",e[e["7z"]=32]="7z",e[e.z=33]="z",e[e.dcm=34]="dcm",e[e.dcm30=35]="dcm30",e[e.dicm=36]="dicm",e[e.dicom=37]="dicom",e[e.ply=38]="ply",e[e.hcp=39]="hcp",e[e.gif=40]="gif",e[e.heic=41]="heic",e[e.heif=42]="heif",e[e.jpeg=43]="jpeg",e[e.jpg=44]="jpg",e[e.jpe=45]="jpe",e[e.mef=46]="mef",e[e.mrw=47]="mrw",e[e.nef=48]="nef",e[e.nrw=49]="nrw",e[e.orf=50]="orf",e[e.pano=51]="pano",e[e.pef=52]="pef",e[e.png=53]="png",e[e.rw2=54]="rw2",e[e.spm=55]="spm",e[e.tif=56]="tif",e[e.tiff=57]="tiff",e[e.xbm=58]="xbm",e[e.xcf=59]="xcf",e[e.key=60]="key",e[e.csv=61]="csv",e[e.dic=62]="dic",e[e.doc=63]="doc",e[e.docm=64]="docm",e[e.docx=65]="docx",e[e.dot=66]="dot",e[e.dotm=67]="dotm",e[e.dotx=68]="dotx",e[e.pot=69]="pot",e[e.potm=70]="potm",e[e.potx=71]="potx",e[e.pps=72]="pps",e[e.ppsm=73]="ppsm",e[e.ppsx=74]="ppsx",e[e.ppt=75]="ppt",e[e.pptm=76]="pptm",e[e.pptx=77]="pptx",e[e.xd=78]="xd",e[e.xls=79]="xls",e[e.xlsb=80]="xlsb",e[e.xlsm=81]="xlsm",e[e.xlsx=82]="xlsx",e[e.sltx=83]="sltx",e[e.eml=84]="eml",e[e.msg=85]="msg",e[e.vsd=86]="vsd",e[e.vsdx=87]="vsdx",e[e.cur=88]="cur",e[e.ico=89]="ico",e[e.icon=90]="icon",e[e.epub=91]="epub",e[e.odp=92]="odp",e[e.ods=93]="ods",e[e.odt=94]="odt",e[e.arw=95]="arw",e[e.cr2=96]="cr2",e[e.crw=97]="crw",e[e.dng=98]="dng",e[e.rtf=99]="rtf",e[e.abap=100]="abap",e[e.ada=101]="ada",e[e.adp=102]="adp",e[e.ahk=103]="ahk",e[e.as=104]="as",e[e.as3=105]="as3",e[e.asc=106]="asc",e[e.ascx=107]="ascx",e[e.asm=108]="asm",e[e.asp=109]="asp",e[e.awk=110]="awk",e[e.bas=111]="bas",e[e.bash=112]="bash",e[e.bash_login=113]="bash_login",e[e.bash_logout=114]="bash_logout",e[e.bash_profile=115]="bash_profile",e[e.bashrc=116]="bashrc",e[e.bat=117]="bat",e[e.bib=118]="bib",e[e.bsh=119]="bsh",e[e.build=120]="build",e[e.builder=121]="builder",e[e.c=122]="c",e[e.capfile=123]="capfile",e[e.cbk=124]="cbk",e[e.cc=125]="cc",e[e.cfc=126]="cfc",e[e.cfm=127]="cfm",e[e.cfml=128]="cfml",e[e.cl=129]="cl",e[e.clj=130]="clj",e[e.cmake=131]="cmake",e[e.cmd=132]="cmd",e[e.coffee=133]="coffee",e[e.cpp=134]="cpp",e[e.cpt=135]="cpt",e[e.cpy=136]="cpy",e[e.cs=137]="cs",e[e.cshtml=138]="cshtml",e[e.cson=139]="cson",e[e.csproj=140]="csproj",e[e.css=141]="css",e[e.ctp=142]="ctp",e[e.cxx=143]="cxx",e[e.d=144]="d",e[e.ddl=145]="ddl",e[e.dif=146]="dif",e[e.diff=147]="diff",e[e.disco=148]="disco",e[e.dml=149]="dml",e[e.dtd=150]="dtd",e[e.dtml=151]="dtml",e[e.el=152]="el",e[e.emake=153]="emake",e[e.erb=154]="erb",e[e.erl=155]="erl",e[e.f90=156]="f90",e[e.f95=157]="f95",e[e.fluid=158]="fluid",e[e.fs=159]="fs",e[e.fsi=160]="fsi",e[e.fsscript=161]="fsscript",e[e.fsx=162]="fsx",e[e.gemfile=163]="gemfile",e[e.gemspec=164]="gemspec",e[e.gitconfig=165]="gitconfig",e[e.go=166]="go",e[e.groovy=167]="groovy",e[e.gvy=168]="gvy",e[e.h=169]="h",e[e.haml=170]="haml",e[e.handlebars=171]="handlebars",e[e.hbs=172]="hbs",e[e.hrl=173]="hrl",e[e.hs=174]="hs",e[e.htc=175]="htc",e[e.hxx=176]="hxx",e[e.idl=177]="idl",e[e.iim=178]="iim",e[e.inc=179]="inc",e[e.inf=180]="inf",e[e.ini=181]="ini",e[e.inl=182]="inl",e[e.ipp=183]="ipp",e[e.ipynb=184]="ipynb",e[e.irbrc=185]="irbrc",e[e.jade=186]="jade",e[e.jav=187]="jav",e[e.java=188]="java",e[e.jfif=189]="jfif",e[e.js=190]="js",e[e.json=191]="json",e[e.jsp=192]="jsp",e[e.jsx=193]="jsx",e[e.l=194]="l",e[e.less=195]="less",e[e.lhs=196]="lhs",e[e.lisp=197]="lisp",e[e.log=198]="log",e[e.lst=199]="lst",e[e.ltx=200]="ltx",e[e.lua=201]="lua",e[e.m=202]="m",e[e.make=203]="make",e[e.markdn=204]="markdn",e[e.mdown=205]="mdown",e[e.mkdn=206]="mkdn",e[e.ml=207]="ml",e[e.mli=208]="mli",e[e.mll=209]="mll",e[e.mly=210]="mly",e[e.mm=211]="mm",e[e.mud=212]="mud",e[e.nfo=213]="nfo",e[e.opml=214]="opml",e[e.osascript=215]="osascript",e[e.out=216]="out",e[e.p=217]="p",e[e.pas=218]="pas",e[e.patch=219]="patch",e[e.php=220]="php",e[e.php2=221]="php2",e[e.php3=222]="php3",e[e.php4=223]="php4",e[e.php5=224]="php5",e[e.pl=225]="pl",e[e.plist=226]="plist",e[e.pm=227]="pm",e[e.pod=228]="pod",e[e.pp=229]="pp",e[e.profile=230]="profile",e[e.properties=231]="properties",e[e.ps=232]="ps",e[e.ps1=233]="ps1",e[e.pt=234]="pt",e[e.py=235]="py",e[e.pyw=236]="pyw",e[e.r=237]="r",e[e.rake=238]="rake",e[e.rb=239]="rb",e[e.rbx=240]="rbx",e[e.rc=241]="rc",e[e.re=242]="re",e[e.readme=243]="readme",e[e.reg=244]="reg",e[e.rest=245]="rest",e[e.resw=246]="resw",e[e.resx=247]="resx",e[e.rhtml=248]="rhtml",e[e.rjs=249]="rjs",e[e.rprofile=250]="rprofile",e[e.rpy=251]="rpy",e[e.rss=252]="rss",e[e.rst=253]="rst",e[e.rxml=254]="rxml",e[e.s=255]="s",e[e.sass=256]="sass",e[e.scala=257]="scala",e[e.scm=258]="scm",e[e.sconscript=259]="sconscript",e[e.sconstruct=260]="sconstruct",e[e.script=261]="script",e[e.scss=262]="scss",e[e.sgml=263]="sgml",e[e.sh=264]="sh",e[e.shtml=265]="shtml",e[e.sml=266]="sml",e[e.sql=267]="sql",e[e.sty=268]="sty",e[e.tcl=269]="tcl",e[e.tex=270]="tex",e[e.text=271]="text",e[e.textile=272]="textile",e[e.tld=273]="tld",e[e.tli=274]="tli",e[e.tmpl=275]="tmpl",e[e.tpl=276]="tpl",e[e.txt=277]="txt",e[e.vb=278]="vb",e[e.vi=279]="vi",e[e.vim=280]="vim",e[e.wsdl=281]="wsdl",e[e.xaml=282]="xaml",e[e.xhtml=283]="xhtml",e[e.xoml=284]="xoml",e[e.xml=285]="xml",e[e.xsd=286]="xsd",e[e.xsl=287]="xsl",e[e.xslt=288]="xslt",e[e.yaml=289]="yaml",e[e.yaws=290]="yaws",e[e.yml=291]="yml",e[e.zsh=292]="zsh",e[e.htm=293]="htm",e[e.html=294]="html",e[e.markdown=295]="markdown",e[e.md=296]="md",e[e.url=297]="url",e[e.one=298]="one",e[e.note=299]="note"}(o||(o={}));const r="(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",s="[0-9a-fA-F]{1,4}",l=`(\\s|^|\\[)(${`(?:${s}:){1,7}:|(?:${s}:){7}${s}|(?:${s}:){6}(?::${s}|${r})|(?:${s}:){5}(?:(?::${s}){1,2}|:${r})|(?:${s}:){4}(?:(?::${s}){1,3}|(?::${s}){0,1}:${r})|(?:${s}:){3}(?:(?::${s}){1,4}|(?::${s}){0,2}:${r})|(?:${s}:){2}(?:(?::${s}){1,5}|(?::${s}){0,3}:${r})|(?:${s}:){1}(?:(?::${s}){1,6}|(?::${s}){0,4}:${r})|(?::(?:(?::${s}){1,7}|(?::${s}){0,5}:${r}|:))|(?:fe80|FE80):(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}`})(\\s|$|\\])`,d={[a.A4.SmtpAddress]:new RegExp("\\S+@\\S+\\.\\S+","g"),[a.A4.IPV4Address]:new RegExp(r,"g"),[a.A4.PhoneNumber]:new RegExp("(?:[^-\\d]|^)(?:\\+?1[-.]?)?\\(?([0-9]{3})\\)?[-.]?([0-9]{3})[-.]?([0-9]{4})(?!\\d)","g"),[a.A4.Uri]:new RegExp('((http[s]?:\\/\\/[^(\\/|\\?)]+\\S)|(data:text\\/)|(data:image)|(data:application)|(file:)|([s]?ftp:\\/\\/[\\S]+\\/)|(mailto:))(([^(.|")]+[^\\s]+))'),[a.A4.FilePath]:new RegExp(`((\\s(\\w+))(\\/).+?(?=((\\.${Object.keys(o).filter((e=>isNaN(Number(e)))).join(")|(\\.")})|($))))`,"g")};function c(e,t){switch(e){case a.A4.SmtpAddress:case a.A4.IPV4Address:case a.A4.PhoneNumber:case a.A4.FilePath:return t.replace(d[e],(e=>(0,i.sha256)(e)));case a.A4.IPv6Address:return function(e){const t=new RegExp(l,"g");let n,a="";do{if(n=t.exec(e),n&&4===n.length){const o=n.index+n[1].length;a=`${a}${e.substring(0,o)}${(0,i.sha256)(n[2])}`;const r=o+n[2].length;e=e.substring(r),t.lastIndex=0}}while(n);return`${a}${e}`}(t);case a.A4.Uri:{let n,a="";do{if(n=d[e].exec(t),n){const e=t.substring(0,n.index),o=t.substring(n.index).replace(n[n.length-1],(e=>(0,i.sha256)(e))),r=5;t=o.substring(r),a=`${a}${e}${o.substring(0,r)}`}}while(n);return a=`${a}${t}`,a}default:return}}function u(e,t=[]){if(e){0===t.length&&t.push(a.A4.Uri,a.A4.SmtpAddress,a.A4.IPV4Address,a.A4.IPv6Address,a.A4.PhoneNumber);for(const n of t)e=c(n,e)}return e}},82039:(e,t,n)=>{"use strict";n.d(t,{F:()=>a});var i=n(15317);class a{constructor(e,t){this.value=e,this.piiKind=t}static isPIIValue(e){return!!e&&"string"!=typeof e&&void 0!==e.scrub}scrub(){return(0,i.sha256)(JSON.stringify(this.value))}}},88476:(e,t,n)=>{"use strict";n.d(t,{p:()=>l});var i=n(13637),a=n(55997),o=n(38923),r=n(75068),s=n(31704);function l(e){return t=>(0,i.mG)(this,void 0,void 0,(function*(){var n;try{return yield e(t)}catch(e){if(e instanceof TypeError&&(null===(n=e.message)||void 0===n?void 0:n.toLowerCase())===s.gZ){const n=t.headers&&t.headers.cache;if(n&&-1!==n.indexOf("only-if-cached"))return{status:a.qb.GATEWAY_TIMEOUT};e=(0,o.Tr)(r.w5.RejectHttpError,r.jK.RemoteOperationFailed,"rejectHttpError",void 0,e.message)}throw e}}))}},9566:(e,t,n)=>{"use strict";n.d(t,{Db:()=>u,tC:()=>m,j$:()=>g});var i=n(13637),a=n(55997),o=n(31821),r=n(6766),s=n(1702),l=n(25966);const d="",c=/\/api\/chatsvc\/.*?\//;function u(e,t,n,o){let r=d;const s=o.newLogger("chat-service-redirect");return o=>c=>(0,i.mG)(this,void 0,void 0,(function*(){let i=0;for(;;){p(r)&&(r=yield g(t,n,s));const u=yield(0,l.G)(e(o),r)(Object.assign(Object.assign({},c),{headers:Object.assign(Object.assign({},c.headers),{BehaviorOverride:"redirectAs404"})})),{status:h,headers:{location:v}}=u;if(!v||h!==a.qb.NOT_FOUND)return h===a.qb.SERVICE_UNAVAILABLE||h===a.qb.BAD_GATEWAY?(r=d,u):u;if(i>=10)return u;if(r=m(v,s),r===d)return u;i+=1}}))}function m(e,t){let n;try{n=new URL(e)}catch(n){return t.error(`Location header ${e} is invalid: error message ${n.message}`),d}if("teams.microsoft.com"===n.hostname){const i=n.pathname.match(c);return i&&i[0]?`${n.origin}${i[0]}`:(t.error(`No match of chatServiceAfd 404 location with regex, url is ${e}`),d)}return t.log("Url is a ATM Url, use previous parsing strategy."),new URL("/",e).href}function g(e,t,n){return(0,i.mG)(this,void 0,void 0,(function*(){const{chatServiceHostOverrideUrl:i}=t.get(o.J.Test);if(i)return(a=i).endsWith("/")?a:`${a}/`;var a;if(function(e){var t,n;return null!==(n=null!==(t=e.get(o.J.Host).enableUseChatServiceAfd)&&void 0!==t?t:e.get(o.J.ChatService).useChatServiceAfd)&&void 0!==n?n:void 0}(t))try{return yield e(r.Pn.chatServiceAfd)}catch(t){if((0,s.B)(t))return n.warn("Flag useChatServiceAfd is set but chatServiceAfd was not found in the GTM table. Falling back to chatService."),e(r.Pn.chatService);throw t}return e(r.Pn.chatService)}))}function p(e){return e===d}},31704:(e,t,n)=>{"use strict";n.d(t,{EH:()=>i,gZ:()=>a,fI:()=>o,dX:()=>r});const i=3e4,a="failed to fetch",o=3e3,r="Request Timed Out"},1702:(e,t,n)=>{"use strict";n.d(t,{B:()=>a});var i=n(75068);function a(e){if(!e||"object"!=typeof e)return!1;const t=e;return t.code===i.jK.InvalidResponse&&"Discover"===t.context&&"regionGtm"===t.subContext}},91369:(e,t,n)=>{"use strict";n.d(t,{S:()=>s});var i=n(13637),a=n(55997),o=n(38923),r=n(75068);function s(e){return t=>(0,i.mG)(this,void 0,void 0,(function*(){const n=yield e(t);if(n.status>=a.qb.BAD_REQUEST)throw(0,o.Tr)(r.w5.RejectHttpError,r.jK.RemoteOperationFailed,"rejectHttpError",void 0,void 0,n);return n}))}},25966:(e,t,n)=>{"use strict";n.d(t,{G:()=>a});var i=n(13637);function a(e,t){return n=>{var{url:a}=n,o=(0,i._T)(n,["url"]);return e(Object.assign(Object.assign({},o),{url:new URL(a,t).href}))}}},33498:(e,t,n)=>{"use strict";n.d(t,{Gg:()=>f,UZ:()=>v});var i=n(75068),a=n(52766),o=n(49206),r=n(64452),s=n(70838),l=n(48712),d=n(10436),c=n(38704),u=n(70918),m=n(85950),g=n(97407),p=n(57756);const h=([e,t])=>(t&&e.do((()=>{}),(e=>{throw e})),e);function v(e,t){return(...n)=>(0,a.P)((()=>e(...n))).pipe(((e,t)=>{const n=e.pipe((0,r.R)(((e,n)=>e||!t(n)),!1)),i=e.pipe((0,s.P)(t),(0,l.V)(5e3));return(0,o.z)((0,d.i)(),(0,c.M)(n),(0,u.U)(h),(0,m.a)((e=>e.pipe((0,g.w)(i)))),(0,p.D)())})(t,y)).toPromise()}const S=e=>(e=>{switch(e){case i.eT.Disabled:case i.eT.Offline:return!1;default:return!0}})(e),f=e=>()=>S(e.getState()),y=e=>e},57924:(e,t,n)=>{"use strict";n.d(t,{s:()=>r,r:()=>s});var i=n(75068),a=n(84575),o=n(25118);function r(e,t){return n=>d((()=>e(n)),t)}function s(e,t){return n=>c(d((()=>e(n)),t),t)}const l=(e,t)=>{if(e.context===i.w5.RejectHttpError&&t.retryCount++<(t.policy.maxRetryCountForOffline||t.policy.maxRetryCount)&&t.policy.shouldRetryRejectHttpError)return t.policy.errorHandler(e,t);if(!e.serverResponse)throw e;const{serverResponse:{status:n}}=e;if(n&&t.retryCount++<t.policy.maxRetryCount&&t.policy.shouldRetry(n))return t.retriesTable[n]=(t.retriesTable[n]||0)+1,t.policy.errorHandler(e,t);throw e},d=(e,t)=>(0,a.X)(e,l)({policy:t,delay:t.createDelay(),retryCount:0,retriesTable:{}}),c=(e,t)=>(0,o.E)(e,t.retryMaxTimeMs)},10588:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(69887),a=n(25118),o=n(31704);const r=({url:e,method:t,body:n,headers:r,credentials:s,timeout:l=o.EH,skipHeaders:d=!1})=>{const c=new AbortController;return(0,a.E)(i(e,{method:t,headers:d?{}:r&&new Headers(r),body:n,credentials:s,signal:c.signal}),l,o.dX,c).then((e=>{const t={};return e.headers.forEach(((e,n)=>t[n]=e)),{status:e.status,headers:t,body:e,url:e.url}}))}},18838:(e,t,n)=>{"use strict";n.d(t,{l:()=>l});var i=n(18541),a=n(13637),o=n(96514);var r=n(10588),s=n(88476);const l=(0,i.E)(function(e){return t=>(0,a.mG)(this,void 0,void 0,(function*(){let i,a;const r=performance.now(),s=new Date;try{return a=yield e(t),a}catch(e){throw i=e.code||e.message,a=e.serverResponse,e}finally{const e=performance.now();!function(e,t,i,a,r){const s=n.g;(0,o.Lk)(a,t,i,e,e&&function(e){const t=performance.getEntriesByName(e);if(t.length>0&&"resource"===t[t.length-1].entryType)return t[t.length-1];return}(e.url),s,r)}(a,s,t,e-r,i)}}))}((0,s.p)(r.A)))},17968:(e,t,n)=>{"use strict";n.d(t,{Om:()=>s,Ng:()=>l});var i=n(34255),a=n(31821);const o=[{predicate:e=>!!e.get(a.J.Presence).enablePresenceInWorker,resolvers:{query:["presence","presences"],mutation:["setPresence","setStatusNote","setCallStatePresence"],subscription:["presenceUpdateEvent"]}},{predicate:e=>!!e.get(a.J.Host).enableEspInWorker||!!e.get(a.J.Esp).enableEsp,resolvers:{query:["espState","irisCampaign"],mutation:["recordEligibleSurface","recordDisplayedSurface","triggerNotificationDisplay"],subscription:["espTriggerEvent"]}},{predicate:e=>!!e.get(a.J.Guardians).enableMembersAndRelatedContactsWorkerResolver,resolvers:{query:["membersAndRelatedContacts"],mutation:[],subscription:[]}},{predicate:e=>!!e.get(a.J.Guardians).enableRelatedContactsWorkerResolver,resolvers:{query:["relatedContacts"],mutation:[],subscription:[]}},{predicate:e=>!!e.get(a.J.Host).enableHybridDiscoverSurface,resolvers:{query:["feed"],mutation:["feedback","discoverSurfaceUserPreferenceForEntities","removeHasUpdatedItemsFlag"],subscription:["replyChainSummaryEvent","discoverFeedHasUpdatedItems"]}},{predicate:e=>!!e.get(a.J.WhatsNew).enableWhatsNew,resolvers:{query:["whatsNewState"],mutation:["recordWhatsNewDisplayedFeature","recordWhatsNewEntryPointPromotion","recordWhatsNewEntryPointUserAction"],subscription:[]}}],r=[{predicate:e=>!!e.get(a.J.Host).enableOfflineActionsManager&&!!e.get(a.J.Host).msgEnableOfflineReactions,resolvers:{query:[],mutation:["updateMessageEmotion"],subscription:[]}},{predicate:e=>!!e.get(a.J.Messaging).msgEnableAutoSetConsumptionHorizonResolver,resolvers:{query:[],mutation:["setConsumptionHorizon"],subscription:[]}},{predicate:e=>!!e.get(a.J.Extensibility).enableAdaptiveAppletCacheFromCDL,resolvers:{query:[],mutation:["cardCacheOperation"],subscription:[]}}];function s(e,t){const{experimentalResolvers:n,stableResolvers:o}=e.get(a.J.Cdl),s=o&&o.resolvers||{query:[],mutation:[],subscription:[]};if(t.log(`Supported operations from config: ${JSON.stringify(s,c)}`),o&&o.version&&n&&n.version&&o.version>=n.version){const e=n.resolvers||{query:[],mutation:[],subscription:[]};t.log(`Supported operations from ECS: ${JSON.stringify(e,c)}`),(0,i.mergeWith)(s,e,u)}m(s,r,e,t);const l=(0,i.mapValues)(s,(e=>e?new Set(e):new Set)),{dataLayerSettings:g}=e.get(a.J.Host);return d(g,l,t,"Angular")}function l(e,t,n){const r=function(e,t){let n;try{if(!t)throw new Error("CDL Worker did not return supported operations");n=JSON.parse(t)}catch(t){e.error(`getWorkerSupportedOperations: Failed to set CDL Worker supported operations: ${t&&t.message}`),n={query:[],mutation:[],subscription:[]}}return(0,i.mapValues)(n,(e=>e?new Set(e):new Set))}(t,n),{supportedResolvers:s,activitySupportedResolvers:l,mtmaMissedNotificationsSupportedResolvers:c,calendarSupportedResolvers:g,chatSupportedResolvers:p,chatPartiallySupportedResolvers:h,peopleTargetingSupportedResolvers:v}=e.get(a.J.CdlWorker),S=function(e){const t={query:[],mutation:[],subscription:[]};return e.forEach((e=>e&&(0,i.mergeWith)(t,e,u))),t}([s,l,c,g,p,h,v]);return m(S,o,e,t),d(S,r,t,"Worker")}function d(e,t,n,a){if(!e)return{query:new Set,mutation:new Set,subscription:new Set};n.log(`Supported operations received from ${a}: ${JSON.stringify(e,c)}`);const o=(0,i.mapValues)(e,((e,n)=>new Set(e.filter((e=>t[n]&&t[n].has(e))))));return n.log(`Merged datalayer settings with config: ${JSON.stringify(o,c)}`),o}const c=(e,t)=>"object"==typeof t&&t instanceof Set?Array.from(t):t,u=(e,t)=>(0,i.isArray)(e)?e.concat(t):void 0;function m(e,t,n,a){const o={query:[],mutation:[],subscription:[]};t.forEach((({predicate:e,resolvers:t})=>{e(n)&&(0,i.mergeWith)(o,t,u)})),a.log(`Supported additional operations: ${JSON.stringify(o,c)}`),(0,i.mergeWith)(e,o,u)}},22596:(e,t,n)=>{"use strict";n.d(t,{zz:()=>d,nG:()=>l,Fj:()=>c});var i=n(38923),a=n(75068),o=n(34255);const r={parseFileLabelQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"parseFileLabelFromUrl"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ParseFileLabelFromUrlInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"parseFileLabelFromUrl"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileLabel"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"linktype"}}]}}]}}]}}]},fileDetailsForChicletQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDetailsForChiclet"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FileDetailsForChicletInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDetailsForChiclet"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}},{kind:"Field",name:{kind:"Name",value:"fileSourceDetail"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileSource"}}]}}]}}]}}]}}]},fetchShareInfoQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fetchShareInfo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"redeemFileInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"RedeemFileInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"redeemFile"},arguments:[{kind:"Argument",name:{kind:"Name",value:"redeemFileInput"},value:{kind:"Variable",name:{kind:"Name",value:"redeemFileInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"downloadUrl"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}},{kind:"Field",name:{kind:"Name",value:"sharepointIds"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"siteUrl"}}]}}]}}]}}]},currentFilesQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getFiles"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fileContainerId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currentFiles"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fileContainerId"},value:{kind:"Variable",name:{kind:"Name",value:"fileContainerId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"progress"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"isReferencedFile"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"previewUrl"}},{kind:"Field",name:{kind:"Name",value:"previewHeight"}},{kind:"Field",name:{kind:"Name",value:"previewWidth"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"progressComplete"}},{kind:"Field",name:{kind:"Name",value:"permissionScope"}},{kind:"Field",name:{kind:"Name",value:"hasUploadFailed"}},{kind:"Field",name:{kind:"Name",value:"serviceName"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"chicletBreadcrumbs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sourceTeamName"}},{kind:"Field",name:{kind:"Name",value:"sourceChannelName"}}]}},{kind:"Field",name:{kind:"Name",value:"externalFileShareInfo"}}]}}]}}]},userPreferencesQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPersonalSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filesSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileOpenPreference"}},{kind:"Field",name:{kind:"Name",value:"nonFileOpenPreferenceSelectedCount"}}]}}]}}]}}]}}]},fileShareDialogAudience:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"shareDialogAudience"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shareDialogAudienceInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ShareDialogAudienceInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shareDialogAudience"},arguments:[{kind:"Argument",name:{kind:"Name",value:"shareDialogAudienceInput"},value:{kind:"Variable",name:{kind:"Name",value:"shareDialogAudienceInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"recipients"}},{kind:"Field",name:{kind:"Name",value:"audienceConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityName"}},{kind:"Field",name:{kind:"Name",value:"audienceType"}}]}}]}}]}}]},fileDetailsByIdQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDetailsById"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"redeemFileByIdInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"RedeemFileByIdInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"redeemFileById"},arguments:[{kind:"Argument",name:{kind:"Name",value:"redeemFileByIdInput"},value:{kind:"Variable",name:{kind:"Name",value:"redeemFileByIdInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"downloadUrl"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}}]}}]}}]},fileDetailsWithSharepointIdQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDetailsWithSharepointId"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fileDetailsWithSharepointIdInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FileDetailsWithSharepointIdInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDetailsWithSharepointId"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fileDetailsWithSharepointIdInput"},value:{kind:"Variable",name:{kind:"Name",value:"fileDetailsWithSharepointIdInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}},{kind:"Field",name:{kind:"Name",value:"sharepointIds"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"listItemUniqueId"}}]}}]}}]}}]},fileDetailsForThumbnailQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientFilesFileRedeemThumbnailQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"redeemFileInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"RedeemFileInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDetailsForThumbnail"},arguments:[{kind:"Argument",name:{kind:"Name",value:"redeemFileInput"},value:{kind:"Variable",name:{kind:"Name",value:"redeemFileInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"webUrl"}},{kind:"Field",name:{kind:"Name",value:"size"}},{kind:"Field",name:{kind:"Name",value:"eTag"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}},{kind:"Field",name:{kind:"Name",value:"downloadUrl"}},{kind:"Field",name:{kind:"Name",value:"odataContext"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"parentReference"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"driveId"}},{kind:"Field",name:{kind:"Name",value:"driveType"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"path"}}]}},{kind:"Field",name:{kind:"Name",value:"cTag"}},{kind:"Field",name:{kind:"Name",value:"sharepointIds"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"listId"}},{kind:"Field",name:{kind:"Name",value:"listItemId"}},{kind:"Field",name:{kind:"Name",value:"listItemUniqueId"}},{kind:"Field",name:{kind:"Name",value:"siteId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"syncResourceId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"webId"}}]}},{kind:"Field",name:{kind:"Name",value:"thumbnails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"small"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"medium"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"large"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"file"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mimeType"}},{kind:"Field",name:{kind:"Name",value:"irmEnabled"}}]}},{kind:"Field",name:{kind:"Name",value:"fileSystemInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createdDateTime"}},{kind:"Field",name:{kind:"Name",value:"lastModifiedDateTime"}}]}},{kind:"Field",name:{kind:"Name",value:"shared"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"effectiveRoles"}},{kind:"Field",name:{kind:"Name",value:"scope"}}]}}]}}]}}]},openInDesktopAsDeviceSpecificFileOpenPreferenceQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"openInDesktopAsDeviceSpecificFileOpenPreference"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"openInDesktopAsDeviceSpecificFileOpenPreference"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isDesktopSetAsDefaultFileOpenPreference"}}]}}]}}]}},s=(e,t)=>{let n=null;try{n=e.readQuery({query:r.currentFilesQuery,variables:{fileContainerId:t}})}catch(e){}if(!n)throw new Error("Expected initial files to be populated before a command is executed");return n.currentFiles},l=(e,t,n)=>s(n,t).find((t=>t.id===e)),d=(e,t,n)=>{const i={currentFiles:[...s(t,n).map((t=>{const n=e.findIndex((e=>e.id===t.id));if(-1===n)return t;const i=e[n];e.splice(n,1);return(0,o.merge)({},t,i)})),...e]};t.writeQuery({query:r.currentFilesQuery,variables:{fileContainerId:n},data:i})},c=(e,t,n)=>{const o=s(n,t),l=o.find((t=>t.id===e));if(!l)throw(0,i.Tr)("FileUploadResolver",a.jK.NotPresent,"removecachefile",{logErrorMessage:`File with id: ${e} not found  in the cache`});const d=o.filter((t=>t.id!==e));return n.writeQuery({query:r.currentFilesQuery,variables:{fileContainerId:t},data:{currentFiles:d}}),l}},87348:(e,t,n)=>{"use strict";n.r(t),n.d(t,{clientResolvers:()=>i.w,resolvers:()=>o,typeDefs:()=>s,useActiveWindow:()=>r.M,writeWindowsDefaults:()=>a.k});var i=n(34507),a=n(44126);const o={Subscription:{windowStateEvent:{subscribe:(e,{windowId:t},{pubsub:n})=>n.asyncIterator(`windowStateEvent-${t}`)}}};var r=n(10976),s=n(88258)},10976:(e,t,n)=>{"use strict";n.d(t,{M:()=>o});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindow"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}}]}}]}}]};var a=n(81822);const o=e=>{const{data:t,error:n,loading:o}=(0,a.a)(i,{variables:{windowId:e}});if(t&&!n&&!o)return t.activeWindow}},34507:(e,t,n)=>{"use strict";n.d(t,{w:()=>m});var i=n(41790),a=n(31821),o=n(40797),r=n(54455);const s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"clientDataQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}}]}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataClientWindowsClientDataFragment_activeEntities"}}]}},{kind:"Field",name:{kind:"Name",value:"windowHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataClientWindowsClientDataFragment_activeEntities"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}},{kind:"Field",name:{kind:"Name",value:"layoutConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"layoutMode"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"callingDebugTool"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visible"}},{kind:"Field",name:{kind:"Name",value:"passiveBarHiddenParticipantsCount"}}]}},{kind:"Field",name:{kind:"Name",value:"streamPermissionsDebug"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"acknowledgementRequired"}},{kind:"Field",name:{kind:"Name",value:"acknowledged"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}},{kind:"Field",name:{kind:"Name",value:"DebugConversation"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"chatSubType"}}]}},{kind:"Field",name:{kind:"Name",value:"activeCalls"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"teamsCallId"}},{kind:"Field",name:{kind:"Name",value:"callUrl"}},{kind:"Field",name:{kind:"Name",value:"expiration"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"callInitiator"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"replyChainMessageId"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}}]}},{kind:"Field",name:{kind:"Name",value:"activeMeetings"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"isTeamsMeeting"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"eventId"}},{kind:"Field",name:{kind:"Name",value:"useCalUid"}},{kind:"Field",name:{kind:"Name",value:"modifiedStamp"}},{kind:"Field",name:{kind:"Name",value:"scheduleType"}}]}},{kind:"Field",name:{kind:"Name",value:"recentMeetings"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"isTeamsMeeting"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"eventId"}},{kind:"Field",name:{kind:"Name",value:"useCalUid"}},{kind:"Field",name:{kind:"Name",value:"modifiedStamp"}},{kind:"Field",name:{kind:"Name",value:"scheduleType"}}]}},{kind:"Field",name:{kind:"Name",value:"pinnedMeetings"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"isTeamsMeeting"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"eventId"}},{kind:"Field",name:{kind:"Name",value:"useCalUid"}},{kind:"Field",name:{kind:"Name",value:"modifiedStamp"}},{kind:"Field",name:{kind:"Name",value:"scheduleType"}}]}},{kind:"Field",name:{kind:"Name",value:"pptSharingSession"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"sessionSlide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"slideIndex"}},{kind:"Field",name:{kind:"Name",value:"timelineMappings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"step"}},{kind:"Field",name:{kind:"Name",value:"timelineId"}},{kind:"Field",name:{kind:"Name",value:"lastClickTime"}},{kind:"Field",name:{kind:"Name",value:"startTimeOffset"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"localSlide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"slideIndex"}},{kind:"Field",name:{kind:"Name",value:"timelineMappings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"step"}},{kind:"Field",name:{kind:"Name",value:"timelineId"}},{kind:"Field",name:{kind:"Name",value:"lastClickTime"}},{kind:"Field",name:{kind:"Name",value:"startTimeOffset"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"slidesCount"}},{kind:"Field",name:{kind:"Name",value:"mode"}},{kind:"Field",name:{kind:"Name",value:"privateViewingEnabled"}}]}},{kind:"Field",name:{kind:"Name",value:"whiteboardSharingSession"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"content"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"mode"}}]}},{kind:"Field",name:{kind:"Name",value:"deletedMessages"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"message"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"fromLanguage"}}]}},{kind:"Field",name:{kind:"Name",value:"diagnosticInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"diagnosticErrorCode"}},{kind:"Field",name:{kind:"Name",value:"diagnosticMessage"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"lpcState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLivePersonaCardInitialized"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientWindowsClientDataFragment_activeEntities"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ActiveEntities"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataClientWindowsClientDataFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataClientWindowsClientDataFragment_entity"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientWindowsClientDataFragment_entity"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"linkedEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}.definitions]};var l=n(82250),d=n(34255);function c(e,t,n=!0){var a;let o=[];try{const t=e.readQuery({query:i.i8});o=null!==(a=null==t?void 0:t.activeWindows)&&void 0!==a?a:o}catch(e){t.warn(`cache.readQuery failed for activeWindowsQuery with ${e}`)}return n?(0,d.cloneDeep)(o):o}function u(e,t,n,i){if(0===c(t,i).length){const i=n.newScenario(l.RG.GarbageCollection);return function(e,t){var n,i,a,o;const l=t.watch({query:s,optimistic:!1,callback(){}}),d=(0,r.aw)(Object.assign({apolloLeakOptions:{leakDetector:e,windowId:null===(n=t.apolloLeakInfo)||void 0===n?void 0:n.apolloLeakInfoWindowId,entityType:null===(i=t.apolloLeakInfo)||void 0===i?void 0:i.apolloLeakInfoEntityType,viewportContext:null===(a=t.apolloLeakInfo)||void 0===a?void 0:a.apolloLeakInfoViewportContext,userContextId:null===(o=t.apolloLeakInfo)||void 0===o?void 0:o.apolloLeakInfoUserContextId}},t.config)),c=Array.from(t.watches);for(const e of c){const n=t.diff(Object.assign(Object.assign({},e),{returnPartialData:!0}));if(n.complete){const t=n.result;d.writeQuery(Object.assign(Object.assign({},e),{data:t}))}}const u=d.extract();t.restore(u),l()}(e,t),i.stop(),!0}return!1}const m=()=>({Query:{activeWindows:(e,t,{cache:n,loggerFactory:i})=>c(n,i.newLogger("activeWindows-query"),!1)},Mutation:{removeWindow(e,{windowId:t},{cache:n,loggerFactory:a,commandChangeReportingService:r}){const s=a.newLogger("removeWindow-mutation"),l=c(n,s),d=l.findIndex((e=>e.id===t));if(d>=0){const e=function(e,t,n){const a=e.splice(t,1);return n.writeQuery({query:i.i8,data:{activeWindows:e}}),a[0]}(l,d,n);return r.report({type:o.B.Close,correlationId:e.correlation.id,context:{target:"remove-window-mutation"}}),e}return s.warn(`Removing window that does not exist ${t}`),null},runGarbageCollection(e,t,{cache:n,coreSettings:i,leakDetectorService:o,loggerFactory:r,scenarioFactory:s}){if(function(e){const{enableGarbageCollection:t}=e.get(a.J.Core);return t}(i)){const e=r.newLogger("runGarbageCollection-mutation");return u(null==o?void 0:o.create(),n,s,e)}return!1}}})},44126:(e,t,n)=>{"use strict";n.d(t,{k:()=>a});var i=n(41790);function a(e){e.writeQuery({query:i.i8,data:{activeWindows:[]}})}},89925:(e,t,n)=>{"use strict";var i,a,o,r,s,l,d,c,u,m,g,p,h,v,S,f,y,k,C,b,T,w,_,I,A,N,E,D,F,P,M,j,R,x,O,L,U,B,W,G,V,H,$,z,q,J,Q,K,Y,X,Z,ee,te,ne,ie,ae,oe,re,se,le,de,ce,ue,me,ge,pe,he,ve,Se,fe,ye,ke,Ce,be,Te,we,_e,Ie,Ae,Ne,Ee,De,Fe,Pe,Me,je,Re,xe,Oe,Le,Ue,Be,We,Ge,Ve,He,$e,ze,qe,Je,Qe,Ke,Ye,Xe,Ze,et,tt,nt,it,at,ot,rt,st,lt,dt,ct,ut,mt,gt,pt,ht,vt,St,ft,yt,kt,Ct,bt,Tt,wt,_t,It,At,Nt,Et,Dt,Ft,Pt,Mt,jt,Rt,xt,Ot,Lt,Ut,Bt,Wt,Gt,Vt,Ht,$t,zt,qt,Jt,Qt,Kt,Yt,Xt,Zt,en,tn,nn,an,on,rn,sn,ln,dn,cn,un,mn,gn,pn,hn,vn,Sn,fn,yn,kn,Cn,bn,Tn,wn,_n,In,An,Nn,En,Dn,Fn,Pn,Mn,jn,Rn,xn,On,Ln,Un,Bn,Wn,Gn,Vn,Hn,$n,zn,qn,Jn,Qn,Kn,Yn,Xn,Zn,ei,ti,ni,ii,ai,oi,ri,si,li,di,ci,ui,mi,gi,pi,hi,vi,Si,fi,yi,ki,Ci,bi,Ti,wi,_i,Ii,Ai,Ni,Ei,Di,Fi,Pi,Mi,ji,Ri,xi,Oi,Li,Ui,Bi,Wi,Gi,Vi,Hi,$i,zi,qi,Ji,Qi,Ki,Yi,Xi,Zi,ea,ta,na,ia,aa,oa,ra,sa,la,da,ca,ua,ma,ga,pa,ha,va,Sa,fa,ya,ka,Ca,ba,Ta,wa,_a,Ia,Aa,Na,Ea,Da,Fa,Pa,Ma,ja,Ra,xa,Oa,La,Ua,Ba,Wa,Ga,Va,Ha,$a,za,qa,Ja,Qa,Ka,Ya,Xa,Za,eo,to,no,io,ao,oo,ro,so,lo,co,uo,mo,go,po,ho,vo,So,fo,yo,ko,Co,bo,To,wo,_o,Io,Ao,No,Eo,Do,Fo,Po,Mo,jo,Ro,xo,Oo,Lo,Uo,Bo,Wo,Go,Vo,Ho,$o,zo,qo,Jo,Qo,Ko,Yo,Xo,Zo,er,tr,nr,ir,ar,or,rr,sr,lr,dr,cr,ur,mr,gr,pr,hr,vr,Sr,fr,yr,kr,Cr,br,Tr,wr,_r,Ir,Ar,Nr,Er,Dr,Fr,Pr,Mr,jr,Rr,xr,Or,Lr,Ur,Br,Wr,Gr,Vr,Hr,$r,zr,qr,Jr,Qr,Kr,Yr,Xr,Zr,es,ts,ns,is,as,os,rs,ss,ls,ds,cs,us,ms,gs,ps,hs,vs,Ss,fs,ys,ks,Cs,bs,Ts,ws,_s,Is,As,Ns,Es,Ds,Fs,Ps,Ms,js,Rs,xs,Os,Ls,Us,Bs,Ws,Gs,Vs,Hs,$s,zs,qs,Js,Qs,Ks,Ys,Xs,Zs,el,tl,nl,il,al,ol,rl,sl,ll,dl,cl,ul,ml,gl,pl,hl,vl,Sl,fl,yl,kl,Cl,bl,Tl,wl,_l,Il,Al,Nl,El,Dl,Fl,Pl,Ml,jl,Rl,xl,Ol,Ll,Ul,Bl,Wl,Gl,Vl,Hl,$l,zl,ql,Jl,Ql,Kl,Yl,Xl,Zl,ed,td,nd,id,ad,od,rd,sd,ld,dd,cd;n.r(t),n.d(t,{ParticipantChangeType:()=>i,CallPptSharingChangeSlideAction:()=>a,AllowVoicemail:()=>o,TeamsCameraFarEndPanTiltZoomControlMode:()=>r,VideoEffectReadinessOnDevice:()=>s,WindowsEffects:()=>l,WindowsEffectsStates:()=>d,CustomLayoutSelection:()=>c,SubStageType:()=>u,CallingServiceEntrypointType:()=>m,DisposeReason:()=>g,DisposeSource:()=>p,AnnotationEventType:()=>h,CallRecordingState:()=>v,CallLocalRecordingState:()=>S,CallVoiceCollectionState:()=>f,CallTranscriptState:()=>y,MeetingRoomRemoteControlLayoutType:()=>k,CallingScreenGalleryType:()=>C,CortanaState:()=>b,ToggleHoldCallContext:()=>T,ScreenShareControlState:()=>w,MeetingRoomDefaultFoRLayoutType:()=>_,FrontRowVideoSize:()=>I,FrontRowDefaultPanelType:()=>A,FrameSinkEventType:()=>N,CallingAppEventSourceName:()=>E,SettingsPaneCategory:()=>D,CallingContentActionVisibility:()=>F,WindowingCoordsType:()=>P,WindowingMode:()=>M,WindowingLinkedContentType:()=>j,BannerAction:()=>R,BannerName:()=>x,CommandSource:()=>O,DialogContentType:()=>L,DialogAction:()=>U,DialogName:()=>B,ToastType:()=>W,NotificationType:()=>G,CallingAppEventResolutionSourceName:()=>V,RoomRemoteStageLayoutControlsCapabilities:()=>H,RoomRemoteMeetingControlsCapabilities:()=>$,RoomRemoteMediaControlsCapabilities:()=>z,ThirdPartyDevicePairingResult:()=>q,HolographicInteractionComponent:()=>J,CallingServiceState:()=>Q,CallGroupNotification:()=>K,AltScenarioAction:()=>Y,CallGroupNotificationOverride:()=>X,CallRefreshSettingsType:()=>Z,MuteAllScope:()=>ee,SettingsPanelTab:()=>te,SettingsPanelTabElement:()=>ne,CallRedirectionTargetType:()=>ie,InteractionCommand:()=>ae,MessageLanguageStatus:()=>oe,PhoneNumberFormat:()=>re,ConsultMode:()=>se,BuddyGroupType:()=>le,UpdateDelegatesAction:()=>de,ContactDataSource:()=>ce,UserClassification:()=>ue,ScdStatus:()=>me,VideoBackgroundImageState:()=>ge,BackgroundImageContext:()=>pe,ScalingMode:()=>he,CreateCompositorContext:()=>ve,CallClosedCaptionsStatus:()=>Se,ParkContext:()=>fe,ContentCameraType:()=>ye,PhoneNumberType:()=>ke,MeetingRoomAppState:()=>Ce,MeetingRoomMeetingLinkUrlSource:()=>be,SharePreviewType:()=>Te,OverflowRoomCallState:()=>we,SystemAudioDriverState:()=>_e,ClosedCaptionsTextTrackSource:()=>Ie,EnvironmentSupport:()=>Ae,StreamingAppState:()=>Ne,AppDevicePermissionType:()=>Ee,ParticipantState:()=>De,DevicesMeetingType:()=>Fe,CompositorRenderType:()=>Pe,ComplianceRecordingState:()=>Me,ContactsSyncSource:()=>je,ContactsSyncError:()=>Re,ContactsSyncWorkflowStatus:()=>xe,GestureBasedReactionServiceState:()=>Oe,MeetingRoomThemeName:()=>Le,CustomAppType:()=>Ue,SchedulingFormTaskType:()=>Be,SchedulingFormTaskState:()=>We,MeetingRoomFrontOfRoomCallPanel:()=>Ge,SchedulingFormTerminatingActionType:()=>Ve,DebugBroadcastStateStatus:()=>He,DebugBroadcastParticipantRole:()=>$e,CurrentCallingState:()=>ze,PptSharingMode:()=>qe,TranslationStatus:()=>Je,ChatDisabledContextReason:()=>Qe,DeviceTypeInput:()=>Ke,QuestionnaireItemType:()=>Ye,FeedbackType:()=>Xe,FeedbackCallType:()=>Ze,AppInstallScope:()=>et,MeetingSurface:()=>tt,ConfigurableTabContext:()=>nt,StaticTabContext:()=>it,CalendarSyncStatusEnum:()=>at,DisallowedToPostReason:()=>ot,CalendarMeetingScheduleType:()=>rt,ClientChannelType:()=>st,TeamMemberRole:()=>lt,ChannelPostPermissions:()=>dt,GeneralChannelPosting:()=>ct,LocationType:()=>ut,CalendarAppointmentType:()=>mt,AvailabilityFreeBusyType:()=>gt,LayoutType:()=>pt,StatusBarMessageType:()=>ht,EntityType:()=>vt,EntityAction:()=>St,EntityVisibilityState:()=>ft,EntityStateTransition:()=>yt,SupportedViewEntities:()=>kt,LayoutModes:()=>Ct,NavigationDirection:()=>bt,CorrelationSourceHint:()=>Tt,AppRenderMode:()=>wt,SlotName:()=>_t,ExtendedContainerState:()=>It,MeetingRoomLayoutSelection:()=>At,StaticTabId:()=>Nt,VideoScanType:()=>Et,BroadcastStreamType:()=>Dt,BroadcastLayoutType:()=>Ft,CaptionFontSizeType:()=>Pt,BroadcastSectionType:()=>Mt,StreamType:()=>jt,DisplayWaterMark:()=>Rt,FluidSourceType:()=>xt,FluidContextType:()=>Ot,PlatformAppsFetchSource:()=>Lt,DebugBroadcastType:()=>Ut,BreakoutRoomActionState:()=>Bt,FileViewServiceName:()=>Wt,BreakoutRoomsAssignmentType:()=>Gt,BreakoutRoomsCreationStatus:()=>Vt,BreakoutRoomsSettingsStatus:()=>Ht,TaskModuleEntryPoints:()=>$t,TaskModuleClosedReason:()=>zt,VideoEffect:()=>qt,VideoEffectStateType:()=>Jt,WebinarAccessPolicy:()=>Qt,WebinarQuestionnaireType:()=>Kt,RegistrationOperationType:()=>Yt,CallParticipantKind:()=>Xt,SchedulingServiceMeetingPromiseState:()=>Zt,AttachmentType:()=>en,AttendeeType:()=>tn,UserRole:()=>nn,AttendeeGroupType:()=>an,MeetingAgendaType:()=>on,MeetingAgendaHostClient:()=>rn,MeetingAgendaState:()=>sn,PinnedConversationItemType:()=>ln,VideoAppPostMessageEvent:()=>dn,AppointmentType:()=>cn,AppDevicePermissionsUpdatedStatus:()=>un,VirtualEventAction:()=>mn,CommandActions:()=>gn,PtzControlCommand:()=>pn,TranscriptEditType:()=>hn,TranscriptDownloadFormat:()=>vn,LinkScopeInput:()=>Sn,LinkTypeInput:()=>fn,MediaEventType:()=>yn,VideoRotationDegree:()=>kn,TeamLayoutPreferenceOptions:()=>Cn,SystemAudioSupport:()=>bn,EmergencyLocationType:()=>Tn,PtzErrorReason:()=>wn,PtzSessionTerminatedReason:()=>_n,CallCoachStatus:()=>In,CallClosedCaptionStatus:()=>An,ArtifactType:()=>Nn,ActionItemsModelInsightType:()=>En,ActionItemConfidence:()=>Dn,ActionItemOwnershipType:()=>Fn,TranslationStatusV2:()=>Pn,CardCacheOperationType:()=>Mn,ScreenSharingControlStateAsViewer:()=>jn,SharingSourceType:()=>Rn,BroadcastStatus:()=>xn,CallAbortReason:()=>On,NoiseSuppressionSupport:()=>Ln,NoiseSuppressionMode:()=>Un,CallingIntentType:()=>Bn,MeetingJoinType:()=>Wn,AudioUsageMode:()=>Gn,MeetingArtifactType:()=>Vn,ClientDeviceType:()=>Hn,StreamDeliveryPipelineType:()=>$n,BotSourceType:()=>zn,StreamLabel:()=>qn,RoomBookingType:()=>Jn,PlaceType:()=>Qn,Availability:()=>Kn,Activity:()=>Yn,UserFlwPresence:()=>Xn,ChatType:()=>Zn,InteropConversationStatus:()=>ei,PresenceLocationType:()=>ti,MeetingChatPolicy:()=>ni,DisableReasonCode:()=>ii,ClaimedConversationImportState:()=>ai,ConversationMemberRole:()=>oi,MessageRenderType:()=>ri,MessageAttachedType:()=>si,DeeplinkedMessageState:()=>li,MeetingType:()=>di,EscalationModality:()=>ci,MessageStatus:()=>ui,MessageImportance:()=>mi,MessageReplyPermissions:()=>gi,PostType:()=>pi,SmsDeliveryReportKey:()=>hi,CallAction:()=>vi,CallLogSessionType:()=>Si,CallLogCallType:()=>fi,CallLogCallState:()=>yi,CallDirection:()=>ki,CallLogTransferStatus:()=>Ci,CallForwardingType:()=>bi,CallForwardingTargetType:()=>Ti,BusyOnBusyOptions:()=>wi,RingtoneCallType:()=>_i,RingtoneNames:()=>Ii,CalendarErrorCode:()=>Ai,MeetingArtifactResourceType:()=>Ni,LeftRailSettingsCalendarType:()=>Ei,BroadcastMeetingAccessLevel:()=>Di,FreeBusyType:()=>Fi,MeetingResponseType:()=>Pi,MeetingAttendanceType:()=>Mi,MeetingStatus:()=>ji,PhoneType:()=>Ri,EventActionType:()=>xi,TeamType:()=>Oi,TeamAccessType:()=>Li,ChannelType:()=>Ui,TeamLockState:()=>Bi,GiphyRatingType:()=>Wi,PinOperation:()=>Gi,ChannelSystemMessageRoleUpdateType:()=>Vi,ChannelReplyPermissions:()=>Hi,ChannelPinPostPermissions:()=>$i,AllowedSenderType:()=>zi,PolicyViolationType:()=>qi,FileChicletState:()=>Ji,DeepLinkChicletState:()=>Qi,DeviceType:()=>Ki,AlertSeverity:()=>Yi,AlertActionType:()=>Xi,AlertType:()=>Zi,PptSharingSource:()=>ea,ShareableContentType:()=>ta,CallDeviceShortcutType:()=>na,SharingLayoutMode:()=>ia,PptSharingContentMode:()=>aa,WhiteboardSharingContentMode:()=>oa,CallAppContentSharingMode:()=>ra,CallTranscriptEntryType:()=>sa,BroadcastParticipantRole:()=>la,PresenceSource:()=>da,StatusNoteExpiry:()=>ca,AppPermissionNodeType:()=>ua,AppDefaultInstallScope:()=>ma,AppGroupCapability:()=>ga,ExtensionPointTypes:()=>pa,ElementType:()=>ha,PlatformAppPermission:()=>va,MessageExtensionCommandType:()=>Sa,MessageExtensionCommandContextType:()=>fa,MessageExtensionInputType:()=>ya,MeetingReactionType:()=>ka,GestureReactionType:()=>Ca,GestureReactionStatus:()=>ba,UserRoleInEmergencyCall:()=>Ta,UserRoleInConsultCall:()=>wa,HolographicDeviceType:()=>_a,MeetingPanelLocation:()=>Ia,CallHealthState:()=>Aa,VirtualDesktopInfrastructureConnectedState:()=>Na,FilesProviderType:()=>Ea,ExternalCloudStorageProviderCode:()=>Da,FilesNavigationType:()=>Fa,SharePointFileSpecialDocumentLibraryType:()=>Pa,SharePointFileDocumentLibraryAccessType:()=>Ma,MessageImportanceInGraphFormat:()=>ja,ActiveContextType:()=>Ra,UserIdentityType:()=>xa,ApplicationIdentityType:()=>Oa,ConversationIdentityType:()=>La,ContentType:()=>Ua,ReactionType:()=>Ba,MeetingOptionsUserType:()=>Wa,OptionValueType:()=>Ga,OptionExternalFeedType:()=>Va,OptionInterpretationType:()=>Ha,OptionPersonType:()=>$a,ConnectedCalendarSource:()=>za,SortColumn:()=>qa,SortDirection:()=>Ja,RecorderOption:()=>Qa,BannerNotificationIntentLevel:()=>Ka,AttendeeRestrictableModality:()=>Ya,ChannelCrossPostStatus:()=>Xa,AmsItemType:()=>Za,AppServiceState:()=>eo,AuthenticationAccountType:()=>to,AuthenticationCloudType:()=>no,AuthenticationUserRole:()=>io,AuthenticationUserSubType:()=>ao,AuthenticationState:()=>oo,UserAuthState:()=>ro,BroadcastType:()=>so,CalendarAvailabilityType:()=>lo,SuggestionTimeQuality:()=>co,SchedulingServiceEventType:()=>uo,SharingEntityType:()=>mo,MeetingRecommendationEntityType:()=>go,ProvenanceType:()=>po,RelevanceRelationshipType:()=>ho,CalendarFormSlotType:()=>vo,CalendarFormErrorType:()=>So,CalendarEventSelectFields:()=>fo,CallBlockingAction:()=>yo,TranslationRequestState:()=>ko,BlobType:()=>Co,ExperienceAccountMode:()=>bo,FileAttachSuggestionSource:()=>To,LinkType:()=>wo,FileUploadStatus:()=>_o,CreateLinkType:()=>Io,PermissionScope:()=>Ao,OneDriveItemType:()=>No,AudienceType:()=>Eo,VideoFileStatus:()=>Do,VideoMessageCaptionStatus:()=>Fo,LiveStreamPlaybackState:()=>Po,LiveStreamPlaybackError:()=>Mo,BroadcastPlayerType:()=>jo,TeamsForCourseStatus:()=>Ro,CourseMembersAndOwnersStatus:()=>xo,MeetAppTopic:()=>Oo,MeetAppEventResponse:()=>Lo,MeetAppTranscriptFragmentSource:()=>Uo,MeetAppScenario:()=>Bo,MeetAppAction:()=>Wo,MeetAppEventInsightSource:()=>Go,MeetForWorkRecurrencePatternType:()=>Vo,MeetForWorkWeekDay:()=>Ho,MeetingOptionsError:()=>$o,MeetingOptionsPredicateOperator:()=>zo,MessageSize:()=>qo,TranslationFeedbackType:()=>Jo,SurveyFieldType:()=>Qo,FeedbackService:()=>Ko,VirtualEventType:()=>Yo,VirtualEventState:()=>Xo,VirtualEventAccessType:()=>Zo,VirtualEventRoleType:()=>er,VirtualEventRecurrenceType:()=>tr,RegistrationQuestionCategory:()=>nr,RegistrationQuestionType:()=>ir,AttendeeRegistrationStatus:()=>ar,ApprovalAction:()=>or,VirtualEventEmailTemplateType:()=>rr,WebinarStatus:()=>sr,WebinarParticipantRole:()=>lr,WebinarField:()=>dr,SettingsComponentType:()=>cr,SettingsComponentLayoutType:()=>ur,WidgetType:()=>mr,ActionType:()=>gr,SettingsCategory:()=>pr,StaticImageType:()=>hr,AvatarMediaType:()=>vr,LocaleParamsType:()=>Sr,FeedbackActionType:()=>fr,AiInsightsOperationType:()=>yr,AppReviewsFilter:()=>kr,AppReviewsSort:()=>Cr,AppReviewSource:()=>br,AppReviewReportCategory:()=>Tr,AppCapability:()=>wr,AppInstallationStates:()=>_r,InstalledAppsUpdateEventType:()=>Ir,TaskModuleUpdateType:()=>Ar,InstalledAppSortType:()=>Nr,BiometricVoiceEnrollmentStatus:()=>Er,MessageExtensionInvokeCacheFetchPolicy:()=>Dr,Theme:()=>Fr,BotMessagePreviewAction:()=>Pr,AttachmentLayout:()=>Mr,ResultTypes:()=>jr,BotConfigResultTypes:()=>Rr,CommandContext:()=>xr,BotAuthResultType:()=>Or,AppBasedLinkAppResultType:()=>Lr,AppBasedLinkCachePolicyType:()=>Ur,AppBasedLinkPreviewType:()=>Br,CalendarEventType:()=>Wr,MembershipType:()=>Gr,ChannelMessageEventType:()=>Vr,GuardiansAnnouncementStatus:()=>Hr,ParentsAnnouncementsStatus:()=>$r,LoadDirection:()=>zr,ChatTypeFilter:()=>qr,EmotionKey:()=>Jr,EmotionAction:()=>Qr,ChatListEventType:()=>Kr,TranslationAction:()=>Yr,SendMessageAction:()=>Xr,ReportConcernReason:()=>Zr,ReportConcernContext:()=>es,ClosedCaptionsSettingsCaptionColorType:()=>ts,ClosedCaptionsSettingsCaptionHeightType:()=>ns,ClosedCaptionsSettingsPositionType:()=>is,ClosedCaptionsSettingsFontSizeType:()=>as,TeamsCollabContextType:()=>os,UserMeetingRole:()=>rs,ContainerState:()=>ss,TokenType:()=>ls,ComposeLanguagePromptEvent:()=>ds,SyncBannerUserActionType:()=>cs,FeedbackSignalType:()=>us,DeltaRequestMode:()=>ms,TeamsChannelPostInclusionReasonDetailedInclusionReasonEnum:()=>gs,DiscoverSurfaceUserPreferenceEntity:()=>ps,DiscoverSurfaceScopeForPreference:()=>hs,DiscoverSurfacePreference:()=>vs,ActorToItemRelationshipType:()=>Ss,DlResultError:()=>fs,VirtualEventsOrgProvisioningStatus:()=>ys,EngagementSurface:()=>ks,EspTrigger:()=>Cs,EspResourceType:()=>bs,EspPosition:()=>Ts,EspAlignment:()=>ws,EspModalImageStyling:()=>_s,EspActionType:()=>Is,EspExternalTelemetryType:()=>As,ExternalAccountProvider:()=>Ns,ConnectedAccountRequestSource:()=>Es,SpecialFolderName:()=>Ds,TeacherAnnouncementsChatIdError:()=>Fs,MembersAndRelatedContactsError:()=>Ps,RelatedContactStatus:()=>Ms,RelatedContactError:()=>js,RedeemIssueType:()=>Rs,InviteLinkType:()=>xs,Density:()=>Os,FlyoutCameraUserChoice:()=>Ls,InfoPaneState:()=>Us,UserTheme:()=>Bs,UserExperiencePreferencesCategory:()=>Ws,ClientPreferencesCategory:()=>Gs,PerformanceMode:()=>Vs,ParticipantJoinMeetingMode:()=>Hs,AttendeeClientType:()=>$s,AttendeeConsentType:()=>zs,UserMeetingRoleType:()=>qs,AttendanceReportType:()=>Js,MeetingSummaryQnAType:()=>Qs,MeshSpaceConversationType:()=>Ks,MissedMtmaNotificationSignals:()=>Ys,BannerNotificationCause:()=>Xs,ToastIntent:()=>Zs,PeoplePickerFor:()=>el,ShareFormStatus:()=>tl,PlatformTabEventType:()=>nl,DocumentViewerFileType:()=>il,PlatformTabSettingsTypes:()=>al,PlatformTabsQueryType:()=>ol,PlatformTabsEntryPoint:()=>rl,TswSdkMessageType:()=>sl,PollOnDemandSupportedSettingsNamespaces:()=>ll,UpdateLocalCacheSupportedPoliciesAndSettingsNamespaces:()=>dl,OutOfOfficeStatus:()=>cl,OutOfOfficeExternalAudience:()=>ul,SessionType:()=>ml,SearchSuggestionActionType:()=>gl,SearchSuggestionIconType:()=>pl,SearchSuggestionEntitySource:()=>hl,SearchHistoryAction:()=>vl,SearchBoxAction:()=>Sl,SearchSuggestionEntityType:()=>fl,SearchSuggestionGroupType:()=>yl,ServiceRecourseQueryAlterationTypes:()=>kl,CalendarInsightType:()=>Cl,CalendarArtifactType:()=>bl,CalendarArtifactGroupType:()=>Tl,SortOrderSources:()=>wl,HostTheme:()=>_l,CustomFrameAreaEventType:()=>Il,AppKind:()=>Al,SmbUserIntentType:()=>Nl,StoreItemKind:()=>El,StoreItemAttribute:()=>Dl,StoreItemOrder:()=>Fl,StoreItemFeature:()=>Pl,StoreArticleMediaType:()=>Ml,SubstrateEntityType:()=>jl,SystemSettingId:()=>Rl,TeamJoinState:()=>xl,TeamSettingsProperty:()=>Ol,GridViewSectionId:()=>Ll,InvitationState:()=>Ul,CompliancePolicyType:()=>Bl,CompliancePolicyStatus:()=>Wl,TeamCreationStatus:()=>Gl,JoinActionType:()=>Vl,JoinRequestErrors:()=>Hl,TeamJoinStatus:()=>$l,UnlockTeamResult:()=>zl,ServiceTeamMembershipUpdateType:()=>ql,TenantAnalyticsTimeperiod:()=>Jl,TenantAnalyticsTeamTypeByPrivacy:()=>Ql,TenantInvitationUserType:()=>Kl,TenantInvitationScenario:()=>Yl,TflMeetingType:()=>Xl,TranscriptEventType:()=>Zl,TranscriptArtifactType:()=>ed,UpdateClientStateSource:()=>td,UserPreferencesCategory:()=>nd,TranslationPreference:()=>id,OneDriveForBusinessAvailability:()=>ad,EmailNotificationOptions:()=>od,EmailDigestOptions:()=>rd,MeetingChatNotificationValue:()=>sd,FileOpenPreference:()=>ld,NotificationSettingsOptions:()=>dd,AliasVisibilitySetting:()=>cd}),function(e){e.Add="Add",e.Remove="Remove",e.Update="Update"}(i||(i={})),function(e){e.Next="Next",e.Prev="Prev",e.GoTo="GoTo"}(a||(a={})),function(e){e.AlwaysEnabled="AlwaysEnabled",e.AlwaysDisabled="AlwaysDisabled",e.UserOverride="UserOverride"}(o||(o={})),function(e){e.Disabled="Disabled",e.AutoAcceptInTenant="AutoAcceptInTenant",e.AutoAcceptAll="AutoAcceptAll"}(r||(r={})),function(e){e.Ready="Ready",e.NotReady="NotReady",e.NotCapable="NotCapable"}(s||(s={})),function(e){e.EyeContact="EyeContact",e.AutoFraming="AutoFraming"}(l||(l={})),function(e){e.On="On",e.Off="Off",e.Default="Default"}(d||(d={})),function(e){e.Accessibility="Accessibility",e.Audience="Audience",e.ContentOnly="ContentOnly",e.FrontRow="FrontRow",e.Grid="Grid",e.ImmersiveView="ImmersiveView",e.LargeGrid="LargeGrid",e.MixedGridView="MixedGridView",e.SpeakerView="SpeakerView"}(c||(c={})),function(e){e.AudioStage="AudioStage",e.BotStage="BotStage",e.VideoStage="VideoStage"}(u||(u={})),function(e){e.acknowledgeFirstFrame="acknowledgeFirstFrame",e.actionOnAlert="actionOnAlert",e.activeCallsChangedEvent="activeCallsChangedEvent",e.addAudienceBotDataChannel="addAudienceBotDataChannel",e.addParticipant1="addParticipant1",e.addScreenRecordingDisabledAlert="addScreenRecordingDisabledAlert",e.admitAllParticipants1="admitAllParticipants1",e.admitParticipant1="admitParticipant1",e.applyVideoBackgroundEffects="applyVideoBackgroundEffects",e.blurringCapabilityChangedEvent="blurringCapabilityChangedEvent",e.busyOnBusySetting="busyOnBusySetting",e.call="call",e.callAppContentSharingAddedEvent="callAppContentSharingAddedEvent",e.callAppContentSharingRemovedEvent="callAppContentSharingRemovedEvent",e.callAppContentSharingStartedEvent="callAppContentSharingStartedEvent",e.callAppContentSharingStartFailedEvent="callAppContentSharingStartFailedEvent",e.callAppContentSharingStatusChangedEvent="callAppContentSharingStatusChangedEvent",e.callAppUrlChangedEvent="callAppUrlChangedEvent",e.explicitRecordingConsentStateChangedEvent="explicitRecordingConsentStateChangedEvent",e.callFeedbackRendered="callFeedbackRendered",e.callHealthCategories="callHealthCategories",e.callRedirectionSettings="callRedirectionSettings",e.updateCallRedirectionSettings="updateCallRedirectionSettings",e.callingAlerts="callingAlerts",e.callingClientStateEvent="callingClientStateEvent",e.callingIntent="callingIntent",e.callingIntentEvent="callingIntentEvent",e.callingScenarioApiCallWithLoggingContext="callingScenarioApiCallWithLoggingContext",e.callingScreenStatusChanged="callingScreenStatusChanged",e.callingServiceEvent="callingServiceEvent",e.callingWindowingContentChangedEvent="callingWindowingContentChangedEvent",e.callMeetingInfo="callMeetingInfo",e.callMicNrgLevelsChangedEvent="callMicNrgLevelsChangedEvent",e.callParticipants="callParticipants",e.callParticipantsChangedEvent="callParticipantsChangedEvent",e.callParticipantsOnlyChangedEvent="callParticipantsOnlyChangedEvent",e.callParticipantsVoiceLevelsChangedEvent="callParticipantsVoiceLevelsChangedEvent",e.callParticipantAudioRestrictionsChangedEvent="callParticipantAudioRestrictionsChangedEvent",e.callParticipantVideoRestrictionsChangedEvent="callParticipantVideoRestrictionsChangedEvent",e.callPptSharingEvent="callPptSharingEvent",e.callQuestionnaire="callQuestionnaire",e.callRecordingStateChangedEvent="callRecordingStateChangedEvent",e.callLocalRecordingStateChangedEvent="callLocalRecordingStateChangedEvent",e.callScreenPreviewsV2="callScreenPreviewsV2",e.callSpeakerHWMutedChangedEvent="callSpeakerHWMutedChangedEvent",e.callSpeakerMutedChangedEvent="callSpeakerMutedChangedEvent",e.callSpeakerVolumeChangedEvent="callSpeakerVolumeChangedEvent",e.callStartTimestamp="callStartTimestamp",e.callTitleChangedEvent="callTitleChangedEvent",e.callTranscriptEditEvent="callTranscriptEditEvent",e.callTranscriptEntryEvent="callTranscriptEntryEvent",e.callTranscriptStateEvent="callTranscriptStateEvent",e.callVoiceCollectionChangedEvent="callVoiceCollectionChangedEvent",e.callWhiteboardSharingSources="callWhiteboardSharingSources",e.cancelCallFeedback="cancelCallFeedback",e.cancelRetry="cancelRetry",e.changeRingtoneSettings="changeRingtoneSettings",e.closedCaptionsDynamicEntryEvent="closedCaptionsDynamicEntryEvent",e.closedCaptionsEntryEvent="closedCaptionsEntryEvent",e.closedCaptionsStatusEvent="closedCaptionsStatusEvent",e.coachStatusEvent="coachStatusEvent",e.companionStreamAddedEvent="companionStreamAddedEvent",e.companionStreamRemovedEvent="companionStreamRemovedEvent",e.connectedCallsChangedEvent="connectedCallsChangedEvent",e.createCompositorV2="createCompositorV2",e.createOrGetInstantMeetingInfo="createOrGetInstantMeetingInfo",e.createRoomRemoteSession="createRoomRemoteSession",e.currentAudienceScene="currentAudienceScene",e.currentSeatingAssignment="currentSeatingAssignment",e.currentSeatMapping="currentSeatMapping",e.defaultVideoBackgroundImages="defaultVideoBackgroundImages",e.demotePresenterToAttendee="demotePresenterToAttendee",e.denyParticipant="denyParticipant",e.deviceList="deviceList",e.dismissAlert="dismissAlert",e.dismissParkedCallById="dismissParkedCallById",e.disposeCompositor="disposeCompositor",e.dominantSpeakerInfoEvent="dominantSpeakerInfoEvent",e.downloadVideoBackgroundImage="downloadVideoBackgroundImage",e.e2eeStatusChangedEvent="e2eeStatusChangedEvent",e.endCallingIntent="endCallingIntent",e.fireCallingIntent="fireCallingIntent",e.frameSizeChangedEvent="frameSizeChangedEvent",e.getDeviceBlurringCapability="getDeviceBlurringCapability",e.hasOngoingCallsChangedEvent="hasOngoingCallsChangedEvent",e.highFidelityAudioSwitchChangedEvent="highFidelityAudioSwitchChangedEvent",e.musicModeSettingsChangedEvent="musicModeSettingsChangedEvent",e.musicModeSettings="musicModeSettings",e.isAnonUserFromCloud="isAnonUserFromCloud",e.isE2EECallEnabled="isE2EECallEnabled",e.isE2EESettingEnabledByTenantAdmin="isE2EESettingEnabledByTenantAdmin",e.isE2EEQualifiedBySlimcoreVersion="isE2EEQualifiedBySlimcoreVersion",e.isTTYSettingEnabled="isTTYSettingEnabled",e.joinCallFromIntent="joinCallFromIntent",e.lowerAllRaisedHands="lowerAllRaisedHands",e.lowerOtherParticipantsHand="lowerOtherParticipantsHand",e.makeTranscriptEdit="makeTranscriptEdit",e.meetingInfoFromCall="meetingInfoFromCall",e.meetingRoomInfo="meetingRoomInfo",e.muteAllParticipants1="muteAllParticipants1",e.muteParticipant1="muteParticipant1",e.toggleParticipantRoomView="toggleParticipantRoomView",e.cloudPeopleFeedRoomViewState="cloudPeopleFeedRoomViewState",e.newCallingScenario="newCallingScenario",e.noiseSuppressionChangedEvent="noiseSuppressionChangedEvent",e.noiseSuppressionSetting="noiseSuppressionSetting",e.autoGainControlSetting="autoGainControlSetting",e.autoGainControlChangedEvent="autoGainControlChangedEvent",e.notifyCallingViewportCreation="notifyCallingViewportCreation",e.onAppPreInit="onAppPreInit",e.onAppPreWarm="onAppPreWarm",e.openSettingsPane="openSettingsPane",e.sendDtmf="sendDtmf",e.parkCall="parkCall",e.unparkCall="unparkCall",e.unparkCallById="unparkCallById",e.promoteAttendeeToPresenter="promoteAttendeeToPresenter",e.raiseHandStateChangedEvent="raiseHandStateChangedEvent",e.rejoinCall="rejoinCall",e.removeParticipant1="removeParticipant1",e.saveEmergencyAddress="saveEmergencyAddress",e.saveEmergencyLocation="saveEmergencyLocation",e.registerControlEvents="registerControlEvents",e.removeCustomEmergencyAddress="removeCustomEmergencyAddress",e.ringtoneSettings="ringtoneSettings",e.setUserAgreementEmergencyCustomDisclaimer="setUserAgreementEmergencyCustomDisclaimer",e.screenSharingAcceptControlRequest="screenSharingAcceptControlRequest",e.screenSharingDenyControlRequest="screenSharingDenyControlRequest",e.screenSharingTerminateControlRequest="screenSharingTerminateControlRequest",e.screenSharingReleaseControl="screenSharingReleaseControl",e.screenSharingRequestControl="screenSharingRequestControl",e.searchUsersByIdsOrQuery="searchUsersByIdsOrQuery",e.selectAudienceSceneAndAssignSeats="selectAudienceSceneAndAssignSeats",e.selectAudioDevice="selectAudioDevice",e.selectDevice="selectDevice",e.sendCommandToMeetingRoom="sendCommandToMeetingRoom",e.sendThirdPartyDevicePairingResponse="sendThirdPartyDevicePairingResponse",e.setBusyOnBusySetting="setBusyOnBusySetting",e.setClosedCaptionsLanguage="setClosedCaptionsLanguage",e.setClosedCaptionsTextTrack="setClosedCaptionsTextTrack",e.requestClosedCaptionSubtitle="requestClosedCaptionSubtitle",e.setInterpretationGroup="setInterpretationGroup",e.setMaxVideoChannels="setMaxVideoChannels",e.setSpeakerVolume="setSpeakerVolume",e.setTextureSharingSupported="setTextureSharingSupported",e.setVideoPreference="setVideoPreference",e.setVideosSizeAndPreference="setVideosSizeAndPreference",e.spatialAudioConfigs="spatialAudioConfigs",e.spatialAudioConfigsChangedEvent="spatialAudioConfigsChangedEvent",e.speakerHWMuted="speakerHWMuted",e.speakerMuted="speakerMuted",e.spotlightParticipant="spotlightParticipant",e.isApplianceMode="isApplianceMode",e.startCall="startCall",e.startCallAppContentSharing="startCallAppContentSharing",e.startBotView="startBotView",e.callingRosterAddARoom="callingRosterAddARoom",e.screenShareControlEvent="screenShareControlEvent",e.sendCallingDataToTelemetry="sendCallingDataToTelemetry",e.startClosedCaptions="startClosedCaptions",e.startCoach="startCoach",e.startOrContinueInstantMeeting="startOrContinueInstantMeeting",e.startPreview="startPreview",e.startPstnCall="startPstnCall",e.startRecording="startRecording",e.startRecordingAndTranscript="startRecordingAndTranscript",e.startLocalRecording="startLocalRecording",e.stopLocalRecording="stopLocalRecording",e.startSharing="startSharing",e.startStream="startStream",e.startStream1="startStream1",e.startTranscript="startTranscript",e.stopCall="stopCall",e.stopCallAppContentSharing="stopCallAppContentSharing",e.stopClosedCaptions="stopClosedCaptions",e.stopCoach="stopCoach",e.stopPreview="stopPreview",e.stopRecording="stopRecording",e.stopRecordingAndTranscript="stopRecordingAndTranscript",e.stopSharing="stopSharing",e.stopSpotlight="stopSpotlight",e.stopSpotlightOnParticipant="stopSpotlightOnParticipant",e.updateParticipantInterpretationState="updateParticipantInterpretationState",e.updateSelfExplicitRecordingConsentState="updateSelfExplicitRecordingConsentState",e.stopStream="stopStream",e.stopStream1="stopStream1",e.stopTranscript="stopTranscript",e.stopVideoForAllCalls="stopVideoForAllCalls",e.submitCallFeedback="submitCallFeedback",e.subscribedCallChangedEvent="subscribedCallChangedEvent",e.systemAudioState="systemAudioState",e.castingSystemAudioState="castingSystemAudioState",e.systemAudioStateChanged="systemAudioStateChanged",e.teamsCallId="teamsCallId",e.thirdPartyDevicesEvent="thirdPartyDevicesEvent",e.threadMembers="threadMembers",e.toggleE2EECall="toggleE2EECall",e.toggleHighFidelityAudio="toggleHighFidelityAudio",e.toggleMusicModeSettings="toggleMusicModeSettings",e.toggleHoldCall="toggleHoldCall",e.toggleIncomingVideo="toggleIncomingVideo",e.toggleMute="toggleMute",e.toggleMuteWithState="toggleMuteWithState",e.toggleMuteSpeaker="toggleMuteSpeaker",e.toggleRaiseHands="toggleRaiseHands",e.toggleTogetherModePinning="toggleTogetherModePinning",e.toggleTTYSetting="toggleTTYSetting",e.toggleVideo="toggleVideo",e.toggleVideoWithState="toggleVideoWithState",e.toggleAutoGainControl="toggleAutoGainControl",e.saveGeneratedBackgroundImage="saveGeneratedBackgroundImage",e.captureVideoFrame="captureVideoFrame",e.transferCall="transferCall",e.parkedCallDetails="parkedCallDetails",e.OngoingConsultation="OngoingConsultation",e.OngoingConsultationEvent="OngoingConsultationEvent",e.transportCompanionDeviceInfo="transportCompanionDeviceInfo",e.tryToggleIncludeSystemAudio="tryToggleIncludeSystemAudio",e.turnOffCallGroupNotification="turnOffCallGroupNotification",e.updateAttendeeRestrictions="updateAttendeeRestrictions",e.unregisterControlEvents="unregisterControlEvents",e.updateCallingScenarioEventData="updateCallingScenarioEventData",e.updateCallRefreshSettings="updateCallRefreshSettings",e.updateCompositorLayout="updateCompositorLayout",e.updateMeetNowTitle="updateMeetNowTitle",e.updateNoiseSuppression="updateNoiseSuppression",e.updateUserDelegates="updateUserDelegates",e.userCallingSettings="userCallingSettings",e.explicitRecordingConsentState="explicitRecordingConsentState",e.videoAvailableForConversation="videoAvailableForConversation",e.videoSizeChanged="videoSizeChanged",e.callByThreadId="callByThreadId",e.handlePresentDeepLink="handlePresentDeepLink",e.startFileSharing1="startFileSharing1",e.startWhiteboardSharing="startWhiteboardSharing",e.stopWhiteboardSharing="stopWhiteboardSharing",e.changeCallForwardingTargetTo="changeCallForwardingTargetTo",e.changeImmersiveViewStatus="changeImmersiveViewStatus",e.callPptSharingAddedEvent="callPptSharingAddedEvent",e.callPptSharingChangeSlideCortanaInvocationEvent="callPptSharingChangeSlideCortanaInvocationEvent",e.callPptSharingContentSharingStatusChangedEvent="callPptSharingContentSharingStatusChangedEvent",e.callPptSharingJoinFailedEvent="callPptSharingJoinFailedEvent",e.callPptSharingMediaEventUpdatedEvent="callPptSharingMediaEventUpdatedEvent",e.callPptSharingPresentationUrlReadyEvent="callPptSharingPresentationUrlReadyEvent",e.callPptSharingPrivateViewingChangedEvent="callPptSharingPrivateViewingChangedEvent",e.callPptSharingRemovedEvent="callPptSharingRemovedEvent",e.callPptSharingStartedEvent="callPptSharingStartedEvent",e.callPptSharingStartFailedEvent="callPptSharingStartFailedEvent",e.callPptSharingSlideChangedEvent="callPptSharingSlideChangedEvent",e.callPptSharingTelemetryUpdatedEvent="callPptSharingTelemetryUpdatedEvent",e.callPptSharingChangeSlide="callPptSharingChangeSlide",e.callPptSharingMediaEventUpdate="callPptSharingMediaEventUpdate",e.callPptSharingStopContentSharing="callPptSharingStopContentSharing",e.callPptSharingTakeControl="callPptSharingTakeControl",e.callPptSharingTogglePrivateViewing="callPptSharingTogglePrivateViewing",e.callPptSharingUpdateCameoState="callPptSharingUpdateCameoState",e.callPptSharingUpdateLayout="callPptSharingUpdateLayout",e.callPptSharingUpdatePresentationUrl="callPptSharingUpdatePresentationUrl",e.callPptSharingUpdateSlidesCount="callPptSharingUpdateSlidesCount",e.callMeBackWithResult="callMeBackWithResult",e.changeWhiteboardUrl="changeWhiteboardUrl",e.changeFileUserPermissions="changeFileUserPermissions",e.postFluidWhiteboard="postFluidWhiteboard",e.whiteboardSharingAddedEvent="whiteboardSharingAddedEvent",e.whiteboardSharingStartedEvent="whiteboardSharingStartedEvent",e.whiteboardSharingStartFailedEvent="whiteboardSharingStartFailedEvent",e.whiteboardSharingStatusChangedEvent="whiteboardSharingStatusChangedEvent",e.whiteboardUrlChangedEvent="whiteboardUrlChangedEvent",e.fileUserPermissionsChangedEvent="fileUserPermissionsChangedEvent",e.updateStreams="updateStreams",e.toggleVideoStreamFocus="toggleVideoStreamFocus",e.isVideoEffectCapableOnDevice="isVideoEffectCapableOnDevice",e.isCameraSharingEnabled="isCameraSharingEnabled",e.videoEffectStateV2="videoEffectStateV2",e.videoTouchUpStrength="videoTouchUpStrength",e.toggleVideoEffectV2="toggleVideoEffectV2",e.setTouchUpVideoEffect="setTouchUpVideoEffect",e.videoEffectConfigChangedEvent="videoEffectConfigChangedEvent",e.windowsEffectsCapability="windowsEffectsCapability",e.windowsEffectsState="windowsEffectsState",e.setWindowsEffectsState="setWindowsEffectsState",e.callParticipantsCounts="callParticipantsCounts",e.callTransferEvents="callTransferEvents",e.roomRemoteStateUpdateEvent="roomRemoteStateUpdateEvent",e.roomRemoteCapabilitiesUpdateEvent="roomRemoteCapabilitiesUpdateEvent",e.roomRemoteProximityBannerEvent="roomRemoteProximityBannerEvent",e.endRoomRemoteSession="endRoomRemoteSession",e.videoEffectReadinessOnDevice="videoEffectReadinessOnDevice",e.videoEffectReadinessChangedEvent="videoEffectReadinessChangedEvent",e.windowsEffectsCapabilityChangedEvent="windowsEffectsCapabilityChangedEvent",e.videoEffectCapabilitiesChangedEvent="videoEffectCapabilitiesChangedEvent",e.totalMeetingParticipantCount="totalMeetingParticipantCount",e.setAvatarModeState="setAvatarModeState",e.setIsAvatarAppAvailable="setIsAvatarAppAvailable",e.updateCustomLayoutSelection="updateCustomLayoutSelection",e.setSpatialAudio="setSpatialAudio",e.updateSpatialAudioStageConfig="updateSpatialAudioStageConfig",e.updateSpatialAudioSubStageConfig="updateSpatialAudioSubStageConfig",e.updateSpatialAudioParticipantsPosition="updateSpatialAudioParticipantsPosition",e.getEmergencyAddress="getEmergencyAddress",e.getLocationResponseAddress="getLocationResponseAddress",e.emergencyAddressUpdatedEvent="emergencyAddressUpdatedEvent",e.emergencyCustomDisclaimerUpdatedEvent="emergencyCustomDisclaimerUpdatedEvent",e.emergencyCustomDisclaimer="emergencyCustomDisclaimer",e.holographicCallState="holographicCallState",e.holographicAnnotationEvent="holographicAnnotationEvent",e.holographicCallStateChangedEvent="holographicCallStateChangedEvent",e.startHolographicInteraction="startHolographicInteraction",e.startHolographicFreezeFrameInteraction="startHolographicFreezeFrameInteraction",e.stopHolographicInteraction2="stopHolographicInteraction2",e.stopHolographicFreezeFrameInteraction="stopHolographicFreezeFrameInteraction",e.updateHolographicViewingParticipant="updateHolographicViewingParticipant",e.placeHolographicAnnotation="placeHolographicAnnotation",e.continueHolographicInking="continueHolographicInking",e.stopHolographicInking="stopHolographicInking",e.deleteHolographicAnnotations="deleteHolographicAnnotations",e.recoverHolographicAnnotations="recoverHolographicAnnotations",e.clearAllHolographicAnnotations="clearAllHolographicAnnotations",e.setHolographicToolbarVisibility="setHolographicToolbarVisibility",e.setHolographicToolbarAvailability="setHolographicToolbarAvailability",e.voicemailPolicySettings="voicemailPolicySettings",e.voicemailSettings="voicemailSettings",e.updateVoicemailSettings="updateVoicemailSettings",e.currentSeatMappingChangedEvent="currentSeatMappingChangedEvent",e.userDelegation="userDelegation",e.isWatermarkSupported="isWatermarkSupported",e.isAudioOnlySupported="isAudioOnlySupported",e.ignoreMirroringVideoPreferenceSetting="ignoreMirroringVideoPreferenceSetting",e.setIgnoreMirroring="setIgnoreMirroring",e.updateIgnoreMirroringVideoPreferenceSetting="updateIgnoreMirroringVideoPreferenceSetting",e.ignoreMirroringVideoPreferenceSettingChangedEvent="ignoreMirroringVideoPreferenceSettingChangedEvent",e.stopMdpDataCollection="stopMdpDataCollection",e.streamingInfoChangedEvent="streamingInfoChangedEvent",e.playAudioFile="playAudioFile",e.pauseAudioFile="pauseAudioFile",e.audioEndedEvent="audioEndedEvent",e.callingAggregateSettings="callingAggregateSettings",e.callingAggregateSettingsEvent="callingAggregateSettingsEvent",e.parkedCalls="parkedCalls",e.parkedCallsChangedEvent="parkedCallsChangedEvent",e.slaCalls="slaCalls",e.slaCallsChangedEvent="slaCallsChangedEvent",e.joinCallByInvitationContent="joinCallByInvitationContent",e.userVideoBackgroundImages="userVideoBackgroundImages",e.uploadVideoBackgroundImage="uploadVideoBackgroundImage",e.deleteVideoBackgroundImage="deleteVideoBackgroundImage",e.renameParticipant="renameParticipant",e.browserPopoutUserPreference="browserPopoutUserPreference",e.setBrowserPopoutUserPreference="setBrowserPopoutUserPreference"}(m||(m={})),function(e){e.SignOut="SignOut"}(g||(g={})),function(e){e.StandupCallingAppJob="StandupCallingAppJob"}(p||(p={})),function(e){e.Added="Added",e.Removed="Removed",e.AnnotationSharerWindow="AnnotationSharerWindow"}(h||(h={})),function(e){e.Disabled="Disabled",e.Failed="Failed",e.None="None",e.Paused="Paused",e.Pending="Pending",e.Recording="Recording",e.Stopping="Stopping",e.Waiting="Waiting",e.WaitingForMeetingLive="WaitingForMeetingLive"}(v||(v={})),function(e){e.None="None",e.Recording="Recording",e.Stopped="Stopped",e.Error="Error"}(S||(S={})),function(e){e.None="None",e.Started="Started",e.Failed="Failed"}(f||(f={})),function(e){e.None="None",e.Disabled="Disabled",e.Pending="Pending",e.Waiting="Waiting",e.Started="Started",e.Stopped="Stopped",e.Failed="Failed",e.WaitingForMeetingLive="WaitingForMeetingLive"}(y||(y={})),function(e){e.Accessibility="Accessibility",e.Audience="Audience",e.Content="Content",e.FrontRow="FrontRow",e.Grid="Grid",e.LargeGrid="LargeGrid",e.PeopleAndContent="PeopleAndContent"}(k||(k={})),function(e){e.Accessibility="Accessibility",e.Audience="Audience",e.FrontRow="FrontRow",e.Grid="Grid",e.LargeGrid="LargeGrid"}(C||(C={})),function(e){e.Ready="Ready",e.Listening="Listening",e.Thinking="Thinking",e.Speaking="Speaking"}(b||(b={})),function(e){e.Hold="Hold",e.Resume="Resume",e.Transfer="Transfer",e.ConsultativeTransfer="ConsultativeTransfer"}(T||(T={})),function(e){e.Request="Request",e.Release="Release"}(w||(w={})),function(e){e.Grid="Grid",e.FrontRow="FrontRow"}(_||(_={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(I||(I={})),function(e){e.Auto="Auto",e.Chat="Chat",e.Hide="Hide",e.RaisedHand="RaisedHand"}(A||(A={})),function(e){e.Rendering="Rendering",e.FirstFrameRendered="FirstFrameRendered",e.Stopped="Stopped"}(N||(N={})),function(e){e.CallingAppEventsServiceSubscribe="CallingAppEventsServiceSubscribe",e.CreateNotificationWithActions="CreateNotificationWithActions",e.DialogOpen="DialogOpen",e.MultiWindowNavigation="MultiWindowNavigation",e.NavigateToConversationPromiseChat="NavigateToConversationPromiseChat",e.NavigateToConversationPromiseChatList="NavigateToConversationPromiseChatList",e.NavigateToDefaultState="NavigateToDefaultState",e.NavigateToDefaultWithFallbacks="NavigateToDefaultWithFallbacks",e.NavigateToLastChatState="NavigateToLastChatState",e.NavigateToLastTeamState="NavigateToLastTeamState",e.NavigateToMainWindow="NavigateToMainWindow",e.ShowBannerNotification="ShowBannerNotification",e.SingleWindowNavigation="SingleWindowNavigation"}(E||(E={})),function(e){e.CallGroup="CallGroup",e.Calls="Calls",e.Devices="Devices",e.PremiumBenefits="PremiumBenefits",e.Privacy="Privacy"}(D||(D={})),function(e){e.Show="Show",e.Hide="Hide"}(F||(F={})),function(e){e.Calling="Calling",e.RigelGallery="RigelGallery",e.RigelContent="RigelContent",e.RigelGalleryAndContent="RigelGalleryAndContent"}(P||(P={})),function(e){e.SingleWindow="SingleWindow",e.MultiWindow="MultiWindow"}(M||(M={})),function(e){e.Chat="Chat"}(j||(j={})),function(e){e.PrimaryAction="PrimaryAction",e.DismissAction="DismissAction"}(R||(R={})),function(e){e.EndpointTransfer="EndpointTransfer"}(x||(x={})),function(e){e.BannerNotification="BannerNotification"}(O||(O={})),function(e){e.DialogTitle="DialogTitle",e.DialogText="DialogText",e.PrimaryButton="PrimaryButton",e.ConfirmMessageTitle="ConfirmMessageTitle",e.ConfirmMessageHtmlBody="ConfirmMessageHtmlBody",e.OkButtonText="OkButtonText"}(L||(L={})),function(e){e.PostConfirm="PostConfirm",e.PreClose="PreClose",e.PostClose="PostClose",e.PreActiveElementIds="PreActiveElementIds",e.CloseByDocument="CloseByDocument"}(U||(U={})),function(e){e.Alert="Alert",e.CallingConfirm="CallingConfirm",e.CallingUnparkCall="CallingUnparkCall",e.OptionsSettings="OptionsSettings",e.PrejoinOverlay="PrejoinOverlay",e.UserMedia="UserMedia",e.CallingRestartRecomendedError="CallingRestartRecomendedError",e.WindowingError="WindowingError"}(B||(B={})),function(e){e.MeetingStart="MeetingStart",e.MeetingStartFromLobby="MeetingStartFromLobby"}(W||(W={})),function(e){e.OneToOne="OneToOne",e.GroupCall="GroupCall",e.Meeting="Meeting",e.Chat="Chat",e.Reply="Reply",e.ReplyToReply="ReplyToReply",e.Like="Like",e.Mention="Mention",e.Download="Download",e.AppUpdated="AppUpdated",e.NeedMoreDiskSpace="NeedMoreDiskSpace",e.TeamMembershipChange="TeamMembershipChange",e.Follow="Follow",e.OneToOnePstn="OneToOnePstn",e.Thirdparty="Thirdparty",e.MessageSendFailed="MessageSendFailed",e.CallTransferFailed="CallTransferFailed",e.ShareFromChat="ShareFromChat",e.Inferred="Inferred",e.Trending="Trending",e.MeetingWentLive="MeetingWentLive",e.PresenceStatus="PresenceStatus",e.Reaction="Reaction",e.Priority="Priority",e.TeamsTasks="TeamsTasks",e.Dlp="Dlp",e.TeamsEngagementActivity="TeamsEngagementActivity",e.MsGraph="MsGraph",e.StaffHub="StaffHub",e.CallAnsweredElsewhere="CallAnsweredElsewhere",e.CallSafeTransferRingback="CallSafeTransferRingback",e.SkypeConsumerCall="SkypeConsumerCall",e.SpamCall="SpamCall",e.Default="Default"}(G||(G={})),function(e){e.BannerContentToCommandingConversionError="BannerContentToCommandingConversionError",e.CallingAppEventJobHandlerError="CallingAppEventJobHandlerError",e.CallingAppEventResolverError="CallingAppEventResolverError",e.ShowBannerError="ShowBannerError",e.WindowingCommandingProcessingError="WindowingCommandingProcessingError",e.WindowingCommandingSuccess="WindowingCommandingSuccess",e.WindowingCommandingTriggerError="WindowingCommandingTriggerError"}(V||(V={})),function(e){e.showVideoGallery="showVideoGallery",e.showContent="showContent",e.showVideoGalleryAndContent="showVideoGalleryAndContent",e.showLargeGallery="showLargeGallery",e.showTogether="showTogether",e.showFrontRow="showFrontRow"}(H||(H={})),function(e){e.leaveMeeting="leaveMeeting"}($||($={})),function(e){e.toggleMute="toggleMute",e.toggleCamera="toggleCamera",e.volume="volume",e.toggleCaptions="toggleCaptions"}(z||(z={})),function(e){e.allow="allow",e.block="block",e.timeout="timeout",e.dismissed="dismissed",e.busy="busy",e.error="error"}(q||(q={})),function(e){e.DataChannel="DataChannel",e.AnnotationReady="AnnotationReady",e.ClientInForeground="ClientInForeground",e.AnnotationLimit="AnnotationLimit",e.Tracking="Tracking"}(J||(J={})),function(e){e.Failed="Failed",e.NotReady="NotReady",e.Ready="Ready"}(Q||(Q={})),function(e){e.Ring="Ring",e.Mute="Mute",e.Banner="Banner"}(K||(K={})),function(e){e.Abandon="Abandon",e.Fail="Fail",e.StartMarker="StartMarker",e.Stop="Stop",e.StopMarker="StopMarker"}(Y||(Y={})),function(e){e.Ring="Ring",e.Mute="Mute"}(X||(X={})),function(e){e.None="None",e.CollabDetails="CollabDetails"}(Z||(Z={})),function(e){e.All="All",e.Presenters="Presenters",e.Attendees="Attendees",e.Interpreters="Interpreters"}(ee||(ee={})),function(e){e.Devices="Devices"}(te||(te={})),function(e){e.GreenScreen="GreenScreen"}(ne||(ne={})),function(e){e.Voicemail="Voicemail",e.SingleTarget="SingleTarget",e.MyDelegates="MyDelegates",e.DoNothing="DoNothing"}(ie||(ie={})),function(e){e.Pause="Pause",e.Resume="Resume",e.Goto="Goto",e.Cards="Cards"}(ae||(ae={})),function(e){e.Success="Success",e.DetectFailed="DetectFailed",e.Timeout="Timeout",e.TextTooShort="TextTooShort",e.Unsupported="Unsupported",e.UnknownError="UnknownError",e.LowConfidence="LowConfidence",e.NoContent="NoContent"}(oe||(oe={})),function(e){e.E164="E164",e.INTERNATIONAL="INTERNATIONAL",e.NATIONAL="NATIONAL",e.RFC3966="RFC3966"}(re||(re={})),function(e){e.Chat="Chat",e.TeamsCall="TeamsCall"}(se||(se={})),function(e){e.Custom="Custom",e.Favorites="Favorites",e.SfBFavorites="SfBFavorites",e.Tagged="Tagged",e.OtherContacts="OtherContacts",e.TflContacts="TflContacts",e.TflBlocked="TflBlocked"}(le||(le={})),function(e){e.AddDelegate="AddDelegate",e.EditDelegate="EditDelegate",e.RemoveDelegate="RemoveDelegate"}(de||(de={})),function(e){e.Exchange="Exchange",e.BuddyList="BuddyList",e.MiddleTier="MiddleTier",e.SerializedData="SerializedData"}(ce||(ce={})),function(e){e.Principal="Principal",e.Manager="Manager",e.Peer="Peer",e.InOrg="InOrg"}(ue||(ue={})),function(e){e.Error="Error",e.Started="Started",e.Captured="Captured",e.Processed="Processed",e.Stopped="Stopped",e.Updated="Updated"}(me||(me={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.NONE="NONE",e.SUCCESS="SUCCESS",e.FAIL="FAIL"}(ge||(ge={})),function(e){e.BackgroundEffect="BackgroundEffect",e.BackgroundAPL="BackgroundAPL"}(pe||(pe={})),function(e){e.Crop="Crop",e.Fit="Fit",e.Stretch="Stretch"}(he||(he={})),function(e){e.Unspecified="Unspecified",e.AttendeeView="AttendeeView",e.PptSharing="PptSharing",e.IncomingScreenShare="IncomingScreenShare",e.IncomingVideo="IncomingVideo",e.LocalPreview="LocalPreview",e.FrameSinkReader="FrameSinkReader"}(ve||(ve={})),function(e){e.Disabled="Disabled",e.Failed="Failed",e.None="None",e.Pending="Pending",e.Started="Started",e.Stopped="Stopped"}(Se||(Se={})),function(e){e.Team="Team",e.SharedLine="SharedLine",e.ServerHold="ServerHold"}(fe||(fe={})),function(e){e.HdmiIngest="HdmiIngest",e.WhiteboardCamera="WhiteboardCamera"}(ye||(ye={})),function(e){e.None="None",e.Home="Home",e.Mobile="Mobile",e.Work="Work"}(ke||(ke={})),function(e){e.Idle="Idle",e.AdHoc="AdHoc",e.Incoming="Incoming",e.InACall="InACall",e.CQF="CQF",e.Cortana="Cortana",e.Broadcast="Broadcast"}(Ce||(Ce={})),function(e){e.Unknown="Unknown",e.Metadata="Metadata",e.Location="Location",e.Body="Body"}(be||(be={})),function(e){e.Screen="Screen",e.App="App"}(Te||(Te={})),function(e){e.hold="hold",e.active="active"}(we||(we={})),function(e){e.NotInstalled="NotInstalled",e.InProgress="InProgress",e.Installed="Installed",e.Unavailable="Unavailable",e.UpdateAvailable="UpdateAvailable",e.MustUpdate="MustUpdate"}(_e||(_e={})),function(e){e.Ai="Ai",e.Cart="Cart",e.Cea708="Cea708",e.Mt="Mt"}(Ie||(Ie={})),function(e){e.NotSupported="NotSupported",e.FullySupported="FullySupported",e.LightweightOnly="LightweightOnly"}(Ae||(Ae={})),function(e){e.Created="Created",e.Ready="Ready",e.Started="Started",e.Stopping="Stopping",e.Stopped="Stopped"}(Ne||(Ne={})),function(e){e.media="media",e.geolocation="geolocation",e.notifications="notifications",e.midi="midi",e.openExternal="openExternal"}(Ee||(Ee={})),function(e){e.Participant="Participant",e.Interpreter="Interpreter",e.Presenter="Presenter"}(De||(De={})),function(e){e.Unknown="Unknown",e.Teams="Teams",e.Skype="Skype",e.Webex="Webex",e.Zoom="Zoom"}(Fe||(Fe={})),function(e){e.Native="Native",e.Chromium="Chromium",e.Webview="Webview"}(Pe||(Pe={})),function(e){e.Active="Active",e.Inactive="Inactive",e.Failed="Failed"}(Me||(Me={})),function(e){e.Outlook="Outlook",e.Skype="Skype",e.Google="Google",e.Device="Device",e.M365="M365"}(je||(je={})),function(e){e.ConnectedAccountsSyncError="ConnectedAccountsSyncError"}(Re||(Re={})),function(e){e.SyncStarted="SyncStarted",e.SyncFailed="SyncFailed",e.SyncCompleted="SyncCompleted",e.UnsyncStarted="UnsyncStarted",e.UnsyncFailed="UnsyncFailed",e.UnsyncCompleted="UnsyncCompleted"}(xe||(xe={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.Unsupported="Unsupported"}(Oe||(Oe={})),function(e){e.BlueWave="BlueWave",e.CreativeConservatory="CreativeConservatory",e.Default="Default",e.DigitalForest="DigitalForest",e.Dreamcatcher="Dreamcatcher",e.IntoTheFold="IntoTheFold",e.Limeade="Limeade",e.NoTheme="NoTheme",e.PixelPerfect="PixelPerfect",e.PurpleParadise="PurpleParadise",e.Roadmap="Roadmap",e.SeasideBliss="SeasideBliss",e.SummerSummit="SummerSummit",e.Sunset="Sunset",e.VividFlagDefault="VividFlagDefault",e.Custom="Custom"}(Le||(Le={})),function(e){e.sideload="sideload",e.tenant="tenant",e.staging="staging"}(Ue||(Ue={})),function(e){e.MeetingNotesAddition="MeetingNotesAddition"}(Be||(Be={})),function(e){e.NotStarted="NotStarted",e.Active="Active",e.Resolved="Resolved",e.Rejected="Rejected",e.Timeout="Timeout",e.Abandoned="Abandoned"}(We||(We={})),function(e){e.Chat="Chat"}(Ge||(Ge={})),function(e){e.Save="Save"}(Ve||(Ve={})),function(e){e.NotStarted="NotStarted",e.Started="Started",e.Starting="Starting",e.Stopped="Stopped",e.Stopping="Stopping"}(He||(He={})),function(e){e.Producer="Producer",e.Contributor="Contributor",e.Attendee="Attendee",e.None="None"}($e||($e={})),function(e){e.InCall="InCall",e.ScreenSharing="ScreenSharing",e.None="None"}(ze||(ze={})),function(e){e.Unestablished="Unestablished",e.Viewing="Viewing",e.BrowsingPrivately="BrowsingPrivately",e.Presenting="Presenting"}(qe||(qe={})),function(e){e.Done="Done",e.InProcess="InProcess",e.NotStarted="NotStarted",e.ScoreTooLow="ScoreTooLow",e.TooManyCharacters="TooManyCharacters",e.UnknownError="UnknownError"}(Je||(Je={})),function(e){e.ChatDisabledDueToIB="ChatDisabledDueToIB",e.SmsChatDisabledDueToLicense="SmsChatDisabledDueToLicense",e.SmsChatDisabledDueToRNLError="SmsChatDisabledDueToRNLError",e.ChatDisabledDueToBotStatus="ChatDisabledDueToBotStatus",e.ChatDisabledDueToRecipientTeamsUpgradePolicy="ChatDisabledDueToRecipientTeamsUpgradePolicy",e.UnknownReason="UnknownReason"}(Qe||(Qe={})),function(e){e.Camera="Camera",e.Microphone="Microphone",e.Speaker="Speaker"}(Ke||(Ke={})),function(e){e.AttendeeAudio="AttendeeAudio",e.AttendeeCaptions="AttendeeCaptions",e.AttendeeGeneral="AttendeeGeneral",e.Audio="Audio",e.Broadcast="Broadcast",e.CallClosedCaptions="CallClosedCaptions",e.EffectiveMeeting="EffectiveMeeting",e.Other="Other",e.ScreenSharing="ScreenSharing",e.ScreenshareFromChat="ScreenshareFromChat",e.Video="Video"}(Ye||(Ye={})),function(e){e.EffectiveMeeting="EffectiveMeeting",e.EffectiveMeetingV2="EffectiveMeetingV2",e.EffectiveMeetingViva="EffectiveMeetingViva",e.Quality="Quality",e.ShortDurationHangup="ShortDurationHangup"}(Xe||(Xe={})),function(e){e.GroupCall="GroupCall",e.Meeting="Meeting",e.P2P="P2P",e.PSTN="PSTN",e.ScreenshareFromChat="ScreenshareFromChat",e.SfB="SfB"}(Ze||(Ze={})),function(e){e.GroupChat="GroupChat",e.Personal="Personal",e.Team="Team"}(et||(et={})),function(e){e.SidePanel="SidePanel",e.Stage="Stage",e.Unknown="Unknown"}(tt||(tt={})),function(e){e.CallingSidePanel="CallingSidePanel",e.ChannelTab="ChannelTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.PersonalTab="PersonalTab",e.PrivateChatTab="PrivateChatTab",e.Unknown="Unknown"}(nt||(nt={})),function(e){e.ChannelTab="ChannelTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.PersonalTab="PersonalTab",e.PrivateChatTab="PrivateChatTab",e.TeamLevelApp="TeamLevelApp",e.Unknown="Unknown"}(it||(it={})),function(e){e.CALENDAR_LEFT_RAIL_SETTINGS_SYNCING="CALENDAR_LEFT_RAIL_SETTINGS_SYNCING",e.CALENDAR_LEFT_RAIL_SETTINGS_SYNC_FAILED="CALENDAR_LEFT_RAIL_SETTINGS_SYNC_FAILED",e.CALENDAR_LEFT_RAIL_SETTINGS_UPTO_DATE="CALENDAR_LEFT_RAIL_SETTINGS_UPTO_DATE",e.CONNECTED_CALENDAR_SYNCING="CONNECTED_CALENDAR_SYNCING",e.CONNECTED_CALENDAR_SYNC_FAILED="CONNECTED_CALENDAR_SYNC_FAILED",e.CONNECTED_CALENDAR_UPTO_DATE="CONNECTED_CALENDAR_UPTO_DATE",e.EMPTY="EMPTY",e.MULTI_CALENDAR_SYNCING="MULTI_CALENDAR_SYNCING",e.MULTI_CALENDAR_SYNC_FAILED="MULTI_CALENDAR_SYNC_FAILED",e.MULTI_CALENDAR_UPTO_DATE="MULTI_CALENDAR_UPTO_DATE",e.USER_CALENDAR_SYNCING="USER_CALENDAR_SYNCING",e.USER_CALENDAR_SYNC_FAILED="USER_CALENDAR_SYNC_FAILED",e.USER_CALENDAR_UPTO_DATE="USER_CALENDAR_UPTO_DATE"}(at||(at={})),function(e){e.None="None",e.MutedTeamMember="MutedTeamMember",e.OnlyOwnersCanPost="OnlyOwnersCanPost"}(ot||(ot={})),function(e){e.private="private",e.online="online",e.event="event",e.inPerson="inPerson",e.channel="channel",e.broadcast="broadcast"}(rt||(rt={})),function(e){e.Standard="Standard",e.Private="Private",e.Shared="Shared"}(st||(st={})),function(e){e.Admin="Admin",e.Guest="Guest",e.Shadow="Shadow",e.Undefined="Undefined",e.User="User"}(lt||(lt={})),function(e){e.Everyone="Everyone",e.EveryoneButGuests="EveryoneButGuests",e.Moderators="Moderators"}(dt||(dt={})),function(e){e.AnyonePost="AnyonePost",e.AnyoneWithWarning="AnyoneWithWarning",e.OwnersPost="OwnersPost"}(ct||(ct={})),function(e){e.Room="Room",e.Building="Building"}(ut||(ut={})),function(e){e.Single="Single",e.Occurrence="Occurrence",e.Exception="Exception",e.RecurringMaster="RecurringMaster"}(mt||(mt={})),function(e){e.Free="Free",e.Tentative="Tentative",e.Busy="Busy",e.Oof="Oof",e.WorkingElsewhere="WorkingElsewhere",e.Unknown="Unknown"}(gt||(gt={})),function(e){e.Content="Content",e.ContentWithGallery="ContentWithGallery",e.Gallery="Gallery",e.None="None"}(pt||(pt={})),function(e){e.Info="Info",e.Error="Error"}(ht||(ht={})),function(e){e.accessibilitypanel="accessibilitypanel",e.accounts="accounts",e.activecalldialog="activecalldialog",e.activity="activity",e.addchannel="addchannel",e.addmember="addmember",e.addmembernewteam="addmembernewteam",e.agendapage="agendapage",e.aiinsightscontent="aiinsightscontent",e.alttext="alttext",e.annotation="annotation",e.appdetails="appdetails",e.attendancereport="attendancereport",e.attendeeview="attendeeview",e.autobrbconfirmationdialog="autobrbconfirmationdialog",e.autoinstallnotification="autoinstallnotification",e.bannerNotification="bannerNotification",e.blank="blank",e.blockChat="blockChat",e.livepersonacard="livepersonacard",e.brbfeedbackdialog="brbfeedbackdialog",e.breakoutrooms="breakoutrooms",e.breakoutroomsassignment="breakoutroomsassignment",e.breakoutroomsassignmenttype="breakoutroomsassignmenttype",e.breakoutroomscreaterooms="breakoutroomscreaterooms",e.breakoutroomsdeleteroom="breakoutroomsdeleteroom",e.breakoutroomsdeleterooms="breakoutroomsdeleterooms",e.breakoutroomseditroom="breakoutroomseditroom",e.breakoutroomssettings="breakoutroomssettings",e.breakoutroomspanel="breakoutroomspanel",e.broadcastfeedback="broadcastfeedback",e.broadcastliveevent="broadcastliveevent",e.broadcastqna="broadcastqna",e.broadcasts="broadcasts",e.calendar="calendar",e.callablechannels="callablechannels",e.callingalertdialog="callingalertdialog",e.callingbannernotification="callingbannernotification",e.callingconfirmdialog="callingconfirmdialog",e.callingdeeplink="callingdeeplink",e.callingprotocoldeeplinkdialog="callingprotocoldeeplinkdialog",e.calls="calls",e.callscontent="callscontent",e.callsgallery="callsgallery",e.callsgalleryandcontent="callsgalleryandcontent",e.callskeypad="callskeypad",e.callsmain="callsmain",e.callsmonitor="callsmonitor",e.callstransfer="callstransfer",e.cameraeffects="cameraeffects",e.campaignnotifications="campaignnotifications",e.cast="cast",e.channelanalytics="channelanalytics",e.channelcalendar="channelcalendar",e.channelconnectors="channelconnectors",e.channeldeeplink="channeldeeplink",e.channeldelete="channeldelete",e.channeledit="channeledit",e.channelemail="channelemail",e.channelemailv2="channelemailv2",e.channelinvitations="channelinvitations",e.channelmanage="channelmanage",e.channelmembers="channelmembers",e.channelmoderators="channelmoderators",e.channelnotificationsettings="channelnotificationsettings",e.channelroster="channelroster",e.channels="channels",e.channelsettings="channelsettings",e.channelsPinnedPost="channelsPinnedPost",e.channelsSystemMessage="channelsSystemMessage",e.channelcontextualsearch="channelcontextualsearch",e.channeltags="channeltags",e.chats="chats",e.chatContextualSearch="chatContextualSearch",e.chatsInfo="chatsInfo",e.chatsInfoView="chatsInfoView",e.classesintegrationcontent="classesintegrationcontent",e.closedcaptionssettings="closedcaptionssettings",e.coachreport="coachreport",e.codesnippet="codesnippet",e.communities="communities",e.communitiesonboarding="communitiesonboarding",e.connectedcalendardialog="connectedcalendardialog",e.contactssync="contactssync",e.contentcamerasetup="contentcamerasetup",e.coursecalendar="coursecalendar",e.courseteams="courseteams",e.crosspostchannelselectiondialog="crosspostchannelselectiondialog",e.crosspostdeletedialog="crosspostdeletedialog",e.crossTeamAnalytics="crossTeamAnalytics",e.customapp="customapp",e.default="default",e.deletechat="deletechat",e.devicesettings="devicesettings",e.deleteActivityFeedItem="deleteActivityFeedItem",e.discoverappsnotifications="discoverappsnotifications",e.discoversurface="discoversurface",e.dlp="dlp",e.eduteamcreate="eduteamcreate",e.email="email",e.error="error",e.esp="esp",e.example="example",e.extensions="extensions",e.faceenrollment="faceenrollment",e.file="file",e.fileopensettings="fileopensettings",e.filepicker="filepicker",e.filesoneupviewer="filesoneupviewer",e.floodgate="floodgate",e.fluid="fluid",e.flyout="flyout",e.framework="framework",e.freemiumupgrade="freemiumupgrade",e.gallery="gallery",e.galleryImages="galleryImages",e.giphyconsent="giphyconsent",e.givefeedbackchoices="givefeedbackchoices",e.guardians="guardians",e.help="help",e.hostedincontextstore="hostedincontextstore",e.hwctaskmodule="hwctaskmodule",e.hybridplaceholder="hybridplaceholder",e.hyperlink="hyperlink",e.identity="identity",e.identitydialog="identitydialog",e.inAppToast="inAppToast",e.incontextstore="incontextstore",e.invisionwhiteboard="invisionwhiteboard",e.joinlinkdialog="joinlinkdialog",e.leavechat="leavechat",e.leaveGroupAndBlockUser="leaveGroupAndBlockUser",e.licenses="licenses",e.linkedin="linkedin",e.lobnotifications="lobnotifications",e.locationapi="locationapi",e.manageapps="manageapps",e.manageappswebhook="manageappswebhook",e.mediastreams="mediastreams",e.meet="meet",e.meetinganalytics="meetinganalytics",e.meetingapis="meetingapis",e.meetingcollaboration="meetingcollaboration",e.meetingdetails="meetingdetails",e.meetingoptionscreatedialog="meetingoptionscreatedialog",e.meetingrecap="meetingrecap",e.meetingrecaptab="meetingrecaptab",e.meetingroomconsolecall="meetingroomconsolecall",e.meetingroomfrontofroom="meetingroomfrontofroom",e.meetingroomfrontofroomcontent="meetingroomfrontofroomcontent",e.meetingroomfrontofroomgallery="meetingroomfrontofroomgallery",e.meetings="meetings",e.meetingsettings="meetingsettings",e.meetingstream="meetingstream",e.meshavatar="meshavatar",e.messagedraft="messagedraft",e.messages="messages",e.notes="notes",e.oauthcode="oauthcode",e.onboardingnotifications="onboardingnotifications",e.open3sfeedback="open3sfeedback",e.optionssettingsdialog="optionssettingsdialog",e.pearnotdefaultapp="pearnotdefaultapp",e.pinnedchatsmaxreached="pinnedchatsmaxreached",e.pinnedconversationitems="pinnedconversationitems",e.pinunpinpost="pinunpinpost",e.platformapp="platformapp",e.platformappdetails="platformappdetails",e.platformappconsent="platformappconsent",e.platformappdevicepermissions="platformappdevicepermissions",e.platformapps="platformapps",e.platformauthconsentdialog="platformauthconsentdialog",e.platformStage="platformStage",e.platformstageinactivemeeting="platformstageinactivemeeting",e.platformsubscriptionplans="platformsubscriptionplans",e.platformtab="platformtab",e.platformTabGallery="platformTabGallery",e.prejoinoverlaydialog="prejoinoverlaydialog",e.presentertoolbar="presentertoolbar",e.ptzextension="ptzextension",e.registration="registration",e.removechannelemail="removechannelemail",e.removechatuser="removechatuser",e.reportConcern="reportConcern",e.reportConcernForTFW="reportConcernForTFW",e.restartrecomendeddialog="restartrecomendeddialog",e.restorechannel="restorechannel",e.roomremote="roomremote",e.roster="roster",e.schedulingform="schedulingform",e.schoolteams="schoolteams",e.search="search",e.selectMediaApi="selectMediaApi",e.selectpeoplepicker="selectpeoplepicker",e.settingsdialog="settingsdialog",e.settingsstore="settingsstore",e.sharedchannelacceptinvitation="sharedchannelacceptinvitation",e.sharedchanneldeclineinvitation="sharedchanneldeclineinvitation",e.sharedchannelspendinginvites="sharedchannelspendinginvites",e.showformemberdialog="showformemberdialog",e.teamslist="teamslist",e.sharechatlink="sharechatlink",e.shareformdialog="shareformdialog",e.shareMeetingInfo="shareMeetingInfo",e.sharecommunitieslink="sharecommunitieslink",e.reportconcerncommunities="reportconcerncommunities",e.signoutdialog="signoutdialog",e.smartdeviceagendapage="smartdeviceagendapage",e.smartdevicelogin="smartdevicelogin",e.smartdevicelogoutdialog="smartdevicelogoutdialog",e.spaces="spaces",e.stagecontent="stagecontent",e.standaloneapp="standaloneapp",e.stagedapps="stagedapps",e.stagingroomstartmeetingconfirmationdialog="stagingroomstartmeetingconfirmationdialog",e.store="store",e.storefre="storefre",e.streamcamera="streamcamera",e.survey="survey",e.tabapps="tabapps",e.taskmodule="taskmodule",e.teamarchive="teamarchive",e.teamchannels="teamchannels",e.teamcreate="teamcreate",e.teamdeeplink="teamdeeplink",e.teamdiscover="teamdiscover",e.teamedit="teamedit",e.teamsgallery="teamsgallery",e.teamjoin="teamjoin",e.teamjoincode="teamjoincode",e.teamleave="teamleave",e.teammanage="teammanage",e.teamanalytics="teamanalytics",e.teammanageapps="teammanageapps",e.teammanagetags="teammanagetags",e.teampendingrequests="teampendingrequests",e.teampicture="teampicture",e.teamrenewal="teamrenewal",e.teamrestore="teamrestore",e.teams="teams",e.teamsettings="teamsettings",e.tflfre="tflfre",e.toasts="toasts",e.tpndialog="tpndialog",e.transcript="transcript",e.transcriptcontent="transcriptcontent",e.transcripttab="transcripttab",e.translationfeedback="translationfeedback",e.twowaysmsfriendlyname="twowaysmsfriendlyname",e.unparkcalldialog="unparkcalldialog",e.unifiedconsentdialog="unifiedconsentdialog",e.unsupporteddeeplinkdialog="unsupporteddeeplinkdialog",e.updategroupchatavatar="updategroupchatavatar",e.updatemsaprofileavatardialog="updatemsaprofileavatardialog",e.updatemsaprofilenamedialog="updatemsaprofilenamedialog",e.usermediadialog="usermediadialog",e.videobackgrounds="videobackgrounds",e.videoeffectsandavatar="videoeffectsandavatar",e.videoeffectscustomization="videoeffectscustomization",e.videoeffectsmoreview="videoeffectsmoreview",e.viewImagesApi="viewImagesApi",e.virtualevents="virtualevents",e.voiceenrollment="voiceenrollment",e.wiki="wiki",e.windowingerrordialog="windowingerrordialog",e.workflows="workflows",e.yammerqna="yammerqna",e.locationnotification="locationnotification",e.externalnavigation="externalnavigation",e.officeintegrationfredialog="officeintegrationfredialog",e.meetingcollaborationcontent="meetingcollaborationcontent"}(vt||(vt={})),function(e){e.config="config",e.confirm="confirm",e.create="create",e.tenantLogin="tenantLogin",e.default="default",e.delete="delete",e.error="error",e.health="health",e.info="info",e.infoDetails="infoDetails",e.join="join",e.list="list",e.manage="manage",e.mutate="mutate",e.signin="signin",e.update="update",e.view="view",e.share="share",e.leave="leave",e.empty="empty"}(St||(St={})),function(e){e.show="show",e.showWithoutFocusing="showWithoutFocusing",e.hide="hide",e.toggle="toggle"}(ft||(ft={})),function(e){e.none="none",e.flush="flush",e.forceFlush="forceFlush",e.flow="flow",e.forceFlow="forceFlow",e.new="new",e.extend="extend"}(yt||(yt={})),function(e){e.subNavEntity="subNavEntity",e.headerEntity="headerEntity",e.startEntity="startEntity",e.mainEntity="mainEntity",e.endEntity="endEntity"}(kt||(kt={})),function(e){e.minimal="minimal",e.focus="focus",e.standard="standard"}(Ct||(Ct={})),function(e){e.back="back",e.forward="forward"}(bt||(bt={})),function(e){e.Activity="Activity",e.NonHybridLeftRail="NonHybridLeftRail"}(Tt||(Tt={})),function(e){e.HorizontalBar="HorizontalBar",e.Main="Main",e.Modal="Modal",e.Rail="Rail",e.OverlayThinHorizontalBar="OverlayThinHorizontalBar",e.PartialOverlay="PartialOverlay",e.Configurations="Configurations",e.ThinHorizontalBar="ThinHorizontalBar",e.TitleBar="TitleBar",e.VerticalBar="VerticalBar"}(wt||(wt={})),function(e){e.CONTEXTUAL_NOTIFICATIONS="CONTEXTUAL_NOTIFICATIONS",e.END="END",e.HEADER="HEADER",e.MAIN="MAIN",e.MODAL="MODAL",e.NAV="NAV",e.NOTIFICATIONS="NOTIFICATIONS",e.CONFIGURATIONS="CONFIGURATIONS",e.START="START",e.SUBNAV="SUBNAV",e.TITLE_BAR="TITLE_BAR",e.TOASTS="TOASTS"}(_t||(_t={})),function(e){e.Cancelled="Cancelled",e.Closed="Closed",e.Confirmed="Confirmed",e.Error="Error",e.Open="Open"}(It||(It={})),function(e){e.ContentAndPeople="ContentAndPeople",e.ContentOnly="ContentOnly",e.PeopleOnly="PeopleOnly"}(At||(At={})),function(e){e.organization="organization"}(Nt||(Nt={})),function(e){e.whiteboard="whiteboard",e.document="document",e.video="video",e.none="none"}(Et||(Et={})),function(e){e.Video="Video",e.ScreenSharing="ScreenSharing"}(Dt||(Dt={})),function(e){e.Single="Single",e.TwoLargeLeft="TwoLargeLeft"}(Ft||(Ft={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(Pt||(Pt={})),function(e){e.Single="Single",e.Left="Left",e.Right="Right"}(Mt||(Mt={})),function(e){e.ScreenSharing="ScreenSharing",e.Video="Video"}(jt||(jt={})),function(e){e.Fade="Fade",e.Off="Off",e.On="On"}(Rt||(Rt={})),function(e){e.Compose="Compose",e.Paste="Paste"}(xt||(xt={})),function(e){e.NonEmbed="NonEmbed",e.Embed="Embed"}(Ot||(Ot={})),function(e){e.Cache="Cache",e.Network="Network"}(Lt||(Lt={})),function(e){e.QuickStart="QuickStart",e.BYOE="BYOE",e.QuickStartPushToStream="QuickStartPushToStream",e.Overflow="Overflow",e.ODSP="ODSP"}(Ut||(Ut={})),function(e){e.Opening="Opening",e.OpeningFailed="OpeningFailed",e.Closing="Closing",e.ClosingFailed="ClosingFailed",e.Deleting="Deleting",e.DeletingFailed="DeletingFailed"}(Bt||(Bt={})),function(e){e.aggregatefiles="aggregatefiles",e.customspo="customspo",e.downloads="downloads",e.p2p="p2p",e.personal="personal",e.recent="recent",e.teams="teams",e.teamsSdk="teamsSdk"}(Wt||(Wt={})),function(e){e.Manual="Manual",e.Automatic="Automatic"}(Gt||(Gt={})),function(e){e.Initial="Initial",e.Creating="Creating",e.AlreadyExist="AlreadyExist",e.Failed="Failed"}(Vt||(Vt={})),function(e){e.Saving="Saving",e.Loading="Loading",e.FailedToLoad="FailedToLoad",e.FailedToSave="FailedToSave",e.Success="Success"}(Ht||(Ht={})),function(e){e.AdaptiveCardTab="AdaptiveCardTab",e.BotConfig="BotConfig",e.Card="Card",e.ContentBubble="ContentBubble",e.DeepLink="DeepLink",e.MessageExtension="MessageExtension",e.PlatformExtensionTab="PlatformExtensionTab",e.ShareToOutlook="ShareToOutlook"}($t||($t={})),function(e){e.CancelledByUser="CancelledByUser",e.Done="Done"}(zt||(zt={})),function(e){e.AutoAdjust="AutoAdjust",e.BackgroundBlur="BackgroundBlur",e.BackgroundReplace="BackgroundReplace",e.EyeContact="EyeContact",e.Greenscreen="Greenscreen",e.Off="Off",e.TouchUp="TouchUp",e.WhiteboardCleanup="WhiteboardCleanup",e.WhiteboardZoom="WhiteboardZoom",e.WhiteboardZoomAndCleanup="WhiteboardZoomAndCleanup"}(qt||(qt={})),function(e){e.Error="Error",e.Loading="Loading",e.ModelNotReady="ModelNotReady",e.NotReady="NotReady",e.Off="Off",e.On="On",e.Unavailable="Unavailable"}(Jt||(Jt={})),function(e){e.Everyone="Everyone",e.EveryoneInCompany="EveryoneInCompany",e.None="None"}(Qt||(Qt={})),function(e){e.MultiChoice="MultiChoice",e.MultiLineText="MultiLineText",e.SingleChoice="SingleChoice",e.SingleLineText="SingleLineText"}(Kt||(Kt={})),function(e){e.CreateEventEnableRegistration="CreateEventEnableRegistration",e.GetRegistrationInformation="GetRegistrationInformation",e.RemoveRegistration="RemoveRegistration",e.UpdateEventDisableRegistration="UpdateEventDisableRegistration",e.UpdateEventEnableRegistration="UpdateEventEnableRegistration"}(Yt||(Yt={})),function(e){e.Standard="Standard",e.PlazaRoom="PlazaRoom"}(Xt||(Xt={})),function(e){e.Uninitialised="Uninitialised",e.InProgress="InProgress",e.Resolved="Resolved",e.Rejected="Rejected"}(Zt||(Zt={})),function(e){e.FileAttachment="FileAttachment",e.ItemAttachment="ItemAttachment",e.ReferenceAttachment="ReferenceAttachment"}(en||(en={})),function(e){e.Optional="Optional",e.Organizer="Organizer",e.Required="Required",e.Resource="Resource",e.Room="Room"}(tn||(tn={})),function(e){e.User="User",e.Admin="Admin",e.Guest="Guest",e.None="None"}(nn||(nn={})),function(e){e.SecurityGroup="SecurityGroup",e.StreamGroup="StreamGroup"}(an||(an={})),function(e){e.collaborativeSpace="collaborativeSpace"}(on||(on={})),function(e){e.TeamsCalendarDetailsPage="TeamsCalendarDetailsPage",e.TeamsCalendarScheduling="TeamsCalendarScheduling",e.TeamsInMeeting="TeamsInMeeting"}(rn||(rn={})),function(e){e.Disabled="Disabled",e.Enabled="Enabled"}(sn||(sn={})),function(e){e.Message="Message"}(ln||(ln={})),function(e){e.ApplyClicked="ApplyClicked",e.Other="Other"}(dn||(dn={})),function(e){e.Exception="Exception",e.Occurrence="Occurrence",e.RecurringMaster="RecurringMaster",e.Single="Single"}(cn||(cn={})),function(e){e.updated="updated",e.notUpdated="notUpdated"}(un||(un={})),function(e){e.Cancel="Cancel",e.Publish="Publish"}(mn||(mn={})),function(e){e.BookFollowUpMeeting="BookFollowUpMeeting",e.CheckAttendance="CheckAttendance",e.DropCurrentMeeting="DropCurrentMeeting",e.JoinNextMeeting="JoinNextMeeting",e.MuteAllParticipants="MuteAllParticipants",e.OpenBotInMeetingChat="OpenBotInMeetingChat",e.OpenFeedback="OpenFeedback",e.PostMeetingStartedEvent="PostMeetingStartedEvent",e.RemindInMeetingChat="RemindInMeetingChat",e.SendRunningLateMessage="SendRunningLateMessage",e.ShareCurrentMeeting="ShareCurrentMeeting",e.ShareFile="ShareFile",e.ShareFiles="ShareFiles",e.ShareMyScreen="ShareMyScreen",e.SharePresentedDeck="SharePresentedDeck",e.ShowDeviceSettings="ShowDeviceSettings",e.ShowMeetingOptions="ShowMeetingOptions",e.ShowMissingParticipants="ShowMissingParticipants",e.StartLiveCaptions="StartLiveCaptions",e.StartRecording="StartRecording",e.StartTranscription="StartTranscription",e.StopLiveCaptions="StopLiveCaptions",e.StopRecording="StopRecording",e.StopTranscription="StopTranscription"}(gn||(gn={})),function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"}(pn||(pn={})),function(e){e.Speaker="Speaker"}(hn||(hn={})),function(e){e.Vtt="Vtt",e.Docx="Docx",e.Pdf="Pdf"}(vn||(vn={})),function(e){e.anonymous="anonymous",e.organization="organization",e.users="users"}(Sn||(Sn={})),function(e){e.view="view",e.edit="edit"}(fn||(fn={})),function(e){e.MediaPaused="MediaPaused",e.MediaPlayed="MediaPlayed",e.MediaStopped="MediaStopped",e.MediaSeeked="MediaSeeked",e.MediaVolumeChanged="MediaVolumeChanged"}(yn||(yn={})),function(e){e.rotate_0="rotate_0",e.rotate_90="rotate_90",e.rotate_180="rotate_180",e.rotate_270="rotate_270"}(kn||(kn={})),function(e){e.list="list",e.grid="grid"}(Cn||(Cn={})),function(e){e.NotSupported="NotSupported",e.Unavailable="Unavailable",e.Available="Available"}(bn||(bn={})),function(e){e.LIS="LIS",e.CLS="CLS",e.Assist="Assist",e.Manual="Manual",e.Registered="Registered",e.None="None"}(Tn||(Tn={})),function(e){e.CommandResetError="CommandResetError",e.CommandZoomInError="CommandZoomInError",e.CommandZoomOutError="CommandZoomOutError",e.CommandPanLeftError="CommandPanLeftError",e.CommandPanRightError="CommandPanRightError",e.CommandTiltUpError="CommandTiltUpError",e.CommandTiltDownError="CommandTiltDownError",e.SendDataError="SendDataError"}(wn||(wn={})),function(e){e.None="None",e.ControlDenied="ControlDenied",e.ControlNoResponse="ControlNoResponse",e.ControlBusy="ControlBusy",e.AckTimeout="AckTimeout",e.ControlTerminated="ControlTerminated",e.ControllerTerminated="ControllerTerminated",e.DataChannelError="DataChannelError",e.ControllerCancelled="ControllerCancelled",e.ControlDisabled="ControlDisabled",e.ControlTerminatedToAllowOtherController="ControlTerminatedToAllowOtherController"}(_n||(_n={})),function(e){e.None="None",e.Disabled="Disabled",e.Pending="Pending",e.Waiting="Waiting",e.Started="Started",e.Stopped="Stopped",e.Failed="Failed"}(In||(In={})),function(e){e.None="None",e.Started="Started",e.Stopped="Stopped",e.Pending="Pending",e.Failed="Failed",e.Disabled="Disabled"}(An||(An={})),function(e){e.ImplicitActionItems="ImplicitActionItems",e.ManualActionItems="ManualActionItems"}(Nn||(Nn={})),function(e){e.ImplicitActionItem="ImplicitActionItem",e.ExplicitActionItem="ExplicitActionItem"}(En||(En={})),function(e){e.Low="Low",e.High="High"}(Dn||(Dn={})),function(e){e.Unassigned="Unassigned",e.Commitment="Commitment",e.Request="Request",e.Delegation="Delegation"}(Fn||(Fn={})),function(e){e.Done="Done",e.InProcess="InProcess",e.NotStarted="NotStarted",e.ScoreTooLow="ScoreTooLow",e.TooManyCharacters="TooManyCharacters",e.UnknownError="UnknownError",e.TranslationNotNeeded="TranslationNotNeeded",e.ShowOriginalMessage="ShowOriginalMessage",e.MessageNotFound="MessageNotFound",e.VersionNotFound="VersionNotFound",e.LanguageDetectionFailed="LanguageDetectionFailed",e.UnsupportedSourceLanguage="UnsupportedSourceLanguage",e.ClientMutationThrottled="ClientMutationThrottled"}(Pn||(Pn={})),function(e){e.GetByKey="GetByKey",e.Put="Put",e.Delete="Delete",e.DeleteCardData="DeleteCardData",e.GetAuthBlockLastUsage="GetAuthBlockLastUsage",e.PutAuthBlockLastUsage="PutAuthBlockLastUsage"}(Mn||(Mn={})),function(e){e.NotControlCapable="NotControlCapable",e.Disabled="Disabled",e.NotInControl="NotInControl",e.RequestSent="RequestSent",e.InControl="InControl"}(jn||(jn={})),function(e){e.Monitor="Monitor",e.Window="Window",e.Camera="Camera"}(Rn||(Rn={})),function(e){e.NotStarted="NotStarted",e.Starting="Starting",e.Started="Started",e.Stopping="Stopping",e.Stopped="Stopped"}(xn||(xn={})),function(e){e.Offline="Offline",e.InitFailed="InitFailed",e.JoinFailed="JoinFailed",e.AcceptFailed="AcceptFailed"}(On||(On={})),function(e){e.None="None",e.Normal="Normal",e.Deep="Deep",e.PNS="PNS"}(Ln||(Ln={})),function(e){e.Auto="Auto",e.High="High",e.Low="Low",e.Medium="Medium",e.None="None"}(Un||(Un={})),function(e){e.OngoingCall="OngoingCall",e.Meeting="Meeting",e.OneToOneCall="OneToOneCall",e.GroupCall="GroupCall"}(Bn||(Bn={})),function(e){e.Legacy="Legacy",e.MeetingData="MeetingData"}(Wn||(Wn={})),function(e){e.Default="Default",e.LongrangeSpeaker="LongrangeSpeaker",e.Auditorium="Auditorium"}(Gn||(Gn={})),function(e){e.MeetingCoach="MeetingCoach",e.MeetingInfo="MeetingInfo",e.MeetingInfoV3="MeetingInfoV3",e.AttendanceReport="AttendanceReport",e.AttendanceReportV3="AttendanceReportV3",e.ExternalParticipants="ExternalParticipants",e.ExplicitActionItems="ExplicitActionItems",e.ImplicitActionItems="ImplicitActionItems",e.Decisions="Decisions",e.Notes="Notes",e.Playground="Playground",e.ManualActionItems="ManualActionItems",e.NgcParticipantsActivity="NgcParticipantsActivity",e.Transcript="Transcript",e.TranscriptEntities="TranscriptEntities",e.TranscriptEvents="TranscriptEvents",e.Recording="Recording",e.MeetingContent="MeetingContent",e.MeetingStage="MeetingStage",e.MeetingChat="MeetingChat"}(Vn||(Vn={})),function(e){e.Default="Default",e.Room="Room"}(Hn||(Hn={})),function(e){e.AMS="AMS",e.MiddleLaneUltraLowLatency="MiddleLaneUltraLowLatency",e.MiddleLaneHttpLiveStreaming="MiddleLaneHttpLiveStreaming"}($n||($n={})),function(e){e.RTMPInput="RTMPInput"}(zn||(zn={})),function(e){e.Audio="Audio",e.Video="Video",e.PanoramicVideo="PanoramicVideo",e.ScreenShare="ScreenShare",e.Data="Data",e.ParticipantVideo_0="ParticipantVideo_0",e.ParticipantVideo_1="ParticipantVideo_1",e.ParticipantVideo_2="ParticipantVideo_2",e.ParticipantVideo_3="ParticipantVideo_3"}(qn||(qn={})),function(e){e.Unknown="Unknown",e.Standard="Standard",e.Reserved="Reserved"}(Jn||(Jn={})),function(e){e.Room="Room",e.Workspace="Workspace",e.RoomList="RoomList"}(Qn||(Qn={})),function(e){e.PresenceUnknown="PresenceUnknown",e.Available="Available",e.AvailableIdle="AvailableIdle",e.Away="Away",e.Busy="Busy",e.BusyIdle="BusyIdle",e.DoNotDisturb="DoNotDisturb",e.BeRightBack="BeRightBack",e.Offline="Offline"}(Kn||(Kn={})),function(e){e.InACall="InACall",e.InAConferenceCall="InAConferenceCall",e.InAMeeting="InAMeeting",e.Presenting="Presenting",e.OffWork="OffWork",e.Available="Available",e.Inactive="Inactive",e.Busy="Busy",e.DoNotDisturb="DoNotDisturb",e.BeRightBack="BeRightBack",e.Away="Away",e.Offline="Offline",e.UrgentInterruptionsOnly="UrgentInterruptionsOnly",e.PresenceUnknown="PresenceUnknown",e.OutOfOffice="OutOfOffice"}(Yn||(Yn={})),function(e){e.None="None",e.OnShift="OnShift",e.OffShift="OffShift"}(Xn||(Xn={})),function(e){e.Chat="Chat",e.PhoneChat="PhoneChat",e.Meeting="Meeting",e.SfBInteropChat="SfBInteropChat"}(Zn||(Zn={})),function(e){e.AcceptPending="AcceptPending",e.Accepted="Accepted",e.Blocked="Blocked",e.Quarantined="Quarantined",e.ExtendedDirectoryAcceptPending="ExtendedDirectoryAcceptPending"}(ei||(ei={})),function(e){e.Unknown="Unknown",e.Office="Office",e.Remote="Remote"}(ti||(ti={})),function(e){e.ChatEnabled="ChatEnabled",e.ChatDisabled="ChatDisabled",e.InMeeting="InMeeting",e.ChatEnabledAnonymousDisabled="ChatEnabledAnonymousDisabled",e.InMeetingAnonymousDisabled="InMeetingAnonymousDisabled"}(ni||(ni={})),function(e){e.OptedOut="OptedOut",e.Deprovisioned="Deprovisioned",e.Claimed="Claimed"}(ii||(ii={})),function(e){e.Importing="Importing",e.Completed="Completed"}(ai||(ai={})),function(e){e.None="None",e.Admin="Admin",e.User="User",e.Guest="Guest",e.Shadow="Shadow",e.Anonymous="Anonymous"}(oi||(oi={})),function(e){e.Standard="Standard",e.MeetingControl="MeetingControl",e.MeetingRecording="MeetingRecording",e.MeetingTranscript="MeetingTranscript"}(ri||(ri={})),function(e){e.top="top",e.bottom="bottom"}(si||(si={})),function(e){e.LOADED="LOADED",e.DELETED="DELETED",e.INVALID="INVALID",e.NOTFOUND="NOTFOUND"}(li||(li={})),function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(di||(di={})),function(e){e.Email="Email",e.Call="Call",e.PSTN="PSTN",e.SMS="SMS",e.TeamsCall="TeamsCall",e.ETNP="ETNP"}(ci||(ci={})),function(e){e.Delivered="Delivered",e.Sending="Sending",e.Error="Error",e.Undeliverable="Undeliverable"}(ui||(ui={})),function(e){e.Standard="Standard",e.Important="Important",e.Urgent="Urgent"}(mi||(mi={})),function(e){e.Everyone="Everyone",e.AuthorAndOwners="AuthorAndOwners",e.Undefined="Undefined"}(gi||(gi={})),function(e){e.Standard="Standard",e.Announcement="Announcement",e.Email="Email",e.ScheduledMeeting="ScheduledMeeting",e.InstantMeeting="InstantMeeting",e.Connector="Connector",e.Guardians="Guardians"}(pi||(pi={})),function(e){e.Sent="Sent",e.sent="sent",e.Failed="Failed",e.failed="failed"}(hi||(hi={})),function(e){e.Hold="Hold",e.Resume="Resume",e.Barge="Barge"}(vi||(vi={})),function(e){e.Default="Default",e.ScreenSharing="ScreenSharing",e.EmergencyGroupCall="EmergencyGroupCall",e.Unknown="Unknown"}(Si||(Si={})),function(e){e.MultiParty="MultiParty",e.TwoParty="TwoParty",e.Unknown="Unknown"}(fi||(fi={})),function(e){e.Accepted="Accepted",e.AcceptedElsewhere="AcceptedElsewhere",e.Declined="Declined",e.Missed="Missed",e.Unknown="Unknown"}(yi||(yi={})),function(e){e.Outgoing="Outgoing",e.Incoming="Incoming",e.Unknown="Unknown"}(ki||(ki={})),function(e){e.Transferred="Transferred",e.TransferAccepted="TransferAccepted",e.TransferFailed="TransferFailed",e.TransferSucceeded="TransferSucceeded",e.Unknown="Unknown"}(Ci||(Ci={})),function(e){e.Immediate="Immediate",e.Simultaneous="Simultaneous",e.Unanswered="Unanswered"}(bi||(bi={})),function(e){e.Voicemail="Voicemail",e.SingleTarget="SingleTarget",e.MyDelegates="MyDelegates",e.DoNothing="DoNothing",e.Group="Group"}(Ti||(Ti={})),function(e){e.PlayBusySignal="PlayBusySignal",e.RedirectAsUnansweredCall="RedirectAsUnansweredCall",e.RingUser="RingUser"}(wi||(wi={})),function(e){e.Regular="Regular",e.CallQueue="CallQueue",e.CallGroup="CallGroup",e.Delegate="Delegate",e.MeetingStartedReminder="MeetingStartedReminder"}(_i||(_i={})),function(e){e.Ring="Ring",e.Bop="Bop",e.Bounce="Bounce",e.Bubbles="Bubbles",e.DripDrop="DripDrop",e.Eureka="Eureka",e.Flutter="Flutter",e.HighScore="HighScore",e.NextLevel="NextLevel",e.Plink="Plink",e.RingRing="RingRing",e.Ripple="Ripple",e.Spacetime="Spacetime",e.WishGranted="WishGranted",e.Wobble="Wobble",e.BubblesLoud="BubblesLoud",e.Remix="Remix"}(Ii||(Ii={})),function(e){e.Unknown="Unknown",e.NetworkError="NetworkError",e.NetworkOffline="NetworkOffline",e.ValidationError="ValidationError",e.DeserializationError="DeserializationError",e.NotImplemented="NotImplemented",e.CalendarEventCreationFailedOccurrenceTimeSpanTooBig="CalendarEventCreationFailedOccurrenceTimeSpanTooBig",e.ErrorOccurrenceTimeSpanTooBig="ErrorOccurrenceTimeSpanTooBig",e.CalendarEventEndDateIsEarlierThanStartDate="CalendarEventEndDateIsEarlierThanStartDate",e.ErrorCalendarEndDateIsEarlierThanStartDate="ErrorCalendarEndDateIsEarlierThanStartDate",e.CalendarEventNotFound="CalendarEventNotFound",e.ErrorItemNotFound="ErrorItemNotFound",e.CalendarEventNull="CalendarEventNull",e.HtmlViewNotPresent="HtmlViewNotPresent",e.EmptySchedulingServiceMeetingSettings="EmptySchedulingServiceMeetingSettings",e.EmptySchedulingServiceEvent="EmptySchedulingServiceEvent",e.ErrorCalendarIsOrganizerForRsvp="ErrorCalendarIsOrganizerForRsvp",e.ErrorCalendarIsOrganizerForAccept="ErrorCalendarIsOrganizerForAccept",e.ErrorCalendarIsOrganizerForDecline="ErrorCalendarIsOrganizerForDecline",e.ErrorCalendarIsOrganizerForTentative="ErrorCalendarIsOrganizerForTentative",e.ErrorCalendarIsCancelledForRsvp="ErrorCalendarIsCancelledForRsvp",e.ErrorCalendarIsCancelledForAccept="ErrorCalendarIsCancelledForAccept",e.ErrorCalendarIsCancelledForDecline="ErrorCalendarIsCancelledForDecline",e.ErrorCalendarIsCancelledForTentative="ErrorCalendarIsCancelledForTentative",e.ExchangeInvalidLicense="ExchangeInvalidLicense",e.ErrorInvalidLicense="ErrorInvalidLicense",e.ErrorInvalidRecipients="ErrorInvalidRecipients",e.ErrorNonExistentMailbox="ErrorNonExistentMailbox",e.ErrorTimeZone="ErrorTimeZone",e.ErrorOccurrenceCrossingBoundary="ErrorOccurrenceCrossingBoundary",e.ErrorCalendarIsNotOrganizer="ErrorCalendarIsNotOrganizer",e.ErrorInSchedulingServiceOutdatedEvent="ErrorInSchedulingServiceOutdatedEvent",e.InvalidCancellationMessageFormat="InvalidCancellationMessageFormat",e.InvalidConversationId="InvalidConversationId",e.InvalidExchangeId="InvalidExchangeId",e.InvalidICalUid="InvalidICalUid",e.InvalidMailboxAddress="InvalidMailboxAddress",e.InvalidMailboxAddressOrGuid="InvalidMailboxAddressOrGuid",e.InvalidMeetingOrganizer="InvalidMeetingOrganizer",e.InvalidUpdateMessageFormat="InvalidUpdateMessageFormat",e.ConnectedAccountNotFound="ConnectedAccountNotFound",e.ShadowMailboxDeleted="ShadowMailboxDeleted",e.ShadowTokenRevoked="ShadowTokenRevoked",e.ShadowTokenExpired="ShadowTokenExpired"}(Ai||(Ai={})),function(e){e.Recording="Recording",e.Notes="Notes",e.AttendanceReport="AttendanceReport",e.Transcript="Transcript",e.SuggestedTasksSession="SuggestedTasksSession",e.MeetingContent="MeetingContent",e.Document="Document",e.PowerPoint="PowerPoint",e.Whiteboard="Whiteboard",e.Attachments="Attachments"}(Ni||(Ni={})),function(e){e.CHANNEL="CHANNEL"}(Ei||(Ei={})),function(e){e.Anonymous="Anonymous",e.AllCompany="AllCompany",e.InvitationOnly="InvitationOnly"}(Di||(Di={})),function(e){e.Free="Free",e.Tentative="Tentative",e.Busy="Busy",e.Oof="Oof",e.WorkingElsewhere="WorkingElsewhere",e.Unknown="Unknown"}(Fi||(Fi={})),function(e){e.None="None",e.Organizer="Organizer",e.Tentative="Tentative",e.Accepted="Accepted",e.Declined="Declined",e.NotResponded="NotResponded"}(Pi||(Pi={})),function(e){e.None="None",e.InPerson="InPerson",e.Virtual="Virtual"}(Mi||(Mi={})),function(e){e.Created="Created",e.Activated="Activated",e.Abandoned="Abandoned",e.Suspended="Suspended",e.Live="Live",e.Stopped="Stopped",e.Deleted="Deleted",e.Recreated="Recreated",e.Hidden="Hidden"}(ji||(ji={})),function(e){e.Mobile="Mobile",e.Business="Business",e.Home="Home",e.Other="Other"}(Ri||(Ri={})),function(e){e.Delete="Delete"}(xi||(xi={})),function(e){e.Team="Team",e.Edu="Edu",e.Class="Class",e.Plc="Plc",e.Staff="Staff",e.HealthcareCareCoordination="HealthcareCareCoordination",e.Community="Community"}(Oi||(Oi={})),function(e){e.None="None",e.Private="Private",e.Secret="Secret",e.Public="Public",e.HiddenMembership="HiddenMembership",e.Unknown="Unknown",e.All="All"}(Li||(Li={})),function(e){e.Standard="Standard",e.Private="Private",e.Shared="Shared"}(Ui||(Ui={})),function(e){e.Locked="Locked",e.PartialSuccess="PartialSuccess",e.Failed="Failed",e.Unlocked="Unlocked"}(Bi||(Bi={})),function(e){e.Strict="Strict",e.Moderate="Moderate",e.NoRestriction="NoRestriction"}(Wi||(Wi={})),function(e){e.Pinned="Pinned",e.Unpinned="Unpinned"}(Gi||(Gi={})),function(e){e.RoleUpdatePromotion="RoleUpdatePromotion",e.SystemRoleUpdatePromotion="SystemRoleUpdatePromotion",e.RoleUpdateDemotion="RoleUpdateDemotion",e.SystemRoleUpdateDemotion="SystemRoleUpdateDemotion"}(Vi||(Vi={})),function(e){e.Everyone="Everyone",e.Moderators="Moderators"}(Hi||(Hi={})),function(e){e.Everyone="Everyone",e.Moderators="Moderators"}($i||($i={})),function(e){e.Domains="Domains",e.Members="Members",e.Anyone="Anyone"}(zi||(zi={})),function(e){e.zap="zap",e.dlp="dlp",e.cc="cc"}(qi||(qi={})),function(e){e.active="active",e.deleted="deleted",e.reference="reference",e.hidden="hidden"}(Ji||(Ji={})),function(e){e.active="active",e.deleted="deleted",e.reference="reference",e.hidden="hidden"}(Qi||(Qi={})),function(e){e.Camera="Camera",e.Microphone="Microphone",e.Speaker="Speaker"}(Ki||(Ki={})),function(e){e.Info="Info",e.Warning="Warning",e.Error="Error",e.Standalone="Standalone"}(Yi||(Yi={})),function(e){e.AcceptBreakoutRoomInvite="AcceptBreakoutRoomInvite",e.AllowControl="AllowControl",e.betterTogetherTransferCall="betterTogetherTransferCall",e.BroadcastLearnMore="BroadcastLearnMore",e.BroadcastModalityReconnect="BroadcastModalityReconnect",e.CloseVideoApp="CloseVideoApp",e.MeetingAttendeeUfdRaiseHand="MeetingAttendeeUfdRaiseHand",e.DeclineBreakoutRoomInvite="DeclineBreakoutRoomInvite",e.DenyControl="DenyControl",e.DownloadApp="DownloadApp",e.MuteSpeakerAndMicAudio="MuteSpeakerAndMicAudio",e.NdiPrivacyPolicyCapturer="NdiPrivacyPolicyCapturer",e.PrivacyPolicyParticipant="PrivacyPolicyParticipant",e.OpenAudioEscalationDialog="OpenAudioEscalationDialog",e.SwitchDevice="SwitchDevice",e.OpenDeviceSettings="OpenDeviceSettings",e.OpenLearnMoreLink="OpenLearnMoreLink",e.OpenMeetingInfo="OpenMeetingInfo",e.OpenPrivacyPolicyLink="OpenPrivacyPolicyLink",e.OpenVideoDevicePermission="OpenVideoDevicePermission",e.OptOutFromVoiceCollection="OptOutFromVoiceCollection",e.CloseVoiceCollection="CloseVoiceCollection",e.PaywallUpgrade="PaywallUpgrade",e.PstnDialInManually="PstnDialInManually",e.PstnDialOutManually="PstnDialOutManually",e.RejoinAsGuest="RejoinAsGuest",e.ReportScdFailure="ReportScdFailure",e.ShowPstnDialog="ShowPstnDialog",e.StartChromeExtensionInstallation="StartChromeExtensionInstallation",e.StartContentSharing="StartContentSharing",e.StartScreenSharingOnCall="StartScreenSharingOnCall",e.StartTranscript="StartTranscript",e.StartRecording="StartRecording",e.SwitchMicrophone="SwitchMicrophone",e.SwitchShareContent="SwitchShareContent",e.ViewLobby="ViewLobby",e.TerminateControl="TerminateControl",e.TakePptSharingControl="TakePptSharingControl",e.TryAgain="TryAgain",e.TurnCameraOn="TurnCameraOn",e.ToggleHighFidelityMusicMode="ToggleHighFidelityMusicMode",e.UnmuteMicAudio="UnmuteMicAudio",e.UnmuteSpeakers="UnmuteSpeakers",e.StartMeeting="StartMeeting",e.EnableScreenshareRecording="EnableScreenshareRecording",e.DisableIncomingAndOutgoingVideo="DisableIncomingAndOutgoingVideo",e.UnmuteMicAndSpeakers="UnmuteMicAndSpeakers",e.OpenInterpretationDialog="OpenInterpretationDialog",e.ControlRoomSystemPanel="ControlRoomSystemPanel",e.Cancel="Cancel",e.ViewBreakoutRooms="ViewBreakoutRooms",e.LowerHandNow="LowerHandNow",e.KeepHandRaised="KeepHandRaised",e.LowerHand="LowerHand"}(Xi||(Xi={})),function(e){e.ACSUserJoined="ACSUserJoined",e.ACSUserLimitedCapabilities="ACSUserLimitedCapabilities",e.AddMemberToChatFailed="AddMemberToChatFailed",e.APLDisabledInCompanionMode="APLDisabledInCompanionMode",e.AttendeeBringOffStageAlert="AttendeeBringOffStageAlert",e.AttendeeBringOnStageAlert="AttendeeBringOnStageAlert",e.AttendeeHostViewModeActivated="AttendeeHostViewModeActivated",e.AttendeeHostViewModeActivatedRaiseHand="AttendeeHostViewModeActivatedRaiseHand",e.AttendeeHostViewModeDeactivated="AttendeeHostViewModeDeactivated",e.AudioCaptureMusicDetectedWithHighNS="AudioCaptureMusicDetectedWithHighNS",e.AudioCaptureMusicDetectedWithLowNS="AudioCaptureMusicDetectedWithLowNS",e.AudioCaptureUltrasoundDetected="AudioCaptureUltrasoundDetected",e.AudioCaptureUltrasoundDetectedWithUnmuteButton="AudioCaptureUltrasoundDetectedWithUnmuteButton",e.AudioCaptureUltrasoundDetectedWithMuteButton="AudioCaptureUltrasoundDetectedWithMuteButton",e.AudienceViewFailed="AudienceViewFailed",e.AudienceViewSceneAck="AudienceViewSceneAck",e.AudienceViewSceneChanged="AudienceViewSceneChanged",e.AudienceViewSceneChangeFailed="AudienceViewSceneChangeFailed",e.BetterTogetherOutOfProximityWarning="BetterTogetherOutOfProximityWarning",e.Bmc_setLayout_command_failure="Bmc_setLayout_command_failure",e.Bmc_setLayout_command_video_stall="Bmc_setLayout_command_video_stall",e.Bmc_start_command_failure="Bmc_start_command_failure",e.Bmc_stop_command_failure="Bmc_stop_command_failure",e.Bmc_restart_command_failure="Bmc_restart_command_failure",e.BreakoutRoomAnnouncement="BreakoutRoomAnnouncement",e.BreakoutRoomsBulkMoveFailure="BreakoutRoomsBulkMoveFailure",e.BreakoutRoomsControlLost="BreakoutRoomsControlLost",e.BreakoutRoomsPanelClosedOnRoomsDeleted="BreakoutRoomsPanelClosedOnRoomsDeleted",e.BreakoutRoomsParticipantHasNoRoomsToChoose="BreakoutRoomsParticipantHasNoRoomsToChoose",e.BreakoutRoomsParticipantHasRoomsToChoose="BreakoutRoomsParticipantHasRoomsToChoose",e.BreakoutRoomCannotMoveDisconnectedParticipants="BreakoutRoomCannotMoveDisconnectedParticipants",e.BreakoutRoomCloseCreateBrDialog="BreakoutRoomCloseCreateBrDialog",e.BreakoutRoomCreationFailed="BreakoutRoomCreationFailed",e.BreakoutRoomEnding="BreakoutRoomEnding",e.BreakoutRoomInvite="BreakoutRoomInvite",e.BreakoutRoomLockXlMeeting="BreakoutRoomLockXlMeeting",e.BreakoutRoomBulkCreationFailed="BreakoutRoomBulkCreationFailed",e.BreakoutRoomBulkCreationSucceeded="BreakoutRoomBulkCreationSucceeded",e.BreakoutRoomBulkCreationFailedRoomsAlreadyExist="BreakoutRoomBulkCreationFailedRoomsAlreadyExist",e.BreakoutRoomOptimisticOpenStarted="BreakoutRoomOptimisticOpenStarted",e.BreakoutRoomOptimisticCloseStarted="BreakoutRoomOptimisticCloseStarted",e.Broadcast_captions_disabled_by_ETM="Broadcast_captions_disabled_by_ETM",e.Broadcast_concurrent_videos_limit="Broadcast_concurrent_videos_limit",e.Broadcast_end_warning="Broadcast_end_warning",e.Broadcast_ipvideo_permission="Broadcast_ipvideo_permission",e.Broadcast_ipvideo_vbss_permission="Broadcast_ipvideo_vbss_permission",e.Broadcast_noCamera="Broadcast_noCamera",e.Broadcast_preview_overflow_warning="Broadcast_preview_overflow_warning",e.Broadcast_reset_done="Broadcast_reset_done",e.Broadcast_vbss_permission="Broadcast_vbss_permission",e.BroadcastModalityDisconnected="BroadcastModalityDisconnected",e.BroadcastModalityNotReceived="BroadcastModalityNotReceived",e.BroadcastMutedProducerWarning="BroadcastMutedProducerWarning",e.BroadcastStopped="BroadcastStopped",e.CameraUnmuteTakesLongerTime="CameraUnmuteTakesLongerTime",e.CannotUnmuteOSMicrophone="CannotUnmuteOSMicrophone",e.ClosedCaptionsStartFailed="ClosedCaptionsStartFailed",e.CoachNotification="CoachNotification",e.CoachStarted="CoachStarted",e.CoachStartFailed="CoachStartFailed",e.CoachStopped="CoachStopped",e.CoachStopFailed="CoachStopFailed",e.ComplianceRecordingE2EEJoinError="ComplianceRecordingE2EEJoinError",e.ComplianceRecordingStarted="ComplianceRecordingStarted",e.ComplianceRecordingStopped="ComplianceRecordingStopped",e.ConsentToRecordingError="ConsentToRecordingError",e.ContentOnlyAlert="ContentOnlyAlert",e.ContentOnlyFromNudgeAlert="ContentOnlyFromNudgeAlert",e.ContentSharingFailed="ContentSharingFailed",e.ControlRoomSystemAlert="ControlRoomSystemAlert",e.CpuInsufficient="CpuInsufficient",e.CurrentMeetingIsXL="CurrentMeetingIsXL",e.DenyConsentToRecordingError="DenyConsentToRecordingError",e.DeviceAtCallStart="DeviceAtCallStart",e.DeviceCaptureMute="DeviceCaptureMute",e.DeviceCaptureNotFunctioning="DeviceCaptureNotFunctioning",e.DeviceCaptureNotFunctioningAudioSrvNotRunning="DeviceCaptureNotFunctioningAudioSrvNotRunning",e.DeviceCaptureNotMuteButSilent="DeviceCaptureNotMuteButSilent",e.DeviceClipping="DeviceClipping",e.DeviceHowling="DeviceHowling",e.DeviceLowSNR="DeviceLowSNR",e.DeviceMultipleEndpoints="DeviceMultipleEndpoints",e.DeviceNearEndToEchoRatio="DeviceNearEndToEchoRatio",e.DeviceRenderHowling="DeviceRenderHowling",e.DeviceRenderMute="DeviceRenderMute",e.DeviceRenderNotFunctioning="DeviceRenderNotFunctioning",e.DeviceRenderNotFunctioningAudioSrvNotRunning="DeviceRenderNotFunctioningAudioSrvNotRunning",e.DeviceRenderZeroVolume="DeviceRenderZeroVolume",e.DeviceSpeakWhileMuted="DeviceSpeakWhileMuted",e.DisableIncomingMeetingAudio="DisableIncomingMeetingAudio",e.EndToEndEncryptedMeetingMaxCapacity="EndToEndEncryptedMeetingMaxCapacity",e.EnableIncomingMeetingAudio="EnableIncomingMeetingAudio",e.EndOfMeetingAlert="EndOfMeetingAlert",e.FaceStreamEndedForCall="FaceStreamEndedForCall",e.FaceStreamStartedForCall="FaceStreamStartedForCall",e.GreenRoomStartMeetingAlert="GreenRoomStartMeetingAlert",e.GreenRoomParticipantFailedToBeMovedAlert="GreenRoomParticipantFailedToBeMovedAlert",e.GreenRoomMeetingGoLiveFailedAlert="GreenRoomMeetingGoLiveFailedAlert",e.LargeGalleryViewFailed="LargeGalleryViewFailed",e.HardwareOutMeetingSendToDevice="HardwareOutMeetingSendToDevice",e.HardwareOutMeetingStopDevice="HardwareOutMeetingStopDevice",e.HolographicAnnotationsError="HolographicAnnotationsError",e.HostViewModeActivated="HostViewModeActivated",e.HostViewModeDeactivated="HostViewModeDeactivated",e.ImageRenderingQualityAlert="ImageRenderingQualityAlert",e.ImmersiveViewUnsupportedContentAlert="ImmersiveViewUnsupportedContentAlert",e.InitiatorStartedRecording="InitiatorStartedRecording",e.InsufficientMeetingRole="InsufficientMeetingRole",e.InteropCallAlert="InteropCallAlert",e.InteropScreenshare="InteropScreenshare",e.InterpretationAvailable="InterpretationAvailable",e.JoinersOngoingRecording="JoinersOngoingRecording",e.LocalDeviceEcho="LocalDeviceEcho",e.LockedScreenInCall="LockedScreenInCall",e.LowerHandPrompt="LowerHandPrompt",e.MaskIdentitiesForRole="MaskIdentitiesForRole",e.Meeting_attendee_restrictions_operation_failure="Meeting_attendee_restrictions_operation_failure",e.Meeting_attendees_audio_failed="Meeting_attendees_audio_failed",e.Meeting_attendees_audio_restricted="Meeting_attendees_audio_restricted",e.Meeting_attendees_audio_unrestricted="Meeting_attendees_audio_unrestricted",e.Meeting_attendees_video_failed="Meeting_attendees_video_failed",e.Meeting_attendees_video_restricted="Meeting_attendees_video_restricted",e.Meeting_attendees_video_unrestricted="Meeting_attendees_video_unrestricted",e.Meeting_self_attendee_audio_restricted="Meeting_self_attendee_audio_restricted",e.Meeting_self_attendee_audio_unrestricted="Meeting_self_attendee_audio_unrestricted",e.Meeting_self_attendee_video_restricted="Meeting_self_attendee_video_restricted",e.Meeting_self_attendee_video_unrestricted="Meeting_self_attendee_video_unrestricted",e.MeetingLocked="MeetingLocked",e.MeetingLockedError="MeetingLockedError",e.MeetingUnlocked="MeetingUnlocked",e.MeetingRoleChanged="MeetingRoleChanged",e.MergeFailedAlert="MergeFailedAlert",e.MicMutedRemotely="MicMutedRemotely",e.MicUnmuteTakesLongerTime="MicUnmuteTakesLongerTime",e.HighFidelityAudioToggled="HighFidelityAudioToggled",e.HighFidelityAudioToggleFailure="HighFidelityAudioToggleFailure",e.NdiMeetingBroadcastCapturer="NdiMeetingBroadcastCapturer",e.NdiMeetingBroadcastStoppedCapturer="NdiMeetingBroadcastStoppedCapturer",e.NdiMeetingBroadcastParticipant="NdiMeetingBroadcastParticipant",e.NdiMeetingBroadcastStoppedParticipant="NdiMeetingBroadcastStoppedParticipant",e.NetworkErrorForOrganizer="NetworkErrorForOrganizer",e.NetworkQuality="NetworkQuality",e.NetworkReconnect="NetworkReconnect",e.NetworkRecvCatastrophicPoorTurnOffVideo="NetworkRecvCatastrophicPoorTurnOffVideo",e.NetworkRecvCatastrophicPstnAvailable="NetworkRecvCatastrophicPstnAvailable",e.NetworkRecvCatastrophicPstnNotAvailable="NetworkRecvCatastrophicPstnNotAvailable",e.NetworkSendCatastrophicPoorTurnOffVideo="NetworkSendCatastrophicPoorTurnOffVideo",e.NetworkSendCatastrophicPstnAvailable="NetworkSendCatastrophicPstnAvailable",e.NetworkSendCatastrophicPstnNotAvailable="NetworkSendCatastrophicPstnNotAvailable",e.NoAvailableMicrophone="NoAvailableMicrophone",e.NoAvailableSpeakers="NoAvailableSpeakers",e.NoRequiredVideoCodecs="NoRequiredVideoCodecs",e.OverflowRoomCreated="OverflowRoomCreated",e.ParticipantsRecordingStarted="ParticipantsRecordingStarted",e.PaywallTimerStart="PaywallTimerStart",e.PaywallRemainingDuration="PaywallRemainingDuration",e.PaywallRemainingParticipantCapacity="PaywallRemainingParticipantCapacity",e.PeopleFeedEndedForCall="PeopleFeedEndedForCall",e.PeopleFeedStartedForCall="PeopleFeedStartedForCall",e.PlazaEditMisrecognizedParticipantFailed="PlazaEditMisrecognizedParticipantFailed",e.PossibleBrowserPopoutForPSTNCall="PossibleBrowserPopoutForPSTNCall",e.PptContentSharingConsent="PptContentSharingConsent",e.PptContentSharingUnsupportedMeeting="PptContentSharingUnsupportedMeeting",e.PptPresentOnMeetingStart="PptPresentOnMeetingStart",e.PptPrivateViewingFailed="PptPrivateViewingFailed",e.PptSharingStolen="PptSharingStolen",e.PptSharingUnavailable="PptSharingUnavailable",e.PptUnsupportedUpload="PptUnsupportedUpload",e.PptWeatherpersonFailed="PptWeatherpersonFailed",e.PSTNCallLBRFailure="PSTNCallLBRFailure",e.PSTNDomesticRestrictedFailure="PSTNDomesticRestrictedFailure",e.PSTNEntitlementFailure="PSTNEntitlementFailure",e.RaiseHandsOperationFailure="RaiseHandsOperationFailure",e.RecordingAndTranscriptFailed="RecordingAndTranscriptFailed",e.RecordingAndTranscriptPending="RecordingAndTranscriptPending",e.RecordingAndTranscriptStarted="RecordingAndTranscriptStarted",e.RecordingAndTranscriptStartedByOthers="RecordingAndTranscriptStartedByOthers",e.RecordingAndTranscriptStopFailed="RecordingAndTranscriptStopFailed",e.RecordingAndTranscriptStopped="RecordingAndTranscriptStopped",e.RecordingAndTranscriptWaitingForMeetingLive="RecordingAndTranscriptWaitingForMeetingLive",e.RecordingDisabled="RecordingDisabled",e.RecordingExited="RecordingExited",e.RecordingFailed="RecordingFailed",e.RecordingFailedTranscriptPending="RecordingFailedTranscriptPending",e.RecordingFailedTranscriptStarted="RecordingFailedTranscriptStarted",e.RecordingPPT="RecordingPPT",e.RecordingStartedTranscriptPending="RecordingStartedTranscriptPending",e.RecordingSpotlight="RecordingSpotlight",e.RecordingStopped="RecordingStopped",e.RecordingWaitingForMeetingLive="RecordingWaitingForMeetingLive",e.RecordingWhiteboard="RecordingWhiteboard",e.RemoteDeviceEcho="RemoteDeviceEcho",e.RigelAutoExitMeetingAlert="RigelAutoExitMeetingAlert",e.RigelDisplayDisconnected="RigelDisplayDisconnected",e.RigelParticipantsInLobby="RigelParticipantsInLobby",e.RigelRoomPeopleCountChanged="RigelRoomPeopleCountChanged",e.RigelUrlBlocked="RigelUrlBlocked",e.ScreenShareContentNotSupportedForOverflow="ScreenShareContentNotSupportedForOverflow",e.ScreenshareRecordingDisabled="ScreenshareRecordingDisabled",e.ScreensharingCallEscalatedToAudio="ScreensharingCallEscalatedToAudio",e.ScreensharingCallEscalatedToAudioFailed="ScreensharingCallEscalatedToAudioFailed",e.ScreenSharingNotSupported="ScreenSharingNotSupported",e.ScreenSharingRenderingError="ScreenSharingRenderingError",e.ScreenSharingWindowMinimizedPopUpAlert="ScreenSharingWindowMinimizedPopUpAlert",e.SensitivityLabelAlert="SensitivityLabelAlert",e.SharedWindowMinimized="SharedWindowMinimized",e.SharingControlRequestDenied="SharingControlRequestDenied",e.SharingControlRequestRevoked="SharingControlRequestRevoked",e.SharingDropped="SharingDropped",e.SharingStolen="SharingStolen",e.SharingIncomingControlRequest="SharingIncomingControlRequest",e.SharingTerminateControl="SharingTerminateControl",e.NewAudioDevicePluggedInAlert="NewAudioDevicePluggedInAlert",e.NewVideoDevicePluggedInAlert="NewVideoDevicePluggedInAlert",e.AudioDeviceSelectionChangedAlert="AudioDeviceSelectionChangedAlert",e.ActiveAudioDevicePluggedOutAlert="ActiveAudioDevicePluggedOutAlert",e.ActiveVideoDevicePluggedOutAlert="ActiveVideoDevicePluggedOutAlert",e.ScdFailed="ScdFailed",e.ScdStopped="ScdStopped",e.ScdSucceeded="ScdSucceeded",e.ServerMuteForConsentRequired="ServerMuteForConsentRequired",e.SpeakerAndMicUnmuted="SpeakerAndMicUnmuted",e.SpotlightError="SpotlightError",e.SpotlightStatusChanged="SpotlightStatusChanged",e.SpotlightStatusOn="SpotlightStatusOn",e.SpotlightStatusOff="SpotlightStatusOff",e.StreamingMeetingStarted="StreamingMeetingStarted",e.StreamingMeetingStopped="StreamingMeetingStopped",e.SystemAudioDevicesMismatchInCallingScreen="SystemAudioDevicesMismatchInCallingScreen",e.SystemAudioNoDeviceInCallingScreen="SystemAudioNoDeviceInCallingScreen",e.SystemAudioDevicesNotMatch="SystemAudioDevicesNotMatch",e.SystemAudioDevicesStoppedWithError="SystemAudioDevicesStoppedWithError",e.SystemAudioDriverInstallationFailed="SystemAudioDriverInstallationFailed",e.SystemAudioDriverInstallationSucceeded="SystemAudioDriverInstallationSucceeded",e.SystemAudioNoDevice="SystemAudioNoDevice",e.SystemAudioStarted="SystemAudioStarted",e.SystemAudioUnsupportedSharing="SystemAudioUnsupportedSharing",e.TemporarilyUnmuted="TemporarilyUnmuted",e.TogetherModePinError="TogetherModePinError",e.TogetherModePinStatusOn="TogetherModePinStatusOn",e.TranscriptFailedRecordingPending="TranscriptFailedRecordingPending",e.TranscriptFailedRecordingStarted="TranscriptFailedRecordingStarted",e.TranscriptStarted="TranscriptStarted",e.TranscriptStartedByOthers="TranscriptStartedByOthers",e.TranscriptStartedRecordingPending="TranscriptStartedRecordingPending",e.TranscriptStartFailed="TranscriptStartFailed",e.TranscriptStopFailed="TranscriptStopFailed",e.TranscriptStopped="TranscriptStopped",e.TranscriptWaitingForMeetingLive="TranscriptWaitingForMeetingLive",e.UnmuteWithoutConsent="UnmuteWithoutConsent",e.UserHandLoweredByPresenter="UserHandLoweredByPresenter",e.VideoCaptureDeviceFreeze="VideoCaptureDeviceFreeze",e.VideoCaptureFreezeRecovered="VideoCaptureFreezeRecovered",e.VideoCapturePermissionDenied="VideoCapturePermissionDenied",e.VideoCapturerDeviceStartFailed="VideoCapturerDeviceStartFailed",e.VideoCapturerDeviceStartFailureLackSystemRes="VideoCapturerDeviceStartFailureLackSystemRes",e.VideoCapturerDeviceStartFailureMFResConflict="VideoCapturerDeviceStartFailureMFResConflict",e.VideoCapturerDeviceStartTimedOut="VideoCapturerDeviceStartTimedOut",e.VideoExtensibilityDisabledInStandoutMode="VideoExtensibilityDisabledInStandoutMode",e.VideoExtensibilityFreeze="VideoExtensibilityFreeze",e.VideoExtensibilitySlow="VideoExtensibilitySlow",e.VideoEffectsQualityDegraded="VideoEffectsQualityDegraded",e.VoiceCollectionFailed="VoiceCollectionFailed",e.VoiceCollectionStarted="VoiceCollectionStarted",e.VoiceCollectionStopped="VoiceCollectionStopped",e.WatermarkAnonymousUser="WatermarkAnonymousUser",e.WatermarkUnsupportedPlatformUser="WatermarkUnsupportedPlatformUser",e.WatermarkVideoStreamStart="WatermarkVideoStreamStart",e.WeatherpersonContentNotSupported="WeatherpersonContentNotSupported",e.WeatherpersonVideoStopped="WeatherpersonVideoStopped"}(Zi||(Zi={})),function(e){e.upload="upload",e.recent="recent",e.channel="channel",e.attachment="attachment",e.cortana="cortana",e.deepLink="deepLink",e.onedrive="onedrive"}(ea||(ea={})),function(e){e.ppt="ppt",e.invision_whiteboard="invision_whiteboard",e.whiteboard="whiteboard",e.extensible_app="extensible_app",e.annotation="annotation",e.mesh_app="mesh_app"}(ta||(ta={})),function(e){e.pptLaserPointLongPressed="pptLaserPointLongPressed",e.pptLaserPointReleased="pptLaserPointReleased",e.pptPrevSlidePressed="pptPrevSlidePressed",e.pptNextSlidePressed="pptNextSlidePressed"}(na||(na={})),function(e){e.Cameo="Cameo",e.ContentOnly="ContentOnly",e.Weatherperson="Weatherperson",e.SideBySide="SideBySide",e.NewsAnchor="NewsAnchor"}(ia||(ia={})),function(e){e.Unestablished="Unestablished",e.Viewing="Viewing",e.BrowsingPrivately="BrowsingPrivately",e.Presenting="Presenting",e.Starting="Starting",e.Joining="Joining"}(aa||(aa={})),function(e){e.Unestablished="Unestablished",e.Viewing="Viewing",e.Presenting="Presenting"}(oa||(oa={})),function(e){e.Unestablished="Unestablished",e.Viewing="Viewing",e.Presenting="Presenting"}(ra||(ra={})),function(e){e.None="None",e.Text="Text",e.StartEvent="StartEvent",e.StopEvent="StopEvent",e.ParticipantJoined="ParticipantJoined",e.ParticipantLeft="ParticipantLeft",e.RoomAttributionStarted="RoomAttributionStarted",e.RoomAttributionStopped="RoomAttributionStopped"}(sa||(sa={})),function(e){e.Producer="Producer",e.Contributor="Contributor",e.Attendee="Attendee",e.None="None"}(la||(la={})),function(e){e.ups="ups",e.sfb="sfb"}(da||(da={})),function(e){e.Never="Never",e.OneHour="OneHour",e.FourHours="FourHours",e.Today="Today",e.ThisWeek="ThisWeek",e.Custom="Custom"}(ca||(ca={})),function(e){e.Application="Application",e.Delegated="Delegated"}(ua||(ua={})),function(e){e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meetings="Meetings"}(ma||(ma={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Connector="Connector"}(ga||(ga={})),function(e){e.MessageReadCommandSurface="MessageReadCommandSurface",e.MessageComposeCommandSurface="MessageComposeCommandSurface",e.AppointmentOrganizerCommandSurface="AppointmentOrganizerCommandSurface",e.AppointmentAttendeeCommandSurface="AppointmentAttendeeCommandSurface"}(pa||(pa={})),function(e){e.Unknown="Unknown",e.OfficeAddIn="OfficeAddIn",e.OfficeAddIns="OfficeAddIns",e.ExchangeAddIn="ExchangeAddIn",e.ExchangeAddIns="ExchangeAddIns",e.LineOfBusiness="LineOfBusiness",e.Bot="Bot",e.Bots="Bots",e.MessageExtension="MessageExtension",e.ComposeExtensions="ComposeExtensions",e.Extension="Extension",e.Extensions="Extensions",e.FirstPartyPages="FirstPartyPages",e.Dynamics="Dynamics",e.AAD="AAD",e.LaunchPage="LaunchPage",e.StaticTabs="StaticTabs",e.GraphConnector="GraphConnector",e.ConfigurableTabs="ConfigurableTabs",e.Connector="Connector",e.Connectors="Connectors",e.Activity="Activity",e.Activities="Activities",e.MeetingExtension="MeetingExtension",e.MeetingExtensionDefinition="MeetingExtensionDefinition"}(ha||(ha={})),function(e){e.Identity="Identity",e.MessageTeamMembers="MessageTeamMembers",e.SendReceiveData="SendReceiveData",e.ContactData="ContactData",e.FullAccess="FullAccess",e.PublishToInternet="PublishToInternet",e.ReadAllDocument="ReadAllDocument",e.ReadDocument="ReadDocument",e.ReadItem="ReadItem",e.ReadWriteDocument="ReadWriteDocument",e.ReadWriteItem="ReadWriteItem",e.ReadWriteMailbox="ReadWriteMailbox",e.Restricted="Restricted",e.WriteDocument="WriteDocument"}(va||(va={})),function(e){e.Query="Query",e.Action="Action"}(Sa||(Sa={})),function(e){e.Compose="Compose",e.Commandbox="Commandbox",e.Message="Message"}(fa||(fa={})),function(e){e.Text="Text",e.Textarea="Textarea",e.Number="Number",e.Date="Date",e.Time="Time",e.Toggle="Toggle",e.Choiceset="Choiceset"}(ya||(ya={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.applause="applause"}(ka||(ka={})),function(e){e.like="like",e.heart="heart",e.applause="applause",e.raisehand="raisehand"}(Ca||(Ca={})),function(e){e.Init="Init",e.Cancel="Cancel",e.Complete="Complete"}(ba||(ba={})),function(e){e.Caller="Caller",e.SecurityDesk="SecurityDesk"}(Ta||(Ta={})),function(e){e.admin="admin",e.boss="boss",e.endUser="endUser"}(wa||(wa={})),function(e){e.None="None",e.HoloLens="HoloLens",e.Android="Android",e.iOS="iOS",e.HoloLensGuides="HoloLensGuides",e.Other="Other"}(_a||(_a={})),function(e){e.ProducerScreen="ProducerScreen",e.ContributorScreen="ContributorScreen",e.CallHealthScreen="CallHealthScreen"}(Ia||(Ia={})),function(e){e.NotAvailable="NotAvailable",e.Green="Green",e.Amber="Amber",e.Red="Red"}(Aa||(Aa={})),function(e){e.None="None",e.Connected="Connected",e.Disconnected="Disconnected",e.Local="Local",e.Unknown="Unknown"}(Na||(Na={})),function(e){e.Sharepoint="Sharepoint",e.WOPI="WOPI",e.Google="Google",e.OneDrive="OneDrive",e.Recent="Recent",e.Aggregate="Aggregate",e.FileSystem="FileSystem",e.Search="Search",e.AllFiles="AllFiles",e.SharedWithMe="SharedWithMe"}(Ea||(Ea={})),function(e){e.DROPBOX="DROPBOX",e.BOX="BOX",e.SHAREFILE="SHAREFILE",e.GOOGLEDRIVE="GOOGLEDRIVE",e.EGNYTE="EGNYTE",e.SharePoint="SharePoint"}(Da||(Da={})),function(e){e.Recent="Recent",e.Aggregate="Aggregate",e.Personal="Personal",e.Teams="Teams",e.Channels="Channels",e.Downloads="Downloads",e.PersonalWopi="PersonalWopi",e.PersonalGoogle="PersonalGoogle",e.CustomSpo="CustomSpo",e.SharedWithMe="SharedWithMe",e.Chats="Chats"}(Fa||(Fa={})),function(e){e.classMaterials="classMaterials"}(Pa||(Pa={})),function(e){e.readonly="readonly"}(Ma||(Ma={})),function(e){e.normal="normal",e.high="high",e.urgent="urgent"}(ja||(ja={})),function(e){e.chat="chat",e.channel="channel"}(Ra||(Ra={})),function(e){e.aadUser="aadUser",e.onPremiseAadUser="onPremiseAadUser",e.anonymousGuest="anonymousGuest",e.federatedUser="federatedUser"}(xa||(xa={})),function(e){e.aadApplication="aadApplication",e.bot="bot",e.tenantBot="tenantBot",e.office365Connector="office365Connector",e.webhook="webhook"}(Oa||(Oa={})),function(e){e.team="team",e.channel="channel"}(La||(La={})),function(e){e.html="html",e.text="text"}(Ua||(Ua={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.sad="sad",e.angry="angry"}(Ba||(Ba={})),function(e){e.Member="Member",e.Guest="Guest",e.Federated="Federated"}(Wa||(Wa={})),function(e){e.List="List",e.BitMask="BitMask",e.Boolean="Boolean",e.SensitivityLabelList="SensitivityLabelList"}(Ga||(Ga={})),function(e){e.ExternalFeed="ExternalFeed"}(Va||(Va={})),function(e){e.Interpretation="Interpretation"}(Ha||(Ha={})),function(e){e.PeopleSelection="PeopleSelection",e.PresenterSelection="PresenterSelection"}($a||($a={})),function(e){e.Google="Google"}(za||(za={})),function(e){e.TYPE="TYPE",e.TITLE="TITLE",e.MODIFIED="MODIFIED",e.SENTBY="SENTBY"}(qa||(qa={})),function(e){e.ASCENDING="ASCENDING",e.DESCENDING="DESCENDING"}(Ja||(Ja={})),function(e){e.OrganizersAndPresentersOnly="OrganizersAndPresentersOnly",e.OrganizerAndCoOrganizersOnly="OrganizerAndCoOrganizersOnly"}(Qa||(Qa={})),function(e){e.MostSevere="MostSevere",e.Live="Live",e.Severe="Severe",e.Positive="Positive",e.Neutral="Neutral"}(Ka||(Ka={})),function(e){e.Audio="Audio",e.Video="Video"}(Ya||(Ya={})),function(e){e.Success="Success",e.Retrying="Retrying",e.SendFailure="SendFailure",e.SendFailureCanRetry="SendFailureCanRetry",e.EditFailure="EditFailure",e.EditFailureCanRetry="EditFailureCanRetry",e.DeleteSingleFailure="DeleteSingleFailure",e.DeleteSingleFailureCanRetry="DeleteSingleFailureCanRetry",e.DeleteAllFailure="DeleteAllFailure",e.DeleteAllFailureCanRetry="DeleteAllFailureCanRetry"}(Xa||(Xa={})),function(e){e.IMAGE="IMAGE",e.DOCUMENT="DOCUMENT"}(Za||(Za={})),function(e){e.UNKNOWN="UNKNOWN",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(eo||(eo={})),function(e){e.Anonymous="Anonymous",e.Aad="Aad",e.Msa="Msa",e.MsaLife="MsaLife",e.GFed="GFed",e.Otp="Otp"}(to||(to={})),function(e){e.dod="dod",e.gcch="gcch",e.life="life",e.prod="prod"}(no||(no={})),function(e){e.Member="Member",e.Anonymous="Anonymous",e.Guest="Guest"}(io||(io={})),function(e){e.Default="Default",e.Mto="Mto"}(ao||(ao={})),function(e){e.Up="Up",e.InteractionRequired="InteractionRequired",e.AADReconnecting="AADReconnecting",e.SkypeReconnecting="SkypeReconnecting"}(oo||(oo={})),function(e){e.Up="Up",e.InteractionRequired="InteractionRequired",e.AADReconnecting="AADReconnecting",e.SkypeReconnecting="SkypeReconnecting",e.LicenseError="LicenseError",e.SignInRestriction="SignInRestriction",e.UnRedeemed="UnRedeemed",e.LoginError="LoginError"}(ro||(ro={})),function(e){e.QuickStart="QuickStart",e.BYOE="BYOE",e.QuickStartPushToStream="QuickStartPushToStream",e.Slowlane="Slowlane",e.Overflow="Overflow"}(so||(so={})),function(e){e.AttendeeAvailabilityOnly="AttendeeAvailabilityOnly",e.SuggestedTimesOnly="SuggestedTimesOnly",e.Both="Both"}(lo||(lo={})),function(e){e.Excellent="Excellent",e.Good="Good",e.Fair="Fair",e.Poor="Poor",e.Unknown="Unknown"}(co||(co={})),function(e){e.Scheduled="Scheduled",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(uo||(uo={})),function(e){e.Email="Email",e.MeetingInvite="MeetingInvite"}(mo||(mo={})),function(e){e.Document="Document",e.Message="Message"}(go||(go={})),function(e){e.SharePoint="SharePoint",e.OneDriveBusiness="OneDriveBusiness",e.Exchange="Exchange"}(po||(po={})),function(e){e.Implicit="Implicit",e.Explicit="Explicit"}(ho||(ho={})),function(e){e.HEADER="HEADER",e.MAIN="MAIN"}(vo||(vo={})),function(e){e.Blocking="Blocking",e.Global="Global",e.Component="Component"}(So||(So={})),function(e){e.attendees="attendees",e.bodyContent="bodyContent",e.bodyContentType="bodyContentType",e.categories="categories",e.cleanGlobalObjectId="cleanGlobalObjectId",e.clientOptimisticEventId="clientOptimisticEventId",e.contextId="contextId",e.doNotForward="doNotForward",e.endTime="endTime",e.eventTimeZone="eventTimeZone",e.eventType="eventType",e.iCalUid="iCalUid",e.isAllDayEvent="isAllDayEvent",e.isCancelled="isCancelled",e.isOnlineMeeting="isOnlineMeeting",e.isOrganizer="isOrganizer",e.isPrivate="isPrivate",e.isReminderSet="isReminderSet",e.isResponseRequested="isResponseRequested",e.joinOnlineMeetingUrl="joinOnlineMeetingUrl",e.lastModifiedTime="lastModifiedTime",e.location="location",e.mailboxAddress="mailboxAddress",e.meetingAgenda="meetingAgenda",e.myResponseType="myResponseType",e.objectId="objectId",e.onlineMeetingConfLink="onlineMeetingConfLink",e.onlineMeetingConferenceId="onlineMeetingConferenceId",e.onlineMeetingTollFreeNumbers="onlineMeetingTollFreeNumbers",e.onlineMeetingTollNumber="onlineMeetingTollNumber",e.organizerAddress="organizerAddress",e.organizerName="organizerName",e.reminderMinutesBeforeStart="reminderMinutesBeforeStart",e.schedulingServiceUpdateUrl="schedulingServiceUpdateUrl",e.seriesMasterId="seriesMasterId",e.showAs="showAs",e.skypeTeamsData="skypeTeamsData",e.skypeTeamsMeetingUrl="skypeTeamsMeetingUrl",e.startTime="startTime",e.subject="subject",e.teamsVtcTenantId="teamsVtcTenantId"}(fo||(fo={})),function(e){e.Block="Block",e.Unblock="Unblock"}(yo||(yo={})),function(e){e.Done="Done",e.Error="Error",e.ErrorTooManyCharacters="ErrorTooManyCharacters",e.InProcess="InProcess"}(ko||(ko={})),function(e){e.Url="Url",e.Text="Text"}(Co||(Co={})),function(e){e.SINGLEACCOUNT="SINGLEACCOUNT",e.MULTIPLEACCOUNTS="MULTIPLEACCOUNTS"}(bo||(bo={})),function(e){e.Exchange="Exchange",e.OneDriveBusiness="OneDriveBusiness",e.SharePoint="SharePoint"}(To||(To={})),function(e){e.TEAMS="TEAMS",e.SHAREPOINT="SHAREPOINT"}(wo||(wo={})),function(e){e.PROGRESS="PROGRESS",e.CANCELLED="CANCELLED",e.FAILED="FAILED",e.CONFLICT="CONFLICT",e.COMPLETE="COMPLETE"}(_o||(_o={})),function(e){e.view="view",e.review="review",e.edit="edit",e.embed="embed"}(Io||(Io={})),function(e){e.anonymous="anonymous",e.organization="organization",e.users="users"}(Ao||(Ao={})),function(e){e.File="File",e.Folder="Folder"}(No||(No={})),function(e){e.chat="chat",e.team="team",e.channel="channel",e.recipient="recipient"}(Eo||(Eo={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.READY="READY",e.NO_CONTENT="NO_CONTENT",e.FAILED="FAILED",e.PERMANENTLY_FAILED="PERMANENTLY_FAILED",e.NONE="NONE"}(Do||(Do={})),function(e){e.READY="READY",e.FAILED="FAILED",e.INPROGRESS="INPROGRESS"}(Fo||(Fo={})),function(e){e.LoadedMetadata="LoadedMetadata",e.LoadStart="LoadStart",e.LoadedData="LoadedData",e.Start="Start",e.Ready="Ready",e.Play="Play",e.Playing="Playing",e.Paused="Paused",e.Buffering="Buffering",e.Seeking="Seeking",e.Seeked="Seeked",e.Ended="Ended",e.Error="Error",e.Destroyed="Destroyed",e.Initialized="Initialized",e.Resume="Resume"}(Po||(Po={})),function(e){e.UnsupportedPlatform="UnsupportedPlatform",e.NetworkError="NetworkError",e.PlaybackRetried="PlaybackRetried",e.PlaybackError="PlaybackError",e.Unknown="Unknown"}(Mo||(Mo={})),function(e){e.AzureMediaPlayer="AzureMediaPlayer",e.HttpLiveStreamingPlayer="HttpLiveStreamingPlayer"}(jo||(jo={})),function(e){e.TeamSummariesAvailable="TeamSummariesAvailable",e.NoTeamsAvailable="NoTeamsAvailable",e.DefaultError="DefaultError"}(Ro||(Ro={})),function(e){e.MembersAndOwnersAvailable="MembersAndOwnersAvailable",e.NoMembersAndOwnersAvailable="NoMembersAndOwnersAvailable",e.NoGroupsAvailable="NoGroupsAvailable",e.MembersAndOwnersLimitExceeded="MembersAndOwnersLimitExceeded",e.ApiDisabled="ApiDisabled",e.DefaultError="DefaultError"}(xo||(xo={})),function(e){e.Recent="Recent",e.Recommended="Recommended",e.Upcoming="Upcoming"}(Oo||(Oo={})),function(e){e.accepted="accepted",e.tentative="tentative",e.declined="declined",e.notResponded="notResponded",e.organizer="organizer"}(Lo||(Lo={})),function(e){e.mentions="mentions",e.tasks="tasks"}(Uo||(Uo={})),function(e){e.allDeclined="allDeclined",e.outOfWorkingHours="outOfWorkingHours",e.conflictWithOtherMeeting="conflictWithOtherMeeting",e.beingInvited="beingInvited",e.hasNotResponded="hasNotResponded",e.rsvpStatus="rsvpStatus",e.noIssue="noIssue",e.meetingCancelled="meetingCancelled",e.missed="missed",e.joinLate="joinLate",e.leaveEarly="leaveEarly",e.mentioned="mentioned",e.mentionedWithMissed="mentionedWithMissed",e.mentionedBeforeJoined="mentionedBeforeJoined",e.mentionedAfterLeft="mentionedAfterLeft"}(Bo||(Bo={})),function(e){e.join="join",e.runningLate="runningLate",e.sendReminderToUser="sendReminderToUser",e.rsvp="rsvp",e.proposeNewTime="proposeNewTime",e.recordMeeting="recordMeeting",e.removeFromCalendar="removeFromCalendar",e.reschedule="reschedule",e.sendReminderToAttendees="sendReminderToAttendees",e.openMeetingChat="openMeetingChat",e.sendRecordingRequest="sendRecordingRequest"}(Wo||(Wo={})),function(e){e.call="call",e.calendar="calendar"}(Go||(Go={})),function(e){e.Daily="Daily",e.Weekly="Weekly",e.Monthly="Monthly",e.Yearly="Yearly"}(Vo||(Vo={})),function(e){e.Sunday="Sunday",e.Monday="Monday",e.Tuesday="Tuesday",e.Wednesday="Wednesday",e.Thursday="Thursday",e.Friday="Friday",e.Saturday="Saturday"}(Ho||(Ho={})),function(e){e.EmptyState="EmptyState",e.InvalidQsp="InvalidQsp",e.NotOrganizer="NotOrganizer",e.MissingQsp="MissingQsp",e.PartialChange="PartialChange",e.CacheNotInitialized="CacheNotInitialized",e.Unknown="Unknown",e.NotFound="NotFound",e.BadStagingRoomConfig="BadStagingRoomConfig",e.BadForceAttendeeStreamingConfig="BadForceAttendeeStreamingConfig"}($o||($o={})),function(e){e.eq="eq"}(zo||(zo={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(qo||(qo={})),function(e){e.Idea="Idea",e.Survey="Survey",e.Frown="Frown",e.Smile="Smile"}(Jo||(Jo={})),function(e){e.Rating="Rating",e.Verbatim="Verbatim"}(Qo||(Qo={})),function(e){e.Petrol="Petrol",e.ODS="ODS"}(Ko||(Ko={})),function(e){e.Webinar="Webinar",e.Conference="Conference",e.Townhall="Townhall"}(Yo||(Yo={})),function(e){e.Draft="Draft",e.Published="Published",e.Ended="Ended",e.Canceled="Canceled"}(Xo||(Xo={})),function(e){e.Public="Public",e.Private="Private"}(Zo||(Zo={})),function(e){e.Attendee="Attendee",e.CoOrganizer="CoOrganizer",e.Presenter="Presenter",e.Organizer="Organizer"}(er||(er={})),function(e){e.Daily="Daily",e.Weekly="Weekly",e.AbsoluteMonthly="AbsoluteMonthly",e.RelativeMonthly="RelativeMonthly",e.AbsoluteYearly="AbsoluteYearly",e.RelativeYearly="RelativeYearly"}(tr||(tr={})),function(e){e.Standard="Standard",e.Predefined="Predefined",e.UserCreated="UserCreated"}(nr||(nr={})),function(e){e.Text="Text",e.Note="Note",e.SingleChoice="SingleChoice",e.MultiChoice="MultiChoice",e.Boolean="Boolean",e.PromoEmailConsent="PromoEmailConsent"}(ir||(ir={})),function(e){e.ProcessingPendingApproval="ProcessingPendingApproval",e.ProcessingWaitlisting="ProcessingWaitlisting",e.Waitlisted="Waitlisted",e.PendingApproval="PendingApproval",e.ProcessingApproval="ProcessingApproval",e.ProcessingRejection="ProcessingRejection",e.Rejected="Rejected",e.PendingPayment="PendingPayment",e.ProcessingRegistration="ProcessingRegistration",e.Registered="Registered",e.ProcessingCancellation="ProcessingCancellation",e.Canceled="Canceled"}(ar||(ar={})),function(e){e.Approve="Approve",e.Reject="Reject"}(or||(or={})),function(e){e.AttendeeCancellation="AttendeeCancellation",e.AttendeeCancellationRequest="AttendeeCancellationRequest",e.AttendeePendingApproval="AttendeePendingApproval",e.AttendeeRegisterAfterWaitlist="AttendeeRegisterAfterWaitlist",e.AttendeeRegistration="AttendeeRegistration",e.AttendeeRejection="AttendeeRejection",e.AttendeeWaitlisting="AttendeeWaitlisting",e.EventCancellation="EventCancellation",e.EventDateTimeUpdate="EventDateTimeUpdate",e.EventAttendeeReminder="EventAttendeeReminder"}(rr||(rr={})),function(e){e.Draft="Draft",e.Active="Active",e.ProcessingCancellation="ProcessingCancellation",e.Canceled="Canceled"}(sr||(sr={})),function(e){e.Organizer="Organizer",e.Presenter="Presenter",e.Attendee="Attendee"}(lr||(lr={})),function(e){e.DateTime="DateTime",e.Location="Location",e.Description="Description",e.Speaker="Speaker",e.Questionnaire="Questionnaire"}(dr||(dr={})),function(e){e.slot="slot",e.page="page"}(cr||(cr={})),function(e){e.horizontal="horizontal",e.vertical="vertical"}(ur||(ur={})),function(e){e.alert_inline="alert_inline",e.alert_banner="alert_banner",e.button="button",e.dropdown="dropdown",e.openWindowsNotificationSettings="openWindowsNotificationSettings",e.subPage="subPage",e.text="text",e.toggle="toggle",e.compoundButton="compoundButton",e.checkbox="checkbox",e.resetButton="resetButton"}(mr||(mr={})),function(e){e.mutation="mutation",e.navigation="navigation",e.external_navigation="external_navigation"}(gr||(gr={})),function(e){e.ToastSettings="ToastSettings",e.ActivityGenerationSettings="ActivityGenerationSettings",e.SoundsSettings="SoundsSettings",e.EmailSettings="EmailSettings",e.selectedPreset="selectedPreset"}(pr||(pr={})),function(e){e.DLP="DLP"}(hr||(hr={})),function(e){e.teamAvatar="teamAvatar",e.staticImage="staticImage",e.imageUrl="imageUrl",e.default="default"}(vr||(vr={})),function(e){e.DEFAULT="DEFAULT",e.CHANNEL="CHANNEL"}(Sr||(Sr={})),function(e){e.ThumbsUp="ThumbsUp",e.ThumbsDown="ThumbsDown",e.RecallFeedback="RecallFeedback",e.Accept="Accept",e.Reject="Reject",e.Edit="Edit",e.Delete="Delete",e.Done="Done",e.AssignOwner="AssignOwner",e.AssignDueDate="AssignDueDate",e.EditNotes="EditNotes",e.CreateCRM="CreateCRM",e.OpenEmail="OpenEmail"}(fr||(fr={})),function(e){e.Add="Add",e.Edit="Edit",e.Delete="Delete"}(yr||(yr={})),function(e){e.OneStar="OneStar",e.TwoStars="TwoStars",e.ThreeStars="ThreeStars",e.FourStars="FourStars",e.FiveStars="FiveStars"}(kr||(kr={})),function(e){e.MostRecent="MostRecent",e.HighestRating="HighestRating",e.LowestRating="LowestRating"}(Cr||(Cr={})),function(e){e.All="All",e.G2="G2",e.Teams="Teams",e.AppSource="AppSource"}(br||(br={})),function(e){e.OffensiveContent="OffensiveContent",e.SpamAndAdvertising="SpamAndAdvertising",e.InvalidReview="InvalidReview",e.Other="Other"}(Tr||(Tr={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Messaging="Messaging",e.Connector="Connector"}(wr||(wr={})),function(e){e.NotInstalled="NotInstalled",e.Installed="Installed",e.InstalledAndFavorited="InstalledAndFavorited",e.InstalledAndHidden="InstalledAndHidden",e.InstalledAndPermanent="InstalledAndPermanent",e.InstalledAndDeprecated="InstalledAndDeprecated",e.Featured="Featured",e.PreConsented="PreConsented",e.AdminPreInstalled="AdminPreInstalled",e.RequireConsent="RequireConsent"}(_r||(_r={})),function(e){e.Added="Added",e.Removed="Removed",e.Updated="Updated",e.Synced="Synced"}(Ir||(Ir={})),function(e){e.Open="Open",e.Close="Close",e.Result="Result",e.Cancel="Cancel"}(Ar||(Ar={})),function(e){e.MRU="MRU",e.AlphabeticalAsc="AlphabeticalAsc",e.AlphabeticalDesc="AlphabeticalDesc"}(Nr||(Nr={})),function(e){e.PROGRESS="PROGRESS",e.CANCELLED="CANCELLED",e.FAILED="FAILED",e.COMPLETE="COMPLETE"}(Er||(Er={})),function(e){e.Network_Only="Network_Only",e.Cache_First="Cache_First",e.Cache_Only="Cache_Only",e.Network_Debounce="Network_Debounce"}(Dr||(Dr={})),function(e){e.default="default",e.dark="dark",e.highContrast="highContrast"}(Fr||(Fr={})),function(e){e.edit="edit",e.send="send"}(Pr||(Pr={})),function(e){e.list="list",e.grid="grid"}(Mr||(Mr={})),function(e){e.result="result",e.auth="auth",e.config="config",e.message="message",e.botMessagePreview="botMessagePreview",e.silentAuth="silentAuth"}(jr||(jr={})),function(e){e.auth="auth",e.config="config"}(Rr||(Rr={})),function(e){e.message="message",e.compose="compose",e.commandBox="commandBox"}(xr||(xr={})),function(e){e.StringAuthResult="StringAuthResult",e.JsonAuthResult="JsonAuthResult"}(Or||(Or={})),function(e){e.NoMatch="NoMatch",e.MatchButNotInstalled="MatchButNotInstalled",e.MatchButNeedAuthOrConfig="MatchButNeedAuthOrConfig",e.MatchAndPendingFetch="MatchAndPendingFetch",e.HasResult="HasResult",e.Failed="Failed"}(Lr||(Lr={})),function(e){e.NoCache="NoCache"}(Ur||(Ur={})),function(e){e.Thumbnail="Thumbnail",e.Card="Card",e.Permission="Permission"}(Br||(Br={})),function(e){e.Single="Single",e.Occurrence="Occurrence",e.RecurringMaster="RecurringMaster",e.Exception="Exception"}(Wr||(Wr={})),function(e){e.Invitee="Invitee",e.ChatMember="ChatMember",e.TeamMember="TeamMember",e.GroupMember="GroupMember"}(Gr||(Gr={})),function(e){e.New="New",e.Update="Update"}(Vr||(Vr={})),function(e){e.Sending="Sending",e.TeacherChatMessageSent="TeacherChatMessageSent",e.ChatCreationSuccess="ChatCreationSuccess",e.ChatCreationFailed="ChatCreationFailed",e.MessageForwardingFailed="MessageForwardingFailed",e.MessageForwardingPartiallyFailed="MessageForwardingPartiallyFailed"}(Hr||(Hr={})),function(e){e.Success_TeacherChatMessageSent="Success_TeacherChatMessageSent",e.Success_ChatCreation="Success_ChatCreation",e.Failed_ChatCreation="Failed_ChatCreation",e.Success_MessageForwarding="Success_MessageForwarding",e.Partial_MessageForwarding="Partial_MessageForwarding",e.Failed_MessageForwarding="Failed_MessageForwarding"}($r||($r={})),function(e){e.Forward="Forward",e.Backward="Backward"}(zr||(zr={})),function(e){e.unread="unread",e.meeting="meeting",e.muted="muted",e.chats="chats"}(qr||(qr={})),function(e){e.like="like",e.star="star",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.sad="sad",e.angry="angry",e.acks="acks"}(Jr||(Jr={})),function(e){e.add="add",e.remove="remove"}(Qr||(Qr={})),function(e){e.add="add",e.remove="remove"}(Kr||(Kr={})),function(e){e.Translate="Translate",e.Untranslate="Untranslate"}(Yr||(Yr={})),function(e){e.Create="Create",e.Update="Update"}(Xr||(Xr={})),function(e){e.OffensiveContent="OffensiveContent",e.Terrorism="Terrorism",e.ChildEndangermentExploitation="ChildEndangermentExploitation",e.ImminentHarmToPersonsOrProperty="ImminentHarmToPersonsOrProperty",e.ThreatsCyberbullyingHarassment="ThreatsCyberbullyingHarassment",e.VirusSpywareMalware="VirusSpywareMalware",e.Fraud="Fraud",e.ContentInfringement="ContentInfringement",e.HateSpeech="HateSpeech",e.Other="Other"}(Zr||(Zr={})),function(e){e.contact_request="contact_request",e.delete_contact="delete_contact",e.block_contact="block_contact",e.profile="profile",e.message="message",e.highlight="highlight",e.search="search",e.profile_image="profile_image"}(es||(es={})),function(e){e.White="White",e.Yellow="Yellow",e.Blue="Blue",e.Green="Green"}(ts||(ts={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(ns||(ns={})),function(e){e.Top="Top",e.Bottom="Bottom"}(is||(is={})),function(e){e.Smaller="Smaller",e.Small="Small",e.Medium="Medium",e.Large="Large",e.Larger="Larger"}(as||(as={})),function(e){e.MeetingId="MeetingId",e.MeetingJoinUrl="MeetingJoinUrl",e.GroupChatId="GroupChatId"}(os||(os={})),function(e){e.Guest="Guest",e.Presenter="Presenter",e.Attendee="Attendee",e.Organizer="Organizer"}(rs||(rs={})),function(e){e.Added="Added",e.AlreadyExists="AlreadyExists",e.Conflict="Conflict",e.NotFound="NotFound"}(ss||(ss={})),function(e){e.AAD="AAD",e.Skype="Skype",e.SkypeEnterprise="SkypeEnterprise"}(ls||(ls={})),function(e){e.confirm="confirm",e.revert="revert",e.dismiss="dismiss"}(ds||(ds={})),function(e){e.Close="Close",e.Sync="Sync"}(cs||(cs={})),function(e){e.NONE="NONE",e.LIKE="LIKE",e.UNLIKE="UNLIKE",e.MORE_LIKE_THIS="MORE_LIKE_THIS",e.LESS_LIKE_THIS="LESS_LIKE_THIS",e.CLICK="CLICK",e.SCROLL_START="SCROLL_START",e.BOUNCE="BOUNCE",e.VIEW="VIEW",e.READ="READ",e.NEVER_SHOW_AGAIN="NEVER_SHOW_AGAIN",e.CLEAR_EXPLICIT_FEEDBACK="CLEAR_EXPLICIT_FEEDBACK"}(us||(us={})),function(e){e.NONE="NONE",e.SYNC="SYNC",e.ANNOTATE="ANNOTATE",e.SYNC_NEXT="SYNC_NEXT",e.ANNOTATE_NEXT="ANNOTATE_NEXT"}(ms||(ms={})),function(e){e.UNKNOWN="UNKNOWN",e.POST_POPULARITY="POST_POPULARITY",e.AUTHOR_YOU_COLLABORATE_WITH="AUTHOR_YOU_COLLABORATE_WITH",e.CHANNEL_YOU_ENGAGE_WITH="CHANNEL_YOU_ENGAGE_WITH",e.AUTHOR_POPULARITY="AUTHOR_POPULARITY",e.CHANNEL_POPULARITY="CHANNEL_POPULARITY",e.CHANNEL_YOU_VISIT="CHANNEL_YOU_VISIT",e.AUTHOR_YOU_INTERACT_WITH="AUTHOR_YOU_INTERACT_WITH",e.ACTIVE_AUTHOR="ACTIVE_AUTHOR"}(gs||(gs={})),function(e){e.ACTOR_RELATIONSHIP="ACTOR_RELATIONSHIP",e.CONTAINER="CONTAINER"}(ps||(ps={})),function(e){e.GLOBAL="GLOBAL",e.TEAMS_FEED="TEAMS_FEED"}(hs||(hs={})),function(e){e.EXCLUDE="EXCLUDE",e.INCLUDE="INCLUDE"}(vs||(vs={})),function(e){e.UNKNOWN="UNKNOWN",e.DOCUMENT_LAST_MODIFIED_BY="DOCUMENT_LAST_MODIFIED_BY",e.SHARED_BY="SHARED_BY",e.AUTHOR="AUTHOR",e.COMMENT_ON="COMMENT_ON",e.MENTION="MENTION",e.REQUESTOR="REQUESTOR",e.SENDER="SENDER",e.ANY="ANY"}(Ss||(Ss={})),function(e){e.TooManyMembers="TooManyMembers",e.ErrorFetchingData="ErrorFetchingData"}(fs||(fs={})),function(e){e.Undefined="Undefined",e.DefaultOrganizationExists="DefaultOrganizationExists",e.TenantGeoIsNotSupported="TenantGeoIsNotSupported",e.TeamsRingIsNotSupported="TeamsRingIsNotSupported",e.InProgress="InProgress",e.Failed="Failed",e.Conflict="Conflict",e.InternalError="InternalError"}(ys||(ys={})),function(e){e.Coachmark="Coachmark",e.Modal="Modal",e.Notification="Notification",e.Iris="Iris",e.QuickGuide="QuickGuide"}(ks||(ks={})),function(e){e.AppReady="AppReady",e.Manual="Manual",e.Daily="Daily",e.BIEvent="BIEvent",e.FollowUp="FollowUp"}(Cs||(Cs={})),function(e){e.notLocalized="notLocalized",e.localized="localized"}(bs||(bs={})),function(e){e.above="above",e.below="below",e.before="before",e.after="after"}(Ts||(Ts={})),function(e){e.bottom="bottom",e.top="top",e.start="start",e.end="end",e.center="center"}(ws||(ws={})),function(e){e.none="none",e.inline="inline",e.banner="banner"}(_s||(_s={})),function(e){e.close="close",e.openFollowUpSurface="openFollowUpSurface",e.navigateToUrl="navigateToUrl",e.navigateWithEntityCommand="navigateWithEntityCommand",e.navigateWithDeeplink="navigateWithDeeplink"}(Is||(Is={})),function(e){e.httpGet="httpGet"}(As||(As={})),function(e){e.Google="Google"}(Ns||(Ns={})),function(e){e.TeamsFreemium="TeamsFreemium",e.TflCloudCache="TflCloudCache"}(Es||(Es={})),function(e){e.Documents="Documents",e.Photos="Photos",e.Cameraroll="Cameraroll",e.Approot="Approot",e.Music="Music",e.Meetings="Meetings"}(Ds||(Ds={})),function(e){e.AccessDenied="AccessDenied",e.BadRequest="BadRequest",e.InvalidArgument="InvalidArgument",e.InvalidBackendResponse="InvalidBackendResponse",e.UserProfileNotFound="UserProfileNotFound",e.Unknown="Unknown"}(Fs||(Fs={})),function(e){e.BadRequest="BadRequest",e.MembersNotFound="MembersNotFound",e.MembersAndRelatedContactsPartialSuccess="MembersAndRelatedContactsPartialSuccess",e.InvalidBackendResponse="InvalidBackendResponse",e.CallerIsNotGroupOwner="CallerIsNotGroupOwner",e.Unknown="Unknown"}(Ps||(Ps={})),function(e){e.Active="Active",e.Inactive="Inactive"}(Ms||(Ms={})),function(e){e.FailedToFetchRelatedContacts="FailedToFetchRelatedContacts",e.RelatedContactsNotFound="RelatedContactsNotFound",e.BadRequest="BadRequest",e.InvalidBackendResponse="InvalidBackendResponse",e.InvalidCallerOrGroup="InvalidCallerOrGroup",e.InvalidUserOrGroup="InvalidUserOrGroup",e.Unknown="Unknown"}(js||(js={})),function(e){e.GENERIC="GENERIC",e.LINK_EXPIRED="LINK_EXPIRED",e.LINK_NOT_FOUND="LINK_NOT_FOUND",e.LINK_INVALID_FORMAT="LINK_INVALID_FORMAT",e.MSA_PHONE_MISMATCH="MSA_PHONE_MISMATCH",e.MSA_PHONES_MISSING_INVALID="MSA_PHONES_MISSING_INVALID"}(Rs||(Rs={})),function(e){e.Thread="Thread",e.User="User"}(xs||(xs={})),function(e){e.comfy="comfy",e.compact="compact"}(Os||(Os={})),function(e){e.on="on",e.off="off",e.notSet="notSet"}(Ls||(Ls={})),function(e){e.closed="closed",e.hidden="hidden",e.open="open"}(Us||(Us={})),function(e){e.light="light",e.dark="dark",e.contrast="contrast"}(Bs||(Bs={})),function(e){e.tflGroupTemplatesHidden="tflGroupTemplatesHidden",e.tflMeetingChicletPrivacyNoticeSettings="tflMeetingChicletPrivacyNoticeSettings",e.prejoinSettings="prejoinSettings",e.coachSettings="coachSettings",e.streamingSettings="streamingSettings",e.channelInfoPaneSettings="channelInfoPaneSettings",e.chatInfoPaneSettings="chatInfoPaneSettings",e.audienceViewSettings="audienceViewSettings",e.newChatDraft="newChatDraft",e.mtmaAppBannerSettings="mtmaAppBannerSettings"}(Ws||(Ws={})),function(e){e.animation="animation",e.density="density",e.flyoutCamera="flyoutCamera",e.infoPane="infoPane",e.performance="performance",e.appSwitcher="appSwitcher",e.theme="theme",e.videoEffect="videoEffect",e.promo="promo",e.avatar="avatar",e.teamLayout="teamLayout",e.diagnosticsLogs="diagnosticsLogs"}(Gs||(Gs={})),function(e){e.normal="normal",e.low="low"}(Vs||(Vs={})),function(e){e.Streaming="Streaming",e.RealTime="RealTime"}(Hs||(Hs={})),function(e){e.ClientTeamsDesktop="ClientTeamsDesktop",e.ClientTeamsMobile="ClientTeamsMobile",e.ClientTeamsWeb="ClientTeamsWeb",e.RoomDeviceAll="RoomDeviceAll",e.RoomDeviceMicrosoftTeamsRoom="RoomDeviceMicrosoftTeamsRoom",e.RoomDeviceMeetingRoomCVI="RoomDeviceMeetingRoomCVI",e.RoomDeviceMeetingRoomDGJ="RoomDeviceMeetingRoomDGJ",e.PSTN="PSTN",e.Other="Other"}($s||($s={})),function(e){e.consenttorecording="consenttorecording",e.denyconsenttorecording="denyconsenttorecording",e.autoconsenttorecording="autoconsenttorecording",e.implicitconsenttorecording="implicitconsenttorecording",e.unknown="unknown"}(zs||(zs={})),function(e){e.Organizer="Organizer",e.CoOrganizer="CoOrganizer",e.Attendee="Attendee",e.Unknown="Unknown"}(qs||(qs={})),function(e){e.AttendanceReportNodata="AttendanceReportNodata",e.AttendanceReportV3="AttendanceReportV3",e.AttendanceReportWebinar="AttendanceReportWebinar",e.RegistrationReportWebinar="RegistrationReportWebinar",e.AttendanceReportV3Overflow="AttendanceReportV3Overflow",e.AttendanceReportV3Breakoutroom="AttendanceReportV3Breakoutroom",e.AttendanceReportVirtualEvent="AttendanceReportVirtualEvent",e.RegistrationReportVirtualEvent="RegistrationReportVirtualEvent"}(Js||(Js={})),function(e){e.MeetingQuestions="MeetingQuestions",e.MeetingPrivateQuestions="MeetingPrivateQuestions",e.MeetingAnswers="MeetingAnswers",e.MeetingPrivateAnswers="MeetingPrivateAnswers"}(Qs||(Qs={})),function(e){e.Chat="Chat",e.Channel="Channel"}(Ks||(Ks={})),function(e){e.call="call",e.mention="mention",e.chat="chat",e.channel="channel",e.other="other"}(Ys||(Ys={})),function(e){e.AuthError="AuthError",e.Offline="Offline",e.ConnectedAccountError="ConnectedAccountError",e.SettingsWarnUser="SettingsWarnUser"}(Xs||(Xs={})),function(e){e.Success="Success",e.Warning="Warning",e.Error="Error",e.Info="Info",e.InfoAvatar="InfoAvatar"}(Zs||(Zs={})),function(e){e.SearchSuggestions="SearchSuggestions",e.SearchResults="SearchResults",e.AddToChat="AddToChat",e.AddToTeam="AddToTeam",e.NewChat="NewChat",e.Transfer="Transfer",e.AddToCall="AddToCall",e.CallRouting="CallRouting",e.CallForwardGroupSelection="CallForwardGroupSelection",e.DelegationSelection="DelegationSelection",e.PresenceSettings="PresenceSettings",e.AddToMeeting="AddToMeeting",e.MeetingSchedule="MeetingSchedule",e.AddToSpeedDialOrContacts="AddToSpeedDialOrContacts",e.AtMention="AtMention",e.OrgChart="OrgChart",e.PriorityContactsSelection="PriorityContactsSelection",e.TaggedContactsSelection="TaggedContactsSelection",e.StatusNote="StatusNote",e.VoicemailTransferTarget="VoicemailTransferTarget",e.SearchExpoDisplays="SearchExpoDisplays",e.AllFalse="AllFalse",e.AllTrue="AllTrue",e.MeetingRoomCall="MeetingRoomCall"}(el||(el={})),function(e){e.open="open",e.cancelled="cancelled",e.shared="shared",e.error="error"}(tl||(tl={})),function(e){e.Removed="Removed",e.Updated="Updated"}(nl||(nl={})),function(e){e.pdf="pdf",e.xls="xls",e.xlsb="xlsb",e.xlsm="xlsm",e.xlsx="xlsx",e.csv="csv",e.doc="doc",e.docm="docm",e.docx="docx",e.dot="dot",e.dotm="dotm",e.dotx="dotx",e.pot="pot",e.potm="potm",e.potx="potx",e.pps="pps",e.ppsm="ppsm",e.ppsx="ppsx",e.ppt="ppt",e.pptm="pptm",e.pptx="pptx",e.vsd="vsd",e.vsdx="vsdx",e.one="one"}(il||(il={})),function(e){e.WhoBotTab="WhoBotTab",e.ExtensionTab="ExtensionTab",e.WebsiteTab="WebsiteTab",e.StaticExtensionTab="StaticExtensionTab"}(al||(al={})),function(e){e.QueryByThread="QueryByThread",e.QueryByApp="QueryByApp",e.QueryByMessage="QueryByMessage"}(ol||(ol={})),function(e){e.PrivateMeeting="PrivateMeeting",e.ChannelMeeting="ChannelMeeting",e.Channel="Channel",e.PrivateMeetingSchedulingForm="PrivateMeetingSchedulingForm",e.ChannelMeetingSchedulingForm="ChannelMeetingSchedulingForm"}(rl||(rl={})),function(e){e.returnFocus="returnFocus"}(sl||(sl={})),function(e){e.voiceAdminSettings="voiceAdminSettings"}(ll||(ll={})),function(e){e.voiceAdminSettings="voiceAdminSettings"}(dl||(dl={})),function(e){e.alwaysEnabled="alwaysEnabled",e.scheduled="scheduled",e.disabled="disabled"}(cl||(cl={})),function(e){e.none="none",e.contactsOnly="contactsOnly",e.all="all"}(ul||(ul={})),function(e){e.Private="Private",e.Shared="Shared"}(ml||(ml={})),function(e){e.PERSONCHAT="PERSONCHAT",e.GROUPCHAT="GROUPCHAT",e.QUERYSEARCH="QUERYSEARCH",e.POPOUTPERSONCHAT="POPOUTPERSONCHAT",e.POPOUTGROUPCHAT="POPOUTGROUPCHAT",e.REMOVESUGGESTION="REMOVESUGGESTION",e.ORGCHART="ORGCHART",e.TEAMNAVIGATION="TEAMNAVIGATION",e.CHANNELNAVIGATION="CHANNELNAVIGATION",e.FILENAVIGATION="FILENAVIGATION",e.JOINLINKDIALOG="JOINLINKDIALOG",e.EXTERNALSEARCH="EXTERNALSEARCH"}(gl||(gl={})),function(e){e.IMAGE="IMAGE",e.AVATAR="AVATAR",e.ICON="ICON"}(pl||(pl={})),function(e){e.GENERATED="GENERATED",e.INDEXEDDB="INDEXEDDB",e.INVITEFLOW="INVITEFLOW",e.SCD="SCD",e.HISTORY="HISTORY",e.MT="MT",e.SUBSTRATE="SUBSTRATE",e.TOPN="TOPN"}(hl||(hl={})),function(e){e.ADD="ADD",e.DELETE="DELETE",e.REMOVEALL="REMOVEALL"}(vl||(vl={})),function(e){e.CLEAR_SEARCHTEXT="CLEAR_SEARCHTEXT",e.DEACTIVATE="DEACTIVATE",e.REFETCH_SUGGESTIONS="REFETCH_SUGGESTIONS",e.REFETCH_SUGGESTIONS_WITH_ANIMATION="REFETCH_SUGGESTIONS_WITH_ANIMATION",e.SET_TITLE_AS_SEARCH_TEXT="SET_TITLE_AS_SEARCH_TEXT"}(Sl||(Sl={})),function(e){e.SEARCH="SEARCH",e.PERSON="PERSON",e.GROUPCHAT="GROUPCHAT",e.JOINLINK="JOINLINK"}(fl||(fl={})),function(e){e.PEOPLE="PEOPLE",e.GROUPCHATS="GROUPCHATS",e.SEARCHES="SEARCHES",e.HISTORY="HISTORY",e.SUGGESTED="SUGGESTED"}(yl||(yl={})),function(e){e.Suggestion="Suggestion",e.NoResultModification="NoResultModification",e.NoResultFolderRefinerModification="NoResultFolderRefinerModification",e.Modification="Modification",e.Extension="Extension",e.NoRequeryModification="NoRequeryModification"}(kl||(kl={})),function(e){e.Quorum="Quorum",e.OutOfRoutine="OutOfRoutine",e.Conflicts="Conflicts"}(Cl||(Cl={})),function(e){e.Attachment="Attachment",e.RelatedFile="RelatedFile",e.RelatedEmail="RelatedEmail",e.FileAttachment="FileAttachment",e.EmailAttachment="EmailAttachment",e.RecordingFile="RecordingFile",e.SharedFile="SharedFile"}(bl||(bl={})),function(e){e.AttachmentGroupType="AttachmentGroupType",e.RelatedEmailType="RelatedEmailType"}(Tl||(Tl={})),function(e){e.Relevance="Relevance",e.DateTime="DateTime"}(wl||(wl={})),function(e){e.Light="Light",e.Dark="Dark",e.Contrast="Contrast",e.OSTheme="OSTheme"}(_l||(_l={})),function(e){e.MouseEnter="MouseEnter",e.MouseLeave="MouseLeave",e.Click="Click"}(Il||(Il={})),function(e){e.Teams1="Teams1",e.Teams2="Teams2"}(Al||(Al={})),function(e){e.Personal="Personal",e.Business="Business",e.Neutral="Neutral",e.Mixed="Mixed",e.Unknown="Unknown"}(Nl||(Nl={})),function(e){e.None="None",e.PowerApp="PowerApp",e.Link="Link"}(El||(El={})),function(e){e.None="None",e.Promotion="Promotion",e.Certified="Certified",e.FirstParty="FirstParty",e.SecondParty="SecondParty"}(Dl||(Dl={})),function(e){e.Alphabetical="Alphabetical",e.Popularity="Popularity"}(Fl||(Fl={})),function(e){e.None="None",e.Bot="Bot",e.Certified="Certified",e.Connector="Connector",e.GroupChat="GroupChat",e.Team="Team",e.Meeting="Meeting",e.MessageExtension="MessageExtension",e.MessageExtensionComposeContext="MessageExtensionComposeContext",e.MessageExtensionCommandboxContext="MessageExtensionCommandboxContext",e.MessageExtensionMessageContext="MessageExtensionMessageContext",e.Personal="Personal",e.Tab="Tab",e.Blocked="Blocked",e.Available="Available",e.NoContextTeamTab="NoContextTeamTab",e.NoContextChatTab="NoContextChatTab",e.EducationContextTab="EducationContextTab",e.TrainingAndTutorialContextTab="TrainingAndTutorialContextTab",e.PersonalContextTab="PersonalContextTab",e.ChannelContextTab="ChannelContextTab",e.PrivateChatContextTab="PrivateChatContextTab",e.MeetingChatContextTab="MeetingChatContextTab",e.MeetingDetailsContextTab="MeetingDetailsContextTab",e.PrivateChatContextGroupChatScopeTab="PrivateChatContextGroupChatScopeTab",e.MeetingChatContextGroupChatScopeTab="MeetingChatContextGroupChatScopeTab",e.MeetingDetailsContextGroupChatScopeTab="MeetingDetailsContextGroupChatScopeTab",e.MeetingSidePanelContextGroupChatScopeTab="MeetingSidePanelContextGroupChatScopeTab",e.MeetingStageContextGroupChatScopeTab="MeetingStageContextGroupChatScopeTab",e.CallingSidePanelContextGroupChatScopeTab="CallingSidePanelContextGroupChatScopeTab",e.PrivateChatContextTeamScopeTab="PrivateChatContextTeamScopeTab",e.MeetingChatContextTeamScopeTab="MeetingChatContextTeamScopeTab",e.MeetingDetailsContextTeamScopeTab="MeetingDetailsContextTeamScopeTab",e.MeetingSidePanelContextTeamScopeTab="MeetingSidePanelContextTeamScopeTab",e.MeetingStageContextTeamScopeTab="MeetingStageContextTeamScopeTab",e.CallingSidePanelContextTeamScopeTab="CallingSidePanelContextTeamScopeTab",e.PersonalContextBot="PersonalContextBot",e.TeamContextBot="TeamContextBot",e.GroupChatContextBot="GroupChatContextBot",e.Free="Free",e.Paid="Paid",e.PublisherAttested="PublisherAttested",e.NoContextTeamStaticTab="NoContextTeamStaticTab",e.NoContextChatStaticTab="NoContextChatStaticTab",e.PersonalContextStaticTab="PersonalContextStaticTab",e.ChannelContextStaticTab="ChannelContextStaticTab",e.PrivateChatContextStaticTab="PrivateChatContextStaticTab",e.MeetingChatContextStaticTab="MeetingChatContextStaticTab",e.MeetingDetailsContextStaticTab="MeetingDetailsContextStaticTab",e.PrivateChatContextGroupChatScopeStaticTab="PrivateChatContextGroupChatScopeStaticTab",e.MeetingChatContextGroupChatScopeStaticTab="MeetingChatContextGroupChatScopeStaticTab",e.MeetingDetailsContextGroupChatScopeStaticTab="MeetingDetailsContextGroupChatScopeStaticTab",e.MeetingSidePanelContextGroupChatScopeStaticTab="MeetingSidePanelContextGroupChatScopeStaticTab",e.MeetingStageContextGroupChatScopeStaticTab="MeetingStageContextGroupChatScopeStaticTab",e.CallingSidePanelContextGroupChatScopeStaticTab="CallingSidePanelContextGroupChatScopeStaticTab",e.PrivateChatContextTeamScopeStaticTab="PrivateChatContextTeamScopeStaticTab",e.MeetingChatContextTeamScopeStaticTab="MeetingChatContextTeamScopeStaticTab",e.MeetingDetailsContextTeamScopeStaticTab="MeetingDetailsContextTeamScopeStaticTab",e.MeetingSidePanelContextTeamScopeStaticTab="MeetingSidePanelContextTeamScopeStaticTab",e.MeetingStageContextTeamScopeStaticTab="MeetingStageContextTeamScopeStaticTab",e.CallingSidePanelContextTeamScopeStaticTab="CallingSidePanelContextTeamScopeStaticTab"}(Pl||(Pl={})),function(e){e.Image="Image",e.Video="Video"}(Ml||(Ml={})),function(e){e.Channel="Channel",e.Chat="Chat",e.Document="Document",e.File="File",e.Message="Message",e.People="People",e.Team="Team",e.Text="Text"}(jl||(jl={})),function(e){e.AutoStart="AutoStart",e.OpenAppInBackground="OpenAppInBackground",e.KeepAppRunningOnClose="KeepAppRunningOnClose",e.DefaultImProvider="DefaultImProvider"}(Rl||(Rl={})),function(e){e.NotJoined="NotJoined",e.Joining="Joining",e.Joined="Joined",e.Pending="Pending"}(xl||(xl={})),function(e){e.CreateAndDeleteTab="CreateAndDeleteTab",e.CreateAndUpdateChannel="CreateAndUpdateChannel",e.EditMessagesEnabled="EditMessagesEnabled",e.DeleteMessagesEnabled="DeleteMessagesEnabled",e.AdminDeleteEnabled="AdminDeleteEnabled",e.InstallAndUninstallApps="InstallAndUninstallApps",e.UploadCustomApp="UploadCustomApp",e.DeleteChannel="DeleteChannel",e.CreatePrivateChannel="CreatePrivateChannel",e.UpdateConnectors="UpdateConnectors",e.GeneralChannelPosting="GeneralChannelPosting",e.TeamMention="TeamMention",e.ChannelMention="ChannelMention",e.GiphyEnabled="GiphyEnabled",e.GiphyRating="GiphyRating",e.StickersEnabled="StickersEnabled",e.CustomMemesEnabled="CustomMemesEnabled",e.AddAndRemoveDisplayContent="AddAndRemoveDisplayContent"}(Ol||(Ol={})),function(e){e.ClassTeamsSection="ClassTeamsSection",e.HiddenTeamsSection="HiddenTeamsSection",e.OtherTeamsSection="OtherTeamsSection"}(Ll||(Ll={})),function(e){e.Sent="Sent",e.Pending="Pending",e.Declined="Declined",e.Revoked="Revoked",e.Validating="Validating",e.Approved="Approved"}(Ul||(Ul={})),function(e){e.XTAP="XTAP",e.IB="IB",e.None="None"}(Bl||(Bl={})),function(e){e.Queued="Queued",e.InProgress="InProgress",e.Compliant="Compliant",e.NonCompliant="NonCompliant",e.Failed="Failed",e.FailedTemporarily="FailedTemporarily"}(Wl||(Wl={})),function(e){e.PreTeamCreation="PreTeamCreation",e.Unknown="Unknown",e.Pending="Pending",e.InProgress="InProgress",e.Completed="Completed",e.Failed="Failed"}(Gl||(Gl={})),function(e){e.Accept="Accept",e.Reject="Reject"}(Vl||(Vl={})),function(e){e.UnknownError="UnknownError",e.MaximumTeamMembersLimitReached="MaximumTeamMembersLimitReached",e.IBPolicyViolation="IBPolicyViolation",e.UserAlreadyExists="UserAlreadyExists",e.RequireStatusFailed="RequireStatusFailed"}(Hl||(Hl={})),function(e){e.NotJoined="NotJoined",e.Joining="Joining",e.Joined="Joined",e.Pending="Pending"}($l||($l={})),function(e){e.Success="Success",e.Error="Error",e.PartialSuccess="PartialSuccess"}(zl||(zl={})),function(e){e.Joined="Joined",e.Left="Left",e.Promoted="Promoted",e.Demoted="Demoted",e.DemotedAndLeft="DemotedAndLeft"}(ql||(ql={})),function(e){e.LAST_SEVEN_DAYS="LAST_SEVEN_DAYS",e.LAST_THIRTY_DAYS="LAST_THIRTY_DAYS",e.LAST_NINETY_DAYS="LAST_NINETY_DAYS"}(Jl||(Jl={})),function(e){e.PUBLIC="PUBLIC",e.PRIVATE="PRIVATE",e.ORGWIDE="ORGWIDE"}(Ql||(Ql={})),function(e){e.member="member",e.guest="guest"}(Kl||(Kl={})),function(e){e.ImportContactsMsa="ImportContactsMsa",e.ImportContactsGoogle="ImportContactsGoogle",e.JoinByCode="JoinByCode"}(Yl||(Yl={})),function(e){e.pastMeeting="pastMeeting",e.upcomingMeeting="upcomingMeeting"}(Xl||(Xl={})),function(e){e.CallStarted="CallStarted",e.CallEnded="CallEnded",e.TranscriptStarted="TranscriptStarted",e.TranscriptStopped="TranscriptStopped",e.ParticipantJoined="ParticipantJoined",e.ParticipantLeft="ParticipantLeft",e.UserEdit="UserEdit",e.RoomAttributionStarted="RoomAttributionStarted",e.RoomAttributionStopped="RoomAttributionStopped",e.TranscriptPublished="TranscriptPublished",e.SessionHandover="SessionHandover",e.RoomAttributionFailed="RoomAttributionFailed"}(Zl||(Zl={})),function(e){e.CallEvents="CallEvents",e.Transcript="Transcript"}(ed||(ed={})),function(e){e.Calling="Calling"}(td||(td={})),function(e){e.personalFileSite="personalFileSite",e.userPersonalSettings="userPersonalSettings",e.firstLoginInformation="firstLoginInformation",e.readReceiptsEnabled="readReceiptsEnabled",e.controllerConnectedServicesEnabled="controllerConnectedServicesEnabled",e.translationSettings="translationSettings",e.favorites="favorites",e.teamsOrder="teamsOrder",e.showInMeetingReport="showInMeetingReport",e.mobileContactsSync="mobileContactsSync",e.userPinnedApps="userPinnedApps",e.suggestedRepliesSettings="suggestedRepliesSettings",e.suggestedScheduleMessageDeliverySettings="suggestedScheduleMessageDeliverySettings",e.cortanaSettings="cortanaSettings",e.callAccessibilitySettings="callAccessibilitySettings",e.vivaTopicsSettings="vivaTopicsSettings",e.selfChatSettings="selfChatSettings",e.eduSimplifiedUxListDefault="eduSimplifiedUxListDefault",e.enableChannelsV2="enableChannelsV2",e.preferredSkinToneIndex="preferredSkinToneIndex",e.userEnableSurveysNotification="userEnableSurveysNotification"}(nd||(nd={})),function(e){e.Translate="Translate",e.NeverTranslate="NeverTranslate",e.Unknown="Unknown"}(id||(id={})),function(e){e.Unknown="Unknown",e.Available="Available",e.NotAvailable="NotAvailable"}(ad||(ad={})),function(e){e.Immediately="Immediately",e.Every10Mins="Every10Mins",e.Hourly="Hourly",e.EveryEightHours="EveryEightHours",e.Daily="Daily",e.Never="Never"}(od||(od={})),function(e){e.Daily="Daily",e.Never="Never"}(rd||(rd={})),function(e){e.MeetingsUserParticipatesIn="MeetingsUserParticipatesIn",e.MeetingsUserIsInvitedTo="MeetingsUserIsInvitedTo",e.MeetingsManuallyUnmuted="MeetingsManuallyUnmuted"}(sd||(sd={})),function(e){e.Teams="Teams",e.Desktop="Desktop",e.Web="Web",e.Unknown="Unknown"}(ld||(ld={})),function(e){e.On="On",e.Off="Off",e.BannerAndFeed="BannerAndFeed",e.OnlyFeed="OnlyFeed",e.OnlyBanner="OnlyBanner",e.All="All",e.CallMentionChats="CallMentionChats",e.Immediately="Immediately",e.Every10Mins="Every10Mins",e.Hourly="Hourly",e.EveryEightHours="EveryEightHours",e.Daily="Daily",e.Never="Never",e.AllActivity="AllActivity",e.MyAtMentions="MyAtMentions",e.Custom="Custom"}(dd||(dd={})),function(e){e.Private="Private",e.Public="Public"}(cd||(cd={}))},93044:(e,t,n)=>{"use strict";n.d(t,{g_h:()=>i});const i={possibleTypes:{MeetingCoordinates:["LegacyMeetingCoordinates","MeetingDataCoordinates"],CallingWindowingContentChangedEvent:["CallingWindowingConversationOrReplyChainContentUpdate"],CallingServiceEvent:["CallAdded","CallRemoved","CallUpdated","CallAlertsUpdated","CallDeviceListUpdated","ParticipantsOnCallConnected"],CallTransfer:["CallTransferred","CallTransferredFailed","CallTransferredSucceeded"],ParticipantsChangedEvent:["ParticipantsChanged","ParticipantCountsChanged"],CallAudienceBotDataChannel:["CallAudienceSceneChanged","CallAudienceSelectSceneAck"],CortanaEvent:["CortanaInvocationStateChanged","CortanaStateChanged"],ExplicitRecordingConsentUpdateResult:["ExplicitRecordingConsentState","ExplicitRecordingConsentTransactionEnd"],ParkedCall:["RegularParkedCall","SLAParkedCall"],CallingAppEventType:["CallingContentEvent","CallingAppSetupEvent"],CallingContent:["CallingBannerContent","CallingWindowingContent","CallingDialogContent","CallingNotificationContent","CallingToChatContent","CallingToChatListContent","CallingToCallListContent","CallingToSettingsPaneContent"],ThirdPartyDevicesEvent:["ThirdPartyDevicePairingRequest","ThirdPartyDeviceMeetingReactionRequest","ThirdPartyDeviceToggleRequest"],HolographicAnnotationEvent:["HolographicAnnotationCreatedEvent","HolographicAnnotationModifiedEvent","HolographicAnnotationRemovedEvent","HolographicInteractionEnabledEvent","HolographicInteractionInitializedEvent","HolographicInteractionComponentChangedEvent","HolographicSnapshotEnabledEvent","HolographicResetEvent","HolographicFreezeFrameEvent"],VideoEffectConfigChanged:["TouchUpToggleChanged","TouchUpStrengthChanged","AutoAdjustToggleChanged","EyeContactToggleChanged"],ContentSharingSession:["PptSharingSession","WhiteboardSharingSession"],ActionStatusEvent:["SendMessageActionData","ReactionsActionData","ErrorActionData"],CallCoordinates:["LegacyMeetingCoordinates","MeetingDataCoordinates","ExistingCallCoordinates","OneToOneCoordinates","GroupCallCoordinates"],CallJoinOptions:["JoinOptions","MeetingJoinOptions","OneToOneJoinOptions","GroupCallJoinOptions"],MeetingArtifactV2Interface:["MeetingArtifactV2Transcript","MeetingArtifactV2Recording","MeetingArtifactV2Notes","MeetingArtifactV2MeetingContent","MeetingArtifactV2Default"],IConnection:["ContactsSuggestionsConnection","ActivitiesConnection","AppReviewsConnection","AppReviewCommentsConnection","ReplyChainSummaryConnection","ReplyChainMessageConnection","ChatsConnection","SearchTeamConnection"],IEdge:["ContactsSuggestionsEdge","ActivityEdge","AppReviewEdge","AppReviewCommentEdge","ReplyChainSummaryEdge","ReplyChainMessagesEdge","ChatsEdge","SearchTeamsEdge"],IEdgeNode:["ContactsSuggestionsItem","Conversation","FeedActivity","AppReview","AppReviewComment","ReplyChainSummary","ReplyChainMessageNode","DiscoverTeamDetails"],IMessage:["Message","LastMessage","ReplyChainMessage","MeetingReplyMessage","StandardPostMessage","AnnouncementPostMessage","EmailPostMessage","MeetingPostMessage","ConnectorPostMessage","GuardiansPostMessage"],ChannelSystemMessage:["BaseChannelSystemMessage","AddDeleteMemberSystemMessage","ChannelUpdatesSystemMessage","PinnedItemSystemMessage","ManageMembersSystemMessage","ChannelAddDeleteSystemMessage","SharedInSpacesSystemMessage","RoleUpdateSystemMessage","UpdateFavDefaultSystemMessage"],ChannelSystemMessageType:["BaseChannelSystemMessage","AddDeleteMemberSystemMessage","ChannelUpdatesSystemMessage","PinnedItemSystemMessage","ManageMembersSystemMessage","ChannelAddDeleteSystemMessage","SharedInSpacesSystemMessage","RoleUpdateSystemMessage","UpdateFavDefaultSystemMessage"],Dimension:["DimensionInFloat","DimensionInString"],BreakoutRoomsParticipantDetails:["ParticipantMainMeetingDetails","ParticipantBreakoutRoomDetails"],CommunitiesUpdateEvent:["CommunitiesUpdate"],TeamsAndChannelsUpdateEvent:["TeamUpdate","ChannelUpdate"],TeamAndChannelListUpdateEvent:["TeamUpdate","ChannelUpdate"],PinnedConversationItemInfo:["Message"],CalendarMultiSlotEventPayload:["CalendarFormCacheSyncEvent","CalendarFormSpinnerEvent","CalendarFormShareDialogEvent","CalendarFormErrorEvent","CalendarToggleTabEvent"],Mentionable:["TagCard","User","ChannelMentionSearchResult","AppDefinition","CommandDefinition"],DeleteActivityFeedItemStatusUpdate:["ActivityFeedItemDeletionSuccessResult","ActivityFeedItemDeletionFailedResult"],FeedLocationLocaleParams:["DefaultFeedLocaleParams","ChannelFeedLocationLocaleParams"],FeedTitleLocaleParams:["DefaultFeedLocaleParams","ChannelFeedTitleLocaleParams"],AppBarIcon:["InternalIcon","RemoteImage"],LaunchTileBadge:["LaunchTileNumericBadge"],M365Application:["M365HubApplication","M365PlatformApplication"],M365ApplicationIcon:["InternalIcon","RemoteImage"],M365ApplicationBadge:["M365ApplicationNumericBadge"],EventTrigger:["AppAcquisitionLink","AppSecondaryAction"],InvokeAdaptiveCardTabResult:["AdaptiveCardTabContinue","AdaptiveCardTabDone","AdaptiveCardTabAuth"],InvokeTaskModuleResult:["TaskModuleTaskContinue","TaskModuleTaskMessage","TaskModuleTaskDone"],MessageExtensionTaskResult:["TaskModuleTaskContinue","TaskModuleTaskMessage","TaskModuleTaskDone","MessageExtensionResult"],BotConfigTaskResult:["TaskModuleTaskContinue","TaskModuleTaskMessage","TaskModuleTaskDone","BotConfigResult"],AdaptiveCardTabTaskResult:["TaskModuleTaskContinue","TaskModuleTaskMessage","TaskModuleTaskDone","AdaptiveCardTabContinue"],CalendarSyncPayloads:["CalendarSyncPayload","ConnectedCalendarSyncPayload","MultiCalendarSyncPayload","CalendarLeftRailSettingsSyncPayload"],CalendarCreateUpdateEventResult:["CalendarEvent","CalendarErrorResponse"],IPostMessage:["StandardPostMessage","AnnouncementPostMessage","EmailPostMessage","MeetingPostMessage","ConnectorPostMessage","GuardiansPostMessage"],ChannelPostMessage:["StandardPostMessage","AnnouncementPostMessage","EmailPostMessage","MeetingPostMessage","ConnectorPostMessage","GuardiansPostMessage"],ChannelReplyMessage:["ReplyChainMessage","MeetingReplyMessage"],ChannelMessage:["ReplyChainMessage","MeetingReplyMessage","StandardPostMessage","AnnouncementPostMessage","EmailPostMessage","MeetingPostMessage","ConnectorPostMessage","GuardiansPostMessage"],ConversationPinnedResult:["ConversationPinnedUpdate","SetChatPinnedMaxLimitReachedError"],ChatServiceEvent:["NewMessage","MessageUpdate","ThreadUpdate","ConversationUpdate","ConversationFullUpdate","ConsumptionHorizonUpdate","ResolveConversationLie","DiscardConversation","NotificationUpdate"],DiscoverSurfaceContainerEntity:["DiscoverSurfaceContainerEntityChannel","DiscoverSurfaceContainerEntityDefault"],DiscoverSurfaceUserPreferenceForEntity:["DiscoverSurfaceUserPreferenceForEntityActorKind","DiscoverSurfaceUserPreferenceForEntityContainerKind"],EspResource:["EspNotLocalizedResource","EspLocalizedResource"],EspUserInterfaceControl:["EspTextControl","EspImageControl","EspButtonControl","EspSpaceControl","EspInfoItemControl"],EspSurfaceParams:["EspModalParams","EspCoachmarkParams","EspNotificationParams","EspQuickGuideParams","EspIrisParams"],EspAction:["EspNoParamsAction","EspEntityCommandAction","EspDeeplinkNavigationAction","EspFollowUpSurfaceAction","EspUrlNavigationAction"],SetExternalCalendarEmailAddressResult:["User","SetExternalCalendarEmailAddressError"],ClientPreferenceCategoryTypes:["AnimationPreferences","DensityPreferences","FlyoutCameraPreferences","InfoPanePreferences","PerformancePreferences","AppSwitcherPreferences","ThemePreferences","VideoEffectPreferences","AvatarPreferences","PromoBadgePreferences","TeamLayoutPreferences","DiagnosticsLogsPreferences"],PlatformTab:["BasicTab","ExtensionTab","WikiTab","FileViewTab","PowerBiTab","WebsiteTab","DocumentLibraryTab","OneNoteTab","StaticExtensionTab","LegacyWikiTab","LegacyDocumentLibraryTab","PlaceholderTab","CalendarTab"],PresenceError:["PresenceErrorGeneric","PresenceErrorNetworkOffline"],PresenceResult:["PresenceSuccess","PresenceErrorNetworkOffline","PresenceErrorGeneric"],BaseSearchSuggestionEntity:["PeopleSearchSuggestionEntity","GroupChatSearchSuggestionEntity","QuerySearchSuggestionEntity","JoinLinkDialogSuggestionEntity"],SearchSuggestionNavigationObject:["PeopleSuggestionNavigation","ConversationSuggestionNavigation","QuerySuggestionNavigation","JoinLinkDialogNavigation"],SearchSuggestionEntity:["PeopleSearchSuggestionEntity","GroupChatSearchSuggestionEntity","QuerySearchSuggestionEntity"],SBGroupLayout:["SBGroupLayoutSingleRenderer","SBGroupLayoutMultiRenderer"],CalendarInsight:["Quorum","OutOfRoutine","Conflicts"],CalendarArtifact:["AttachmentGroupType","RelatedEmailType"],AllSearchResults:["SearchMessageResult","SearchFileResult","PeopleSearchResult","SearchEmailResult"],UserPreferencesCategoryValue:["PersonalFileSiteDetailsValue","UserSettingsValue","FirstLoginInformationValue","ReadReceiptsEnabledValue","IsSingleUserTenantValue","CortanaSettingsValue","ControllerConnectedServicesEnabledValue","SuggestedRepliesSettingsValue","SuggestedScheduleMessageDeliverySettings","TranslationSettingsValue","FavoritesValue","TeamOrdersValue","ShowInMeetingReportValue","MobileContactsSyncValue","UserPinnedAppValue","CallAccessibilitySettingsValue","SelfChatSettingsValue","EnableChannelsV2Value","VivaTopicsSettingsValue","EduSimplifiedUxListDefaultValue","PreferredSkinToneIndexValue","UserEnableSurveysNotificationValue"],UserPreferencesResponse:["UserPreferences","UserPreferencesError"]}}.possibleTypes},37212:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"appDefinition"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"developerName"}},{kind:"Field",name:{kind:"Name",value:"developerUrl"}},{kind:"Field",name:{kind:"Name",value:"privacyUrl"}},{kind:"Field",name:{kind:"Name",value:"termsOfUseUrl"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"shortDescription"}},{kind:"Field",name:{kind:"Name",value:"longDescription"}},{kind:"Field",name:{kind:"Name",value:"smallImageUrl"}},{kind:"Field",name:{kind:"Name",value:"largeImageUrl"}},{kind:"Field",name:{kind:"Name",value:"accentColor"}},{kind:"Field",name:{kind:"Name",value:"categories"}},{kind:"Field",name:{kind:"Name",value:"validDomains"}},{kind:"Field",name:{kind:"Name",value:"externalId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"isBlocked"}},{kind:"Field",name:{kind:"Name",value:"isFullScreenApp"}},{kind:"Field",name:{kind:"Name",value:"isFullTrustApp"}},{kind:"Field",name:{kind:"Name",value:"isMicrosoftOwned"}},{kind:"Field",name:{kind:"Name",value:"showTabLoadingIndicator"}},{kind:"Field",name:{kind:"Name",value:"bots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"botDefinition"}}]}},{kind:"Field",name:{kind:"Name",value:"customBots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"endpointUrl"}},{kind:"Field",name:{kind:"Name",value:"secret"}}]}},{kind:"Field",name:{kind:"Name",value:"connectors"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorId"}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"galleryTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"configurationUrl"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"canHaveTabConversation"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"meetingSurfaces"}},{kind:"Field",name:{kind:"Name",value:"context"}}]}},{kind:"Field",name:{kind:"Name",value:"staticTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"order"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}},{kind:"Field",name:{kind:"Name",value:"contentBotId"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"containerAppIds"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingExtensionDefinition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isAnonymousAccessAllowed"}},{kind:"Field",name:{kind:"Name",value:"supportsStreaming"}},{kind:"Field",name:{kind:"Name",value:"scenes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"file"}},{kind:"Field",name:{kind:"Name",value:"preview"}},{kind:"Field",name:{kind:"Name",value:"maxAudience"}},{kind:"Field",name:{kind:"Name",value:"seatsReservedForOrganizersOrPresenters"}}]}},{kind:"Field",name:{kind:"Name",value:"filters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}}]}},{kind:"Field",name:{kind:"Name",value:"videoAppContentUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"authorization"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"orgWide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"resourceSpecific"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"fetchCommands"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"initialRun"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"parameters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"inputType"}},{kind:"Field",name:{kind:"Name",value:"value"}},{kind:"Field",name:{kind:"Name",value:"choices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"appKey"}},{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"messageHandlers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"value"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"domains"}},{kind:"Field",name:{kind:"Name",value:"supportsAnonymousAccess"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"webApplicationInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appKey"}},{kind:"Field",name:{kind:"Name",value:"resource"}},{kind:"Field",name:{kind:"Name",value:"applicationPermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"screenshotUrls"}},{kind:"Field",name:{kind:"Name",value:"officeAssetId"}},{kind:"Field",name:{kind:"Name",value:"videoUrl"}},{kind:"Field",name:{kind:"Name",value:"devicePermissions"}},{kind:"Field",name:{kind:"Name",value:"securityComplianceInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mcasId"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"csaId"}},{kind:"Field",name:{kind:"Name",value:"csaName"}}]}},{kind:"Field",name:{kind:"Name",value:"defaultInstallScope"}},{kind:"Field",name:{kind:"Name",value:"defaultGroupCapability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"team"}},{kind:"Field",name:{kind:"Name",value:"groupchat"}},{kind:"Field",name:{kind:"Name",value:"meetings"}}]}},{kind:"Field",name:{kind:"Name",value:"subscriptionOffer"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"offerId"}}]}},{kind:"Field",name:{kind:"Name",value:"manifestVersion"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"botDefinition"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BotDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"capabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isNotificationOnly"}},{kind:"Field",name:{kind:"Name",value:"supportsFiles"}},{kind:"Field",name:{kind:"Name",value:"supportsCalling"}},{kind:"Field",name:{kind:"Name",value:"supportsVideo"}}]}},{kind:"Field",name:{kind:"Name",value:"commandLists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"configuration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupChat"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"team"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}}]}}]}}]}},58963:(e,t,n)=>{"use strict";n.d(t,{_:()=>a});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"sdnFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SDNDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"playbackInfo"}},{kind:"Field",name:{kind:"Name",value:"pluginUrl"}},{kind:"Field",name:{kind:"Name",value:"sdkUrl"}}]}}]},a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"broadcastFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Broadcast"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"userRole"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"streamingDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"streamingDetailsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"qna"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isEnabled"}},{kind:"Field",name:{kind:"Name",value:"attendeeUrl"}},{kind:"Field",name:{kind:"Name",value:"moderatorUrl"}},{kind:"Field",name:{kind:"Name",value:"iosAutodiscoverUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"yammer"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isEnabled"}},{kind:"Field",name:{kind:"Name",value:"broadcastId"}},{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"eventUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingStatus"}},{kind:"Field",name:{kind:"Name",value:"sdn"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"sdnFields"}}]}},{kind:"Field",name:{kind:"Name",value:"transcription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isEnabled"}},{kind:"Field",name:{kind:"Name",value:"isSuppressed"}},{kind:"Field",name:{kind:"Name",value:"transcriptionLanguage"}},{kind:"Field",name:{kind:"Name",value:"translationLanguages"}},{kind:"Field",name:{kind:"Name",value:"captionsCacheUrl"}},{kind:"Field",name:{kind:"Name",value:"captionsOriginUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"aesKey"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"iv"}},{kind:"Field",name:{kind:"Name",value:"expiry"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"aesKeyRefresh"}},{kind:"Field",name:{kind:"Name",value:"error"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"errorFields"}}]}},{kind:"Field",name:{kind:"Name",value:"utcStart"}},{kind:"Field",name:{kind:"Name",value:"utcEnd"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"supportUrl"}},{kind:"Field",name:{kind:"Name",value:"streamResource"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attendeeEmbed"}}]}},{kind:"Field",name:{kind:"Name",value:"signalR"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attendeeHubName"}},{kind:"Field",name:{kind:"Name",value:"eventTeamHubName"}},{kind:"Field",name:{kind:"Name",value:"setCookieUrl"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"querystrings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"joinid"}},{kind:"Field",name:{kind:"Name",value:"msgid"}},{kind:"Field",name:{kind:"Name",value:"organizerid"}},{kind:"Field",name:{kind:"Name",value:"tenantid"}},{kind:"Field",name:{kind:"Name",value:"threadid"}},{kind:"Field",name:{kind:"Name",value:"uid"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"broadcastRestartVersion"}},{kind:"Field",name:{kind:"Name",value:"odspVodShareUrl"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"streamingDetailsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastStreamingDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"stream"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"streamFields"}}]}},{kind:"Field",name:{kind:"Name",value:"altStream"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"streamFields"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"streamFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastStreamingInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"wamsStreamingUrl"}},{kind:"Field",name:{kind:"Name",value:"decryptionToken"}},{kind:"Field",name:{kind:"Name",value:"keyAuthorizationToken"}},{kind:"Field",name:{kind:"Name",value:"setKeyAuthorizationCookieUri"}},{kind:"Field",name:{kind:"Name",value:"sdn"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"sdnFields"}}]}}]}},...i.definitions]}.definitions]}.definitions,...i.definitions,{kind:"FragmentDefinition",name:{kind:"Name",value:"errorFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastErrorDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"errorMessage"}},{kind:"Field",name:{kind:"Name",value:"errorCode"}},{kind:"Field",name:{kind:"Name",value:"code"}},{kind:"Field",name:{kind:"Name",value:"errorSubCode"}}]}}]}},75206:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConsumptionHorizonBookmark"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}}]}}]}},21164:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"consumptionHorizonFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConsumptionHorizon"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}}]}}]}},16792:(e,t,n)=>{"use strict";n.d(t,{V:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataTypesCommonUserI18NFieldsFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"User"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"givenName"}},{kind:"Field",name:{kind:"Name",value:"surname"}}]}}]}},57842:(e,t,n)=>{"use strict";n.d(t,{W:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"installedAppFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InstalledApp"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"installationState"}},{kind:"Field",name:{kind:"Name",value:"installedAppProps"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUninstallable"}},{kind:"Field",name:{kind:"Name",value:"isAdminPreInstalled"}},{kind:"Field",name:{kind:"Name",value:"isNewGlobalPreInstalled"}},{kind:"Field",name:{kind:"Name",value:"isNewAdminPreInstalled"}}]}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"installedVersion"}},{kind:"Field",name:{kind:"Name",value:"messageExtensionStates"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageExtensionState"}}]}},{kind:"Field",name:{kind:"Name",value:"definition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}},{kind:"Field",name:{kind:"Name",value:"permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appPermissions"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"messageExtensionState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MessageExtensionState"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"pinOrder"}}]}},...n(37212).E.definitions,{kind:"FragmentDefinition",name:{kind:"Name",value:"appPermissions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppPermissions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"orgWide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"resourceSpecific"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}},40950:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"lastMessageFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LastMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"cardClientId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}}]}}]}}]}},99451:(e,t,n)=>{"use strict";n.d(t,{q:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingInformationFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingInformation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"scenario"}},{kind:"Field",name:{kind:"Name",value:"meetingType"}},{kind:"Field",name:{kind:"Name",value:"meetingData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meetingCode"}},{kind:"Field",name:{kind:"Name",value:"passcode"}},{kind:"Field",name:{kind:"Name",value:"meetingUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"isRecurring"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"eventRecurrenceRange"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"}},{kind:"Field",name:{kind:"Name",value:"endDate"}}]}},{kind:"Field",name:{kind:"Name",value:"eventRecurrencePattern"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patternType"}},{kind:"Field",name:{kind:"Name",value:"daily"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"weekly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"daysOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"monthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfMonth"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeMonthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"yearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheMonth"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeYearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"resolvedSensitivityLabelId"}},{kind:"Field",name:{kind:"Name",value:"isCopyRestrictionEnforced"}}]}}]}},92779:(e,t,n)=>{"use strict";n.d(t,{u_:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"participantFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Participant"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isServerMuted"}},{kind:"Field",name:{kind:"Name",value:"isHandRaised"}},{kind:"Field",name:{kind:"Name",value:"raiseHandsRank"}},{kind:"Field",name:{kind:"Name",value:"raiseHandsOrderedRank"}},{kind:"Field",name:{kind:"Name",value:"isSpotlighted"}},{kind:"Field",name:{kind:"Name",value:"spotlightRank"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"isReconciled"}},{kind:"Field",name:{kind:"Name",value:"streams"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"participantStreamFields"}}]}},{kind:"Field",name:{kind:"Name",value:"audio"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"participantStreamFields"}}]}},{kind:"Field",name:{kind:"Name",value:"isFake"}},{kind:"Field",name:{kind:"Name",value:"isVideoLive"}},{kind:"Field",name:{kind:"Name",value:"isScreenShareLive"}},{kind:"Field",name:{kind:"Name",value:"meetingRole"}},{kind:"Field",name:{kind:"Name",value:"stateReason"}},{kind:"Field",name:{kind:"Name",value:"contentSharingRole"}},{kind:"Field",name:{kind:"Name",value:"participantId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"visible"}},{kind:"Field",name:{kind:"Name",value:"holographicDevice"}},{kind:"Field",name:{kind:"Name",value:"timeZoneOffset"}},{kind:"Field",name:{kind:"Name",value:"endpoints"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"endpointDetailsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"weathermanModeDetail"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"weathermanModeDetailFields"}}]}},{kind:"Field",name:{kind:"Name",value:"mappedTo"}},{kind:"Field",name:{kind:"Name",value:"mappedToMeetingRoom"}},{kind:"Field",name:{kind:"Name",value:"deviceType"}},{kind:"Field",name:{kind:"Name",value:"interpretationDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isInterpreter"}},{kind:"Field",name:{kind:"Name",value:"group"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"joinCorrelationId"}},{kind:"Field",name:{kind:"Name",value:"isInSameRoom"}},{kind:"Field",name:{kind:"Name",value:"isIdentityMasked"}},{kind:"Field",name:{kind:"Name",value:"nonMaskedId"}},{kind:"Field",name:{kind:"Name",value:"nonMaskedDisplayName"}},{kind:"Field",name:{kind:"Name",value:"maskedIdSeqNumber"}},{kind:"Field",name:{kind:"Name",value:"displayNameOverride"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"participantStreamFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ParticipantStream"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAvailable"}},{kind:"Field",name:{kind:"Name",value:"isStreaming"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"rank"}},{kind:"Field",name:{kind:"Name",value:"negotiationTag"}},{kind:"Field",name:{kind:"Name",value:"participantLegId"}},{kind:"Field",name:{kind:"Name",value:"label"}},{kind:"Field",name:{kind:"Name",value:"endpointId"}},{kind:"Field",name:{kind:"Name",value:"dynamicVirtualParticipantId"}},{kind:"Field",name:{kind:"Name",value:"sourceId"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"endpointDetailsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EndpointDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"originalId"}},{kind:"Field",name:{kind:"Name",value:"participantId"}},{kind:"Field",name:{kind:"Name",value:"clientEndpointCapabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"clientEndpointCapabilitiesFields"}}]}},{kind:"Field",name:{kind:"Name",value:"endpointId"}},{kind:"Field",name:{kind:"Name",value:"endpointMetadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"audienceview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"page"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"botData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"hiddenParticipant"}},{kind:"Field",name:{kind:"Name",value:"hiddenStream"}},{kind:"Field",name:{kind:"Name",value:"canBeMutedAndUnMuted"}},{kind:"Field",name:{kind:"Name",value:"page"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"clientEndpointCapabilitiesFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ClientEndpointCapabilities"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CanSupportBreakOutRoom"}}]}}]}.definitions,{kind:"FragmentDefinition",name:{kind:"Name",value:"weathermanModeDetailFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WeathermanModeDetail"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isWeatherpersonPresenter"}},{kind:"Field",name:{kind:"Name",value:"overlayCoords"}}]}}]}},43724:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"pinnedMessageItemFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},21305:(e,t,n)=>{"use strict";n.d(t,{l:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"typingUserFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"TypingUser"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"arrivalTime"}}]}}]}},30958:(e,t,n)=>{"use strict";n.d(t,{f:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"User"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"decoratedDisplayName"}},{kind:"Field",name:{kind:"Name",value:"givenName"}},{kind:"Field",name:{kind:"Name",value:"surname"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"tenantName"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"jobTitle"}},{kind:"Field",name:{kind:"Name",value:"department"}},{kind:"Field",name:{kind:"Name",value:"featureSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"featureSettingsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"featureSettingsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UserFeatureSettingsInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"coExistenceMode"}},{kind:"Field",name:{kind:"Name",value:"isPrivateChatEnabled"}}]}}]}},27240:(e,t,n)=>{"use strict";n.d(t,{I:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userProperties"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConversationUserProperties"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isMutedInChannel"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"maskId"}}]}}]}},26304:(e,t,n)=>{"use strict";n.d(t,{g:()=>i});const i={M365Application:["M365HubApplication","M365PlatformApplication"],M365ApplicationIcon:["InternalIcon","RemoteImage"],M365ApplicationBadge:["M365ApplicationNumericBadge"],EventTrigger:["AppAcquisitionLink","AppSecondaryAction"],Node:["M365HubApplication","M365PlatformApplication","Conversation","Me","FullAccount","Cloud","ActiveTenant","InactiveTenant","MeInOtherTenant","Person","MePresence","PersonPresence","AvailabilityOption"],ConnectionEdge:["M365ApplicationEdge","AccountEdge","TenantEdge"],ConnectionEdgeWithCursorPagination:[],Connection:["M365ApplicationConnection","AccountConnection","TenantConnection"],ConnectionWithCursorPagination:[],MutationFailure:["PresenceMutationFailure","PresenceMutationFailureNetworkOffline"],BaseAccount:["FullAccount","Cloud"],Account:["FullAccount","Cloud"],Tenant:["ActiveTenant","InactiveTenant"],BaseTenant:["ActiveTenant","InactiveTenant"],Persona:["Me","MeInOtherTenant","Person"],Individual:["Me","MeInOtherTenant","Person"],Presence:["MePresence","PersonPresence"],PresenceStatusNoteExpiry:["PresenceStatusNoteExpiryPreDefined","PresenceStatusNoteExpiryCustom"],PresenceMutationResult:["PresenceMutationSuccess","PresenceMutationFailure","PresenceMutationFailureNetworkOffline"]}},53046:(e,t,n)=>{"use strict";n.r(t),n.d(t,{resolvers:()=>h,typeDefs:()=>f});var i=n(13637),a=n(83134),o=n(31821),r=n(59270),s=n(6866),l=n(82250),d=n(12354),c=n(90649),u=n(60780),m=n(60025),g=n(13931),p=n(78756);const h={Query:{authenticationUsers(e,{filter:t},{authenticationService:n}){var a,o;return(0,i.mG)(this,void 0,void 0,(function*(){const e=t?{}:void 0;e&&(null==t?void 0:t.isAuthenticated)&&(e.isAuthenticated=t.isAuthenticated),e&&(null==t?void 0:t.isPrimaryUser)&&(e.isPrimaryUser=t.isPrimaryUser);return v(null!==(o=yield null===(a=null==n?void 0:n.getCachedUsers)||void 0===a?void 0:a.call(n,{id:(0,d.pW)(),source:"authenticationUsersQuery",scenarioName:l.RG.AuthWebCachedUser},e))&&void 0!==o?o:[])}))},authenticatedUser(e,{allowAnon:t,tenantId:n,loginHint:a,userContextId:o},{authenticationService:r,correlation:s,loggerFactory:c}){return(0,i.mG)(this,void 0,void 0,(function*(){const e=null==c?void 0:c.newLogger("AuthenticationService"),i={id:(null==s?void 0:s.id)||(0,d.pW)(),source:(null==s?void 0:s.source)||"getUserQuery",scenarioName:(null==s?void 0:s.scenarioName)||l.RG.AuthWebUser};try{const e=yield r.getUser({allowAnon:t,correlation:i,tenantId:null!=n?n:void 0,loginHint:null!=a?a:void 0,accountId:null!=o?o:void 0});return e?S(e):null}catch(t){throw null==e||e.warn(`[resolvers][authenticatedUser] ${t.code||t.errorCode} - ${t.message}`),t}}))},authenticationToken(e,{resource:t,acquireTokenOptions:n},{authenticationService:a,windowId:o}){return(0,i.mG)(this,void 0,void 0,(function*(){return{token:yield a.acquireToken(t,{claim:(null==n?void 0:n.claim)||void 0,windowId:o||void 0,silent:n&&null!=n.silent?n.silent:void 0,userIdentifier:(null==n?void 0:n.userIdentifier)||void 0,tenantId:(null==n?void 0:n.tenantId)||void 0})}}))},authConsent(e,{resource:t,tenantId:n,acquireTokenOptions:a},{authenticationService:o,correlation:r,windowId:s,loggerFactory:l}){var c;return(0,i.mG)(this,void 0,void 0,(function*(){const e=null==l?void 0:l.newLogger("AuthenticationService");return o.acquireToken(t,{claim:(null==a?void 0:a.claim)||void 0,windowId:s||void 0,silent:a&&null!==a.silent?a.silent:void 0,userIdentifier:(null==a?void 0:a.userIdentifier)||void 0,correlationId:null!==(c=null==r?void 0:r.id)&&void 0!==c?c:(0,d.pW)(),tenantId:n}).then((()=>({consentAccepted:!0}))).catch((t=>(null==e||e.warn(`[resolvers][authConsent] Failed to acquire user's consent with error: ${t.code||t.errorCode} - ${t.message}`),{consentAccepted:!1})))}))},hostMachineUsers(e,{fetchAuthenticatedUsers:t},{authenticationService:n,loggerFactory:a}){var o,r;return(0,i.mG)(this,void 0,void 0,(function*(){const e=null==a?void 0:a.newLogger("AuthenticationService"),i=yield null===(o=n.getHostMachineUsers)||void 0===o?void 0:o.call(n,(0,d.pW)()).catch((t=>e&&e.warn(`[resolvers][hostMachineUsers] ${t.code||t.errorCode} - ${t.message}`)));if(null!=t){return function(e,t,n){if(!e||e.length<1||!t||(null==t?void 0:t.length)<1)return n?[]:e;return n?e.filter((e=>t.find((({id:t})=>e.id===t)))):e.filter((e=>!t.find((({id:t})=>e.id===t))))}(i,yield null===(r=n.getCachedUsers)||void 0===r?void 0:r.call(n,{id:(0,d.pW)(),scenarioName:l.RG.AuthWebCachedUser,source:"server-resolvers::hostMachineUsers"}),t)}return i||[]}))},tenantData(e,{accountId:t},{authenticationService:n,correlation:a}){var o;return(0,i.mG)(this,void 0,void 0,(function*(){if(!a||!a.source)throw new Error("CorrelationKey is not passed to UseGetTenantData");const e={id:(null==a?void 0:a.id)||(0,d.pW)(),scenarioName:(null==a?void 0:a.scenarioName)||l.RG.AuthWebGetTenantData,source:(null==a?void 0:a.source)||"server-resolver"},[i,r]=(0,c.OU)({options:{correlation:e},subContext:"tenantData",scenarioName:l.RG.AuthWebGetTenantData,source:"server-resolver"});i.addScenarioMark(l.ck.AuthWebGetTenantDataResolverStart);try{const e=yield null===(o=n.getTenantData)||void 0===o?void 0:o.call(n,{correlation:a,accountId:t});return i.addScenarioMark(l.ck.AuthWebGetTenantDataResolverStop),r(),e||null}catch(e){throw i.addScenarioMark(l.ck.AuthWebGetTenantDataResolverStop,{error:e}),r({error:e}),e}}))},userAuthState(e,{userContextId:t},{authenticationService:n,correlation:a}){var o;return(0,i.mG)(this,void 0,void 0,(function*(){if(!(null==a?void 0:a.source))throw new Error("CorrelationKey is not passed to userAuthState");const e={id:a.id||(0,d.pW)(),scenarioName:a.scenarioName||l.RG.AuthWebGetTenantData,source:a.source},[i,r]=(0,c.OU)({options:{correlation:e},subContext:"tenantData",scenarioName:l.RG.AuthWebGetTenantData,source:"server-resolver"});i.addScenarioMark(l.ck.AuthWebGetUserAuthStateResolverStart);try{const a=yield null===(o=n.getUserAuthState)||void 0===o?void 0:o.call(n,{correlation:e,accountId:t});return i.addScenarioMark(l.ck.AuthWebGetUserAuthStateResolverStop),a||null}catch(e){throw i.addScenarioMark(l.ck.AuthWebGetUserAuthStateResolverStop,{error:e}),r({error:e}),e}}))}},Mutation:{authenticateUser(e,{id:t,correlationId:n,loginHint:a},{authenticationService:r,windowId:s,coreSettings:l,loggerFactory:c,correlation:m}){return(0,i.mG)(this,void 0,void 0,(function*(){const e=null==c?void 0:c.newLogger("AuthenticationService"),g={accountId:t||"",correlation:{id:null!=n?n:(0,d.pW)(),source:(null==m?void 0:m.source)||"login-mutation",scenarioName:(null==m?void 0:m.scenarioName)||"auth_web_login"},loginHint:null!=a?a:"",prompt:"login",silent:!1,windowId:s||void 0};return r.login(g).then((e=>(0,i.mG)(this,void 0,void 0,(function*(){return e?S(e):null})))).catch((t=>{var n;if(null==e||e.warn(`[resolvers][authenticateUser] Failed with error: ${t.code||t.errorCode} - isExpected: ${t.isExpected}. ${t.message}.`),t.code=null!==(n=t.code)&&void 0!==n?n:t.errorCode,!t.isExpected||t.errorCode===u.SM.SignInRestrictions||!l.get(o.J.Auth).disableOfflineErrors&&function(e){switch(e){case u.wK.NoNetwork:case u.SM.RemoteOperationFailed:return!0;default:return!1}}(t.errorCode))throw null==e||e.error("[resolvers][authenticateUser] Warning above is fatal. Failing mutation."),t;return null==e||e.log("[resolvers][authenticateUser] Warning above is expected. Ignoring failure."),null}))}))},refreshTenants(e,{userContextId:t},{authenticationService:n,correlation:a}){var o,r;return(0,i.mG)(this,void 0,void 0,(function*(){if(!a||!a.source||!a.id)throw new Error("CorrelationKey is not passed to UseGetTenant");const e={id:a.id,scenarioName:a.scenarioName,source:a.source},[i,s]=(0,c.OU)({options:{correlation:e},subContext:"getTenants",scenarioName:null!==(o=a.scenarioName)&&void 0!==o?o:l.RG.AuthWebSetUpTenants,source:e.source,scenarioEventData:{targetedUser:t}});i.addScenarioMark(l.ck.AuthWebGetTenantDataResolverStart);try{const a=yield null===(r=n.getTenants)||void 0===r?void 0:r.call(n,{correlation:e,forceRefresh:!0,accountId:t});return i.addScenarioMark(l.ck.AuthWebGetTenantDataResolverStop),s(),a||null}catch(e){throw i.addScenarioMark(l.ck.AuthWebGetTenantDataResolverStop,{error:e}),s({error:e}),e}}))},authenticationLogout(e,t,{authenticationService:n}){return(0,i.mG)(this,void 0,void 0,(function*(){return t.correlation||(t.correlation={id:(0,d.pW)(),source:"server-resolvers::authenticationLogout",scenarioName:l.RG.AuthWebLogout}),n.logout?n.logout(t).then((()=>(0,i.mG)(this,void 0,void 0,(function*(){return{succeed:!0}})))).catch((()=>({succeed:!1}))):{succeed:!1}}))},reauthenticateUser(e,t,{authenticationService:n,authStateProvider:a,coreSettings:s,windowId:m,loggerFactory:g}){return(0,i.mG)(this,void 0,void 0,(function*(){const e=null==g?void 0:g.newLogger("AuthenticationService");let t=null==a?void 0:a.getInteractionRequiredResource();if(!t){null==e||e.error("reauthenticateUser called but no InteractionRequired resource found");const{criticalResources:n,mtResource:i}=(null==s?void 0:s.get(o.J.Auth))||{};t=(null==n?void 0:n[0])||i||r.K$}const i={silent:!1,prompt:"login",forceRenew:!0,loginRedirect:!1,windowId:m||void 0,correlation:{id:(0,d.pW)(),scenarioName:l.RG.AcquireToken,source:"reauthenticateUser"}},[,p]=(0,c.OU)({options:i,source:"server-resolvers",scenarioName:l.RG.AcquireToken,subContext:"reauthenticateUser",timeoutMs:!1===i.silent?u.rF.ONE_HOUR:void 0,scenarioEventData:{isSilent:i.silent,endpointUrl:t},eventData:["silent:"+(void 0===i.silent?-1:+!!i.silent)],startWithoutScenario:!0});return n.acquireToken(t,i).then((()=>(p(),{success:!0}))).catch((e=>(p(e),{success:!1})))}))},resolveThirdPartyOauthCode(e,{code:t,state:n},{getGoogleCalendarAuthenticationService:a,getGoogleContactsAuthenticationService:o}){return(0,i.mG)(this,void 0,void 0,(function*(){if(!function(e){return e.includes(p.W.Calendar)||e.includes(p.W.Contacts)}(n))return!1;return(n.includes(p.W.Calendar)?yield a():yield o()).setAuthCode(t||null,n||null),!0}))},switchAccount(e,{userContextId:t},{entityCommanding:n}){return(0,i.mG)(this,void 0,void 0,(function*(){const e={source:s.D.SwitchAccountFromMeMenu};return n.authentication.switchAccount({userContextId:t,correlation:e}),!0}))},initializeAccounts(e,t,{authenticationService:n,correlation:a}){var o;return(0,i.mG)(this,void 0,void 0,(function*(){const e={id:(null==a?void 0:a.id)||(0,d.pW)(),scenarioName:(null==a?void 0:a.scenarioName)||l.RG.AuthWebInitializeAccounts,source:(null==a?void 0:a.source)||"server-resolver"},[t]=(0,c.OU)({options:{correlation:e},subContext:"initializeAccounts",scenarioName:l.RG.AuthWebInitializeAccounts,source:"server-resolver"});t.addScenarioMark(l.ck.AuthWebInitializeAccountsResolverStart);const i=yield null===(o=n.initializeAccounts)||void 0===o?void 0:o.call(n,{correlation:a});return t.addScenarioMark(l.ck.AuthWebInitializeAccountsResolverStop),t.closeScenario(),i||!1}))}},Subscription:{authenticationUsersEvent:{subscribe(e,{filter:t},{authenticationService:n}){return(0,i.FC)(this,arguments,(function*(){var e,a;try{for(var o,r=(0,i.KL)(n.getUsersIterator(t));!(o=yield(0,i.qq)(r.next())).done;){const e=o.value;yield yield(0,i.qq)({authenticationUsersEvent:{authenticationUsers:v(e)}})}}catch(t){e={error:t}}finally{try{o&&!o.done&&(a=r.return)&&(yield(0,i.qq)(a.call(r)))}finally{if(e)throw e.error}}}))}},authenticationStateChanged:{subscribe(e,t,{authStateProvider:n}){return(0,i.FC)(this,arguments,(function*(){var e,t;const o=new a((e=>{const t=null==n?void 0:n.observe();t?null==t||t.subscribe((t=>{e.next(t)})):e.next(r.jq.Up)}));try{for(var s,l=(0,i.KL)((0,g.Z)(o));!(s=yield(0,i.qq)(l.next())).done;){const e=s.value;yield yield(0,i.qq)({authenticationStateChanged:{authenticationState:e}})}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=l.return)&&(yield(0,i.qq)(t.call(l)))}finally{if(e)throw e.error}}}))}}}};function v(e){return e.filter(Boolean).map(S)}function S(e){const t=e.homeAccountId,n=(0,m.K)(e),i=n.profile,{upn:a}=e.profile;return Object.assign(Object.assign({},n),{__typename:"AuthenticationUser",profile:Object.assign(Object.assign({},i),{__typename:"AuthenticationUserProfile",upn:a}),homeAccountId:t,isAuthenticated:!!n.isAuthenticated})}var f=n(54621)},96766:(e,t,n)=>{"use strict";n.d(t,{wf:()=>L,s_:()=>O});var i=n(13637),a=n(89925);const o=e=>e&&!!e.wamsStreamingUrl&&!!e.decryptionToken,r=(e,t,n)=>{var i,r,s,l;return{__typename:"Broadcast",id:e,type:t?a.BroadcastType.Overflow:a.BroadcastType.QuickStart,userRole:n.userRole||a.BroadcastParticipantRole.Attendee,correlationId:n.correlationId,title:n.subject,utcStart:n.utcStart||null,utcEnd:n.utcEnd||null,location:n.location||null,streamingDetails:d(e,n),qna:Object.assign(Object.assign({},n.qna),{isEnabled:(null===(i=n.qna)||void 0===i?void 0:i.isEnabled)||!1,attendeeUrl:(null===(r=n.qna)||void 0===r?void 0:r.attendeeUrl)||"",moderatorUrl:(null===(s=n.qna)||void 0===s?void 0:s.moderatorUrl)||"",iosAutodiscoverUrl:(null===(l=n.qna)||void 0===l?void 0:l.iosAutodiscoverUrl)||"",__typename:"BroadcastQnaMetadata"}),yammer:n.yammer&&{__typename:"BroadcastYammerMetadata",broadcastId:n.yammer.broadcastId,groupId:n.yammer.groupId,isEnabled:n.yammer.isEnabled,eventUrl:n.yammer.event}||null,meetingStatus:n.meetingStatus||(o(n.stream)||o(n.altStream)?a.MeetingStatus.Live:a.MeetingStatus.Created),supportUrl:n.supportUrl,sdn:u(n)||null,transcription:g(e,n),aesKey:Object.assign({__typename:"AESKey"},p(n)),aesKeyRefresh:n.aesKeyRefresh,error:n.error||null,signalR:Object.assign({__typename:"SignalRDetails"},h(n)),streamResource:v(n),broadcastRestartVersion:n.broadcastRestartVersion||0,odspVodShareUrl:n.odspVodShareUrl||null}},s=e=>({__typename:"BroadcastAttendeeStream",wamsStreamingUrl:null==e?void 0:e.wamsStreamingUrl,decryptionToken:null==e?void 0:e.decryptionToken}),l=e=>({__typename:"BroadcastStreamingInfo",wamsStreamingUrl:(null==e?void 0:e.wamsStreamingUrl)||null,decryptionToken:(null==e?void 0:e.decryptionToken)||null,setKeyAuthorizationCookieUri:null,keyAuthorizationToken:null,sdn:c(e)||null}),d=(e,t)=>({__typename:"BroadcastStreamingDetails",id:e,stream:l(t.stream),altStream:l(t.altStream)}),c=e=>e&&e.sdnName&&e.sdnPluginUrl&&{__typename:"SDNDetails",name:e.sdnName,playbackInfo:e.sdnPlaybackInfo||"",pluginUrl:e.sdnPluginUrl,sdkUrl:""}||void 0,u=e=>e.stream&&c(e.stream)||e.altStream&&c(e.altStream),m=e=>e/1e3,g=(e,t)=>{var n,i,a,o,r,s;return{__typename:"BroadcastTranscription",id:e,isEnabled:null===(n=t.transcription)||void 0===n?void 0:n.isEnabled,isSuppressed:null===(i=t.transcription)||void 0===i?void 0:i.isSuppressed,translationLanguages:null===(a=t.transcription)||void 0===a?void 0:a.translationLanguages,transcriptionLanguage:null===(o=t.transcription)||void 0===o?void 0:o.transcriptionLanguage,captionsOriginUrl:null===(r=t.transcription)||void 0===r?void 0:r.captionsOriginUrl,captionsCacheUrl:null===(s=t.transcription)||void 0===s?void 0:s.captionsCacheUrl}},p=e=>{var t,n,i,a;return{id:(null===(t=e.aesKey)||void 0===t?void 0:t.id)||"",iv:(null===(n=e.aesKey)||void 0===n?void 0:n.iv)||"",expiry:(null===(i=e.aesKey)||void 0===i?void 0:i.expiry)||"",key:(null===(a=e.aesKey)||void 0===a?void 0:a.key)||""}},h=e=>{var t,n,i,a,o;return{attendeeHubName:(null===(t=null==e?void 0:e.signalR)||void 0===t?void 0:t.attendeeHubName)||null,eventTeamHubName:(null===(n=null==e?void 0:e.signalR)||void 0===n?void 0:n.eventTeamHubName)||null,url:(null===(i=null==e?void 0:e.signalR)||void 0===i?void 0:i.url)||null,querystrings:(null===(a=null==e?void 0:e.signalR)||void 0===a?void 0:a.querystrings)||null,setCookieUrl:(null===(o=null==e?void 0:e.signalR)||void 0===o?void 0:o.setCookieUrl)||null}},v=e=>{var t;return{__typename:"StreamResource",attendeeEmbed:(null===(t=e.streamResource)||void 0===t?void 0:t.attendeeEmbed)||""}};const S={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"broadcast"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"roleHint"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"broadcast"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"roleHint"},value:{kind:"Variable",name:{kind:"Name",value:"roleHint"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"broadcastFragment"}}]}}]}},...n(58963)._.definitions]},f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showInMeetingReport"}}]}}]}}]};var y=n(62231),k=n(82250),C=n(85330);const b=e=>{const[t,n,i,o,r]=e.split("__");return{tenantId:t,organizerId:n,threadId:i,messageId:o,sessionId:r,roleHint:a.BroadcastParticipantRole.Attendee}},T=(e,t,n,a,o,s)=>(0,i.mG)(void 0,void 0,void 0,(function*(){try{const i=(0,C.G5)(t),l=e.readQuery({query:S,variables:{id:i}});if(l)return l.broadcast;{const l=yield n.getAttendeeMeeting(a),d=r(t,o,l);return w(e,s,i,d),d}}catch(e){throw s.error(e),e}})),w=(e,t,n,i)=>{const a={broadcast:i};try{e.writeQuery({query:S,variables:{id:n},data:a})}catch(e){t.error(e)}},_=(e,t,n,a,o,r,s,l,d,c,u)=>(0,i.mG)(void 0,void 0,void 0,(function*(){var i,m;if(I(e))return!1;const g=A(s,a,o,d,l,c),p=M(a,n);r.joinId=null===(m=null===(i=null==e?void 0:e.signalR)||void 0===i?void 0:i.querystrings)||void 0===m?void 0:m.joinid;const h=j(a,r,n,g,l,s,o,e.meetingStatus);try{const i=!o||u;return e.signalR&&e.signalR.url&&!e.error&&i?(yield t.subscribeToBroadcast(a,e.signalR,g,p,h),!0):!e.error&&(n.startPollingAttendeeMeeting(a,r,g,e.meetingStatus,!0),!0)}catch(t){return l.error(t),n.startPollingAttendeeMeeting(a,r,g,e.meetingStatus,!0),!0}})),I=e=>{var t;return e.meetingStatus===a.MeetingStatus.Stopped&&(null===(t=e.streamingDetails)||void 0===t?void 0:t.stream.wamsStreamingUrl)},A=(e,t,n,i,a,o)=>(s,l)=>{const c=N(o,t);let u="",m="";try{const o=(0,C.G5)(t),p=i.readQuery({query:S,variables:{id:o}}),h=null==p?void 0:p.broadcast;let v;if(h)if(v=Object.assign({},h),l===y.N.transcriptionStateUpdate)v.transcription=g(t,s),u="SignalR",m=y.N.transcriptionStateUpdate;else if(l===y.N.streamUpdateHubEvent){const e=d(t,s);if(E(e,h.streamingDetails))return void c.stop({broadcastData:"Duplicated update skipped"});v.streamingDetails=D(h,e),v.broadcastRestartVersion=s.broadcastRestartVersion,v.meetingStatus=F(h.broadcastRestartVersion,s.broadcastRestartVersion),u="SignalR",m=y.N.streamUpdateHubEvent}else v=Object.assign({},r(t,n,s)),u="Attendee Polling";else v=Object.assign({},r(t,n,s));const f=P(v);a.log(f),c.stop({broadcastData:JSON.stringify({updateSource:u,updateType:m,details:f})}),e.publish(`${y.V}-${t}`,{broadcastUpdatedEvent:v}),a.log(`New broadcast info successfully published for ${t}`),w(i,a,o,v)}catch(e){a.error(e),c.fail({broadcastData:`Error while processing broadcast update. updateSource: ${u}, updateType: ${m}`,broadcastError:e&&e.message})}},N=(e,t)=>{const n=e.newScenario(k.RG.BroadcastSubscriptionUpdate);return n.appendEventData({"Thread.Id":(0,C.G5)(t)}),n},E=(e,t)=>(null==e?void 0:e.stream.wamsStreamingUrl)===(null==t?void 0:t.stream.wamsStreamingUrl)&&(null==e?void 0:e.altStream.wamsStreamingUrl)===(null==t?void 0:t.altStream.wamsStreamingUrl),D=(e,t)=>{var n,i,a;return{__typename:"BroadcastStreamingDetails",stream:(null==t?void 0:t.stream)||(null===(n=e.streamingDetails)||void 0===n?void 0:n.stream),altStream:(null==t?void 0:t.altStream)||(null===(i=e.streamingDetails)||void 0===i?void 0:i.altStream),id:(null==t?void 0:t.id)||(null===(a=e.streamingDetails)||void 0===a?void 0:a.id)}},F=(e,t)=>(t=t||0)>(e=e||0)?a.MeetingStatus.Suspended:a.MeetingStatus.Created,P=e=>{var t,n,i,a,o,r,s,l;const d=e.broadcastRestartVersion,c=e.meetingStatus,u=null===(n=null===(t=e.streamingDetails)||void 0===t?void 0:t.stream)||void 0===n?void 0:n.wamsStreamingUrl,m=!!(null===(a=null===(i=e.streamingDetails)||void 0===i?void 0:i.stream)||void 0===a?void 0:a.decryptionToken),g=null===(r=null===(o=e.streamingDetails)||void 0===o?void 0:o.altStream)||void 0===r?void 0:r.wamsStreamingUrl,p=!!(null===(l=null===(s=e.streamingDetails)||void 0===s?void 0:s.altStream)||void 0===l?void 0:l.decryptionToken),h=e.transcription;return`broadcastRestartVersion: ${d}, meetingStatus: ${c}, stream: ${u}, isDecryptionTokenAvailable: ${m}, altStream: ${g}, isAltDecryptionTokenAvailable: ${p}, isTranscriptionEnabled: ${null==h?void 0:h.isEnabled}, isTranscriptionSuppressed: ${null==h?void 0:h.isSuppressed}`},M=(e,t)=>()=>{t.stopPollingAttendeeMeeting(e)},j=(e,t,n,i,a,o,r,s)=>l=>{if(!l){a.log("broadcast-subscripotion disconnect callback called not intentionally. Subscribing to attendee service polling.");try{n.startPollingAttendeeMeeting(e,t,i,s,!1)}catch(t){R(a,o,t.message,e,r)}}},R=(e,t,n,i,a)=>{e.error("Error while starting broadcast updates subscription");const o=r(i,a,{error:{errorMessage:n}});t.publish(`${y.V}-${i}`,{broadcastUpdatedEvent:o})};var x=n(31821);const O={Query:{broadcastAttendeeMeeting(e,{broadcastAttendeeMeetingParams:t},{cache:n,coreSettings:a,getBroadcastAttendeeService:o,loggerFactory:r}){return(0,i.mG)(this,void 0,void 0,(function*(){const e=a.get(x.J.MeetingArtifacts);let i=!0;const l=r.newLogger("broadcastAttendeeMeetingQuery"),{overflowAttendance:d}=e;if(t){if(d)try{i=((e,t)=>{var n;if("Disabled"===t)return!1;if("Enabled"===t)return!0;const i=!(!e||!e.userPreferences||"true"!==e.userPreferences.showInMeetingReport&&"false"!==e.userPreferences.showInMeetingReport);return"EnabledUserOverride"===t?!i||"false"!==(null===(n=null==e?void 0:e.userPreferences)||void 0===n?void 0:n.showInMeetingReport):"DisabledUserOverride"!==t||!!i&&"false"!==(null==e?void 0:e.userPreferences.showInMeetingReport)})(n.readQuery({query:f}),e.allowTrackingInReportPolicy)}catch(e){l.error("Failed to fetch allowTrackingInReportPolicy"),l.error(e)}return{__typename:"BroadcastAttendeeMeeting",id:(c=yield(yield o()).getAttendeeMeeting(Object.assign(Object.assign({},t),{allowTrackingInReport:i}))).correlationId,title:c.subject,stream:s(c.stream),altStream:s(c.altStream),qna:c.qna,yammer:c.yammer&&{__typename:"YammerMetadata",broadcastId:c.yammer.broadcastId,groupId:c.yammer.groupId,isEnabled:c.yammer.isEnabled,eventUrl:c.yammer.event},supportUrl:c.supportUrl}}return null;var c}))},broadcastCaptions(e,{id:t,broadcastId:n,culture:a,currentPlayerTime:o},{cache:r,getBroadcastCaptionsService:s,loggerFactory:l}){return(0,i.mG)(this,void 0,void 0,(function*(){const e=l.newLogger("broadcastCaptionsQuery");if(!t&&!n||!a)return e.error("Invalid params sent to broadcastCaptions Query"),Promise.reject("Invalid params sent to broadcastCaptions Query");e.log(`Fetching the captions for: ID: ${t}, Culture: ${a}, Time: ${o}`);const i=t||(0,C.G5)(n);try{const e=r.readQuery({query:S,variables:{id:i}});if(e&&e.broadcast.aesKey&&e.broadcast.transcription){const t={aesKey:e.broadcast.aesKey,aesKeyRefresh:e.broadcast.aesKeyRefresh,correlationId:e.broadcast.correlationId,transcription:e.broadcast.transcription},n=yield s();n.setCurrentCaptionLanguage(i,a);return(e=>{const t=[];for(const n of e){if(""===n.Text)continue;const e={__typename:"Captions",start:m(n.TimestampMs),text:n.Text,end:m(n.EndTimestampMs)};t.push(e)}return t})(yield n.getCaptions(o,i,t,a))}}catch(t){e.error("Failed to fetch captions"),e.error(t)}return Promise.resolve([])}))},broadcast(e,{id:t,roleHint:n},{getBroadcastAttendeeService:o,loggerFactory:s}){return(0,i.mG)(this,void 0,void 0,(function*(){const[e,i,l,d,c]=t.split("__");if(!(e&&i&&l&&d)){const e=`Invalid Id: ${t}`;throw s.newLogger("broadcast").error(e),new Error(e)}const u=!!c,m=u?a.BroadcastType.Overflow:a.BroadcastType.QuickStart,g=yield(yield o()).getAttendeeMeeting({tenantId:e,organizerId:i,threadId:l,messageId:d,sessionId:c,roleHint:n,broadcastType:m});return r(t,u,g)}))}},Mutation:{startLiveStreamCaptions(e,{id:t,liveStreamId:n,culture:a},{cache:o,getBroadcastCaptionsService:r,getLiveStreamRenderingService:s,loggerFactory:l}){return(0,i.mG)(this,void 0,void 0,(function*(){const e=l.newLogger("liveStreamCaptionsMutation");try{const i=o.readQuery({query:S,variables:{id:t}});if(!i)throw new Error("Could not find broadcast data");const l=yield s(),d=yield r(),c=()=>l.getDiagnosticData(n).then((t=>(e.log(`The times are: ${t.currentAbsoluteTime}, ${t.currentMediaTime}, ${t.currentPlayPosition}`),t.currentAbsoluteTime))),u=e=>{l.addCues(n,e)},m={aesKey:i.broadcast.aesKey,aesKeyRefresh:i.broadcast.aesKeyRefresh,correlationId:i.broadcast.correlationId,transcription:i.broadcast.transcription};d.startCaptionsForStream(n,t,m,a,c,u)}catch(t){e.error("Failed to fetch captions"),e.error(t)}return null}))},stopLiveStreamCaptions(e,{liveStreamId:t},{getBroadcastCaptionsService:n,getLiveStreamRenderingService:a,loggerFactory:o}){return(0,i.mG)(this,void 0,void 0,(function*(){const e=o.newLogger("liveStreamCaptionsMutation");e.log(`Stopping captions for stream ${t}`);try{const e=yield n(),i=yield a();return e.stopCaptionsForStream(t),i.clearCues(t),!0}catch(n){return e.error(`Error while stopping captions for stream ${t}`),e.error(n),!1}}))},toggleLiveStreamCaptionButton(e,{liveStreamId:t,shouldShowButton:n},{getLiveStreamRenderingService:a,loggerFactory:o}){return(0,i.mG)(this,void 0,void 0,(function*(){const e=o.newLogger("toggleLiveStreamCaptionButton");e.log(`Setting the caption button visibility in the player to ${n} for stream ${t}`);try{return(yield a()).showCaptions(t,n),!0}catch(i){return e.error(`Error while setting the caption button to ${n} for stream ${t}`),!1}}))},subscribeToBroadcastUpdates(e,{id:t},{loggerFactory:n,getBroadcastAttendeeService:a,getBroadcastSignalRService:o,pubsub:r,cache:s,coreSettings:l,scenarioFactory:d}){return(0,i.mG)(this,void 0,void 0,(function*(){const e=yield a(),c=yield o(),u=n.newLogger("broadcastSubscribe"),{enableSignalrForOverflow:m}=l.get(x.J.Broadcast);return yield((e,t,n,a,o,r,s,l)=>(0,i.mG)(void 0,void 0,void 0,(function*(){const i=b(e),d=!!i.sessionId;try{const c=yield T(o,e,t,i,d,r);return c?(a.publish(`${y.V}-${e}`,{broadcastUpdatedEvent:c}),yield _(c,n,t,e,d,i,a,r,o,s,l)):(R(r,a,"Error subscribing to broadcast updates",e,d),!1)}catch(t){return r.error(t),R(r,a,t.message,e,d),!1}})))(t,e,c,r,s,u,d,!!m)}))},unsubscribeFromBroadcastUpdates(e,{id:t},{getBroadcastAttendeeService:n,getBroadcastSignalRService:a,loggerFactory:o}){return(0,i.mG)(this,void 0,void 0,(function*(){const e=o.newLogger("broadcastUnsubscribe");e.log(`Stopping subscription for broadcast ${t}`);try{(yield n()).stopPollingAttendeeMeeting(t);return(yield a()).unsubscribeFromBroadcast(t),!0}catch(n){return e.error(`Error while unsubscribing from broadcast ${t}`),e.error(n),!1}}))}},Subscription:{broadcastQnaFeedStatusEvent:{subscribe:(e,{id:t},{pubsub:n})=>n.asyncIterator(t)},broadcastUpdatedEvent:{subscribe:(e,{broadcastId:t},{pubsub:n})=>(0,i.mG)(void 0,void 0,void 0,(function*(){return n.asyncIterator(`${y.V}-${t}`)}))}}},L=()=>({Mutation:{updateBroadcastQnaFeedStatus:(e,{id:t,isQnaFeedLoaded:n,hasNewMessages:i},{pubsub:a})=>(null==i&&null==n||a.publish(t,{broadcastQnaFeedStatusEvent:{isQnaFeedLoaded:!!n,hasNewMessages:!!i}}),{__typename:"BroadcastQnaFeedStatus",isQnaFeedLoaded:!!n,hasNewMessages:!!i})}})},9255:(e,t,n)=>{"use strict";n.d(t,{w:()=>s});var i=n(34255),a=n(66695);const o="calendarv2",r=e=>{const t=e.get(o);return t?(0,a.D)(t):{}},s={Query:{calendarSettingsFromLocalStorage:(e,t,{localStorage:n})=>(({shouldGetDateRangeType:e,shouldGetWorkHours:t,shouldGetWorkWeekDays:n},i)=>{const a=r(i);return{__typename:"ICalendarSettings",dateRangeType:e&&a.dateRangeType||null,workHours:t&&a.workHours?Object.assign({__typename:"IWorkHours"},a.workHours):null,workWeekDays:n&&a.workWeekDays||null}})(t,n)},Mutation:{saveCalendarSettingsInLocalStorage:(e,t,{localStorage:n})=>((e,t)=>{const n=r(t);return(0,i.forOwn)(e,((e,t)=>{null!=e&&(n[t]=e)})),t.setSafe(o,JSON.stringify(n)),!0})(t,n)}}},10348:(e,t,n)=>{"use strict";n.d(t,{wz:()=>m,FJ:()=>_,Z6:()=>T,gL:()=>E,I6:()=>C,Nz:()=>I,C9:()=>g,eM:()=>b,jF:()=>N,QV:()=>w,qz:()=>A,g:()=>W,_w:()=>F,Li:()=>D,Oh:()=>x,vV:()=>S,yw:()=>v,bF:()=>$,nh:()=>f,M3:()=>y,gv:()=>R,e7:()=>U,mB:()=>B,nP:()=>O,Jw:()=>V,kc:()=>H,bW:()=>P,s6:()=>j,tx:()=>L,tW:()=>p,bC:()=>h});var i=n(89925),a=n(31821),o=n(92779);n(34255);const r=e=>!e||e.joinType!==i.MeetingJoinType.MeetingData;var s=n(42550),l=n(19435),d=n(14045);const c={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"breakoutRoomParticipants"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BreakoutRoom"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"coordinates"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"threadId"}}]}},{kind:"Field",name:{kind:"Name",value:"participants"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"upn"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"role"}}]}}]}}]};var u=n(88130);const m="acceptStreamPermissionsDebug",g={__typename:"PrejoinState",incomingAudio:!0,isPSTN:!1,withAudio:!0,withVideo:!1,volume:10,wasMuteToggledByUser:!1,roomDetails:{__typename:"RoomDetails",room:null,roomParticipantInMeeting:null,wasRoomBluetoothProximityTriggered:!1,wasRoomLoudSpeakerInTheMeetingTriggered:!1},wasAutomuteTriggered:!1,isAuditoriumModeEnabled:!1,shouldShowCameraCoachMark:!1,shouldAutoExpandRoomsDropdown:!1};function p(e){e.writeQuery({query:d.vB,data:{prejoinState:g}})}function h(e){e.writeQuery({query:u._,data:{shouldShowVideoApp:!1}})}const v=e=>({__typename:"CallingScreenStatus",id:e,isDtmfKeypadVisible:!1,isPstnDialogVisible:!1,isBroadcastRestartWaitingOverlayVisible:!1,isChatBubblesSuppressed:!1,hasTogetherModeBeenPinned:!1,isShareTrayVisible:!1,hasOnMeetingLandingElementBeenShown:!1,isAudienceBackgroundDialogVisible:!1,isTogetherModeSeatSelectionDialogVisible:!1,isAnnouncementDialogVisible:!1,isUnlockMeetingDialogVisible:!1,isInterpretationDialogVisible:!1}),S=e=>({__typename:"CallingScreenLayout",currentLayout:e.get(a.J.Calling).defaultLayoutSelection||i.CustomLayoutSelection.Grid,meetingRoomLayoutSelection:i.MeetingRoomLayoutSelection.ContentAndPeople,lastSelectedLayout:i.CustomLayoutSelection.Grid,initialLayoutBeforeContentPopout:i.CustomLayoutSelection.Grid,meetingRoomLayoutPreferences:[],isFocusModeEnabled:!1,isNarrowModeActive:!1,isNarrowModeActiveByResize:!1,isNarrowModeActiveInSpatialAudio:!1,isHostViewModeNoContentActive:!1,isHostViewModeWithContentActive:!1,isLayoutFlipped:!1,isPresenterHostMode:!1,isContentPoppedOut:!1,isPresenterHostModeWithContent:!1,isBarSegmentOnStage:!1}),f=e=>({__typename:"PinnedParticipantIds",participantIds:[],id:e}),y=e=>({__typename:"VideoScanTypeResponse",videoScanType:i.VideoScanType.none,id:e}),k="microsoft_none",C={__typename:"BackgroundsInfo",imageId:k,imagePath:""},b={__typename:"SelectedAvatarInfo",id:"SelectedAvatarInfoWithAppId:null",appId:null,filterId:null,isFilterApplyUnderLoadingProcess:null,imageId:k},T={__typename:"AvatarAppAvailabilityInfo",available:!1,dataFetched:!1},w={__typename:"VideoEffectInfo",appId:"",appName:"",filterId:""},_={__typename:"ActiveVideoEffects",first:w,second:w,third:w},I={__typename:"InstallingVideoEffectInfo",appId:"",appName:"",developerName:"",effectCount:0,filterId:""},A={__typename:"VideoEffectsCurrentInfo",isInstallingVideoEffectInfo:I,isShowingAppPageVideoEffect:w,isAppliedVideoEffect:w,isUnderApplyingProcessVideoEffect:w,allVideoApps:[]},N={__typename:"VideoAppInfo",appId:"",appName:"",developerName:"",effectCount:1,isInstalled:!0},E={__typename:"AvatarPayload",avatarItems:[]},D=(e,t)=>{var n;return(null===(n=t.readQuery({query:s.Q,variables:{id:e}}))||void 0===n?void 0:n.callParticipants)||[]},F=(e,t)=>t.readFragment({id:M(e),fragment:o.u_,fragmentName:"participantFields"})||null,P=(e,t,n)=>{const i=F(e,n);i&&n.writeFragment({id:M(e),fragment:o.u_,data:Object.assign(Object.assign({},i),t),fragmentName:"participantFields"})},M=e=>`Participant:{"participantId":"${e}"}`,j=(e,t)=>{e.writeQuery({query:l.j,data:{callingAlerts:t}})},R=e=>`No call found with id ${e}`,x=(e,t)=>{var n;const a=e.coordinates;return{conversationId:r(a)&&a.conversationId||null,isOneOnOne:e.type===i.CallingIntentType.OneToOneCall,isMeetup:e.type===i.CallingIntentType.Meeting,isBroadcast:r(a)&&"LegacyMeetingCoordinates"===a.__typename&&!!a.broadcast,broadcastRole:r(a)&&"LegacyMeetingCoordinates"===a.__typename?r(a)&&(null===(n=a.broadcast)||void 0===n?void 0:n.role):null,withVideo:t&&t.outgoingVideo,withAudio:t&&t.outgoingAudio}},O=(e,t)=>{if(e)try{return t.readFragment({id:`BreakoutRoom:${e}`,fragment:c})}catch(t){throw new Error(`room ${e} doesn't exist`)}return null},L=({roomFragment:e,cache:t,updateParticipants:n})=>{const i=Object.assign(Object.assign({},e),{participants:n(e.participants||[])});try{t.writeFragment({id:`BreakoutRoom:${e.coordinates.threadId}`,fragment:c,data:i})}catch(e){throw new Error("Error updating room participants in cache")}return i},U=e=>({__typename:"BreakoutRoomParticipant",mri:e,role:null,objectId:null,upn:null}),B=e=>({tenantId:"tenantId",organizerId:null!=e?e:"6763e6ac-1bfd-48ec-8352-a3e3a066c81c",threadId:"threadId",messageId:"messageId",additionalMessageId:"additionalMessage"}),W=()=>{const e=B();return{__typename:"BreakoutRoom",coordinates:Object.assign(Object.assign({__typename:"RoomCoordinates"},e),{additionalMessageId:"additionalMessage"}),roomName:"Room 1",sourceMeetingCoordinates:Object.assign(Object.assign({__typename:"RoomCoordinates"},e),{additionalMessageId:"additionalMessage"}),participants:[U("6763e6ac-1bfd-48ec-8352-a3e3a066c81c")],restrictChatAccess:!0,isOpened:!1,meetingJoinUrl:"https://teams.microsoft.com",clientActionState:null}},G=(e,t)=>e?Object.assign(Object.assign({},e),{__typename:"VideoEffectInfo"}):t,V=e=>({__typename:"ActiveVideoEffects",first:G(e.activeVideoEffects.first,w),second:G(e.activeVideoEffects.second,w),third:G(e.activeVideoEffects.third,w)}),H=(e,t)=>({__typename:"VideoEffectsCurrentInfo",allVideoApps:t&&t.allVideoApps&&t.allVideoApps.length>0&&t.allVideoApps.map((e=>Object.assign(Object.assign({},e),{__typename:"VideoAppInfo"})))||e.allVideoApps,isInstallingVideoEffectInfo:t.isInstallingVideoEffectInfo?Object.assign(Object.assign({},t.isInstallingVideoEffectInfo),{__typename:"InstallingVideoEffectInfo"}):e.isInstallingVideoEffectInfo,isShowingAppPageVideoEffect:G(t.isShowingAppPageVideoEffect,e.isShowingAppPageVideoEffect),isAppliedVideoEffect:G(t.isAppliedVideoEffect,e.isAppliedVideoEffect),isUnderApplyingProcessVideoEffect:G(t.isUnderApplyingProcessVideoEffect,e.isUnderApplyingProcessVideoEffect)}),$=()=>i.CurrentCallingState.None},42550:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"callParticipants"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callParticipants"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"participantFields"}}]}}]}},...n(92779).u_.definitions]}},19435:(e,t,n)=>{"use strict";n.d(t,{j:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"callingAlerts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingAlerts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingAlert"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAlert"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAlert"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamsCallId"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}},{kind:"Field",name:{kind:"Name",value:"alertType"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"ariaText"}},{kind:"Field",name:{kind:"Name",value:"severity"}},{kind:"Field",name:{kind:"Name",value:"actions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"action"}}]}},{kind:"Field",name:{kind:"Name",value:"dismissable"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"action"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AlertAction"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"isSecondary"}},{kind:"Field",name:{kind:"Name",value:"actionId"}}]}}]}.definitions]}},98076:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserCallingShouldAvatarMenuItemSelectedQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldAvatarMenuItemSelected"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},75981:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserCallingShouldKeepPreviewWindowInSidePanelOpenQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldKeepPreviewWindowInSidePanelOpen"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},14045:(e,t,n)=>{"use strict";n.d(t,{vB:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"prejoinState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"prejoinState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntentId"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntentId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"incomingAudio"}},{kind:"Field",name:{kind:"Name",value:"isPSTN"}},{kind:"Field",name:{kind:"Name",value:"withAudio"}},{kind:"Field",name:{kind:"Name",value:"withVideo"}},{kind:"Field",name:{kind:"Name",value:"volume"}},{kind:"Field",name:{kind:"Name",value:"wasAutomuteTriggered"}},{kind:"Field",name:{kind:"Name",value:"wasMuteToggledByUser"}},{kind:"Field",name:{kind:"Name",value:"roomDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"roomDetails"}}]}},{kind:"Field",name:{kind:"Name",value:"isAuditoriumModeEnabled"}},{kind:"Field",name:{kind:"Name",value:"shouldShowCameraCoachMark"}},{kind:"Field",name:{kind:"Name",value:"shouldAutoExpandRoomsDropdown"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"roomDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RoomDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"room"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"roomData"}}]}},{kind:"Field",name:{kind:"Name",value:"roomParticipantInMeeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"roomData"}}]}},{kind:"Field",name:{kind:"Name",value:"wasRoomBluetoothProximityTriggered"}},{kind:"Field",name:{kind:"Name",value:"wasRoomLoudSpeakerInTheMeetingTriggered"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"roomData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ClientRoom"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"proximityValidationCode"}}]}}]}.definitions]}},88130:(e,t,n)=>{"use strict";n.d(t,{_:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"shouldShowVideoApp"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldShowVideoApp"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},9869:(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"shouldShowVideoEffectsPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldShowVideoEffectsPreview"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},94494:(e,t,n)=>{"use strict";n.d(t,{s:()=>U});var i=n(13637);const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"newChatIntentId"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"newChatIntentId"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}]}]}}]},o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"controllerConnectedServicesEnabled"}},{kind:"Field",name:{kind:"Name",value:"readReceiptsEnabled"}}]}}]}}]};var r=n(31821),s=n(82250),l=n(72080),d=n(75068),c=n(38923),u=n(57792);const m=(e,t,n)=>(0,i.mG)(void 0,void 0,void 0,(function*(){const i=n.filter((e=>!e.shareUrl)).map((e=>e.id));if(0===i.length)return n;const a=yield e.shareDriveItems(i),o=new Map;a.forEach(((e,t)=>o.set(i[t],e)));const r=[];for(const e of n){const n=o.get(e.id);if(n){if(!n.link){const n=`ShareUrl (link.webUrl) is not present in createLink response for fileId: ${e.id}`,i={[u.z.internalErrorCode]:"ShareUrlIsMissingFromResponse",[u.z.logErrorMessage]:n};throw t.newLogger("ChatResolversUtilsFiles").error(`${n}. ${JSON.stringify(i)}`),(0,c.Tr)(d.w5.AddShareUrlOnSendMessage,d.jK.Undefined,"",i,n)}r.push(Object.assign(Object.assign({},e),{shareUrl:n.link.webUrl,shareId:n.shareId}))}else r.push(e)}return r})),g=e=>{var t;return!!(null===(t=null==e?void 0:e.files)||void 0===t?void 0:t.length)},p=(e,t,n)=>{const i=e.newLogger("ChatResolversUtilsFiles"),{reason:a}=n;if(a){const e={errorCode:a[u.z.internalErrorCode]||n.code||"ErrorCodeMissing",correlationId:a[u.z.correlationId],statusCode:a[u.z.httpCode],message:a[u.z.logErrorMessage]||"Log message is not present in reason bag",errors:a[u.z.logErrorMessage]};throw t.fail(e),i.error(`Failed to generate ShareUrl for files. ${JSON.stringify(e)}`),n}const o={errorCode:n.code||d.jK.Unknown,message:"thrown error is not an instance of IError. So not much data available",errors:`${n.context}_${n.subContext}`};throw t.fail(o),i.error(`Failed to generate ShareUrl for files and as well error is not instance of IError ${JSON.stringify(o)}`),n},h=(e,t,n)=>(0,i.mG)(void 0,void 0,void 0,(function*(){try{return yield e()}catch(e){const i="Failed to lazy load drive item share service",a={[u.z.internalErrorCode]:e.code||"FailedToLazyLoadDriveItemShareService",[u.z.logErrorMessage]:i,innerError:e},o={errorCode:a[u.z.internalErrorCode],message:a[u.z.logErrorMessage]};n.fail(o);throw t.newLogger("ChatResolversUtilsFiles").error(`Failed to get DriveItemShareService. error: ${JSON.stringify(o)}`),(0,c.Tr)(d.w5.AddShareUrlOnSendMessage,d.jK.FailedToLazyLoadService,"",a,i)}}));var v=n(18065),S=n(34255),f=n(82372),y=n(85762),k=n(15496),C=n(96843),b=n(78808),T=n(85350),w=n(37464),_=n(16484);const I={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"optionalTelemetry"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"optionalTelemetry"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidCorrelationId"}},{kind:"Field",name:{kind:"Name",value:"fluidDataLossOccurred"}},{kind:"Field",name:{kind:"Name",value:"fluidDataLossPrevented"}}]}}]}}]};var A=n(89925);const N=e=>{switch(e){case"Standard":return"NORMAL";case"Important":return"HIGH";case"Urgent":return"URGENT"}return null},E=e=>{var t;const n=null===(t=e.computed)||void 0===t?void 0:t.cards;if(!n)return!1;return!!(0,S.find)(n,(e=>"application/vnd.microsoft.card.fluid"===e.contentType))},D=e=>{var t;const n=null===(t=e.computed)||void 0===t?void 0:t.cards;if(n){const e=[];return n.forEach((t=>{e.push(t.appId)})),null==e?void 0:e.join(",")}return""},F=e=>{const t=new RegExp(w.T.reply,"g");return(e.match(t)||[]).length},P=(e,t)=>e.split(" ").filter((e=>e===`itemtype="${t}"`)).length,M=(e,t,n,i,a,o)=>{var r,s,l,d,c,u,m,g,p,h,v;return{"DataBag.messagelength":(v=e.content,v?v.replace(/(<([^>]+)>)/gi,""):"").length,"DataBag.size":e.content.length,"DataBag.importantflag":N(e.importance),"DataBag.messageType":a?o?"replyConversation":"newConversation":"Update"===t?"chatEdit":"newP2PMessage","DataBag.postType":"Announcement"===e.postType?"announcement":"normal","DataBag.richText":(h=e.messageType,"RichText/Html"===h),"DataBag.fluidCard":E(e),"DataBag.appId":D(e),"DataBag.sfbInteropMessage":(null==n?void 0:n.chatType)===A.ChatType.SfBInteropChat,"DataBag.mricollection":(null===(s=null===(r=null==n?void 0:n.memberIds)||void 0===r?void 0:r.map((e=>(0,C.Q2)(e))))||void 0===s?void 0:s.join(" "))||"","DataBag.rostersize":(null===(l=null==n?void 0:n.memberIds)||void 0===l?void 0:l.length)||0,"DataBag.attachments":(null===(d=e.files)||void 0===d?void 0:d.length)||0,"DataBag.attachmentIds":(null===(u=null===(c=e.files)||void 0===c?void 0:c.map((e=>e.id)))||void 0===u?void 0:u.join(" "))||"","DataBag.fileTypeList":(null===(g=null===(m=e.files)||void 0===m?void 0:m.map((e=>e.type)))||void 0===g?void 0:g.filter((e=>!(0,S.isNil)(e))))||[],"DataBag.suggestedFile":null===(p=e.files)||void 0===p?void 0:p.some((e=>"smartReply"===e.context)),"DataBag.leftRailDirective":a?"channel-list":"chat-list","DataBag.messageID":e.id,"DataBag.isNewChat":!!i,"DataBag.newChatIntentId":i,"DataBag.tflOffNetworkEmailCount":(null==n?void 0:n.memberIds)?n.memberIds.filter((e=>e.startsWith(b.b6))).length:0,"DataBag.tflOffNetworkOneWayPhoneCount":(null==n?void 0:n.memberIds)?n.memberIds.filter((e=>e.startsWith(b.EI))).length:0,"DataBag.tflSMSMembersCount":(null==n?void 0:n.memberIds)?n.memberIds.filter(C.yj).length:0,"DataBag.offNetworkContactsSelected":(null==n?void 0:n.memberIds)?n.memberIds.filter(C.$i).length:0,"DataBag.hasAADFederatedMembers":(null==n?void 0:n.hasFederatedUser)||!1,"DataBag.hasMSAFederatedMembers":(null==n?void 0:n.hasTflConsumerUser)||!1,"DataBag.quotedReplyCount":F(e.content),"DataBag.groupTemplateType":null==n?void 0:n.groupTemplate,"DataBag.chatType":j(n),"DataBag.GIF":P(e.content,w.T.giphy),"DataBag.Sticker":P(e.content,w.T.sticker)}},j=e=>(null==e?void 0:e.guardianChatInfo)?f.Ml.GuardianChat:null,R=(e,t,n,i,a,o,r,s,d,c,u,m)=>{var g;const p=((e,t)=>{var n,i;if(!e||e.chatSubType===T.k2.Channel)return t?y.Th.Channel:void 0;const a=(null===(n=e.id)||void 0===n?void 0:n.includes(":nativefed:preview"))||!e.isFederated&&e.isOneOnOne&&e.hasFederatedUser&&!(null===(i=e.memberIds)||void 0===i?void 0:i.some((e=>(0,C.Nl)(e))));return(0,l.NL)(e.id,e.chatType,e.isMeeting,e.isOneOnOne,e.isOneOnOneBotChat,a,e.isFederated)})(r,c);let h={};p===y.Th.Botchat&&(h=((e,t)=>{var n,i,a;const o=null===(n=null==e?void 0:e.memberIds)||void 0===n?void 0:n.find(C.bl);if(o){const e=o.substring(b.at.BotPrefix.length);try{const n=t.readQuery({query:_.C,variables:{installedContext:{scope:A.AppInstallScope.Personal}}});if(n){const t=null===(i=n.installedAppsV2)||void 0===i?void 0:i.filter((t=>{var n,i,a;return(null===(a=null===(i=null===(n=null==t?void 0:t.definition)||void 0===n?void 0:n.bots)||void 0===i?void 0:i[0])||void 0===a?void 0:a.id)===e}));if(t&&t.length>0)return{id:null===(a=t[0])||void 0===a?void 0:a.id,capabilityId:e,scenarioCapability:k.Ky.bots}}}catch(e){}}return{}})(r,d));const v=c?y.wh.Channel:y.wh.Chat,S=c?"channel":"chat";a.recordPanelAction({actionGesture:y.uS.click,actionOutcome:y.$K.submit,actionOutcomeNew:y.$K.submit,actionScenarioType:y.Yu.composeMsg,actionScenario:y.Tk.composeSendMessage,moduleName:y.rA.sendButton,moduleNameNew:y.rA.sendButton,moduleType:y.PO.sendMessageButton,moduleTypeNew:y.PO.sendMessageButton,panelRegion:y.Ai.main,panelType:v,panelRegionNew:y.Ai.main,panelTypeNew:v,threadId:e,teamId:m,threadMembers:null===(g=null==r?void 0:r.memberIds)||void 0===g?void 0:g.length,threadType:p,actionWorkload:c?y.sz.channelContent:y.sz.chatContent,actionSubworkload:y.eD.composeMsg,tabId:"",tabType:"conversations",tabIdNew:"",tabTypeNew:"conversations",tabOrdinal:1,appName:S,dataBag:{id:"",data:Object.assign(Object.assign(Object.assign({},i),M(t,n,r,s,c,u)),x(d)),dispose:()=>{}},extensibilityData:h},o)};function x(e){var t,n,i;const a={};let o=null;try{o=e.readQuery({query:I})}catch(e){}const r=null==o?void 0:o.optionalTelemetry;return void 0!==(null==r?void 0:r.fluidDataLossOccurred)&&null!==(null==r?void 0:r.fluidDataLossOccurred)&&(a["DataBag.fluidDataLossOccurred"]=null===(t=null==o?void 0:o.optionalTelemetry)||void 0===t?void 0:t.fluidDataLossOccurred),void 0!==(null==r?void 0:r.fluidDataLossPrevented)&&null!==(null==r?void 0:r.fluidDataLossPrevented)&&(a["DataBag.fluidDataLossPrevented"]=null===(n=null==o?void 0:o.optionalTelemetry)||void 0===n?void 0:n.fluidDataLossPrevented),void 0!==(null==r?void 0:r.fluidCorrelationId)&&null!==(null==r?void 0:r.fluidCorrelationId)&&(a["Messaging.fluidCorrelationId"]=null===(i=null==o?void 0:o.optionalTelemetry)||void 0===i?void 0:i.fluidCorrelationId),a}var O=n(26863),L=n(95067);const U={Mutation:{sendMessageWorker(e,t){return(0,i.mG)(this,void 0,void 0,(function*(){return B(e,t)}))},sendMessage(e,t){return(0,i.mG)(this,void 0,void 0,(function*(){return B(e,t)}))}}},B=(e,t)=>(0,i.mG)(void 0,void 0,void 0,(function*(){const{convId:n,action:a,originalConvId:o,withChatNetworkFallback:l,searchSessionId:d,sendFromChannel_ToBeRefactored:c}=e;let u=e.message;const{cache:S,coreSettings:f,loggerFactory:y,offlineCacheManager:k,getDriveItemShareService:T,scenarioFactory:w,channelView:_,teamId:I}=t,{enableInstalledAppsV2:N,enableBotsFileSharing:E,enableAppsQueryOptimization:D,botFileInfoFetchTimeout:F}=f.get(r.J.Extensibility),{enableFilesShareLinksInvite:P,enableSharingByCreateLinkAPI:M,enableFilesShareLinksFetchFederatedUsersAPI:j,enableFilesShareLinksFetchTflConsumerUsersAPI:x}=f.get(r.J.Files),{msgEnableChannelsV2:U}=f.get(r.J.Host),{enableScheduleMessage:B}=f.get(r.J.Messaging),H={"DataBag.searchSessionId":d,"DataBag.isChannelsV2":!!U,"DataBag.channelView":_},$=y.newLogger("chatMutationForwardResolvers"),z=((e,t,n,i,a,o)=>{const r=a;switch(null==t?void 0:t.postType){case A.PostType.Guardians:return s.RG.GuardiansSendAnnouncement}const l=(null==i?void 0:i.length)===b.Uy,d=null==i?void 0:i.some((e=>(0,C.Nl)(e))),c=null==i?void 0:i.some((e=>(0,C.ug)(e))),u=n||"",m=!r&&l&&d&&!(0,O.Bl)(u),g=r&&l&&c;switch(e){case A.SendMessageAction.Create:return(0,L.Jn)(u)?s.RG.P2PSendNewMessageSfB:(0,O.Bl)(u)?s.RG.P2PSendNewMessageSfC:(0,O.As)(u)?s.RG.P2PSendNewMessageFederated:o?s.RG.P2PSendNewMessageNativeFederated:m?s.RG.P2PSendNewMessageTfl:g?s.RG.P2PSendNewMessageTfw:s.RG.ChatSendMessage;case A.SendMessageAction.Update:return s.RG.EditMessage}return s.RG.ChatSendMessage})(a,u),q=w.findScenario(z),J=yield(0,v.mb)(n,S,t,$,y,l,null,null,void 0,o||"");null==q||q.mark(s.ck.ChatSendMessageGotChat);const Q=G(o,S,$),K=yield W(t);null==q||q.mark(s.ck.ChatSendMessageServicesLazyLoadComplete);const Y=(0,v.Fb)(S,n,N,D),X=(0,v.QD)(S),Z=V(t,$);(P||B)&&J&&(0,v.iX)(J)&&(u=yield(0,v.Ju)(u,J,t,j,x));let ee=yield(0,v.JB)(t,u,a,n,Z,Object.assign(Object.assign({},K),{offlineCacheManager:k,telemetryDatabag:H,convId:n,getInstalledMessageExtensionApps:Y,getAppDefinitions:X}),q,!!c);return M&&u&&(ee=yield((e,t,n,a)=>(0,i.mG)(void 0,void 0,void 0,(function*(){if(g(a)){const i=t.newScenario(s.RG.FilesCreateShareLink),o=yield h(e,n,i);try{const e=yield m(o,n,a.files);return i.stop(),Object.assign(Object.assign({},a),{files:e})}catch(e){p(n,i,e)}}return Object.assign({},a)})))(T,w,y,ee)),ee=yield(0,v.R_)(K.botsPlatformService,ee,E,y,J,F),ee=(0,v.wX)(ee,J),((e,t,n,i,{loggerFactory:a,userBiService:o,cache:r},s,l,d,c,u)=>{const m=a.newLogger("sendMessageTelemetry");o?R(e,t,n,i,o,m,s,l,r,d,c,u):m.warn("userBiService is null")})(n,ee,a,H,t,J,Q,c,null==u?void 0:u.replyChainId,I),Object.assign(Object.assign({},e),{message:ee})})),W=e=>(0,i.mG)(void 0,void 0,void 0,(function*(){const{getAppBasedLinkService:t,getAsyncMediaService:n,getUrlPreviewService:i,getImageProxyService:a,getFilesReferenceService:o,getBotsPlatformService:r}=e,[s,l,d,c,u,m]=yield Promise.all([n(),a(),i(),o(),t(),r()]);return{asyncMediaService:s,imageProxyService:l,urlPreviewService:d,fileReferenceService:c,appBasedLinkService:u,botsPlatformService:m}})),G=(e,t,n)=>{var i;let o=null;if((0,l.UL)(e))try{const n=t.readQuery({query:a,variables:{convId:e}});o=null!==(i=null==n?void 0:n.newChatIntentId)&&void 0!==i?i:null}catch(e){n.error("Failed to find newChatIntentId in cache")}return o},V=(e,t)=>{var n;let i=!0;const{cache:a,coreSettings:s}=e,{enableConnectedExperiences:l}=s.get(r.J.Messaging);if(!l)return i;try{const e=a.readQuery({query:o});i="false"!==(null===(n=null==e?void 0:e.userPreferences)||void 0===n?void 0:n.controllerConnectedServicesEnabled)}catch(e){t.error("Failed to find userPreferences in cache")}return i}},18065:(e,t,n)=>{"use strict";n.d(t,{QD:()=>H,R_:()=>G,mb:()=>K,Fb:()=>$,Ju:()=>J,iX:()=>Y,PJ:()=>W,JB:()=>B,wX:()=>X});var i=n(13637),a=n(34255),o=n(40950),r=n(16792),s=n(30958),l=n(21164),d=n(75206),c=n(99451),u=n(21305),m=n(27240),g=n(43724);const p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"chat"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"shortTitle"}},{kind:"Field",name:{kind:"Name",value:"groupTemplate"}},{kind:"Field",name:{kind:"Name",value:"themeId"}},{kind:"Field",name:{kind:"Name",value:"picture"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOneBotChat"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}},{kind:"Field",name:{kind:"Name",value:"disabledReason"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}},{kind:"Field",name:{kind:"Name",value:"newlyCreatedUserId"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingChatPolicy"}},{kind:"Field",name:{kind:"Name",value:"chatSubType"}},{kind:"Field",name:{kind:"Name",value:"chatType"}},{kind:"Field",name:{kind:"Name",value:"isSfB"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMeeting"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMuted"}},{kind:"Field",name:{kind:"Name",value:"isFederated"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isRetentionHorizonSet"}},{kind:"Field",name:{kind:"Name",value:"isModerator"}},{kind:"Field",name:{kind:"Name",value:"isAdmin"}},{kind:"Field",name:{kind:"Name",value:"isUserAnonymous"}},{kind:"Field",name:{kind:"Name",value:"substrateGroupId"}},{kind:"Field",name:{kind:"Name",value:"lastMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"lastMessageFields"}}]}},{kind:"Field",name:{kind:"Name",value:"lastMessageSender"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataTypesCommonUserI18NFieldsFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"me"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizonBookmark"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"userConsumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"memberIds"}},{kind:"Field",name:{kind:"Name",value:"membersLimited"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"memberDisplayNamesLimited"}},{kind:"Field",name:{kind:"Name",value:"hasFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"cfet"}},{kind:"Field",name:{kind:"Name",value:"hasEnterpriseUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnknownConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnknownEnterpriseUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnresolvedFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsUnverifiedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsVerifiedUser"}},{kind:"Field",name:{kind:"Name",value:"nonTeamsFederatedUserLimitedNames"}},{kind:"Field",name:{kind:"Name",value:"nonTeamsFederatedUsersLength"}},{kind:"Field",name:{kind:"Name",value:"isPrivateChatPolicyDefinedScenario"}},{kind:"Field",name:{kind:"Name",value:"isChatDisabledForRecipients"}},{kind:"Field",name:{kind:"Name",value:"guardianChatInfo"}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUserLength"}},{kind:"Field",name:{kind:"Name",value:"hasBotMember"}},{kind:"Field",name:{kind:"Name",value:"isUserMember"}},{kind:"Field",name:{kind:"Name",value:"botMembers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"userAdminSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"adminDeleteEnabled"}},{kind:"Field",name:{kind:"Name",value:"deleteMessagesEnabled"}}]}},{kind:"Field",name:{kind:"Name",value:"creator"}},{kind:"Field",name:{kind:"Name",value:"meetingInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingInformationFields"}}]}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"chatDisabledContext"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUIDisabled"}},{kind:"Field",name:{kind:"Name",value:"disabledReason"}},{kind:"Field",name:{kind:"Name",value:"extendedData"}},{kind:"Field",name:{kind:"Name",value:"lastUpdatedTime"}}]}},{kind:"Field",name:{kind:"Name",value:"interopConversationStatus"}},{kind:"Field",name:{kind:"Name",value:"chatScheduleSuggestionSuppressUntil"}},{kind:"Field",name:{kind:"Name",value:"chatHistoryHiddenTime"}},{kind:"Field",name:{kind:"Name",value:"clearHistoryTime"}},{kind:"Field",name:{kind:"Name",value:"typingUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"typingUserFields"}}]}},{kind:"Field",name:{kind:"Name",value:"userProperties"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userProperties"}}]}},{kind:"Field",name:{kind:"Name",value:"pinnedConversationItems"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"pinnedMessageItemFields"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"addedBy"}},{kind:"Field",name:{kind:"Name",value:"addedByTenantId"}},{kind:"Field",name:{kind:"Name",value:"identityMaskEnabled"}}]}}]}},...o.T.definitions,...r.V.definitions,...s.f.definitions,...l.T.definitions,...d.v.definitions,...c.q.definitions,...u.l.definitions,...m.I.definitions,...g.E.definitions]};var h=n(82250),v=n(72080),S=n(39302),f=n(16491);let y=class{transform(e,t){var n,i,o,r,s,l;if(e.parent&&1===e.parent.children.length&&"div"===(null===(n=e.parent.name)||void 0===n?void 0:n.toLowerCase())&&"root"===(null===(i=e.parent.parent)||void 0===i?void 0:i.type)){if((!e.children||0===e.children.length)&&"text"===e.type)return t.isPureText=!0,void(t.textContent=(0,a.unescape)(e.data));if("tag"===e.type&&"p"===(null===(o=e.name)||void 0===o?void 0:o.toLowerCase())&&1===(null===(r=e.children)||void 0===r?void 0:r.length)&&"text"===e.children[0].type)return t.isPureText=!0,void(t.textContent=(0,a.unescape)(null===(s=e.children)||void 0===s?void 0:s[0].data));if("tag"===e.type&&"p"===(null===(l=e.name)||void 0===l?void 0:l.toLowerCase()))return e.name="div",e}}};y=(0,i.gn)([(0,f.wx)({name:"BotMessageContentSerializer",filter:"*"})],y);var k=n(17809),C=n(96843),b=n(26863),T=n(78808);class w{constructor(){}static getInstance(){return this.platformAppConversationService||(this.platformAppConversationService=new w),this.platformAppConversationService}setSubEntityDeepLinkInfo(e){this.deepLink=e}getSubEntityDeepLinkInfo(){return this.deepLink}setClientMessageId(e){this.clientMessageId=e}getClientMessageId(){return this.clientMessageId}}var _=n(31821);var I=n(25118),A=n(3215);const N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserChatAppDefinitionsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinitions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}}]}},...n(37212).E.definitions]};var E=n(16484),D=n(57842);const F={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...D.W.definitions]},P={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedApps"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedApps"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScopes"},value:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...D.W.definitions]};var M=n(23569),j=n(37464),R=n(36223);const x={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};let O=class{transform(e,t){if(e&&e.attribs&&M.zj.cacheKey in e.attribs&&e.attribs[M.zj.cacheKey]===t.cacheKey)return t.instancesReplaced++,void 0!==t.value?e.attribs[t.prop]=t.value:t.prop in e.attribs&&void 0===t.value&&delete e.attribs[t.prop],e}};O=(0,i.gn)([(0,f.wx)({name:"InlineVideoUpdater",filter:[{itemtype:j.T.amsVideo}]})],O);var L=n(89925);const U=(e,t,n,a,o,r,s,l)=>(0,i.mG)(void 0,void 0,void 0,(function*(){const{cache:i,coreSettings:d,loggerFactory:c,scenarioFactory:u,authenticationUser:m}=e,g=c.newLogger("chat-resolver-utils"),p=(0,f.te)(k.bl,t,Object.assign(Object.assign({},n),{coreSettings:d,loggerFactory:c,scenarioFactory:u,authenticationUser:m}));try{yield(0,A.yG)(i,e,a,o,r,p,n.messageProperties,l),null==s||s.mark(h.ck.ChatSendMessageOptimisticResponsePosted)}catch(e){g.error(`client lie generation failed for conversation: ${a} clientMessageId: ${o.clientMessageId} error: ${e}`)}return(0,f.zL)(k.Vf,p,Object.assign(Object.assign({},n),{coreSettings:d,loggerFactory:c,scenarioFactory:u,videoMessageLieUpdater:(e,t,n)=>((e,t,n,i,a)=>{if(!t)throw Error("clientMessageId undefined");const o=`Message:${t}`;let r;try{r=e.readFragment({id:o,fragment:x})}catch(e){throw e}if(!r)throw Error(`Message lie ${o} not found.`);if(!r.content)throw Error(`Message lie ${o} has no content.`);const s={cacheKey:n,prop:i,value:a,instancesReplaced:0},l=(0,f.te)([O],r.content,s);if(1!==s.instancesReplaced)throw Error(`${s.instancesReplaced} instances found instead of 1`);{const n=(0,R.M)()[0].toString();try{e.writeFragment({id:o,fragment:x,data:{__typename:"Message",id:t,content:l,version:n}})}catch(e){throw e}}})(i,o.clientMessageId,e,t,n)}))})),B=(e,t,n,a,o,r,s,l)=>(0,i.mG)(void 0,void 0,void 0,(function*(){const{content:d,computed:c,files:u,clientMessageId:m,deeplinks:g}=t,p=(0,i._T)(t,["content","computed","files","clientMessageId","deeplinks"]),v=Object.assign({conversationId:a,connectedExperienceEnabled:o,existingLinks:(null==c?void 0:c.embeddedLinks)||[],messageProperties:c?Object.assign(Object.assign({},c),{embeddedLinks:[]}):{},files:u,coreSettings:e.coreSettings,loggerFactory:e.loggerFactory},r),{coreSettings:S,loggerFactory:f}=e,y=f.newLogger("chat-resolver-utils"),k=yield U(e,d,v,a,t,n,s,l),C=((e,t)=>{const{enableEntityConversationInMWTab:n}=e.get(_.J.Extensibility);if(!n)return[];const i=w.getInstance(),a=i.getSubEntityDeepLinkInfo();return a&&t&&i.getClientMessageId()===t?(i.setSubEntityDeepLinkInfo(void 0),i.setClientMessageId(void 0),[a]):[]})(S,m||void 0);return y.log(`serialized message ${m}`),null==s||s.mark(h.ck.ChatSendMessageSerializationComplete),Object.assign({content:k,computed:v.messageProperties,files:v.files,deeplinks:C.length>0?C:g,clientMessageId:m},p)})),W=(e,t)=>{const{loggerFactory:n,offlineCacheManager:i}=e,a={logger:n.newLogger("serializeDraftMessage"),offlineCacheManager:i},o=(0,f.te)(k.D,t.content,a);return Object.assign(Object.assign({},t),{content:o})},G=(e,t,n,a,o,r)=>(0,i.mG)(void 0,void 0,void 0,(function*(){if(!o||!n||!t.files||0===t.files.length)return t;if(!(null==o?void 0:o.isOneOnOneBotChat))return t;const i=a.newLogger("chat-resolver-utils"),s=r||1e4,l=yield Promise.all(t.files.map((t=>V(t,e,i,s))));return Object.assign(Object.assign({},t),{files:l})})),V=(e,t,n,a)=>(0,i.mG)(void 0,void 0,void 0,(function*(){const i=e.objectUrl;if(i){let o;try{o=yield(0,I.E)(t.getBotFileDownloadUrl(i,n),a,"get bot downlaod url timed out")}catch(e){o=null,n.error("getBotDownloadUrlForFiles: failed to get file info")}if(o)return Object.assign(Object.assign({},e),{downloadUrl:o})}return e})),H=e=>()=>{try{const t=e.readQuery({query:N,variables:{options:{capabilityFilter:[L.AppCapability.Messaging]}}});return(null==t?void 0:t.appDefinitions)||void 0}catch(e){return}},$=(e,t,n,i)=>()=>{var o;try{if(n){const n=z(e,t,i);return(0,a.compact)(null==n?void 0:n.filter((e=>{var t;return null===(t=null==e?void 0:e.definition)||void 0===t?void 0:t.messageExtensions})).map((e=>e&&q(e)?e:null)))}{const n=e.readQuery({query:P,variables:{conversationId:t,installedScopes:[L.AppInstallScope.Personal,L.AppInstallScope.GroupChat],options:{capabilityFilter:[L.AppCapability.Messaging]}}});return(0,a.compact)(null===(o=null==n?void 0:n.installedApps)||void 0===o?void 0:o.map((e=>e&&q(e)?e:null)))}}catch(e){return}},z=(e,t,n)=>{var i;let a=null;try{a=e.readQuery({query:E.C,variables:{installedContext:{scope:L.AppInstallScope.Personal}}})}catch(e){a=null}let o=null;try{if(n){const n=e.readQuery({query:F,variables:{conversationId:t}});o=null==n?void 0:n.installedChatAppsWithPreCheck}else{const n=e.readQuery({query:E.C,variables:{installedContext:{conversationId:t,scope:L.AppInstallScope.GroupChat}}});o=null==n?void 0:n.installedAppsV2}}catch(e){o=null}const r=null!=o?o:[];return(null!==(i=null==a?void 0:a.installedAppsV2)&&void 0!==i?i:[]).concat(r)},q=e=>(0,a.includes)([L.AppInstallationStates.Installed,L.AppInstallationStates.InstalledAndFavorited,L.AppInstallationStates.InstalledAndPermanent],e.installationState),J=(e,t,{getSharepointShareService:n,getPeopleService:a,discover:o},r,s)=>(0,i.mG)(void 0,void 0,void 0,(function*(){var i;if((null===(i=null==e?void 0:e.files)||void 0===i?void 0:i.length)&&!(null==t?void 0:t.isOneOnOneBotChat)){const i=yield n(),l=yield a(),d=yield o.skypeid(),c=(yield Q(t,l,r,s)).filter((e=>e.mri!==d)),u=yield i.shareFiles(e.files,c);return Object.assign(Object.assign({},e),{files:u})}return e})),Q=(e,t,n,o)=>(0,i.mG)(void 0,void 0,void 0,(function*(){const i=e.hasFederatedUser,r=e.hasTflConsumerUser,[s,l]=r?(0,a.partition)(e.memberIds,(t=>(0,C.Nl)(t)&&!(0,b.Bl)(e.id))):[[],e.memberIds],d=n&&i?yield(0,S.a2)(l||[],t):yield(0,S.Mv)(l||[],t),c=o&&r?yield(0,S.LH)(s||[],t):[];return d.concat(c)})),K=(e,t,n,a,o,r,s,l,d,c)=>(0,i.mG)(void 0,void 0,void 0,(function*(){var i,u;let m;try{m=null===(i=t.readQuery({query:p,variables:{convId:e}}))||void 0===i?void 0:i.chat}catch(e){a.error("Failed to find chat in cache")}if(r&&!m){const t=yield n.getCSAService(),i=yield t.getChat(e);i&&(m=(0,v._$)(i,o,s,{id:l},d))}const g=(0,v.UL)(c)||(0,v.AK)(c);if(!m&&g&&c){e=c;try{m=null===(u=t.readQuery({query:p,variables:{convId:e}}))||void 0===u?void 0:u.chat}catch(e){a.error("Failed to find chat in cache")}}return m})),Y=({chatType:e})=>e===L.ChatType.Chat||e===L.ChatType.Meeting,X=(e,t)=>{var n,i;const o=!(0,a.isEmpty)(null==t?void 0:t.botMembers),r=!!(null===(i=null===(n=e.computed)||void 0===n?void 0:n.mentions)||void 0===i?void 0:i.find((e=>"bot"===e.mentionType)));if(!((null==t?void 0:t.isOneOnOneBotChat)||o&&r))return e;const s={},l=(0,f.te)([y],e.content,s);return s.isPureText&&!(0,a.isNil)(s.textContent)?Object.assign(Object.assign({},e),{content:s.textContent,messageType:"BotMessageBack"===e.messageType?"BotMessageBack":T.Cs.Text}):Object.assign(Object.assign({},e),{content:l})}},3215:(e,t,n)=>{"use strict";n.d(t,{yG:()=>ae,wr:()=>re,lD:()=>oe});var i=n(13637),a=n(34255),o=n(96882),r=n(5102);function s(e,t,n){e.splice(function(e,t,n){let i=0,a=e.length;const o=n(t);for(;i<a;){const t=Math.floor((i+a)/2);o<n(e[t])?a=t:i=t+1}return i}(e,t,n),0,t)}const l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageIdList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"replyChainId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"cursor"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messages"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"replyChainId"},value:{kind:"Variable",name:{kind:"Name",value:"replyChainId"}}},{kind:"Argument",name:{kind:"Name",value:"cursor"},value:{kind:"Variable",name:{kind:"Name",value:"cursor"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageIdFields"}}]}},{kind:"Field",name:{kind:"Name",value:"cursor"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"messageIdFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}}]}}]},d={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"interopDeliveryState"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"smsDeliveryReports"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"time"}},{kind:"Field",name:{kind:"Name",value:"errorCode"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"time"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"count"}}]}},{kind:"Field",name:{kind:"Name",value:"escalations"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"time"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"meetingTitle"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"rsvpTo"}},{kind:"Field",name:{kind:"Name",value:"body"}},{kind:"Field",name:{kind:"Name",value:"scheduledMeetingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"exchangeId"}},{kind:"Field",name:{kind:"Name",value:"iCalUID"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"timeZoneId"}},{kind:"Field",name:{kind:"Name",value:"originalStartTime"}},{kind:"Field",name:{kind:"Name",value:"eventRecurrenceRange"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"}},{kind:"Field",name:{kind:"Name",value:"endDate"}}]}},{kind:"Field",name:{kind:"Name",value:"eventRecurrencePattern"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patternType"}},{kind:"Field",name:{kind:"Name",value:"daily"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"weekly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"daysOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"monthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfMonth"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeMonthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"yearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheMonth"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeYearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"cardClientId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}},{kind:"Field",name:{kind:"Name",value:"userSpecificContent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"authBlockLastUsedOn"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"diagnosticInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"diagnosticErrorCode"}},{kind:"Field",name:{kind:"Name",value:"diagnosticMessage"}}]}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"chicletBreadcrumbs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sourceTeamName"}},{kind:"Field",name:{kind:"Name",value:"sourceChannelName"}}]}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"previewUrl"}},{kind:"Field",name:{kind:"Name",value:"previewHeight"}},{kind:"Field",name:{kind:"Name",value:"previewWidth"}},{kind:"Field",name:{kind:"Name",value:"progressComplete"}},{kind:"Field",name:{kind:"Name",value:"hasUploadFailed"}},{kind:"Field",name:{kind:"Name",value:"serviceName"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"providerDataV2"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"embeddedLinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"fileShareUrlMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"policyViolation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"verdictDetails"}},{kind:"Field",name:{kind:"Name",value:"dlpAction"}},{kind:"Field",name:{kind:"Name",value:"genericStreamItemId"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"justificationText"}},{kind:"Field",name:{kind:"Name",value:"userAction"}},{kind:"Field",name:{kind:"Name",value:"violationType"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"policyTip"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"generalText"}},{kind:"Field",name:{kind:"Name",value:"complianceUrl"}},{kind:"Field",name:{kind:"Name",value:"matchedConditionDescriptions"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"userHasSaved"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"fromLanguage"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"URL"}},{kind:"Field",name:{kind:"Name",value:"Xsdata"}},{kind:"Field",name:{kind:"Name",value:"Sdata"}}]}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"translatedSubject"}},{kind:"Field",name:{kind:"Name",value:"translatedContent"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"scheduledSendTime"}},{kind:"Field",name:{kind:"Name",value:"draftId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}}]}}]};const c=(e,t,n,i)=>{const a=e.readQuery({query:t,variables:{convId:n,replyChainId:i}});return u(a)},u=e=>{if(!e||!e.messages)return;const{messages:t,__typename:n}=e.messages;return t?{messages:t,typeName:n}:void 0},m=(e,t,n,i,a,o,r)=>{const s=a.length>0&&a[a.length-1].id,l={convId:t,replyChainId:n};e.writeQuery({query:i,variables:l,data:{messages:{messages:a,cursor:s,__typename:o}}}),null==r||r.log(`cache.writeQuery message: [${a.map((e=>e.id))}]`)},g=(e,t,n,i,a,o)=>{let r;const s=[];return t.forEach((t=>{let o=!1,l=!1;t.from===i&&n.find((e=>e.id===t.clientMessageId))?(l=!0,o=!0):n.find((e=>e.id===t.id))||(o=!0),a&&v(e,t),o?(r||(r=[...n]),l&&h(r,t),p(r,t)):s.push(t.id)})),s.length>0&&(null==o||o.log(`Skipped message ids [${s.map((e=>e))}]`)),r},p=(e,t)=>{s(e,t,(e=>-new Date(e.originalArrivalTime)))},h=(e,t)=>{const n=e.findIndex((e=>e.clientMessageId===t.clientMessageId));n>=0&&e.splice(n,1)},v=(e,t)=>{e.writeFragment({id:`${(0,o.uG)(t)}`,fragment:d,data:Object.assign({},t)})};var S=n(89925),f=n(54813),y=n(73456);const k={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"files"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"File"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"chicletBreadcrumbs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sourceTeamName"}},{kind:"Field",name:{kind:"Name",value:"sourceChannelName"}}]}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"previewUrl"}},{kind:"Field",name:{kind:"Name",value:"previewHeight"}},{kind:"Field",name:{kind:"Name",value:"previewWidth"}},{kind:"Field",name:{kind:"Name",value:"progressComplete"}},{kind:"Field",name:{kind:"Name",value:"hasUploadFailed"}},{kind:"Field",name:{kind:"Name",value:"serviceName"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"providerDataV2"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]},C={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"emotions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Emotion"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"time"}}]}}]}}]},b={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"emotionsSummary"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmotionSummary"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"count"}}]}}]},T={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"mentions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Mention"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}}]},w={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"card"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Card"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"cardClientId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}},{kind:"Field",name:{kind:"Name",value:"userSpecificContent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"authBlockLastUsedOn"}}]}}]}}]},_={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataTypesCommonAtpSharepointDataFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ATPSafelinksSharepointData"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"URL"}},{kind:"Field",name:{kind:"Name",value:"Xsdata"}},{kind:"Field",name:{kind:"Name",value:"Sdata"}}]}}]},I={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"dlpContext"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DlpContext"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"policyViolation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"verdictDetails"}},{kind:"Field",name:{kind:"Name",value:"dlpAction"}},{kind:"Field",name:{kind:"Name",value:"genericStreamItemId"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"justificationText"}},{kind:"Field",name:{kind:"Name",value:"userAction"}},{kind:"Field",name:{kind:"Name",value:"violationType"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"policyTip"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"generalText"}},{kind:"Field",name:{kind:"Name",value:"complianceUrl"}},{kind:"Field",name:{kind:"Name",value:"matchedConditionDescriptions"}}]}}]}}]}}]},A={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"translation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Translation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"fromLanguage"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"title"}}]}}]},N={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"replyMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}},{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"isImportant"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataTypesCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"attached"}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}}]}},...k.definitions,...C.definitions,...b.definitions,...T.definitions,...w.definitions,..._.definitions,...I.definitions,...A.definitions]};var E=n(21164);const D={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"standardPostMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StandardPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataTypesCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}}]}},...k.definitions,...T.definitions,...C.definitions,...b.definitions,...w.definitions,..._.definitions,...I.definitions,...A.definitions]},F={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meeting"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Meeting"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"meetingTitle"}},{kind:"Field",name:{kind:"Name",value:"meetingActionType"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"scheduledMeetingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"scheduledMeetingInfo"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"scheduledMeetingInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ScheduledMeetingInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"exchangeId"}},{kind:"Field",name:{kind:"Name",value:"iCalUID"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"eventRecurrenceRange"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"}},{kind:"Field",name:{kind:"Name",value:"endDate"}}]}},{kind:"Field",name:{kind:"Name",value:"eventRecurrencePattern"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patternType"}},{kind:"Field",name:{kind:"Name",value:"daily"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"weekly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"daysOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"monthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfMonth"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeMonthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"yearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheMonth"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeYearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}}]}}]}}]}}]},P={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"announcementPostMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AnnouncementPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"announcement"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"originalImageUrl"}},{kind:"Field",name:{kind:"Name",value:"croppedImageUrl"}},{kind:"Field",name:{kind:"Name",value:"colorTheme"}},{kind:"Field",name:{kind:"Name",value:"croppedImageHeight"}},{kind:"Field",name:{kind:"Name",value:"croppedImageWidth"}},{kind:"Field",name:{kind:"Name",value:"isTeamsIllustration"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataTypesCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meeting"}}]}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}}]}},...k.definitions,...T.definitions,...C.definitions,...b.definitions,...w.definitions,..._.definitions,...A.definitions,...I.definitions,...F.definitions]},M={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"emailPostMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"emailDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emailDetails"}}]}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataTypesCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}}]}},...k.definitions,...T.definitions,...C.definitions,...b.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"emailDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"from"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"sender"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"to"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"cc"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"emailLink"}},{kind:"Field",name:{kind:"Name",value:"totalRecipients"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"emailUser"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailUser"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"smtp"}}]}}]}.definitions,...w.definitions,..._.definitions,...A.definitions,...I.definitions]},j={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingPostMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meeting"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataTypesCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}}]}},...T.definitions,...C.definitions,...b.definitions,...k.definitions,...F.definitions,...w.definitions,..._.definitions,...A.definitions,...I.definitions]},R={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"connectorPostMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConnectorPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"connectorMetadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorSenderGuid"}},{kind:"Field",name:{kind:"Name",value:"providerAccountUniqueId"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}}]}},...k.definitions,...T.definitions,...C.definitions,...b.definitions,...w.definitions,...A.definitions]},x={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataTypesCommonGuardiansPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"GuardiansPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"parentsAnnouncementsStatus"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}}]}},...T.definitions,...C.definitions,...b.definitions,...w.definitions,...A.definitions]},O={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingReplyMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingReplyMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"isImportant"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataTypesCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meeting"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"attached"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}}]}},...C.definitions,...b.definitions,...T.definitions,...w.definitions,..._.definitions,...k.definitions,...F.definitions,...A.definitions,...I.definitions]},L={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChannelReplyChainSummaryWithUserDetailsFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainSummary"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"replyChainId"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"postMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"standardPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"announcementPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"emailPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"connectorPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataTypesCommonGuardiansPostMessageFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"previewMessageSet"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"replyMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingReplyMessage"}}]}},{kind:"Field",name:{kind:"Name",value:"mostRecentOverflowMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"replyMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingReplyMessage"}}]}},{kind:"Field",name:{kind:"Name",value:"totalReplies"}},{kind:"Field",name:{kind:"Name",value:"totalUsers"}},{kind:"Field",name:{kind:"Name",value:"recentUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}}]}},{kind:"Field",name:{kind:"Name",value:"recentUserDisplayNameHints"}},{kind:"Field",name:{kind:"Name",value:"creationTime"}},{kind:"Field",name:{kind:"Name",value:"updatedTime"}},{kind:"Field",name:{kind:"Name",value:"hasMention"}},{kind:"Field",name:{kind:"Name",value:"hasChannelMention"}},{kind:"Field",name:{kind:"Name",value:"hasCurrentUserMention"}},{kind:"Field",name:{kind:"Name",value:"hasUnreadPostMessage"}},{kind:"Field",name:{kind:"Name",value:"hasUnreadReplyMessage"}}]}},...E.T.definitions,...D.definitions,...P.definitions,...M.definitions,...j.definitions,...R.definitions,...x.definitions,...N.definitions,...O.definitions]},U={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"replyChainSummaryLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainSummary"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"replyChainId"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"postMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"standardPostLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingPostLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"emailPostMessageLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingPostMessageLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"announcementPostMessageLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"guardiansPostMessageLie"}}]}},{kind:"Field",name:{kind:"Name",value:"previewMessageSet"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"replyLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingReplyLie"}}]}},{kind:"Field",name:{kind:"Name",value:"creationTime"}}]}},...E.T.definitions,{kind:"FragmentDefinition",name:{kind:"Name",value:"standardPostLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StandardPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingPostLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"emailPostMessageLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingPostMessageLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"announcementPostMessageLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AnnouncementPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"guardiansPostMessageLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"GuardiansPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"replyLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"attached"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingReplyLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingReplyMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"attached"}}]}}]},B={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"replyChainSummaryList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"channelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"queryInput"}},type:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainSummaryQueryInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"last"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"before"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"replyChainSummaries"},arguments:[{kind:"Argument",name:{kind:"Name",value:"channelId"},value:{kind:"Variable",name:{kind:"Name",value:"channelId"}}},{kind:"Argument",name:{kind:"Name",value:"queryInput"},value:{kind:"Variable",name:{kind:"Name",value:"queryInput"}}},{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}}},{kind:"Argument",name:{kind:"Name",value:"last"},value:{kind:"Variable",name:{kind:"Name",value:"last"}}},{kind:"Argument",name:{kind:"Name",value:"before"},value:{kind:"Variable",name:{kind:"Name",value:"before"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pageInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startCursor"}},{kind:"Field",name:{kind:"Name",value:"endCursor"}},{kind:"Field",name:{kind:"Name",value:"hasNextPage"}},{kind:"Field",name:{kind:"Name",value:"hasPreviousPage"}}]}},{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"replyChainSummaryLie"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"metadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dataSource"}},{kind:"Field",name:{kind:"Name",value:"channelRosterSizeExceeded"}}]}}]}}]}},...U.definitions]};var W=n(63931);const G=(e,t,n,i,a)=>{if(t.from&&t.imDisplayName&&(n||t.attached))return t;const{fragment:r,fragmentTypeName:s,fragmentName:l}=V(a);try{const a=e.readFragment(n?{id:`${s}:${t.clientMessageId}`,fragment:r,fragmentName:l}:{id:`${(0,o.uG)(t)}`,fragment:N,fragmentName:"replyMessage"});if(!a)return i&&i.warn(`getDataToWrite::No existing entry found in cache for ${n?"post":"reply"} with clientMessageId ${t.clientMessageId}. Returning given data.`),t;const d=n?void 0:a.attached;return Object.assign(Object.assign(Object.assign({},t),!n&&{attached:d}),{from:a.from,imDisplayName:a.imDisplayName})}catch(e){return i&&i.warn(`getDataToWrite::Failed to read ${n?"post":"reply"} fragment to replace existing lie for msg with clientMessageId ${t.clientMessageId}. Returning given data.`),t}};const V=e=>{switch(e){case S.PostType.Announcement:return{fragmentName:"announcementPostMessage",fragmentTypeName:"AnnouncementPostMessage",fragment:P};case S.PostType.Guardians:return{fragmentName:"DataTypesCommonGuardiansPostMessageFragment",fragmentTypeName:"GuardiansPostMessage",fragment:x};default:return{fragmentName:"standardPostMessage",fragmentTypeName:"StandardPostMessage",fragment:D}}},H=(e,t)=>{let n;if(!t||t.deleteTime)return;if(e.from!==t.from)return;return(0,W.X)(e,t)?n=S.MessageAttachedType.bottom:t.attached&&(n=S.MessageAttachedType.top),n};const $=(e,t,n)=>{try{const n=e.readQuery({query:B,variables:{channelId:t}});return(0,f.X)(n)}catch(e){return n&&n.error("getReplyChainSummariesData::Failed to read replyChainSummariesQuery"),null}},z=(e,t,n,i)=>{try{e.writeQuery({query:B,variables:{channelId:t},data:n})}catch(e){return void(i&&i.error(`writeReplyChainSummariesData::Failed to write to replyChainSummariesQuery for channel ${t}`))}},q={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"replyChainMessageNodeLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessageNode"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"message"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"standardPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"announcementPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"emailPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"replyMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingReplyMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"connectorPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataTypesCommonGuardiansPostMessageFragment"}}]}}]}},...D.definitions,...P.definitions,...M.definitions,...j.definitions,...N.definitions,...O.definitions,...R.definitions,...x.definitions]},J={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"replyChainMessagesList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"channelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"replyChainId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"queryInput"}},type:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainQueryInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"last"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"before"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"replyChainMessages"},arguments:[{kind:"Argument",name:{kind:"Name",value:"channelId"},value:{kind:"Variable",name:{kind:"Name",value:"channelId"}}},{kind:"Argument",name:{kind:"Name",value:"replychainId"},value:{kind:"Variable",name:{kind:"Name",value:"replyChainId"}}},{kind:"Argument",name:{kind:"Name",value:"queryInput"},value:{kind:"Variable",name:{kind:"Name",value:"queryInput"}}},{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}}},{kind:"Argument",name:{kind:"Name",value:"last"},value:{kind:"Variable",name:{kind:"Name",value:"last"}}},{kind:"Argument",name:{kind:"Name",value:"before"},value:{kind:"Variable",name:{kind:"Name",value:"before"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"pageInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startCursor"}},{kind:"Field",name:{kind:"Name",value:"endCursor"}},{kind:"Field",name:{kind:"Name",value:"hasNextPage"}},{kind:"Field",name:{kind:"Name",value:"hasPreviousPage"}}]}},{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"replyChainMessageNodeLie"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"parentMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}}]}},{kind:"Field",name:{kind:"Name",value:"metadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dataSource"}},{kind:"Field",name:{kind:"Name",value:"channelRosterSizeExceeded"}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinkedMessageState"}}]}}]}},...E.T.definitions,...q.definitions]};const Q=(e,t,n,i,a)=>{try{e.writeQuery({query:J,variables:{channelId:t,replyChainId:n},data:i})}catch(e){return void(a&&a.error(`writeReplyChainMessageData::Failed writing replyChainMessageList query to cache for channel ${t} replyChainId ${n}`))}},K=(e,t,n,i)=>{try{const i=e.readQuery({query:J,variables:{channelId:t,replyChainId:n}});return(0,f.X)(i)}catch(e){return i&&i.error(`getReplyChainSummariesData::Failed to read replyChainSummariesQuery for channel ${t} replyChainId ${n}`),null}},Y=(e,t)=>t.replyChainMessages.edges.findIndex((t=>t.node.id===e)),X=(e,t)=>`${t}_${e}`,Z=(e,t,n,i,a,r=!1,s=!1,l,d)=>{n?(function(e,t,n,i,a,r,s){const l=r?G(e,i,!1,s):i;try{const t=l.attached;e.writeFragment({id:`${(0,o.uG)(i)}`,fragment:N,fragmentName:"replyMessage",data:Object.assign(Object.assign({},l),t&&{attached:t})})}catch(e){return void(s&&s.error(`updateReplyChainSummariesWithReply::Failed writing replyChainMessage fragment to cache for clientMessageId ${i.clientMessageId}`))}if(r)return;const d=$(e,t,s);if(!d)return void(s&&s.warn(`updateReplyChainSummariesWithReply::No replyChainSummaries found in cache for channel ${t}`));const c=d.replyChainSummaries.edges.find((e=>e.node.replyChainId===n));if(!c)return void(s&&s.warn(`updateReplyChainSummariesWithReply::ReplyChainSummary does not include post with replyChainId ${n}`));const{node:u}=c,m=[...u.previewMessageSet];m.length===y.up&&m.shift();let g=S.MessageAttachedType.top;if(m.length){const e=m[m.length-1];g=H(i,e)||S.MessageAttachedType.top;const t=Object.assign(Object.assign({},m[0]),{attached:S.MessageAttachedType.top});m[0]=t}const p={__typename:i.__typename||"ReplyChainMessage",id:i.clientMessageId||"",clientMessageId:i.clientMessageId||"",from:a,originalArrivalTime:i.originalArrivalTime||"",version:"-1",attached:g};m.push(p);try{e.writeFragment({id:`ReplyChainSummary:${t}::${n}`,fragment:U,fragmentName:"replyChainSummaryLie",data:Object.assign(Object.assign({},u),{previewMessageSet:m})})}catch(e){return void(s&&s.error(`updateReplyChainSummariesWithReply::Failed writing replyChainSummary fragment to cache for ReplyChainSummary:${t}::${n}`))}}(e,t,n,i,a,r,d),function(e,t,n,i,a,o){var r,s,l;const d=a?G(e,i,!1,o):i,c=K(e,t,n,o);if(!c)return void(o&&o.warn(`updateReplyChainMessagesWithReply::Failed getting replyChainMessage data for channel ${t} replyChainId ${n}`));let u=d.attached;if(!a){const e=null===(l=null===(s=null===(r=null==c?void 0:c.replyChainMessages)||void 0===r?void 0:r.edges)||void 0===s?void 0:s[0])||void 0===l?void 0:l.node;u=(null==e?void 0:e.postType)?void 0:H(d,null==e?void 0:e.message)}const m=X(a?i.id:i.clientMessageId||"",n),g={id:m,postType:null,message:Object.assign(Object.assign({},d),u&&{attached:u})};if(a){const e=Y(m,c);if(-1===e)return void(o&&o.warn("updateReplyChainMessagesWithReply::replaceExisting::Could not find matching message to replace"));c.replyChainMessages.edges[e]={__typename:"ReplyChainMessagesEdge",node:Object.assign({__typename:"ReplyChainMessageNode"},g)}}else c.replyChainMessages.edges.unshift({__typename:"ReplyChainMessagesEdge",node:Object.assign({__typename:"ReplyChainMessageNode"},g)});Q(e,t,n,c,o)}(e,t,n,i,r,d)):function(e,t,n,i,a,o,r,s){const l=a?G(e,n,!0,s,r):n,d=Object.assign(Object.assign({},l),{__typename:n.__typename||"StandardPostMessage",clientMessageId:n.clientMessageId||"",originalArrivalTime:n.originalArrivalTime||"",from:i||l.from||"",version:"-1"}),{fragmentName:c,fragmentTypeName:u,fragment:m}=V(r);try{e.writeFragment({id:`${u}:${o?n.id:n.clientMessageId}`,fragment:m,fragmentName:c,data:d})}catch(e){return void(s&&s.error(`updateReplyChainSummariesWithPost::Failed to write post fragment for clientMessageId ${n.clientMessageId}`))}if(a)return;const g={__typename:"ReplyChainSummary",id:`${t}::${n.clientMessageId}`,channelId:t,replyChainId:n.clientMessageId||"",creationTime:n.originalArrivalTime||"",postType:r||S.PostType.Standard,postMessage:d,previewMessageSet:[],mostRecentOverflowMessage:null,totalReplies:0,totalUsers:0,recentUsers:[],recentUserDisplayNameHints:[],updatedTime:null,hasMention:!1,hasChannelMention:!1,hasCurrentUserMention:!1,hasUnreadPostMessage:null,hasUnreadReplyMessage:null,consumptionHorizon:{id:"lie_ch"}};try{e.writeFragment({id:`ReplyChainSummary:${t}::${o?n.id:n.clientMessageId}`,fragment:L,fragmentName:"DataClientChannelReplyChainSummaryWithUserDetailsFragment",data:g})}catch(e){return void(s&&s.error(`updateReplyChainSummariesWithPost::Failed to write replyChainSummary fragment for clientMessageId ${n.clientMessageId}`))}const p=$(e,t,s);p?(p.replyChainSummaries.edges.unshift({__typename:"ReplyChainSummaryEdge",node:g}),z(e,t,p,s)):s&&s.warn(`updateReplyChainSummariesWithPost::replyChainSummariesList is undefined for channel ${t}`)}(e,t,i,a,r,s,l,d)};var ee=n(36223),te=n(38923),ne=n(75068);const ie=e=>{var t,n,i,a,o,r,s,l,d;const c=(e=>{const{announcementCard:t}=((e=[])=>{const t=e.findIndex((e=>"application/vnd.microsoft.teams.messaging-announcementBanner"===e.contentType));return{announcementCard:e[t],announcementCardIndex:t}})(e);if(t)try{return JSON.parse(t.content)}catch(e){throw(0,te.Tr)("PostComposeHelpers",ne.jK.Undefined,"getAnnouncementCardContentFromDraft::JsonParseError")}})((null===(t=null==e?void 0:e.computed)||void 0===t?void 0:t.cards)||[]);return{title:(null==e?void 0:e.title)||"",colorTheme:(null==c?void 0:c.colorTheme)||null,originalImageUrl:(null===(i=null===(n=null==c?void 0:c.imageData)||void 0===n?void 0:n.origImage)||void 0===i?void 0:i.src)||null,croppedImageUrl:(null===(o=null===(a=null==c?void 0:c.imageData)||void 0===a?void 0:a.croppedImage)||void 0===o?void 0:o.src)||null,croppedImageHeight:(null===(s=null===(r=null==c?void 0:c.imageData)||void 0===r?void 0:r.croppedImage)||void 0===s?void 0:s.imageHeight)||null,croppedImageWidth:(null===(d=null===(l=null==c?void 0:c.imageData)||void 0===l?void 0:l.croppedImage)||void 0===d?void 0:d.imageWidth)||null,isTeamsIllustration:null}},ae=(e,t,n,o,s,d,{mentions:u,cards:p},h)=>(0,i.mG)(void 0,void 0,void 0,(function*(){const{authenticationService:i,discover:v,loggerFactory:f}=t,y=f.newLogger("Client Lie Helper"),[{profile:{name:k}},C]=yield Promise.all([i.getUser(),v.skypeid()]);let b=le(d,o,{mentions:u,cards:p});const{replyChainId:T}=o;b=Object.assign(Object.assign({},b),{from:C,imDisplayName:k});const w=s===S.SendMessageAction.Update;if(w){const{clientMessageId:e,id:t,originalArrivalTime:n,messageType:i}=o;t&&n&&i?b=Object.assign(Object.assign({},b),{id:t,originalArrivalTime:n,editTime:new Date(Date.now()).toISOString(),messageType:i}):y.error(`can't find id, originalArrivalTime, messageType for ${e}`)}const _=w||h&&!!o.id;h?Z(e,n,T||void 0,se(b,o),C,_,w,(null==o?void 0:o.postType)||void 0,y):function(e,t,n,i,o,s=!1,d){try{if((0,a.isEmpty)(i))return void(null==d||d.log(`convId: ${t}, replyChainId: ${n}:: newMessageBatch is empty!`));const r=l,u=c(e,r,t,n);if(!u)return void(null==d||d.warn(`convId: ${t}, replyChainId: ${n}:: cachedMessages is undefined!`));const{messages:p,typeName:h}=u;null==d||d.log(`convId: ${t}, replyChainId: ${n}:: newMessageBatch: [${i.map((e=>e.id))}]`);const v=g(e,i,p,o,s,d);v?m(e,t,n,r,v,h,d):null==d||d.log(`convId: ${t}, replyChainId: ${n}:: skipped writeCacheQuery. message list not updated!`)}catch(e){null==d||d.error((0,r.A)(e.message))}}(e,n,null,[b],C,!0,y)})),oe=e=>le(e.content,e,e.computed||{}),re=e=>se(oe(e),e),se=(e,t)=>{const n=!(null==t?void 0:t.replyChainId),i=(null==t?void 0:t.subject)||"",a=(null==t?void 0:t.replyPermission)||null,o=n&&(null==t?void 0:t.postType)===S.PostType.Announcement?ie(t):void 0,{fragmentTypeName:r}=V(null==t?void 0:t.postType);return Object.assign(Object.assign({},e),{__typename:n?r:"ReplyChainMessage",id:e.id||"",isImportant:"Important"===e.importance,isPinned:!1,messageRenderType:S.MessageRenderType.Standard,subject:i||"",isLastRead:!1,isTimestampDividerNeeded:!1,isCrossPost:!1,crossPostId:null,attached:null,translation:null,translatedSubject:null,translatedContent:null,translationStatus:null,sourceLanguageName:null,sourceLanguageCode:null,announcement:o,replyPermission:a,deletionInfo:{__typename:"MessageDeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:!1},canUserReply:!0,parentsAnnouncementsStatus:null})},le=(e,{clientMessageId:t,files:n,deeplinks:i,importance:a,messageType:o,scheduledSendTime:r},{mentions:s,cards:l})=>({__typename:"Message",id:t||"",clientMessageId:t||"",originalArrivalTime:new Date(Date.now()).toISOString(),version:(0,ee.M)()[0].toString(),importance:a||null,content:e,messageType:o||"RichText/Html",interopDeliveryState:null,smsDeliveryReports:null,emotionsSummary:null,emotions:null,escalations:null,mentions:de(s),onBehalfOf:null,cards:ce(l),from:null,imDisplayName:null,files:ue(n),deeplinks:me(i),urlPreview:null,embeddedLinks:null,dlpContext:null,deleteTime:null,editTime:null,status:S.MessageStatus.Sending,diagnosticInfo:null,deletionInfo:{__typename:"DeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:!1},userHasSaved:!1,callId:null,replyPermission:null,translation:null,atpSharepointData:null,isDeletedByAdmin:null,meeting:null,hardDeleteTime:null,hardDeleteReason:null,translatedSubject:null,translatedContent:null,translationStatus:null,sourceLanguageName:null,sourceLanguageCode:null,scheduledSendTime:r||null,draftId:r?t||"":null,crossPostStatus:null,crossPostFailedChannels:null}),de=e=>(0,a.map)(e,(e=>{var{itemId:t}=e,n=(0,i._T)(e,["itemId"]);return Object.assign({__typename:"Mention",id:t,itemId:t},n)})),ce=e=>(0,a.map)(e,(e=>({__typename:"Card",appIcon:e.appIcon||null,appId:e.appId,appName:e.appName||null,cardClientId:e.cardClientId,content:e.content,contentType:e.contentType,locale:e.locale||null,userSpecificContent:null}))),ue=e=>(0,a.map)(e,(e=>{var{chicletBreadcrumbs:t,title:n,type:a}=e,o=(0,i._T)(e,["chicletBreadcrumbs","title","type"]);return{__typename:"File",id:o.id,itemId:o.itemId||null,chicletBreadcrumbs:t?{__typename:"ChicletBreadcrumbs",sourceChannelName:t.sourceChannelName||null,sourceTeamName:t.sourceTeamName||null}:null,baseUrl:null,objectUrl:null,shareId:null,shareUrl:null,type:a||null,title:n||null,previewUrl:null,previewHeight:null,previewWidth:null,progressComplete:null,hasUploadFailed:!1,serviceName:null,providerDataV2:null,state:null}})),me=e=>(0,a.map)(e,(e=>({__typename:"DeepLink",id:(0,i._T)(e,[]).id,channelId:null,title:null,siteUrl:null,objectUrl:null,serverRelativeUrl:null,state:null})))},16484:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedAppsV2"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...n(57842).W.definitions]}},42265:(e,t,n)=>{"use strict";n.d(t,{X:()=>a});var i=n(96882);function a(e){var t;switch(e.__typename){case"BreakoutRoom":return`${e.__typename}:${null===(t=e.coordinates)||void 0===t?void 0:t.threadId}`;case"Participant":return`${e.__typename}:${e.participantId}`;case"TeamTagCards":return`${e.__typename}:${e.teamId}`;case"TagCard":return`${e.__typename}:${e.tagId}`;case"Entity":return e.linkedEntity?`${e.__typename}:${e.id}:${e.type}:${e.action}:${e.options}:${e.linkedEntity.id}:${e.linkedEntity.type}:${e.linkedEntity.action}`:`${e.__typename}:${e.id}:${e.type}:${e.action}:${e.options}`;case"InstalledApp":const n=`${(0,i.uG)(e)}:${e.installedScope}`;return e.conversationId?`${n}:${e.conversationId}`:n;case"AppDefinition":return`${(0,i.uG)(e)}:${e.version}`;case"MessageExtensionCommand":return`${(0,i.uG)(e)}:${e.appKey}`;case"BotDynamicCommands":return`${e.__typename}:${e.botMri}:${e.commandContext}`;case"DeviceList":if(!e.id)throw new Error("dataIdFromObject(), no id on DeviceList object.");return(0,i.uG)(e);case"TransportCompanionDeviceInfo":case"UserPreferences":case"UserSettings":case"MessagingSettings":case"MeetingChatSettings":case"AppsUsage":return e.__typename;case"StagedApp":return`${(0,i.uG)(e)}:${e.reviewStatus}`;case"CallLogParticipant":return`${(0,i.uG)(e)}:${e.displayName}:${e.type}`;case"WebApplicationInfo":return`${e.__typename}:${e.appKey}`;default:return(0,i.uG)(e)}}},21537:(e,t,n)=>{"use strict";n.d(t,{D:()=>a});var i=n(49355);const a={Mutation:{updateFilePermission(e,{updateFilePermissionInput:t},{cache:n}){if(!t)return!1;const{fileId:a,shareUrl:o,shareId:r,scope:s}=t,l=i.Ps`
  fragment filePermissionUpdate on FileUpload {
    id
    shareUrl
    shareId
    permissionScope
  }
`;let d;const c=`FileUpload:${a}`;try{d=n.readFragment({fragment:l,id:c})}catch(e){throw e}if(!d)throw new Error("Expected initial files to be populated before a command is executed");const u=Object.assign(Object.assign({},d),{shareUrl:o,shareId:r,permissionScope:s});return n.writeFragment({fragment:l,id:c,data:u}),!0},updatePermissionScopeInFileUpload(e,{updatePermissionScopeInput:t},{cache:n}){if(!t)return!1;const{fileId:a,scope:o}=t;if(!a)return!1;const r={permissionScope:o,__typename:"FileUpload"};try{n.writeFragment({fragment:i.Ps`
  fragment updatePermissionScope on FileUpload {
    permissionScope
  }
`,id:`FileUpload:${a}`,data:r})}catch(e){return!1}return!0}}}},670:(e,t,n)=>{"use strict";n.d(t,{w:()=>o,Q:()=>r});var i=n(13637),a=n(73230);const o={Query:{meetForWorkAppUserState(e,t,n){return(0,i.mG)(this,void 0,void 0,(function*(){return(yield n.getMeetForWorkService()).getAppUserState()}))}},Mutation:{refreshForMeetApp(e,t,{getMeetForWorkService:n}){return(0,i.mG)(this,void 0,void 0,(function*(){return n().then((e=>(0,i.mG)(this,void 0,void 0,(function*(){return e.refresh()})))),!0}))},deleteUpcomingEventForMeetApp(e,{meetingId:t},{getMeetForWorkService:n}){return(0,i.mG)(this,void 0,void 0,(function*(){return(yield n()).deleteUpcomingEvent(t)}))},updateMeetForWorkAppUserState(e,{updatedValue:t},n){return(0,i.mG)(this,void 0,void 0,(function*(){return(yield n.getMeetForWorkService()).updateAppUserState(t)}))},setFetchMeetAppDataEnabled(e,{enable:t},{getMeetForWorkService:n}){return(0,i.mG)(this,void 0,void 0,(function*(){return(yield n()).setFetchDataEnabled(t),!0}))},requireFurtherRecentDataFromMeetApp(e,{sessionId:t},{getMeetForWorkService:n}){return(0,i.mG)(this,void 0,void 0,(function*(){return(yield n()).requireFurtherRecentData(t)}))}}},r={Subscription:{meetAppInsightsEvent:{subscribe:(0,a.OF)(((e,t,{pubsub:n,getMeetForWorkService:a})=>(a().then((e=>(0,i.mG)(void 0,void 0,void 0,(function*(){e.fetchDataIfNeeded()})))),n.asyncIterator("meetAppInsightsEvent"))),((e,t)=>t.topic===e.meetAppInsightsEvent.topic))}}}},29204:(e,t,n)=>{"use strict";n.d(t,{w:()=>r,s:()=>s});var i=n(13637),a=n(57153),o=n(73230);const r={Query:{meetingBotMetaInfo(e,t,n){return(0,i.mG)(this,void 0,void 0,(function*(){const{getMeetingBotService:e}=n,t=yield e();return{meetingBotMri:yield t.getBotId(),__typename:"MeetingBotMetaInfo"}}))},meetingBotCalendarEvents(e,{start:t,end:n},a){return(0,i.mG)(this,void 0,void 0,(function*(){const e=yield a.getMeetingBotService();return(yield e.fetchCalendarEvents(t,n)).filter((e=>!e.isAllDayEvent&&e.isOnlineMeeting)).map((e=>{var t;return{id:e.objectId,start:new Date(e.startTime).toUTCString(),end:new Date(e.endTime).toUTCString(),iCalUID:e.iCalUID,subject:e.subject,objectId:e.objectId,conversationId:null===(t=e.skypeTeamsDataObj)||void 0===t?void 0:t.cid,skypeTeamsMeetingUrl:e.skypeTeamsMeetingUrl,isCancelled:e.isCancelled,isAllDayEvent:e.isAllDayEvent}}))}))},meetingBotChatIdForCalendarEvent(e,{eventId:t},n){return(0,i.mG)(this,void 0,void 0,(function*(){return(yield n.getMeetingBotService()).fetchChatIdForCalendarEvent(t)}))}},Mutation:{postMeetingStarted(e,{absentAttendees:t,hasRecordingStarted:n,meetingId:o,isForced:r},s){return(0,i.mG)(this,void 0,void 0,(function*(){const e=yield s.getMeetingBotService();if(!r&&e.isMeetingEventSent(o,a.$.MeetingStart))return"absentAttendee checked";if(e.setMeetingEventSent(o,a.$.MeetingStart),t&&t.length>0){const i=yield e.postEventToBot({Scenario:a.$.MeetingStart,MeetingInfo:{HasRecordingStarted:n,AbsentAttendee:t}});return`${null==i?void 0:i.status}`}return"no absent attendees"}))},postGreetingToMeetingBot(e,{input:{meetingId:t,organizerId:n,recordingState:o,hasPresentedDeck:r,hasRecordingStarted:s,hasProactiveAction:l,absentAttendee:d,timeElapedSinceMeetingStartedInMinutes:c,hasNextMeeting:u,endTime:m,isRecurrent:g}},p){return(0,i.mG)(this,void 0,void 0,(function*(){const e=yield p.getMeetingBotService();if(e.isMeetingEventSent(t,a.$.InMeetingGreeting)||e.isMeetingEventSent(t,a.$.MeetingStart))return!1;e.setMeetingEventSent(t,a.$.InMeetingGreeting);return!!(yield e.postEventToBot({Scenario:a.$.InMeetingGreeting,MeetingInfo:{MeetingId:t,AbsentAttendee:d,OrganizerId:n,RecordingState:o,HasPresentedFile:r,HasProactiveAction:l,HasRecordingStarted:s,TimeElapedSinceMeetingStartedInMinutes:c,HasNextMeeting:u,EndTime:m,IsRecurrent:g,Subject:"Subject"}}))}))},tryStartMeetingBotPublisher(e,t,n){return(0,i.mG)(this,void 0,void 0,(function*(){const{getMeetingBotService:e,loggerFactory:t}=n;t.newLogger("MeetingBot Resolver").log("tryStartMeetingBotPublisher");const i=yield e();return yield i.startPublisher(),!0}))},sendActionStatus(e,{botAction:t,isActionSucess:n,nextMeetingName:o},r){return(0,i.mG)(this,void 0,void 0,(function*(){const e=yield r.getMeetingBotService();return yield e.postEventToBot({Scenario:a.$.InMeetingActionStatusUpdated,MeetingInfo:{InMeetingAction:t,IsActionSucceed:n,NextMeetingName:o}}),!0}))},sendRunningLateForNextMeetingNotification(e,{iCalUID:t,subject:n,objectId:o,conversationId:r},s){return(0,i.mG)(this,void 0,void 0,(function*(){const e=yield s.getMeetingBotService();return yield e.postEventToBot({Scenario:a.$.RunningLate,MeetingInfo:{CallId:t,ThreadId:r,Subject:n,MeetingUid:o}}),!0}))},removeCalendarEvent(e,{eventId:t},n){return(0,i.mG)(this,void 0,void 0,(function*(){const e=yield n.getMeetingBotService();return yield e.removeCalendarEvent(t),"Message sent"}))},sendMeetingBotMessage(e,{text:t,conversationId:n},a){return(0,i.mG)(this,void 0,void 0,(function*(){return(yield a.getMeetingBotService()).sendMeetingBotMessage(t,n)}))},sendMeetingObjectId(e,{meetingObjectId:t},n){return(0,i.mG)(this,void 0,void 0,(function*(){const e=yield n.getMeetingBotService();return yield e.postEventToBot({Scenario:a.$.InMeetingShareFile,MeetingInfo:{MeetingId:t}}),!0}))},reportUsageToMeetingBot(e,t,n){return(0,i.mG)(this,void 0,void 0,(function*(){return(yield n.getMeetingBotService()).reportUsageToMeetingBot()}))},triggerBotAction(e,{conversationId:t,botAction:n,actionId:a},o){return(0,i.mG)(this,void 0,void 0,(function*(){const e=yield o.getMeetingBotService(),i=yield e.fetchChatIdForCalendarEvent(t);return o.pubsub.publish("meetingBotActionEvent",{meetingBotActionEvent:{conversationId:i,botAction:n,actionId:a},__typename:"meetingBotActionEvent"}),!0}))},sendMessageToConversation(e,{conversationId:t,message:n,files:a},o){return(0,i.mG)(this,void 0,void 0,(function*(){if(a&&!a.length)return!1;const e=yield o.getMeetingBotService();return yield e.sendToConversation(t,n,a),!0}))}}},s={Subscription:{meetingBotActionEvent:{subscribe:(0,o.OF)(((e,t,{pubsub:n})=>n.asyncIterator(["meetingBotActionEvent"])),((e,t)=>t.conversationId===e.meetingBotActionEvent.conversationId))}}}},20575:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});const i="payment-service"},8267:(e,t,n)=>{"use strict";n.d(t,{s:()=>r});var i=n(20575),a=n(43748);let o;const r={Mutation:{updatePaymentDetailsInCache:(e,{eventId:t,paymentDetails:n},{cache:r,loggerFactory:s})=>{var l;(e=>{o||(o=e.newLogger(i.k))})(s);try{const e=(null===(l=r.readQuery({query:a.Z,variables:{eventId:t}}))||void 0===l?void 0:l.paymentDetails)||{},i=Object.assign(Object.assign(Object.assign({},e),n),{__typename:"PaymentDetails"});return r.writeQuery({query:a.Z,variables:{eventId:t},data:{paymentDetails:i}}),{eventId:t,__typename:"PaymentDetails"}}catch(e){throw o.error("Payment client resolver failed to update payment details in cache",e),e}}}}},43748:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"paymentDetails"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"eventId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"paymentDetails"},arguments:[{kind:"Argument",name:{kind:"Name",value:"eventId"},value:{kind:"Variable",name:{kind:"Name",value:"eventId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"eventId"}},{kind:"Field",name:{kind:"Name",value:"paymentProvider"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"product"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"price"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"amount"}},{kind:"Field",name:{kind:"Name",value:"currency"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}}]}}]}}]}}]}}]}}]}},43691:(e,t,n)=>{"use strict";n.d(t,{w:()=>h});var i=n(13637),a=n(49074),o=n(89925),r=n(34255);function s(e,t){return t.isGeneral&&e.memberRole!==o.TeamMemberRole.Admin&&function(e){return e.teamSettings&&e.teamSettings.generalChannelPosting===o.GeneralChannelPosting.OwnersPost}(e)}function l(e,t){return e.isUserMuted?o.DisallowedToPostReason.MutedTeamMember:s(e,t)?o.DisallowedToPostReason.OnlyOwnersCanPost:o.DisallowedToPostReason.None}var d=n(43552);function c(e,t){var n,i;return{id:t.id,channelType:m(t.channelType),isGeneral:t.isGeneral||!1,displayName:t.displayName,disallowedToPostReason:l(e,t),consumptionHorizon:t.consumptionHorizon?Object.assign(Object.assign({},t.consumptionHorizon),{__typename:"ClientConsumptionHorizon"}):null,filesRelativePath:(null===(n=t.defaultFileSettings)||void 0===n?void 0:n.filesRelativePath)||null,memberRole:g(t.memberRole),isModerator:t.isModerator||!1,channelSettings:{__typename:"ChannelSettings",channelPostPermissions:p(null===(i=t.channelSettings)||void 0===i?void 0:i.channelPostPermissions)},sharepointSiteUrl:t.sharepointSiteUrl||null,team:{id:e.id,displayName:e.displayName,groupId:e.teamSiteInformation.groupId,sharepointSiteUrl:e.teamSiteInformation.sharepointSiteUrl||null,pictureETag:e.pictureETag||null,smtpAddress:e.smtpAddress,teamSettings:e.teamSettings,__typename:"ClientTeam"},isArchived:t.isArchived,isDeleted:t.isDeleted,__typename:"ChannelWithTeam"}}function u(e){return(0,r.flatMap)(e,(e=>e.filteredChannels.map(c.bind(void 0,e))))}function m(e){switch(e){case o.ChannelType.Standard:return o.ClientChannelType.Standard;case o.ChannelType.Private:return o.ClientChannelType.Private;case o.ChannelType.Shared:return o.ClientChannelType.Shared;default:return null}}const g=e=>{switch(e){case o.TeamMemberRole.Admin:return o.TeamMemberRole.Admin;case o.TeamMemberRole.Guest:return o.TeamMemberRole.Guest;case o.TeamMemberRole.User:return o.TeamMemberRole.User;case o.TeamMemberRole.Undefined:default:return o.TeamMemberRole.Undefined}},p=e=>{switch(e){case o.ChannelPostPermissions.Moderators:return o.ChannelPostPermissions.Moderators;case o.ChannelPostPermissions.EveryoneButGuests:return o.ChannelPostPermissions.EveryoneButGuests;case o.ChannelPostPermissions.Everyone:default:return o.ChannelPostPermissions.Everyone}},h={Query:{channelSearch:(e,{searchQuery:t},n)=>(0,i.mG)(void 0,void 0,void 0,(function*(){let e=yield v(n);if(0===e.length)return{__typename:"ChannelSearchResults",resultsByChannelName:[],resultsByTeamName:[]};e=e.filter((e=>!e.isDeleted)).map((e=>Object.assign(Object.assign({},e),{channels:e.channels.filter((e=>!e.isDeleted))})));const i=new RegExp((0,r.escapeRegExp)(t.toLowerCase())),a=(0,r.cloneDeep)(e).filter((e=>i.test(e.displayName.toLowerCase()))).map((e=>(e.filteredChannels=e.channels,e)));return{__typename:"ChannelSearchResults",resultsByChannelName:u(e.map((e=>(e.filteredChannels=e.channels.filter((e=>i.test(e.displayName.toLowerCase()))),e)))),resultsByTeamName:u(a)}})),channel:(e,{channelId:t},n)=>(0,i.mG)(void 0,void 0,void 0,(function*(){const e=yield v(n);let i;return(0,r.forEach)(e,(e=>{const n=(0,r.find)(e.channels,{id:t});return!n||(i=c(e,n),!1)})),i}))}};function v(e){return(0,i.mG)(this,void 0,void 0,(function*(){const{authenticationUser:t,cache:n,coreSettings:i,localStorage:o,loggerFactory:r,scenarioFactory:s}=e;let l;try{({teams:l}=n.readQuery({query:a.T}))}catch(e){r.newLogger("ClientResolvers").warn("Cache error, returning empty data instead");const c=t&&(yield(0,d.Qp)(t,i,o,s));if(c){const e=c.map(d.uX);n.writeQuery({query:a.T,data:{teams:e}})}l=c||[]}return l}))}},49074:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"teamsList"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teams"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"isDeleted"}},{kind:"Field",name:{kind:"Name",value:"isUserMuted"}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"smtpAddress"}},{kind:"Field",name:{kind:"Name",value:"pictureETag"}},{kind:"Field",name:{kind:"Name",value:"teamSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"generalChannelPosting"}}]}},{kind:"Field",name:{kind:"Name",value:"teamSiteInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"teamType"}},{kind:"Field",name:{kind:"Name",value:"channels"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"channelType"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"isDeleted"}},{kind:"Field",name:{kind:"Name",value:"isArchived"}},{kind:"Field",name:{kind:"Name",value:"isGeneral"}},{kind:"Field",name:{kind:"Name",value:"isShown"}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}}]}},{kind:"Field",name:{kind:"Name",value:"defaultFileSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filesRelativePath"}}]}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"channelSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelPostPermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"isModerator"}}]}}]}}]}}]}},43552:(e,t,n)=>{"use strict";n.d(t,{uX:()=>S,Qp:()=>T,xm:()=>A,GC:()=>E});var i=n(13637),a=n(34255),o=n(31821),r=n(82250),s=n(40178),l=n(26863),d=n(78808),c=n(85350),u=n(72080),m=n(99342),g=n(89925);const p="conversations",h="teams-list";function v(e){var t,n;return Object.assign(Object.assign(Object.assign({__typename:"Channel"},(0,a.defaults)((0,a.pick)(e,["id","channelType","displayName","isArchived","isDeleted","isGeneral","isModerator","isShown","memberRole"]),{channelType:null,isArchived:null,isDeleted:null,isModerator:null,memberRole:null})),{channelSettings:(0,a.defaults)(e.channelSettings,{__typename:"ChannelSettings",channelPostPermissions:null}),defaultFileSettings:{__typename:"DefaultFileSettings",filesRelativePath:(null===(t=e.defaultFileSettings)||void 0===t?void 0:t.filesRelativePath)||null},sharepointSiteUrl:e.sharepointSiteUrl||null}),(null===(n=e.consumptionHorizon)||void 0===n?void 0:n.id)?{consumptionHorizon:{__typename:"ConsumptionHorizon",id:e.consumptionHorizon.id,timeStamp:e.consumptionHorizon.timeStamp||null}}:{consumptionHorizon:null})}function S(e){return Object.assign(Object.assign({__typename:"Team"},(0,a.defaults)((0,a.pick)(e,["id","displayName","isDeleted","isUserMuted","memberRole","smtpAddress","pictureETag","teamType"]),{isUserMuted:null,pictureETag:null,smtpAddress:null,teamType:null})),{teamSettings:{__typename:"TeamSettings",generalChannelPosting:e.teamSettings.generalChannelPosting||null},teamSiteInformation:Object.assign({__typename:"TeamSiteInformation"},(0,a.defaults)((0,a.pick)(e.teamSiteInformation,["groupId","sharepointSiteUrl"]),{groupId:null,sharepointSiteUrl:null})),channels:(e.channels||[]).map(v)})}function f(e){try{return JSON.parse(e)}catch(e){return}}function y(e){if(!e||0===e.length)return;const t=new Map,n=new Map;e.filter((e=>e&&(0,l.HU)(e))).map((e=>t.set(e.id,function(e){var t;const n=e.threadProperties;return Object.assign({id:e.id,displayName:n[d.Q5.SpaceThreadTopic]||"",isDeleted:(0,l.uY)(e),memberRole:b((null===(t=e.memberProperties)||void 0===t?void 0:t.role)||d.nL.None),teamSiteInformation:{groupId:n[d.Q5.GroupId]||"",sharepointSiteUrl:n[d.Q5.SiteUrl]},smtpAddress:n[d.Q5.TeamSmtpAddress],pictureETag:n[d.Q5.PictureETag],isFavorite:(0,l.Dq)(e),channels:[]},function(e){const t=f(e.threadProperties[d.Q5.TeamAdminSettings]);return t?{teamSettings:t.userSettings,teamGuestSettings:t.guestSettings}:{teamSettings:{}}}(e))}(e)))),e.filter((e=>e&&(0,l.J6)(e)&&e.threadProperties)).map((e=>n.set(e.id,{teamId:e.threadProperties[d.Q5.SpaceId],channel:k(e)}))),n.forEach((e=>{const{teamId:n,channel:i}=e,a=n&&t.get(n);a&&(i.team=a,a.channels.push(i))}));const i=Array.from(t.values());return i.length>0?i:void 0}function k(e){const t=e.threadProperties,n=t[d.Q5.SpaceTypes]===c.tG.Private;return{id:e.id,displayName:(n?t[d.Q5.SpaceThreadTopic]:(0,l.T7)(e))||"",description:t[d.Q5.TopicDescription]||"",isDeleted:(0,l.uY)(e),isGeneral:(0,l.HU)(e),channelType:C(t[d.Q5.SpaceTypes]),tabs:[],isShown:(0,l.Dq)(e),isShownByDefault:"true"===t[d.Q5.FavDefault],sharepointSiteUrl:n?t[d.Q5.SiteUrl]:void 0,defaultFileSettings:{filesRelativePath:t[d.Q5.FolderRelativeUrl]},consumptionHorizon:(0,u._l)(e.id,e.properties[d.Ff.ConsumptionHorizon])}}function C(e){switch(e){case c.tG.Private:return g.ChannelType.Private;case c.tG.Shared:return g.ChannelType.Shared;case c.tG.None:default:return g.ChannelType.Standard}}function b(e){switch(e){case d.nL.Admin:return g.TeamMemberRole.Admin;case d.nL.Guest:return g.TeamMemberRole.Guest;case d.nL.User:return g.TeamMemberRole.User;case d.nL.None:default:return g.TeamMemberRole.Undefined}}function T(e,t,n,a){return(0,i.mG)(this,void 0,void 0,(function*(){const{enableChannelLocalCache:i,channelLocalCacheMaxDays:r,enableChannelIndexedDBCache:s,disableChannelIndexedDBNextCache:l}=t.get(o.J.Search);let d,c=!1;if(s&&(d=yield A(e.profile.objectId,e.profile.tenantId,a,!!l),c=void 0!==d),i&&(function(e,t){const n=N(e),i=new Date(Date.now()),a=new Date((null==n?void 0:n.timestamp)||0);a.setDate(a.getDate()+t),a<i&&e.remove(h)}(n,c?0:r||7),!d)){const e=N(n);d=null==e?void 0:e.teams}return d}))}let w;let _;const I=(0,m.J)();function A(e,t,n,a){return(0,i.mG)(this,void 0,void 0,(function*(){return w||(w=function(e,t,n,a){return(0,i.mG)(this,void 0,void 0,(function*(){const o=n.newScenario(r.RG.GetTeamsChannelsFromIndexedDB),l=a=>(0,i.mG)(this,void 0,void 0,(function*(){try{return yield function(e,t,n,a){return(0,i.mG)(this,void 0,void 0,(function*(){const i=function(e,t,n){return n?`Teams:conversation-manager:${t}:${e}`:`skypexspaces-${e}`}(e,t,n),o=function(e){return e?2:7}(n);return(0,s.q8)(i,o,p,"",a,!0)}))}(e,t,a,n)}catch(e){return void o.appendEventData({errors:JSON.stringify(e)})}}));let d;if(a||(d=yield l(!0)),d||(d=yield l(!1)),d)try{const e=y(d);return o.stop({message:e?"Successfully fetched.":"Conversations store does not contain any teams or channels."}),e}catch(e){return void o.fail({errors:"Fails to convert conversations to teams."})}else o.fail({errors:"unable to read conversations from indexedbd"})}))}(e,t,n,a),_=I.setTimeout((()=>{w=void 0,I.clearTimeout(_),_=void 0}),3e5),w)}))}function N(e){const t=e.get(h);if(t)return f(t)}function E(e,t){e.setSafe(h,JSON.stringify({timestamp:Date.now(),teams:t}))}},11235:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});const i="webinar-service"},51924:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"webinarImageQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"webinarId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webinarImage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"webinarId"},value:{kind:"Variable",name:{kind:"Name",value:"webinarId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"image"}}]}}]}}]}},2700:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"webinar"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"webinarId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webinar"},arguments:[{kind:"Argument",name:{kind:"Name",value:"webinarId"},value:{kind:"Variable",name:{kind:"Name",value:"webinarId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"allWebinarFiels"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"allWebinarFiels"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Webinar"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"eventDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"accessPolicy"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"isFull"}},{kind:"Field",name:{kind:"Name",value:"privacyProfileStatementLink"}},{kind:"Field",name:{kind:"Name",value:"capacity"}},{kind:"Field",name:{kind:"Name",value:"price"}}]}},{kind:"Field",name:{kind:"Name",value:"speakerBios"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"speakerId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}},{kind:"Field",name:{kind:"Name",value:"questionnaire"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"questionId"}},{kind:"Field",name:{kind:"Name",value:"order"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"isRequired"}},{kind:"Field",name:{kind:"Name",value:"isPredefined"}}]}},{kind:"Field",name:{kind:"Name",value:"isUserAlreadyRegistered"}},{kind:"Field",name:{kind:"Name",value:"joinLink"}},{kind:"Field",name:{kind:"Name",value:"participantRole"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"registrationId"}},{kind:"Field",name:{kind:"Name",value:"paymentTransactionId"}}]}}]}},80522:(e,t,n)=>{"use strict";n.d(t,{O:()=>a,a:()=>o});var i=n(2700);const a=(e,t)=>{try{const n=e.readQuery({query:i.H,variables:{webinarId:t}});if(!n||!n.webinar)throw new Error("Invalid cached webinar data");return n.webinar}catch(e){throw e}},o=(e,t,n,o)=>{try{const o=a(n,e),r=Object.assign(Object.assign({},o),{questionnaire:t.map((e=>{var t,n,i;return Object.assign(Object.assign({},e),{name:null!==(t=e.name)&&void 0!==t?t:null,displayName:null!==(n=e.displayName)&&void 0!==n?n:null,options:null!==(i=e.options)&&void 0!==i?i:null,__typename:"WebinarQuestion"})}))});n.writeQuery({variables:{webinarId:e},query:i.H,data:{webinar:r}})}catch(e){throw o.error("Webinar resolver fails to update webinar questions in cache."),e}}},87155:(e,t,n)=>{"use strict";n.d(t,{s:()=>d});var i=n(11235),a=n(2700),o=n(51924),r=n(80522);let s;const l=e=>s||(s=e.newLogger(i.k)),d={Mutation:{updateWebinarDetails:(e,{webinarId:t,detailsInput:n},{cache:i,loggerFactory:o})=>{l(o);try{const e=(0,r.O)(i,t),o=Object.assign(Object.assign({},e),{eventDetails:Object.assign(Object.assign(Object.assign({},e.eventDetails),n),{__typename:"WebinarDetails"})});return i.writeQuery({variables:{webinarId:t},query:a.H,data:{webinar:o}}),{_:!0,__typename:"Webinar"}}catch(e){throw s.error("Webinar resolver fails to update webinar details in cache."),e}},updateWebinarQuestions:(e,{webinarId:t,questionsInput:n},{cache:i,loggerFactory:a})=>(l(a),(0,r.a)(t,n,i,s),{_:!0,__typename:"Webinar"}),updateWebinarSpeakers:(e,{webinarId:t,speakersInput:n},{cache:i,loggerFactory:o})=>{l(o);try{const e=(0,r.O)(i,t),o=Object.assign(Object.assign({},e),{speakerBios:n.map((e=>Object.assign(Object.assign({},e),{__typename:"WebinarSpeakerBio"})))});return i.writeQuery({variables:{webinarId:t},query:a.H,data:{webinar:o}}),{_:!0,__typename:"Webinar"}}catch(e){throw s.error("Webinar resolver fails to update webinar speakers in cache."),e}},updateWebinarImage:(e,{webinarId:t,webinarImageInput:n},{cache:i,loggerFactory:a})=>{l(a);try{return i.writeQuery({variables:{webinarId:t},query:o.C,data:{webinarImage:{image:n.image,__typename:"WebinarImage"}}}),{_:!0,__typename:"Webinar"}}catch(e){throw s.error("Webinar resolver fails to update webinar image in cache."),e}}}}},73456:(e,t,n)=>{"use strict";n.d(t,{kn:()=>i,JF:()=>a,up:()=>o,rS:()=>r});const i=3,a=3,o=3,r="MicrosoftTeams-EmailPost.eml"},39302:(e,t,n)=>{"use strict";n.d(t,{Mv:()=>r,kO:()=>s,a2:()=>d,LH:()=>c});var i=n(13637),a=n(34255),o=n(25534);function r(e,t){return(0,i.mG)(this,void 0,void 0,(function*(){return l(e,t)}))}function s(e,t,n){return(0,i.mG)(this,void 0,void 0,(function*(){return l(e,t,n)}))}function l(e,t,n){return(0,i.mG)(this,void 0,void 0,(function*(){const i=(0,a.uniqBy)(e,(e=>e)),r=(0,a.chunk)(i.map((e=>e)),t.MAX_PEOPLE_MRI_LIMIT),s=yield Promise.all(r.map((e=>t.getPeopleProfilesByMris(e,n,!0,!1,!0))));let l=[];return s.forEach((e=>{l=l.concat(Array.from(e.values(),(e=>(0,o.ne)(e))))})),l}))}function d(e,t,n){return(0,i.mG)(this,void 0,void 0,(function*(){const i=(0,a.uniqBy)(e,(e=>e)),r=(0,a.chunk)(i.map((e=>e)),t.MAX_PEOPLE_MRI_LIMIT);return(yield Promise.all(r.map((e=>t.getPeopleProfilesIncludeFederatedByMris(e,!0,!1,n))))).map((e=>Array.from(e.values(),(e=>(0,o.ne)(e))))).reduce(((e,t)=>e.concat(t)),[])}))}function c(e,t,n){return(0,i.mG)(this,void 0,void 0,(function*(){const i=(0,a.uniqBy)(e,(e=>e)),r=(0,a.chunk)(i.map((e=>e)),t.MAX_PEOPLE_MRI_LIMIT);return(yield Promise.all(r.map((e=>t.getTflConsumerProfilesByMris(e,n||null))))).map((e=>Array.from(e.values(),(e=>(0,o.ne)(e))))).reduce(((e,t)=>e.concat(t)),[])}))}},46356:(e,t,n)=>{"use strict";n.d(t,{F:()=>o});var i=n(13637),a=n(32344);function o(e){let t;const n=()=>t&&t.return&&t.return();return new a.y((a=>{try{e().then((e=>{if(e.next instanceof Function){if(t=e,a.closed)return void n();!function(e,t){var n,a;(0,i.mG)(this,void 0,void 0,(function*(){const o={[Symbol.asyncIterator]:()=>e};try{try{for(var r,s=(0,i.KL)(o);!(r=yield s.next()).done;){const e=r.value;t.next(e)}}catch(e){n={error:e}}finally{try{r&&!r.done&&(a=s.return)&&(yield a.call(s))}finally{if(n)throw n.error}}t.complete()}catch(e){t.error(e)}}))}(e,a)}else a.next(e),a.complete()}),a.error.bind(a))}catch(e){a.error(e)}return n}))}},19272:(e,t,n)=>{"use strict";n.d(t,{N:()=>a});var i=n(89925);const a=e=>{if(e)switch(e){default:case"Success":return i.ChannelCrossPostStatus.Success;case"SendFailure":return i.ChannelCrossPostStatus.SendFailure;case"SendFailureCanRetry":return i.ChannelCrossPostStatus.SendFailureCanRetry;case"EditFailure":return i.ChannelCrossPostStatus.EditFailure;case"EditFailureCanRetry":return i.ChannelCrossPostStatus.EditFailureCanRetry;case"DeleteSingleFailure":return i.ChannelCrossPostStatus.DeleteSingleFailure;case"DeleteSingleFailureCanRetry":return i.ChannelCrossPostStatus.DeleteSingleFailureCanRetry;case"DeleteAllFailure":return i.ChannelCrossPostStatus.DeleteAllFailure;case"DeleteAllFailureCanRetry":return i.ChannelCrossPostStatus.DeleteAllFailureCanRetry}}},72080:(e,t,n)=>{"use strict";n.d(t,{xA:()=>ne,$M:()=>nt,FX:()=>ie,NL:()=>sn,AY:()=>Ct,pR:()=>ut,Gt:()=>Be,DP:()=>Ue,qJ:()=>Xt,C:()=>pt,MB:()=>Wt,uA:()=>Ve,fN:()=>rt,H4:()=>Me,zA:()=>Ke,dx:()=>je,Qq:()=>vt,vI:()=>ht,I6:()=>St,eY:()=>$t,zT:()=>gt,D1:()=>Ut,nI:()=>nn,rP:()=>Qt,eX:()=>Yt,UL:()=>Zt,Eu:()=>rn,wm:()=>tn,C6:()=>Kt,AK:()=>en,GE:()=>on,Go:()=>Gt,wX:()=>Ze,bv:()=>He,lg:()=>Et,yU:()=>We,aw:()=>qt,x6:()=>At,_$:()=>It,ph:()=>Ft,O5:()=>Mt,Hl:()=>Nt,_l:()=>Qe,sf:()=>tt,TK:()=>Oe,b_:()=>mt,FH:()=>ct,nF:()=>Tt,Th:()=>xe,eN:()=>Rt,l0:()=>Lt,Lr:()=>_t,it:()=>De,YX:()=>Ot,ob:()=>et,eH:()=>le,is:()=>be,ts:()=>Ce,YU:()=>Ee,_S:()=>Dt,zK:()=>Re,ac:()=>Ge,_V:()=>zt,iB:()=>Le,RU:()=>Ht,OB:()=>de,xT:()=>Vt,Pi:()=>Bt,SX:()=>mn});var i=n(13637),a=n(31821),o=n(85762),r=n(8302),s=n(18519),l=n(74300),d=n(78808),c=n(85350),u=n(96843),m=n(26863),g=n(68282),p=n(67462),h=n(18548),v=n(66695),S=n(38923),f=n(75068),y=n(34255),k=n(89925);const C="default",b="CallableChannelOboCall",T="callParkService",w=e=>"twoParty"===e?k.CallLogCallType.TwoParty:"multiParty"===e?k.CallLogCallType.MultiParty:k.CallLogCallType.Unknown,_=e=>{switch(e){case"default":return k.CallLogSessionType.Default;case"screenSharing":case"ScreenSharing":return k.CallLogSessionType.ScreenSharing;case"emergencyGroupCall":return k.CallLogSessionType.EmergencyGroupCall;default:return k.CallLogSessionType.Unknown}},I=e=>e?Object.assign(Object.assign({},e),{type:e.type||C}):void 0,A=e=>({type:e.type,configId:e.configId,onBehalfOf:e.onBehalfOf&&Object.assign({type:C},e.onBehalfOf),details:e.details&&Object.assign({type:C},e.details)}),N={__typename:"CallLogParticipant",displayName:"Unknown",id:"28:unknown",type:C},E=(e,t)=>{var n;if(!e)return"";const i='value="',a=null===(n=e.find((e=>e.indexOf(t)>=0)))||void 0===n?void 0:n.match(/value="(.*?)"/g);return a?a[0].substr(i.length,a[0].length-i.length-1):""},D=(e,t,n,i,a)=>{let o,r,s,l,c=(new Date).toISOString();if(a===d.Cs.CallTranscript){const t=((e,t)=>{if(t)try{const e=JSON.parse(unescape(t.replace(/\u200b|\\/g,"")));return{callId:e.callId,userParticipantId:e.originatorParticipantId,transcriptMsg:{scopeId:e.scopeId}}}catch(t){return void e.error("failed to parse transcription content.",t)}})(e,n);if(!t)return;o=t.callId,r=t.userParticipantId,s=t.transcriptMsg}else if(a===d.Cs.CallLogTranscript){const t=((e,t)=>{if(t)try{const e=JSON.parse(unescape(t.replace(/\u200b|\\/g,""))),{CallId:n,UserParticipantId:i,ThreadId:a,MessageId:o}=e;return{callId:n,userParticipantId:i,transcriptMsg:{linkedMessage:{conversationId:a,messageId:o}}}}catch(t){return void e.error("failed to parse transcription content.",t)}})(e,n);if(!t)return;o=t.callId,r=t.userParticipantId,s=t.transcriptMsg}else if(a===d.Cs.CallLogRecording){const t=((e,t)=>{if(t)try{const e=JSON.parse(unescape(t.replace(/\u200b|\\/g,""))),{CallId:n,UserParticipantId:i,ThreadId:a,MessageId:o}=e;return{callId:n,userParticipantId:i,recordingMsg:{linkedMessage:{conversationId:a,messageId:o}}}}catch(t){return void e.error("failed to parse recording message content.",t)}})(e,n);if(!t)return;o=t.callId,r=t.userParticipantId,l=t.recordingMsg}else if(a===d.Cs.CallRecording){const e=((e,t)=>{if(!e)return;const n=e.match(/<.*?>/g),i=E(n,'<Id type="callId"'),a=E(n,'<Id type="OriginatorParticipantId"'),o=E(n,"<RecordingInitiatorId ");return{callId:i,userParticipantId:a,recordingMsg:{conversationId:d.wS,messageId:t||"",initiatorId:o,content:e}}})(n,i);if(!e)return;o=e.callId,r=e.userParticipantId,l=e.recordingMsg}else o=t.callId,r=null==t?void 0:t.userParticipantId,c=t.startTime;return{callId:null!=o?o:"",userParticipantId:r,transcript:s,recordings:l&&[l],startTime:null!=c?c:""}},F=(e,t,n,i,a,o,r)=>{var s,l,d,c;if(U(t,n))return;const u=o.newLogger("CallHistoryHelper");try{const n=B(t),{applicationContent:o,callDirection:m,callState:g,callType:p,connectTime:h,endTime:v,isDeleted:S,messageId:f,originatorParticipant:y,participantList:C,sessionType:T,sharedCorrelationId:E,targetParticipant:F,threadId:P,spamProperties:O,onBehalfOfContext:U,callAttributes:W,forwardingInfo:G,transferInfo:V,sharedLineAppearanceActivated:H,sharedLineAppearanceParticipantList:$,targetDelegator:z}=n;let q;q=U&&!o?{type:b,configId:U.id,onBehalfOf:{type:(null===(s=null==W?void 0:W.onBehalfOf)||void 0===s?void 0:s.type)||b,id:null===(l=null==W?void 0:W.onBehalfOf)||void 0===l?void 0:l.id,displayName:null===(d=null==W?void 0:W.onBehalfOf)||void 0===d?void 0:d.displayName}}:o;const J=D(u,n,a,e,i);if(!J)return;let Q=I(y);Q||(Q=N,u.warn(`Could not parse valid participant from ${t}`));const K=(e=>{switch(e){case"missed":return k.CallLogCallState.Missed;case"accepted":return k.CallLogCallState.Accepted;case"declined":return k.CallLogCallState.Declined;case"acceptedElsewhere":return k.CallLogCallState.AcceptedElsewhere;default:return k.CallLogCallState.Unknown}})(g),Y=(e=>"incoming"===e?k.CallDirection.Incoming:"outgoing"===e?k.CallDirection.Outgoing:k.CallDirection.Unknown)(m),X=x(C,null==F?void 0:F.type,null==y?void 0:y.type,null===(c=null==W?void 0:W.transferor)||void 0===c?void 0:c.type,null==V?void 0:V.parkType),{validTargetParticipant:Z,forwarderParticipant:ee,forwardedTargetParticipant:te}=M(K,F,G,W,r,z),{transferorParticipant:ne,transferTargetParticipant:ie}=j(W,V,X);return Object.assign(Object.assign(Object.assign(Object.assign({applicationContent:q&&A(q),callDirection:Y,callState:K,callType:w(p),connectTime:h,endTime:v,isDeleted:S,messageId:f,originatorParticipant:Q,participantList:C?C.map(I):[],targetParticipant:Z,threadId:P,sessionType:_(T),sharedCorrelationId:null!=E?E:"",spamRiskLevel:O?O.riskLevel:null},J),{transferorParticipant:ne,transferTargetParticipant:ie,transferStatus:(null==V?void 0:V.transferStatus)&&R(V.transferStatus),forwarderParticipant:ee,forwardedTargetParticipant:te}),r&&L(n)),{isSharedLineAppearanceActivated:H,sharedLineAppearanceParticipantList:$?$.map(I):[]})}catch(e){u.warn(`UnhandledException in message transformation: ${e}`)}},P=e=>{const t={callHistoryInput:void 0,isSlaCallHistory:!1};return e&&(e["sla-call-history"]?(t.callHistoryInput=e["sla-call-history"],t.isSlaCallHistory=!0):e["call-log"]&&(t.callHistoryInput=e["call-log"])),t},M=(e,t,n,i,a,o)=>{let r,s,l=t&&I(t);return e===k.CallLogCallState.Accepted&&(null==n?void 0:n.acceptedBy)&&(r=a?o&&I(o):l,l=I(n.acceptedBy)),(null==i?void 0:i.forwardedFrom)&&(r=I(i.forwardedFrom)),(e===k.CallLogCallState.AcceptedElsewhere||a)&&(null==n?void 0:n.acceptedBy)&&(s=I(n.acceptedBy)),(null==i?void 0:i.delegator)&&(r=I(i.delegator)),{validTargetParticipant:l,forwarderParticipant:r,forwardedTargetParticipant:s}},j=(e,t,n)=>{let i,a;return n||((null==e?void 0:e.transferor)&&(i=I(e.transferor)),(null==t?void 0:t.transferor)&&(i=I(t.transferor)),(null==t?void 0:t.transferTarget)&&(a=I(t.transferTarget))),{transferorParticipant:i,transferTargetParticipant:a}},R=e=>{switch(e){case"transferred":return k.CallLogTransferStatus.Transferred;case"transferAccepted":return k.CallLogTransferStatus.TransferAccepted;case"transferFailed":return k.CallLogTransferStatus.TransferFailed;case"transferSucceeded":return k.CallLogTransferStatus.TransferSucceeded;default:return k.CallLogTransferStatus.Unknown}},x=(e,t,n,i,a)=>{const o=a&&"none"!==a&&"Unknown"!==a;return o||o&&!!(null==e?void 0:e.find((e=>e.type&&e.type===T)))||t===T||n===T||i===T},O=e=>{switch(e){case"immediate":return k.CallForwardingType.Immediate;case"simultaneous":return k.CallForwardingType.Simultaneous;default:return}},L=e=>{const{sharedLineAppearanceForwardType:t,originatorDelegator:n,targetDelegator:i}=e;return{isSharedLineAppearanceCallHistory:!0,forwardingType:O(t),originatorDelegator:n&&I(n),targetDelegator:i&&I(i)}},U=(e,t)=>void 0===t?!e:t!==d.wS,B=e=>e?JSON.parse(e):{};var W=n(84128),G=n(25534),V=n(28550),H=n(79058);const $=e=>{if(!e)return[];const t="meeting.scheduledMeetingInfo";let n=J(e,["startTime","endTime","eventType"],t);const{eventRecurrenceRange:i,eventRecurrencePattern:a}=e;return n=[...n,...z(i,t),...q(a,t)],n},z=(e,t)=>J(e,["startDate"],`${t}.eventRecurrenceRange`),q=(e,t)=>{let n=[];if(e){const{daily:i,weekly:a,monthly:o,yearly:r,relativeMonthly:s,relativeYearly:l}=e;n=[...J(e,["patternType"],`${t}.eventRecurrencePattern`),...J(i,["interval"],`${t}.eventRecurrencePattern.daily`),...J(a,["interval","daysOfTheWeek"],`${t}.eventRecurrencePattern.weekly`),...J(o,["interval","dayOfMonth"],`${t}.eventRecurrencePattern.monthly`),...J(r,["month","dayOfTheMonth"],`${t}.eventRecurrencePattern.yearly`),...J(s,["interval","dayOfTheWeekIndex","dayOfTheWeek"],`${t}.eventRecurrencePattern.relativeMonthly`),...J(l,["month","dayOfTheWeekIndex","dayOfTheWeek"],`${t}.eventRecurrencePattern.relativeYearly`)],a&&a.daysOfTheWeek&&a.daysOfTheWeek.some((e=>(0,y.isNil)(e)))&&n.push(`${t}.eventRecurrencePattern.weekly.daysOfTheWeek`)}return n},J=(e,t,n)=>{const i=[];return(0,y.isNil)(e)||t.forEach((t=>{(0,y.isNil)(e[t])&&i.push(`${n}.${t}`)})),i};var Q=n(36223);var K=n(19272);const Y="http://schema.skype.com/StarredMessage",X=p.F,Z=new Map([["sms",k.EscalationModality.SMS],["email",k.EscalationModality.Email],["call",k.EscalationModality.Call],["teamscall",k.EscalationModality.TeamsCall],["etnp",k.EscalationModality.ETNP]]),ee=new Set(["RichText/Media_CallRecording","RichText/Media_CallTranscript","Event/Call"]);var te;!function(e){e.FAMILY="family",e.FRIENDS="friends",e.PROJECT="projectCoord",e.WORKPLACE="company",e.TRIP_PLANNING="tripPlanning",e.GET_TOGETHER="getTogether",e.LOCAL_COMMUNITY="localCommunity",e.HOLIDAY_PLANNING="holidayPlanning"}(te||(te={}));const ne="preview-",ie="newchat",ae="deeplink",oe=(e,t,n=!1)=>{if(!(null==e?void 0:e.emotions))return null;const i=e.emotions.map((({key:e,users:t})=>({key:e,users:t.map((({mri:e,time:t,value:n})=>({id:X(e),time:t,value:n}))).sort(((e,t)=>e.time-t.time))})));return n&&i.sort(((e,n)=>{var i,a,o,r,s,l;return(null!==(o=null!==(a=null===(i=null==t?void 0:t.emotions)||void 0===i?void 0:i[n.key])&&void 0!==a?a:n.users.length)&&void 0!==o?o:0)-(null!==(l=null!==(s=null===(r=null==t?void 0:t.emotions)||void 0===r?void 0:r[e.key])&&void 0!==s?s:e.users.length)&&void 0!==l?l:0)})),i},re=e=>{if(!e||!e.emotions)return null;const t=e.emotions;return Object.keys(t).map((e=>({key:e,count:t[e]})))},se=e=>{if(!e||!e.escalations)return null;return JSON.parse(e.escalations).map((({key:e,users:t})=>({key:Z.get(e),users:t.map((({mri:e,time:t,value:n})=>({mri:X(e),time:t,value:n})))})))},le=(e,t)=>e&&e.mentions?ue(e.mentions,t):null,de=(e,t)=>e&&e.onbehalfof?ue(e.onbehalfof,t):null,ce=(e,t)=>{if(!t||!t.atp)return null;const n=t.atp;try{return"string"==typeof n?JSON.parse(n):n}catch(t){return e.newLogger("Chat Helper").log(`UnhandledException in toAtpSharepointData: ${t}`),null}},ue=(e,t)=>{const n="string"==typeof e?JSON.parse(e):e;return n?n.map((({itemid:e,mri:n,displayName:i,mentionType:a})=>({id:`${t}_${e}_${n}`,userId:n,itemId:e,displayName:i,mentionType:a}))):null},me=e=>{if(!e||!e.files)return null;try{let t=JSON.parse(null==e?void 0:e.files);return t=t.filter((e=>e.type===ae)),t.map((({id:e,title:t,fileInfo:n,channelId:i,state:a})=>({id:e,title:t,state:a,serverRelativeUrl:n.serverRelativeUrl,channelId:i,siteUrl:n.siteUrl,objectUrl:n.fileUrl})))}catch(e){return null}},ge=(e,t)=>{if(!e||!e.files)return null;try{let n=JSON.parse(e.files);n=n.filter((e=>e.type!==ae));return(0,y.map)(n,(e=>pe(e,t)))}catch(e){return null}},pe=(e,t)=>{{const n=2,i=["http","https"],{filePreview:a,chicletBreadcrumbs:o,fileInfo:r,anchorFileId:s,progressComplete:l,isUploadError:d,fileChicletState:c,providerData:u}=e,{shareUrl:m,shareId:g,itemId:p}=r,v=a||{},S=null==c?void 0:c.serviceName,{id:f,baseUrl:y,objectUrl:C,type:b,title:T,state:w}=ke(e,n),_="active"!==w&&"hidden"!==w,I=ve(u,t);return Object.assign({id:f,itemId:p,chicletBreadcrumbs:o,baseUrl:(0,h.Nm)(y,i),objectUrl:(0,h.Nm)(C,i),shareId:g,shareUrl:m,type:b,title:T,fileId:f,isReferencedFile:_,anchorFileId:s,progressComplete:l&&parseInt(l,10)||null,serviceName:S&&k.FileViewServiceName[S],state:w&&k.FileChicletState[w],hasUploadFailed:d,providerDataV2:I},v)}},he=e=>{if(!e)return null;try{const t=function(e){const t=e.startsWith("?")||e.startsWith("#");e=t?e.substring(1):e;const n={};return e.split("&").forEach((e=>{const[t,i]=e.split("=");n[t]=decodeURIComponent((i||"").replace(/^.+?(=)/,""))})),n}(e);return t.languages.split(":")[0]}catch(e){return null}},ve=(e,t)=>{try{const t=JSON.parse(e);if(!t||!t.code)return;const n=Se(t.code);return{code:n,type:ye(parseInt(t.type,10))}}catch(e){return void t.newLogger("Chat Helper").log(`UnhandledException in message transformation: ${e}`)}},Se=e=>{switch(e){case k.ExternalCloudStorageProviderCode.BOX:return k.ExternalCloudStorageProviderCode.BOX;case k.ExternalCloudStorageProviderCode.DROPBOX:return k.ExternalCloudStorageProviderCode.DROPBOX;case k.ExternalCloudStorageProviderCode.EGNYTE:return k.ExternalCloudStorageProviderCode.EGNYTE;case k.ExternalCloudStorageProviderCode.GOOGLEDRIVE:return k.ExternalCloudStorageProviderCode.GOOGLEDRIVE;case k.ExternalCloudStorageProviderCode.SHAREFILE:return k.ExternalCloudStorageProviderCode.SHAREFILE;default:throw new Error("Invalid provider code")}};var fe;!function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WOPI=1]="WOPI",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(fe||(fe={}));const ye=e=>{switch(e){case fe.Sharepoint:return k.FilesProviderType.Sharepoint;case fe.WOPI:return k.FilesProviderType.WOPI;case fe.Google:return k.FilesProviderType.Google;case fe.OneDrive:return k.FilesProviderType.OneDrive;case fe.Recent:return k.FilesProviderType.Recent;case fe.Aggregate:return k.FilesProviderType.Aggregate;case fe.FileSystem:return k.FilesProviderType.FileSystem;case fe.Search:return k.FilesProviderType.Search;case fe.AllFiles:return k.FilesProviderType.AllFiles;case fe.SharedWithMe:return k.FilesProviderType.SharedWithMe;default:throw new Error("Not a valid provider type")}},ke=(e,t)=>{var n;const{version:i}=e;let{id:a,baseUrl:o,objectUrl:r,type:s,title:l,state:d}=e;if(i!==t&&(({itemid:a,fileName:l,fileType:s,fileInfo:{fileUrl:r,siteUrl:o}}=e),d=null===(n=e.fileChicletState)||void 0===n?void 0:n.state),"string"!=typeof a)throw(0,S.Tr)("ChatHelpers",f.jK.Undefined,"toFiles",{id:a,version:i,type:s},"File id is missing");return{id:a,baseUrl:o,objectUrl:r,type:s,title:l,state:d}},Ce=e=>JSON.stringify((0,y.map)(e,(({id:e,itemId:t,baseUrl:n,type:i,title:a,objectUrl:o,previewUrl:r,shareUrl:s,shareId:l,state:d,chicletBreadcrumbs:c,serviceName:u,previewHeight:m,previewWidth:g,progressComplete:p,hasUploadFailed:h,externalFileShareInfo:v})=>({itemid:e,fileName:a,fileType:i,fileInfo:{itemId:t,fileUrl:o,siteUrl:n,serverRelativeUrl:"",shareUrl:s,shareId:l},fileChicletState:{serviceName:u,state:d},"@type":"http://schema.skype.com/File",version:2,id:e,baseUrl:n,objectUrl:o,type:i,title:a,state:d,chicletBreadcrumbs:c,providerData:v,botFileProperties:{},isUploadError:h,progressComplete:p,filePreview:{previewUrl:r,previewHeight:m,previewWidth:g}})))),be=e=>e&&JSON.stringify((0,y.map)(e,(e=>{var{content:t}=e,n=(0,i._T)(e,["content"]);return Object.assign(Object.assign({},n),{content:JSON.parse(t)})}))),Te=(e,t)=>{if(!e||!e.links)return{urlPreview:null,embeddedLinks:null};try{const t=["http","https"],n=JSON.parse(e.links),i=[],a=[];return n.forEach((e=>{we(e,i,t),_e(e,a,t)})),{urlPreview:a.length>0?a[0]:null,embeddedLinks:i}}catch(e){return t.newLogger("Chat Helper").log(`UnhandledException in message transformation: ${e}`),{urlPreview:null,embeddedLinks:null}}},we=(e,t,n)=>{const{url:i,fileShareUrlMeta:a,title:o,description:r}=e,s=(0,h.Nm)(i,n);a&&t.push({objectUrl:s,title:o,description:r,fileShareUrlMeta:a})},_e=(e,t,n)=>{const{url:i,preview:a,previewenabled:o}=e,{previewurl:r,previewmeta:s,title:l,description:d}=a||{},c=(0,h.Nm)(i,n);t.push({url:c,thumbnail:(0,h.Nm)(r,n),title:l,description:d,previewEnabled:o,thumbnailMeta:s?{width:s.width,height:s.height}:null})},Ie=(e,t,n)=>{if(!t||!t.cards)return null;try{let e=t.cards;n&&(e=n);return JSON.parse(e).map((({appIcon:e,appId:t,appName:n,cardClientId:i,content:a,contentType:o,locale:r,userSpecificContent:s})=>Object.assign({appIcon:e,appId:t||"",appName:n,cardClientId:i,content:JSON.stringify(a),contentType:o,locale:r},!!s&&{userSpecificContent:s})))}catch(t){return e.newLogger("Chat Helper").log(`UnhandledException in toCards: ${t}`),null}},Ae=(e,t,n,i)=>{let a=i&&i.policyViolation;const o=i&&i.genericStreamMetadata;if(!a&&!o)return null;const r={};if("string"==typeof a)try{a=JSON.parse(a)}catch(n){e.newLogger("Chat Helper").log(`Exception in parsing PolicyViolation in message: ${t}. Error: ${n}`)}a&&(r.policyViolation=a);let s=o&&o.policyTip;if("string"==typeof o)try{s=JSON.parse(o).policyTip}catch(n){e.newLogger("Chat Helper").log(`Exception in parsing policy tip in message: ${t}. Error: ${n}`)}return s&&(r.dlpData={id:t,content:n,policyTip:s}),r},Ne=e=>{if(!e.scheduledmeetinginfo||(0,y.isNil)(e.scheduledmeetinginfo.eventType))return null;const t=e.scheduledmeetinginfo,{iCalUid:n}=t,a=(0,i._T)(t,["iCalUid"]);return Object.assign({iCalUID:n},a)},Ee=e=>{const{itemId:t,meetingTitle:n,meetingActionType:a,scheduledMeetingInfo:o}=e,r=(0,i._T)(e,["itemId","meetingTitle","meetingActionType","scheduledMeetingInfo"]),s=Object.assign(Object.assign(Object.assign({},r),(e=>{const{iCalUID:t}=e,n=(0,i._T)(e,["iCalUID"]);return{scheduledmeetinginfo:Object.assign(Object.assign({},n),{iCalUid:t})}})(o)),{itemid:t,meetingtitle:n,"@type":a});return JSON.stringify(s)},De=(e,t)=>{if(!t||!t.meeting)return null;try{const e=JSON.parse(t.meeting),{organizerId:n,tenantId:i,meetingJoinUrl:a,location:o,itemid:r,meetingtitle:s,rsvpTo:l,body:c}=e;return(e=>{const{scheduledMeetingInfo:t}=e,n=$(t);if(n.length)throw(0,S.Tr)(f.w5.DataLayerClient,f.jK.MissingParameter,`validate Meeting schema failed. Missing required prop(s): ${n.join(", ")}`);return e})({meetingActionType:e[d.BM.MeetingType],organizerId:n,tenantId:i,meetingJoinUrl:a,location:o,itemId:r,meetingTitle:s,rsvpTo:l,body:c,scheduledMeetingInfo:Ne(e)})}catch(t){return e.newLogger("Chat Helper").log(`UnhandledException in toMeeting: ${t}`),null}},Fe=(e,t,n,i)=>{const a=t||n;if(a)return a;if(i&&ee.has(e)){const e=i.match(/<id type="callId"[^>]*?\svalue="([^"]+?)"/i);return e&&e[1]||null}return null},Pe=(e,t)=>"-1"===e?t:e,Me=(0,l.Z)((e=>new Intl.Collator(e,{numeric:!1,sensitivity:"accent"}))),je=(e,t,n)=>{const i=((e,t)=>{if(e.length<=1)return e;const n=Me(t),i=[...e];return i.sort(((e,t)=>n.compare(e.displayName||"",t.displayName||""))),i})(e,n),a=[],o=[];return(0,y.forEach)(i,(e=>{const{id:n,displayName:i}=e;if(n!==t&&!H.eo.isTFLOffNetworkUser(n)&&i){if(o.push(i),20===o.length)return!1;a.length<3&&a.push(e)}return!0})),{membersLimited:a,memberDisplayNamesLimited:o}},Re=(e,t,n,i,a,o)=>{var s;if(!(null==e?void 0:e.id))return;const l=xe(e,t,i,a,n,!!o),{id:d,clientmessageid:c,messagetype:m,properties:g,callId:p,skypeguid:h,composetime:v,content:S,conversationid:f,draftDetails:y,crossPostData:k}=e,C=(0,u.kw)(y),{callHistoryInput:b,isSlaCallHistory:T}=P(g);return Object.assign(Object.assign({},l),{__typename:"Message",interopDeliveryState:un(null==g?void 0:g.deliveryState),smsDeliveryReports:g&&g.smsDeliveryReports?g.smsDeliveryReports:null,announcement:He(g),escalations:se(g),notification:ln(t,g),notifications:cn(t,g),meeting:De(t,g),onBehalfOf:de(g,d),callId:Fe(m,p,h||g&&g.skypeguid,S),callLog:g&&F(Pe(d,c),b,f,m,S,t,T),skypeguid:h,composeTime:v,isCallStartedMessage:(0,r.LY)(S,m),replyPermission:null!==(s=null==g?void 0:g.replyPermission)&&void 0!==s?s:null,atpSharepointData:ce(t,g),isDeletedByAdmin:(null==g?void 0:g.adminDelete)||!1,suggestedActions:(null==g?void 0:g.suggestedActions)||null,scheduledSendTime:C?new Date(C).toISOString():null,draftId:(null==g?void 0:g.draftId)||(C?null==l?void 0:l.id:null),conversationId:f,crossPostStatus:k?(0,K.N)(k.status):void 0,crossPostFailedChannels:null==k?void 0:k.failedChannels})},xe=({id:e,content:t,originalarrivaltime:n,from:i,messagetype:a,annotationsSummary:o,userHasStarred:r,properties:s,clientmessageid:l,version:d,imdisplayname:u,translation:m},g,p,h,v,S=!1)=>{let f=t;p&&(f=p);const y=Ie(g,s,h),C=(e=>{const{body:t,subject:n,title:i,toggled:a,detectedLanguageName:o,sourceLanguageCode:r,targetLanguageCode:s,error:l}=e||{};return(void 0!==t||void 0!==l)&&o&&r&&s?{translationStatus:(()=>{if(!a)return k.TranslationStatusV2.ShowOriginalMessage;if(!l)return k.TranslationStatusV2.Done;switch(l){case c.AO.Success:return k.TranslationStatusV2.Done;case c.AO.SkipTranslation:return k.TranslationStatusV2.TranslationNotNeeded;case c.AO.MessageNotFound:return k.TranslationStatusV2.MessageNotFound;case c.AO.VersionNotFound:return k.TranslationStatusV2.VersionNotFound;case c.AO.LanguageDetectionFailed:return k.TranslationStatusV2.LanguageDetectionFailed;case c.AO.UnsupportedSourceLanguage:return k.TranslationStatusV2.UnsupportedSourceLanguage;default:return k.TranslationStatusV2.UnknownError}})(),translatedSubject:n,translatedContent:t,translatedTitle:i,sourceLanguageName:o,sourceLanguageCode:r}:void 0})(m),b=(null==C?void 0:C.translationStatus)===k.TranslationStatusV2.Done?(0,Q.M)()[0].toString():d;return Object.assign(Object.assign(Object.assign({id:Pe(e,l),content:f,originalArrivalTime:n,from:X(i),messageType:ze(g,a,s),isImportant:(0,W.wU)(null==s?void 0:s.importance),importance:(0,W.gy)(null==s?void 0:s.importance),emotionsSummary:re(o),emotions:oe(s,o,S),mentions:le(s,e),cards:y,files:ge(s,g),deeplinks:me(s)},Te(s,g)),{deleteTime:null==s?void 0:s.deletetime,editTime:null==s?void 0:s.edittime,version:b,userHasSaved:r,imDisplayName:u,clientMessageId:l,dlpContext:Ae(g,e,t,s),atpSharepointData:ce(g,s),status:v||k.MessageStatus.Delivered,hardDeleteReason:null==s?void 0:s.hardDeleteReason,hardDeleteTime:null==s?void 0:s.hardDeleteTime,onBehalfOf:de(s,e),sourceLanguageCode:he(null==s?void 0:s.languageStamp)}),C)},Oe=({content:e,id:t,messageType:n,originalArrivalTime:i,type:a,version:o})=>({__typename:"Message",content:e,id:t,messageType:n,originalArrivalTime:new Date(i).toISOString(),type:a,version:o}),Le=(e,t,n)=>{const i=Re(e,t,zt(e.state),void 0,void 0,!!(null==n?void 0:n.shouldSortReactions));if(!i)throw(0,S.Tr)("ChatHelpers",f.jK.Undefined,"toNewMessageSchema",{resource:e},"Bad shaped NewMessage");let a=null;if(e&&e.conversationLink){const t=(0,u.P5)(e);a=t===i.id?null:t}return{convId:e.conversationid||(0,u.o_)(e),replyChainId:a,threadType:e.threadtype,threadTopic:e.threadtopic,message:i}};function Ue(e,t){return{__typename:"Message",content:"",messageType:"Text",id:e,originalArrivalTime:t,imDisplayName:null,from:null,deleteTime:null,files:null,cards:null,embeddedLinks:null,callId:null,replyPermission:null,onBehalfOf:null,atpSharepointData:null,deeplinks:null,version:null,importance:null,interopDeliveryState:null,smsDeliveryReports:null,suggestedActions:null,emotions:null,emotionsSummary:null,escalations:null,mentions:null,status:null,diagnosticInfo:null,clientMessageId:e,urlPreview:null,dlpContext:null,editTime:null,deletionInfo:null,translation:null,userHasSaved:null}}function Be(e,t){return{__typename:"ConsumptionHorizon",id:e,originalArrivalTime:t,timeStamp:t,clientMessageId:(0,V.K)()}}function We(e){const t=new Date,n=t.toISOString(),i=t.getTime().toString();return Object.assign(Object.assign({},{members:[],membersLimited:[],activeCallsCount:null,canBeDiscarded:null,canBeFavorited:null,canBeHidden:null,botMembers:null,canBeLeft:null,canBeMuted:null,canBePinned:null,canBotBeBlocked:null,canManageApps:null,canPopOut:null,canTagContact:null,chatSubType:null,isDisabled:!1,isOneOnOne:!1,isOneOnOneBotChat:!1,isRead:!0,datatid:null,displayName:null,hasActions:null,hasActiveCalls:null,hasFailedMessages:null,isBotBlocked:null,isBotUser:null,isContactTagged:null,isFederated:!1,isHidden:null,isHighImportance:null,isLastMessageFromMe:null,isLastMessageText:null,isMeeting:!1,isMuted:null,isNewChat:!0,isSfB:!1,isUrgentImportance:null,lastMessageSender:null,isUserMember:!0,creator:null,meetingInformation:null,userConsumptionHorizon:null,consumptionHorizonBookmark:null,lastMessageTime:null,lastContentMessageTime:null,longTitle:null,messagePreview:null,messagePreviewAria:null,otherMemberMris:null,pictureGroup:null,pictureUpn:null,pinnedIndex:null,plGroupKey:null,presenceSource:null,showAtMention:null,showMarkers:null,tooltipTitle:null,substrateGroupId:null}),{__typename:"Conversation",id:e,memberIds:[],memberDisplayNamesLimited:[],nonTeamsFederatedUserLimitedNames:[],hasFederatedUser:!1,chatHistoryHiddenTime:null,hasTflConsumerUser:!1,hasEnterpriseUser:!1,hasUnknownConsumerUser:!1,hasUnknownEnterpriseUser:!1,hasTflSmsUnverifiedUser:!1,hasTflSmsVerifiedUser:!1,tflOffNetworkUser:null,cfet:!1,consumerGroupId:null,tenantId:null,title:"",hasBotMember:!1,hasUnresolvedFederatedUser:!1,isChatDisabledForRecipients:!1,typingUsers:[],isPrivateChatPolicyDefinedScenario:null,meetingChatPolicy:null,me:null,tflOffNetworkUserLength:null,nonTeamsFederatedUsers:[],nonTeamsFederatedUsersLength:0,chatType:k.ChatType.Chat,type:k.ChatType.Chat,lastMessage:Ue(i,n),consumptionHorizon:Be(e,n),addedBy:null,addedByTenantId:null})}const Ge=(e,t,n,a=!1)=>{var{annotationsSummary:o,id:r,from:s,messageType:l,properties:d,version:c}=e,u=(0,i._T)(e,["annotationsSummary","id","from","messageType","properties","version"]);if(!r)return null;const{callHistoryInput:m,isSlaCallHistory:g}=P(d);try{return Object.assign(Object.assign(Object.assign({__typename:"Message",id:r,from:s,messageType:ze(n,l,d),version:(0,y.isNumber)(c)?c.toString():void 0,isImportant:(0,W.wU)(d&&d.importance),importance:(0,W.gy)(d&&d.importance),interopDeliveryState:un(null==d?void 0:d.deliveryState),smsDeliveryReports:(null==d?void 0:d.smsDeliveryReports)||null,emotions:oe(d,o,a),emotionsSummary:re(o),announcement:He(d),escalations:se(d),mentions:le(d,r),onBehalfOf:de(d,r),cards:Ie(n,d),files:ge(d,n),deeplinks:me(d)},Te(d,n)),{deleteTime:d&&d.deletetime,editTime:d&&d.edittime,isDeletedByAdmin:d&&d.adminDelete,scheduledSendTime:(null==d?void 0:d.sendAt)||null,draftId:(null==d?void 0:d.draftId)||null,hardDeleteTime:d&&d.hardDeleteTime,hardDeleteReason:d&&d.hardDeleteReason,suggestedActions:(null==d?void 0:d.suggestedActions)||null,status:k.MessageStatus.Delivered,dlpContext:Ae(n,r,u.content,d),meeting:De(n,d),callId:d&&d.skypeguid,callLog:d&&F(r,m,t,l,u.content,n,g),sourceLanguageCode:he(null==d?void 0:d.languageStamp)}),u)}catch(e){return n.newLogger("Chat Helper").log(`UnhandledException in message transformation: ${e}`),Object.assign({id:r,from:s,messageType:ze(n,l,d),isImportant:null,emotions:null,mentions:null,files:null,announcement:null,urlPreview:null,deleteTime:null,status:null},u)}},Ve=({originalArrivalTime:e,timeStamp:t,clientMessageId:n})=>({originalArrivalTime:new Date(e).toISOString(),timeStamp:new Date(t).toISOString(),clientMessageId:n}),He=e=>{const t={title:"",originalImageUrl:null,croppedImageUrl:null,colorTheme:null};if(!e)return t;const n="string"==typeof e.cards?JSON.parse(e.cards):e.cards;if(!n||0===n.length)return t;const i=n.find((e=>"application/vnd.microsoft.teams.messaging-announcementBanner"===e.contentType));if(!i)return t;const a=$e(i);return{title:e.title?e.title:"",originalImageUrl:a.originalImageUrl,croppedImageUrl:a.croppedImageUrl,colorTheme:a.colorTheme,croppedImageHeight:a.croppedImageHeight,croppedImageWidth:a.croppedImageWidth,isTeamsIllustration:a.isTeamsIllustration}},$e=e=>{let t=(0,y.get)(e,"content.imageData.origImage.src",null),n=(0,y.get)(e,"content.imageData.croppedImage.src",null);const i=(0,y.get)(e,"content.imageData.croppedImage.imageHeight",null),a=(0,y.get)(e,"content.imageData.croppedImage.imageWidth",null),o=(0,y.get)(e,"content.imageData.isTeamsIllustration",null);let r=(0,y.get)(e,"content.imageData.colorTheme",null)||(0,y.get)(e,"content.colorTheme",null);return t=void 0===t?null:t,n=void 0===n?null:n,r=void 0===r?null:r,{originalImageUrl:t,croppedImageUrl:n,croppedImageHeight:i,croppedImageWidth:a,colorTheme:r,isTeamsIllustration:o}},ze=(e,t,n)=>{if(t===d.Cs.HTML){if(qe(e,n))return d.Cs.Collaborate;if(Je(e,n))return d.Cs.Embed}return t},qe=(e,t)=>{const n=Ie(e,t);if(!n)return!1;const i=(0,y.find)(n,(e=>"application/vnd.microsoft.card.fluid"===e.contentType));if(!i)return!1;return!!JSON.parse(i.content).componentUrl},Je=(e,t)=>{const n=Ie(e,t);if(!n)return!1;const i=(0,y.find)(n,(e=>"application/vnd.microsoft.card.fluidEmbedCard"===e.contentType));if(!i)return!1;return!!JSON.parse(i.content).componentUrl},Qe=(e,t)=>{if(!t||(0,y.isEmpty)(t))return null;const[n,i,a]=t.split(";"),o=parseInt(n,10),r=parseInt(i,10);return isNaN(o)||isNaN(r)?null:Object.assign({id:e},Ve({originalArrivalTime:o,timeStamp:r,clientMessageId:a}))},Ke=e=>(null==e?void 0:e.userConsumptionHorizon)||(null==e?void 0:e.consumptionHorizonBookmark)||null,Ye=(e,t,n)=>{try{const n=Xe(t),i=null==n?void 0:n.map((t=>({activityReplyToId:t.replyToId,activityTimestamp:t.timestamp,convId:e,suggestedReplies:t.suggestedActions.actions.filter((e=>{var t,n;return(null===(t=null==e?void 0:e.channelData)||void 0===t?void 0:t.id)&&(null===(n=null==e?void 0:e.channelData)||void 0===n?void 0:n.utcTime)})).map((e=>{var n,i;const a={targetMessageId:(null===(n=null==e?void 0:e.channelData)||void 0===n?void 0:n.targetMessageId)||t.replyToId,type:(null===(i=null==e?void 0:e.channelData)||void 0===i?void 0:i.type)||"reply"};return{suggestionChannelData:Object.assign(Object.assign({},null==e?void 0:e.channelData),a),value:e.value,whisperId:t.id}}))})));return i&&0!==i.length?{suggestedRepliesCollections:i}:null}catch(e){return n.newLogger("Chat Helper").error(`formatQuickReplyAugmentationFromObject: Exception in parsing quick reply augmentation. Error: ${e}`),null}},Xe=e=>{const t=e&&e.suggestedActivities&&e.suggestedActivities.filter((e=>{var t,n,i;return(null==e?void 0:e.type)===d.uV&&(null===(t=null==e?void 0:e.from)||void 0===t?void 0:t.id)===d.ZI&&(null==e?void 0:e.timestamp)&&(null===(i=null===(n=null==e?void 0:e.suggestedActions)||void 0===n?void 0:n.actions)||void 0===i?void 0:i.some((e=>e.type===d.qC||e.type===d.DC)))}));return t&&0!==t.length?t:null},Ze=(e,t,n)=>{const i=t&&t[d.Ff.SmartReplies];return i&&"string"==typeof i?((e,t,n)=>{try{const i=JSON.parse(t);return Ye(e,i,n)}catch(e){return n.newLogger("Chat Helper").error(`formatQuickReplyAugmentationFromString: Exception in parsing quick reply augmentation. Error: ${e}`),null}})(e,i,n):null},et=e=>{switch(e){case c.wJ.None:return k.MeetingType.Unknown;case c.wJ.Adhoc:return k.MeetingType.Adhoc;case c.wJ.Scheduled:return k.MeetingType.Scheduled;case c.wJ.Recurring:return k.MeetingType.Recurring;case c.wJ.Broadcast:return k.MeetingType.Broadcast;case c.wJ.MeetNow:return k.MeetingType.MeetNow}},tt=e=>e&&e.map((e=>({id:e.id,originalArrivalTime:e.consumptionhorizon,messageVisibilityTime:e.messageVisibilityTime})))||null;var nt;function it(e,t){if(!e||!t)return!1;return(0,m.hu)(e,t)>0}function at(e,t,n,i,o,r,s=!1,l=!1,d,c,m,g){const p=pt(e,n),h=e.find((({id:e})=>e===t))||null,v=Ht(e),S=(0,u.iK)(e,r,[]).members||[],f=function(e,t,n,i,o){const r=!(null==o?void 0:o.get(a.J.CdlWorker).disableLastMessageSenderCache);let s=i;switch(void 0===s&&(s=r?nt.Cache:nt.Runtime),s){case nt.Noop:return null;case nt.CacheOrNoop:return t&&t.id===n?t:null;case nt.Cache:return t&&t.id===n?t:e.find((({id:e})=>e===n));case nt.Runtime:return e.find((({id:e})=>e===n))}}(S,d,o,c,m);return Object.assign(Object.assign(Object.assign(Object.assign({memberIds:S.map((({id:e})=>e))},je(S,t,i)),ut(p)),Ct(t,S)),{me:h,isUserMember:!!h,lastMessageSender:f,tflOffNetworkUser:(0,y.first)(v),tflOffNetworkUserLength:v.length,hasBotMember:S.some((({id:e})=>(0,u.bl)(e))),hasFederatedUser:!!p.length||s,hasTflConsumerUser:vt(S)||l,hasEnterpriseUser:kt(S),hasUnknownEnterpriseUser:yt(S),hasUnknownConsumerUser:ft(S),hasUnresolvedFederatedUser:p.some(H.eo.isUnknownUser),hasTflSmsUnverifiedUser:ht(S),hasTflSmsVerifiedUser:St(S),isRetentionHorizonSet:it(g,m)})}!function(e){e[e.Noop=0]="Noop",e[e.Cache=1]="Cache",e[e.CacheOrNoop=2]="CacheOrNoop",e[e.Runtime=3]="Runtime"}(nt||(nt={}));const ot=e=>{switch(typeof e){case"string":return"true"===e.toLowerCase()}return e};function rt(e){const t=Object.keys(null!=e?e:{}).filter((e=>e.includes(d.Q5.Liveness))).map((t=>({key:t,value:String(e[t])})));return(0,y.isEmpty)(t)?null:t}function st(e,t,n,i,o,r,s,l){var g,p,h,v,S,f;const{id:y,lastMessage:k}=e;let C;const b=!!(null===(p=null===(g=null==n?void 0:n.get(a.J.Messaging).expandedReactionsConfigs)||void 0===g?void 0:g.chat)||void 0===p?void 0:p.enableSend);k&&(C=_t(Re(k,i,void 0,void 0,void 0,b)));const T=!!(0,m.YP)(e),w=at(t,(null==r?void 0:r.id)||"",o,s,null==C?void 0:C.from,e.threadProperties,null===(h=e.usersProps)||void 0===h?void 0:h.hasFederatedUser,null===(v=e.usersProps)||void 0===v?void 0:v.hasConsumerUser,e.lastMessageSender,l,n,e);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),w),function(e,t){const{id:n,properties:i,threadProperties:a}=e,o=Qe(n,Ke(e.properties));return{chatSubType:Ft(a.threadType),chatType:Mt(a.threadType),consumptionHorizon:Qe(n,i[d.Ff.ConsumptionHorizon]),consumptionHorizonBookmark:o,quickReplyAugmentation:Ze(n,i,t),creator:a[d.Q5.Creator],importState:wt(a[d.Q5.ImportState]),isDisabled:Ut(a.isDisabled),disabledReason:Tt(a.disabledReason),isLastMessageFromMe:a.isLastMessageFromMe,isRead:a.isRead,meetingInformation:Ft(a.threadType)===c.k2.Channel?void 0:Gt(n,a[d.Q5.Meeting]),tenantId:a[d.Q5.TenantId],title:a.topic,userConsumptionHorizon:o,interopConversationStatus:Rt(i[d.Ff.InteropConversationStatus]),gapDetectionEnabled:ot(a.gapDetectionEnabled),cfet:gt(a.cfet),consumerGroupId:a[d.Q5.ConsumerGroupId],guardianChatInfo:a[d.Q5.GuardianChatInfo],groupTemplate:an(a[d.Q5.GroupTemplate]),themeId:a[d.Q5.ThemeId],picture:a[d.Q5.Picture],addedBy:(null==i?void 0:i.addedBy)||null,addedByTenantId:(null==i?void 0:i.addedByTenantId)||null,meetingChatPolicy:Ot(a[d.Q5.MeetingChatPolicy]),chatScheduleSuggestionSuppressUntil:null==i?void 0:i.chatScheduleSuggestionSuppressUntil}}(e,i)),lt(e.memberProperties)),{shortTitle:null===(S=e.chatTitle)||void 0===S?void 0:S.shortTitle,longTitle:null===(f=e.chatTitle)||void 0===f?void 0:f.longTitle,id:y,isMuted:(0,m.tl)(e),isOneOnOne:T,isOneOnOneBotChat:T&&w.hasBotMember,isFederated:Yt(y),isMeeting:(0,u.e9)(y),isSfB:Kt(y),lastMessage:C,awarenessLiveState:rt(e.threadProperties),members:[],clearHistoryTime:(0,m.dO)(e,n).toString(),chatHistoryHiddenTime:e.properties.historyHiddenTime,type:null}),Vt(e.threadProperties.pinnedItems))}const lt=e=>{const t=null==e?void 0:e[d.e0.RelationshipState];return{extendedDirectoryRedemptionRequired:null==t?void 0:t.edRedemptionRequired}},dt=(e,t)=>(0,y.map)(t,(t=>e[t.id]||function(e){return(0,G.ne)(Object.assign(Object.assign({},e),{mri:e.id,objectId:"",type:"",userPrincipalName:"",isMuted:e.isReader,displayName:e.friendlyName}))}(t))),ct=(e,t,n,i,a,o,r,s)=>{try{return st(e,dt(t,e.members),n,i,a,o,r,s)}catch(t){return i.newLogger("Chat Helper").log(`UnhandledException in toConversationSchemaFromSkypeConversationLocal transformation: ${t}`),Object.assign(Object.assign({},e),{id:e.id,isUserMember:!1,members:[],membersLimited:[],memberDisplayNamesLimited:[],type:null})}},ut=e=>{const t=e.filter((e=>{var t;return!H.eo.isUnknownUser(e)&&(null===(t=e.featureSettings)||void 0===t?void 0:t.coExistenceMode)!==s.hN.TeamsOnly&&!!e.displayName}));return{nonTeamsFederatedUserLimitedNames:t.slice(0,2).map((({displayName:e})=>e||"")),nonTeamsFederatedUsersLength:t.length}},mt=(e,t,n)=>{try{const n=dt(t,e.members);return{id:e.id,members:n}}catch(t){return n.newLogger("Chat Helper").log(`UnhandledException in toConversationMembersSchemaFromSkypeConversationLocal transformation: ${t}`),{id:e.id,members:[]}}},gt=e=>{switch(typeof e){case"string":return"true"===(null==e?void 0:e.toLowerCase())}return!!e},pt=(e,t)=>e.filter((({tenantId:e,isFederated:n})=>n||t&&e&&e!==t)),ht=e=>e.some((({id:e})=>(0,u.MR)(e))),vt=e=>e.some((e=>H.eo.isTFLConsumerUser(e))),St=e=>e.some((e=>H.eo.isTFLSmsVerifiedMri(null==e?void 0:e.id))),ft=e=>e.some((e=>(0,u.Nl)(e.id)&&H.eo.isUnknownUser(e))),yt=e=>e.some((e=>H.eo.isEnterpriseUserMri(e.id)&&H.eo.isUnknownUser(e))),kt=e=>e.some((e=>H.eo.isEnterpriseUserMri(e.id))),Ct=(e,t)=>{let n=!0;const i=t&&t.some((t=>{if(!t.isFederated&&t.id!==e&&t.featureSettings){const e=t.featureSettings.isPrivateChatEnabled;return null==e?(n=!1,!0):!e}return!1}));return{isPrivateChatPolicyDefinedScenario:n,isChatDisabledForRecipients:i}},bt={opted_out:k.DisableReasonCode.OptedOut,claimed:k.DisableReasonCode.Claimed,deprovisioned:k.DisableReasonCode.Deprovisioned},Tt=e=>{if(!e)return;const t=(0,v.D)(e);return{newlyCreatedUserId:t.userId,code:bt[t.code]}},wt=e=>{if(e)return k.ClaimedConversationImportState[e]},_t=e=>Object.assign(Object.assign({},e),{__typename:"LastMessage"}),It=(e,t,n,a,o)=>{var{id:r,members:s,consumptionHorizon:l,userConsumptionHorizon:c,lastMessage:u,creator:m,meetingInformation:g,isDisabled:p,disabledReason:h,importState:v,isMuted:S,isLastMessageFromMe:f,isRead:C,isOneOnOne:b,isOneOnOneBotChat:T,isSticky:w,isExternal:_,consumerGroupId:I,templateType:A,chatType:N,historyHiddenTime:E,createdAt:D,interopConversationStatus:F,quickReplyAugmentation:P,meetingPolicy:M,addedBy:j,addedByTenantId:R}=e,x=(0,i._T)(e,["id","members","consumptionHorizon","userConsumptionHorizon","lastMessage","creator","meetingInformation","isDisabled","disabledReason","importState","isMuted","isLastMessageFromMe","isRead","isOneOnOne","isOneOnOneBotChat","isSticky","isExternal","consumerGroupId","templateType","chatType","historyHiddenTime","createdAt","interopConversationStatus","quickReplyAugmentation","meetingPolicy","addedBy","addedByTenantId"]);try{const e=(0,y.map)(s,(e=>(0,G.ne)(e))),i=u&&_t(Ge(u,r,t)),E=g&&{id:r,subject:g.subject,startTime:g.startTime,scenario:g.scenario,endTime:g.endTime,iCalUid:g.iCalUid,location:g.location,exchangeId:g.exchangeId,meetingType:g.meetingType?et(g.meetingType):k.MeetingType.Unknown,resolvedSensitivityLabelId:g.resolvedSensitivityLabelId,isCopyRestrictionEnforced:g.isCopyRestrictionEnforced},D=!(!b&&!w&&A!==d.Q5.ImmutableRoster);return Object.assign(Object.assign(Object.assign({__typename:"Conversation"},at(e,(null==a?void 0:a.id)||"",n,o,null==i?void 0:i.from)),x),{id:r,consumptionHorizon:l&&Object.assign({__typename:"ConsumptionHorizon",id:r},Ve(l)),consumptionHorizonBookmark:c&&Object.assign({__typename:"ConsumptionHorizonBookmark",id:r},Ve(c)),userConsumptionHorizon:c&&Object.assign({__typename:"ConsumptionHorizonBookmark",id:r},Ve(c)),lastMessage:i,members:[],creator:m,meetingInformation:E,isDisabled:!!p,disabledReason:Tt(h),importState:wt(v),isMuted:S,isLastMessageFromMe:!!f,isRead:C,isOneOnOne:D,cfet:_,consumerGroupId:I,isOneOnOneBotChat:!!T,chatType:Mt(N),interopConversationStatus:Rt(F),quickReplyAugmentation:P&&Ye(r,P,t),addedBy:j,addedByTenantId:R,meetingChatPolicy:Ot(M)})}catch(e){t.newLogger("Chat Helper").log(`UnhandledException in conversation object transformation: ${e}`);return Object.assign(Object.assign({},x),{id:r,isUserMember:!1,consumptionHorizon:null,consumptionHorizonBookmark:null,userConsumptionHorizon:null,lastMessage:null,memberIds:[],members:[],membersLimited:[],chatHistoryHiddenTime:E,memberDisplayNamesLimited:[],creator:null,meetingInformation:null,chatType:null})}},At=({id:e,members:t},n)=>{try{const n=(0,y.map)(t,(e=>(0,G.ne)(e)));return{__typename:"ConversationMembers",id:e,members:n}}catch(t){n.newLogger("Chat Helper").log(`UnhandledException in conversation object transformation: ${t}`);return{id:e,members:[]}}},Nt=(e,t,n,i,a)=>({node:It(e,t,n,i,a),cursor:e.createdAt||e.id}),Et=e=>({activities:e.activities,callLogs:e.callLogs,chats:e.chats,total:e.total});function Dt(e){return JSON.stringify((0,y.map)(e,(e=>{const t=e.mentionType,n=e.displayName;return{"@type":"http://schema.skype.com/Mention",itemid:e.itemId,mri:e.userId,mentionType:t,displayName:n}})))}const Ft=e=>{if(e)return"space"===e||"topic"===e?c.k2.Channel:"meeting"===e?c.k2.Meeting:c.k2.None},Pt=new Map([["chat",k.ChatType.Chat],["phonechat",k.ChatType.PhoneChat],["meeting",k.ChatType.Meeting],["sfbinteropchat",k.ChatType.SfBInteropChat]]),Mt=e=>{let t=null;return null==e||(t=Pt.get(e),void 0===t&&(t=null)),t},jt=new Map([["AcceptPending",k.InteropConversationStatus.AcceptPending],["ExtendedDirectoryAcceptPending",k.InteropConversationStatus.ExtendedDirectoryAcceptPending],["Accepted",k.InteropConversationStatus.Accepted],["Blocked",k.InteropConversationStatus.Blocked],["Quarantined",k.InteropConversationStatus.Quarantined]]),Rt=e=>e&&jt.get(e)||null,xt=new Map([["ChatEnabled",k.MeetingChatPolicy.ChatEnabled],["ChatDisabled",k.MeetingChatPolicy.ChatDisabled],["InMeeting",k.MeetingChatPolicy.InMeeting],["ChatEnabledAnonymousDisabled",k.MeetingChatPolicy.ChatEnabledAnonymousDisabled],["InMeetingAnonymousDisabled",k.MeetingChatPolicy.InMeetingAnonymousDisabled]]),Ot=e=>e&&xt.get(e)||null,Lt=e=>{if(!e)return!1;switch(typeof e){case"string":e="true"===e.toLowerCase();case"boolean":return e;default:return!1}},Ut=e=>(0,y.isString)(e)?"true"===e.toLowerCase():e||!1,Bt=({id:e,conversationid:t,imdisplayname:n,from:i,composetime:a},o)=>e&&{"@type":Y,mri:X(i),imdisplayname:n,messageId:e,parentMessageId:null!=o?o:e,threadId:t,isUnresolvedEmailUser:!1,originalComposeTime:a},Wt=(e,t,n)=>{const i=n.find((n=>{try{const i=JSON.parse((n.properties||{}).starred),a=i&&i["@type"]===Y&&i.threadId===t?i.messageId:void 0;return e===a}catch(e){return!1}}));return i&&i.id},Gt=(e,t)=>{if(!t)return;const n=JSON.parse(t);return Object.keys(t).length?Object.assign(Object.assign({id:e},n),{meetingType:n.meetingType?et(c.wJ[n.meetingType]):k.MeetingType.Unknown}):void 0},Vt=e=>{if(e)try{const t=JSON.parse(e);return{pinnedConversationItems:t.reduce(((e,t)=>(t.itemType===k.PinnedConversationItemType.Message&&e.push({__typename:"Message",id:t.itemId}),e)),[])}}catch(e){return}},Ht=e=>e.filter((({id:e})=>H.eo.isTFLOffNetworkUser(e))),$t=(e,t,n)=>{const i=oe(n.properties);return!!i&&i.some((n=>n.key===e&&!!n.users&&n.users.some((e=>e.id===t))))},zt=e=>{let t;switch(e){case g.iv.Error:t=k.MessageStatus.Error;break;case g.iv.Sending:t=k.MessageStatus.Sending;break;default:t=k.MessageStatus.Delivered}return t},qt=({resourceType:e,resource:t},n,a)=>(0,i.mG)(void 0,void 0,void 0,(function*(){if("ThreadUpdate"===e)try{const{id:e="",members:i}=t,a=i?yield n(i,e):[];return{__typename:"ConversationMembers",id:e,members:a}}catch(e){a.newLogger("toChatMembersEvent").error(`Failed getting thread members: ${e}`)}}));var Jt;!function(e){e.SfBGatewayChat="@sfb.unq.gbl.spaces",e.OnPremFederatedGatewayChat="@sfbonprem.unq.gbl.spaces",e.FederatedGatewayChat="@fed.unq.gbl.spaces"}(Jt||(Jt={}));const Qt=e=>Kt(e)||Yt(e)||(0,m.Bl)(e),Kt=e=>!!e&&e.endsWith(Jt.SfBGatewayChat),Yt=e=>!!e&&(e.includes(":fed:preview")||e.endsWith(Jt.FederatedGatewayChat)||e.endsWith(Jt.OnPremFederatedGatewayChat)),Xt=(e,t)=>(0,y.filter)(e,(0,y.omit)(t,"__typename")),Zt=e=>!!e&&-1!==e.indexOf(ne),en=e=>!!(null==e?void 0:e.startsWith("tfl:preview-")),tn=e=>e===ie,nn=e=>tn(e)||Zt(e),an=e=>{const t=e&&(0,v.D)(e).id;return(e=>{switch(e){case te.FAMILY:case te.FRIENDS:case te.PROJECT:case te.WORKPLACE:case te.TRIP_PLANNING:case te.GET_TOGETHER:case te.LOCAL_COMMUNITY:case te.HOLIDAY_PLANNING:return!0}return!1})(t)?t:void 0},on=e=>!!e&&-1!==e.indexOf(":tflfed:preview-"),rn=e=>!!e&&e.includes("meeting"),sn=(e,t,n,i,a,r,s)=>{if(e)return n?o.Th.Meeting:i?a?o.Th.Botchat:(e=>!!e&&e===k.ChatType.PhoneChat)(t)?o.Th.SMSOneOnOneChat:(0,m.Bl)(e)?o.Th.SfcInteropChat:Kt(e)?o.Th.SfbInteropChat:r?o.Th.NativeFederatedChat:s?o.Th.FederatedChat:o.Th.OneOnOneChat:(0,m.mB)(e)?o.Th.StreamOfNotes:o.Th.GroupChat},ln=(e,t)=>{if(!t||!t.notification)return null;try{const e=t.notification;return{alertInMeeting:e.alertInMeeting,externalResourceUrl:e.externalResourceUrl}}catch(t){return e.newLogger("Chat Helper").log(`UnhandledException in chat message notification transformation: ${t}`),null}},dn=e=>{if((0,y.isString)(e)){return{__typename:"DimensionInString",value:e}}if((0,y.isNumber)(e)){return{__typename:"DimensionInFloat",value:e}}return null},cn=(e,t)=>{if(!t||!t.notifications)return null;try{const e="string"==typeof t.notifications?JSON.parse(t.notifications):t.notifications;return e&&e.map((({surface:e,contentType:t,content:n})=>{var i,a,o;return{surface:e,contentType:t,content:{value:{height:null!==(i=dn(n.value.height))&&void 0!==i?i:void 0,width:null!==(a=dn(n.value.width))&&void 0!==a?a:void 0,title:n.value.title,url:null!==(o=n.value.url)&&void 0!==o?o:""}}}}))}catch(t){return e.newLogger("Chat Helper").log(`UnhandledException in message notifications parsing: ${t}`),null}};function un(e){if(e)return"string"==typeof e?e:e.state}const mn=(e,t,n)=>{const i=n.get(a.J.Messaging).commCopilotSummarizationRequestConfig;return i?{gptVersion:i.gptVersion,summaryMode:i.summaryMode,input:{type:i.threadType,id:e,lookbackperiod:t}}:null}},28550:(e,t,n)=>{"use strict";n.d(t,{w:()=>s,K:()=>l,su:()=>d});var i=n(36223),a=n(31821),o=n(6766);const r=e=>e.slice(e.includes("_")?41:8),s=(e,t)=>{const n=[r(e),r(t)].sort();return`19:${n[0]}_${n[1]}@unq.gbl.spaces`};function l(){const[e,t]=(0,i.M)(2);return`${e}${t}`.substr(0,19)}function d(e){const{ageGroup:t}=e.get(a.J.AgeConsent);return t===o.zH.MinorWithMsaParentalConsent||t===o.zH.MinorWithoutMsaParentalConsent}},84128:(e,t,n)=>{"use strict";n.d(t,{wU:()=>r,jY:()=>s,gy:()=>l});var i,a,o=n(89925);!function(e){e[e.Standard=0]="Standard",e[e.Important=2]="Important",e[e.Urgent=3]="Urgent"}(i||(i={})),function(e){e.Standard="",e.Important="high",e.Urgent="urgent"}(a||(a={}));const r=e=>l(e)===o.MessageImportance.Important,s=e=>a[e]||a.Standard,l=e=>{switch(e){case a.Important:case i.Important:return o.MessageImportance.Important;case a.Urgent:case i.Urgent:return o.MessageImportance.Urgent;case a.Standard:case i.Standard:default:return o.MessageImportance.Standard}}},25534:(e,t,n)=>{"use strict";n.d(t,{ne:()=>l,cx:()=>d});var i=n(86631),a=n(79058),o=n(75351),r=n(96843),s=n(34255);const l=(e,t,n,i)=>{const o=a.eo.getRequestCount(e),{mri:r,objectId:s,displayName:l,givenName:d,surname:p,type:S,jobTitle:f,userPrincipalName:y,email:k,tenantId:C,sipProxyAddress:b,mobile:T,telephoneNumber:w,tenantName:_,decoratedDisplayName:I,cid:A,description:N,externalCalendarEmailAddress:E}=e,D={__typename:"User",id:v(e),objectId:s,mri:r,displayName:l,givenName:d,surname:p,type:S,jobTitle:f,userPrincipalName:y,email:k,tenantId:n||C||null,sipProxyAddress:b,mobile:T,telephoneNumber:w,requestCount:o,preferredUserName:t,tenantName:_||null,decoratedDisplayName:I||null,cid:A,description:N,externalCalendarEmailAddress:E,emailForQuery:i};return function(e,t){const n=e.department;n&&(t.department=n)}(e,D),g(e,D),m(e,D),c(e,D),u(e,D),h(D),D},d=e=>{const{id:t,displayName:n,description:i,email:a,phone:o,mri:r,requestCount:s,syncSource:l}=e;return{__typename:"User",id:t,mri:r,objectId:r,displayName:n,userPrincipalName:r,givenName:n,surname:n,description:i,email:a,mobile:o,telephoneNumber:o,requestCount:s,syncSource:l}},c=(e,t)=>{var n;if(function(e){var t;const n=e;return void 0!==n.isFederated||void 0!==n.isAnonymousB2bUser||"federated"===(null===(t=n.type)||void 0===t?void 0:t.toLowerCase())}(e)){const{isFederated:i,fetchErrorCode:a,isAnonymousB2bUser:o}=e;t.isFederated=i||"federated"===(null===(n=e.type)||void 0===n?void 0:n.toLowerCase()),t.fetchErrorCode=a,t.isAnonymousB2bUser=o}else t.isFederated=null,t.fetchErrorCode=null,t.isAnonymousB2bUser=null},u=(e,t)=>{e.featureSettings&&(t.featureSettings=e.featureSettings),e.isBlocked&&(t.isBlocked=e.isBlocked),e.cid&&(t.cid=e.cid),e.isIbBarred&&(t.isInfoBarrierSet=e.isIbBarred),e.isAnonymousUser&&(t.isAnonymousUser=e.isAnonymousUser),e.phonesInfo&&(t.phonesInfo=(0,s.cloneDeep)(e.phonesInfo)),e.emailsInfo&&(t.emailsInfo=(0,s.cloneDeep)(e.emailsInfo)),e.xtapUser&&(t.xtapUser=e.xtapUser),e.companyName&&(t.companyName=e.companyName),e.tenantName&&(t.tenantName=e.tenantName),e.imageUri&&(t.imageUri=e.imageUri),e.selfAvatarLastupdatedTime&&(t.selfAvatarLastupdatedTime=e.selfAvatarLastupdatedTime),t.isShortProfile=e.isShortProfile},m=(e,t)=>{(function(e){return void 0!==e.userType}(e)||function(e){const t=e;return t.type?t.type===i.t.botType:(0,r.bl)(e.mri)}(e)||function(e){var t,n;return"aduser"===(null===(t=e.type)||void 0===t?void 0:t.toLowerCase())||"aduser"===(null===(n=e.$$subType)||void 0===n?void 0:n.toLowerCase())}(e))&&(t.userType=e.userType,t.description=e.description,t.isUnified=e.isUnified,t.securityEnabled=e.securityEnabled,t.featureSettings=e.featureSettings,t.imageUri=e.imageUri,t.userLocation=e.userLocation)},g=(e,t)=>{const n=e.phones;n&&(t.phones=n.map((e=>p(e))))},p=e=>({number:e.number,type:e.type}),h=e=>{const{mri:t}=e;if((0,o.EG)(t)&&!e.displayName){const n=(0,o.Ol)(t);e.displayName=n,e.givenName=n}else if(t&&(0,r.MR)(t)&&!e.displayName){const n=(0,r.vq)(t);e.displayName=n,e.givenName=n}else e.displayName||(e.displayName="Unknown User");return e},v=e=>e.mri||e.objectId||e.concatenatedId},12491:(e,t,n)=>{"use strict";n.r(t),n.d(t,{audienceViewSettingsId:()=>h,coachSettingsId:()=>g,resolvers:()=>v,streamingSettingsId:()=>p,typeDefs:()=>b,userExperiencePreferencesKey:()=>u});var i=n(13637),a=n(34255),o=n(83134),r=n(51581),s=n(90181),l=n(13931),d=n(98995),c=n(89925);const u="user-experience-preferences-key",m="user-experience-preferences-id",g="coach-settings-id",p="streaming-settings-id",h="audience-view-settings-id",v={Query:{allClientPreferences:(e,t,{clientPreferences:n})=>y(n.getAllPreferences()),clientPreferences:(e,{category:t},{clientPreferences:n})=>f(n.getPreferences(t),t),userExperiencePreferences(e,t,{localStorage:n}){const i=n.get(u,d.f.UserAndExperience);return i?k(JSON.parse(i)):{id:m}}},Mutation:{updateClientPreferences:(e,{value:t},{clientPreferences:n})=>(n.updatePreferences(t),y(n.getAllPreferences())),updateUserExperiencePreferences(e,{value:t},{localStorage:n}){var i,o,s,l,c,m;const g=S(n),p=(0,a.merge)({},g,Object.assign(Object.assign({},t),{tflGroupTemplatesHidden:Object.assign(Object.assign({},t.tflGroupTemplatesHidden),{items:(0,a.unionBy)(null===(i=g.tflGroupTemplatesHidden)||void 0===i?void 0:i.items,null===(o=t.tflGroupTemplatesHidden)||void 0===o?void 0:o.items,"groupTemplate")}),tflMeetingChicletPrivacyNoticeSettings:Object.assign({},t.tflMeetingChicletPrivacyNoticeSettings),prejoinSettings:Object.assign({},t.prejoinSettings),coachSettings:Object.assign({},t.coachSettings),streamingSettings:Object.assign({},t.streamingSettings),chatInfoPaneSettings:Object.assign({},t.chatInfoPaneSettings),channelInfoPaneSettings:Object.assign({},t.channelInfoPaneSettings),audienceViewSettings:Object.assign({},t.audienceViewSettings),newChatDraft:Object.assign({},t.newChatDraft),mtmaAppBannerSettings:Object.assign(Object.assign({},t.mtmaAppBannerSettings),{dismissedApps:(0,a.union)(null!==(l=null===(s=g.mtmaAppBannerSettings)||void 0===s?void 0:s.dismissedApps)&&void 0!==l?l:[],null!==(m=null===(c=t.mtmaAppBannerSettings)||void 0===c?void 0:c.dismissedApps)&&void 0!==m?m:[])})})),h=n.setSafe(u,(0,r.u4)(p),d.f.UserAndExperience);return k(h?p:g)},clearUserExperiencePreferences:(e,t,{localStorage:n})=>n.remove(u,d.f.UserAndExperience),clearUserExperiencePreferencesByCategory(e,{category:t},{localStorage:n}){const i=S(n);return delete i[t],n.setSafe(u,(0,r.u4)(i),d.f.UserAndExperience)}},Subscription:{clientPreferencesChangedEvent:{subscribe(e,{category:t},{clientPreferences:n}){return(0,i.mG)(this,void 0,void 0,(function*(){let e;const i=new o((i=>{const a=n.getPreferenceObservable(t);return e=a.subscribe(i),()=>null==e?void 0:e.unsubscribe()}));return(0,s.TL)((0,l.Z)(i),(e=>({clientPreferencesChangedEvent:f(e,t)})))}))}}},Density:{comfy:"comfy",compact:"compact"},PerformanceMode:{normal:"normal",low:"low"},UserTheme:{light:"light",dark:"dark",contrast:"contrast"},ClientPreferenceCategoryTypes:{__resolveType:e=>e.hasOwnProperty("mode")?"PerformancePreferences":e.hasOwnProperty("disableAnimations")?"AnimationPreferences":e.hasOwnProperty("badgeActionComplete")||e.hasOwnProperty("labelActionComplete")?"PromoBadgePreferences":e.hasOwnProperty("chatDensity")?"DensityPreferences":e.hasOwnProperty("checkboxChecked")?"AppSwitcherPreferences":e.hasOwnProperty("userTheme")||e.hasOwnProperty("followOsTheme")?"ThemePreferences":e.hasOwnProperty("lastUsedBackgroundImage")||e.hasOwnProperty("lastUsedVideoFilter")?"VideoEffectPreferences":e.hasOwnProperty("lastUsedAvatarFilter")?"AvatarPreferences":e.hasOwnProperty("currentLayout")?"TeamLayoutPreferences":e.hasOwnProperty("chats")||e.hasOwnProperty("channels")||e.hasOwnProperty("chatContextualSearch")||e.hasOwnProperty("channelContextualSearch")?"InfoPanePreferences":e.hasOwnProperty("cameraState")?"FlyoutCameraPreferences":e.hasOwnProperty("shouldPersistLogsIntoIDB")?"DiagnosticsLogsPreferences":null}},S=e=>{const t=e.get(u,d.f.UserAndExperience);return t?JSON.parse(t):{}},f=(e,t)=>{let n;switch(t){case c.ClientPreferencesCategory.theme:n="theme-preferences-id";break;case c.ClientPreferencesCategory.animation:n="animation-preferences-id";break;case c.ClientPreferencesCategory.promo:n="promo-preferences-id";break;case c.ClientPreferencesCategory.density:n="density-preferences-id";break;case c.ClientPreferencesCategory.flyoutCamera:n="flyoutpane-preferences-id";break;case c.ClientPreferencesCategory.infoPane:n="infopane-preferences-id";break;case c.ClientPreferencesCategory.performance:n="perf-preferences-id";break;case c.ClientPreferencesCategory.appSwitcher:n="app-switcher-preferences-id";break;case c.ClientPreferencesCategory.videoEffect:n="videoeffect-preferences-id";break;case c.ClientPreferencesCategory.avatar:n="avatar-preferences-id";break;case c.ClientPreferencesCategory.teamLayout:n="team-layout-id";break;case c.ClientPreferencesCategory.diagnosticsLogs:n="diagnostics-logs-preferences-id"}return Object.assign({id:n},e)},y=e=>({id:"client-preferences-id",theme:Object.assign({},f(e.theme,c.ClientPreferencesCategory.theme)),animation:Object.assign({},f(e.animation,c.ClientPreferencesCategory.animation)),promo:Object.assign({},f(e.promo,c.ClientPreferencesCategory.promo)),density:Object.assign({},f(e.density,c.ClientPreferencesCategory.density)),flyoutCamera:Object.assign({},f(e.flyoutCamera,c.ClientPreferencesCategory.flyoutCamera)),infoPane:Object.assign({},f(e.infoPane,c.ClientPreferencesCategory.infoPane)),performance:Object.assign({},f(e.performance,c.ClientPreferencesCategory.performance)),appSwitcher:Object.assign({},f(e.appSwitcher,c.ClientPreferencesCategory.appSwitcher)),videoEffect:Object.assign({},f(e.videoEffect,c.ClientPreferencesCategory.videoEffect)),avatar:Object.assign({},f(e.avatar,c.ClientPreferencesCategory.avatar)),teamLayout:Object.assign({},f(e.teamLayout,c.ClientPreferencesCategory.teamLayout)),diagnosticsLogs:Object.assign({},f(e.diagnosticsLogs,c.ClientPreferencesCategory.diagnosticsLogs))}),k=e=>({id:m,tflGroupTemplatesHidden:C(e.tflGroupTemplatesHidden,c.UserExperiencePreferencesCategory.tflGroupTemplatesHidden),tflMeetingChicletPrivacyNoticeSettings:C(e.tflMeetingChicletPrivacyNoticeSettings,c.UserExperiencePreferencesCategory.tflMeetingChicletPrivacyNoticeSettings),prejoinSettings:C(e.prejoinSettings,c.UserExperiencePreferencesCategory.prejoinSettings),coachSettings:C(e.coachSettings,c.UserExperiencePreferencesCategory.coachSettings),streamingSettings:C(e.streamingSettings,c.UserExperiencePreferencesCategory.streamingSettings),chatInfoPaneSettings:C(e.chatInfoPaneSettings,c.UserExperiencePreferencesCategory.chatInfoPaneSettings),channelInfoPaneSettings:C(e.channelInfoPaneSettings,c.UserExperiencePreferencesCategory.channelInfoPaneSettings),audienceViewSettings:C(e.audienceViewSettings,c.UserExperiencePreferencesCategory.audienceViewSettings),newChatDraft:C(e.newChatDraft,c.UserExperiencePreferencesCategory.newChatDraft),mtmaAppBannerSettings:C(e.mtmaAppBannerSettings,c.UserExperiencePreferencesCategory.mtmaAppBannerSettings)}),C=(e,t)=>{let n;switch(t){case c.UserExperiencePreferencesCategory.tflGroupTemplatesHidden:n="tfl-group-templates-hidden-id";break;case c.UserExperiencePreferencesCategory.tflMeetingChicletPrivacyNoticeSettings:n="tfl-meeting-chiclet-privacy-notice-settings-id";break;case c.UserExperiencePreferencesCategory.prejoinSettings:n="prejoin-settings";break;case c.UserExperiencePreferencesCategory.coachSettings:n=g;break;case c.UserExperiencePreferencesCategory.streamingSettings:n=p;break;case c.UserExperiencePreferencesCategory.chatInfoPaneSettings:n="chat-info-pane-settings-id";break;case c.UserExperiencePreferencesCategory.audienceViewSettings:n=h;break;case c.UserExperiencePreferencesCategory.newChatDraft:n="new-chat-draft-id";break;case c.UserExperiencePreferencesCategory.mtmaAppBannerSettings:n="mtma-app-banner-settings-id"}return Object.assign({id:n},e)};var b=n(56023)},51018:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ILocalizationSettings:()=>r.localizationSettingsQuery,ILocalizationSettingsQuery:()=>r.y,ILocalizationSettingsVariables:()=>r.localizationSettingsQueryVariables,IUpdateCurrentLocaleMutation:()=>s,IUpdateCurrentLocaleVariables:()=>i.updateCurrentLocaleMutation,resolvers:()=>a.s,typeDefs:()=>o});var i={};n.r(i),n.d(i,{W:()=>s});var a=n(42094),o=n(80130),r=n(17986);const s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateCurrentLocale"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"newLocale"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateCurrentLocale"},arguments:[{kind:"Argument",name:{kind:"Name",value:"newLocale"},value:{kind:"Variable",name:{kind:"Name",value:"newLocale"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currentLocale"}}]}}]}}]}},17986:(e,t,n)=>{"use strict";n.d(t,{y:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"localizationSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"localizationSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currentLocale"}}]}}]}}]}},42094:(e,t,n)=>{"use strict";n.d(t,{s:()=>s});var i=n(13637),a=n(17986),o=n(19898),r=n(30170);const s={Query:{localizationSettings(e,t,{hostCommunicationService:n,platformService:a,routingServices:s,i18n:l}){return(0,i.mG)(this,void 0,void 0,(function*(){const e=yield c(s.state.getSearchState()||{});if(e)return{currentLocale:e};if(localStorage.getItem("localeCode"))return{currentLocale:localStorage.getItem("localeCode")};if(a.config.clientType===o.Bh.Web)return{currentLocale:l.locale};let t;try{const e=yield d(n);e?(t=(0,r.vw)(e).locale,yield l.setLocale(t)):t=l.locale}catch(e){t=l.locale}return{currentLocale:t}}))}},Mutation:{updateCurrentLocale(e,{newLocale:t},{cache:n,hostCommunicationService:r,loggerFactory:s,platformService:d,i18n:c}){return(0,i.mG)(this,void 0,void 0,(function*(){try{const e={localizationSettings:{__typename:"LocalizationSettings",currentLocale:t}};return yield c.setLocale(t),localStorage.setItem("localeCode",t),n.writeQuery({query:a.y,data:e}),d.config.clientType!==o.Bh.Web&&(yield l(s,r,t)),{currentLocale:t}}catch(e){return{currentLocale:c.locale}}}))}}},l=(e,t,n)=>(0,i.mG)(void 0,void 0,void 0,(function*(){var i;const a=e.newLogger("LocalizationSettingsResolvers");try{const e=yield t.loadModule("osutils");(yield null===(i=null==e?void 0:e.setAppLocale)||void 0===i?void 0:i.call(e,{localeName:n}))||a.warn("hostingCommunicationService language set has failed")}catch(e){a.warn("hostingCommunicationService failed to load")}})),d=e=>(0,i.mG)(void 0,void 0,void 0,(function*(){var t;const n=yield e.loadModule("osutils"),i=yield null===(t=null==n?void 0:n.getAppLocale)||void 0===t?void 0:t.call(n);return null==i?void 0:i.localeName})),c=e=>(0,i.mG)(void 0,void 0,void 0,(function*(){if(e.localeCode)return e.localeCode;if(e.language)return e.language.toLowerCase();if(!e.setting)return;const t=e.setting;let n;if(Array.isArray(t)){for(const e of t)if(e.startsWith("localeCode:")){n=e;break}}else t.startsWith("localeCode:")&&(n=t);return n?n.split(":")[1]:void 0}))},54871:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={}},48471:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={mappings:{},namespaces:[]}},74406:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={core:{isHeaderDisabled:[{viewportContext:["iFrame"],value:!0}]}}},98067:(e,t,n)=>{"use strict";n.d(t,{rY:()=>o,Ok:()=>r});var i=n(9458);function a(e){if(e.definitions.length>1)return null;const t=e.definitions[0];return"FragmentDefinition"!==t.kind?null:t}function o(e){const t=(0,i.S)(e);if(!(null==t?void 0:t.name))throw new Error("Operation name must be set");return t.name.value}function r(e){var t;let n=(0,i.S)(e);return n||(n=a(e)),(null===(t=null==n?void 0:n.name)||void 0===t?void 0:t.value)||null}},54455:(e,t,n)=>{"use strict";n.d(t,{$Z:()=>p,aw:()=>m,nl:()=>u});var i=n(13637),a=n(88081),o=n(37814),r=n(93355),s=n(12929),l=n(82250);class d extends s.h{constructor(e,t){super(e),this.definitionOverflowLogged=new Set;const{loggerFactory:n,scenarioFactory:i,graphqlStoreStatsReporterService:a,storeType:o}=t;this.storeType=o,n&&(this.logger=n.newLogger("InMemoryCacheWrapper")),i&&(this.scenarioFactory=i),a&&(this.graphqlStoreStatsReporterService=a)}write(e){var t,n,i,a;let o;try{o=null===(t=this.graphqlStoreStatsReporterService)||void 0===t?void 0:t.markWriteStart(this.storeType,e.query);const i=super.write(e);return o&&(null===(n=this.graphqlStoreStatsReporterService)||void 0===n||n.markWriteEnd(o)),i}catch(e){throw null===(i=this.logger)||void 0===i||i.error(e.message),o&&(null===(a=this.graphqlStoreStatsReporterService)||void 0===a||a.markWriteError(o)),e}}read(e){var t,n;let i;try{i=null===(t=this.graphqlStoreStatsReporterService)||void 0===t?void 0:t.markReadStart(this.storeType,e.query);const a=super.read(e);return i&&(null===(n=this.graphqlStoreStatsReporterService)||void 0===n||n.markReadEnd(i)),a}finally{this.logResultCacheOverflowOnce("read",e.query)}}modify(e){var t,n,i,a;let o;try{o=null===(t=this.graphqlStoreStatsReporterService)||void 0===t?void 0:t.markWriteStart(this.storeType,`modify ${e.id||"ROOT_QUERY"}`);const i=super.modify(e);return o&&(null===(n=this.graphqlStoreStatsReporterService)||void 0===n||n.markWriteEnd(o)),i}catch(e){throw null===(i=this.logger)||void 0===i||i.error(e.message),o&&(null===(a=this.graphqlStoreStatsReporterService)||void 0===a||a.markWriteError(o)),e}}diff(e){var t,n;let i;try{i=null===(t=this.graphqlStoreStatsReporterService)||void 0===t?void 0:t.markDiffStart(this.storeType,e.query);const a=super.diff(e);return i&&(null===(n=this.graphqlStoreStatsReporterService)||void 0===n||n.markDiffEnd(i)),a}finally{this.logResultCacheOverflowOnce("diff",e.query)}}logResultCacheOverflowOnce(e,t){var n,i,a,o,r;const s=t.definitions[0],d=this.getLastResultCacheOverflow();if(!this.scenarioFactory||d<=0||"OperationDefinition"!==s.kind)return;let c;if(s.name||1!==s.selectionSet.selections.length||"FragmentSpread"!==s.selectionSet.selections[0].kind){c={definitionKind:"query",definitionName:null!==(r=null===(o=s.name)||void 0===o?void 0:o.value)&&void 0!==r?r:"(unnamed)",overflowSize:d,method:e}}else{c={definitionKind:"fragment",definitionName:null!==(a=null===(i=null===(n=s.selectionSet.selections[0])||void 0===n?void 0:n.name)||void 0===i?void 0:i.value)&&void 0!==a?a:"",overflowSize:d,method:e}}const u=`${c.definitionKind}-${c.definitionName}`;if(!this.definitionOverflowLogged.has(u)){this.scenarioFactory.createScenarioWithoutStarting(l.RG.ApolloResultCacheOverflow).stop(c),this.definitionOverflowLogged.add(u)}}getLastResultCacheOverflow(){var e,t,n;return(null!==(n=(null!==(t=(null!==(e=this.storeReader)&&void 0!==e?e:{}).executeSelectionSet)&&void 0!==t?t:{}).__DEBUG_ONLY_optimismCache)&&void 0!==n?n:{}).__DEBUG_ONLY_lastOverflow||0}}const c=d,u=(e={})=>{const{apolloLeakOptions:t,cache:n,loggerFactory:r,scenarioFactory:s,enableApolloDevtools:l,storeType:d=o.t.other,graphqlStoreStatsReporterService:c}=e,u=(0,i._T)(e,["apolloLeakOptions","cache","loggerFactory","scenarioFactory","enableApolloDevtools","storeType","graphqlStoreStatsReporterService"]),p=new a.f(Object.assign(Object.assign({},u),{cache:n||m({apolloLeakOptions:t,loggerFactory:r,scenarioFactory:s,storeType:d,graphqlStoreStatsReporterService:c}),assumeImmutableResults:!0,connectToDevTools:Boolean(l)}));return g(p,t),p},m=(e={})=>{var t,{apolloLeakOptions:n,loggerFactory:a,scenarioFactory:s,graphqlStoreStatsReporterService:l,storeType:d}=e,u=(0,i._T)(e,["apolloLeakOptions","loggerFactory","scenarioFactory","graphqlStoreStatsReporterService","storeType"]);const m={loggerFactory:a,scenarioFactory:s,graphqlStoreStatsReporterService:l,storeType:d||o.t.other},p=new c(u,m);return null===(t=null==n?void 0:n.leakDetector)||void 0===t||t.track(r.I.ApolloCache,p),g(p,n),p},g=(e,{userContextId:t,windowId:n,entityType:i,viewportContext:a}={})=>{e.apolloLeakInfo={apolloLeakInfoStartTime:(new Date).toUTCString(),apolloLeakInfoEntityType:i,apolloLeakInfoUserContextId:t,apolloLeakInfoViewportContext:a,apolloLeakInfoWindowId:n}},p=e=>{e.apolloLeakInfo||(e.apolloLeakInfo={}),e.apolloLeakInfo.apolloLeakInfoEndTime=(new Date).toUTCString()}},81328:(e,t,n)=>{"use strict";n.d(t,{T:()=>a});var i=n(47437);const a=e=>{const t=performance.now();return{cacheSize:i({data:e.data.data,optimisticData:e.optimisticData.data}),measuringTime:performance.now()-t}}},83250:(e,t,n)=>{"use strict";n.d(t,{Hl:()=>i,TV:()=>a,ST:()=>o,sb:()=>r});const i="ComposeInlineImageCardExtension",a="ComposeClipboardInlineImageCardExtension",o="InlineImageCard",r="SingleInlineImageCard"},5216:(e,t,n)=>{"use strict";n.d(t,{l:()=>r});var i=n(12345),a=n(59722);const o=["NoNetwork","RemoteOperationFailed"];class r extends i.G{constructor(e,t){super({type:"AuthError",code:s(e,t),prevError:"boolean"==typeof e?void 0:e})}getBoundaryProps(){switch(this.code){case"SIGN_IN_RESTRICTIONS":return{title:"default_signinrestrictions_title",description:"default_signinrestrictions_description",actions:["RESTART"]};case"ERROR_GETUSER_WHEN_ANON_NOT_SUPPORTED":return{title:"default_error_getuser_when_anon_not_supported_title",description:"default_error_getuser_when_anon_not_supported_description"};case"OFFLINE":return{title:"default_auth_no_network_title",description:"default_auth_no_network_description",actions:["RESTART"]};default:return{title:"default_authentication_title",description:"default_authentication_description",actions:["RESTART","SIGN_OUT"]}}}static fromSerialized(e){if("AuthError"!==(null==e?void 0:e.type))return null;const t=new r(void 0,e.code);return t.deserialize(e),t}}function s(e,t){if(t)return t;if("boolean"==typeof e)return e?"SIGN_IN_RESTRICTIONS":"UNKNOWN";if((0,a.a)(e)){const t=e.code;switch(t){case"SignInRestrictions":return"SIGN_IN_RESTRICTIONS";case"ErrorGetUserWhenAnonNotSupported":return"ERROR_GETUSER_WHEN_ANON_NOT_SUPPORTED";default:return o.includes(t)?"OFFLINE":"UNKNOWN"}}return"UNKNOWN"}},12345:(e,t,n)=>{"use strict";n.d(t,{G:()=>a});var i=n(59722);class a extends Error{constructor({type:e,code:t,message:n,prevError:i,userContextId:a}){var o;super(n),this.type=e,this.code=t,this.prevError=i,this.userContextId=a;const r=function(e){var t;return null!==(t=null==e?void 0:e.split("\n").slice(1))&&void 0!==t?t:[]}(null!==(o=null==i?void 0:i.stack)&&void 0!==o?o:this.stack);this.stack=[`${t} Error: ${n}`,...r].join("\n"),Object.setPrototypeOf(this,new.target.prototype)}get extensions(){return this.getExtensions()}getBoundaryProps(){return{title:`default_${this.type.toLowerCase()}_title`,description:`default_${this.type.toLowerCase()}_description`}}toTelemetryEntry(){var e,t;let n=this.toTelemetryCode(),o=this.prevError;for(;o;)o instanceof a?(n+=o.toTelemetryEntry(),o=void 0):(0,i.a)(o)?(n+=`[IError::${o.code}]`,o=null!==(e=o.innerError)&&void 0!==e?e:null===(t=o.reason)||void 0===t?void 0:t.innerError):(n+=`[Error::${o.message}]`,o=void 0);return n}toJSON(){return{type:this.type,code:this.code,stack:this.stack,userContextId:this.userContextId,prevError:this.prevError}}serialize(){const e=new WeakSet;return JSON.stringify(this,((t,n)=>{if("object"==typeof n&&null!==n){if(e.has(n))return;e.add(n)}return n}))}deserialize(e){this.stack=e.stack}toTelemetryCode(){return`[${this.type}::${this.code}]`}getExtensions(){return{type:this.type,code:this.code,prevError:this.prevError,boundaryProps:this.getBoundaryProps()}}}},52058:(e,t,n)=>{"use strict";n.d(t,{$:()=>i,G:()=>d});var i,a=n(12345),o=n(55372),r=n(59722);!function(e){e.CDL_WORKER_FAILURE="CDL_WORKER_FAILURE",e.CLEANUP="CLEANUP",e.CREATE_USER_CONTEXT_FAILED_GENERIC="CREATE_USER_CONTEXT_FAILED_GENERIC",e.CREATE_WINDOW_WRAPPER="CREATE_WINDOW_WRAPPER",e.EXPERIENCE_DISABLED="EXPERIENCE_DISABLED",e.INVALID_INTENT_OVERRIDE="INVALID_INTENT_OVERRIDE",e.LAYOUT_ERROR="LAYOUT_ERROR",e.LAYOUT_PHASE_STATE_MACHINE_TIMEOUT="LAYOUT_PHASE_STATE_MACHINE_TIMEOUT",e.NETWORK_OFFLINE="NETWORK_OFFLINE",e.RENDERING_CONTEXT_DOES_NOT_EXIST="RENDERING_CONTEXT_DOES_NOT_EXIST",e.UNKNOWN="UNKNOWN",e.TELEMETRY_PRIMARY_USER_SET_FAILURE="TELEMETRY_PRIMARY_USER_SET_FAILURE",e.USER_DOES_NOT_EXIST="USER_DOES_NOT_EXIST",e.WINDOW_UNDEFINED="WINDOW_UNDEFINED"}(i||(i={}));const s={CDL_WORKER_FAILURE:"Cdl worker did not start up properly.",EXPERIENCE_DISABLED:"We can't wait to show you the new Teams, but we're not quite ready for you. We'll let you know when it's time.",LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:"Layout phase state machine has timed out triggering a view tear down.",TELEMETRY_PRIMARY_USER_SET_FAILURE:"This can result from a failure to load the PIE api, a failure to call maglev, or a failure to set primary user in the telemetry web worker"},l={CREATE_USER_CONTEXT_FAILED_GENERIC:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},EXPERIENCE_DISABLED:{title:"default_experiencedisabled_title",description:"default_experiencedisabled_description",actions:["SIGN_OUT"],icon:o.P.NoLongerAllowed},LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART"]},NETWORK_OFFLINE:{title:"default_nonetwork_title",description:"error_nonetwork_text"},CDL_WORKER_FAILURE:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART"]},LAYOUT_ERROR:{title:"default_unknown_title",description:"",actions:[]},RENDERING_CONTEXT_DOES_NOT_EXIST:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},USER_DOES_NOT_EXIST:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]}};class d extends a.G{constructor(e,t,n){var i,a,o,l,d;super({type:"CoreError",code:e,message:null!==(i=s[e])&&void 0!==i?i:(0,r.a)(t)?null!==(o=null===(a=t.innerError)||void 0===a?void 0:a.message)&&void 0!==o?o:null===(d=null===(l=t.reason)||void 0===l?void 0:l.innerError)||void 0===d?void 0:d.message:null==t?void 0:t.message,prevError:t,userContextId:n})}getBoundaryProps(){var e;return null!==(e=l[this.code])&&void 0!==e?e:{title:"default_core_title",description:"default_core_description"}}static fromSerialized(e){if("CoreError"!==(null==e?void 0:e.type))return null;const t=new d(e.code,e.prevError,e.userContextId);return t.deserialize(e),t}}},40474:(e,t,n)=>{"use strict";n.d(t,{Y:()=>a});var i=n(12345);class a extends i.G{constructor(e,t){super({type:"TrustedTypeError",code:e,prevError:t})}}},50689:(e,t,n)=>{"use strict";n.d(t,{K:()=>a});var i=n(12345);class a extends i.G{constructor(e,t){super({type:"UnknownError",code:"NONE",message:e.message,prevError:e}),this.context=t}getExtensions(){return Object.assign(Object.assign({},super.getExtensions()),this.context)}toTelemetryCode(){return`[${this.type}]`}}},59722:(e,t,n)=>{"use strict";function i(e){const t=e;return"string"==typeof(null==t?void 0:t.code)}n.d(t,{a:()=>i})},87360:(e,t,n)=>{"use strict";n.d(t,{m:()=>a});var i=n(13637);const a=()=>(0,i.mG)(void 0,void 0,void 0,(function*(){return n.e(9190).then(n.bind(n,19190))}))},73297:(e,t,n)=>{"use strict";n.d(t,{b:()=>_});var i=n(13637),a=n(57924),o=n(31583),r=n(91369),s=n(6766),l=n(98995),d=n(55997),c=n(20448),u=n(31821),m=n(24211),g=n(88783),p=n(42771),h=n(6181),v=n(62174),S=n(91902),f=n(38923);const y=3e5;var k=n(5102);const C="beta/imageauth/cookie",b="beta/users/{objectId}/cookiev2",T=1e3,w=new Map([[h.ej.SKYPE_KEY,[s.Pn.ams,s.Pn.amsV2]],[h.ej.MT_KEY,[s.Pn.mtImageService]]]);class _{constructor(e,t,n,i,m,h,k,w,_,I,A,N){var E;this._gtmRegistry=t,this._discover=n,this.coreSettings=m,this.windowProvider=h,this.platformService=k,this.localStorage=_,this._authenticationService=I,this.config=A,this.user=N,this._imageAuthCookieExpiryTsKey="ImageAuthCookieExpiryTime",this._activeAmsRequest={},this._baseImageUrlSubject=new g.X(null),this._isInitialized=!1,this._isImageAuthCookieValidSubject=new g.X(!1),this._imageCookieRetryInterval=2e4,this._imageCookieRetryMaxCount=5,this._isSetupImageCookieInProgress=!1,this.checkImageAuthCookie=()=>{let e=-1;const t=(new Date).getTime()/T,n=this.localStorage&&this.localStorage.get(this._imageAuthCookieExpiryTsKey,l.f.Global)||"-1";e=parseInt(n,10);const i=e>t,a=i?`Image auth cookie has NOT expired. Expiry time stamp: ${e}`:`Image auth cookie has expired. Expiry time stamp: ${e}`;this._logger.log(a),this._isImageAuthCookieValidSubject.next(i),this.startImageAuthCookiePollingTimer(i,e)},this.getRequest=(e,{requestUrl:t,requestBody:n,headers:i,serviceName:a},o)=>this._gtmRegistry.bind(this._send,e)({url:t,headers:i,credentials:"include",method:"POST",body:n,serviceName:a,apiName:o}),this.setupImageAuthCookie=()=>Promise.resolve({constructRequest:()=>{var e,t;return{url:this._isMTMAProfilePicturesEnabled&&(null===(e=this.user)||void 0===e?void 0:e.id)?b.replace("{objectId}",null===(t=this.user)||void 0===t?void 0:t.id):C,method:"POST",headers:{"x-ms-client-caller":"imageAuthCookieSetupEM","x-ms-client-type":(0,p.I)(this.platformService,this.config)},credentials:"include",apiName:"imageAuthCookie"}},allowedResponses:[d.qj.HTTP_2XX],retryPolicy:this.imageCookieRetryPolicy()}),this.setupImageAuthCookieEndpoints=({discover:e,authenticationResources:t})=>({baseUrlPromise:()=>e.regionGtm(s.Pn.middleTier),serviceName:c.EJ.MiddleTier,authResource:t.mtAuthResource,models:{setupImageAuthCookie:this.setupImageAuthCookie()}}),this._logger=i.newLogger("Content Media Auth"),this._send=(0,a.r)((0,o.B)((0,r.S)(e),d.qb.NO_CONTENT,d.qb.OK),(E=this._logger,{shouldRetry:e=>(0,f.o7)(e)||[d.qb.THROTTLED,-1].indexOf(e)>-1,errorHandler:(e,t)=>{const{serverResponse:{status:n}}=e;if(!t.retriesTable[n])throw new Error(`AsyncMediaAuthServiceRetryPolicy: retry count for ${n} is empty`);return E.error(`asyncMediaAuthServiceRetryPolicy: retrying '[${t.retryCount}]' times due to response status - '[${n}]'`),(0,v._)(t.delay.next())},retryMaxTimeMs:y,maxRetryCount:6,createDelay:()=>new S.df(1e3,2,y)})),this._setupImageAuthCookieApi=w.createApi(this.setupImageAuthCookieEndpoints),this._imageCookieRetryInterval=m.get(u.J.People).imageCookieRetryInterval||2e4,this._imageCookieRetryMaxCount=m.get(u.J.People).imageCookieRetryMaxCount||5,this._isMTMAProfilePicturesEnabled=!!m.get(u.J.People).enableProfilePicturesWithObjectId,this._isDeleteImageAuthCookieEnabled=!!m.get(u.J.People).enableDeleteImageAuthCookie,this._isMTMAProfilePicturesEnabled&&(this._imageAuthCookieExpiryTsKey=`${this._imageAuthCookieExpiryTsKey}_${null==N?void 0:N.id}`)}initAsyncMediaAuthService(){if(this._isInitialized)return;this.initBaseImageUrl().catch((()=>{this._logger.error("Error in initCookieImageAuth")}));const{enableAmsCookieValidation:e}=this.coreSettings.get(u.J.Core),{isImageAuthCookiePollingCheckEnabled:t}=this.coreSettings.get(u.J.People),{skipAmsAuthRequest:n,disableTokenCacheReadEvent:i}=this.coreSettings.get(u.J.Auth);e&&t?this.checkImageAuthCookie():n?this._isImageAuthCookieValidSubject.next(!0):(this._discover.validateSkypeToken().catch((()=>{})),this.subscribeToToken(h.ej.SKYPE_KEY),i?this.subscribeToMiddleTierToken():this.subscribeToToken(h.ej.MT_KEY)),this._isInitialized=!0}logout(){var e,t,n,a;return(0,i.mG)(this,void 0,void 0,(function*(){let i,o=c.EJ.Skype;const r=h.ej.MT_KEY,{mtResource:s}=yield this.coreSettings.get(u.J.Auth);if(s&&this._isDeleteImageAuthCookieEnabled&&(null===(e=this.user)||void 0===e?void 0:e.id)&&(null===(t=this._authenticationService)||void 0===t?void 0:t.acquireTokenV2)){const{token:e}=yield null===(n=this._authenticationService)||void 0===n?void 0:n.acquireTokenV2(s),t=null!==(a=w.get(r))&&void 0!==a?a:[],l=this.getHeaders(e,r);i=this._isMTMAProfilePicturesEnabled?"beta/users/{objectId}/deletecookiev2".replace("{objectId}",this.user.id):"beta/imageauth/deletecookie",o=c.EJ.MiddleTier;const{requireSkypetokenForMT:d}=this.coreSettings.get(u.J.Auth);return d&&(l["x-skypetoken"]=yield this._discover.validateSkypeToken()),this._logger.log("queueing request for deleting image auth cookie"),this.queueRequests(t,r,{requestUrl:i,headers:l,requestBody:undefined,serviceName:o},"deleteCookieOnLogout"),this._activeAmsRequest[r][0]}}))}startImageAuthCookiePollingTimer(e,t){this._imageAuthCookiePollingTimerId&&(this._logger.log(`Clearing image auth cookie polling. Timer ID: ${this._imageAuthCookiePollingTimerId}`),this.windowProvider.clearInterval(this._imageAuthCookiePollingTimerId));const n=Math.abs(t*T-(new Date).getTime()),i=e?n:5e3;this._imageAuthCookiePollingTimerId=this.windowProvider.setInterval((()=>this.checkImageAuthCookie()),i);const a=e?`Image auth cookie valid. expiry check timer started. Timer ID: ${this._imageAuthCookiePollingTimerId}`:`Image auth cookie NOT valid. polling validity timer started. Timer ID: ${this._imageAuthCookiePollingTimerId}`;e||this._logger.warn(a)}initBaseImageUrl(){var e;return(0,i.mG)(this,void 0,void 0,(function*(){const t=null!==(e=w.get(h.ej.MT_KEY))&&void 0!==e?e:[],n=yield this.getBaseUrl(t[0]);n&&this._baseImageUrlSubject.next(n)}))}getBaseUrl(e){return(0,i.mG)(this,void 0,void 0,(function*(){try{const t=yield this._discover.regionGtm(e);return t||this._logger.error("baseImageUrl is undefined"),t}catch(t){const n=`Fetching baseImageUrl failed from regionGTM, passed gtm: ${e.length}, errorCode: ${null==t?void 0:t.code}, errorContext: ${null==t?void 0:t.context}, errorMessage: ${null==t?void 0:t.message}`,i=(0,k.A)(n);return this._logger.errorToTelemetry?this._logger.errorToTelemetry(i,"async_media_auth_service",void 0,!0):this._logger.error(n),Promise.reject(t)}}))}subscribeToToken(e){var t;e===h.ej.SKYPE_KEY&&this._discover.observeSkypeToken().subscribe((e=>this.persistTokenToAMS(e,h.ej.SKYPE_KEY))),e===h.ej.MT_KEY&&(null===(t=this._authenticationService)||void 0===t||t.observeMiddleTierToken().subscribe((e=>this.persistTokenToAMS(e,h.ej.MT_KEY))))}getHeaders(e,t){const n={},i=(0,m.v4)();return n.Authorization=`${t===h.ej.SKYPE_KEY?"skype_token":"Bearer"} ${e}`,n["Content-Type"]="application/x-www-form-urlencoded",n.RequestId=i,n.CorrelationId=i,n.TransactionId=i,n["x-ms-client-type"]=(0,p.I)(this.platformService,this.config),n}persistTokenToAMS(e,t){var n,a;return(0,i.mG)(this,void 0,void 0,(function*(){let i,o,r,s=c.EJ.Skype;const l=null!==(n=w.get(t))&&void 0!==n?n:[],d=this.getHeaders(e,t);if(!e)return Promise.resolve(null);if(this._activeAmsRequest[t])return this._activeAmsRequest[t];switch(this._logger.log("persistTokenToAMS: received new token"),t){case h.ej.SKYPE_KEY:i=`skypetoken=${e}`,o="v1/skypetokenauth",s=c.EJ.Skype;break;case h.ej.MT_KEY:o=this._isMTMAProfilePicturesEnabled&&(null===(a=this.user)||void 0===a?void 0:a.id)?b.replace("{objectId}",this.user.id):C,s=c.EJ.MiddleTier,r=yield this.getBaseUrl(l[0]);const{requireSkypetokenForMT:t}=this.coreSettings.get(u.J.Auth);t&&(d["x-skypetoken"]=yield this._discover.validateSkypeToken())}return this._logger.log(`persistTokenToAMS: queueing request for ${t}`),this.queueRequests(l,t,{requestUrl:o,headers:d,requestBody:i,serviceName:s},"persistTokenToAMS"),Promise.all(this._activeAmsRequest[t]).then((()=>{this._activeAmsRequest[t]=void 0,t===h.ej.MT_KEY&&(this._isImageAuthCookieValidSubject.next(!0),r?this._baseImageUrlSubject.next(r):this._logger.error("baseImageUrl is undefined"))})).catch((e=>{this._logger.error(`Unable to persist skype token to AMS. ${e}`),this._activeAmsRequest[t]=void 0})),this._activeAmsRequest[t]}))}queueRequests(e,t,n,i){this._activeAmsRequest[t]=[],e.map((e=>{this._activeAmsRequest[t].push(this.getRequest(e,n,i))}))}subscribeToMiddleTierToken(){var e;null===(e=this._authenticationService)||void 0===e||e.observeMiddleTierToken().subscribe((e=>{if(e||this.isImageCookieExpired()){const t=e?"token changed":"cookie expired";this._logger.log(`Set up image auth cookie due to: ${t}`),this.setupImageAuthCookieAndExpiry()}else this._isImageAuthCookieValidSubject.next(!0)}))}setupImageAuthCookieAndExpiry(){var e,t,n;return(0,i.mG)(this,void 0,void 0,(function*(){if(!this._isSetupImageCookieInProgress){this._isSetupImageCookieInProgress=!0,this._logger.log("Setting up image auth cookie");try{yield this._setupImageAuthCookieApi.setupImageAuthCookie(),this._isImageAuthCookieValidSubject.next(!0);const{mtResource:i}=yield this.coreSettings.get(u.J.Auth);if(i&&(null===(e=this._authenticationService)||void 0===e?void 0:e.acquireTokenV2)){const e=yield null===(t=this._authenticationService)||void 0===t?void 0:t.acquireTokenV2(i);null===(n=this.localStorage)||void 0===n||n.set(this._imageAuthCookieExpiryTsKey,`${null==e?void 0:e.expires}`,l.f.Global),this._logger.log(`Successfully set up image auth cookie expiry ${null==e?void 0:e.expires}`)}}catch(e){this._logger.error(`setupImageAuthCookieAndExpiry error ${e}`)}finally{this._isSetupImageCookieInProgress=!1}}}))}isImageCookieExpired(){var e;const t=Math.round(Date.now()/T),n=(null===(e=this.localStorage)||void 0===e?void 0:e.get(this._imageAuthCookieExpiryTsKey,l.f.Global))||"-1";return parseInt(n,10)<t}imageCookieRetryPolicy(){return{shouldRetry:(e,t,n)=>{if(t>=d.qb.OK&&t<=d.qb.NOT_MODIFIED)return!1;const i=e<this._imageCookieRetryMaxCount&&t!==d.qb.BAD_REQUEST&&t!==d.qb.NOT_AUTHORIZED;return this._logger.warn(`imageCookieRetryPolicy retry count ${e} responseCode ${t} canRetry ${i}`),i},nextDelay:e=>this._imageCookieRetryInterval*Math.pow(2,e)}}get baseImageUrlObservable(){return this._baseImageUrlSubject.asObservable()}get isImageAuthCookieValidObservable(){return this._isImageAuthCookieValidSubject.asObservable()}}},17809:(e,t,n)=>{"use strict";n.d(t,{D:()=>Ze,fh:()=>Ke,Vf:()=>Xe,bl:()=>Ye});var i=n(13637),a=n(16491),o=n(62803),r=n(23569),s=n(37464),l=n(34255),d=n(25118),c=n(3700),u=n(22835);const m=e=>{e&&o.N.DomUtils.hasAttrib(e,r.zj.type)&&delete e.attribs[r.zj.type]};var g=n(57792),p=n(98871);var h=n(38923);const v=(e,t,n)=>{const i=f(e),a=(0,h.O$)(e,g.z.internalErrorCode),o=(0,h.O$)(e,g.z.httpCode,(null==e?void 0:e.code)||a||""),r={errorMessage:i,serverRequestId:(0,h.O$)(e,g.z.correlationId)};t(i),(e=>{switch(e){case p.Bx.clientError:case p.Bx.badRequest:case p.Bx.internalServerError:case p.Bx.serviceUnavailable:case p.Bx.tooManyRequests:case p.Bx.unauthorizedAccess:return!0;default:return!1}})(parseInt(o||"",10))&&!S(parseInt(o||"",10),a)?n&&n.fail({errors:JSON.stringify(r),errorCode:`${o}`}):n&&n.incomplete({errors:JSON.stringify(r),errorCode:`${o||p.BS.Unhandled}`})},S=(e,t)=>e&&e===p.Bx.badRequest&&t&&t===p.BS.InvalidRequest,f=e=>{let t=(0,h.O$)(e,g.z.logErrorMessage,(null==e?void 0:e.message)||"");const n=(0,h.O$)(e,"innerError",{message:""});t=`${t}. ${n?n.message:""}`;const i={context:null==e?void 0:e.context,subContext:null==e?void 0:e.subContext};return t=`${t}. ${JSON.stringify(i)}`,t};var y=n(31821),k=n(59929),C=n(89925);const b={fileDetailsPromiseResolved:"file_deatails_promise_resolved"};var T=n(82250);let w=class{constructor(){this._allowAsyncChicletCreation=!1,this._asyncLinkConversionDetailsByItemId=new Map,this._loggerCb=l.noop,this._timeout=0}preTransform(e,t){var n;return(0,i.mG)(this,void 0,void 0,(function*(){if(!e||!t||!o.N.DomUtils.hasAttrib(e,"href"))return;this._setupConstants(t);const i=e.attribs[r.zj.itemid];if(i){if(this._allowAsyncChicletCreation&&o.N.DomUtils.hasAttrib(e,r.zj.type)&&e.attribs[r.zj.type]===u.le.asyncLinkToChicletConversionIdentifier){const a=(0,l.unescape)(e.attribs.href),{fileReferenceService:o}=t,r=o.parseFileLabelFromUrl(a);if(!r)return void m(e);const s=null===(n=this._scenarioFactory)||void 0===n?void 0:n.newScenario(T.RG.AsyncLinkToChiclet),c=this._asyncLinkConversionDetailsByItemId.get(i);if(c)return void x(c,a,s,(e=>this._asyncLinkConversionDetailsByItemId.set(i,e)));try{const e=(0,d.E)(o.getFileDetails(r,"chat",["fluid"]),this._timeout,"file details call timed out");this._asyncLinkConversionDetailsByItemId.set(i,{fileDetailsPromise:e,scenario:s,linkInfo:{href:a,count:1}})}catch(t){const n=(null==t?void 0:t.message)||"";return R(e,s,n)}}return e}}))}transform(e,t){return(0,i.mG)(this,void 0,void 0,(function*(){if(!(e&&o.N.DomUtils.hasAttrib(e,"href")&&t&&t.files&&t.messageProperties&&t.existingLinks))return;const n=e.attribs[r.zj.itemid];if(!n)return;const i=this._asyncLinkConversionDetailsByItemId.get(n);if(i){const{scenario:n}=i;try{const a=yield I(t,e,i);return n&&n.stop(),a}catch(t){return m(e),void v(t,this._loggerCb,n)}}if(!o.N.DomUtils.hasAttrib(e,r.zj.itemProps))return j(e,t);const{files:a}=t;try{const i=M(a,e);if(!i)return;const{shareUrl:o,title:r}=i;o&&(e.attribs.href=o),N(e,r,o),A(i,n,t)}catch(e){return}return e}))}_setupConstants({coreSettings:e,loggerFactory:t,scenarioFactory:n}){this._loggerCb=_(t.newLogger("SharepointLinkSerializer")),this._scenarioFactory=n;const{enableFilesAsyncChicletCreationInMultiWindow:i,asyncChicletCreationTimeout:a}=e.get(y.J.Files);this._allowAsyncChicletCreation=!!i,this._timeout=a||3e3}};w=(0,i.gn)([(0,a.HR)({name:"SharepointLinkSerializer",filter:"a"})],w);const _=e=>t=>{e.error(t)},I=(e,t,n)=>(0,i.mG)(void 0,void 0,void 0,(function*(){const{fileDetailsPromise:i,scenario:a}=n,o=yield i;return a&&a.mark(b.fileDetailsPromiseResolved),A(o,o.fileId,e),((e,t)=>{const{files:n}=t;return-1!==n.findIndex((t=>t.id===e.fileId))})(o,e)||P(e,(({objectUrl:e,shareUrl:t,type:n,fileId:i,title:a,baseUrl:o,shareId:r,fileSourceDetail:s})=>{const l=(0,k.gD)(e),{permissionScope:d}=s||{permissionScope:""};return{id:i,baseUrl:o,objectUrl:e,shareUrl:t,shareId:r,type:n,title:a,permissionScope:d,state:C.FileChicletState.reference,isReferencedFile:!0,serviceName:C.FileViewServiceName.p2p,previewUrl:"",chicletBreadcrumbs:{sourceChannelName:(null==l?void 0:l.sourceChannelName)||null,sourceTeamName:(null==l?void 0:l.sourceTeamName)||null},previewHeight:null,previewWidth:null,progressComplete:null,hasUploadFailed:!1}})(o)),m(t),t})),A=(e,t,n)=>{const{objectUrl:i,shareUrl:a,title:o,type:r}=e,s=D({objectUrl:i,shareUrl:a,itemid:t,type:r,title:o});F(n,s)},N=(e,t,n)=>{e.children&&E(t,e,n)},E=(e,t,n)=>{const i=[t];for(;0!==i.length;){const a=i.pop();if(a&&a.children)for(const o of a.children){if("text"===o.type&&(0,l.startsWith)(o.data,"https"))return o.data=e,t.attribs&&(t.attribs.title=n),!0;i.push(o)}}return!1},D=({objectUrl:e,shareUrl:t,itemid:n,type:i,title:a})=>({title:a,objectUrl:e,description:"",fileShareUrlMeta:{id:n,objectUrl:e,type:i,shareUrl:t}}),F=(e,t)=>{e.messageProperties.embeddedLinks=[...e.messageProperties.embeddedLinks||[],t],e.telemetryDatabag["DataBag.links"]=(e.telemetryDatabag["DataBag.links"]||0)+1},P=(e,t)=>{e.files.push(t)},M=(e,t)=>{const n=t.attribs[r.zj.itemid],i=e.find((e=>e.id===n));if(i){const{shareUrl:e,title:t,objectUrl:n,type:a}=i;return{shareUrl:e||"",title:t||"",type:a||"",objectUrl:n||""}}if(t.attribs[r.zj.itemtype]===s.T.filesHyperlink){const e=t.attribs[r.zj.itemProps];if(e){const t=(0,l.unescape)((0,l.unescape)(e)),n=JSON.parse(t),{type:i,objectUrl:a,shareUrl:o,title:r}=n;return{shareUrl:o,title:r,objectUrl:a,type:i}}}},j=(e,t)=>{if(o.N.DomUtils.hasAttrib(e,"href")){const n=e.attribs.href||"",i=t.existingLinks.filter((e=>{var t;return(null===(t=e.fileShareUrlMeta)||void 0===t?void 0:t.shareUrl)===n}));if(i&&i.length&&i[0].fileShareUrlMeta)return F(t,(0,c.i)(i[0],"__typename")),e}},R=(e,t,n)=>{m(e),null==t||t.fail({errorCode:u.le.telemetry.errorCodes.asyncLinkConversionPretransformFailure,errors:JSON.stringify(n)})},x=(e,t,n,i)=>{const{linkInfo:a}=e;let o="";if(a&&t===a.href){const{count:n}=a;o=`Duplicate links: ${n}`,i(Object.assign(Object.assign({},e),{linkInfo:{href:t,count:n+1}}))}else o="Different href for same itemid";null==n||n.incomplete({errorCode:u.le.telemetry.errorCodes.asyncLinkMultiplePretransform,errors:o})};var O=n(82059),L=n(69412),U=n(78808),B=n(96843);let W=class{constructor(){this._removeExtraSpacesInMention=e=>{var t;null===(t=e.parent)||void 0===t||t.children.forEach((e=>{"text"===e.type&&" "===e.data&&o.N.DomUtils.removeElement(e)}))},this._getMentionKey=e=>{var t,n,i;const a=null===(n=null===(t=e.children)||void 0===t?void 0:t[0])||void 0===n?void 0:n.data;return`${null===(i=e.attribs)||void 0===i?void 0:i[r.zj.mri]}_${a}`},this._mergeMentions=(e,t)=>{if(!e.attribs)return;const n=e.attribs[r.zj.mri]||"";let i=this._getNextContigousMention(e,n);for(;e.children&&e.children.length>0&&i;){const a=i.children;if(a&&a.length>0&&a[0].data){const n=this._getMentionKey(i),o=t.get(n);o?t.set(n,o+1):t.set(n,1),e.children[0].data+=` ${a[0].data}`}i=this._getNextContigousMention(i,n)}},this._getNextContigousMention=(e,t)=>{var n;if(!e||!e.next)return null;const i=e.next,a=t===(null===(n=null==i?void 0:i.attribs)||void 0===n?void 0:n[r.zj.mri]);return" "===i.data||a?i:null}}transform(e,t){var n;if(!(e&&t&&t.messageProperties&&o.N.DomUtils.hasAttrib(e,r.zj.mri)))return;t.seenMentions||(t.seenMentions=new Map);const i=this._getMentionKey(e),a=t.seenMentions.get(i);if(a)return 1===a?t.seenMentions.delete(i):t.seenMentions.set(i,a-1),null;this._mergeMentions(e,t.seenMentions);const{messageProperties:d,telemetryDatabag:c}=t;d.mentions||(d.mentions=[]);const u=`${d.mentions.length}`,m=(0,L.Q)(e),g=(null===(n=null==e?void 0:e.attribs)||void 0===n?void 0:n[r.zj.type])||(G(e)?"bot":"person");c["DataBag.atmentions"]=(c["DataBag.atmentions"]||0)+1;const p=(0,L.ln)(O.s.span),h=(0,L.rw)((0,l.escape)(m)),v=o.N.DomUtils.hasAttrib(e,r.zj.stale),S=o.N.DomUtils.getAttributeValue(e,r.zj.mri)||"";return o.N.DomUtils.appendChild(p,h),v||(d.mentions.push({itemId:u,displayName:m,userId:S,mentionType:g}),"webhook"===g&&d.mentions.push({itemId:u,displayName:m,userId:U.BB.InterceptorBotMris[0],mentionType:"person"}),p.attribs[r.zj.itemtype]=s.T.mention,p.attribs[r.zj.itemscope]="",p.attribs[r.zj.itemid]=u),this._removeExtraSpacesInMention(e),p}};W=(0,i.gn)([(0,a.wx)({name:"AtMentionSerializer",filter:"mention"})],W);const G=e=>{var t;return(0,B.bl)((null===(t=null==e?void 0:e.attribs)||void 0===t?void 0:t[r.zj.mri])||"")};let V=class{transform(e,t){if(!e.attribs)return void t.logger.error("image attribs is missing");const n=o.N.DomUtils.getAttributeValue(e,r.zj.cacheKey);if(n&&n.length)return e.attribs["data-cke-saved-src"]=void 0,e.attribs.src=t.offlineCacheManager.getCachedUrlByKey(n),e;t.logger.error("image missing cache key")}};V=(0,i.gn)([(0,a.wx)({name:"CachedImageSerializer",filter:[{itemtype:s.T.cachedImage}]})],V);let H=class{preTransform(e){return null}};H=(0,i.gn)([(0,a.wx)({name:"RemoveHiddenSelectionSerializer",filter:["data-cke-hidden-sel"]})],H);var $=n(59875);let z=class{transform(e){if(e.data&&$.Eh.test(e.data))return e.data=e.data.replace(new RegExp($.Eh,"g"),""),e}};z=(0,i.gn)([(0,a.wx)({name:"RemoveZwsSerializer",filter:"text",transient:!0})],z);const q="data-only-whitespace",J=/^(\s|[\u200B-\u200D\uFEFF])*$/;let Q=class{preTransform(e,t){return K(e)?void(t.whiteSpaceId&&t.whiteSpaceId++):(t.whiteSpaceId||(t.whiteSpaceId=1),e.attribs||(e.attribs={}),e.attribs[q]=`${t.whiteSpaceId+1}`,e)}};Q=(0,i.gn)([(0,a.wx)({name:"WhiteSpacePreprocessor",filter:["div","p","br","span","text"],transient:!0})],Q);const K=e=>!J.test((0,L.Q)(e))||!!o.N.DomUtils.findOne((e=>{if(e.attribs&&Object.keys(e.attribs).length||!e.name)return!0;switch(e.name.toLowerCase()){case"br":case"div":case"p":case"span":break;default:return!0}return!1}),[e]);let Y=class{transform(e,t){const n=o.N.DomUtils.getAttributeValue(e,q);return!t.whiteSpaceId||!n||+n>t.whiteSpaceId?null:(e.attribs&&delete e.attribs[q],e)}};var X;Y=(0,i.gn)([(0,a.wx)({name:"TrailingWhiteSpaceSerializer",filter:[q],transient:!0})],Y),function(e){e.CodeSnippet="application/vnd.microsoft.card.codesnippet",e.Fluid="application/vnd.microsoft.card.fluid",e.FluidEmbed="application/vnd.microsoft.card.fluidEmbedCard"}(X||(X={}));var Z=n(86125);let ee=class{transform(e,t){return(0,i.mG)(this,void 0,void 0,(function*(){if(!e||!t.messageProperties)return;this._logger=t.loggerFactory.newLogger("CodeSnippetsSerializer"),this._scenarioFactory=t.scenarioFactory,this._settings=t.coreSettings;const n=(0,l.unescape)(o.N.DomUtils.getAttributeValue(e,$.Qq)),i=o.N.DomUtils.getAttributeValue(e,$.fK),[a]=o.N.DomUtils.getElementsByTagName("code",e);if(!n)return this._logger.error("The props was missing"),null;if(!a)return this._logger.error("The code snippet was missing"),null;if(!i)return this._logger.error("The id of the card was missing"),null;try{yield this._uploadAndUpdateCard(i,JSON.parse(n),a,t);const e=(0,L.ln)("span",{content:i,itemprop:"cardId"}),r=(0,L.ln)("span",{class:"inline-compose-card",itemid:i,itemscope:"",itemtype:s.T.inputExtension});return o.N.DomUtils.appendChild(r,e),this._logger.debug("Uploaded code snippet",i),r}catch(e){return this._logger.error("Failed to upload the code snippet!"),null}}))}_uploadCodeSnippet(e,t,n){var a;return(0,i.mG)(this,void 0,void 0,(function*(){const{source:i}=e,r=`${i}~~~~###@@TACOCAT@@###~~~~${o.N.DomUtils.getInnerHTML(t)}`,s=null===(a=this._scenarioFactory)||void 0===a?void 0:a.newScenario(T.RG.CodeSnippetUpload);try{const{objectId:e}=yield this._uploadToAMS(r,n,this._logger);return null==s||s.stop(),{objectId:e,uploadType:"AMS"}}catch(e){this._logger.error("_uploadCodeSnippet: code snippet upload to ams failed!"),null==s||s.fail();const{enableCacheStorageInSendMessageMW:t}=this._settings.get(y.J.Messaging);if(t){this._logger.debug("Trying to upload code snippet to cache storage");const{objectId:e}=yield this._uploadToCache(r,n,this._logger);return{objectId:e,uploadType:"OfflineCache"}}throw this._logger.debug("_uploadCodeSnippet: enableCacheStorageInSendMessageMW is not enabled!"),e}finally{null==s||s.stop()}}))}_uploadToAMS(e,t,n){return(0,i.mG)(this,void 0,void 0,(function*(){n.log("Uploading to code snippet to ams");const{objectId:i}=yield t.asyncMediaService.uploadItem(e,t.conversationId,"DOCUMENT",Z.r1.Attached);return{objectId:i}}))}_uploadToCache(e,t,n){return(0,i.mG)(this,void 0,void 0,(function*(){try{n.log("uploading inline image to offline cache storage");const[i,a]=yield t.offlineCacheManager.saveDynamic(new Response(e,{headers:new Headers({"Content-Type":"text/html","Cache-Control":"max-age=259200, s-maxage=0, private","Content-Length":`${e.length}`,Date:(new Date).toUTCString()})}));return n.log(`Uploaded image to offline cache, image: ${a} objectId: ${i}`),{objectId:i}}catch(e){throw n.error("_uploadToCache: uploading inline image to offline cache store failed!"),e}}))}_uploadAndUpdateCard(e,t,n,a){return(0,i.mG)(this,void 0,void 0,(function*(){const{amsReferenceId:i}=t,{name:o,language:r,wrap:s}=t,l=a.messageProperties.cards||[];let d={objectId:i,uploadType:"AMS"};if(i||(d=yield this._uploadCodeSnippet(t,n,a)),"AMS"===d.uploadType){const e=a.messageProperties.amsReferences||[];a.messageProperties.amsReferences=[...e,d.objectId]}else if("OfflineCache"===d.uploadType){const e=a.messageProperties.offlineAssets||[];a.messageProperties.offlineAssets=[...e,d.objectId]}a.messageProperties.cards=[...l.filter((t=>t.cardClientId!==e)),{appId:e,cardClientId:e,contentType:X.CodeSnippet,content:JSON.stringify({type:X.CodeSnippet,editable:!0,id:e,name:o,language:r,wrap:s,lines:n.children?n.children.length:0,cardClientId:e,amsReferenceId:d.objectId})}],a.telemetryDatabag["DataBag.codeSnippets"]=(a.telemetryDatabag["DataBag.codeSnippets"]||0)+1}))}};ee=(0,i.gn)([(0,a.HR)({name:"CodeSnippets",filter:{[$.$S]:"CodeSnippetCard"}})],ee);var te=n(68630);const ne=new RegExp(te.Uu),ie=new RegExp(/animated-emoticon.*?/),ae=/img|table/,oe=e=>{return!!e&&(o.N.DomUtils.getAttributeValue(e,"itemtype")===s.T.emoji||ie.test(o.N.DomUtils.getAttributeValue(e,"class")||"")||(t=e,ne.test(o.N.DomUtils.getAttributeValue(t,"class")||"")));var t},re=3;let se=class{preTransform(e,t){const n=(0,l.isUndefined)(t.superSizeEmoticons)?0:t.superSizeEmoticons;var i;"br"===e.name?t.containsPotentiallyIncludedWhitespace=!0:(0,l.isNumber)(n)&&(t.superSizeEmoticons=oe(e)?(i=n,!t.containsPotentiallyIncludedWhitespace&&i<re&&i+1):!(e=>e&&!oe(e.parent)&&!(e.parent&&oe(e.parent.parent))&&(ae.test(e.name||"")||!(!e.data||!e.data.replace("","").replace(/[\u200B-\u200D\uFEFF]/g,"").trim())))(e)&&n)}};se=(0,i.gn)([(0,a.wx)({name:"BigEmoticonPreprocessor",filter:"*"})],se);let le=class{transform(e,t){const n=`${!!t.superSizeEmoticons?$.G4:$.Mw}px`;return e.attribs||(e.attribs={}),e.attribs.height=n,e.attribs.width=n,(0,L.A_)(e,{"max-height":n,"max-width":n,height:n,width:n}),e}};le=(0,i.gn)([(0,a.wx)({name:"EmojiOneSerializer",filter:{class:new RegExp(te.Uu)}})],le);var de=n(84390);let ce=class{transform(e,t){const n=t.superSizeEmoticons?"large":"small",i=(0,de.cn)(n),a=t=>o.N.DomUtils.getAttributeValue(e,t)||"",r=a("itemid");t.telemetryDatabag&&(t.telemetryDatabag["DataBag.emojiList"]=[...t.telemetryDatabag["DataBag.emojiList"]||[],`Skype.${r}`],t.telemetryDatabag["DataBag.emoji"]=t.telemetryDatabag["DataBag.emojiList"].length);const l=(0,L.ln)("span",{contenteditable:"false",title:a("title"),type:`(${r})`,class:`animated-emoticon-${i}-${r}`}),d=a("alt")||a("itemscope"),c=(0,L.ln)("img",{itemscope:"",itemtype:s.T.emoji,itemid:r,src:(0,de.rO)(r,n,t.coreSettings.get(y.J.Messaging),!1),title:a("title"),alt:d,style:`width:${i}px;height:${i}px;`});return o.N.DomUtils.appendChild(l,c),l}};ce=(0,i.gn)([(0,a.wx)({name:"EmoticonSerializer",filter:{itemtype:s.T.emoji}})],ce);let ue=class{transform(e){return o.N.DomUtils.getAttributeValue(e,r.zj.itemProps)&&delete e.attribs[r.zj.itemProps],e}};ue=(0,i.gn)([(0,a.wx)({name:"FluidEmbedSerializer",filter:{itemtype:s.T.fluidEmbedLink}})],ue);var me=n(70700);let ge=class{transform(e,t){const n=o.N.DomUtils.getAttributeValue(e,"href");if(!n||!e.attribs)return;const i=n.replace(/&amp;/g,"&");o.N.DomUtils.getAttributeValue(e,r.zj.itemProps)&&delete e.attribs[r.zj.itemProps];const a={appId:"fluid-card",cardClientId:(0,me.Z)(),contentType:X.Fluid,content:JSON.stringify({componentUrl:i})};return t.messageProperties.cards=[a],t.files=void 0,e}};ge=(0,i.gn)([(0,a.wx)({name:"FluidSerializer",filter:{itemtype:s.T.fluidLink}})],ge);var pe=n(26632),he=n(18548),ve=n(99342);const Se=new RegExp([".*\\.asm\\.skype\\.com$",".*\\.asyncgw\\.teams\\.microsoft\\.com$",".*\\.ams\\.gcc\\.teams\\.microsoft\\.com$",".*\\.ams\\.gov\\.teams\\.microsoft\\.us$",".*\\.ams\\.dod\\.teams\\.microsoft\\.us$",".*\\.asyncgw\\.teams\\.microsoft\\.scloud$",".*\\.asyncgw\\.teams\\.microsoftonline\\.cn$","\\urlp\\.sfbassets\\.com$","statics\\.gov\\.teams\\.microsoft\\.us$","statics\\.dod\\.teams\\.microsoft\\.us$","statics\\.teams\\.microsoft\\.com$","statics\\.teams\\.cdn\\.office\\.net$","staticsint\\.teams\\.cdn\\.office\\.net$","statics-dev\\.teams\\.cdn\\.office\\.net$","statics\\.teams\\.cdn\\.live\\.net$","staticsint\\.teams\\.cdn\\.live\\.net$","statics-dev\\.teams\\.cdn\\.live\\.net$","statics-cn\\.teams\\.cdn\\.office\\.net$","media.*\\.giphy\\.com$","local\\.teams\\.(?:office|live)\\.com$"].join("|"),"i"),fe=new RegExp([".*\\logout*"].join("|"),"i"),ye=/^\/asm\/[a-z]+/i,ke=e=>(e=>{const t=(0,ve.J)().location.origin;if((0,he.nz)(e,t))return!0;const n=(0,he.Lp)(e).toLowerCase(),i=(0,he.DW)(e).toLowerCase();return Se.test(n)||"teams.microsoft.com"===n&&ye.test(i)})(e)&&(e=>{const t=(0,he.DW)(e).toLowerCase();return!fe.test(t)})(e)||e.startsWith("data:image");var Ce=n(55997),be=n(25366);let Te=class{constructor(){this.getImageBlobUrlFromCache=(e,t)=>(0,i.mG)(this,void 0,void 0,(function*(){const n=yield e.offlineCacheManager.get(t),i=yield n.blob();return URL.createObjectURL(i)})),this.processCachedImage=(e,t)=>(0,i.mG)(this,void 0,void 0,(function*(){var n;const i=o.N.DomUtils.getAttributeValue(e,r.zj.cacheKey);if(!i)return void this._logger.error("Cached image missing key attribute.");this._logger.log(`processing cached image: ${i}`);const a=null===(n=this._scenarioFactory)||void 0===n?void 0:n.newScenario(T.RG.SerializeCachedImage);try{const n=o.N.DomUtils.getAttributeValue(e,"src"),s=!!(null==n?void 0:n.startsWith("blob"));let l;try{const e=yield t.offlineCacheManager.get(i);l=yield null==e?void 0:e.blob()}catch(e){l=null,this._logger.warn(`processCachedImage: Could not find cached image with key=${i} in offlineCacheManager`)}if(!l&&s&&n&&(l=yield(0,be.Hk)(n)),null===l)throw Error("Could not get image Blob neither from cache nor from blob data");null==a||a.mark(T.ck.SerializeCachedImageGotData);const d=yield this.uploadImage(l,t);if(we(e,d,t),null==a||a.mark(T.ck.SerializeCachedImageUploadedData),"OfflineCache"!==d.uploadType){const n=yield t.offlineCacheManager.delete(i);null==a||a.mark(T.ck.SerializeCachedImageDeletedEntry,void 0,n?"success":"failure"),n||this._logger.warn(`Failed to delete cached image with key: ${i}`),e.attribs&&delete e.attribs[r.zj.cacheKey]}}catch(e){throw this._logger.error(`processCachedImage: Failed to process cached image with key=${i}`),null==a||a.fail(),e}finally{null==a||a.stop()}return e}))}transform(e,t){if(this._logger=t.loggerFactory.newLogger("InlineImageSerializer"),!this.isConfigValid(t))return this._logger.error("invalid config"),Promise.resolve(void 0);this._scenarioFactory=t.scenarioFactory,this._settings=t.coreSettings;const n=o.N.DomUtils.getAttributeValue(e,"src");if(!n)return this._logger.error("image src is missing"),Promise.resolve(void 0);const i=(0,pe.KD)(n);if(i)return this.handleAmsSourceTag(i,e,t);const{enableImprovedImageHandling:a,enableComposeFrameworkV2:l}=this._settings.get(y.J.Messaging);if(a&&l){const n=o.N.DomUtils.getAttributeValue(e,"data-orig-src");if(n){const i=(0,pe.KD)(n);if(i)return this.handleAmsSourceTag(i,e,t)}}return o.N.DomUtils.getAttributeValue(e,r.zj.itemtype)===s.T.cachedImage?this.processCachedImage(e,t):n.startsWith("http://")||n.startsWith("https://")?ke(n)?this.processKnownImage(n,t.telemetryDatabag):this.handleKnownProtcolSourceTag(n,"HttpUrl",e,t):n.startsWith("blob:")?this.handleKnownProtcolSourceTag(n,"BlobUrl",e,t):(this._logger.error("Unsupported image! deleting it."),Promise.resolve(null))}handleAmsSourceTag(e,t,n){return(0,i.mG)(this,void 0,void 0,(function*(){try{const i="AMS",a=yield n.asyncMediaService.forwardContent(e,n.conversationId);return this._logger.log(`forwarded ams image ${e} to ${a.objectId}`),n.messageProperties.amsReferences=[...n.messageProperties.amsReferences||[],a.objectId],we(t,Object.assign(Object.assign({},a),{uploadType:i}),n),t}catch(e){throw this._logger.error("handleAmsSourceTag: forward content failed!"),e}}))}handleKnownProtcolSourceTag(e,t,n,a){return(0,i.mG)(this,void 0,void 0,(function*(){try{const i=yield _e(e,t,a),o=yield this.uploadImage(i,a);return we(n,o,a),n}catch(e){throw this._logger.error("handleKnownProtcolSourceTag: pasted from web image upload failed"),this.addDiagnosticCodeToError(e),e}}))}uploadImage(e,t,n=!1){return(0,i.mG)(this,void 0,void 0,(function*(){try{return yield this.uploadImageToAms(e,t,this._logger)}catch(i){this._logger.error("uploadImage: image upload to AMS failed!");const{enableCacheStorageInSendMessageMW:a,msgEnableRestrictImagePasting:o}=this._settings.get(y.J.Messaging);if(!a||o||n)throw i;this._logger.debug("Trying to upload inline image to cache storage");return yield this.uploadToCache(e,t,this._logger)}}))}uploadImageToAms(e,t,n){return(0,i.mG)(this,void 0,void 0,(function*(){const i=t.asyncMediaService.createAmsScenario(T.RG.AmsImageUpload);try{const a="AMS",o=yield t.asyncMediaService.uploadItem(e,t.conversationId,"IMAGE","MicrosoftTeams-image.png",Z.r1.Inline);return n.log(`Uploaded image to ams, image: ${o.inlineSizeUrl} objectId: ${o.objectId}`),i.stop(),t.messageProperties.amsReferences=[...t.messageProperties.amsReferences||[],o.objectId],Object.assign(Object.assign({},o),{uploadType:a})}catch(e){throw i.fail({errors:e.message}),n.error("Ams image upload failed!"),e}}))}uploadToCache(e,t,n){return(0,i.mG)(this,void 0,void 0,(function*(){try{n.log("uploading inline image to offline cache storage");const[i,a]=yield t.offlineCacheManager.saveDynamic(new Response(e,{headers:new Headers({"Content-Type":e.type,"Cache-Control":"max-age=259200, s-maxage=0, private","Content-Length":`${e.size}`,Date:(new Date).toUTCString()})}));n.log(`Uploaded image to offline cache, image: ${a} objectId: ${i}`);const o="OfflineCache";t.messageProperties.offlineAssets=[...t.messageProperties.offlineAssets||[],i];return{objectId:i,inlineSizeUrl:yield this.getImageBlobUrlFromCache(t,i),uploadType:o}}catch(e){throw n.error("uploadToCache: uploading inline image to offline cache store failed!"),e}}))}isConfigValid(e){return!!(e&&e.asyncMediaService&&e.messageProperties&&e.imageProxyService&&e.conversationId&&e.telemetryDatabag&&e.offlineCacheManager)}processKnownImage(e,t){return e.endsWith(".gif")&&(t["DataBag.giphy"]=(t["DataBag.giphy"]||0)+1),Promise.resolve(void 0)}addDiagnosticCodeToError(e){if(e.serverResponse&&e.serverResponse.status){switch(e.serverResponse.status){case Ce.qb.UNSUPPORTED_MEDIA_TYPE:e.reason=Object.assign(Object.assign({},e.reason),{errorCode:pe.hA.IMAGE_SIZE_TOO_LARGE})}}}};Te=(0,i.gn)([(0,a.HR)({name:"InlineImageSerializer",filter:["img","image"]})],Te);const we=(e,t,n)=>{e.attribs||(e.attribs={}),e.attribs.id=t.objectId,e.attribs.itemid=t.objectId,e.attribs.href=t.inlineSizeUrl,e.attribs["target-src"]=t.inlineSizeUrl,e.attribs.src=t.inlineSizeUrl,e.attribs[r.zj.itemtype]="AMS"===t.uploadType?s.T.amsImage:s.T.cachedImage,n.telemetryDatabag["DataBag.inlineImages"]=(n.telemetryDatabag["DataBag.inlineImages"]||0)+1},_e=(e,t,n)=>(0,i.mG)(void 0,void 0,void 0,(function*(){let i=null;return"BlobUrl"===t?i=yield(0,be.Hk)(e):"HttpUrl"===t&&(i=yield n.imageProxyService.getImageAsBlob(e)),i}));var Ie=n(87229),Ae=n(53910),Ne=n(52989);let Ee=class{transform(e,t){var n,a,o,r;return(0,i.mG)(this,void 0,void 0,(function*(){this._logger=t.loggerFactory.newLogger("InlineVideoSerializer");const i=t.scenarioFactory.newScenario(T.RG.InlineVideoAsyncTransform),{conversationId:s,videoMessageLieUpdater:l}=t;if(!(e&&e.attribs&&0!==Object.keys(e.attribs).length&&t.asyncMediaService&&t.offlineCacheManager&&l))return i.fail({errorCode:"unexpected_precondition"}),void(null===(a=(n=this._logger).errorToTelemetry)||void 0===a||a.call(n,`unexpected precondition : element - ${e}`,"messaging_inline_video_serializer_error_tracking",void 0,!0));this._offlineCacheManager=t.offlineCacheManager,this._asyncMediaService=t.asyncMediaService;const d=De(e);if(!d)return i.fail({errorCode:"malformed_video_message"}),void(null===(r=(o=this._logger).errorToTelemetry)||void 0===r||r.call(o,`malformed video message: element - ${e}, additionalData - ${t}`,"messaging_inline_video_serializer_error_tracking",void 0,!0));i.appendEventData({correlationId:d.cacheKey});const c=yield this.resolveAMSItem(i,s,l,d),u=t.scenarioFactory.newScenario(T.RG.VideoMessageThumbnailUpload);u.appendEventData({correlationId:d.cacheKey}),yield this.bestEffortUploadAMSVideoThumbnail(u,c,l,d),u.stop(),yield this.uploadAMSVideo(i,c,l,d),t.messageProperties.amsReferences=[...t.messageProperties.amsReferences||[],c];const m=this.createVideoMessageTag(e.attribs,d.src);return this.bestEffortCleanOfflineCacheManager(i,d.cacheKey,!!d.thumbnailUploadProgress),i.stop(),m}))}createVideoMessageTag(e,t){const n=(0,L.ln)("video",{src:t,itemscope:"",itemtype:s.T.amsVideo,"data-duration":e[r.zj.duration],width:e[r.zj.width],height:e[r.zj.height]});return n.children=[(0,L.rw)(Ie.R2)],n}resolveAMSItem(e,t,n,a){return(0,i.mG)(this,void 0,void 0,(function*(){try{const i=yield this.createAMSObjectIfRequired(e,t,n,a.cacheKey,a.src);return a.src=i.src,i.objectId}catch(t){throw e.fail({errorCode:"create_ams_object_failed"}),new Error(`create ams object failed:${t.toString()}`)}}))}createAMSObjectIfRequired(e,t,n,a,o){return(0,i.mG)(this,void 0,void 0,(function*(){if(!o){e.mark(T.ck.ItemCreationStart);const i=yield this._asyncMediaService.createVideoObject(t,a),o=(0,Ie.$N)(i.amsUrl,i.objectId);return this.bestEffortMessageLieUpdate(e,n,a,r.zj.src,o),e.mark(T.ck.ItemCreationStop),Object.assign(Object.assign({},i),{src:o})}e.mark(T.ck.UploadRetry);return{objectId:(0,pe.KD)(o),amsUrl:(0,he.DW)(o),src:o}}))}bestEffortUploadAMSVideoThumbnail(e,t,n,a){return(0,i.mG)(this,void 0,void 0,(function*(){if(a.thumbnailUploadProgress&&a.thumbnailUploadProgress.progress!==a.thumbnailUploadProgress.total)try{const i=yield this.uploadAMSVideoThumbnail(e,t,n,a.cacheKey);a.thumbnailUploadProgress=i}catch(t){this._logger.warn("video thumbnail upload failed",t),e.fail({errorCode:"thumbnail_upload_failed"})}}))}uploadAMSVideoThumbnail(e,t,n,a){return(0,i.mG)(this,void 0,void 0,(function*(){e.mark(T.ck.ThumbnailUploadStart);const i=yield this._offlineCacheManager.get((0,Ae.cQ)(a)),o=yield i.blob();yield this._asyncMediaService.uploadVideoThumbnail(t,o,a);const s={progress:o.size,total:o.size};return this.bestEffortMessageLieUpdate(e,n,a,r.zj.thumbnailUploadProgress,(0,Ie.tl)(s.progress,s.total)),e.mark(T.ck.ThumbnailUploadStop),s}))}uploadAMSVideo(e,t,n,a){return(0,i.mG)(this,void 0,void 0,(function*(){try{e.mark(T.ck.VideoUploadStart);const i=yield this._offlineCacheManager.get((0,Ae.If)(a.cacheKey)),o=yield i.blob();yield this._asyncMediaService.uploadVideo(t,a.uploadProgress.progress,o,this.updateMessageLieVideoUploadProgress(e,n,a),a.cacheKey),e.mark(T.ck.VideoUploadStop)}catch(t){throw e.fail({errorCode:"video_upload_failed"}),new Error(`video upload failed:${t.toString()}`)}}))}bestEffortCleanOfflineCacheManager(e,t,n){return(0,i.mG)(this,void 0,void 0,(function*(){try{yield this._offlineCacheManager.delete((0,Ae.If)(t))}catch(t){this._logger.warn("video cache cleanup failed",t),e.mark(T.ck.VideoCacheCleanFailed)}try{n&&(yield this._offlineCacheManager.delete((0,Ae.cQ)(t)))}catch(t){this._logger.warn("thumbnail cache cleanup failed",t),e.mark(T.ck.ThumbnailCacheCleanFailed)}}))}updateMessageLieVideoUploadProgress(e,t,n){return i=>{const a=i+1;n.uploadProgress.progress=a,this.bestEffortMessageLieUpdate(e,t,n.cacheKey,r.zj.uploadProgress,(0,Ie.tl)(n.uploadProgress.progress,n.uploadProgress.total))}}bestEffortMessageLieUpdate(e,t,n,i,a){try{t(n,i,a)}catch(t){e.mark(T.ck.MessageLieUpdateFailed),this._logger.warn(t.toString())}}};Ee=(0,i.gn)([(0,a.HR)({name:"InlineVideo",filter:[{itemtype:s.T.amsVideo}]})],Ee);const De=e=>{const t=o.N.DomUtils.getAttributeValue,n=t(e,r.zj.itemtype),i=t(e,r.zj.cacheKey),a=t(e,r.zj.src),s=t(e,r.zj.uploadProgress),l=t(e,r.zj.thumbnailUploadProgress),d=t(e,r.zj.duration),c=t(e,r.zj.width),u=t(e,r.zj.height);if(!n||!i||!s||!c||!u||!d||Number.isNaN(c)||Number.isNaN(u)||!(0,Ie.cJ)(s))return;const m={itemType:n,cacheKey:i,uploadProgress:(0,Ie.VI)(s),width:+c,height:+u,duration:+(0,Ne.J)(d)};return a&&(m.src=a),l&&(m.thumbnailUploadProgress=(0,Ie.VI)(l)),m};var Fe=n(3605);const Pe=(e,t,n)=>{e.forEach((e=>Me(e,t,n)))},Me=(e,t,n)=>{(0,Fe.gU)(e,{type:"TextBlock"},(e=>{je(e.text,t,n)})),(0,Fe.gU)(e,{type:"FactSet"},(e=>{e.facts.forEach((e=>{je(e.title,t,n),je(e.value,t,n)}))}))},je=(e,t,n)=>{const i=e.toLowerCase(),a='itemid="',o=i.indexOf(a),r=o+a.length;if(o>-1){const a=i.substring(r,r+1);if(t&&a){const i=Re(a,t,n);i&&(e=e.replace(new RegExp(a,"g"),i))}}},Re=(e,t,n)=>{let i="";return t.forEach((t=>{if(t.itemId===e){const{messageProperties:e,telemetryDatabag:a}=n;e.mentions||(e.mentions=[]),i=`${e.mentions.length}`;const o=t.displayName||"",r=t.mentionType||"",s=t.userId||"";a["DataBag.atmentions"]=(a["DataBag.atmentions"]||0)+1,e.mentions.push({itemId:i,displayName:o,userId:s,mentionType:r})}})),i};let xe=class{transform(e,t){if(!e||!t||!t.messageProperties)return;const{loggerFactory:n,coreSettings:a}=t,r=a.get(y.J.Extensibility).enableJITInstallForACv2FromComposeV2||!1,d=n.newLogger("MessageExtensionCardSerializer"),c=(0,l.unescape)(o.N.DomUtils.getAttributeValue(e,$.Qq)),u=o.N.DomUtils.getAttributeValue(e,$.fK);if(!c)return d.error("The props was missing"),null;if(!u)return d.error("The id of the card was missing"),null;try{const n=t.messageProperties.cards||[],{card:a,renderJitInstallConsentFooter:d}=JSON.parse(c);if(!(0,l.isObject)(a))throw new Error("not valid JSON object");(0,l.isString)(a.contentType)&&a.contentType.toLowerCase()===Fe.sj.Adaptive&&a.content&&((e,t)=>{const n=JSON.parse(e),i=n.body,a=(0,Fe.NI)(n);a&&i&&Pe(i,a,t)})(a.content,t);const{__typename:m}=a,g=(0,i._T)(a,["__typename"]);g.cardClientId=u,t.messageProperties.cards=[...n,g];const p=o.N.DomUtils.getElements({"data-tid":"jit-install-consent-footer"},e);(r?!!d:!(0,l.isEmpty)(p))&&(t.messageProperties.appIdsToInstall=(0,l.union)(t.messageProperties.appIdsToInstall,[a.appId]));const h=(0,L.ln)("span",{content:u,itemprop:"cardId"}),v=(0,L.ln)("span",{class:"inline-compose-card",itemid:u,itemscope:"",itemtype:s.T.inputExtension});return o.N.DomUtils.appendChild(v,h),v}catch(e){return d.error("Error while adding message extension card to message",e),null}}};xe=(0,i.gn)([(0,a.wx)({name:"MessageExtension",filter:{[$.$S]:"MessageExtensionCard"}})],xe);var Oe=n(66695);let Le=class{constructor(){}transform(e,t){const{loggerFactory:n}=t;if(!e)return;const i=(0,l.unescape)(o.N.DomUtils.getAttributeValue(e,$.Qq));if(!i)return;const a=(0,Oe.D)(i);if((0,l.isEmpty)(a))return void n.newLogger("QuotedReplySerializer").error("Json parsing failed: ",i);const{from:r,messageId:d,preview:c,timestamp:u,userName:m}=a;if(!(r&&d&&c&&m))return void n.newLogger("QuotedReplySerializer").error("Json parsing failed: ",i);const g=(0,L.ln)("blockquote",{itemscope:"",itemtype:s.T.reply,itemid:d}),p=(0,L.ln)("strong",{itemprop:"mri",itemid:r}),h=(0,L.rw)((0,l.escape)(m));if(o.N.DomUtils.appendChild(p,h),o.N.DomUtils.appendChild(g,p),u){const e=(0,L.ln)("span",{itemprop:"time",itemid:u.toString()});o.N.DomUtils.appendChild(g,e)}const v=(0,L.ln)("p",{itemprop:"preview"}),S=(0,L.rw)((0,l.escape)(c));return o.N.DomUtils.appendChild(v,S),o.N.DomUtils.appendChild(g,v),g}};Le=(0,i.gn)([(0,a.wx)({name:"QuotedReply",filter:{[$.$S]:"QuotedReplyCard"}}),(0,i.w6)("design:paramtypes",[])],Le);let Ue=class{transform(e){return(0,l.isEmpty)(e.children)&&o.N.DomUtils.appendChild(e,(0,L.rw)("")),e}};Ue=(0,i.gn)([(0,a.wx)({name:"TableCellSerializer",filter:"td",transient:!0})],Ue);let Be=class{transform(e){return e.attribs.class="copy-paste-table",e.attribs.itemprop="copy-paste-table",e}};Be=(0,i.gn)([(0,a.wx)({name:"TableSerializer",filter:"table",transient:!0})],Be);var We=n(75068);let Ge=class{transform(e,t){return(0,i.mG)(this,void 0,void 0,(function*(){const n=t.coreSettings.get(y.J.Extensibility).postSendTimeoutInMs||2e3,{areUrlPreviewsAllowed:i}=t.coreSettings.get(y.J.Messaging);if(!!!i||!t.connectedExperienceEnabled||!e||!t.messageProperties||t.messageProperties.urlPreview||!t.urlPreviewService||!t.appBasedLinkService||!o.N.DomUtils.hasAttrib(e,"href"))return;const a=t.loggerFactory.newLogger("UrlPreviewSerializer"),r=e.attribs.href||"",s=[this.getUrlPreviewFromAppTimed(r,n,t,a),this.getUrlPreviewTimed(r,n,t,a)],[l,d]=yield Promise.all(s),c=l||d&&He(d);return c?(t.messageProperties.urlPreview=c,e):void 0}))}getUrlPreviewFromAppTimed(e,t,n,a){return(0,i.mG)(this,void 0,void 0,(function*(){const{enableAppBasedLink:i}=n.coreSettings.get(y.J.Extensibility);if(!i)return Promise.resolve(void 0);const o=n.scenarioFactory.newScenario(T.RG.ExtGetAppPreviewPostSend),r=n.getInstalledMessageExtensionApps(),s="post send app preview timed out";try{const i=yield(0,d.E)(n.appBasedLinkService.getUrlPreviewFromApp(e,r,n.getAppDefinitions,o,n.convId),t,s);return o.stop(),i}catch(t){return Ve(t)&&t.code===We.jK.TimedOut&&t.context===We.w5.Timed?o.incomplete({errors:s}):o.fail(),void a.warn(`fetching app preview for url: ${e} failed with error: ${t}`)}}))}getUrlPreviewTimed(e,t,n,a){return(0,i.mG)(this,void 0,void 0,(function*(){try{return yield(0,d.E)(n.urlPreviewService.getPreview(e),t,"url preview timed out")}catch(t){return void a.warn(`fetching url preview for url: ${e} failed with error: ${t}`)}}))}};Ge=(0,i.gn)([(0,a.HR)({name:"URLPreviewSerializer",filter:"a",transient:!0})],Ge);const Ve=e=>!!(e&&((0,l.get)(e,"code")&&(0,l.get)(e,"context")||(0,l.get)(e,"reason"))),He=e=>({url:e.url,title:e.title,description:e.description,previewEnabled:!0,thumbnail:e.thumbnail,thumbnailMeta:e.thumbnail_meta});var $e=n(72867);let ze=class{transform(e,t){if(!e||!o.N.DomUtils.hasAttrib(e,r.zj.itemid))return;const n=(0,L.ln)(O.s.span),i=(0,L.rw)((0,L.Q)(e));o.N.DomUtils.appendChild(n,i);const a=o.N.DomUtils.getAttributeValue(e,r.zj.itemid)||"",l=(0,$e.I6)({userAadObjectId:t.authenticationUser.profile.objectId,tenantAadObjectId:t.authenticationUser.profile.tenantId});return null==l||l.logEvent("Cortex.TopicAnnotations.ManualTag.Send",{topicId:a,isTopicNameNumeric:!isNaN(parseFloat(this._getTopicName(e))),contextId:t.convId}),n.attribs[r.zj.itemtype]=s.T.topic,n.attribs[r.zj.itemid]=a,n}_getTopicName(e){const t=(0,L.Q)(e);return t.startsWith("#")?t.substring(1):t}};ze=(0,i.gn)([(0,a.wx)({name:"TopicSerializer",filter:"topic"})],ze);var qe=n(83250);const Je=[qe.TV,qe.Hl];let Qe=class{constructor(){}transform(e){var t,n,i;if(e&&(null===(t=e.children)||void 0===t?void 0:t.length)){const t=(0,L.kE)(e.children)[0],a=null===(n=null==e?void 0:e.prev)||void 0===n?void 0:n.attribs[$.$S],o=null===(i=null==e?void 0:e.next)||void 0===i?void 0:i.attribs[$.$S];let r=qe.sb;return(a&&Je.includes(a)||o&&Je.includes(o))&&(r=qe.ST),t.attribs={itemtype:r,[$.$S]:null==e?void 0:e.attribs[$.$S]},t}}};Qe=(0,i.gn)([(0,a.wx)({name:"InlineImageCardsSerializer",filter:[{[$.$S]:qe.TV},{[$.$S]:qe.Hl}]}),(0,i.w6)("design:paramtypes",[])],Qe);const Ke=[W],Ye=[z,H,se,W,ze,Ue,Be,ce,le,Q,Y,ge,ue,xe,Le,Qe],Xe=[Te,ee,Ge,w,Ee],Ze=[V]},68630:(e,t,n)=>{"use strict";n.d(t,{Uu:()=>i,rW:()=>a});const i="emojione",a="https://statics.teams.cdn.office.net/evergreen-assets/emojioneassets/assets-png/"},84390:(e,t,n)=>{"use strict";n.d(t,{L1:()=>l,xU:()=>c,if:()=>u,I:()=>m,Q4:()=>g,uT:()=>p,js:()=>h,_R:()=>v,rO:()=>S,cn:()=>f,Du:()=>y,rJ:()=>k,$w:()=>C,oM:()=>b,TG:()=>T,th:()=>w,QX:()=>_,ct:()=>A,WK:()=>N,pt:()=>E});var i=n(59875),a=n(37464),o=n(11697),r=n(42926),s=n(63598);const l=4250,d=new Map([["angry","angryV2"]]),c=(e,t)=>"legacy"===t||!e.enableSkypeCMSEmoticons&&"skype"!==t?e.emoticonCdnAssetsUrl||"https://statics.teams.cdn.office.net/evergreen-assets/skype/v2":e.pesEmoticonCdnAssetsUrl||"https://statics.teams.cdn.office.net/evergreen-assets/personal-expressions/v1/assets/emoticons",u=(e,t,n=!1,i=!0)=>{var a;const r=e.description;if(!i&&!n)return r;const{id:s,skinTone:l}=(0,o.M)(e.id),d=(null===(a=e.shortcuts)||void 0===a?void 0:a[0])||`(${s})`;if(e.diverse){const e=t.stringTranslate("funstuff",`emoticon_skintone_${o.j[l].name}`);return n?t.stringTranslate("funstuff","emoticon_combined_skintone_title",{name:r,skinTone:e,shortName:d}):t.stringTranslate("funstuff","emoticon_name_with_skintone",{name:r,skinTone:e})}return n?t.stringTranslate("funstuff","emoticon_combined_title",{name:r,shortName:d}):r},m=(e,t,n)=>{var i,a;const{id:r}=(0,o.M)(e.id),s=(null===(a=null===(i=e.shortcuts)||void 0===i?void 0:i[0])||void 0===a?void 0:a.slice(1,-1))||r;return n?t.stringTranslate("funstuff","emoticon_aria_combined_title",{name:u(e,t,!1,n),shortName:s,openingParenthesis:t.stringTranslate("funstuff","emoticon_aria_opening_parenthesis"),closingParenthesis:t.stringTranslate("funstuff","emoticon_aria_closing_parenthesis")}):e.description},g=(e,t,n,i)=>s.uU.has(e)?S(p(e,t,n),"small",{enableSkypeCMSEmoticons:t,pesEmoticonCdnAssetsUrl:i},!0):void 0,p=(e,t,n=!1)=>{var i;return null!==(i=t?n?(0,r.Z)(e):s.uU.get(e):s.Ao.get(e))&&void 0!==i?i:e},h=(e,t,n,i,a)=>{E(n,a).forEach((n=>{const a=g(n,e,i,t);if(a){(new Image).src=a}}))},v=(e,t)=>t.stringTranslate("funstuff",`emoticon_${e}_keywords`),S=(e,t,n,i=!0,a="",r=!1,s=!1,l=null)=>{const u=s?y(t,l,r):f(t,r),{id:m,skinTone:g}=(0,o.M)(e),p=0!==g?`_s${g+1}`:"";if(!n||!n.enableSkypeCMSEmoticons&&b(m)&&0===g||s){let e=d.get(m)||m;return b(m)||(e=`${e}${p}`),`${c(n,"legacy")}/${e}/${u}${i?"a":""}.png`}{const e=i?"_anim":"",t=a&&""!==a?`?v=${a}`:"";return`${c(n,"skype")}/${m}/default/${u}${e}_f${p}.png${t}`}},f=(e,t=!1)=>{switch(e){case"extra-large":return i.hU;case"large":return t?i.hU:i.G4;case"medium":return t?i.$y:i.ZO;case"extra-small":return t?i.Mw:i.fs;case"small":default:return t?i.G4:i.Mw}},y=(e,t=null,n=!1)=>{const i=k(e,t);return n?2*i:i},k=(e,t=null)=>{switch(e){case"meeting-giant":return(null==t?void 0:t.xxxLargeIconSize)||224;case"meeting-jumbo":return(null==t?void 0:t.xxLargeIconSize)||168;case"meeting-overlay":return(null==t?void 0:t.overlayIconSize)||64;case"extra-large":return(null==t?void 0:t.xLargeIconSize)||140;case"large":return(null==t?void 0:t.largeIconSize)||112;case"medium":return(null==t?void 0:t.mediumIconSize)||84;case"small":return(null==t?void 0:t.smallIconSize)||56;case"extra-small":return(null==t?void 0:t.xSmallIconSize)||42;case"meeting-tiny":default:return(null==t?void 0:t.xxSmallIconSize)||32}},C=e=>{switch(e){case i.hU:case i.$y:return i.G4;case i.G4:return i.ZO;case i.ZO:return i.Mw;default:return e}},b=e=>s.uQ.has(e)||s.Ye.has(e),T=e=>{var t,n;return(null===(t=s.uQ.get(e))||void 0===t?void 0:t.unicode)||(null===(n=s.Ye.get(e))||void 0===n?void 0:n.unicode)||void 0},w=(e,t,n,r)=>{if(!e)return t.document.createElement("span");const{id:s,skinTone:l}=(0,o.M)(e.id);let d=`${e.description}`;if(0!==l){const t=`emoticon_skintone_${o.j[l].name}`;d=n.stringTranslate("funstuff","emoticon_name_with_skintone",{name:e.description,skinTone:n.stringTranslate("funstuff",t)})}const c="small",u=t.document.createElement("img"),m=`${f(c)}px`;u.setAttribute("src",S(e.id,c,r,!1,e.etag,t.isHighResolution)),u.setAttribute("alt",e.description),u.setAttribute("draggable","false"),u.setAttribute("width",m),u.setAttribute("height",m),u.setAttribute("aria-label",e.description),u.style.overflow="hidden",u.style.margin="0 1px",r.enableSkypeCMSEmoticons||"yes"!==s||(u.style.transform="scaleX(-1)");const g=t.document.createElement(i.Od);return g.setAttribute("contenteditable","false"),g.setAttribute("title",d),g.setAttribute("itemid",e.id),g.setAttribute("itemtype",a.T.emoji),g.setAttribute("itemscope",e.unicode||d),g.setAttribute("aria-label",e.description),g.appendChild(u),g},_=(e,t,n,i=!0,a="funstuff")=>{const o=s.uQ.get(e)||s.Ye.get(e);if(!o)throw new RangeError(`Invalid emoticon ${e}`);const r=o.steps,l=r/o.duration;return{id:e,description:t&&i&&t.stringTranslate(a,`emoticon_${o.pastName||e}_name`)||n||e,unicode:o.unicode,etag:"",animation:{fps:l,firstFrame:"kiss"===e?30:1,framesCount:r}}};let I;const A=()=>(I||(I=new Map,s.uQ.forEach(((e,t)=>e.shortcuts.forEach((e=>I.set(e.toLowerCase(),t)))))),I),N=e=>A().get(e),E=(e,t)=>Array.isArray(t)&&t.length&&e?t:Array.from(s.uU.keys())},11697:(e,t,n)=>{"use strict";n.d(t,{j:()=>i,M:()=>a});const i=[{name:"default"},{name:"light",code:57339},{name:"medium_light",code:57340},{name:"medium",code:57341},{name:"medium_dark",code:57342},{name:"dark",code:57343}],a=e=>{const t=e.match(/(\S+)-tone(\S+)/);return t&&3===t.length?{id:t[1],skinTone:Number.parseInt(t[2],10)}:{id:e,skinTone:0}}},42926:(e,t,n)=>{"use strict";n.d(t,{I:()=>o,Z:()=>r});const i=new Map([["like","likeWithFaceMSER"],["star","starMSER"],["yes","like"]]),a=new Map([["angry","angryface"],["like","yes"],["likeWithFaceMSER","like"],["starMSER","star"]]),o=e=>{var t;return null!==(t=i.get(e))&&void 0!==t?t:e},r=e=>{var t;return null!==(t=a.get(e))&&void 0!==t?t:e}},63598:(e,t,n)=>{"use strict";n.d(t,{uQ:()=>i,Ye:()=>a,uU:()=>o,Ao:()=>r,c$:()=>s});const i=new Map([["smile",{unicode:"",shortcuts:[":)",":-)",":=)","(smile)"],duration:2.2083,steps:53}],["laugh",{unicode:"",shortcuts:[":d",":-d",":=d","(laugh)",":>",":->","(lol)"],duration:3.2083,steps:77}],["heart",{unicode:"",shortcuts:["(heart)","<3"],duration:.7083,steps:16}],["kiss",{unicode:"",shortcuts:["(kiss)",":*",":-*",":=*","(xo)"],duration:2.875,steps:50}],["sad",{unicode:"",shortcuts:[":(",":-(",":=(","(sad)",":<",":-<"],duration:2.625,steps:63}],["tongueout",{unicode:"",shortcuts:[":p",":-p",":=p","(tongueout)","(yum)"],duration:2.9583,steps:71}],["wink",{unicode:"",shortcuts:[";)",";-)",";=)","(wink)"],duration:1.5,steps:36}],["cry",{unicode:"",shortcuts:[";(",";-(",";=(","(cry)",":'("],duration:2.0833,steps:50}],["inlove",{unicode:"",shortcuts:["(inlove)","(love)",":]",":-]"],duration:2.625,steps:63}],["hug",{unicode:"",shortcuts:["(hug)","(bear)"],duration:3.1667,steps:76}],["cwl",{unicode:"",shortcuts:["(cwl)","(cryingwithlaughter)"],duration:2.5417,steps:61}],["lips",{unicode:"",shortcuts:["(lips)"],duration:3.7083,steps:89}],["blush",{unicode:"",shortcuts:[":$",":-$",":=$",':">',"(blush)"],duration:2.875,steps:69}],["surprised",{unicode:"",shortcuts:[":o",":-o",":=o","(surprised)"],duration:2.8333,steps:68}],["penguin",{unicode:"",shortcuts:["(penguin)","(dancingpenguin)","(penguindance)"],duration:2.6667,steps:64}],["yes",{unicode:"",shortcuts:["(y)","(yes)","(thumbsup)"],duration:1.6667,steps:40}],["cool",{unicode:"",shortcuts:["(cool)","8-)","8=)","b-)","b=)","(sunglasses)"],duration:1.5833,steps:38}],["rofl",{unicode:"",shortcuts:["(rofl)","(rotfl)"],duration:3.375,steps:81}],["cat",{unicode:"",shortcuts:["(cat)","(meow)","(kitty)"],duration:5,steps:120}],["monkey",{unicode:"",shortcuts:["(monkey)","(ape)"],duration:2.0833,steps:50}],["hi",{unicode:"",shortcuts:["(wave)","(hi)","(bye)"],duration:2.375,steps:57}],["snowangel",{unicode:"",shortcuts:["(snowangel)"],duration:2.5,steps:60}],["flower",{unicode:"",shortcuts:["(flower)"],duration:3.4583,steps:83}],["giggle",{unicode:"",shortcuts:["(chuckle)","(giggle)"],duration:1.875,steps:45}],["devil",{unicode:"",shortcuts:["(devil)"],duration:2.7917,steps:67}],["party",{unicode:"",shortcuts:["(party)","<o)","<:o)"],duration:2.9583,steps:71}],["worry",{unicode:"",shortcuts:["(worry)",":s",":-s",":=s","(worried)","(scared)"],duration:2.3333,steps:56}],["champagne",{unicode:"",shortcuts:["(champagne)","(sparkling)"],duration:2.5833,steps:62}],["sun",{unicode:"",shortcuts:["(sun)"],duration:1.0833,steps:26}],["star",{unicode:"",shortcuts:["(star)"],duration:2.6667,steps:64}],["polarbear",{unicode:"",shortcuts:["(polarbear)","(polarbearhug)"],duration:5,steps:120}],["dull",{unicode:"",shortcuts:["|-(","|(","|=(","(dull)","(eyeroll)"],duration:3.2083,steps:77}],["speechless",{unicode:"",shortcuts:[":|",":-|",":=|","(speechless)"],duration:2.7917,steps:67}],["wonder",{unicode:"",shortcuts:[":^)","(wonder)","(skeptical)"],duration:2.9167,steps:70}],["angry",{unicode:"",shortcuts:["(angry)",":@",":-@",":=@","x(","x-(","x=(",";@",";-@","(rage)"],duration:4.375,steps:105}],["puke",{unicode:"",shortcuts:["(puke)",":&",":-&",":=&","+o("],duration:3.2917,steps:79}],["facepalm",{unicode:"",shortcuts:["(facepalm)","(fail)"],duration:3.2083,steps:77}],["sweat",{unicode:"",shortcuts:["(:|","(sweat)"],duration:2.875,steps:69}],["holidayspirit",{unicode:"",shortcuts:["(holidayspirit)","(crazyxmas)","(crazychristmas)"],duration:1.5,steps:36}],["sleepy",{unicode:"",shortcuts:["|-)","i-)","i=)","(snooze)","(sleepy)","(sleeping)"],duration:3,steps:72}],["bow",{unicode:"",shortcuts:["(bow)"],duration:2.5,steps:60}],["makeup",{unicode:"",shortcuts:["(makeup)"],duration:4.5,steps:108}],["cash",{unicode:"",shortcuts:["(cash)","(money)"],duration:1.125,steps:27}],["lipssealed",{unicode:"",shortcuts:[":x",":-x",":#",":-#",":=x",":=#","(lipssealed)"],duration:2.0833,steps:50}],["shivering",{unicode:"",shortcuts:["(shivering)","(cold)","(freezing)"],duration:7.9167,steps:190}],["cake",{unicode:"",shortcuts:["(cake)"],duration:4.125,steps:99}],["headbang",{unicode:"",shortcuts:["(headbang)","(banghead)"],duration:2.9583,steps:71}],["dance",{unicode:"",shortcuts:["o/",":d/","(dance)"],duration:8.5833,steps:206}],["wasntme",{unicode:"",shortcuts:["(wasntme)"],duration:3.1667,steps:76}],["hungover",{unicode:"",shortcuts:["(hungover)"],duration:3.0417,steps:73}],["yawn",{unicode:"",shortcuts:["(yawn)"],duration:3.0833,steps:74}],["gift",{unicode:"",shortcuts:["(gift)"],duration:.5417,steps:13}],["angel",{unicode:"",shortcuts:["(angel)"],duration:3.5,steps:84}],["xmastree",{unicode:"",shortcuts:["(xmastree)","(christmastree)"],duration:1.125,steps:27}],["brokenheart",{unicode:"",shortcuts:["(brokenheart)"],duration:4.375,steps:105}],["think",{unicode:"",shortcuts:["(think)",":-?",":?",":=?","*-)"],duration:2.4583,steps:59}],["clap",{unicode:"",shortcuts:["(clap)"],duration:1.6667,steps:40}],["punch",{unicode:"",shortcuts:["(punch)","*|","*-|"],duration:1.8333,steps:44}],["envy",{unicode:"",shortcuts:["(envy)"],duration:2.8333,steps:68}],["handshake",{unicode:"",shortcuts:["(handshake)"],duration:2.5833,steps:62}],["nod",{unicode:"",shortcuts:["(nod)"],duration:2.125,steps:51}],["nerdy",{unicode:"",shortcuts:["(nerd)","8-|","b-|","8|","b|","8=|","b=|","(nerdy)"],duration:2,steps:48}],["emo",{unicode:"",shortcuts:["(emo)"],duration:2.25,steps:54}],["muscle",{unicode:"",shortcuts:["(flex)","(muscle)"],duration:2.4583,steps:59}],["mmm",{unicode:"",shortcuts:["(mm)","(mmm)","(mmmm)"],duration:3.875,steps:93}],["highfive",{unicode:"",shortcuts:["(highfive)","(hifive)","(h5)"],duration:1.5833,steps:38}],["turkey",{unicode:"",shortcuts:["(turkey)","(turkeydance)"],duration:2.0833,steps:50}],["call",{unicode:"",shortcuts:["(call)"],duration:1.9167,steps:46}],["movember",{unicode:"",shortcuts:["(movember)","(moustache)","(mustache)",":{"],duration:4.5833,steps:110}],["dog",{unicode:"",shortcuts:["(dog)"],duration:2.25,steps:54}],["coffee",{unicode:"",shortcuts:["(coffee)"],duration:1.1667,steps:28}],["poke",{unicode:"",shortcuts:["(poke)","(nudge)"],duration:3.125,steps:75}],["swear",{unicode:"",shortcuts:["(swear)"],duration:3.2083,steps:77}],["donttalktome",{unicode:"",shortcuts:["(donttalk)","(donttalktome)"],duration:2.5,steps:60}],["fingerscrossed",{unicode:"",shortcuts:["(fingers)","(fingerscrossed)","(crossedfingers)"],duration:2.6667,steps:64}],["rainbow",{unicode:"",shortcuts:["(rainbow)"],duration:.8333,steps:20}],["headphones",{unicode:"",shortcuts:["(headphones)"],duration:3.5,steps:84}],["waiting",{unicode:"",shortcuts:["(waiting)"],duration:2.125,steps:51}],["festiveparty",{unicode:"",shortcuts:["(festiveparty)"],duration:3.0417,steps:73}],["heidy",{unicode:"",shortcuts:["(squirrel)","(heidy)"],duration:3.125,steps:75}],["beer",{unicode:"",shortcuts:["(beer)"],duration:3.1667,steps:76}],["doh",{unicode:"",shortcuts:["(doh)"],duration:2.5,steps:60}],["bomb",{unicode:"",shortcuts:["(bomb)","(explosion)","(explode)"],duration:7.1667,steps:172}],["happy",{unicode:"",shortcuts:["(happy)"],duration:2.9167,steps:70}],["ninja",{unicode:"",shortcuts:["(ninja)"],duration:5.0833,steps:122}]]),a=new Map([["angryface",{unicode:"",shortcuts:[],duration:4.375,steps:105,pastName:"angry"}],["smileeyes",{unicode:"",shortcuts:[],duration:2.875,steps:69}]]),o=new Map([["like","yes"],["heart","heart"],["laugh","laugh"],["surprised","surprised"],["sad","sad"],["angry","angryface"]]),r=new Map(o).set("angry","angry"),s=new Map([["laughV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["surprisedV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehand",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["surprisedV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehandV3",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["heartV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["yesV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["clapV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["surprisedV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["laughV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["surprisedV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehand-3D",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["surprisedV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehandV3-3D",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["heartV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["yesV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["clapV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["surprisedV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["yesGestureLoading",{unicode:"",shortcuts:[],duration:1.5417,steps:37}],["yesGestureComplete",{unicode:"",shortcuts:[],duration:4.7083,steps:113}],["raisehandGestureLoading",{unicode:"",shortcuts:[],duration:1.5417,steps:37}],["raisehandGestureComplete",{unicode:"",shortcuts:[],duration:4.7083,steps:113}]])},95774:(e,t,n)=>{"use strict";n.d(t,{p0:()=>m,um:()=>d,so:()=>c,eG:()=>s,Ax:()=>l,cL:()=>u});const i=["aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","ae","aeb","aec","afb","ajp","apc","apd","ar","arb","arc","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","bcc","bqi","ckb","dv","fa","glk","hbo","he","jpr","ku","men","mzn","nqo","pbt","pbu","peo","pes","pga","pnb","prd","prp","prs","ps","pst","sam","sd","shu","sqr","ssh","ug","ur","xaa","xmn","ydd","yhd","yi","yih","yud","pseudo_rtl"];var a=n(30170),o=n(82250);const r={af_ZA:1078,am_ET:1118,ar_AE:14337,ar_BH:15361,ar_DZ:5121,ar_EG:3073,ar_IQ:2049,ar_JO:11265,ar_KW:13313,ar_LB:12289,ar_LY:4097,ar_MA:6145,ar_OM:8193,ar_QA:16385,ar_SA:1025,ar_SY:10241,ar_TN:7169,ar_YE:9217,arn_CL:1146,as_IN:1101,az_AZ:2092,ba_RU:1133,be_BY:1059,bg_BG:1026,bn_IN:1093,bo_BT:2129,bo_CN:1105,br_FR:1150,bs_BA:8218,ca_ES:1027,co_FR:1155,cs_CZ:1029,cy_GB:1106,da_DK:1030,de_AT:3079,de_CH:2055,de_DE:1031,de_LI:5127,de_LU:4103,div_MV:1125,dsb_DE:2094,el_GR:1032,en_AU:3081,en_BZ:10249,en_CA:4105,en_CB:9225,en_GB:2057,en_IE:6153,en_IN:18441,en_JA:8201,en_MY:17417,en_NZ:5129,en_PH:13321,en_TT:11273,en_US:1033,en_ZA:7177,en_ZW:12297,es_AR:11274,es_BO:16394,es_CL:13322,es_CO:9226,es_CR:5130,es_DO:7178,es_EC:12298,es_ES:3082,es_GT:4106,es_HN:18442,es_MX:2058,es_NI:19466,es_PA:6154,es_PE:10250,es_PR:20490,es_PY:15370,es_SV:17418,es_UR:14346,es_US:21514,es_VE:8202,et_EE:1061,eu_ES:1069,fa_IR:1065,fi_FI:1035,fil_PH:1124,fo_FO:1080,fr_BE:2060,fr_CA:3084,fr_CH:4108,fr_FR:1036,fr_LU:5132,fr_MC:6156,fy_NL:1122,ga_IE:2108,gbz_AF:1164,gl_ES:1110,gsw_FR:1156,gu_IN:1095,ha_NG:1128,he_IL:1037,hi_IN:1081,hr_BA:4122,hr_HR:1050,hu_HU:1038,hy_AM:1067,id_ID:1057,ii_CN:1144,is_IS:1039,it_CH:2064,it_IT:1040,iu_CA:2141,ja_JP:1041,ka_GE:1079,kh_KH:1107,kk_KZ:1087,kl_GL:1135,kn_IN:1099,ko_KR:1042,kok_IN:1111,ky_KG:1088,lb_LU:1134,lo_LA:1108,lt_LT:1063,lv_LV:1062,mi_NZ:1153,mk_MK:1071,ml_IN:1100,mn_CN:2128,mn_MN:1104,moh_CA:1148,mr_IN:1102,ms_BN:2110,ms_MY:1086,mt_MT:1082,my_MM:1109,nb_NO:1044,ne_NP:1121,nl_BE:2067,nl_NL:1043,nn_NO:2068,ns_ZA:1132,oc_FR:1154,or_IN:1096,pa_IN:1094,pl_PL:1045,ps_AF:1123,pt_BR:1046,pt_PT:2070,qut_GT:1158,quz_BO:1131,quz_EC:2155,quz_PE:3179,rm_CH:1047,ro_RO:1048,ru_RU:1049,rw_RW:1159,sa_IN:1103,sah_RU:1157,se_FI:3131,se_NO:1083,se_SE:2107,si_LK:1115,sk_SK:1051,sl_SI:1060,sma_NO:6203,sma_SE:7227,smj_NO:4155,smj_SE:5179,smn_FI:9275,sms_FI:8251,sq_AL:1052,sr_BA:7194,sr_SP:3098,sv_FI:2077,sv_SE:1053,sw_KE:1089,syr_SY:1114,ta_IN:1097,te_IN:1098,tg_TJ:1064,th_TH:1054,tk_TM:1090,tmz_DZ:2143,tn_ZA:1074,tr_TR:1055,tt_RU:1092,ug_CN:1152,uk_UA:1058,ur_IN:2080,ur_PK:1056,uz_UZ:2115,vi_VN:1066,wen_DE:1070,wo_SN:1160,xh_ZA:1076,yo_NG:1130,zh_CHS:4,zh_CHT:31748,zh_CN:2052,zh_HK:3076,zh_MO:5124,zh_SG:4100,zh_TW:1028,zu_ZA:1077};function s(e){const[t,n]=e.split("-");let i="";return t&&n&&(i=`${t.toLowerCase()}_${n.toUpperCase()}`),r[i]||r.en_US}function l(e,t,n){return d(t,n?n.toLocaleLowerCase():e.toLowerCase())}function d(e,t){const n=(0,a.vw)(t);if(n.locale!==t){e.createScenarioWithoutStarting(o.RG.I18nLangFallback).stop({origin:t,message:n.reason})}return n.locale?n.locale:"en-us"}function c(e){return e.split("-")[1]||""}const u={locale:""};class m{static get locale(){return u.locale}static isRtl(e){return function(e){const t=e.trim().split("-")[0].toLocaleLowerCase();return i.indexOf(t)>-1}(e=e||this.locale)}static setLangAttribute(e,t){t=t||this.locale,e.getAttribute("lang")!==t&&e.setAttribute("lang",t)}static setDirAttribute(e,t,n){void 0===t&&(t=this.isRtl(n||this.locale));const i=e.getAttribute("dir");t&&"rtl"!==i?e.setAttribute("dir","rtl"):t||""===i||"ltr"===i||e.removeAttribute("dir")}}},31225:(e,t,n)=>{"use strict";n.d(t,{o:()=>g,E:()=>u});var i=n(95774),a=n(19898),o=n(4266),r=n(85494),s=n(82250);const l=/[\W]*[y]+[\.\/-]*/,d=e=>e?e.replace(l,""):e,c={"ar-sa":0,"az-latn-az":1,"bg-bg":1,"ca-es":1,"ca-es-valencia":1,"cs-cz":1,"cy-gb":1,"da-dk":1,"de-at":1,"de-ch":1,"de-de":1,"de-li":1,"de-lu":1,"el-gr":1,"en-029":1,"en-au":1,"en-bz":0,"en-ca":0,"en-gb":1,"en-ie":1,"en-in":1,"en-jm":0,"en-my":0,"en-nz":1,"en-ph":0,"en-sg":0,"en-tt":0,"en-us":0,"en-za":0,"en-zw":0,"es-ar":0,"es-bo":1,"es-cl":1,"es-co":0,"es-cr":1,"es-do":0,"es-ec":1,"es-es":1,"es-gt":0,"es-hn":0,"es-mx":0,"es-ni":0,"es-pa":0,"es-pe":0,"es-pr":0,"es-py":0,"es-sv":0,"es-us":0,"es-uy":1,"es-ve":0,"et-ee":1,"eu-es":1,"fi-fi":1,"fil-ph":0,"fr-be":1,"fr-ca":0,"fr-ch":1,"fr-fr":1,"fr-lu":1,"fr-mc":1,"gl-es":1,"he-il":0,"hi-in":1,"hr-hr":1,"hu-hu":1,"id-id":0,"is-is":1,"it-ch":1,"it-it":1,"ja-jp":0,"ka-ge":1,"kk-kz":1,"ko-kr":0,"lt-lt":1,"lv-lv":1,"mk-mk":1,"nb-no":1,"nl-be":1,"nl-nl":1,"nn-no":1,"pl-pl":1,"pt-br":0,"pt-pt":0,"ro-ro":1,"ru-ru":1,"sk-sk":1,"sl-si":1,"sq-al":1,"sr-latn-rs":1,"sv-fi":1,"sv-se":1,"th-th":1,"tr-tr":1,"uk-ua":1,"vi-vn":1,"zh-cn":1,"zh-hk":0,"zh-mo":0,"zh-sg":0,"zh-tw":0},u=(e,t)=>(null==e?void 0:e.endsWith("_mf"))?Object.assign(Object.assign({},t),{skipInterpolation:!0}):t,m={hour:!0,minute:!0,second:!0};class g{constructor(e){if(this.i18nextWrapper=e,this.timeSettings={},this.scenarioFactory=e.scenarioFactory,!this.i18nextWrapper.osLocaleInfo||!this.isSupportedOsRegionalFormat()){const t=(null==e?void 0:e.locale)||"en-us";return this.dateTimeFormatter=new r.bg(t),void(this.dateTimeFormatterNoYear=this.dateTimeFormatter)}if(this._osLocaleInfo=this.i18nextWrapper.osLocaleInfo,this._osDateTimeLocale=this._osLocaleInfo.regionalFormat,this.isUnsupportedCalendar())return this.dateTimeFormatter=new r.bg(this._osLocaleInfo.regionalFormat),void(this.dateTimeFormatterNoYear=this.dateTimeFormatter);const t={platform:this.i18nextWrapper.osPlatform===a.NR.Mac?"macos":"windows",regionalFormat:this._osLocaleInfo.regionalFormat,shortDate:this.i18nextWrapper.osLocaleInfo.date.shortDate,longDate:this.i18nextWrapper.osLocaleInfo.date.longDate,shortTime:this.i18nextWrapper.osLocaleInfo.date.shortTime,longTime:this.i18nextWrapper.osLocaleInfo.date.longTime},n=Object.assign(Object.assign({},t),{shortDate:d(t.shortDate),longDate:d(t.longDate),shortTime:d(t.shortTime),longTime:d(t.longTime)});this.dateTimeFormatter=new r.bg(t),this.dateTimeFormatterNoYear=new r.bg(n)}get locale(){var e;return(null===(e=this.i18nextWrapper)||void 0===e?void 0:e.locale)||"en-us"}get originLocale(){var e;return null===(e=this.i18nextWrapper)||void 0===e?void 0:e.originLocale}get userLanguage(){var e;return null===(e=this.i18nextWrapper)||void 0===e?void 0:e.userLanguage}get isRtl(){return i.p0.isRtl(this.locale)}setLocale(e){var t;return null===(t=this.i18nextWrapper)||void 0===t?void 0:t.setLocale(e)}get osDateTimeLocale(){return this._osDateTimeLocale}get osFirstDayOfWeek(){if(this.osLocaleInfo&&this.osLocaleInfo.date){const e=parseInt(this.osLocaleInfo.date.firstDayOfWeek,10);if(!Number.isNaN(e))return e}}get firstDayOfWeek(){var e,t;return null!==(e=this.osFirstDayOfWeek)&&void 0!==e?e:(t=this.i18nextWrapper.originLocale,c[t.toLowerCase()])}get osLocaleInfo(){return this._osLocaleInfo}stringTranslate(e,t,n){this.i18nextWrapper.latestTranslation.namespace=e,this.i18nextWrapper.latestTranslation.key=t;return this.i18nextWrapper.i18next.getFixedT(this.locale,e)(t,u(t,n))}waitForNamespace(e){return this.i18nextWrapper.namespaceLoader.waitForNamespace(this.i18nextWrapper,e)}getNamespaceState(e){return this.i18nextWrapper.namespaceLoader.getState(e)}isNamespaceLoaded(e){const t=this.getNamespaceState(e);return!(t===o.i.Loading||t===o.i.Missing)}formatDateTime(e,t,n){var i,a,o;try{return n?this.dateTimeFormatterNoYear.formatDateTime(e,(e=>{switch(e){case r.s1:return r.WZ;case r.WG:return r.Iy;case r.PB:return r.M2;case r.xH:return r.Kq;case r.CX:return r.Qo;case r.p2:return r.Ct;case r.TF:return r.SD;case r.tu:return r.KO}return e})(t)):this.dateTimeFormatter.formatDateTime(e,t)}catch(n){if(this.shouldLogFormatFallback(t)){const e=`Date format ${JSON.stringify(t)} is not supported, falling back to Intl.DateTimeFormat`;this.scenarioFactory.createScenarioWithoutStarting(s.RG.I18nFallbackToIntl).stop({errors:e,origin:null===(i=this.osLocaleInfo)||void 0===i?void 0:i.regionalFormat})}const l=null!==(o=null===(a=this.osLocaleInfo)||void 0===a?void 0:a.regionalFormat)&&void 0!==o?o:this.locale;try{return(0,r.fM)(l,t).format(e)}catch(n){const i=`Date format ${JSON.stringify(t)} for date ${e.toLocaleString()} fallback failed: ${n&&n.message}`;return this.scenarioFactory.createScenarioWithoutStarting(s.RG.I18nFallbackToIntl).fail({errors:i,origin:l}),""}}}formatNumber(e,t){return Intl.NumberFormat(this.osDateTimeLocale||this.locale,t).format(e)}formatNumberWithRegionalFormat(e,t){return Intl.NumberFormat(this.originLocale,t).format(e)}getStringComparer(e){return Intl.Collator(this.locale,e).compare}sortStrings(e,t){const n=this.getStringComparer(t);return e.sort(n)}getLocaleTimeSettings(){if(this.timeSettings[this.locale])return this.timeSettings[this.locale];const e=new Date(0,0,0,1,2,3).toLocaleTimeString(this.locale).match(new RegExp(`[${this.formatNumber(0)}-${this.formatNumber(9)}]+`,"g")),t={hour:"2-digit",minute:"2-digit",second:"2-digit"};if(Array.isArray(e)){const n=this.formatNumber(1),i=this.formatNumber(2),a=this.formatNumber(3);for(const o of e)o.indexOf(n)>-1?t.hour=1===o.length?"numeric":"2-digit":o.indexOf(i)>-1?t.minute=1===o.length?"numeric":"2-digit":o.indexOf(a)>-1&&(t.second=1===o.length?"numeric":"2-digit")}return this.timeSettings[this.locale]=t,t}isSupportedOsRegionalFormat(){const e=[a.NR.Mac,a.NR.Windows].indexOf(this.i18nextWrapper.osPlatform)>-1;return this.i18nextWrapper.osLocaleInfo&&e&&this.i18nextWrapper.osLocaleInfo.regionalFormat&&"UNKNOWN"!==this.i18nextWrapper.osLocaleInfo.regionalFormat}isUnsupportedCalendar(){return!this.i18nextWrapper.osLocaleInfo||!this.i18nextWrapper.osLocaleInfo.date||"gregorian"!==this.i18nextWrapper.osLocaleInfo.date.calendar&&"1"!==this.i18nextWrapper.osLocaleInfo.date.calendar}shouldLogFormatFallback(e){if(!e)return!0;if(e===r.Eq||e===r.W2)return!1;let t=!1;return Object.keys(e).map((e=>{m[e]||(t=!0)})),t}}},40178:(e,t,n)=>{"use strict";n.d(t,{q8:()=>d,dR:()=>c,Zl:()=>u});var i=n(13637),a=n(99342),o=n(38923),r=n(75068),s=n(82250);const l="Browser does not support IndexedDB APIs";function d(e,t,n,d,c,u){return(0,i.mG)(this,void 0,void 0,(function*(){let i;const g=(0,a.J)().indexedDB;return new Promise(((a,p)=>{const h=c.newScenario(s.RG.IndexedDBFetch);h.appendEventData({dataSource:n});try{g||p((0,o.Tr)(r.w5.IndexDb,r.jK.IndexDbException,l)),i=g.open(e,t),i.onerror=()=>{p((0,o.Tr)(r.w5.IndexDb,r.jK.IndexDbException,"Error in indexedDB open request"))},i.onupgradeneeded=e=>{m(t,n,d,i,e,a,p,h)},i.onsuccess=function(e,t,n,i,a,s,l){return()=>{try{const d=e.result,c=d.transaction([t]).objectStore(t),u=l?c.getAll():c.get(n);u.onsuccess=e=>{d.close(),i.stop();const t=e.target.result;a(l?t:t&&(t.value||u.result))},u.onerror=()=>{d.close(),i.fail(),s((0,o.Tr)(r.w5.IndexDb,r.jK.IndexDbException,"Error trying to get chat service sync end point from indexedDB"))}}catch(e){i.fail(),s((0,o.Tr)(r.w5.IndexDb,r.jK.IndexDbException,`Failed to read from '${t}' object store on the indexedDB.`))}}}(i,n,d,h,a,p,u)}catch(e){h.fail({errors:e.message}),p(e)}}))}))}function c(e,t,n,o,r){return(0,i.mG)(this,void 0,void 0,(function*(){{let i;const d=(0,a.J)().indexedDB;return new Promise(((a,c)=>{const u=r.newScenario(s.RG.IndexedDBDelete);u.appendEventData({dataSource:n});try{d||c(new Error(l)),i=d.open(e,t),i.onerror=()=>{c(new Error(l)),u.fail({errors:l})},i.onsuccess=()=>{!function(e,t,n,i,a){try{const o=e.result,r=o.transaction([t],"readwrite"),s=r.objectStore(t).clear();s.onsuccess=e=>{o.close(),n.stop(),i(e.target.result)},s.onerror=e=>{o.close(),n.fail(),a(`Error trying to delete data from indexedDB: ${e}`)}}catch(e){n.fail(),a(`Error trying to delete data from indexedDB: ${e}`)}}(i,n,u,a,c)},i.onupgradeneeded=e=>{m(t,n,o,i,e,a,c,u)}}catch(e){u.fail({errors:e.message}),c(e)}}))}}))}function u(e,t,n,o,r,d){return(0,i.mG)(this,void 0,void 0,(function*(){let i;const c=(0,a.J)().indexedDB;return new Promise(((a,u)=>{const g=d.newScenario(s.RG.IndexedDBWrite);g.appendEventData({dataSource:n});try{c||u(new Error(l)),i=c.open(e,t),i.onerror=()=>{u(new Error(l)),g.fail({errors:l})},i.onsuccess=()=>{!function(e,t,n,i,a,o){try{const r=e.result,s=r.transaction([t],"readwrite").objectStore(t);let l;n.forEach((e=>{l=s.put(e),l.onsuccess=e=>{r.close(),i.stop(),a(e.target.result.value)},l.onerror=e=>{r.close(),i.fail(),o(`Error trying to write into indexedDB: ${e}`)}}))}catch(e){i.fail(),o(`Error trying to write into indexedDB: ${e}`)}}(i,n,r,g,a,u)},i.onupgradeneeded=e=>{m(t,n,o,i,e,a,u,g)}}catch(e){g.fail({errors:e.message}),u(e)}}))}))}function m(e,t,n,i,a,o,r,l){try{a.oldVersion<e&&i.result.createObjectStore(t,{keyPath:n}),l.mark(s.ck.IndexedDBUpgrade),o()}catch(e){l.fail(),r(`Failed to create object stores on the indexedDB: ${e}`)}}},26404:(e,t,n)=>{"use strict";n.d(t,{W:()=>i});const i={"az-az":"az-latn-az","be-by":"ru-ru","de-at":"de-de","de-ch":"de-de","de-li":"de-de","de-lu":"de-de","en-029":"en-us","en-au":"en-gb","en-bz":"en-us","en-ca":"en-gb","en-ie":"en-gb","en-in":"en-gb","en-jm":"en-us","en-my":"en-gb","en-nz":"en-gb","en-ph":"en-us","en-sg":"en-gb","en-tt":"en-us","en-za":"en-gb","en-zw":"en-gb","es-419":"es-es","es-ar":"es-mx","es-bo":"es-mx","es-cl":"es-mx","es-co":"es-mx","es-cr":"es-mx","es-do":"es-mx","es-ec":"es-mx","es-gt":"es-mx","es-hn":"es-mx","es-ni":"es-mx","es-pa":"es-mx","es-pe":"es-mx","es-pr":"es-mx","es-py":"es-mx","es-sv":"es-mx","es-us":"es-mx","es-uy":"es-mx","es-ve":"es-mx","fr-be":"fr-fr","fr-ch":"fr-fr","fr-lu":"fr-fr","fr-mc":"fr-fr","it-ch":"it-it","ky-kg":"ru-ru","lb-lu":"de-de","nl-be":"nl-nl","qut-gt":"es-es","quz-pe":"es-es","sr-cyrl-rs":"sr-latn-rs","sr-cyrl":"sr-latn-rs","sr-latn":"sr-latn-rs","sr-rs":"sr-latn-rs","sv-fi":"sv-se","tg-cyrl-tj":"ru-ru","tk-tm":"ru-ru","tt-ru":"ru-ru","ug-cn":"zh-cn","wo-sn":"fr-fr","zh-hans-cn":"zh-cn","zh-hans-sg":"zh-cn","zh-hans":"zh-cn","zh-hant-hk":"zh-tw","zh-hant-mo":"zh-tw","zh-hant-tw":"zh-tw","zh-hant":"zh-tw","zh-hk":"zh-tw","zh-mo":"zh-tw","zh-sg":"zh-cn",ar:"ar-sa",az:"az-latn-az",bg:"bg-bg",ca:"ca-es",cs:"cs-cz",cy:"cy-gb",da:"da-dk",de:"de-de",el:"el-gr",en:"en-us",es:"es-es",et:"et-ee",eu:"eu-es",fi:"fi-fi",fil:"fil-ph",fr:"fr-fr",gl:"gl-es",he:"he-il",hi:"hi-in",hr:"hr-hr",hu:"hu-hu",id:"id-id",is:"is-is",it:"it-it",ja:"ja-jp",ka:"ka-ge",ko:"ko-kr",kk:"kk-kz",lt:"lt-lt",lv:"lv-lv",mk:"mk-mk",nb:"nb-no",nl:"nl-nl",nn:"nn-no",pl:"pl-pl",pt:"pt-br",ro:"ro-ro",ru:"ru-ru",sk:"sk-sk",sl:"sl-si",sr:"sr-latn-rs",sq:"sq-al",sv:"sv-se",th:"th-th",tr:"tr-tr",uk:"uk-ua",vi:"vi-vn",zh:"en-us"}},30170:(e,t,n)=>{"use strict";n.d(t,{$n:()=>o,vw:()=>r});var i=n(26404),a=n(32531);const o=e=>{for(const t of e){const n=s(t);if(null!==n.locale)return n.originalLocale=e.toLocaleString(),n}return{locale:"en-us",reason:"No supported language found - falling back to en-us",originalLocale:e.toLocaleString()}},r=e=>{const t=s(e);return null!==t.locale?t:{locale:"en-us",reason:"No supported language found - falling back to en-us",originalLocale:e}},s=e=>{const t=e.trim().toLowerCase();let n=d(t);return i.W[n]?(n=i.W[n],{locale:n,reason:"Found in fallback table",originalLocale:e}):l(n)?{locale:n,reason:"Supported language"}:{locale:null,reason:"Didn't find supported language.",originalLocale:e}},l=e=>{const t=e.toLowerCase();for(const e of a.x)if(t===e.toLowerCase())return!0;return!1},d=e=>{const t=(new Date).getTimezoneOffset();return"fr"===e&&t>=120&&t<=420?"fr-ca":e}},52961:(e,t,n)=>{"use strict";n.d(t,{N:()=>o});var i=n(13637),a=n(31821);class o{constructor(e,t,n){this.logsCollectorService=t,this.coreSettings=n,this.defaultLogsFilesDownloadDelayIntervalMs=333,this.logger=e.newLogger("LogsFilesService")}downloadLogsFiles(e){return(0,i.mG)(this,void 0,void 0,(function*(){let t=!0,n=this.defaultLogsFilesDownloadDelayIntervalMs;if(this.coreSettings){const e=this.coreSettings.get(a.J.Diagnostics);t=e.enableLogsFilesDownload||!1,n=e.logsFilesDownloadDelayIntervalMs||this.defaultLogsFilesDownloadDelayIntervalMs}if(!t)return this.logger.error(`Unabled to download logs files - logs files download is not enabled: ${t}`),!1;if(!e)return this.logger.error(`Unabled to download logs files - no host present: ${e}`),!1;let o=0;const r=yield this.logsCollectorService.callOnLogsFiles((t=>(0,i.mG)(this,void 0,void 0,(function*(){let a;const r=new Promise((r=>{a=e.setTimeout((()=>(0,i.mG)(this,void 0,void 0,(function*(){const n=yield this.downloadLogsFile(t,e);r(n)}))),o*n)})).then((t=>(void 0!==a&&e.clearTimeout(a),t)));return o++,r}))),!0);return r||this.logger.error("Failed to download all logs files"),r}))}downloadLogsFile(e,t){let n,i="";try{let a;a="string"==typeof e.content?new Blob([null==e?void 0:e.content],{type:"text/plain;charset=utf-8"}):e.content,i=URL.createObjectURL(a);const o=t.document.createElement("a");o.setAttribute("href",i),o.setAttribute("download",null==e?void 0:e.fileName),o.click(),o.remove(),n=!0}catch(t){this.logger.error(`Failed to download logs file ${null==e?void 0:e.fileName} - error:`,t),n=!1}return i&&URL.revokeObjectURL&&URL.revokeObjectURL(i),Promise.resolve(n)}}},45657:(e,t,n)=>{"use strict";n.d(t,{n:()=>oe});var i=n(7042),a=n(67424),o=n(41656),r=n(24211),s=n(38923),l=n(75068);class d{constructor(e,t){this.shellComms=e,this.globalWindow=t,this.defaultRequestTimeoutMs=3e4,this.bufferInTimeout=5e3}postMessage(e,t){const n={eventId:e,payload:t,correlationId:(0,r.v4)()};this.shellComms.postMessage(n)}requestMessage(e,t,n=this.defaultRequestTimeoutMs){let i;const a=(0,r.v4)(),o=((null==t?void 0:t.timeout)||n)+this.bufferInTimeout;return new Promise(((n,r)=>{const d=t=>{this.globalWindow.clearTimeout(i),t&&!t.error?n(t.payload):r((0,s.Tr)(l.w5.ShellService,l.jK.RemoteOperationFailed,"requestMessage",{eventName:e,error:t&&t.error,correlationId:a},"Received an error from IPC"))};i=this.globalWindow.setTimeout((()=>{this.shellComms.remove(e,d),r((0,s.Tr)(l.w5.ShellService,l.jK.TimedOut,"requestMessage",{eventName:e,correlationId:a}))}),o),this.shellComms.once(e,d,a);const c={eventId:e,correlationId:a,payload:t};this.shellComms.postMessage(c)}))}addEventListener(e,t,n){n&&n.once?this.shellComms.once(e,t):this.shellComms.on(e,t)}removeEventListener(e,t){t?this.shellComms.remove(e,t):this.shellComms.removeAll(e)}open(e,t,n){const i={openType:e,openHandler:t,handlerParams:n};this.postMessage("requestShellToOpen",i)}}class c{constructor(e,t,n){this._globalWindow=e,this.shellComms=t,this.envPerformance={getBlinkMemoryInfo:()=>{},getJSHeapStatistics:()=>{},getMallocMemoryUsage:()=>{},getProcessMemoryInfo:()=>{},getWebCacheInfo:()=>{}};const{isInCypressFrame:i,isInIframe:r}=n;let s=a.QP.standAlone;this.viewportContext=o.R.primary,r&&!i?(s=a.QP.iframe,this.viewportContext=o.R.iFrame):null!==this._globalWindow.opener&&(s=a.QP.secondary,this.viewportContext=o.R.secondary),this._hostedWindowContext=Object.assign(Object.assign({},n),{panelContext:s,startReason:a.zF.userInitiated,__webpack_public_path__:this._globalWindow.__webpack_public_path__}),this.opener=new d(this.shellComms,this._globalWindow)}getHostedWindowContext(){return this._hostedWindowContext}onAppStart(){}}var u=n(98065),m=n(70918);var g=n(95808);class p{constructor(e,t){this.getObservableOn=e=>{const t=this.observableCache,n=t.get(e);if(n)return n;const i=new g.xQ;return t.set(e,i),i},this.next=e=>{this.logger.debug("Incoming message received. Filtering through cached observables.");const t=e.metaData.destination.channel,n=this.observableCache.get(t);n&&n.next(e)},this.error=e=>{const t=e.message?e.message:e;this.logger.error(`Internal Message Source emitted an error - {${t}}. Completing then clearing all observables from cache...`),this.completeAndClearCache()},this.complete=()=>{this.logger.debug("Internal Message Source completed. Completing then clearing all observables from cache..."),this.completeAndClearCache()},this.completeAndClearCache=()=>{this.observableCache.forEach((e=>e.complete())),this.observableCache.clear(),this.logger.debug("Cache cleared")},this.logger=t,this.observableCache=new Map,e.subscribe(this)}}const h="multi-window-manager-channel";var v=n(82044),S=n(28076),f=n(34255);const y=/^https:\/\/local\.teams\.(office|live)\.com(:8080)?$/;function k(e,t){return t.some((t=>{if(t.startsWith("regex:")){const n=t.replace("regex:","");return new RegExp(n).test(e)}return t===e}))}function C(e){return y.test(new URL(e).origin)}const b=(e,t,n,i)=>v.y.create((a=>{e.addEventListener("message",(e=>{const{eventId:o,channel:r}=e.data;e&&o&&r===h&&function(e,t,n){var i,a,o;const r=n.newLogger("PostMessage origin validation"),s=e.origin;return t?!("*"!==t&&!C(s)&&((0,f.isArray)(t)?0===t.length?(null===(i=r.errorToTelemetry)||void 0===i||i.call(r,"PostMessage is disabled for this experience. (case 5)","core_origin_validation_failed",{message:s},!0),1):!k(s,t)&&(null===(a=r.errorToTelemetry)||void 0===a||a.call(r,"Event origin is not in allow-list. Event was dropped. (case 4)","core_origin_validation_failed",{message:s},!0),1):(null===(o=r.errorToTelemetry)||void 0===o||o.call(r,"Could not match the event origin. Event was dropped. (case 6)","core_origin_validation_failed",{message:s},!0),1))):(r.debug("PostMessage is enabled for backwards compatibility. No postMessageConfig is set on this experience. https://aka.ms/tmp-post-message-config (case1 )"),!0)}(e,n.postMessageConfig,i)&&(t.debug("Incoming message from post messages"),a.next(e.data))}))})).pipe((0,S.B)());class T{constructor(e,t,n,i){this.opt=i,this.postMessage=e=>{var t,n;if((0,f.isArray)(this.opt.postMessageConfig)&&0===this.opt.postMessageConfig.length)return void(null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,"postMessageConfig is set to empty array. No outgoing post messages are allowed","core_origin_validation_failed",void 0,!0));this.logger.log("Sending targeted message to host browser only");const i=null!==e.payload&&"object"==typeof e.payload?Object.assign({},e.payload):{payload:e.payload};this.windowReference.parent.postMessage({channel:h,payload:Object.assign(Object.assign({},i),{channel:e.channel})},((e,t,n)=>{const i=new URL(e.location.href).origin;let a;if(!t||"*"===t)return"*";if(e.document.referrer)try{a=new URL(e.document.referrer).origin}catch(t){n.error(`Invalid referrer: ${e.document.referrer}`)}return a?a===i||C(a)||k(a,t)?a:(n.error(`Invalid target origin (${a}). Source origin (${i}) was returned as target origin.`),i):(n.log(`Could not determine target origin. Falling back to source origin: ${i}`),i)})(this.windowReference,this.opt.postMessageConfig,this.logger))},this.broadcast=()=>{},this.asObservable=e=>this.shellChannelCache.getObservableOn(e).pipe((0,m.U)((e=>(e=>({channel:e.metaData.destination.channel,payload:e.payload}))(e)))),this.createShellChannelCache=(e,t,n,i)=>{t.debug("Creating Shell Channel cache");const a=b(e,t,n,i);return new p(a,t)},this.logger=n.newLogger("RndrShComm"),this.processId=e,this.windowReference=t,this.shellChannelCache=this.createShellChannelCache(this.windowReference,this.logger,this.opt,n)}}const w="main_process",_="main_renderer";var I;!function(e){e[e.Request=0]="Request",e[e.Response=1]="Response"}(I||(I={}));var A=n(21532),N=n(14618),E=n(13368),D=n(3747),F=n(40903),P=n(69164),M=n(70838),j=n(48712),R=n(27018);const x=5*n(6181).gT.MILLI_PER_SECOND;class O{constructor(e,t,n){this.createResponseFunction=(e,t,n)=>i=>{const a=this.messagePassingService,o={direction:I.Response,responsePayload:i,procedureSignature:n},r={channel:t,payload:o};this.logger.log(`Sending response with signature: ${n}`),a.postMessage(r,[e])};if(3!==arguments.length||e.trim().length<=0)throw(0,s.Tr)("Invalid constructor arguments",l.jK.InvalidInput,typeof O);this.logger=n,this.messagePassingService=t,this.metaData={requestId:e}}send(e,t,n=x){const i=this.messagePassingService,a=this.metaData,o=i.processId,s=a.requestId,l=r.v4(),d=t?[t]:i.processId!==w?[w]:[_],c={channel:s,payload:{direction:I.Request,senderProcessId:o,procedureSignature:l,requestPayload:e}};this.logger.log(`Invoking procedure on ${t} with id, ${l}`);const u=(0,A.c)().pipe((0,D.x)((()=>i.postMessage(c,d)))),m=i.asObservable(s).pipe((0,F.h)((e=>e.payload.direction===I.Response)),(0,P.zg)((e=>{const t=e.payload;return t.procedureSignature===l?(0,N.of)(t.responsePayload):(0,A.c)()})));return(0,E.z)(u,m).pipe((0,M.P)(),(0,j.V)(n))}sendAsPromise(e,t,n=x){return this.logger.debug("Invoking procedure as promise"),new Promise(((i,a)=>{this.send(e,t,n).subscribe((e=>{i(e)}),(e=>{a(e)}))}))}asObservable(){const e=this.messagePassingService,t=this.metaData.requestId;return this.logger.debug("Retreiving observable on request-response procedure"),e.asObservable(t).pipe((0,F.h)((e=>e.payload.direction===I.Request)),(0,R.b)((e=>{this.logger.log(`Incoming request with signature - ${e.payload.procedureSignature}`)})),(0,m.U)((e=>{const n=e.payload,i=n.procedureSignature,a=n.requestPayload,o=n.senderProcessId;return{payload:a,respond:this.createResponseFunction(o,t,i)}})))}}var L=n(97905),U=n(45092),B=n(71068);class W{constructor(e,t,n){this.setState=e=>{const t=this.metaData,n={lastAuthorMetaData:t,newState:e};this.logger.debug(`Process, ${t.authorId}, is setting the state`),this.stateUpdateSource.next(n)},this.asObservable=()=>(this.logger.debug("Retreiving observable on the state"),this.distinctStateUpdates.pipe((0,m.U)((e=>e.newState)))),this.setupContinuousSyncronizationAcrossShellBoundary=()=>{const e=this.messagePassingService,t=this.metaData,n=this.logger,i=this.stateUpdateSource,a=this.distinctStateUpdates,o=t.storeId;a.pipe((0,F.h)((e=>e.lastAuthorMetaData.authorId===this.metaData.authorId)),(0,R.b)((()=>n.debug("Broadcasting state update")))).subscribe((t=>{const n={payload:t,channel:o};e.broadcast(n)})),e.asObservable(o).pipe((0,F.h)((e=>e.payload.lastAuthorMetaData.authorId!==t.authorId)),(0,R.b)((()=>n.log("State update incoming from message passing service")))).subscribe((e=>{i.next(e.payload)}))},this.setupInitialStateSynchronizationRequest=()=>{const e=this.metaData,t=this.distinctStateUpdates,n=this.messagePassingService,i=e.storeId,a=i.concat("-initial-sync-request");t.pipe((0,R.b)((()=>this.logger.debug("State updated. SwitchMapping to observable on incoming sync requests"))),(0,U.w)((()=>n.asObservable(a)),((e,t)=>{const n=t.payload.requesterMetaData.authorId;return{syncResponseMessage:{channel:i,payload:e},targetId:n}})),(0,R.b)((({targetId:e})=>this.logger.debug(`Incoming initial sync request from ${e}.`)))).subscribe((({syncResponseMessage:e,targetId:t})=>{n.postMessage(e,[t])}));const o={channel:a,payload:{requesterMetaData:e}};this.logger.debug("Sending out initial synchronization request..."),n.broadcast(o)};if(3!==arguments.length||e.trim().length<=0)throw(0,s.Tr)("Invalid constructor arguments",l.jK.InvalidInput,typeof W);const i=t.processId;this.logger=n,this.messagePassingService=t,this.metaData={storeId:e,authorId:i};this.stateUpdateSource=new L.t(1),this.distinctStateUpdates=this.stateUpdateSource.pipe((0,B.x)(((e,t)=>(0,f.isEqual)(e,t)))),this.setupContinuousSyncronizationAcrossShellBoundary(),this.setupInitialStateSynchronizationRequest()}}class G{constructor(e,t,n){if(3!==arguments.length||e.trim().length<=0)throw(0,s.Tr)("Invalid constructor arguments",l.jK.InvalidInput,typeof G);this.logger=n,this.messagePassingService=t,this.metaData={streamId:e}}next(e,...t){const n=this.metaData,i=this.messagePassingService,a=t&&t.length>0?t:this.messagePassingService.processId!==w?[w]:[_],o={channel:n.streamId,payload:e};this.logger.debug(`Invoking stream on targets: ${JSON.stringify(a)}.`),i.postMessage(o,a)}asObservable(){const e=this.messagePassingService,t=this.metaData.streamId;return e.asObservable(t).pipe((0,m.U)((e=>e.payload)),(0,R.b)((()=>{this.logger.debug("Handling stream event.")})))}}class V{constructor(e,t){if(this.getRequest=e=>new O(e,this.messagePassingService,this.loggerFactory.newLogger(`ShRqst${e}`)),this.getStream=e=>new G(e,this.messagePassingService,this.loggerFactory.newLogger(`ShStrm${e}`)),this.getStore=e=>new W(e,this.messagePassingService,this.loggerFactory.newLogger(`ShStr${e}`)),!e||!t)throw(0,s.Tr)(`sc: ${e}, lf: ${t}`,l.jK.Undefined,typeof V);this.messagePassingService=e,this.loggerFactory=t}}var H=n(93330),$=n(29601);class z{constructor(e,t){if(this.windowReference=e,this.opt=t,!this.windowReference)throw(0,s.Tr)(l.w5.ShellService,l.jK.Undefined,"constructor");const n={error:()=>{},warn:()=>{},debug:()=>{},info:()=>{},log:()=>{}},i={newLogger:()=>n},a=new T("browserWindow",this.windowReference,i,this.opt);this.shellComms=new V(a,i),this.subscriptionManager=new g.xQ}postMessage(e){this.shellComms.getStream(e.eventId).next(e)}on(e,t,n=""){this.createSubscription(e,t,!1,n)}once(e,t,n=""){this.createSubscription(e,t,!0,n)}remove(e,t){this.subscriptionManager.next({channel:e,listener:t})}removeAll(e){this.subscriptionManager.next({channel:e})}createSubscription(e,t,n,i){const a=this.shellComms.getStream(e).asObservable().pipe(this.filterWrapper((e=>{var t;const n=(null==e?void 0:e.correlationId)||(null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.correlationId);return!e||!n||n===i}))),o=this.registerForUnsubscription(e,t);(n?a.pipe((0,H.q)(1),(0,$.R)(o)):a.pipe((0,$.R)(o))).subscribe((e=>{t({payload:e})}),(e=>{throw(0,s.Tr)(l.w5.ShellService,l.jK.RemoteOperationFailed,"createSubscription",{errorMsg:(0,s.B9)(e)})}))}registerForUnsubscription(e,t){return this.subscriptionManager.pipe(this.filterWrapper((n=>n.channel===e&&(void 0===n.listener||n.listener===t))))}filterWrapper(e){return(0,F.h)(e)}}class q{constructor(e,t){this.globalWindow=e,this.opt=t}configureShell(e){const t=this.globalWindow,n=this.createShellCommService(this.globalWindow,this.opt),i=new c(this.globalWindow,n,e);return{hostedWindowContext:i.getHostedWindowContext(),window:(0,u.So)(t,i)}}createShellCommService(e,t){return new z(e,t)}}class J{constructor(e,t,n,r){this.envPerformance=e,this._globalWindow=t,this.shellComms=n,this._hostedWindowContext=Object.assign(Object.assign({},r),{panelContext:a.QP.secondary,startReason:a.zF.userInitiated,__webpack_public_path__:this._globalWindow.__webpack_public_path__}),this.viewportContext=o.R.iFrame,this.opener=new d(n,this._globalWindow),this._globalWindow.addEventListener("unload",(()=>{this.shellComms.postMessage({eventId:i.W.WindowUnloaded})}))}getHostedWindowContext(){return this._hostedWindowContext}onAppStart(){const e={eventId:i.W.WindowAppStart};this.shellComms.postMessage(e)}}var Q,K=n(9940);!function(e){e.WindowMinimize="child-window-minimize",e.WindowMaximize="child-window-maximize"}(Q||(Q={}));const Y="experience-renderer-channel";class X{constructor(e){this.ipcRenderer=e,this.onceListenerLookup={},this.listenerLookup={},this.ipcRenderer.on(Y,((e,t)=>{if(t&&t.eventId){const e=`${t.eventId}${t.correlationId||""}`;this.onceListenerLookup[e]?(this.onceListenerLookup[e].forEach((e=>e(t))),delete this.onceListenerLookup[e]):this.listenerLookup[e]&&this.listenerLookup[e].forEach((e=>{e(t)}))}}))}postMessage(e){switch(e.eventId){case K.rY.ActivityEvent:case K.rY.CreateWebview:case K.rY.GetWindowLaunchSubSteps:case K.rY.SetTouchBar:case K.rY.ClearTouchBar:case K.rY.ActivateOutlook:case K.rY.RequestTabMetrics:case K.rY.HasDevicePermissionsCallback:this.ipcRenderer.send(Y,e);break;case i.W.CoreInitialized:case K.rY.WindowInitialized:this.ipcRenderer.send(Y,e),this.ipcRenderer.sendToHost(Y,e);break;default:this.ipcRenderer.sendToHost(Y,e)}}on(e,t,n=""){const i=`${e}${n}`;this.listenerLookup[i]||(this.listenerLookup[i]=[]),this.listenerLookup[i].push(t)}once(e,t,n=""){const i=`${e}${n}`;this.onceListenerLookup[i]||(this.onceListenerLookup[i]=[]),this.onceListenerLookup[i].push(t)}remove(e,t){e&&t&&(this.onceListenerLookup[e]&&(this.onceListenerLookup[e]=this.onceListenerLookup[e].filter((e=>e!==t)),0===this.onceListenerLookup[e].length&&delete this.onceListenerLookup[e]),this.listenerLookup[e]&&(this.listenerLookup[e]=this.listenerLookup[e].filter((e=>e!==t)),0===this.listenerLookup[e].length&&delete this.listenerLookup[e]))}removeAll(e){delete this.onceListenerLookup[e],delete this.listenerLookup[e]}}class Z{constructor(e){this.windowHandle=e,this.ipcRenderer=this.windowHandle.desktop.ipcRenderer,this.webViewCommService=new X(this.ipcRenderer),this.browserShellCommService=new z(e,{})}postMessage(e){switch(e.eventId){case K.rY.ActivityEvent:case K.rY.CreateWebview:case K.rY.GetWindowLaunchSubSteps:case K.rY.SetTouchBar:case K.rY.ClearTouchBar:this.ipcRenderer.send(Y,e);break;case i.W.CoreInitialized:case K.rY.WindowInitialized:this.ipcRenderer.send(Y,e),this.browserShellCommService.postMessage(e);break;default:this.browserShellCommService.postMessage(e)}}on(e,t,n=""){this.webViewCommService.on(e,t,n),this.browserShellCommService.on(e,t,n)}once(e,t,n=""){this.webViewCommService.once(e,t,n),this.browserShellCommService.once(e,t,n)}remove(e,t){this.webViewCommService.remove(e,t),this.browserShellCommService.remove(e,t)}removeAll(e){this.webViewCommService.removeAll(e),this.browserShellCommService.removeAll(e)}}class ee{constructor(e){this.globalWindow=e}configureShell(e){const t=this.globalWindow,{isInIframe:n}=e,i=this.extractPerformanceTooling(t),a=n?new Z(t):new X(t.desktop.ipcRenderer),o=new J(i,t,a,e);return Object.keys(t.desktop).forEach((e=>{"perf"!==e&&delete t.desktop[e]})),{hostedWindowContext:o.getHostedWindowContext(),window:(0,u.So)(t,o)}}extractPerformanceTooling(e){return e.desktop.perf||{getBlinkMemoryInfo:()=>{},getJSHeapStatistics:()=>{},getMallocMemoryUsage:()=>{},getProcessMemoryInfo:()=>{},getWebCacheInfo:()=>{}}}}var te=n(73800);class ne{constructor(e){this.windowEnvironment=e}configure(e){const t={isInCypressFrame:ie(this.windowEnvironment),isInIframe:ae(this.windowEnvironment)};t.isInIframe&&function(e){var t;if(e.navigator){if("Electron"===te.getParser(null===(t=e.navigator)||void 0===t?void 0:t.userAgent).getBrowserName())return!0}return!1}(this.windowEnvironment)&&function(e){var t;try{const n=e.parent;if(!n||!function(e){return!(!e||!e.electronSafeIpc)}(n))return;e.desktop={perf:null===(t=n.desktop)||void 0===t?void 0:t.perf,ipcRenderer:n.electronSafeIpc},e.createInterprocessStore=n.createInterprocessStore,e.vdiSettings=n.vdiSettings}catch(e){return}}(this.windowEnvironment);return(function(e){return!!(e&&e.desktop&&e.desktop.ipcRenderer)}(this.windowEnvironment)?new ee(this.windowEnvironment):new q(this.windowEnvironment,e)).configureShell(t)}}function ie(e){try{let t=!!e.Cypress;if(!t){const n=e.top||e.parent;t=!!(null==n?void 0:n.Cypress)}return t}catch(e){return!1}}function ae(e){try{return e.self!==e.top}catch(e){return!0}}class oe{constructor(){this._opt={};const e=new ne(window);this.config=e.configure(this._opt),this.config.window.opener.postMessage(i.W.WindowReady)}set opt(e){Object.keys(e).forEach((t=>{this._opt[t]=e[t]}))}static getInstance(){return oe.instance||(oe.instance=new oe),oe.instance}get window(){return this.config.window}}},98065:(e,t,n)=>{"use strict";n.d(t,{YR:()=>C,dP:()=>y,So:()=>f});var i=n(19898),a=n(16552),o=n(41656),r=n(52058);function s(e){return e.ResizeObserver?e.ResizeObserver:function(t){const n=new Map;let i,a=!1;function o(){if(a||!n.size)return void(i=void 0);const r=[];n.forEach(((e,t)=>{const i=t.getBoundingClientRect();e.height!==i.height&&(n.set(t,i),r.push({target:t,contentRect:i}))})),r.length&&t(r),i=e.requestAnimationFrame(o)}return{observe(t){n.has(t)||(n.set(t,t.getBoundingClientRect()),i||(i=e.requestAnimationFrame(o)))},unobserve(e){n.has(e)&&n.delete(e)},disconnect(){n.clear(),i=void 0,a=!0}}}}var l=n(13637),d=n(40474),c=n(84575);class u{constructor(e,t){this._document=e,this._chunkConfig=t,this._loadedItems=new Map,this._loadScript=(0,c.m)(((e,t)=>new Promise(((n,i)=>{if(!e)return n();const a=this._document.createElement("script");if(a.onload=()=>n(),a.onerror=i,a.async=!0,a.id=`${t}-script`,a.charset="utf-8",!this._coreSecurityService)throw new d.Y("DEVELOPER_ERROR",new Error("Chunkloader core security service is not defined. This should never happen"));try{const t=this._coreSecurityService.getTrustedTypePolicy("@msteams/services-utilities-common#ChunkLoader").createScriptURL(e,a.baseURI);a.src=t}catch(e){throw e}this._document.body.appendChild(a)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this._loadStyle=(0,c.m)(((e,t)=>new Promise(((n,i)=>{if(!e)return n();const a=this._document.createElement("link");a.onload=()=>n(),a.onerror=i,a.type="text/css",a.rel="stylesheet",a.id=`${t}-style`,a.charset="utf-8",a.href=e,this._document.head.appendChild(a)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this.loadChunk=(e,t=!1)=>(0,l.mG)(this,void 0,void 0,(function*(){if(!this._chunkConfig)throw new Error("Chunk loading is not supported in this window or host.");const n=e.reduce(((e,n)=>{const i=this._chunkConfig&&this._chunkConfig[n];if(!i)return e.push(Promise.reject(new Error(`No chunk information found for ${i}.`))),e;const a=i.endsWith(".css")?this._loadStyle:this._loadScript,o=this._loadedItems.get(i)||a(i,n).catch((e=>{throw t&&this._loadedItems.delete(i),e}));return this._loadedItems.has(i)||this._loadedItems.set(i,o),e.push(o),e}),[]);yield Promise.all(n)}))}configureCoreSecurityService(e){if(this._coreSecurityService)throw new d.Y("DUPLICATE_POLICY_FOUND",new Error("ChunkLoader::coreSecurityService is already defined. Developer should not be calling configureCoreSecurityService multiple times in it's context"));e&&(this._coreSecurityService=e)}}var m=n(88783),g=n(21532),p=n(27018),h=n(3747),v=n(71068);const S=e=>!(!e.matchMedia("(display-mode: fullscreen)").matches&&!e.document.fullscreenElement),f=(e,t)=>{var n,i,a,o;let l;try{l={DOMRect:e.DOMRect,loader:e.loader,loaderConfig:e.loaderConfig,preCoreUiAdapter:e.preCoreUiAdapter,Cypress:e.Cypress,document:e.document,HTMLVideoElement:e.HTMLVideoElement,Element:e.Element,emitDebugEvent:e.emitDebugEvent,external:e.external,location:e.location,history:e.history,navigator:e.navigator,caches:e.caches,crypto:e.crypto,parent:e.parent,self:e.self,top:e.top,performance:e.performance,msCrypto:e.msCrypto&&e.msCrypto,IntersectionObserver:e.IntersectionObserver,ResizeObserver:s(e),WeakRef:e.WeakRef,chunkLoader:new u(e.document,e.__experienceWindowChunks__),screen:e.screen,viewportContext:t.viewportContext,chrome:e.chrome,open:e.loader&&e.loader.openWindow?e.loader.openWindow.bind(e.loader):e.open.bind(e),fetch:e.fetch&&e.fetch.bind(e),close:e.close.bind(e),alert:e.alert.bind(e),requestAnimationFrame:e.requestAnimationFrame.bind(e),cancelAnimationFrame:e.cancelAnimationFrame.bind(e),requestIdleCallback:e.requestIdleCallback?e.requestIdleCallback.bind(e):e.requestAnimationFrame.bind(e),cancelIdleCallback:e.cancelIdleCallback?e.cancelIdleCallback.bind(e):e.cancelAnimationFrame.bind(e),setInterval:e.setInterval.bind(e),clearInterval:e.clearInterval.bind(e),clearTimeout:e.clearTimeout.bind(e),setTimeout:e.setTimeout.bind(e),addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e),dispatchEvent:e.dispatchEvent.bind(e),focus:e.focus.bind(e),getScreenDetails:()=>e.getScreenDetails?e.getScreenDetails():Promise.resolve(void 0),getSelection:e.getSelection.bind(e),getComputedStyle:e.getComputedStyle.bind(e),onpagehide:null===(n=e.onpagehide)||void 0===n?void 0:n.bind(e),setBounds:e.setBounds,setMinimumSize:e.setMinimumSize,createInterprocessStore:e.createInterprocessStore,Logging:e.Logging,matchMedia:e.matchMedia?e.matchMedia.bind(e):null,proxyPostMessage:(t,n,i)=>{e.proxyPostMessage&&e.proxyPostMessage(t,n,i)},getLocaleInfoAsync:()=>e.getLocaleInfoAsync?e.getLocaleInfoAsync():Promise.resolve(void 0),getUserMedia:t=>{var n,i;return(null===(i=null===(n=e.navigator)||void 0===n?void 0:n.mediaDevices)||void 0===i?void 0:i.getUserMedia)?e.navigator.mediaDevices.getUserMedia(t):Promise.reject(new Error("Not available"))},handleGlobalWindowError:null===(i=e.handleGlobalWindowError)||void 0===i?void 0:i.bind(e),decodeURIComponent,encodeURIComponent,getDesktopCapturerSources:t=>e.getDesktopCapturerSources?e.getDesktopCapturerSources(t):Promise.reject(new Error("Not available")),get __experienceWindowChunks__(){return e.__experienceWindowChunks__},get __webpack_nonce__(){return e.__webpack_nonce__},get __VERSION__(){return e.__VERSION__},get __webpack_public_path__(){return e.__webpack_public_path__},get devicePixelRatio(){return e.devicePixelRatio},get localStorage(){return e.localStorage},get sessionStorage(){return e.sessionStorage},get indexedDB(){return e.indexedDB},get CKEDITOR(){return e.CKEDITOR},get ITEMS_VIEW_STRINGS(){return e.ITEMS_VIEW_STRINGS},get CodeMirror(){return e.CodeMirror},get MutationObserver(){return e.MutationObserver},get LivePersonaCardStrings(){return e.LivePersonaCardStrings},get LivePersonaCardHoverTargetV2(){return e.LivePersonaCardHoverTargetV2},get LPC(){return e.LPC},get authLogger(){return e.Logging},get Microsoft(){return e.Microsoft},get Office(){return e.Office},get Image(){return e.Image},get DOMParser(){return e.DOMParser},videoRenderer:e.videoRenderer,get FrameSinkReader(){return e.FrameSinkReader},get continueExternalAuth(){return e.continueExternalAuth},set continueExternalAuth(t){e.continueExternalAuth=t},get continueMsaAuth(){return e.continueMsaAuth},set continueMsaAuth(t){e.continueMsaAuth=t},get FabricConfig(){return e.FabricConfig},set FabricConfig(t){e.FabricConfig=t},get CKEDITOR_BASEPATH(){return e.CKEDITOR_BASEPATH},get ClipboardItem(){return e.ClipboardItem},get PerformanceObserver(){return e.PerformanceObserver},get opener(){return t.opener},get envPerformance(){return t.envPerformance},getHostedWindowContext:t.getHostedWindowContext.bind(t),onAppStart:t.onAppStart.bind(t),get isHighResolution(){if(e){const t=1.3,n=e.navigator&&e.navigator.userAgent&&e.navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if(void 0!==e.devicePixelRatio&&!n)return e.devicePixelRatio>t;if(e.matchMedia){const t="(-webkit-min-device-pixel-ratio: 1.3),            (min--moz-device-pixel-ratio: 1.3),            (-o-min-device-pixel-ratio: 1.3),            (min-resolution: 120dpi)";return e.matchMedia(t).matches}}return!1},get screenX(){return e.screenX},get screenY(){return e.screenY},get innerWidth(){return e.innerWidth},get innerHeight(){return e.innerHeight},isFocused:()=>e.isFocused?e.isFocused():e.document.hasFocus(),onFullscreen:()=>new m.X(!1),exitFullscreen:()=>{},maximize:()=>{},minimize:()=>{},requestFullscreen:()=>{},show:()=>{},windowTitleDblClick:()=>{},clearCache:()=>{var t;return null===(t=e.clearCache)||void 0===t?void 0:t.call(e)},getZoomFactor:()=>e.getZoomFactor?e.getZoomFactor():0,zoomFactors:null!==(a=e.zoomFactors)&&void 0!==a?a:g.E,zoomIn:()=>e.zoomIn?e.zoomIn():void 0,zoomOut:()=>e.zoomOut?e.zoomOut():void 0,zoomReset:()=>e.zoomReset?e.zoomReset():void 0,vdiSettings:e.vdiSettings,setSelectedAudioOutputDevice:t=>e.setSelectedAudioOutputDevice?e.setSelectedAudioOutputDevice(t):Promise.resolve()}}catch(e){throw new r.G(r.$.CREATE_WINDOW_WRAPPER,e)}e.CKEDITOR_BASEPATH=e.CKEDITOR_BASEPATH||`${e.__webpack_public_path__||(null===(o=null==t?void 0:t.getHostedWindowContext())||void 0===o?void 0:o.__webpack_public_path__)||""}ckeditor/4.15.1-msft-11/`||"";const d=new Proxy(l,{deleteProperty:(t,n)=>delete e[n]});return l.__lpcWindowProxy=d,l};function y(e,t,n,a,o){const{coreSecurityService:r,windowProvider:s}=t,l=e,d=f(l,s),c=C(a,o),g=new u(l.document,s.__experienceWindowChunks__);g.configureCoreSecurityService(r);const y={chunkLoader:g,parent:s,viewportContext:c,FabricConfig:{mergeStyles:{namespace:"cw"}},exitFullscreen:()=>k("exitFullscreen",e,t,n),focus:()=>k("focus",e,t,n),maximize:()=>k("maximize",e,t,n),minimize:()=>k("minimize",e,t,n),requestFullscreen:()=>k("requestFullscreen",e,t,n),windowTitleDblClick:()=>k("windowTitleDblClick",e,t,n),onFullscreen:()=>((e,t,n)=>{const{interprocessStoreService:a,loggerFactory:o,platformService:r}=e,s=o.newLogger("WindowUtilities");if(r.config.clientType===i.Bh.Desktop)return a?a.onWindowFullscreen(n).pipe((0,p.b)((e=>s.log(`WindowHook[onFullscreen] update to: ${e}`)))):(s.error("WindowHook[onFullscreen] on desktop failed due to interprocessStoreService missing"),new m.X(!1));{const e=t,n=new m.X(S(e)),i=new e.ResizeObserver((()=>n.next(S(e))));return i.observe(e.document.documentElement),n.pipe((0,h.x)((()=>i.disconnect())),(0,v.x)())}})(t,e,n)};return Object.assign(d,y)}function k(e,t,n,a){const{interprocessStoreService:o,loggerFactory:r,platformService:s}=n,l=r.newLogger("WindowUtilities");if(l.log(`Performing action ${e}`),s.config.clientType===i.Bh.Desktop){if("focus"===e&&(null==t?void 0:t.document.hidden)&&(e="show"),!o)return void l.error(`WindowAction[${e}] on Desktop failed due to interprocessStoreService missing`);o[e](a).then((()=>{l.log(`WindowAction[${e}] on Desktop succeeded.`)})).catch((t=>{l.error(`WindowAction[${e}] on Desktop failed with: ${t&&t.message} (${t&&t.code})`)}))}else{const n=t;switch(e){case"exitFullscreen":n.document.exitFullscreen().catch((t=>{l.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}));break;case"requestFullscreen":n.document.documentElement.requestFullscreen().catch((t=>{l.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}));break;default:try{n[e]()}catch(t){l.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}}}}function C(e,t){let n;return n=e?t===a.lO.minimal?o.R.flyout:o.R.primary:o.R.secondary,n}},91477:(e,t,n)=>{"use strict";n.d(t,{XD:()=>r,jW:()=>s,F$:()=>l,OB:()=>d,bF:()=>c});var i=n(13637),a=n(89925),o=n(41790);const r=e=>(0,i.mG)(void 0,void 0,void 0,(function*(){const{data:t}=yield e.query({query:o.i8});return null==t?void 0:t.activeWindows})),s=e=>(0,i.mG)(void 0,void 0,void 0,(function*(){const t=yield r(e);return null==t?void 0:t.find((e=>e.isMainWindow&&e.layoutConfig.layoutMode===a.LayoutModes.standard))})),l=e=>{try{const t=e.readQuery({query:o.i8});return null==t?void 0:t.activeWindows}catch(e){return}},d=e=>e.watchQuery({query:o.i8}),c=(e,t)=>{try{return e.writeQuery({query:o.i8,data:{activeWindows:t}}),!0}catch(e){return!1}}},79729:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ServicesIoDataActiveWindowsSaveReactiveVarsToHistoryMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appIds"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"saveReactiveVarsToHistory"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"appIds"},value:{kind:"Variable",name:{kind:"Name",value:"appIds"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},41790:(e,t,n)=>{"use strict";n.d(t,{i8:()=>c});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowOptions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowOptions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"left"}},{kind:"Field",name:{kind:"Name",value:"top"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]},a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowOptions"}}]}},{kind:"Field",name:{kind:"Name",value:"linkedEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_linkedEntity"}}]}},{kind:"Field",name:{kind:"Name",value:"entityState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"flushableByLinkedEntity"}}]}}]}},...i.definitions,{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_linkedEntity"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LinkedEntity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}}]}}]},o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_coreViewState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CoreViewState"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"slotsConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotsConfig"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotsConfig"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SlotsConfig"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"contextualNotificationsSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"endSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"headerSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"mainSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"navSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"notificationsSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"startSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"subNavSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"titleBarSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"toastsSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"configurationsSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SlotConfig"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appRenderMode"}},{kind:"Field",name:{kind:"Name",value:"slotName"}},{kind:"Field",name:{kind:"Name",value:"viewEntityName"}},{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"appId"}}]}},...a.definitions]}.definitions]}.definitions]},r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_window"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Window"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"clientLaunchId"}}]}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}},{kind:"Field",name:{kind:"Name",value:"blockingEntityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"blockedEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"blockedCommand"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visibilityState"}},{kind:"Field",name:{kind:"Name",value:"stateTransition"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"blockedEntityOptions"}}]}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}},{kind:"Field",name:{kind:"Name",value:"isInitialWindowStateHidden"}},{kind:"Field",name:{kind:"Name",value:"userContextId"}},{kind:"Field",name:{kind:"Name",value:"coreViewState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_coreViewState"}}]}},{kind:"Field",name:{kind:"Name",value:"layoutConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"layoutMode"}},{kind:"Field",name:{kind:"Name",value:"isFullscreen"}},{kind:"Field",name:{kind:"Name",value:"slots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"header"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"subNav"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"contextualNotifications"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"end"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"nav"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"main"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"start"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"titleBar"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"toasts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"notifications"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}}]}}]}}]}},...a.definitions,...o.definitions]},s={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeEntities"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ActiveEntities"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subNavEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"headerEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"startEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"entityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}}]}},...a.definitions]},l={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowHistoryItem"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeEntities"}}]}},{kind:"Field",name:{kind:"Name",value:"reactiveVars"}}]}},...s.definitions]},d={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Window"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"windowHistoryNavigationState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canNavigateBack"}},{kind:"Field",name:{kind:"Name",value:"canNavigateForward"}},{kind:"Field",name:{kind:"Name",value:"backHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationItem"}}]}},{kind:"Field",name:{kind:"Name",value:"forwardHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationItem"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowHistoryNavigationItem"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"windowHistoryIndex"}},{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}}]}},...a.definitions]}.definitions]},c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataActiveWindowsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeWindows"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeWindows"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Window"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowOptions"}}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_window"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeEntities"}}]}},{kind:"Field",name:{kind:"Name",value:"windowHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryItem"}}]}},{kind:"Field",name:{kind:"Name",value:"currentWindowHistoryIndex"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationState"}}]}},...i.definitions,...r.definitions,...s.definitions,...l.definitions,...d.definitions]}.definitions]}},91400:(e,t,n)=>{"use strict";n.d(t,{x:()=>C});var i,a=n(13637),o=n(34255);!function(e){e.Info="Info",e.Warning="Warning",e.Error="Error",e.Debug="Debug"}(i||(i={}));var r=n(16552),s=n(6866),l=n(31821),d=n(89925),c=n(75351);const u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationUserQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"defaultName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"isMailAddress"},value:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}}},{kind:"Argument",name:{kind:"Name",value:"defaultName"},value:{kind:"Variable",name:{kind:"Name",value:"defaultName"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}}]}}]}}]},m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationGetUsersQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mriOrEmailArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mriOrEmailArray"},value:{kind:"Variable",name:{kind:"Name",value:"mriOrEmailArray"}}},{kind:"Argument",name:{kind:"Name",value:"isMailAddress"},value:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}},{kind:"Field",name:{kind:"Name",value:"emailForQuery"}}]}}]}}]},g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationPresenceSubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PresenceSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"presenceUpdateEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"availability"}},{kind:"Field",name:{kind:"Name",value:"activity"}},{kind:"Field",name:{kind:"Name",value:"isOutOfOffice"}},{kind:"Field",name:{kind:"Name",value:"lastSeenAt"}}]}}]}}]},p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationPresencesQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userPresenceRequestArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPresenceRequest"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"presences"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userPresenceRequestArray"},value:{kind:"Variable",name:{kind:"Name",value:"userPresenceRequestArray"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"availability"}},{kind:"Field",name:{kind:"Name",value:"activity"}},{kind:"Field",name:{kind:"Name",value:"isOutOfOffice"}},{kind:"Field",name:{kind:"Name",value:"lastSeenAt"}}]}}]}}]},h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationFireCallingIntentMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntentInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fireCallingIntent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntent"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationUserCallingSettingsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userCallingSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isCallingAllowed"}},{kind:"Field",name:{kind:"Name",value:"isPstnCallingAllowed"}}]}}]}}]};var S,f;!function(e){e[e.UnInitialized=0]="UnInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(S||(S={})),function(e){e.FreDialogDisplayedKey="office-integration-fre-dialog-displayed",e.HasManuallyUnregisteredIMProviderKey="office-integration-has-manually-unregistered"}(f||(f={}));const y="sip:",k=new Map([["InACall","OnThePhone"],["InAConferenceCall","InAMeeting"],["InAMeeting","InAMeeting"],["Presenting","Presenting"],["OffWork","Offline"],["Available","Online"],["Inactive","Idle"],["Busy","Busy"],["DoNotDisturb","Focusing"],["BeRightBack","BeRightBack"],["Away","Away"],["Offline","Offline"],["UrgentInterruptionsOnly","Focusing"],["PresenceUnknown","Unknown"],["OutOfOffice","OutOfOffice"]]);class C{constructor(e,t,n,i,a,o,l,c){this.hostCommunicationService=e,this.coreSettings=t,this.client=n,this.entityCommanding=a,this.windowProvider=o,this.localStorage=l,this.authenticationUser=c,this.initializedState=S.UnInitialized,this.unsubscribers=[],this.entityCommand={stateTransition:r.su.none,visibilityState:r.fe.show,correlation:{source:s.D.OfficeIntegration}},this.presenceSubscriptionMap=new Map,this.uriToMriCacheMap=new Map,this.selfMri="",this.selfActivity=d.Activity.PresenceUnknown,this.logger=i.newLogger("OfficeIntegration")}static Instance(e,t,n,i,a,o,r,s){return C.instance||(C.instance=new C(e,t,n,i,a,o,r,s)),C.instance}static defaultInstance(){return C.instance}initialize(){var e,t;return(0,a.mG)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(l.J.People).enableOfficeIntegration)return!1;if(this.initializedState!==S.UnInitialized)return!1;this.initializedState=S.Initializing;const n=yield this.hostCommunicationService.loadModule("officeintegration");if(n){const{isRegistered:a,isAdminAccessRequired:o,isUacEnabled:r}=(yield null===(e=n.isRegisteredIMProvider)||void 0===e?void 0:e.call(n))||{};if(this.logger.log(`initialize isRegistered ${a} isAdminAccessRequired ${o} isUacEnabled ${r}`),a)return this.startService(n);if(o&&r)this.startOfficeIntegrationFREDialog();else if(o||this.isLocalStoragePropertySet(f.HasManuallyUnregisteredIMProviderKey)){const e=`Failed to register due to isAdminAccessRequired ${o} isUacEnabled \n          ${r} HasManuallyUnregisteredIMProviderKey ${this.isLocalStoragePropertySet(f.HasManuallyUnregisteredIMProviderKey)}`;this.handleLogToTelemetry(e,"office_integration_register_im_provider",i.Warning)}else{const e=yield null===(t=n.registerIMProvider)||void 0===t?void 0:t.call(n,!1,!!r);if(0===e)return this.startService(n);{const t=`Failed to register during silent registration with result ${e}`;this.handleLogToTelemetry(t,"office_integration_register_im_provider",i.Warning,{errorCode:null==e?void 0:e.toString(16)})}}return!1}return!1}))}finalize(){var e;return(0,a.mG)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(l.J.People).enableOfficeIntegration)return!1;if(this.initializedState!==S.Initializing)return!1;const t=yield this.hostCommunicationService.loadModule("officeintegration");if(t){const{isRegistered:n}=(yield null===(e=t.isRegisteredIMProvider)||void 0===e?void 0:e.call(t))||{};if(n)return this.startService(t);const a="finalize is called without IM provider registered";return this.handleLogToTelemetry(a,"office_integration_fre_register_finalize_failed",i.Warning),!1}return!1}))}shutdown(){var e;return(0,a.mG)(this,void 0,void 0,(function*(){if(this.initializedState!==S.Initialized)return!1;this.initializedState=S.UnInitialized,this.unsubscribers.forEach((e=>e()));const t=yield this.hostCommunicationService.loadModule("officeintegration");if(t){return!!(null===(e=t.stopComServer)||void 0===e?void 0:e.call(t))}return!1}))}isRegisteredIMProvider(){var e;return(0,a.mG)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("officeintegration");return null===(e=null==t?void 0:t.isRegisteredIMProvider)||void 0===e?void 0:e.call(t)}))}registerIMProvider(e,t,n){var o;return(0,a.mG)(this,void 0,void 0,(function*(){const a=yield this.hostCommunicationService.loadModule("officeintegration");if(a){const r=yield null===(o=a.registerIMProvider)||void 0===o?void 0:o.call(a,e,t),s=`registerIMProvider result ${r} from ${n}. isAdminAccessRequired ${e} isUacEnabled ${t}`;return this.handleLogToTelemetry(s,"office_integration_register_im_provider",i.Info,{errorCode:null==r?void 0:r.toString(16)}),0===r}return!1}))}unregisterIMProvider(e){var t;return(0,a.mG)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("officeintegration");if(n){const a=yield null===(t=n.unregisterIMProvider)||void 0===t?void 0:t.call(n),o=`unregisterIMProvider result ${a} from ${e}`;return this.handleLogToTelemetry(o,"office_integration_unregister_im_provider",i.Info,{errorCode:null==a?void 0:a.toString(16)}),0===a}return!1}))}toggleIMProvider(e){return(0,a.mG)(this,void 0,void 0,(function*(){const{isRegistered:t,isAdminAccessRequired:n,isUacEnabled:i}=(yield this.isRegisteredIMProvider())||{};if(t){this.setLocalStorageProperty(f.HasManuallyUnregisteredIMProviderKey,"true");const t=yield this.unregisterIMProvider(e);return yield this.waitForRegistryUpdate(),t}if(yield this.registerIMProvider(!!n,!!i,e)){const e=yield this.hostCommunicationService.loadModule("officeintegration");return!!e&&(this.startService(e),yield this.waitForRegistryUpdate(),!0)}return!1}))}waitForRegistryUpdate(){return(0,a.mG)(this,void 0,void 0,(function*(){let e;yield new Promise((t=>{e=this.windowProvider.setTimeout(t,250)})),this.windowProvider.clearTimeout(e)}))}isLocalStoragePropertySet(e){var t;return"true"===(null===(t=this.localStorage)||void 0===t?void 0:t.get(e))}setLocalStorageProperty(e,t){var n;null===(n=this.localStorage)||void 0===n||n.set(e,t)}startService(e){var t,n,i,o,r,s,l,d,c;return(0,a.mG)(this,void 0,void 0,(function*(){if(this.initializedState===S.Initialized)return!1;let a;this.initializedState=S.Initialized,a=null===(t=e.registerForStartChat)||void 0===t?void 0:t.call(e,(e=>this.handleStartChat(e))),a&&this.unsubscribers.push(a),a=null===(n=e.registerForStartCall)||void 0===n?void 0:n.call(e,((e,t,n)=>this.handleStartCall(e,t,n))),a&&this.unsubscribers.push(a),a=null===(i=e.registerForTrackPresence)||void 0===i?void 0:i.call(e,(e=>this.handleTrackPresence(e))),a&&this.unsubscribers.push(a),a=null===(o=e.registerForUntrackPresence)||void 0===o?void 0:o.call(e,(e=>this.handleUntrackPresence(e))),a&&this.unsubscribers.push(a),a=null===(r=e.registerForLogStatement)||void 0===r?void 0:r.call(e,((e,t)=>this.handleLogStatement(e,t))),a&&this.unsubscribers.push(a);const m=(null===(s=this.authenticationUser)||void 0===s?void 0:s.loginUserName)||"",{data:g}=yield this.client.query({query:u,variables:{userId:m,isMailAddress:!0},context:{callerInfo:"office-integration-start"}}),p=null==g?void 0:g.user;if(p){const e=null===(l=p.userPrincipalName)||void 0===l?void 0:l.toLowerCase(),t=null===(d=p.email)||void 0===d?void 0:d.toLowerCase();p.mri&&(this.selfMri=p.mri,e&&this.uriToMriCacheMap.set(e,p.mri),t&&t!==e&&this.uriToMriCacheMap.set(t,p.mri))}return!!(yield null===(c=e.startComServer)||void 0===c?void 0:c.call(e,(null==p?void 0:p.userPrincipalName)||m))}))}startOfficeIntegrationFREDialog(){if(this.isLocalStoragePropertySet(f.FreDialogDisplayedKey))this.logger.log("Skipping FRE as it has already been displayed for user");else{this.entityCommanding.shell.openFreDialog(this.entityCommand),this.setLocalStorageProperty(f.FreDialogDisplayedKey,"true");const e="Start office integration FRE through user dialog registration";this.handleLogToTelemetry(e,"office_integration_fre_register_dialog",i.Info)}}notifyPresence(e){var t;return(0,a.mG)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("officeintegration");return null===(t=null==n?void 0:n.notifyPresence)||void 0===t?void 0:t.call(n,e)}))}convertLastSeenAt(e){if(e){return new Date(e).getTime()}}notifyInitialPresence(e,t){const n=[];e.presences.forEach((e=>{const i=d.Activity[e.activity||d.Activity.PresenceUnknown];e.id===this.selfMri&&e.activity&&(this.selfActivity=e.activity),n.push({id:e.id,requestedUri:t.get(e.id)||"",status:k.get(i)||i,lastSeenAt:this.convertLastSeenAt(e.lastSeenAt)})})),this.notifyPresence(n)}handleTrackPresence(e){return(0,a.mG)(this,void 0,void 0,(function*(){const t=yield this.mapUrisToMris(e),n=[],i=new Map;if(e.forEach((e=>{const a=t.get(e);if(a){const t=this.presenceSubscriptionMap.get(a);if(t)(!t.requestedUris.has(e)||a===this.selfMri&&d.Activity.PresenceUnknown===this.selfActivity)&&(t.requestedUris.add(e),n.push({userId:a,source:d.PresenceSource.ups}),i.set(a,e));else{const t=this.client.subscribe({query:g,variables:{userId:a,source:d.PresenceSource.ups}}).subscribe((({data:e})=>{e&&this.notifyUpdatedPresence(e)})),o={requestedUris:new Set,presenceSubscription:t};o.requestedUris.add(e),this.presenceSubscriptionMap.set(a,o),n.push({userId:a,source:d.PresenceSource.ups}),i.set(a,e)}}})),!(0,o.isEmpty)(n)){const{data:e}=yield this.client.query({query:p,variables:{userPresenceRequestArray:n}});e&&this.notifyInitialPresence(e,i)}}))}mapUrisToMris(e){return(0,a.mG)(this,void 0,void 0,(function*(){const t=this.resolveUrisToMrisFromCache(e);if(t.size===e.length)return t;{const n=[];return e.forEach((e=>{if(!t.has(e)){const t=e.startsWith(y)?e.substring(y.length):e;n.push(t)}})),(0,o.isEmpty)(n)?t:(yield this.resolveUrisToMrisFromServiceIntoCache(n),this.resolveUrisToMrisFromCache(e))}}))}resolveUrisToMrisFromServiceIntoCache(e){var t;return(0,a.mG)(this,void 0,void 0,(function*(){const{data:n}=yield this.client.query({query:m,variables:{mriOrEmailArray:e,isMailAddress:!0},context:{callerInfo:"office-integration-uri-resolution"}});null===(t=null==n?void 0:n.getUsers)||void 0===t||t.forEach((e=>{var t,n,i;if(e.mri&&"unknown_email_address@invalid.teams.ms"!==e.email){const a=null===(t=e.userPrincipalName)||void 0===t?void 0:t.toLowerCase(),o=null===(n=e.email)||void 0===n?void 0:n.toLowerCase(),r=null===(i=e.emailForQuery)||void 0===i?void 0:i.toLowerCase();a&&this.uriToMriCacheMap.set(a,e.mri),o&&o!==a&&this.uriToMriCacheMap.set(o,e.mri),r&&r!==a&&r!==o&&this.uriToMriCacheMap.set(r,e.mri)}}))}))}resolveUrisToMrisFromCache(e){const t=new Map;return e.forEach((e=>{const n=e.toLowerCase(),i=n.startsWith(y)?n.substring(y.length):n,a=this.uriToMriCacheMap.get(i);a&&t.set(e,a)})),t}notifyUpdatedPresence(e){const t=e.presenceUpdateEvent;if(t){const e=t.id,n=this.presenceSubscriptionMap.get(e);if(n){const i=[],a=d.Activity[t.activity||d.Activity.PresenceUnknown],o=k.get(a)||a,r=this.convertLastSeenAt(t.lastSeenAt);n.requestedUris.forEach((t=>{i.push({id:e,requestedUri:t,status:o,lastSeenAt:r})})),e===this.selfMri&&t.activity&&(this.selfActivity=t.activity),this.notifyPresence(i)}}}handleUntrackPresence(e){return(0,a.mG)(this,void 0,void 0,(function*(){(yield this.mapUrisToMris(e)).forEach(((e,t)=>{const n=this.presenceSubscriptionMap.get(e);n&&(n.requestedUris.delete(t),(0,o.isEmpty)(n.requestedUris)&&(n.presenceSubscription.unsubscribe(),this.presenceSubscriptionMap.delete(e)))}))}))}handleStartChat(e){return(0,a.mG)(this,void 0,void 0,(function*(){this.logger.log("Starting chat");const t=e.split(";").filter((e=>!!e.trim())),n=yield this.mapUrisToMris(t),a=`mapped ${n.size} uris`;this.handleLogToTelemetry(a,"office_integration_handle_chat",i.Info);const r=Array.from(n.values());(0,o.isEmpty)(r)?this.handleLogToTelemetry("No mapped uris to start chat","office_integration_handle_chat",i.Warning):this.navigateToChat(r)}))}navigateToChat(e,t=r.su.new){return(0,a.mG)(this,void 0,void 0,(function*(){return this.entityCommanding.chat.chatWithUsers({userIds:e,entityCommand:{stateTransition:t,visibilityState:r.fe.show,correlation:{source:s.D.OfficeIntegrationChat}}})}))}handleStartCall(e,t,n){return(0,a.mG)(this,void 0,void 0,(function*(){const{enableOfficeIntegrationCalling:a}=this.coreSettings.get(l.J.Calling);try{const{data:{userCallingSettings:o}}=yield this.client.query({query:v,variables:{}});if(!a||n&&!(null==o?void 0:o.isPstnCallingAllowed)||!n&&!(null==o?void 0:o.isCallingAllowed))return void this.handleLogToTelemetry("Office integration calling or policy is disabled","office_integration_handle_call",i.Warning,{context:JSON.stringify({enableOfficeIntegrationCalling:a,isPSTN:n,isVideo:t,isCallingAllowed:null==o?void 0:o.isCallingAllowed,isPstnCallingAllowed:null==o?void 0:o.isPstnCallingAllowed})});this.handleLogToTelemetry("Starting call","office_integration_handle_call",i.Info,{context:JSON.stringify({enableOfficeIntegrationCalling:a,isPSTN:n,isVideo:t})});const r=n?this.getPstnCallingIntent(e):yield this.getVoipCallingIntentAndNavigateChat(e,t);yield this.client.mutate({mutation:h,variables:{callingIntent:r}}),this.handleLogToTelemetry("Successfully triggered call","office_integration_handle_call",i.Info,{context:JSON.stringify({enableOfficeIntegrationCalling:a,isPSTN:n,isVideo:t})})}catch(e){this.handleLogToTelemetry("Failed to start call","office_integration_handle_call",i.Error,{context:JSON.stringify({enableOfficeIntegrationCalling:a,isPSTN:n,isVideo:t}),errors:(null==e?void 0:e.message)||e})}}))}getPstnCallingIntent(e){return{type:d.CallingIntentType.OneToOneCall,joinOptions:{},coordinates:{oneToOne:{mri:(0,c.DI)(e)}}}}getVoipCallingIntentAndNavigateChat(e,t){return(0,a.mG)(this,void 0,void 0,(function*(){const n=(yield this.mapUrisToMris([e])).get(e);if(!n)throw new Error("No mapped uri to start call");return yield this.navigateToChat([n],r.su.flush),{type:d.CallingIntentType.OneToOneCall,coordinates:{oneToOne:{mri:n}},joinOptions:{outgoingVideo:t}}}))}handleLogStatement(e,t){switch(t){case i.Info:this.logger.log(e);break;case i.Debug:this.logger.debug(e);break;case i.Error:this.logger.error(e);break;case i.Warning:this.logger.warn(e)}}handleLogToTelemetry(e,t,n,a,o=!0){switch(n){case i.Info:this.logger.infoToTelemetry?this.logger.infoToTelemetry(e,t,a,o):this.logger.log(e);break;case i.Debug:this.logger.debugToTelemetry?this.logger.debugToTelemetry(e,t,a,o):this.logger.debug(e);break;case i.Error:this.logger.errorToTelemetry?this.logger.errorToTelemetry(e,t,a,o):this.logger.error(e);break;case i.Warning:this.logger.warnToTelemetry?this.logger.warnToTelemetry(e,t,a,o):this.logger.warn(e)}}}},30755:(e,t,n)=>{"use strict";var i,a;n.d(t,{V:()=>i}),function(e){e[e.BT_STOP=0]="BT_STOP",e[e.BT_STOP_BASE=1]="BT_STOP_BASE",e[e.BT_BOOL=2]="BT_BOOL",e[e.BT_UINT8=3]="BT_UINT8",e[e.BT_UINT16=4]="BT_UINT16",e[e.BT_UINT32=5]="BT_UINT32",e[e.BT_UINT64=6]="BT_UINT64",e[e.BT_FLOAT=7]="BT_FLOAT",e[e.BT_DOUBLE=8]="BT_DOUBLE",e[e.BT_STRING=9]="BT_STRING",e[e.BT_STRUCT=10]="BT_STRUCT",e[e.BT_LIST=11]="BT_LIST",e[e.BT_SET=12]="BT_SET",e[e.BT_MAP=13]="BT_MAP",e[e.BT_INT8=14]="BT_INT8",e[e.BT_INT16=15]="BT_INT16",e[e.BT_INT32=16]="BT_INT32",e[e.BT_INT64=17]="BT_INT64",e[e.BT_WSTRING=18]="BT_WSTRING",e[e.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"}(i||(i={})),function(e){e[e.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL",e[e.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL",e[e.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL",e[e.JSON_PROTOCOL=21322]="JSON_PROTOCOL",e[e.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL",e[e.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"}(a||(a={}))},79154:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});class i{constructor(){this._buffer=[]}Add(e,t){-1==this._getIndex(e)&&this._buffer.push({Key:e,Value:t})}AddOrReplace(e,t){var n=this._getIndex(e);n>=0?this._buffer[n]={Key:e,Value:t}:this._buffer.push({Key:e,Value:t})}Remove(e){var t=this._getIndex(e);t>=0&&this._buffer.splice(t,1)}Count(){return this._buffer.length}GetBuffer(){return this._buffer}ContainsKey(e){return this._getIndex(e)>=0}Get(e){var t=this._getIndex(e);return t>=0?this._buffer[t].Value:null}_getIndex(e){for(var t=0,n=-1;t<this._buffer.length;++t)if(this._buffer[t].Key==e){n=t;break}return n}}},50746:(e,t,n)=>{"use strict";n.d(t,{di:()=>a,DS:()=>o,Km:()=>r,Ms:()=>s,bv:()=>l,bh:()=>d,if:()=>c});var i=n(37033);class a{static GetBytes(e){for(var t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++n)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t}}class o{static GetString(e){var t,n,i,a,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[],s=e.length%3;for(t=0,i=e.length-s;t<i;t+=3)n=(e[t]<<16)+(e[t+1]<<8)+e[t+2],r.push([o.charAt((a=n)>>18&63),o.charAt(a>>12&63),o.charAt(a>>6&63),o.charAt(63&a)].join(""));switch(s){case 1:n=e[e.length-1],r.push(o.charAt(n>>2)),r.push(o.charAt(n<<4&63)),r.push("==");break;case 2:n=(e[e.length-2]<<8)+e[e.length-1],r.push(o.charAt(n>>10)),r.push(o.charAt(n>>4&63)),r.push(o.charAt(n<<2&63)),r.push("=")}return r.join("")}}class r{static GetBytes(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t}}class s{static GetBytes(e){for(var t=e.low,n=e.high,i=[];n||4294967168&t;)i.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return i.push(127&t),i}}class l{static GetBytes(e){if(i.KS.IsDataViewSupport()){var t=new DataView(new ArrayBuffer(4));t.setFloat32(0,e,!0);for(var n=[],a=0;a<4;++a)n.push(t.getUint8(a));return n}return u.ConvertNumberToArray(e,!1)}}class d{static GetBytes(e){if(i.KS.IsDataViewSupport()){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e,!0);for(var n=[],a=0;a<8;++a)n.push(t.getUint8(a));return n}return u.ConvertNumberToArray(e,!0)}}class c{static EncodeZigzag16(e){return(e=i.Mr.ToInt16(e))<<1^e>>15}static EncodeZigzag32(e){return(e=i.Mr.ToInt32(e))<<1^e>>31}static EncodeZigzag64(e){var t=e.low,n=e.high,a=n<<1|t>>>31,o=t<<1;2147483648&n&&(a=~a,o=~o);var r=new i.zM("0");return r.low=o,r.high=a,r}}class u{static ConvertNumberToArray(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?52:23,i=(1<<(t?11:8)-1)-1,a=1-i,o=i,r=e<0?1:0;e=Math.abs(e);for(var s=Math.floor(e),l=e-s,d=2*(i+2)+n,c=new Array(d),u=0;u<d;)c[u++]=0;for(u=i+2;u&&s;)c[--u]=s%2,s=Math.floor(s/2);for(u=i+1;u<d-1&&l>0;)(l*=2)>=1?(c[++u]=1,--l):c[++u]=0;for(var m=0;m<d&&!c[m];++m);var g=i+1-m,p=m+n;if(c[p+1]){for(u=p;u>m&&!(c[u]=1-c[u]);--u);u==m&&++g}if(g>o||s)return r?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(g<a)return t?this._doubleZero:this._floatZero;if(t){var h=0;for(u=0;u<20;++u)h=h<<1|c[++m];for(var v=0;u<52;++u)v=v<<1|c[++m];return[255&v,v>>8&255,v>>16&255,v>>>24,255&(h=r<<31|2147483647&(h|=g+i<<20)),h>>8&255,h>>16&255,h>>>24]}var S=0;for(u=0;u<23;++u)S=S<<1|c[++m];return[255&(S=r<<31|2147483647&(S|=g+i<<23)),S>>8&255,S>>16&255,S>>>24]}static ConvertArrayToNumber(e,t){var n=(1<<(t?11:8)-1)-1,a=0!=(128&e[t?7:3]),o=t?(127&e[7])<<4|(240&e[6])>>4:(127&e[3])<<1|(128&e[2])>>7;if(255==o)throw new i.Pp("Not a valid float/double buffer.");var r=1,s=1;if(t){var l=(15&e[6])<<28|(255&e[5])<<20|(255&e[4])<<12,d=e[3]<<24|(255&e[2])<<16|(255&e[1])<<8|255&e[0];if(!o&&!l&&!d)return 0;for(var c=0;c<20;++c)s/=2,l<0&&(r+=s),l<<=1;for(c=0;c<32;++c)s/=2,d<0&&(r+=s),d<<=1}else{var u=(127&e[2])<<25|(255&e[1])<<17|(255&e[0])<<9;if(!o&&!u)return 0;for(c=0;c<23;++c)s/=2,u<0&&(r+=s),u<<=1}return r*=Math.pow(2,o-n),a?0-r:r}}u._floatZero=[0,0,0,0],u._doubleZero=[0,0,0,0,0,0,0,0],u._floatInifinity=[0,0,128,127],u._floatNegInifinity=[0,0,128,255],u._doubleInifinity=[0,0,0,0,0,0,240,127],u._doubleNegInifinity=[0,0,0,0,0,0,240,255]},37033:(e,t,n)=>{"use strict";n.d(t,{ni:()=>o,zM:()=>r,Mr:()=>s,Pp:()=>l,KS:()=>d,rH:()=>c});var i=n(30755),a=n(50746);class o{constructor(e){this.low=0,this.high=0,this.low=parseInt(e),this.low<0&&(this.high=-1)}Equals(e){var t=new o(e);return this.low==t.low&&this.high==t.high}}class r{constructor(e){this.low=0,this.high=0,this.low=parseInt(e)}Equals(e){var t=new r(e);return this.low==t.low&&this.high==t.high}}class s{static ToByte(e){return this.ToUInt8(e)}static ToInt8(e){return 127&e|(128&e)<<24>>24}static ToInt16(e){return 32767&e|(32768&e)<<16>>16}static ToInt32(e){return 2147483647&e|2147483648&e}static ToUInt8(e){return 255&e}static ToUInt16(e){return 65535&e}static ToUInt32(e){return 4294967295&e}}class l{constructor(e){this.Message=e}}class d{static IsDataViewSupport(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView}}class c{constructor(e){this._stream=e}WriteBlob(e){this._stream.Write(e,0,e.length)}WriteBool(e){this._stream.WriteByte(e?1:0)}WriteContainerBegin(e,t){this.WriteUInt8(t),this.WriteUInt32(e)}WriteMapContainerBegin(e,t,n){this.WriteUInt8(t),this.WriteUInt8(n),this.WriteUInt32(e)}WriteContainerEnd(){}WriteDouble(e){var t=a.bh.GetBytes(e);this._stream.Write(t,0,t.length)}WriteFloat(e){var t=a.bv.GetBytes(e);this._stream.Write(t,0,t.length)}WriteFieldBegin(e,t,n){t<=5?this._stream.WriteByte(e|t<<5):t<=255?(this._stream.WriteByte(192|e),this._stream.WriteByte(t)):(this._stream.WriteByte(224|e),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))}WriteFieldEnd(){}WriteFieldOmitted(e,t,n){}WriteInt16(e){e=a.if.EncodeZigzag16(e),this.WriteUInt16(e)}WriteInt32(e){e=a.if.EncodeZigzag32(e),this.WriteUInt32(e)}WriteInt64(e){this.WriteUInt64(a.if.EncodeZigzag64(e))}WriteInt8(e){this._stream.WriteByte(s.ToInt8(e))}WriteString(e){if(""==e)this.WriteUInt32(0);else{var t=a.di.GetBytes(e);this.WriteUInt32(t.length),this._stream.Write(t,0,t.length)}}WriteStructBegin(e,t){}WriteStructEnd(e){this.WriteUInt8(e?i.V.BT_STOP_BASE:i.V.BT_STOP)}WriteUInt16(e){var t=a.Km.GetBytes(s.ToUInt16(e));this._stream.Write(t,0,t.length)}WriteUInt32(e){var t=a.Km.GetBytes(s.ToUInt32(e));this._stream.Write(t,0,t.length)}WriteUInt64(e){var t=a.Ms.GetBytes(e);this._stream.Write(t,0,t.length)}WriteUInt8(e){this._stream.WriteByte(s.ToUInt8(e))}WriteWString(e){this.WriteUInt32(e.length);for(var t=0;t<e.length;++t){var n=e.charCodeAt(t);this._stream.WriteByte(n),this._stream.WriteByte(n>>>8)}}}},71503:(e,t,n)=>{"use strict";n.d(t,{P6:()=>d,A4:()=>o,WV:()=>u,Pm:()=>m,$L:()=>g});var i,a,o,r=n(37033),s=n(30755),l=n(79154);class d{static GetGuid(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5)};return[e(),e(),"-",e(),"-",e(),"-",e(),"-",e(),e(),e()].join("")}static GetTimeStamp(){var e=(new Date).getTime(),t=new r.ni("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t}static GetTimeStampWithValue(e){var t=new r.ni("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t}}!function(e){e[e.NotSet=0]="NotSet",e[e.Event=1]="Event",e[e.PerformanceCounter=2]="PerformanceCounter",e[e.Anomaly=3]="Anomaly",e[e.Prediction=4]="Prediction",e[e.TraceLog=5]="TraceLog",e[e.EventSourceLog=6]="EventSourceLog",e[e.HttpLog=7]="HttpLog",e[e.PerformanceCounterAzure=8]="PerformanceCounterAzure",e[e.PerformanceCounterGfs=9]="PerformanceCounterGfs"}(i||(i={})),function(e){e[e.NotSet=0]="NotSet",e[e.O365=1]="O365",e[e.SkypeBI=2]="SkypeBI",e[e.SkypeData=3]="SkypeData"}(a||(a={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy",e[e.FilePath=14]="FilePath"}(o||(o={}));class c{constructor(){this.ScrubType=a.NotSet,this.Kind=o.NotSet,this.RawContent=""}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){e.WriteStructBegin(null,t),this.ScrubType!=a.NotSet?(e.WriteFieldBegin(s.V.BT_INT32,1,null),e.WriteInt32(this.ScrubType),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_INT32,1,null),this.Kind!=o.NotSet?(e.WriteFieldBegin(s.V.BT_INT32,2,null),e.WriteInt32(this.Kind),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_INT32,2,null),""!=this.RawContent?(e.WriteFieldBegin(s.V.BT_STRING,3,null),e.WriteString(this.RawContent),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_STRING,3,null),e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}class u{constructor(){this.Id=d.GetGuid(),this.Timestamp=d.GetTimeStamp(),this.Type="",this.EventType="",this.Extension=new l.D,this.RecordType=i.NotSet,this.PIIExtensions=new l.D}AddOrReplacePII(e,t,n){var i=new c;i.RawContent=t,i.Kind=n,i.ScrubType=a.O365,this.PIIExtensions.AddOrReplace(e,i)}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){if(e.WriteStructBegin(null,t),""!=this.Id?(e.WriteFieldBegin(s.V.BT_STRING,1,null),e.WriteString(this.Id),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_STRING,1,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(s.V.BT_INT64,3,null):(e.WriteFieldBegin(s.V.BT_INT64,3,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),""!=this.Type?(e.WriteFieldBegin(s.V.BT_STRING,5,null),e.WriteString(this.Type),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_STRING,5,null),""!=this.EventType?(e.WriteFieldBegin(s.V.BT_STRING,6,null),e.WriteString(this.EventType),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_STRING,6,null),this.Extension.Count()){e.WriteFieldBegin(s.V.BT_MAP,13,null),e.WriteMapContainerBegin(this.Extension.Count(),s.V.BT_STRING,s.V.BT_STRING);for(var n=0;n<this.Extension.GetBuffer().length;++n)e.WriteString(this.Extension.GetBuffer()[n].Key),e.WriteString(this.Extension.GetBuffer()[n].Value);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(s.V.BT_MAP,13,null);if(this.RecordType!=i.NotSet?(e.WriteFieldBegin(s.V.BT_INT32,24,null),e.WriteInt32(this.RecordType),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_INT32,24,null),this.PIIExtensions.Count()){e.WriteFieldBegin(s.V.BT_MAP,30,null),e.WriteMapContainerBegin(this.PIIExtensions.Count(),s.V.BT_STRING,s.V.BT_STRUCT);for(var a=0;a<this.PIIExtensions.GetBuffer().length;++a)e.WriteString(this.PIIExtensions.GetBuffer()[a].Key),this.PIIExtensions.GetBuffer()[a].Value.WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(s.V.BT_MAP,30,null);e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}class m{constructor(){this.Source="",this.DataPackageId="",this.Timestamp=new r.ni("0"),this.Records=[]}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){if(e.WriteStructBegin(null,t),""!=this.Source?(e.WriteFieldBegin(s.V.BT_STRING,2,null),e.WriteString(this.Source),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_STRING,2,null),""!=this.DataPackageId?(e.WriteFieldBegin(s.V.BT_STRING,5,null),e.WriteString(this.DataPackageId),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_STRING,5,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(s.V.BT_INT64,6,null):(e.WriteFieldBegin(s.V.BT_INT64,6,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),this.Records.length){e.WriteFieldBegin(s.V.BT_LIST,8,null),e.WriteContainerBegin(this.Records.length,s.V.BT_STRUCT);for(var n=0;n<this.Records.length;++n)this.Records[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(s.V.BT_LIST,8,null);e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}class g{constructor(){this.DataPackages=[],this.RequestRetryCount=0}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){if(e.WriteStructBegin(null,t),this.DataPackages.length){e.WriteFieldBegin(s.V.BT_LIST,1,null),e.WriteContainerBegin(this.DataPackages.length,s.V.BT_STRUCT);for(var n=0;n<this.DataPackages.length;++n)this.DataPackages[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(s.V.BT_LIST,1,null);0!=this.RequestRetryCount?(e.WriteFieldBegin(s.V.BT_INT32,2,null),e.WriteInt32(this.RequestRetryCount),e.WriteFieldEnd()):e.WriteFieldOmitted(s.V.BT_INT32,2,null),e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}},21643:(e,t,n)=>{"use strict";n.d(t,{Mk:()=>f,sE:()=>y});var i=n(71503);class a{static IsSafariOrFirefox(){return null===a._isSafariOrFirefox&&a._DetectBrowser(),a._isSafariOrFirefox}static ajax(e){var t=a._createConnection();if(e.headers){var n="qsp=true";for(var i in e.headers)n+="&",n+=encodeURIComponent(i),n+="=",n+=encodeURIComponent(e.headers[i]);e.url.indexOf("?")<0?e.url+="?":e.url+="&",e.url+=n}t.open(e.type,e.url),e.complete&&(t.onload=()=>{void 0===t.status&&(t.status=200),e.complete(t)},t.ontimeout=()=>{void 0===t.status&&(t.status=500),e.complete(t)},t.onerror=()=>{e.complete(t)}),t.send(e.data)}static keys(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}static IsUsingXDomainRequest(){null==a._usingXDomainRequest&&(void 0===(new XMLHttpRequest).withCredentials&&"undefined"!=typeof XDomainRequest?a._usingXDomainRequest=!0:a._usingXDomainRequest=!1);return a._usingXDomainRequest}static _createConnection(){var e=new XMLHttpRequest;return a.IsUsingXDomainRequest()?new XDomainRequest:e}static _DetectBrowser(){var e=navigator.userAgent.toLowerCase();(e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0?a._isSafariOrFirefox=!0:a._isSafariOrFirefox=!1}}a._isSafariOrFirefox=null,a._usingXDomainRequest=null;var o,r,s,l=n(50746),d=n(37033);class c{constructor(){this._buffer=[]}WriteByte(e){this._buffer.push(d.Mr.ToByte(e))}Write(e,t,n){for(;n--;)this.WriteByte(e[t++])}GetBuffer(){return this._buffer}}class u{constructor(){this.data=[]}WriteBlob(e){let t={type:"blob",value:e};this.data.push(t)}WriteBool(e){let t={type:"boolean",value:e};this.data.push(t)}WriteContainerBegin(e,t){let n={type:"containerBegin",size:e,elementType:t};this.data.push(n)}WriteMapContainerBegin(e,t,n){let i={type:"mapContainerBegin",size:e,keyType:t,valueType:n};this.data.push(i)}WriteContainerEnd(){this.data.push({type:"containerEnd"})}WriteDouble(e){let t={type:"number",value:e};this.data.push(t)}WriteFloat(e){let t={type:"number",value:e};this.data.push(t)}WriteFieldBegin(e,t,n){let i={type:"fieldBegin",id:t};this.data.push(i)}WriteFieldEnd(){this.data.push({type:"fieldEnd"})}WriteFieldOmitted(e,t,n){let i={type:"fieldOmitted",id:t};this.data.push(i)}WriteInt16(e){let t={type:"number",value:e};this.data.push(t)}WriteInt32(e){let t={type:"number",value:e};this.data.push(t)}WriteInt64(e){let t={type:"number",value:4294967296*e.high+e.low};this.data.push(t)}WriteInt8(e){let t={type:"number",value:e};this.data.push(t)}WriteString(e){let t={type:"string",value:e};this.data.push(t)}WriteStructBegin(e,t){let n={type:"structBegin",isBase:t};this.data.push(n)}WriteStructEnd(e){let t={type:"structEnd",isBase:e};this.data.push(t)}WriteUInt16(e){let t={type:"number",value:e};this.data.push(t)}WriteUInt32(e){let t={type:"number",value:e};this.data.push(t)}WriteUInt64(e){let t={type:"number",value:e};this.data.push(t)}WriteUInt8(e){let t={type:"number",value:e};this.data.push(t)}WriteWString(e){let t={type:"string",value:e};this.data.push(t)}}!function(e){e[e.ECS_ERROR_OK=0]="ECS_ERROR_OK",e[e.ECS_ERROR_INVALID_STATUS=1]="ECS_ERROR_INVALID_STATUS",e[e.ECS_ERROR_INVALID_RESPONSE=6]="ECS_ERROR_INVALID_RESPONSE",e[e.ECS_ERROR_INVALID_CONFIG=8]="ECS_ERROR_INVALID_CONFIG"}(o||(o={}));!function(e){e[e.CONFIG_UPDATED=0]="CONFIG_UPDATED",e[e.TOKEN_IS_INVALID=1]="TOKEN_IS_INVALID"}(r||(r={}));class m{}m.Servers=["https://config.teams.microsoft.com/config/v1/Skype/"],m.RefreshIntervalInMS=36e5,m.FailedRetryFactorInMS=1e4,m.MaxRetryIntervalForFailedInMS=36e5,function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started",e[e.Loading=3]="Loading"}(s||(s={}));var g,p,h,v=n(85259);!function(e){e[e.SENT=0]="SENT",e[e.SEND_FAILED=1]="SEND_FAILED"}(g||(g={})),function(e){e[e.DATARV_ERROR_OK=0]="DATARV_ERROR_OK",e[e.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT",e[e.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG",e[e.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES",e[e.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS",e[e.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG"}(p||(p={}));class S{constructor(e){this._errorCode=p.DATARV_ERROR_OK,this._errorCode=e}ErrorCode(){return this._errorCode}toString(){switch(this._errorCode){case p.DATARV_ERROR_OK:return"DATARV_ERROR_OK";case p.DATARV_ERROR_INVALID_EVENT:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty.";case p.DATARV_ERROR_INVALID_CONFIG:return"Invalid configuration. CollectorUrl is missing.";case p.DATARV_ERROR_INVALID_DEPENDENCIES:return"DATARV_ERROR_INVALID_DEPENDENCIES";case p.DATARV_ERROR_INVALID_STATUS:return"Telemetry Manager is not initialized.";case p.DATARV_ERROR_INVALID_ARG:return"TenantToken is null or empty, or events is null.";default:return"Unknown error"}}}class f{constructor(){this.eventsLimitInMem=1e4}}class y{static CreateTelemetryManager(){return new C}}class k{}k.MaxPackageSizeInBytes=3e6,k.TimeIntervalForNextSendInMS=15e3,function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started"}(h||(h={}));class C{constructor(){this._MaxPackageSizeInBytes=k.MaxPackageSizeInBytes,this._listeners=[],this._status=h.Created,this._ecsClient=null,this._etag=null,this._ecsCallback=null,this._testServerResponseHook=null,this._testHookListeners=[]}Initialize(e){if(this._status!=h.Created)throw new S(p.DATARV_ERROR_INVALID_STATUS);if(!e||!e.collectorUrl)throw new S(p.DATARV_ERROR_INVALID_CONFIG);this._config=e,this._Reset(),this._status=h.Initialized,e.ecsClient&&(this._Verbose("ECS object assigned. Do integration"),this._ecsClient=e.ecsClient),e.overwriteSendTimeInterval&&e.overwriteSendTimeInterval>=0&&(k.TimeIntervalForNextSendInMS=e.overwriteSendTimeInterval),this._Verbose("Initialize() done")}setEventsLimitInMem(e){this._eventsCache.setEventsLimitInMem(e)}AddListener(e){if(this._status<h.Initialized)throw new S(p.DATARV_ERROR_INVALID_STATUS);this._Verbose(["AddListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void this._Verbose("the listener has been added already, index: "+t);this._listeners.push(e),this._Verbose("AddListener() done, the new length: "+this._listeners.length)}RemoveListener(e){if(this._status<h.Initialized)throw new S(p.DATARV_ERROR_INVALID_STATUS);this._Verbose(["RemoveListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return 1==this._listeners.length?this._listeners=[]:t==this._listeners.length-1?this._listeners.pop():this._listeners[t]=this._listeners.pop(),void this._Verbose(["this listener has been found, index: ",t,"new length: ",this._listeners.length].join(""));this._Verbose("listener isn't been found, new length"+this._listeners.length)}Start(){if(this._status<h.Initialized)throw new S(p.DATARV_ERROR_INVALID_STATUS);this._Verbose(["Start(), status:",this._status,"tag:",C._tag].join(" ")),this._status>=h.Started&&this._Verbose("Start() already, ignore"),this._ecsClient&&(this._ecsCallback=this._CreateEcsCallback(),this._ecsClient.AddListener(this._ecsCallback),this._etag=this._ecsClient.GetETag()),++C._tag,this._status=h.Started,this._Verbose(["Start() done, status: ",this._status,"tag: ",C._tag].join(""))}Stop(){if(this._status<h.Initialized)throw new S(p.DATARV_ERROR_INVALID_STATUS);this._Verbose("Stop(), status: "+this._status),this._status!=h.Initialized?(this._Reset(),this._status=h.Initialized,this._Verbose("Stop() done, status: "+this._status)):this._Verbose("Stop() already, ignore")}Flush(e){this._eventsCache.IsEmpty()||this._WorkThread(e)}SendAsync(e,t){var n;if(this._status<h.Initialized)throw new S(p.DATARV_ERROR_INVALID_STATUS);if(this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",e,"count:",t.length].join(" ")),this._status<h.Started)return this._Info("SendAsync(), not started, ignore, return false"),!1;if(!e||!t)throw this._Error("SendAsync(), tenantToken or events is null or empty"),new S(p.DATARV_ERROR_INVALID_ARG);for(var i=0;i<t.length;++i)if(!t[i].Id||!C._eventTypeRegex.test(t[i].EventType)||t[i].Timestamp.Equals("0"))throw this._Error(["eventId:",t[i].Id,"eventType:",t[i].EventType,"timestamp high:",t[i].Timestamp.high,"timestamp low:",t[i].Timestamp.low].join("")),new S(p.DATARV_ERROR_INVALID_EVENT);return null===(n=this._eventsCache)||void 0===n||n.AddEvents(e,t),this._Verbose(["SendAsync(), currentTimer: ",this._timer,"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" ")),this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1),this._Verbose("SendAsync() done"),!0}_WorkThread(e){var t;try{var n=Date.now();if(this._Verbose("_WorkThread, status: "+this._status),this._status<h.Started)return void this._Verbose("_WorkThread, status is not started, return");var i=this._eventsCache.DequeuEvents();if(null==i)return this._Verbose("_WorkThread, No events found, return"),void this._CleanTimer();var o=i.events.length,r=this._PackEvents(i.tenantToken,i.events);null===(t=this._eventsCache)||void 0===t||t.AddEvents(i.tenantToken,r.remainedEvents);var s=r.remainedEvents.length;if(null==r.buffer||0==r.buffer.length)return void(this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1)));if(this._testHookListeners)for(var d=0;d<this._testHookListeners.length;++d)this._testHookListeners[d](r.sendEvents);if(this._testServerResponseHook){var c=this._testServerResponseHook();return void setTimeout((()=>this._SendCallback(m,i.tenantToken,r.sendEvents,c,null)),100)}var u={type:"POST",url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary","client-id":"NO_AUTH","sdk-version":"ACT-Web-JS-"+v.w.version},complete:t=>this._SendCallback(m,i.tenantToken,r.sendEvents,t,e)};this._config.useJsonTextStream?(u.data=r.buffer,u.headers["content-type"]="application/json"):a.IsSafariOrFirefox()||"undefined"==typeof Uint8Array?(this._Verbose("Uint8Array is undefined, send with base64 encode."),u.data=l.DS.GetString(r.buffer),u.headers["content-encoding"]="base64"):(this._Verbose("Uint8Array is defined, send with binary format directly."),u.data=new Uint8Array(r.buffer)),i.tenantToken&&(u.headers["x-apikey"]=i.tenantToken);var m=C._tag;this._lastActiveTime=(new Date).getTime(),a.ajax(u),this._Verbose("_Workthread, send via jquery, tag: "+m),this._Info("Processing telemetry events took "+(Date.now()-n)+" ms for "+(o-s)+" events with total size of "+r.buffer.length+" bytes, remaining events - "+s)}catch(e){this._Error("_WorkThread, exception: "+e)}}_PackEvents(e,t){this._Verbose("_PackageEvents, total Count: "+t.length);var n,a=new i.$L,o=new i.Pm;o.Source="JS_default_source",o.DataPackageId=i.P6.GetGuid(),o.Timestamp=i.P6.GetTimeStamp();var r=t;if(t=[],r.length>200){var s=r.splice(0,200);t.push.apply(t,r),r=s}for(;o.Records=[],o.Records.push.apply(o.Records,r),a.DataPackages=[],a.DataPackages.push(o),n=this._Serialize(a),this._Verbose(["_PackageEvents, sendEvents.length:",r.length," buffer.length:",n.length," MaxPackageSize:",this._MaxPackageSizeInBytes].join("")),!(n.length<this._MaxPackageSizeInBytes);){if(1==r.length){r=[],n=null;break}var l=r.splice(0,Math.floor(r.length/2));this._Verbose("_PackageEvents, too large, package again"),t.push.apply(t,r),r=l}return this._Verbose(["_PakcageEvents done, sendEventsCount:",r.length,"buffer.length:",null==n?0:n.length,"remained events:",t.length].join("")),{buffer:n,sendEvents:r,remainedEvents:t}}_Serialize(e){if(this._config.useJsonTextStream){var t=new u;return e.Write(t),JSON.stringify(t.data)}var n=new c,i=new d.rH(n);return e.Write(i),n.GetBuffer()}_SendCallback(e,t,n,i,a){var o;if(this._Verbose(["_SendCallback","tag:",e,"current tag:",C._tag,"tenantToken:",t,"events count:",n.length,"jqXHR:",i].join("")),null==a){var r=null!=i&&i.status>=200&&i.status<300;if(this._status<h.Started||e<C._tag)this._Verbose("_SendCallback, is not started, or tag is not the same, return");else{if(!(r||i&&400==i.status))return this._Verbose("retry statusCode: "+(i?i.status:0)),null===(o=this._eventsCache)||void 0===o||o.AddEvents(t,n),void this._ScheduleTimer(!0);for(var s=0;s<this._listeners.length;++s)this._listeners[s](r?g.SENT:g.SEND_FAILED,i?i.status:0,t,n);this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1))}}else a(i?i.status:0,t,n)}_CleanTimer(){this._Verbose("_CleanTimer(), timer: "+this._timer),this._timer&&(clearTimeout(this._timer),this._timer=null)}_ScheduleTimer(e){if(this._Verbose("_ScheduleTimer: isRetry: "+e),this._CleanTimer(),e){this._Verbose("_ScheduleTimer, current factor: "+this._rescheduleFactor);t=Math.floor(5*this._rescheduleFactor*(1+Math.random()));this._timer=setTimeout((()=>this._WorkThread(null)),1e3*t),this._Verbose("_ScheduleTimer, next try (s): "+t),this._rescheduleFactor<<=1,this._rescheduleFactor>64&&(this._rescheduleFactor=1)}else{var t=0,n=(new Date).getTime()-this._lastActiveTime;t=n>k.TimeIntervalForNextSendInMS?0:k.TimeIntervalForNextSendInMS-n,this._timer=setTimeout((()=>this._WorkThread(null)),t),this._Verbose("_ScheduleTimer, next try: "+t),this._rescheduleFactor=1}}_Verbose(e){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+e)}_Info(e){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+e)}_Error(e){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+e)}_Reset(){this._Verbose("Reset()"),this._CleanTimer(),this._lastActiveTime=0,this._rescheduleFactor=1,this._sendingEvents=[],this._eventsCache=new b(this._config.log,this._config.eventsLimitInMem),this._ecsClient&&(this._ecsClient.RemoveListener(this._ecsCallback),this._ecsCallback=null)}_CreateEcsCallback(){return e=>{e==r.CONFIG_UPDATED&&(this._etag=this._ecsClient.GetETag())}}__AddTestHookListener(e){if(this._status<h.Initialized)throw new S(p.DATARV_ERROR_INVALID_STATUS);for(var t=0;t<this._testHookListeners.length;++t)if(this._testHookListeners[t]==e)return;this._testHookListeners.push(e)}__ClearTestHookListener(){this._testHookListeners=[]}__GetListenerArray(){return this._listeners}__GetTotalEventsCount(){return this._eventsCache.GetTotalEventsCount()}__IsScheduled(){return null!=this._timer}__ChageMaxPackageSizeInKB(e){this._MaxPackageSizeInBytes=1024*e}__SetTestServerResponseHook(e){this._testServerResponseHook=e}}C._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,C._tag=0;class b{constructor(e,t){this._logger=e,this._eventsLimitInMem=t,this._events={},this._tokens=[]}AddEvents(e,t){t.length&&(t.length>this._eventsLimitInMem?this._logDroppedEvents(e,t.length):(this._events[e]||(this._events[e]=[],this._tokens.push(e)),this._events[e].push.apply(this._events[e],t)))}IsEmpty(){return 0==this._tokens.length}DequeuEvents(){if(0==this._tokens.length)return null;var e=this._tokens.shift(),t=this._events[e];return delete this._events[e],{tenantToken:e,events:t}}GetTotalEventsCount(){var e=0;for(var t in this._events)e+=this._events[t].length;return e}setEventsLimitInMem(e){this._eventsLimitInMem=e}_logDroppedEvents(e,t){if(!this._logger)return;let n=0;this._events[e]&&(n=this._events[e].length),this._logger.Verbose(`[TelemetryEventCache]: Size of dropped events: ${t},\n      events size currently in queue for tenant ${e}: ${n}`)}}},85259:(e,t,n)=>{"use strict";n.d(t,{w:()=>i});class i{static get version(){return"2.5.0"}}},7254:(e,t,n)=>{"use strict";n.d(t,{w:()=>A});var i,a=n(13637),o=n(31821),r=n(82250),s=n(20448),l=n(55997),d=n(24211),c=n(51581);function u(e){const{clientId:t}=e.get(o.J.Brb);return t}function m(e){const{licenseType:t}=e.get(o.J.UserResources);return t}function g(e,t,n,a){const{adoTagsForAllItems:r,categories:s}=e.get(o.J.Brb),l=null==s?void 0:s.find((e=>(null==e?void 0:e.id)===t));return[r,(null==l?void 0:l.additionalAdoTags)||"",n.get(i.Ring)||"unknownRing",function(e,t){const{platformAdoTagPrefix:n,platformAdoTagSuffix:i}=e.get(o.J.Brb);return`${n||"teams"}_${i||t.config.browser}`}(e,a),n.get(i.MTMA)?"MTMA":""].filter((e=>e)).join(";")}function p(e,t,n){const a=`${function(e){const t=e.get(i.Build)||"";return t.startsWith("local")?"[LOCAL] ":t.indexOf("oncdn")>=0?"[CONTAINER] ":""}(n)||""}${e||""}`,{brbItemTitleMaxLength:r}=t.get(o.J.Brb);return v(a,r||1500)}function h(e,t){const{brbItemDescriptionMaxLength:n}=t.get(o.J.Brb);return v(e||"",n||5e3)}function v(e,t){return(e=e||"No text provided").length>t?`${e.substring(0,t-3)}...`:e}function S(e){let t="";const n=e.get(i.MTMA);n&&"MTMA"===n&&(t="<h3>(This is MTMA scenario, please check logs from user's other accounts under Links tab)</h3><br>");let a="";return null==e||e.forEach(((e,t)=>{a=`${a}<b>${t}:</b> ${e}<br>`})),`<h3><strong>All the logs & screenshots (if attached) are available in the devlogs link which is present in the Links tab.</strong></h3><br>${t}${a}`.trim()}function f(e){return e.get(i.WebClientBuild)||"1.1.11.1111_11/1.1.1.1111111111"}!function(e){e.UserEmail="UserEmail",e.TenantID="TenantID",e.Ring="Ring",e.UserID="UserID",e.WebClientBuild="WebClient build",e.Build="Build",e.MTMA="MTMA",e.MSAlias="MSAlias",e.DeviceID="Device ID",e.Language="Language",e.SystemManufacturer="System Manufacturer",e.DeviceModel="Device Model",e.DesktopVersion="Desktop Version",e.slimcoreVersion="Slimcore Version"}(i||(i={}));const y=e=>{const t=e.loggerFactory.newLogger("BrbServiceEndpointsManager");return{baseUrl:"https://brbv2",serviceName:s.EJ.BRB,models:{createBrbItem:C(e,t),uploadLogsFile:b(t),releaseBrbItem:T(e,t),extendBrbReports:k(e,t)}}},k=(e,t)=>(0,a.mG)(void 0,void 0,void 0,(function*(){return{allowedResponses:[l.qb.OK],constructRequest:(n,a,r,s)=>{if(!a){const e=`Skype token is not present: ${a}`;throw t.error(e),new Error(e)}const{extendBrbReportsUrl:l}=e.coreSettings.get(o.J.Brb);if(!l){const e=`Failed to retrieve extend BRB report url from core settings: ${l}`;throw t.error(e),new Error(e)}let m;try{m=function(e,t,n,a,o){return(0,c.u4)({ReportTitle:p(e.text,a,o),ReportDescription:h(e.text,a),CategoryName:e.categoryId,SkypeAuthToken:t,UploadID:(0,d.v4)(),InitiatorIDs:[n],ClientID:u(a),ClientVersion:f(o),Email:o.get(i.UserEmail),TenantID:o.get(i.TenantID),UserID:o.get(i.UserID),Ring:o.get(i.Ring)})}(n,a,r,e.coreSettings,s)}catch(e){throw t.error("Failed to get extend BRB report request body:",e),e}const g=new URL(l);return{method:"POST",url:g.href,headers:{Host:g.hostname,"Content-Type":"application/json","Content-Length":`${m.length}`},body:m}}}})),C=(e,t)=>(0,a.mG)(void 0,void 0,void 0,(function*(){return{allowedResponses:[l.qb.OK],constructRequest:(n,a,r)=>{if(!n){const e=`Skype token is not present: ${n}`;throw t.error(e),new Error(e)}const{createBrbRequestUrl:s}=e.coreSettings.get(o.J.Brb);if(!s){const e=`Failed to retrieve create BRB request url from core settings: ${s}`;throw t.error(e),new Error(e)}let l;try{l=function(e,t,n,a,o){return(0,c.u4)({ReportTitle:p(e.text,t,a),ReportDescription:h(e.text,t),CategoryName:e.categoryId,UploadID:(0,d.v4)(),InitiatorIDs:[],ClientID:u(t),ClientVersion:f(a),CorelibVersion:"",Ring:a.get(i.Ring),SkypeAuthToken:n,TenantName:"",TenantID:a.get(i.TenantID),UserID:a.get(i.UserID),Email:a.get(i.UserEmail),MSAlias:a.get(i.MSAlias)||"",SkipEmailNotification:!1,SkipVsoTicketCreation:!1,SystemInfo:S(a),VsoTags:g(t,e.categoryId,a,o),LicenseType:m(t)})}(a,e.coreSettings,n,r,e.platformService)}catch(e){throw t.error("Failed to get create BRB item request body:",e),e}const v=new URL(s);return{method:"POST",url:v.href,headers:{Host:v.hostname,"Content-Type":"application/json","Content-Length":`${l.length}`},body:l}}}})),b=e=>Promise.resolve({allowedResponses:[l.qb.CREATED],constructRequest:(t,n)=>{if(!t){const n=`Create BRB item response body is not present: ${t}`;throw e.error(n),new Error(n)}if(!n){const t=`Logs file is not present: ${n}`;throw e.error(t),new Error(t)}const i=new URL(t.ContainerUrl);return{method:"PUT",url:`${i.href}/${n.fileName}?${t.SASToken}`,headers:{Host:i.hostname,"Content-Type":"text/plain","Content-Length":`${"string"==typeof n.content?n.content.length:"unknown"}`,"x-ms-blob-type":"BlockBlob"},body:n.content}},transformResponse:()=>Promise.resolve(!0)}),T=(e,t)=>Promise.resolve({allowedResponses:[l.qb.OK],constructRequest:n=>{if(!n){const e=`Container ID is not present: ${n}`;throw t.error(e),new Error(e)}const{releaseBrbRequestUrlPrefix:i}=e.coreSettings.get(o.J.Brb);if(!i){const e=`Failed to retrieve release BRB request url prefix from core settings: ${i}`;throw t.error(e),new Error(e)}const a=new URL(`${i}${n}`);return{method:"POST",url:a.href,headers:{Host:a.hostname,"Content-Length":"0"}}},transformResponse:()=>Promise.resolve(!0)});var w=n(25118),_=n(91477);class I{constructor(e,t,n,i,a,o,r,s,l,d,c){this.coreSettings=t,this.logsCollectorService=n,this.authenticationService=i,this.platformService=a,this.discover=o,this.hostCommunicationService=r,this.brbServiceApi=s,this.i18n=l,this.authenticationUser=d,this.apolloClient=c,this.defaultUploadDesktopLogsTimeoutMs=2e4,this.logger=e.newLogger("BrbServiceTasks")}getSystemInfo(){var e,t,n,s,l,c,u,m,g;return(0,a.mG)(this,void 0,void 0,(function*(){const p=new Map;let h;p.set("TimeStamp",(new Date).toISOString()),this.logger.debug("... starting getSystemInfo() brb");try{h=yield this.authenticationService.getUser()}catch(e){this.logger.error("Failed to fetch user:",e)}!function(e,t,n){var a,r,s,l,d,c,u,m,g,p,h,v;e.set(i.UserEmail,(null===(a=null==t?void 0:t.profile)||void 0===a?void 0:a.email)||(null===(r=null==t?void 0:t.profile)||void 0===r?void 0:r.upn)||(null===(s=null==t?void 0:t.profile)||void 0===s?void 0:s.preferred_username)||""),e.set("UserType",(null===(l=null==t?void 0:t.type)||void 0===l?void 0:l.toString())||""),e.set(i.TenantID,(null===(d=null==t?void 0:t.profile)||void 0===d?void 0:d.tid)||""),e.set(i.Ring,(null===(u=null===(c=n.get(o.J.Metadata))||void 0===c?void 0:c.ring)||void 0===u?void 0:u.id)||""),e.set(i.UserID,(null===(g=null===(m=null==t?void 0:t.profile)||void 0===m?void 0:m.oid)||void 0===g?void 0:g.toString())||"");const S=(null===(p=n.get(o.J.Brb))||void 0===p?void 0:p.sendBrbMSAlias)?(null===(h=null==t?void 0:t.profile)||void 0===h?void 0:h.upn)||(null===(v=null==t?void 0:t.profile)||void 0===v?void 0:v.email):"";e.set(i.MSAlias,S||"")}(p,h,this.coreSettings),function(e,t){var n,i,a,o,r,s,l,d;e.set("Platform",(null===(i=null===(n=null==t?void 0:t.config)||void 0===n?void 0:n.platformId)||void 0===i?void 0:i.toString())||""),e.set("OS",(null===(a=null==t?void 0:t.config)||void 0===a?void 0:a.osPlatform)||""),e.set("OS Version",(null===(r=null===(o=null==t?void 0:t.config)||void 0===o?void 0:o.osVersion)||void 0===r?void 0:r.toString())||""),e.set("Browser",(null===(s=null==t?void 0:t.config)||void 0===s?void 0:s.browser)||""),e.set("Browser Version",(null===(d=null===(l=null==t?void 0:t.config)||void 0===l?void 0:l.browserVersion)||void 0===d?void 0:d.toString())||"")}(p,this.platformService);const{enableMTMA:v}=this.coreSettings.get(o.J.Core);v&&(yield function(e,t){var n;return(0,a.mG)(this,void 0,void 0,(function*(){const a=yield null===(n=null==t?void 0:t.getCachedUsers)||void 0===n?void 0:n.call(t,{id:(0,d.v4)(),scenarioName:r.RG.AuthWebCachedUser,source:"brb-utils::addMTMAInfo"}),o=(null==a?void 0:a.length)&&a.length>1;e.set(i.MTMA,o?"MTMA":"")}))}(p,this.authenticationService)),p.set("Client",(null===(e=this.coreSettings.get(o.J.Brb))||void 0===e?void 0:e.systemInfoClient)||""),p.set(i.WebClientBuild,(null===(n=null===(t=this.platformService)||void 0===t?void 0:t.config)||void 0===n?void 0:n.clientVersion)||""),p.set(i.Build,(null===(l=null===(s=this.platformService)||void 0===s?void 0:s.config)||void 0===l?void 0:l.buildVersion)||"");const{sessionId:S}=this.coreSettings.get(o.J.Platform);p.set("SessionID",S||""),p.set(i.Language,(null===(c=this.i18n)||void 0===c?void 0:c.locale)||"");const f=yield this.hostCommunicationService.loadModule("osutils"),y=yield null===(u=null==f?void 0:f.getDeviceInfo)||void 0===u?void 0:u.call(f);p.set(i.DeviceID,(null==y?void 0:y.deviceId)||"unkown deviceID"),p.set(i.SystemManufacturer,(null==y?void 0:y.make)||(null===(m=this.hostSettings)||void 0===m?void 0:m.systemManufacturer)||""),p.set(i.DeviceModel,(null==y?void 0:y.model)||(null===(g=this.hostSettings)||void 0===g?void 0:g.systemProductName)||"");let k=new Map;try{k=(yield this.logsCollectorService.getSystemInfo())||new Map}catch(e){this.logger.error("Failed to fetch system info from logs collector service:",e)}return new Map([...Array.from(p.entries()),...Array.from(k.entries())])}))}createBrbItem(e,t){return(0,a.mG)(this,void 0,void 0,(function*(){let n;try{const i=yield this.discover.validateSkypeToken();n=yield this.brbServiceApi.createBrbItem(i,e,t)}catch(e){return this.logger.error("Failed creating BRB item:",e),null}return n}))}extendBrbReports(e,t,n){return(0,a.mG)(this,void 0,void 0,(function*(){let i;try{const a=yield this.discover.validateSkypeToken();i=yield this.brbServiceApi.extendBrbReports(e,a,t,n)}catch(e){return this.logger.error("Failed extending BRB report"),null}return i}))}uploadWebLogsFiles(e){var t;return(0,a.mG)(this,void 0,void 0,(function*(){let n=!1;const{enableMTMA:i}=this.coreSettings.get(o.J.Core),r=t=>(0,a.mG)(this,void 0,void 0,(function*(){try{return yield this.brbServiceApi.uploadLogsFile(e,t)}catch(e){return this.logger.error(`Failed to upload logs file - ${t.fileName} - error:`,e),!1}}));try{n=i&&(null===(t=this.authenticationUser)||void 0===t?void 0:t.id)?yield this.logsCollectorService.callOnUserLogsFiles([this.authenticationUser.id],r):yield this.logsCollectorService.callOnLogsFiles(r)}catch(e){this.logger.error("Failed when calling upload on all logs files:",e)}return n}))}uploadDesktopLogsFiles(e,t){var n;return(0,a.mG)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("brb");if(!i)return this.logger.log("uploadDesktopLogsFiles(): HostComms is unable to load brb module. We are running on Web or Teams 1.0. Bailing out."),!0;let a;const{enableMTMA:r}=this.coreSettings.get(o.J.Core);if(r&&this.apolloClient){const e=null===(n=this.authenticationUser)||void 0===n?void 0:n.id,i=yield(0,_.XD)(this.apolloClient),o=[];i.forEach((t=>{t.userContextId===e&&o.push(t.id)})),a=null==t?void 0:t.filter((e=>o.includes(e)))}else a=t;if(!i.uploadDesktopLogs)return this.logger.error("uploadDesktopLogs not available on brb module."),!1;const s={azureBlobStorageInfo:{sharedAccessSignature:e.SharedAccessSignature},screenshotIds:a},{uploadDesktopLogsTimeoutMs:l}=this.coreSettings.get(o.J.Brb),d=null!=l?l:this.defaultUploadDesktopLogsTimeoutMs;try{const e=yield(0,w.E)(i.uploadDesktopLogs(s),d,`uploadDesktopLogs timed out. Ran for ${d} ms.`);return!!(null==e?void 0:e.status)}catch(e){return this.logger.error("Failed to upload desktop logs files. Error:",e),!1}}))}uploadHeapSnapshotFiles(e){var t,n;return(0,a.mG)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("brb");if(!i)return this.logger.log("uploadHeapSnapshotFiles(): HostComms is unable to load brb module. We are running on Web or Teams 1.0. Bailing out."),!0;if(!i.uploadHeapSnapshot)return this.logger.error("uploadHeapSnapshot not available on brb module."),!1;const a={azureBlobStorageInfo:{sharedAccessSignature:e.SharedAccessSignature}};try{const e=yield i.uploadHeapSnapshot(a);return!!(null==e?void 0:e.status)}catch(e){return this.logger.error("Failed to upload heapsnapshot files. Error:",e),null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,"Failed to upload heap snapshot file","brb"),!1}}))}uploadMemoryTracingFile(e){var t,n;return(0,a.mG)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("brb");if(!i)return this.logger.log("uploadMemoryTracingFile(): HostComms is unable to load brb module. We are running on Web or Teams 1.0. Bailing out."),!0;if(!i.uploadMemoryTracing)return this.logger.error("uploadMemoryTracing not available on brb module."),!1;const a={azureBlobStorageInfo:{sharedAccessSignature:e.SharedAccessSignature}};try{const e=yield i.uploadMemoryTracing(a);return!!(null==e?void 0:e.status)}catch(e){return this.logger.error("Failed to upload memory tracing file. Error:",e),null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,"Failed to upload memory tracing file","brb"),!1}}))}releaseBrbItem(e){return(0,a.mG)(this,void 0,void 0,(function*(){let t;try{t=yield this.brbServiceApi.releaseBrbItem(e)}catch(e){return this.logger.error("Failed to release the BRB item - error:",e),!1}return t}))}}class A{constructor(e,t,n,i,a,o,r,s,l,d,c,u){this.coreSettings=t,this.hostCommunicationService=r,this.scenarioFactory=l,this.defaultDisclaimer='NOTE: Data sent in feedback submissions will be "Support Data" under your agreement for Microsoft 365, including any information that would otherwise be considered "Customer Data" or "Personal Data". Please do not submit feedback that may include data you do not wish to provide to Microsoft as "Support Data".',this.logger=e.newLogger("BrbService");const m=s.createApi(y);this.brbServiceTasks=new I(e,t,n,i,a,o,r,m,d,c,u)}getBrbFormData(){return(0,a.mG)(this,void 0,void 0,(function*(){const{categories:e,disclaimer:t}=this.coreSettings.get(o.J.Brb),n=[];return null==e||e.forEach((e=>{e&&n.push({id:e.id,name:e.name})})),{disclaimer:t||this.defaultDisclaimer,categories:n}}))}getBrbScreenshots(e){var t;return(0,a.mG)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("brb");if(!n)return void this.logger.log("getBrbScreenshots(): HostComms is unable to load brb module. We are running on Web or Teams 1.0. Bailing out.");const i=yield null===(t=n.getScreenshotThumbnails)||void 0===t?void 0:t.call(n,{width:e.width,height:e.height||void 0});return null==i?void 0:i.screenshots}))}createBrbItem(e){return(0,a.mG)(this,void 0,void 0,(function*(){const{enableBrb:t}=this.coreSettings.get(o.J.Brb);if(!t)return void this.logger.log(`Create BRB item not enabled - setting: ${t}`);const n=this.scenarioFactory.newScenario(r.RG.BrbCreateItem,{timeoutMs:36e5});n.mark(r.ck.BrbSubmitted);const i=yield this.processCreateBrbRequest(e);if("error"!==i.kind)return n.stop(),i.response.ContainerID;n.fail({reason:i.reason})}))}extendBrbReports(e,t){return(0,a.mG)(this,void 0,void 0,(function*(){const{isInternalRingAccount:n}=this.coreSettings.get(o.J.Core),i=this.scenarioFactory.newScenario(r.RG.BrbExtendReports);if(!n){const e="Current account is not internal ring account";return this.logger.error(e),i.cancel({reason:e}),!1}const a=yield this.processExtendBrbReportsRequest(e,t);return a?i.stop():i.fail(),a}))}processExtendBrbReportsRequest(e,t){return(0,a.mG)(this,void 0,void 0,(function*(){let n=new Map;try{n=yield this.brbServiceTasks.getSystemInfo()}catch(e){this.logger.error("Failed to fetch system info")}let i=null;try{i=yield this.brbServiceTasks.extendBrbReports(e,t,n)}catch(e){return this.logger.error("Failed to Extend BRB Reports"),!1}if(!i)return this.logger.error(`Request to Extend BRB Reports failed to receive response body: ${i}`),!1;let a=!1;try{a=yield this.uploadFilesToBrbItem(i,e.includeHeapSnapshot,e.screenshotIds?[...e.screenshotIds]:void 0),a||this.logger.error(`Failed to upload all logs files to first party container: ${t}`)}catch(e){this.logger.error(`Error when uploading all logs files to first party container: ${t}`)}return!0}))}processCreateBrbRequest(e){var t,n;return(0,a.mG)(this,void 0,void 0,(function*(){let i=new Map;try{i=yield this.brbServiceTasks.getSystemInfo()}catch(e){this.logger.error("Failed to fetch system info:",e)}let a=null;try{a=yield this.brbServiceTasks.createBrbItem(e,i)}catch(e){return this.logger.error("Failed to create BRB item:",e),{kind:"error",reason:"Failed to create BRB item"}}if(!a)return this.logger.error(`Request to create BRB item failed to receive response body: ${a}`),{kind:"error",reason:"Request to create BRB item failed to receive response body"};let o=!1;try{o=yield this.uploadFilesToBrbItem(a,e.includeHeapSnapshot,e.screenshotIds?[...e.screenshotIds]:void 0)}catch(e){this.logger.error("Failed to upload all logs files:",e)}o||null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,"Failed to upload all logs files - attempting to complete BRB item","brb");let r=!1;try{r=yield this.brbServiceTasks.releaseBrbItem(a.ContainerID)}catch(e){return this.logger.error("Failed to release BRB item:",e),{kind:"error",reason:"Failed to release BRB item"}}if(!r){const e="Failed to release the BRB item";return this.logger.error(e),{kind:"error",reason:e}}return{kind:"response",response:a}}))}uploadFilesToBrbItem(e,t=!1,n){return(0,a.mG)(this,void 0,void 0,(function*(){const i=[];let a=!0;t&&(a=yield this.brbServiceTasks.uploadHeapSnapshotFiles(e),i.push(this.brbServiceTasks.uploadMemoryTracingFile(e))),i.push(this.brbServiceTasks.uploadWebLogsFiles(e)),i.push(this.brbServiceTasks.uploadDesktopLogsFiles(e,n));return(yield Promise.all(i)).every((e=>e))&&a}))}}},62231:(e,t,n)=>{"use strict";n.d(t,{V:()=>i,N:()=>a});const i="broadcast-updated-event",a={streamUpdateHubEvent:"streamUpdate",captionsUpdate:"captionsUpdate",subscribeToStreamUpdatesHubEvent:"subscribeToStreamUpdates",notifyStreamSwitch:"notifyStreamSwitch",transcriptionStateUpdate:"transcriptionStateUpdate"}},2308:(e,t,n)=>{"use strict";var i,a;n.d(t,{mN:()=>i,GB:()=>a,yR:()=>o,oo:()=>r,Q0:()=>s,ex:()=>l,PR:()=>d,gh:()=>c,LC:()=>u,Ky:()=>m,ji:()=>g}),function(e){e.InProgress="InProgress",e.Success="Success",e.Error="Error",e.PartialSuccess="PartialSuccess"}(i||(i={})),function(e){e.StatusEntity="Microsoft.SkypeSpaces.MiddleTier.Models.StatusEntity"}(a||(a={}));const o="x-serverrequestid",r="call_blocking_list_refreshed",s=36e5,l="https://teams.microsoft.com/";var d;!function(e){e.getBlockedContacts="getBlockedContacts",e.postBlockedContacts="postBlockedContacts"}(d||(d={}));const c="api/",u=[{id:d.getBlockedContacts,path:"mt/part/msft/beta/userSettings/blocklist"},{id:d.postBlockedContacts,path:"mt/part/msft/beta/userSettings/blocklist/manage"}],m="https://teams.live.com/";var g;!function(e){e.Add="Add",e.Remove="Remove"}(g||(g={}))},57775:(e,t,n)=>{"use strict";n.d(t,{Y:()=>l});var i=n(13637),a=n(24211),o=n(89925),r=n(87442),s=n(94415);class l{constructor(e,t,n){this.logger=e.newLogger("CallingBannerServiceAdapter"),this.callingAppEventsService=t,this.bannerCallbacks=new Map,this.i18n=n}showBanner(e,t,n,l={}){var d;return(0,i.mG)(this,void 0,void 0,(function*(){const i=(0,a.v4)(),c=t.replace(/(<([^>]+)>)/gi,""),u=(e=>{const t=[];return e.primaryActionCallback&&t.push({name:s.w.PrimaryAction,action:e.primaryActionCallback}),e.dismissActionCallback&&t.push({name:s.w.DismissAction,action:e.dismissActionCallback}),t})(l);this.bannerCallbacks.set(i,u);const m={visibility:r.cP.Show},g={source:{name:"ShowBannerNotification",description:e}},p={event:{typeName:"calling-content-event",content:{contentType:"banner",id:i,text:c,intentLevel:o.BannerNotificationIntentLevel.Live,dismissable:!1,duration:0,bannerScenario:r.XD.EndpointTransfer,source:r.Dy.BannerNotification,dismissOnAction:!0,joinButtonText:this.i18n.stringTranslate("calling","calling_join"),bannerActions:u.map((e=>e.name))},action:m},context:g};try{yield this.callingAppEventsService.trigger(p,n),this.logger.log(`[show] Successfully triggered banner event [bannerId: ${i}]`)}catch(e){return this.logger.error(`[show] Showing banner error [bannerId: ${i}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`),Promise.reject(null)}const h=(null===(d=u.find((e=>e.name===s.w.DismissAction)))||void 0===d?void 0:d.action)||(()=>{});return Promise.resolve({id:i,dismiss:h,dismissPromise:Promise.resolve({id:"",value:""})})}))}executeBannerAction(e,t){var n;this.logger.log(`Attempting to execute ${t.toString()} action for banner ${e}`);const i=null===(n=this.bannerActions(e).find((e=>e.name===t)))||void 0===n?void 0:n.action;if(!i)throw new Error(`Action ${t.toString()} not found for banner ${e}`);i()}bannerActions(e){this.logger.log(`Getting actions for banner ${e}`);return this.bannerCallbacks.get(e)||[]}}},94415:(e,t,n)=>{"use strict";var i;n.d(t,{w:()=>i}),function(e){e.PrimaryAction="PrimaryAction",e.DismissAction="DismissAction"}(i||(i={}))},56696:(e,t,n)=>{"use strict";n.d(t,{w:()=>i});class i extends Error{constructor(e,t,n){super(t),this._code=e,this.message=t,this._subCode=n}get code(){return this._code}get subCode(){return this._subCode}}},90660:(e,t,n)=>{"use strict";n.d(t,{n:()=>l});var i=n(13637),a=n(24211),o=n(85369),r=n(56696),s=n(82250);class l{constructor(e,t,n,i){this.host=i,this.logger=e.newLogger("CallingAppEventsService"),this.asObservable=t.createObservable(),this.deferredEventsResolution=new Map,this.scenarioFactory=n}trigger(e,t){return(0,i.mG)(this,void 0,void 0,(function*(){const{externalId:n,timeStamp:i,source:l}=e.context,d=Object.assign(e,{id:`calling-app-event-${(0,a.v4)()}`});this.logger.log(`[trigger] Calling app event received [id=${d.id}, externalId=${n}, timeStamp=${i}, source=${l}]`);const c=this.scenarioFactory.newScenario(s.RG.CallingAppEventTriggerInitiated,{clientId:d.id});if(c.appendEventData({dataSource:e.context.source.name,correlationId:n}),!t)return this.logger.log(`[trigger] Timeout not provided. Resolving promise immediately [id=${d.id}, externalId=${n}, timeStamp=${i}, source=${l}, timeout=${t}]`),void this.asObservable.trigger(void 0,void 0,d);const u=(0,o.P)();let m;this.deferredEventsResolution.set(d.id,u);const g=new Promise(((e,a)=>{m=this.host.setTimeout((()=>{const e=`[trigger] Timeout waiting for event resolution signal [id=${d.id}, externalId=${n}, timeStamp=${i}, source.name=${l.name}, source.description=${l.description}]`;this.logger.error(e);const t=new r.w("event-resolution-timeout",e);c.fail({errorCode:t.code,message:t.message}),a(t)}),t)})),p=Promise.race([u.promise,g]);this.asObservable.trigger(void 0,void 0,d);try{yield p}finally{void 0!==m&&this.host.clearTimeout(m),this.deferredEventsResolution.delete(d.id)}}))}resolve(e){return(0,i.mG)(this,void 0,void 0,(function*(){const{eventId:t,resolution:n}=e;this.logger.log(`[resolve] Received event resolution [eventId=${t}, resolutionType=${n.resolutionType}]`);const i=this.scenarioFactory.findScenarioByNameAndId(s.RG.CallingAppEventTriggerInitiated,t)||this.scenarioFactory.newScenario(s.RG.CallingAppEventResolveInitiated,{clientId:t}),a=this.deferredEventsResolution.get(t);if(!a){const e=`[resolve] No deferred resolution found for event [eventId=${t}, resolutionType=${n.resolutionType}]`;this.logger.error(e);const a=new r.w("event-to-resolve-not-found",e);throw i.fail({errorCode:a.code,message:a.message}),a}if("success"===n.resolutionType)return this.logger.log(`[resolve] Resolving succesful event [eventId=${t}]`),a.resolve(),void i.stop();if("error"===n.resolutionType){const{name:e,message:o}=n,s=`[resolve] Resolving event error from external resolution [eventId=${t}, resolution.name=${e}, resolution.message=${o}]`;this.logger.error(s);const l=new r.w("external-resolution-error",s,e);return a.reject(l),void i.fail({errorCode:l.code,message:l.message})}const o=`[resolve] Invalid resolution type received. No changes on deferred promise for event [eventId=${t}]`;this.logger.error(o);const l=new r.w("invalid-resolution-type",o);throw i.fail({errorCode:l.code,message:l.message}),l}))}subscribe(e,t){const n=this.asObservable.subscribe(((t,n)=>(0,i.mG)(this,void 0,void 0,(function*(){if(n){const t=n.id;this.logger.log(`Resolver received app event [eventId=${t}]`);try{e(n)}catch(e){this.logger.error(`[callingAppEventResolver] handling app event error. [errorName=${e.name}, errorMessage=${e.message}]`);const n={eventId:t,resolution:{resolutionType:"error",name:e.name,message:e.message},context:{source:{name:"calling-app-event-resolver-error",description:`[callingAppEventResolver] Error processing event in resolvers [eventId=${t} error.errorCode=${e.name}, error.message=${e.message}]`}}};try{yield this.resolve(n)}catch(e){this.logger.error(`[callingAppEventResolver] error resolution failed in resolvers [eventId=${t}, errorCode[${e.name}], errorMessage[${e.message}]`)}}}else this.logger.error("[subscribe] Received invalid args.")}))));t&&this.handleOnResolverSubscriptionCancellation(t);return this.trigger({event:{typeName:"calling-setup-event",result:{resultType:"calling-setup-success"}},context:{source:{name:"CallingAppEventsService.subscribe",description:"subscribe"}}}),n}unsubscribe(e){this.logger.log(`[unsubscribe] calling app events subscription closed. [subscriptionId=${e}]`),this.asObservable.unsubscribe(e)}handleOnResolverSubscriptionCancellation(e){const t=e=>{let t=this.scenarioFactory.findScenario(e);return t||(t=this.scenarioFactory.newScenario(e)),t};e.subscribe({next:e=>{this.logger.log(`[callingAppEventResolver] cancellation listener next. [reason=${e}]`),t(s.RG.CallingAppEventsSubscriptionCancellationListener).appendEventData({reason:e||"cancellation-listener-reason-undefined"})},complete:()=>{this.logger.log("[callingAppEventResolver] cancellation listener complete."),t(s.RG.CallingAppEventsSubscriptionCancellationListener).mark("cancellation-listener-complete",{reason:"cancellation-listener-complete"})},error:e=>{this.logger.log(`[callingAppEventResolver] cancellation listener found an error. [errorName=${e.name}, errorMessage=${e.message}]`),t(s.RG.CallingAppEventsSubscriptionCancellationListener).fail({errorCode:e.name,message:e.message,reason:"cancellation-listener-error"})}}),t(s.RG.CallingAppEventsSubscribe).mark("cancellation-listener-subscribed")}}},87442:(e,t,n)=>{"use strict";var i,a,o,r,s,l,d,c,u;n.d(t,{cP:()=>i,cA:()=>a,lC:()=>o,JL:()=>r,XD:()=>s,Dy:()=>d,WB:()=>c,k$:()=>u}),function(e){e[e.Show=0]="Show",e[e.Hide=1]="Hide"}(i||(i={})),function(e){e[e.Calling=0]="Calling",e[e.RigelGallery=1]="RigelGallery",e[e.RigelContent=2]="RigelContent",e[e.RigelGalleryAndContent=3]="RigelGalleryAndContent"}(a||(a={})),function(e){e.MultiWindow="MultiWindow",e.SingleWindow="SingleWindow"}(o||(o={})),function(e){e[e.Chat=0]="Chat"}(r||(r={})),function(e){e.EndpointTransfer="EndpointTransfer"}(s||(s={})),function(e){e.MostSevere="MostSevere",e.Live="Live",e.Severe="Severe",e.Positive="Positive",e.Neutral="Neutral"}(l||(l={})),function(e){e.BannerNotification="BannerNotification"}(d||(d={})),function(e){e.Alert="Alert",e.CallingConfirm="CallingConfirm",e.CallingUnparkCall="CallingUnparkCall",e.Confirm="ConfirmDialog",e.OptionsSettings="optionsSettingsDialog",e.PrejoinOverlay="PrejoinOverlay",e.UserMedia="GetUserMediaDialog"}(c||(c={})),function(e){e.OneToOne="OneToOne",e.GroupCall="GroupCall",e.Meeting="Meeting",e.Chat="Chat",e.Reply="Reply",e.ReplyToReply="ReplyToReply",e.Like="Like",e.Mention="Mention",e.Download="Download",e.AppUpdated="AppUpdated",e.NeedMoreDiskSpace="NeedMoreDiskSpace",e.TeamMembershipChange="TeamMembershipChange",e.Follow="Follow",e.OneToOnePstn="OneToOnePstn",e.Thirdparty="Thirdparty",e.MessageSendFailed="MessageSendFailed",e.CallTransferFailed="CallTransferFailed",e.ShareFromChat="ShareFromChat",e.Inferred="Inferred",e.Trending="Trending",e.MeetingWentLive="MeetingWentLive",e.PresenceStatus="PresenceStatus",e.Reaction="Reaction",e.Priority="Priority",e.TeamsTasks="TeamsTasks",e.Dlp="Dlp",e.TeamsEngagementActivity="TeamsEngagementActivity",e.MsGraph="MsGraph",e.StaffHub="StaffHub",e.CallAnsweredElsewhere="CallAnsweredElsewhere",e.CallSafeTransferRingback="CallSafeTransferRingback",e.SkypeConsumerCall="SkypeConsumerCall",e.SpamCall="SpamCall",e.Default="Default"}(u||(u={}))},3157:(e,t,n)=>{"use strict";n.d(t,{L:()=>c});var i=n(13637),a=n(31821),o=n(24211),r=n(87442);function s(e){switch(e){case 1:return r.k$.OneToOne;case 2:return r.k$.GroupCall;case 3:return r.k$.Meeting;case 4:return r.k$.Chat;case 5:return r.k$.Reply;case 6:return r.k$.ReplyToReply;case 7:return r.k$.Like;case 8:return r.k$.Mention;case 9:return r.k$.Download;case 10:return r.k$.AppUpdated;case 11:return r.k$.NeedMoreDiskSpace;case 12:return r.k$.TeamMembershipChange;case 13:return r.k$.Follow;case 14:return r.k$.OneToOnePstn;case 15:return r.k$.Thirdparty;case 16:return r.k$.MessageSendFailed;case 19:return r.k$.CallTransferFailed;case 20:return r.k$.ShareFromChat;case 21:return r.k$.Inferred;case 26:return r.k$.Trending;case 27:return r.k$.MeetingWentLive;case 28:return r.k$.PresenceStatus;case 29:return r.k$.Reaction;case 30:return r.k$.Priority;case 34:return r.k$.TeamsTasks;case 35:return r.k$.Dlp;case 36:return r.k$.TeamsEngagementActivity;case 37:return r.k$.MsGraph;case 38:return r.k$.StaffHub;case 40:return r.k$.CallAnsweredElsewhere;case 41:return r.k$.CallSafeTransferRingback;case 42:return r.k$.SkypeConsumerCall;case 43:return r.k$.SpamCall;default:return r.k$.Default}}var l=n(38246),d=n(87078);class c{constructor(e,t,n){this.loggerFactory=e,this.coreSettings=t,this.callingAppEventsService=n,this.logger=this.loggerFactory.newLogger("CallingNotificationService"),this.logger.log("Instantiated CallingNotificationService"),this.notificationsMap=new Map,this.callToNotificationMap=new Map}createNotificationWithActions(e){var t,n;const{enableCallingNotifications:i,enableOutgoingVideo:l,enableIncomingCallCrossClientTelemetry:d}=this.coreSettings.get(a.J.Calling);if(!i)return this.logger.log(`[createNotificationWithActions] Feature flag enableCallingNotifications, current value: ${i}), is required for incoming call notifications is not enabled`),this.getNoopReturnValue();const c=(0,o.v4)(),u=Date.now(),m=[],g=[],p=e.sourceId||"sourceId";if(e.actions)for(const t of e.actions){const e=t.actionType;if(!e||"Unknown"===e)return this.logger.error(`[createNotificationWithActions] unknown action type for action ${t}`),this.getNoopReturnValue();l||"AcceptIncomingCallWithVideo"!==e?(m.push({actionType:e,id:c,label:t.label||"",icon:this.getNotificationIcon(t)}),g.push({action:t.action,actionType:e})):this.logger.log(`[createNotificationWithActions] Feature flag enableOutgoingVideo, current value: ${l}), is not enabled video button cannot be added`)}(null===(t=e.timeoutAction)||void 0===t?void 0:t.action)&&g.push({action:e.timeoutAction.action,actionType:"TimeOut"}),this.notificationsMap.set(c,g);const h={typeName:"calling-content-event",action:{visibility:r.cP.Show},content:{id:c,contentType:"notification",image:this.getDefaultImage(e.type),title:e.title,subtitle:e.subtitle||"",time:u,userid:e.callerMri||"",type:s(e.type),primaryAction:(null===(n=e.primaryAction)||void 0===n?void 0:n.actionType)||"AcceptIncomingCallWithAudio",actions:m,toastType:e.toastType}};e.headerData&&e.headerData.headerTitle&&e.headerData.headerMessage&&e.headerData.headerMri&&(h.content.header={defaultImageDataUrl:this.getDefaultImage(e.type),title:e.headerData.headerTitle,subtitle:e.headerData.headerMessage,mri:e.headerData.headerMri}),d&&(h.content.callId=null==e?void 0:e.callId,h.content.crossClientScenarioName=null==e?void 0:e.crossClientScenarioName);const v={event:h,context:{source:{name:"CreateNotificationWithActions",description:e.sourceId||"undefinedContextName"}}},S=h.content;return this.logger.log(`triggering callingAppEventsService id=${S.id}, type=${S.type}, sourceId=${e.sourceId}, callId=${e.callId}`),this.callingAppEventsService.trigger(v),this.callToNotificationMap.set(p,v),this.getNotificationWithActions(p)}executeCallingToastCallback(e,t){return(0,i.mG)(this,void 0,void 0,(function*(){if(!this.canTryGetEntriesForToastId(e,t))return Promise.resolve(!1);const n=this.tryGetEntriesForToastId(e);if(!n)return Promise.resolve(!1);const i=this.tryGetEntryForActionType(n,e,t);return i?this.tryExecuteCallback(i,e):Promise.resolve(!1)}))}canNotifyForActionNotification(){return this.logger.error("[canNotifyForActionNotification] NYI"),!0}getAppUserSettings(){this.logger.error("[getAppUserSettings] NYI");return{soundsSettings:{alertSound:"All"}}}getAriaShortcutLabel(){return this.logger.error("[getAriaShortcutLabel] NYI"),""}getCallGroupMembershipSettings(){return this.logger.error("[getCallGroupMembershipSettings] NYI"),Promise.resolve({callGroupMembershipDetails:[],callGroupNotificationOverride:"Ring"})}getPanelActionScenario(){return this.logger.error("[getPanelActionScenario] NYI"),l.Lc.closeActiveCallBanner}isSfCNotificationEnabledDesktop(){return this.logger.error("[isSfCNotificationEnabledDesktop] NYI"),!0}isSpamNotificationEnabledDesktop(){return this.logger.error("[isSpamNotificationEnabledDesktop] NYI"),!1}shouldMuteAudio(){return this.logger.error("[shouldMuteAudio] NYI"),!1}getDefaultImage(e){return e===d.qp.meetingWentLive?"data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTkyIDE5MiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjZWRlYmU5IiBkPSJNMCAwaDE5MnYxOTJIMHoiLz48cGF0aCBkPSJNNzguNTI4IDEwMC4xMWE1LjEzOSA1LjEzOSAwIDEgMCAwLTEwLjI3NyA1LjEzOSA1LjEzOSAwIDAgMCAwIDEwLjI3N3ptMjIuNjEyLTUuMTM5QTUuMTM5IDUuMTM5IDAgMCAxIDk2IDEwMC4xMWE1LjEzOSA1LjEzOSAwIDEgMSAwLTEwLjI3NyA1LjE0IDUuMTQgMCAwIDEgNS4xNCA1LjEzOHptMTIuMzMyIDUuMTM5YTUuMTM4IDUuMTM4IDAgMSAwIDAtMTAuMjc4IDUuMTM4IDUuMTM4IDAgMCAwIDAgMTAuMjc4em0tMjkuODA1IDExLjMwN2E1LjE0IDUuMTQgMCAxIDEtMTAuMjc4IDAgNS4xNCA1LjE0IDAgMCAxIDEwLjI3OCAwek05NiAxMTYuNTU2YTUuMTQgNS4xNCAwIDEgMCAuMDAxLTEwLjI3OUE1LjE0IDUuMTQgMCAwIDAgOTYgMTE2LjU1NnpNNTkgNzEuODQ3QzU5IDY0Ljc1NCA2NC43NTIgNTkgNzEuODQ3IDU5aDQ4LjMwNkMxMjcuMjUgNTkgMTMzIDY0Ljc1NCAxMzMgNzEuODQ3djQ4LjMwNmMwIDcuMDk1LTUuNzUgMTIuODQ3LTEyLjg0NyAxMi44NDdINzEuODQ3QzY0Ljc1MiAxMzMgNTkgMTI3LjI0OCA1OSAxMjAuMTUzVjcxLjg0N3ptMTIuODQ3LTcuNzA3YTcuNzA2IDcuNzA2IDAgMCAwLTcuNzA3IDcuNzA3djMuNTk2aDYzLjcydi0zLjU5NmE3LjcwNiA3LjcwNiAwIDAgMC03LjcwNy03LjcwN0g3MS44NDd6bS03LjcwNyA1Ni4wMTNjMCA0LjI2IDMuNDUgNy43MDcgNy43MDcgNy43MDdoNDguMzA2YTcuNzA0IDcuNzA0IDAgMCAwIDcuNzA3LTcuNzA3di0zOS41N0g2NC4xNHYzOS41N3oiIGZpbGw9IiM2MDVlNWMiLz48L3N2Zz4=":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAADsiSURBVHgB7d17bFz3deDxc+8MXyIl6mXRci1IFhW7yUayngtTsFMJsCy5QRA7COAFbGy8Gxc24C6QKCjcAE2Ljf8IvEWcAFsD9hZFk4W9u0bRSt2gtRWpkJpoSbcWRVly4zgOFQlyJNGWKVEkxdfM3L3nkkNTFMl53N+9cx/fD8DMiJIda0jOOb/zO7/zswRA5O06ejQ71tBQ19DU1CCFkZX6uUa77k7vN+1Mu/dgFW7Li9Wmzy3H2T7zn3ccWWNZslbKd7z4xBLntwXLvjT9a8d613tSyPfqw2hh4sMGp354LJMZGRsZGWsYG5s4tnt3TgBEmiUAasdxrI6ursYl9fVLC42ZtkyucJdY1nLHcj6vQbyKwB0Z7n/7edty3tLkISNOXyHvvJWvy16zR/N9miwc27x5wP27OgKgJkgAgIDp6r1h8eLbigHetp17Co58Mc7B3ZRikmBZ1qlCwXo/n7V/MzEh57SS0LVz54gACAwJAGDITYE+72yzJL+n4Fj3pT3I++FuP7zuJQdu9cDJW+9fHx+/RmIAmEECAFRqqmzfsqTpHgJ9+LRqILZ1wCrIz4oVg2NbtlwTABUhAQBK6OjsbJoZ7B2xHhNEjlYLHDtz2JK6Y9cGBy9SKQAWRgIAzOSu7nedOtXaaBV2O7Z8QQrOo6zs42m6UpAv/P2oZE/RdAjcjAQA6eYG/L3d3bdbWS3hFx5jdZ9sXpXAsV93cs5bh7Ztu0xCgDQjAUC6zFjhE/BRTAhGHfsofQRIGxIAJF5xD98uFL5GSR8LcSzrhwXb/vHQ9ZH36SFA0pEAIHlmrPLFcva7n7lfgIo5x8XO/Gg0Z/0t1QEkEQkAkkGD/smu9oa6hmdZ5cM0bSjM2PKyYzX8zciVK+cZdYwkIAFAfLlBf8+/nbpXS/uW43xDgJDoVoFt1f8FyQDijAQA8ULQR8SQDCCuSAAQfQR9xEQxGXjj858/yxFDRB0JACJrV0/P0kYr/4z7LvoMe/qIHdt+yhkr/OOh7dsvCRBBJACIFA36TQ3OvYXxwo8J+kiGqdMEVwZ+zBYBooQEALVHiR8pwRYBooQEADUzWeIv7HbE+QGrfaSJHiu0MvbzVAVQSyQACJfO3j95sl3q5FlW+8CMqsDGjb0ChIgEAOFwA//D7/V8gb19YD70CiBcJAAIVLGT3/1O+54AKI9tPzUwOPq/uI8AQSIBQCA08DdkCn9GmR+oHtsDCBIJAMyZ6ubP5PP/XbiABzDIOW7ZjU+SCMAkEgD4x/4+EJLJRICxwzCBBADVI/ADNeImAnWZPxnpG/h/JAKoFgkAKkfgByKCRADVIwFA+Qj8QESRCKByJAAojcAPxASJAMpHAoD5EfiBmOLUAEojAcCc9nZ3b5CMc4TAD8QZiQDmRwKAm3gDfOzcy5ZYjwmAhCARwK1IAOBhch+QfDpZcOyT639EfwAUCUDaufv8D53p/rLtyAEBkA62/RSXDoEEIMUe/sXJ36PBD0iryRMDb3xu6z8LUokEIIW8G/rs/E+Eef0A6A9ILRKAFNl19Gi2YcWSP2efH8At2BZIHRKAlKDcD6AcVp29i22BdCABSDjK/QAq5xwfGJ54qGvnzhFBYpEAJBXd/QD8Ylsg0UgAEmjviROrJStdlPsB+EeTYFKRACQITX4AAkM1IHFIABLi99/t2ZzP5Q+y6gcQHKoBSUICEHOs+gGEjmpAIpAAxNjDZ860F/Jj/8SqH0D4qAbEHQlAHDmOte9M93PiyPcEAGqJakBskQDEDOf6AUSPc3y0kP3SsS1brgligwQgRh46feIRzvUDiCqmCMYLCUAMeI1+y1tetcR6TAAg0txqQP/QbrYEoo8EIOI43gcgbhyR8/lx59EjO3b0CCLLFkST41hfPPP21wv5fA/BH0CcuCvLtdl66+S+Mye/ru9lgkjiCxNBHRc6m1r7638qNPoBiD22BKKKBCBiKPkDSBq2BKKJBCAquL0PQMJZVubRNzZtOSiIBBKACKDLH0B6sCUQFSQANaaDfRqs/ClK/gDSg8FBUUACUEO6369d/gIAKcTgoNriGGAtzDjiJwCQUs5E4djDp3seEdQEFYCQsd8PALPRF1ALJAAh4nw/AMyHJCBsJAAhefjMmfZCfuyfaPYDgLnpvACZkI5D27dfEgSOBCAE+3re3iW2dVQAACXRHBgOmgADplf4EvwBoHw0B4aDBCAojmPtPd39Ayb7AUDlHCd/YN/pE3/MZULB4YUNAJ3+AGAKzYFBIQEwTIN/4/LFWvKn0x8AjCAJCAJbAAbpMT+CPwCYZt3fuLzlaEdnZ5PAGCoAhjDTHwCCpccErw+Pf7Zr584RgW8kAAboGX+nMPZrAQAEzslZnzm0bRvvuT6xBeCTXuhD8AeA8FhZ54MH3357i8AXEgAfdMAPF/oAQPiy9dbJh39x8vcEVWMLoEpM9wOA2mNqYPVIAKpA8AeA6CAJqA4JQIUI/gAQPSQBlSMBqADBHwCiiySgMiQAZSL4A0D0kQSUjwSgDAR/AIgPkoDykACUQPAHgPghCSiNBGABBH8AiC+SgIWRAMyD4A8A8UcSMD8SgDnoeF8m/AFAMuTGna1HduzgPX0WEoBZuNgHAJKHC4RuRQIwQ8eFzqbW/vobAgBInNFCZtmxLVuuCTxcBjRFg/+ST+rfEwBAIjXY+VMdnZ1NAg8JgGvX0aNZd+X/U8uStQIASCS35L22tbnup/qeL2ALQL8RGpcv1m7/+wUAkALO8dH+od3Hdu/OSYqluwLgOBbBHwDSxrq/YXnLqxoDJMVSnQDsO9P9nBD8ASB1LLEe23vm5IuSYqnNfh46feIR25EDAgBILcvKPPrGpi0HJYVSmQAw5Q8AUJTWaYGpSwAY9AMAmC2Ng4JS1QOgHf+F/Ng/CQAAM2WdI2mbEZCaBKB43I+z/gCA2dI4IyA1CQDH/QAAC0vX8cBUJADa8S8EfwBACXo8cN+7Pf9ZUiDxWQ4d/wCASqXhCuFEJwC7enqWNtr5qwIAQIWSfntgYrcAvKY/O/8TAQCgCnp7YJKbAhObAND0BwDwQ08GJLkpMJEJAE1/AAATtCnw4TOnviwJlLis5vff7dlcyOcT3bgBAAhXEpsCE1UB0L2afC6fyksdAADBydRbB5I2KTA5CYC7R8OkPwBAEIqTApPUD5CYBGDv6X/9urDvDwAIjHV/koYEJSKTYd8fABCWpPQDxL4CwL4/ACBM2g+QhPkAsU8A2PcHAIRpej5AzMU6AfDm/LPvDwAImTcf4HTPIxJjse0BYM4/AKDW4nxfQCwrAMz5BwBEQaOd+0lcjwbGMgFoWL7oSaH0DwCoOev+fWe6n5MYil3Wsre7e4OVdT4QAAAiwpmQOw5t335JYiRWFQAt/bvB/68FAIAoqZOuuB0NjFUCQOkfABBF3tHAFUv+XGIkNlsAlP4BAFEXpymBsagAUPoHAMRBnKYExiIBoPQPAIiDOG0FRH4LgNI/ACBu4nAqINIVAEr/AIBYqpOuqA8IinQCQOkfABBHuhXw8JlTX5YIi2x20nHhQlNrf98NAQAgpqJ8V0BkKwBu8P+pAAAQY95dAREVyQSAa34BAMlg3T8V0yInclsA3k1/yxdPCAAACeCInB/rH9xwbPfunERI5CoAU41/AAAkQlRnA0SqAsCZfwBAUkWtITBSFQDO/AMAkipqDYGRSQBo/AMAJFu0GgIjcWGBd3GCbT0vAHxbVVcv65sWye319dJW1yDNmYy06XP3Q7XVN8z5z/WNj8lQPi/DUx994+PSNzEmvSMj7q9zcnZ0RAD449jWj8Rx7hLLcqTGIpEAMPEPqI4G+00ti6W9cZFsbGlxg/5kwK+GJgZtC/y+JgW9IzfkrJsQvDM8KL9xn/dNjAuA8hUnBL4hclBqrOZNgBz7A8rXbGfc1X2T7FyyTDpaW+ddzYelmBAcvvqJnHGTAgDliUJDYM0rAA3L9WhEzSshQKRtbG6RPctWys7WpVWv8IPQ7m416Mee5Su8CkHnwDXpvH5N3roeycmnQGQ0ZAp/5j58U2qophUAjv0B81vf2OSu8pfKoyvbIhX0y6H9A6eHBuW1votsEwDzqHUVoKYVAI79AbfS1f4TbXd4e/txpQ2HWhXQD00EXu27xBYBMEuDnXvZffgPUiM1qwCw+gduloTAvxCtCrzqVgSOXP1EAEyy7IYNb2zc2Cs1ULMEYN87J34udP4DiQ/8s5EIAJ/SewIObdpWk2OBNUkAWP0Dbpm8rl72r1mXmsA/W9fANXnl4gV6BICCs/vNLTuOSchCTwCmjv0dFVb/SCk9yvfIbau8VT/EqwYcvPKRd4oASKNaVQFCTwC8MYi2dVSAFNJy/7fW3DU9lQ+TdFvgxQvn5DSNgkirGlQBQk0AWP0jrXTV/8Ttq+WRlW2C+R38+CN55dIFAdKmFlWAUC8DalzaooGf4I9U0b3+l+7+HMG/DLo18qPf3ei9ZkCa6IjgfadO/J6EKLQEgAt/kEYPLlvhBX9K/uXT12oyYVolQJpMXRQUWmU+tASA1T/S5uk77nT3+9fFbopfFOhr9vQda+TxttUCpEXYVYBQEgBW/0gT3e9/Yf3dlPwN0JMSf7q2nSQKqRFmFSCU/xM6/5EWunf9nXUbpL2pSWppOJ+T3tER76a+vvExr8v+I/djKJ+XoULuliN3GmBb7KxXftfn+qg3DerNg+2NTe7nantvmP73P9f7PjMDkA4hnQgIPAGg8x9pocH/hfZ7arLfrwG/8/qAnBkalNNDQ26gHBOT2hsXecmADi3So4y1uIaYJABpEdaJgMATAKb+IQ1qEfw16B++2u9N1Av7/Pym5sXeRT9hJwMkAUiNEKoAgScAzPxH0oUd/DXYv3b5UmSG5nQsWeolA/oYBpIApEEYVYBAEwBW/0i6sIJ/cbV/8EqfFwCjSF8DbdrTo49BIwlAGuTGna1HduzokYAEmgCw+keSabd/GGf8dU6+zsuPy6z8sBKB3pEb8tzZX3GHABLMOf7mvTsekIAElgCw+kfS6fG0jtbgyt5a4tf5+FFd8ZcSRiJwemjQSwKApBotZJYd27LlmgQguDkAWXlWgITSATVBBX89tvfdc71uiftXsQ3+Sv/bv+8mMJNJjNlTCUV6KuHp1WsESKqGTOHPJCCBVAB29fQsbbTzVwVIIB1Rq1PqgnDk6ify8sULiStrB10N0ERDXzsgiYKqAgRSAWiwx78qQAJp058GMtO0ye+Vix96gSyJe9rFasArASU3z7gJGRcIIakaM/lnJADGKwBTg38mBEgg76Y6w01/Wh7Xfew4l/sroa+fjko2PT9AX79nP/gFTYFIpDc3bbNNHwk0XgFoWL7oSQESSC/3MR38tZP92Q/eS03wV94RPjfh0b+7Sd42wyrz1RkgCoK4JMh4AmBJ5msCJIxOvDN9uY/uWf+hG/zTuGLVJED/7kf6ze7bP3LbKm9KIZA0QVwSZDQB0KN/wrl/JIye9//WmrvEJD3br3viaff9D895r4VJ+7mCGQmkVwU//O6768UgsxUAjv4hgXRVabL0rwFPm+EwSV8Lk0mAfq30pAaQNAVn/A/FIGPlBJr/kETaWf6jz24UU7Tsz8p/bt+6c508uNzcMcEn3zvDqGAkjskjgcYqADT/IYlMnvfXpjeC//x0O8BkY6BuBQBJ05gt7BZDzCQAjmMVJPMnAiTInmUrjE3706N+z5/vFSxs8jikmamBOiWQhkAkjVNwfmCqGdBIArD35Mn2jMhaARLkcUMDf3TIT5rO+fuhJyJMXvCjI5uBJNFmwAdPnNgsBpipAND8h4TR1b+pxr9X+y4T/Cugr5XefmgCVQAkUabB/o9igO8EQJv/LHG+IUCCmFr9H776iRy80ieojJ4KMDUjgCoAksZynG/onTvik+8EgOY/JI0O/TGx+te97NcMrWTT6OVLF4z0A1AFQBI1Ss73NoDvBIDJf0gaU5f9vNp3idK/D9oHoBckmUAVAEnjTQb0yVcC8MCJE/pTxeQ/JIae+9cVo19a+ud6Wv+6rl+T00OD4pd+Tdc3NgmQFNoM6HcbwFcCsKgu/0UBEsTU6p/SvzkvfnhOTDB1pBOICr/XBFefADiO5Zb//1KABNloaPVP6d8cfS1NjAp+1PBlTkCtOY4842cmQNUJgJ79FyBBOpYsNdL8x+rfPD0W6Hc2gF4QRDMgksTvTIDqKwCc/UfC7Fziv0TM6j8YGvwPX70ifpm8awCIAj8zAapKADj7jyQysUfM6j84JrYBNMnjqmAkic4EqHYboKoEoGHJknUCJIie/fcbGLRjndV/cPS19XsiQL/G7Y2LBEiSarcBqtsCoPyPhHlo2Urx63A/x/6C9lrfJfHrvtZWAZKk2m2AihMAyv9Iorua/K0KdWKdVgAQrNPDg76bAXcuWSZAklS7DVBxAkD5H0mjw3/am/wNiTk9PCQIh99mQD3pscrQRU9AVFSzDVD5FgDlfyTM+ib/e8JHKP+HpmtgQPziOCCSppptgIoSAMr/SKJNLS3ih5b/tTSNcJjYBljfxFhgJEs12wAVJQCU/5FE6312hVP+D1/n9avix71UAJBAlQ7oqygBsOqcrwqQMO0+twBMXFaDypwZ8pd0tdU3CJA4dZVt0VeUAOR17jCQIHpDnN/z/2dHbwjC5XfLRb/mNAIicRzn0Uq2AcpOAPTaQfdtcq0ACeI3+Ote9NmREUG4dCiQ3z4ABgIhabwrgk+dKnvQRdkJQIM9TvkfieO3/N/L6r9mekf8vfZtVACQQI3Zwu5y/2zZCYAlma8JkDB+g4DfIITq+d16YQsAiVSQ/eX+0bISgI7OTj0zc78ACdNW568Z7CNm/9eM33sXWjJZAZLHuX8qZpdUVgKwdFHd7wqQQH57ALj8p3b8vvZsASCpmuvKi9llJQAFq/r7hoEoa/a5CvTbiIbq6QAmP/xWf4CoKncqYFkJANP/kFQtmeouxCy6POEvCKF6wwWSL2BOZR4HLPnup8f/BEgovwNhqADUzpDP154tACRVuccBSyYAdYXxso8UAGlDAlA7vPbA/Mo5DlgyAbCz1mMCAABiwykUSsbuhRMAdw/BEpsEAACAGLHEXbyX6ANYMAF4oLv7dgEAALGzt0QMXzABaLTy9wmAefmdI4Dq8doDC7MarAVj+IIJAPv/SDq/Z8kJQrXTwhAnYEGl+gDmTwDY/wdKaiEBqJlVdf6O8Q3ncwIkWak+gHkTgEquFATiyvc4WabJ1YzfWf5DDBJCCiwUy+dNABolt1mAhOvzOcmPYTK14/e1Z44A0mCheQDzJgCObX9ZgITzGwS4UrZ2/CYAl8cZ44zkcxz5wny/N28CUBDnUQESzu8WQHvjIkFtrPf52nOVM1LBmT+Wz5kA6F3CGZG1AiSc7wSgiQSgVvy+9mdHRgRIOr0XQGP6XL83ZwKwpKHhdwRIgbOjN8QPPQbINkD41jc2+T6COVTgFADSobmu7nfn+vzcWwDZ3C4BUkArAH77ADY1LxaEy+/qX7/mVACQFtnGzNa5Pj9PD4D1oAApcdnnNsCmFhKAsPlNunp9Vn6AOHEK+T1zfX7OBIABQEiTM8PXxY+dS5YKwrXRZ9LVO0ICgPSYbyDQLQnArp4e3s2QKn5LwboXzTZAeDY2t/g+AnhmaEiANOno6mqc/blbEoAmK3eXAClyenhQ/LqvlcGZYXlo2Urx6yxbAEiZuRoBb0kAcvnCOgFSRBsB/V4KZCIooTx+y/9n3fI/FwEhbeZqBLwlAbCz2S8IkDJd16+JH2wDhKNjyVLf5f/eUbr/kT5zNQLekgAwARBp1DUwIH493rZaEKw9y1aIX0f6PxEgfaz7Zn/mpgSACYBIKz0W5nsegFuabqtjKFBQ9LXtaPXXo6xfYxM9H0Dc6ETAXUeP3nSF5k0JQLa+nhMASCUNDJ3Xr4pfX75tlSAYT7TdIX51+tzqAeKsYfHi22b++qYEoDnj3CNASh3p7xe/tBnQ74ha3EpX/w8u91/+7xogAUB65R3n9pm/vrkHIHPrHgGQFloa9rsNoMH/iVX+V6q4mYnVv5706KICgBSbfRLgpgTAcQqbBUixA1f6xK9H3G0AegHMMbX6Pz3M8B+k2+yTADclAIwARtqZWiHuX7NOYIaJ1b96re+iAOl2c5V/OgGY775gIE10LPDpIf9d4noioIM7AnzTY39mVv+DDP9B6s0+CTCdADQ0NTUIAHeleElMePqONTQE+qCl/8dNrf4vm/maAnE38yTAdALAHQDAJF0tmqgC6MS6p1evEVRHS/9+p/4pbf7j7D8waeZJgOkEgDsAgE+ZqgLsccvXj6xkNkCl9DUzUfpXr/ax+geKso32uuLz6QQgU5dhBgAwxVQVQHkrWU4FlE1fK1ONf7r6P3KV0b/AtIn89K2A0wkARwCBm5mqAmgfwAvt99APUAYN/iZfK1b/wCyZzO8Xn04nAAWxGQIEzGCyCqB72S+sv1uwsO+s22Bk31/pkU5W/8DNHHGmG5MmEwDHsbgECLjVix+eE1PamxbJ/jvXCea2f81a9zUydxr5lYsXBMDN9Cigxnx97iUAu06dahUAt9Cz468aHCCjTYGcDLjV03fcKXuWrRRTdPuGc//A3Dq6uhr10UsA8vk8Q4CAeRy88pHXTGaKjgomCfiUBv9HVraJKfq1MjHSGUiqJVM3/3oJQEv25huCAHxKLwh68cJ5MUmTALYDJsv+JoO/0q+V30udgCQrzgLwEgDHEbYAgAVoQ6BWAkzS7YC/+MxnU3lEsNnOuH/3zxkt+yv9GjH0B1hYcRbAZBMg1wADJWkvgMmtAKWNgXrsLU1JgP5dX7r7c0Yb/pR+bWj8A8phLdf/naoAWGZrcEACaVn5ubO/Ml5e1mNvGhDTMDFQ/476dzV11K9oOJ/zvjYASnMK+c/r49QcgPxqAVCSdpYHscrUwTd6eZD2BSSxGqAl/z9d2x7YBUmv9l2m6x8okyX2dn30rgXUIUDMKAPKc/jqJ7LeLd0HsWLXvgC9Sli3G5IyxEavRdbAb3rVX6RH/g7S9Q+UrTgMyEsAGAIEVEarALpS72hdKqZpoPzWmnWyqXmxG9wuSt9EPFe2+vrs17+Hm9AERaf9mZzTAKSBNRXzrV1Hj2Ybly+eEAAV8Wb8r7/ba+QL0uH+T2KVCGi5/4nbVxs/3jebNv09+8F7HPkDqjDaP1hndXR2NrU2198QABUrzvhvq2+QoEU9EdAVvwZ93cYI+uIjDf7a9Me+P1CdgeHxRdaunp6ljXb+qgCoSphJgOoauCY/vfqJvOWWv6NgY3OLd31vkKX+mQj+gH+jhcwy64ETJ1Y31wmbaIAPYScBSgOg3laoTYlnQh5+o0F/55Jloaz2ZyL4A2Y4Oesz1t7uzg1Wtv4DAeBLLZKAomIyoFPwzo7ckLOjI2LSKre8ryt8bUzc2bo01KBfRPAHzPESgH09b+8S2zoqAHyrZRIwkzbG9WoiMDIifRNjctkNmvo5DaL6OFy4uXFOG/c0qLe4H6vc//bb3b9HW12DrG9q8pocaxHwZ9K/y/Pnewn+gCkFZ3dWABijAUo7079157pAjgiWSwO2t2IPaV8+SHrU7/sXztHtDxhmO05hgwAwRgPVd93Vqg6ogT96uc93z/US/AHTspl2KgBAQHRAzVA+53XI17qEHjc62/+Vi7+Vw1evCIBg2JLJ/jsBEAhdwT77wS+M3yKYZMUBPwR/IEATuVW2AAiU9gU8+ct3vWQAC5tMmN6j2Q8ImJOxVrEFAIRE7w/QIT7716yt+SmBqNFV/4sXznvHGAGEw+YqYCA8GuB0hUuD4Kf0tdDXhOAPhEevBM66//M7AiA02tGuDYK6x63X5Op1uWmkAf/FC+co9wM1whYAUCMa+PSI255lK+TxttWp2RbQwP/a5Uus+IEaIwEAakxn+etH0hMBAj8QLda+d044AiAydN7+47ev9h6TgMAPRI8b+M+TAAARpfcK6BAhvXkvblUBHeRz8MrH0jlwTc6O3hAA0UMCAMSANgrqLXwdS1qlORPNnTsN+p3XB+RI/yes9oEYIAEAYka3BvYsXyF36U19jYuklvSmwa6BAW++Qa+70mdmPxAfNAECMaOr6+IKW7cJ1rtJgN76513d29gUWIVAV/iXJ8blzNCQnB25IafdR00AAMQTCQAQY3qUUD/0ytwirQro5UOaEGjvgCYJ+mv9aHE/2urm7icoBvPiv1NX8zqhT5+fHRkh2AMJQwIAJEzvVNMd+/AAFsJlQAAApBAJAAAAKUQCAABACpEAAACQQnZe5LwAAIBUsTMiFwQAAKSIdZwtAAAAUogEAACAFCIBAAAgZRwp/NZ2xDohAAAgTS5RAQAAIIVsy3L6BAAApIrt5PJXBAAApIZlZ95lCwAAgBRytwDsXwsAAEiPXL43K0CENdsZ2diyWO5tXizNmYysb2qSFvexrb5BgKjoGx+ToXxePhofl97RG9I7MiK/GbkhfRPjAkRV1ilMfGjZ9QJExcbmFtm5ZJl0tLYS6BEL+n3a5j62Ny1yv2+XTn++z00ITg8NyuGrn8iZ4UEBosIp2B9SAUAk6Er/kdtWSceSpd6bKJAEbfX1smf5Cu9Dk4FX+y7KGTchoDKAmnOcYWtXT8/SRjt/VYAaKAb+R1e2eSV+IOmG3a2CA1f65Ej/JyQCqJnRQmaZ1dHZ2dTaXH9DgJA9snKVPNF2B4EfqVSsCBxxtweAsA0Mjy+ydh09mm1cvnhCgJC01dXL/jXrZFPLYgHSThOB53rfpxqAUI32D9ZZ+mTfOyccAULw4LIV8swda1j1AzPotoBWAw5e+UiAMLx573bLawLMi5x3347XChCgx9tWeyV/ADfThPjpqcT4tb5LAgTJXfGf10dvEqAb/C8IEKD9a9YS/IES9Gdk/53rBAiW85b+r5cAcCUwgqTBf8+ylQKgND0y+ML6uwUIkFdmmrwLIJ/7NwECQPAHKqcNslQCEBQr73jNJl4CUHCEcygwTvf8Cf5AdbQS8PTqNQIYZ1ld+uAlANmMfU4Ag4pn/AFUT4dk6c8SYFIuJwP66CUAQznrsgCG6Dl/gj9ghv4s6c8UYErGmoz5XgKQGx+/JoAhL7Tfwzl/wBD9WdLBWYApY5nMiD56CUBXR8eoAAbsWbbCuwAFgDnaFMhWAEw5tnmztwUweRugZTn5d04wDAi+aJny8YBK/8P5nHReH5CzIzfkzNCQd/d638SYALWmK/Tb6xpkfVOTF6g7lrS6nzN/0apuBei1wjo1EKiWNwTIjfn6fPq7dGoYEAkAqqYNS6ZX/33jY954VN74EFX6fdmbvyG9oze871OllTA9BdNW3yCmaKKhVQAmBcKfySFAyp7+nCX/IECVdPX/yMo2MUVX/PpG9+Qv3/USAII/4kQTAf3efeWi2SGrXJsNv6y8807x+XQCkJ/Ivy9AlUze7Ker/mc/eM+7HAWIM01en/zlGe972oRiFQCoWl3ml8Wn0wkAswDgh6m9f32jfO7sr7wrUoEk8K77db+ne0duiAmPGqy0IX1yo4VzxefTCQCzAFCtjc0tRvb+Cf5IKv2efv58r5FKgFYBNjWbq7ghXXLZ7G+Kz6cTgMzg4McCVOEhQ+N+Cf5IsmIlwEQ/y32trQJUY2xkZDoLnU4Aju3enctP3REMVGKjgf1/bfgj+CPp9HvcRG/LziXLBKhG186dI8Xn9szfsKXwlgAV0O5/v+V/LYvS8Ie00MZAv1sB+jO3ioFbqJAjzuszf31TAiB554gAFVjftEj8epVzzUgZTQL8og8AlZp5BFDdXAGw7W4BKrCppUX80P3QI1e5jRrpYmKwlU4eBCoydQ1w0U0JACcBUKm2On+Tzjqvcw8V0keDf+f1q+LH7QanDCIdnLx107yfmxIATgKgUqt8vgmdHhoUII30Tgs/uCIYlbo+6+bfmxIATgKgUi0ZW/w4O2pmOAoQN34HAwVx4RCSSy8BmnkCQN3y7s1JAFTC72UnHP1DWvVN+Pve59ptVMY5MPszty7fOAmAEHHJD9KK732EybLtn83+3K0VAE4CAACQKDPvACi6JQG4dmPilwIAABJj5h0ARbckAF0dHaMCAAAS49iWLbecub61B8CyHEcKrwtQBr8jTRlnirTy28RHDwHKNXsEcNHcZ7hoBASAQDXbGfFjiAQAZbIkc3iuz8+ZANAIiHIN5Qvix+11TDNDOjVn/CUAw/mcAOVwcs4/z/X5ORMAGgFRLr9vQmwBIK1afA7yGSpQAUB5ro+N/Xauz8+ZAOi0ICYCohx9E/56AFp8roKAuKIHAGGYawJg0bxzXG2xDghQgt83ISoASCu/CcBlnw24SAtn3lg+bwJQyOV+JkAJfkf5cqMZ0mp94yLx4yPGaKMMVkH+fr7fmzcBmLDrjwpQgt8EwO+bIBBX7U3+vvfPjowIUMqoZE/N93vzJgDHNm8eEKAEv7f5aRm0mT4ApIx+z/v9vh8qcAoApS0Uy+e/y5WBQCiDidv8NjUvFiBN1jc2iV9UAFCKNwDIjeXz/f6Cl7kXcg4JAErq9flGtLGlRYA02dTiL+k9O+Kv8oZ0sGx7wRi+YAIw6mTeEqCEs6PD4kc7fQBIGb9Vr74JGgBRmjPmLBjDF0wAfr5t22UBSvBbitTVEH0ASAv9XvdbATg9NChAKYdKxPAFEwD6AFAOE3uR9AEgLUx8r7P/j1JK7f+rhRMAoQ8ApZ0eHvQ9EKijdakAabBzib/vdf1Z0585YCGl9v9VyQSAeQAoR6/PpiR9U2QbAGngN9ntHaUBEKWN5uySsbtkAqBnCLkXAKV0Xb8mfmjwpxkQSbdn2QrfiW7XgL+fNaTDsS1bSn6jlEwAdA+BewFQiommpMfbVguQZB1L/G91Uf5HKY44Pyznz5VOAPQPOYX/KcACzo6O+O4D4DQAkqytrt53+b9vfIwGQJSUH5eyYnZZCcC1GxO/FKCEw1eviF+PrFwlQBI90XaH+HV6eEiAUoYnyovZZSUAU3cJHxdgAV0D/q+PeHRlG1UAJI6u/je2+D/+d6T/EwEW5hyfitkllZUAqHwu/6IACzBxHFCDP1UAJM2Dy1d4F1/5oeV/9v9RWuZH5f7JshMAjgOiHAeu9IlfVAGQJLr637NspfjVeZ3uf5Q2WrD+ttw/W3YCwHFAlOPglY/EL6oASBITq3/19wZ+tpBsjhujyzn+V1R2AsBxQJTDm1Jm4EigVgF05QTEmX4Pm2n+GzRy9TaSzcoXXqnkz5efAKjc2EsClPBa3yXxS6sA+9esEyDOTAR/dZjmP5TBcTJ/U8mfrygBOLS1o1eAEiZXK2Pil84FMDE4BagFnfqn5X+/9GfpyFUSAJQ2dv36uUr+fGUVAO92QKusCUNINxNVAPUttwpAQyDiRkv/jxta/b9q6GcJyabT/47t3p2r5J+pLAEQpgKiPNqx7PdIoNLg/6dr2wWIEy39m2j8Y/WPsuXsirfoK04A3rh3+ykBStDg/2rfRTFBtwI4FYC40DstTJT+Fat/lKvS8r+qOAFgGwDl0iOBJnoB1NN3rJFNzf4nqQFBam9sMtb4x+of5aqm/K8qTwCEbQCU78UL5kZH6KkAjgYiqvR78zvrNogprP5RtirK/6qqBIBtAJRLTwSYmAugdE/1hfZ7aApE5DTbGe9708S+v9KfG1b/KFc15X9VVQLANgAq8T8ufiimeEnA+rsFiBKTwV+9eOGcAOWotvyvqksAhG0AlK939IaREcFF7U2LZP+d6wSIgv1r1rrfk01iih6hZeofylZl+V9VnQDoNgB3A6BceiLAVEOg2rN8BUkAak6Dv4mLfor0Z8TU6Rmkw6GtW6se0Fd1AqDbAJYjLwtQBj0WaLIhUBWTAHoCEDbd8zcd/NVzZ38lQPnspzQWS5WqTwBc406GBABl08amg4ZvNNMkQHsCSAIQlmLDn+ngT+kflXImCv8oPvhKAPTaQbYBUIlXLl6Q3pEbYpL2BLz0mc9xRBCB0++xl+7+nNE9f0XpH5Vzjh/avt3XWVFfCYDKFJwnBajA8+d7jYwJnql4RHB94yIBgrCxucV4t7/S4E/pH5XL/Eh88p0ADIxM/IsAFdAy53fPmb9YUt+YX7r7s94oVsAkHUX93wII/uqVix9S+kfFRvsHfiw++U4AunbuHGEmACql/QCvBTTpTEexanMgWwLwS/f79TIqHUUdBP0Z6Lp+TYBK+Dn7P5PvBMD7lzATAFXQPU/TTYFFXnOgu2Lj/gBUS0v+ut/f0bpUgqDf++z7oyo+zv7PZIkJjmPtOd39m4zIWgEqpF38euNfUA5+7L7RfnTReN8BkklX/U/cvtot+7dJULQC9lwv+/6onCNy/tCmbXf5Of5XZKQC4P2H5PLfFKAK3z3fa/xkwEyP3LbKOyXw4DIzV7QiuYqr/iCDv36vB9EDg3SwxH7eRPCf/HcZsqunZ2mjnb8qQBWKM/7b6hskSIf7P3H3XS9K3wRNV/iU9ovoPn9Q5f6iYsc/TX+o1mj/YJ2J/X9lLAFQe9/p/oElzjcEqEJYSYAq9h+wLZBuWu7XCtGj7oo/6GFSBH/4pc1/h+7dYazabjYB6O7eYGWdDwSoUphJgL4RayLAtavppMdFwwj8iuAPE5yc9ZlD27b9WgwxmgDQDAgTNAn4ztp2b8JfGEgE0mXPshVu8L8jkDP9c9E9fw3+VJvgj3P8zXt3PCAGmU0AXPt63t4ltnVUAB90VfatO9cFvic7UzER6Bq4JsMF3qyTJMxS/0x6xv/7F84R/GGA/dSb9279KzHIeAKgVYB9p7sLAhigjVk6hS1MmgicHhqkWTABahX4lfaY6N0XgAkmm/+KzCcArodOnfhj25LvCWCATvar1XhfPTVw2N0aODM8KIgPPc6n3zdBzpdYiI73PXilTwAzzK/+VSAJAEcCYVrHkqVuNeDOUJoD56JVgcNXr8gRNyGgKhBNq+rqvQmQtVjtFw3nc/Ldc2e9QT+AKQPD44t07L4YFkgCoDgSCNPCPCGwEN0e8KoC7iPJQG1piV+DviaItVrtF2mzn950Sac/TDJ99G+mwBIAqgAISi23BGbTZEAbvbRxkGQgHLrS39m6NBJBv4j9fgTF9NG/mQJLANS+d0783H24XwDDar0lMBdd+Wki0OkmBPQMmKOr/PVNTbJzyTLpaG2N2Nd8TF68cJ6SPwJi/ujfTIEmAA+fenuLY1knBQiAbgloNSCqM/61OqCB4fTQEAlBBYoBX1f3epujzoOo1Z7+Qjjih6AFufpXgSYADAZCGCYHu6yO1MpwLpoQnB0ZkXfcZOAjd+V4dtR4T08saUlfg3174yLZ2NIS2gCoaumqX7v8NQEAghPs6l8FmwAIg4EQjqhXA+aiK0dtHNOkoG9izH0+4j6/kdghRLqy16/TejfAa7DXVX5UV/fz0b1+HRbFqh9BC3r1rwJPAKgCIExROSngRzEx8B5Hb3iJgT7XledHEW801NW8vvb6dfA+6hq8QH+7+7k4BfrZdCvntcuX2OtHSJzjo/1Du00P/pkt+ARAqAIgfHHZFqiGJgOX3WRgMikY9x6HCrnp42fFRz2TPjRjpVpu8qBBvKjFDdrNmaz3vDg7Xx9b7KwX0PX3V+mvM5lEvtaadL3ad4l7IhCugrP7zS07jknAQkkAqAKgVpKcCCA4mjwdvPKxHLjSR7kfIQtn9a/CSQCEKgBqR1ese5atlAeXLScRwIII/Ki5kFb/KrQEgCoAao1EAPMh8CMawlv9q/ASAKEKgOhgawBK9/i1s19HOxP4UXMhrv5VqAkAVQBEjSYCDy5f4Q2cQXrQ1Y/oCXf1r8JNAIQqAKKpOEdAr5GlKpBMxTJ/58A1OTt6Q4BICXn1r0JPAKgCIOq0KtAxddkM4q+42teZCpT5EU3hr/5V+AmAUAVAPGhVQLcG2CKIHw36ejETe/uIgzCm/s2lJgkAVQDEDclA9BH0EU/Bz/yfT20SANfe7u4NVtb5QICYKSYDeoFNx5LW6Ul5CJfu6XdeH5AzQ4PeFcwEfcRRrVb/qmYJgNr7ztv/xxLrMQFiTJMBnXevfQNUB4KjAb93dMQN+EPTVy0D8Va71b+qaQKwq6dnaaOdvypAgsxMCNobm6gQVEkD/unhoelrlGniQ9LUcvWvapoAqL3vdP/AEucbAiSUXn2rF+boloF3BS5JwS2Kq/uzU1cin3ZX+XpFMpBUjjg/PHTvjm9KDdU8AaAKgDQqJgVeQtA0+fz2uvrEJwYa6C9PjE8Her25UJ8T7JE2o/2DdWEf+5ut5gmA2tPd/Wgm6/ydACnXVtfgNRnqxyrv8dNf6+9FnXcFcWHymuLJjzH5aCrI69XEBHpA2U+9ee/Wv5Iai0QCwLFAoDzNmYxbKWjwHvVDEwN9bHErB5OPk58v/tmWqeeq3ARidpDWQD7zUffhh9xA/9GMz+vHUCHHHj1QUm2G/swlGgmAMBwIAJACNRj5O5/IJABq3zsnfu4+3C8AACRObY/9zWZLhIwWMl8SAAASyMnZ/0kiJFIJwLEtW645Yv1QAABIFPupWp75n0ukEgA11n/9j/Ii5wUAgIQY7R/4sURM5BIA7YzMFJwnBQCAJCg4kej6ny1STYAz0RAIAIi/aDX+zRS5CkARDYEAgLgbGJ54SCIqsgmANgTmc9ZXBACAWLKf6tq5c0QiKrIJgDq8detBGgIBAPGjE/+i1/g3U6QTALEsZ3RCOgQAgBjRM/9RbPybKdoJgOvn27dfYjYAACA+onfmfy6RTwAUswEAAPEQ/dJ/UWSPAc728KnOLY5Vf1IAAIgoJ2d9Jg6rfxWLCoB6Y/POHrYCAADRFY/Sf1FsEgDFVgAAIJriU/ovis0WQNEDJ06sbq6TiwIAQETEqfRfFKsKgNJTAeLItwUAgEiIV+m/KHYJgHrz3m0vuA/HBQCAmopf6b8olgmANyCIuwIAADU2Wsh+KeoDf+YTzwRAuCsAAFBjes2vG4skpmKbAKjD27YdcMR5XQAACJVz/M0tO45JjMU6AVBj/UNPcDQQABCWvCPnR/uHdkvMxe4Y4FyYEggACIvlOFvf2LyjR2Iu9hUApVMC6QcAAATPfioJwV8logLgcRxr3+nun7nP7hcAAIxz9/03bf+CnkSTBEhEBcCjRwP7B3fTDwAAMG163z8hwV8lpwIwhX4AAIBpSdn3nyk5FYAp9AMAAIyyra8kLfirxFUAPI5j7T194n9bYj0mAABUzd33v3fHA5JAiasAeNw9GuYDAAD80Tn/8T/vP59kVgCm7OrpWdpo568KAAAVGi1klsV51G8pyawATNEvnOWMbxUAACoR8zn/5Uh0AqC0KdCR/B8IAADlsK2vxH3OfzkSvQUwjaZAAEBZktv0N1viKwCeqaZA99lxAQBgTslu+pstHRWAKR0XOpta+uvfy4isFQAApuikv4mrgxuO7d6dk5RIVQKg9nZ3b7CyzgcCAMAUZ0LuOLR9+yVJkXRsAcxwaNu2X2t3pwAAoNyYkLbgr1KXACjt7mRcMAAgLR3/c0llAqAOb9t2wBHrhwIASKWCI99+c+O2A5JSqesBuAnHAwEgpZzjb27a/oUkXe9bqdRWADwcDwSAFJo67pfi4K/SXQGYsuvo0Wzj8sVH3af3CwAgwSaDf5qO+82HBGAKMwIAINn0rP/QivHPdq3ZOSIgAZiJ2wMBILkGlo8vIvh/Kt09ALPozU9OzvqMAAASpd59byf434wEYBYdFMQVwgCQHJbjbP2/OgQONyEBmINeIcy0QABIAPe9/I3NO3oEt6AHYAH7et7eJbZ1VAAA8eMG/7RO+SsHCUAJJAEAEEME/5JIAMpAEgAAMULwLwsJQJlIAgAgBgj+ZSMBqABJAABEGMG/IiQAFSIJAIAIIvhXjASgCiQBABAhBP+qkABUiSQAACKA4F81EgAfSAIAoIYI/r6QAPj08KnOLY5Vf1IAAKHR8b5M+POHBMCAvd3dG6ys84EAAAKnF/sw298/EgBDOi50NrX017+XEVkrAADj8o6cn3Aym/XmVoFvXAZkiF4zObR8/LPu0+MCADDMOT60YvyzBH9zSAAM0iRgtH9QbxEkCQAAY5zjo/1Du/U9VmAMCYBhx3bvzpEEAIAZjjiva/DX91aBUfQABMVxrH3vdD/nvsLfEwBAxdzg/8NDm7bvF8tyBMaRAARsT3f3o5ms83cCACifbX3lzY3bDggCQwIQAgYGAUAFGPATChKAkDxw4sTqxjrp4pggAMxNj/k15a0HOeMfDpoAQ/Lz7dsvTfQPbhCaAwFgDpPH/Aj+4SEBCBEnBADgVsVOf475hYstgBqhORAANPjn/+DQpn//V3T6h48EoIZoDgSQZlzoU1skADW2q6dnaaOd/4n79H4BgBRgpn800ANQY/oDQF8AgLTQ/f6Jq4MbCP61RwUgQugLAJBoOtzn81sPst8fDVQAIuTwtm0HLGd8a17kvABAQmjJX/f7vcl+BP/IIAGImDc27+xhXgCA5HCOa8mfZr/oYQsgqhzH2tvzr1+3Mpm/FACII0r+kUYCEHEPn+rckrPqDzBCGEBcaMk/K86jrPqjjS2AiGNLAECcFLv8Cf7RRwUgRhgcBCDSuMI3VkgAYobBQQCixzk+Wsh+ibP98UICEEO7jh7NNrQuepIGQQC1VnDk2z+9d9sLNPrFDwlAjO3t7t5gZZ2/FqoBAEKmjX52TjoObd9+SRBLNAHG2KFt236tY4SdfP4PBABC4ojzQ230I/jHGxWAhKAaACBoHO9LFioACUE1AECQiqt+gn9yUAFIIKoBAExhrz+5SAASipMCAHxjlG+ikQAkXEdnZ1Nrc/1PhWoAgLJxrj8NSABSgimCAErRcn/GcZ58c8uOY4LEowkwJfQHerR/sI4mQQBzKTb5EfzTgwpACtEkCOBTlPvTigQgxaa2BZ4XEgEgdSj3gwQg5TgtAKQQ3f0QEgBM8RKB5S1/bon1DQGQSLrPP1bI/lfK/VAkALgJ/QFA8riB/3U38D9D4MdMJACYE4kAEH/eFL+89aCOChdgFhIALIhEAIif6Qa/zdv/mX1+zIcEACVpf0Dj0pb7OTEARBuBH5UgAUDZSASAaCLwoxokAKgYiQAQDQR++EECgKqRCAC1QeCHCSQA8M2bIbBkyTqaBYFgEfhhEgkAjOLUABAE57idyf6Xf/x3m98h8MMUEgAEQhMByRaeZbIgUD0m9yFIJAAIVMeFzqYlH2ce564BoAKOfHvUybxM4EeQSAAQihmXDn1N2B4AbsH+PsJGAoDQsT0AfErL/JKzXzq0dWsvgR9hIgFAzRSrAgU78ycZS9YKkBLeal+sb4469lHK/KgVEgDUnuNYe0+ebKcqgKTT1X4mk/0x3fyIAhIARAq9Akia4t7+wMjEv3Tt3DkiQESQACCyHjhxYvUiO/9FThAgbiZL/PIynfyIMhIARB9bBIgJSvyIExIAxEpx7DDJAKKCoI+4IgFAbJEMoFYI+kgCEgAkQjEZcDLOV91342c4VgiTdE/ftpwDkpt46dDWDs7rIxFIAJBIu3p6ljY441/lNAF8OC6O9aJ3Vn/z5gGCPpKGBACJp/cRLBtouiefz32NrQLMp7jK19L+jY+vvXts9+6cAAlGAoDU0epAo1XY7Uj+McuyHxOkluMUXrck8zqrfKQRCQDSzXGsB7q7b2/OWveRECRfMeAP55y3fr5t22UCPtKMBACYyU0Idp061doouc2OLV8uONajNBTGU7Gkbzn2z1jhA7ciAQBK0B6CJR81/I5YuV1iWw9SJYgmXd07VvZwNmN1X20deb9rDWN3gYWQAABV0D6CRXWyrpAr3OVYhS9QKQiPt7KXwls3Bfs7O0ZZ3QOVIQEADNFKQbavfmlzxrmnYFn3WVLYTLWgerMD/eBovi8zOPgx3fmAGSQAQMA0MWi40tRQrBgUxLlHk4OC2PelvWrgXZpjyYWCI/9gi/W+nbV/Q6AHwkECANTSVNNhPp9vWtyYaStM5JZ61QPLaXN/b3Wck4RicHfEOeFI5l3bcfqLAT7XNn6Nsj1QWyQAQAzoqOOxDQ11WknQZGGRNd5s2XV36u8V7Ey7PlqS//z0P+AmD+72w+/M+FeUPQ2xGLhnfk6D+OS/1uoTy/5Yn9uFfK/3ucLEh/o4ZjddGVs5Mtbw67EJVu9A9P1/chzdCoDsCuEAAAAASUVORK5CYII="}getNotificationIcon(e){switch(e.icon){case"call-video":return"msteams-asset://accept-call-video.svg";case"call-audio":return"msteams-asset://accept-call.svg";case"call-reject":return"msteams-asset://decline-call.svg";default:return void(e.icon&&this.logger.error("[getNotificationIcon] Unknown notification action icon",e.icon))}}canTryGetEntriesForToastId(e,t){const{enableCallingNotifications:n}=this.coreSettings.get(a.J.Calling);return n?!(!e||!t)||(this.logger.error(`[canTryGetEntriesForToastId] notificationId and actionType are required to find calling notification action callback. notificationId: ${e}, actionType: ${t}.`),!1):(this.logger.log(`[canTryGetEntriesForToastId] Feature flag enableCallingNotifications, current value: ${n}), required for processing call notification activation is not enabled`),!1)}dismissNotificationFromCall(e,t){const n=this.callToNotificationMap.get(e);if(n&&n.event&&"content"in n.event&&n.event.content&&"notification"===n.event.content.contentType){n.event.action.visibility=r.cP.Hide;const e=n.event.content.id;return!t&&this.notificationsMap.has(e)&&this.executeCallingToastCallback(e,"TimeOut"),n.event.content.callId&&delete n.event.content.callId,n.event.content.crossClientScenarioName&&delete n.event.content.crossClientScenarioName,this.callingAppEventsService.trigger(n),Promise.resolve(!0)}return this.logger.error(`[dismissNotificationFromCall] Corresponding event not found. No op [sourceId: ${e}]`),Promise.resolve(!1)}getNotificationWithActions(e){return{update:()=>{},cancel:t=>{this.dismissNotificationFromCall(e,t)}}}tryGetEntriesForToastId(e){const t=this.notificationsMap.get(e);return t||this.logger.error(`[tryGetEntriesForToastId] entries for calling toast with notificationId ${e} not found in notifications map`),t}tryGetEntryForActionType(e,t,n){const i=e.find((e=>this.isMatchingAction(e,n)));if(!i){const e=this.removeFromMap(t);this.logger.error(`[tryGetEntryForActionType] no entry for actionType ${n} found for calling toast activation. ${e}`)}return i}tryExecuteCallback(e,t){return(0,i.mG)(this,void 0,void 0,(function*(){if(!e.action){const e=this.removeFromMap(t);return this.logger.error(`[tryExecuteCallback] no action is defined for calling toast activation with notificationId ${t}. ${e}`),Promise.resolve(!1)}try{yield e.action(),this.logger.log(`[tryExecuteCallback] callback action was executed for calling toast activation with notificationId ${t}.`)}catch(e){this.logger.error(`[tryExecuteCallback] callback action threw an exception with with error: ${e}`)}finally{this.logger.log(this.removeFromMap(t))}return Promise.resolve(!0)}))}isMatchingAction(e,t){return e.actionType===t}removeFromMap(e){return`Removed from map: ${this.notificationsMap.delete(e)}`}getNoopReturnValue(){return{update:()=>{},cancel:()=>{}}}}},19352:(e,t,n)=>{"use strict";n.d(t,{l:()=>s});var i=n(13637),a=n(24211),o=n(67164),r=n(87442);class s{constructor(e,t){this.logger=e.newLogger("CallingDialogServiceAdapter"),this.callingAppEventsService=t,this.dialogCallback=new Map,this.dialogData=new Map}open(e,t={}){var n;return(0,i.mG)(this,void 0,void 0,(function*(){this.logger.log(`[open] Opening ${e} dialog in dialog service`);const i=(0,a.v4)(),s=(e=>{if(!e)return[];const t=[];return e.postConfirmCallback&&t.push({name:o.lR.PostConfirm,action:e.postConfirmCallback}),e.preCloseCallback&&t.push({name:o.lR.PreClose,action:e.preCloseCallback}),e.postCloseCallback&&t.push({name:o.lR.PostClose,action:e.postCloseCallback}),e.preActiveElementIds&&t.push({name:o.lR.PreActiveElementIds,action:e.preActiveElementIds}),e.closeByDocument&&t.push({name:o.lR.CloseByDocument,action:e.closeByDocument}),t})(t);this.dialogCallback.set(i,s);const l=(e=>{if(!e)return[];const t=[];return e.dialogTitle&&t.push({title:o._d.DialogTitle,text:e.dialogTitle}),e.dialogText&&t.push({title:o._d.DialogText,text:e.dialogText}),e.primaryButton&&t.push({title:o._d.PrimaryButton,text:e.primaryButton.text||""}),e.confirmMessageTitle&&t.push({title:o._d.ConfirmMessageTitle,text:e.confirmMessageTitle}),e.confirmMessageHtmlBody&&t.push({title:o._d.ConfirmMessageHtmlBody,text:e.confirmMessageHtmlBody}),e.okButtonText&&t.push({title:o._d.OkButtonText,text:e.okButtonText}),t})(t);this.dialogData.set(i,{dialogContent:l});const d="calling-content-event",c={visibility:r.cP.Show},u={source:{name:"DialogOpen",description:e}},m={event:e===r.WB.OptionsSettings?{typeName:d,content:{contentType:"calling-external-settings-pane",tabItemId:t.tabItemId},action:c}:{typeName:d,content:{contentType:"dialog",id:i,name:e,dialogActions:s.map((e=>e.name)),dialogStrings:l},action:c},context:u};try{yield this.callingAppEventsService.trigger(m)}catch(e){return this.logger.error(`[open] Opening dialog error [dialogId: ${i}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`),Promise.reject(null)}const g=(null===(n=s.find((e=>e.name===o.lR.PostClose)))||void 0===n?void 0:n.action)||(()=>{});return Promise.resolve({id:i,close:g,closePromise:Promise.resolve({id:"",value:""})})}))}getDialogData(e){if(this.logger.log(`Getting dialog data for dialog ${e}`),!this.dialogData.get(e))throw new Error(`Unable to find out dialog data with id: ${e}`);return this.dialogData.get(e)||{}}executeDialogAction(e,t){var n;this.logger.log(`Attempting to execute ${t.toString()} action for dialog ${e}`);const i=null===(n=this.dialogActions(e).find((e=>e.name===t)))||void 0===n?void 0:n.action;if(!i)throw new Error(`Action ${t.toString()} not found for dialog ${e}`);i()}dialogActions(e){var t;this.logger.log(`Getting actions for dialog ${e}`);return(null===(t=this.dialogCallback)||void 0===t?void 0:t.get(e))||[]}}},67164:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{WB:()=>i,lR:()=>a,_d:()=>o}),function(e){e.Alert="Alert",e.CallingConfirm="CallingConfirm",e.CallingUnparkCall="CallingUnparkCall",e.OptionsSettings="optionsSettingsDialog",e.PrejoinOverlay="PrejoinOverlay",e.UserMedia="GetUserMediaDialog"}(i||(i={})),function(e){e.PostConfirm="PostConfirm",e.PreClose="PreClose",e.PostClose="PostClose",e.PreActiveElementIds="PreActiveElementIds",e.CloseByDocument="CloseByDocument"}(a||(a={})),function(e){e.DialogTitle="DialogTitle",e.DialogText="DialogText",e.PrimaryButton="PrimaryButton",e.ConfirmMessageTitle="ConfirmMessageTitle",e.ConfirmMessageHtmlBody="ConfirmMessageHtmlBody",e.OkButtonText="OkButtonText"}(o||(o={}))},74898:(e,t,n)=>{"use strict";var i;n.d(t,{T:()=>i}),function(e){e.Chat="chat",e.Community="community",e.Meeting="meeting",e.OneOnOne="1on1",e.PhoneChat="phonechat",e.SfbInteropChat="sfbinteropchat",e.Team="space",e.Topic="topic",e.StreamOfNotifications="streamofnotifications",e.StreamOfCalllogs="streamofcalllogs",e.StreamOfBookmarks="streamofbookmarks",e.StreamOfNotes="streamofnotes",e.StreamOfDrafts="streamofdrafts"}(i||(i={}))},78808:(e,t,n)=>{"use strict";var i;n.d(t,{at:()=>i,iW:()=>a,Uy:()=>o,Ii:()=>r,B3:()=>s,ep:()=>l,XM:()=>d,hV:()=>c,Yv:()=>u,TO:()=>m,ng:()=>g,pk:()=>p,Fp:()=>h,eA:()=>v,g_:()=>S,Jh:()=>f,WX:()=>y,Dr:()=>k,Mt:()=>C,IS:()=>b,M9:()=>T,U0:()=>w,P_:()=>_,cz:()=>I,iO:()=>A,Md:()=>N,YP:()=>E,BQ:()=>D,kK:()=>F,m_:()=>P,WU:()=>M,mz:()=>j,Jq:()=>R,GQ:()=>x,pW:()=>O,zt:()=>L,RS:()=>U,vN:()=>B,f0:()=>W,IK:()=>G,ZI:()=>V,qC:()=>H,DC:()=>$,uV:()=>z,E9:()=>q,Vg:()=>J,Ei:()=>Q,ty:()=>K,rK:()=>Y,dT:()=>X,q0:()=>Z,Y3:()=>ee,aJ:()=>te,_j:()=>ne,Sj:()=>ie,B_:()=>ae,VJ:()=>oe,$H:()=>re,Pc:()=>se,b6:()=>le,EI:()=>de,PA:()=>ce,rl:()=>ue,Tn:()=>ge,wS:()=>pe,qj:()=>he,Z:()=>ve,Ov:()=>Se,kR:()=>fe,Bb:()=>ye,rJ:()=>ke,rf:()=>Ce,MW:()=>be,$R:()=>Te,dh:()=>we,Mp:()=>_e,GE:()=>Ie,QV:()=>Ae,d7:()=>Ne,XT:()=>Ee,CZ:()=>De,j2:()=>Fe,BB:()=>Pe,nP:()=>Me,fA:()=>je,QI:()=>Re,S1:()=>xe,X2:()=>Oe,At:()=>Le,Q5:()=>Ue,yJ:()=>Be,ms:()=>We,i1:()=>Ge,wJ:()=>Ve,uI:()=>He,Ff:()=>$e,C8:()=>ze,e0:()=>qe,Cs:()=>Je,lZ:()=>Qe,BM:()=>Ke,tw:()=>Ye,pj:()=>Xe,nL:()=>et,Cy:()=>tt,UQ:()=>nt,UC:()=>it}),function(e){e.SkypeSpacesThread="19:",e.PrivateFeed="48:",e.SkypeSpacesUser="8:",e.Pstn="4:",e.BotPrefix="28:",e.TFLSmsPrefix="50:sms:",e.RootResourceGroupIdPrefix="92:"}(i||(i={}));const a=864e13,o=2,r=/^[\d]+\:/,s="unq.gbl.spaces",l="messageid=",d=`;${l}`,c=Date.UTC(2e3,0,1),u=new Date("2016-07-01").getTime(),m="ag08:",g="ag08-sfb:",p="ag09:",h="ag09-sfb:",v="4:anonymous",S="teamsvisitor:",f="clientId",y="blah/",k="dod:",C="dod-sfb:",b="@sfbonprem.unq.gbl.spaces",T="@fed.unq.gbl.spaces",w="fed:",_="gal:",I="gal-sfb:",A="gcch:",N="gcch-sfb:",E="preview-",D="tfl:preview-",F="newchat",P="nativefed:",M="tflfed:",j="tfl:",R="orgid:",x="@sfb.unq.gbl.spaces",O="sfb:",L="sip:",U="@sfc.unq.gbl.spaces",B="sfc:",W="orgid:",G="8:",V="28:30005246-e706-444f-ba61-8647ef09db75",H="imBack",$="custom",z="suggestion",q=`:${P}`,J=`:${w}`,Q=`:${j}`,K=`:${B}`,Y=i.SkypeSpacesUser+W,X=i.SkypeSpacesUser+S,Z=i.SkypeSpacesUser+"guest:",ee=i.SkypeSpacesUser+"spool:",te=i.SkypeSpacesUser+"acs:",ne=i.SkypeSpacesUser+O,ie=G+"guest:",ae="50:sms:",oe="50:smsunverified:",re=["live","sip_profile","myspace","c2c","sms"],se="8:tfloffnetwork:",le=`${se}email:`,de=`${se}phone:`,ce="19:meeting",ue="Message";var me;!function(e){e.PSTN="PSTN",e.Thread="thread",e.User="user",e.Bot="bot",e.Unknown="unknown"}(me||(me={}));new Map([[i.Pstn,me.PSTN],[i.SkypeSpacesThread,me.Thread],[i.PrivateFeed,me.Thread],[i.SkypeSpacesUser,me.User],[i.BotPrefix,me.Bot]]);const ge="drafts",pe=`${i.PrivateFeed}calllogs`,he=`${i.PrivateFeed}starred`,ve=`${i.PrivateFeed}notes`,Se=`${i.PrivateFeed}${ge}`,fe=`${i.BotPrefix}integration:`,ye=`${i.BotPrefix}app`,ke=`${i.PrivateFeed}notifications`,Ce="streamof",be="notifications",Te=i.BotPrefix+W,we=(i.SkypeSpacesUser,i.BotPrefix,`${i.SkypeSpacesThread}sfb:`),_e="0;0;0",Ie={VoiceAppPrefix:`${i.BotPrefix}orgid:`,BotPrefixOld:i.SkypeSpacesUser+i.BotPrefix},Ae=(i.SkypeSpacesThread,i.SkypeSpacesThread+B),Ne=i.SkypeSpacesUser+R,Ee=i.SkypeSpacesUser+A,De=i.SkypeSpacesUser+k,Fe="unknown_email_address@invalid.teams.ms",Pe={InterceptorBotMris:["28:22e50a9b-80cc-4eab-a092-ce64796d28d7","28:aee3af68-f70b-4f3d-a98e-28acc47ac522","28:6d2635c7-5f7b-4274-b0b5-e44d64e20dd9","28:f7206cef-8727-438b-9724-e1c508e3e54b"]},Me="application/vnd.microsoft.card.adaptive";var je,Re,xe;!function(e){e.NORMAL="normal",e.HIGH="high",e.URGENT="urgent"}(je||(je={})),function(e){e[e.NoAccess=209]="NoAccess",e[e.InvalidToken=230]="InvalidToken",e[e.ThreadNotFound=732]="ThreadNotFound",e[e.ChatPermissionAndIBRejection=206]="ChatPermissionAndIBRejection"}(Re||(Re={})),function(e){e[e.IBRejection=40318]="IBRejection"}(xe||(xe={}));const Oe=i.SkypeSpacesThread+w,Le=i.SkypeSpacesThread+P;var Ue,Be;!function(e){e.ArchivalLevel="archivalLevel",e.ThemeId="themeId",e.CallableChannel="callableChannel",e.ChannelDefaultSectionId="channelDefaultNotesSectionId",e.ChannelSettings="channelSettings",e.Classification="classification",e.CreatedAt="createdat",e.CreatingFromTemplate="creatingFromTemplate",e.Creator="creator",e.DocumentLibraryId="channelDocsDocumentLibraryId",e.DynamicMembership="dynamicMembership",e.FavDefault="favDefault",e.FolderRelativeUrl="channelDocsFolderRelativeUrl",e.GapDetectionEnabled="gapDetectionEnabled",e.GroupId="groupId",e.GuestUsers="guestUsersCategory",e.DisabledReason="disabledReason",e.GuardianChatInfo="guardianChatInfo",e.HasTranscript="hasTranscript",e.WebinarId="webinarId",e.CoOrganizers="coOrganizers",e.MeetingObjectsConfig="meetingObjectsConfig",e.MeetingContent="meetingContent",e.ImportState="importState",e.ImmutableRoster="immutableRoster",e.Integration="integration:",e.IsDeleted="isdeleted",e.IsFederated="isFederated",e.IsStickyThread="isStickyThread",e.Cfet="cfet",e.JoiningEnabled="joiningenabled",e.ConsumerGroupId="consumerGroupId",e.IsTeamLocked="isTeamLocked",e.IsUnlockMembershipSyncRequired="isUnlockMembershipSyncRequired",e.IsThreadDisabled="isDisabled",e.MeetingChatPolicy="meetingChatPolicy",e.LastJoinAt="lastjoinat",e.LastLeaveAt="lastleaveat",e.LastSyncTime="lastSyncTime",e.Meeting="meeting",e.MemberLimitExceeded="isMaxMemberLimitExceeded",e.NotebookId="notebookId",e.NotesSectionInfo="notesSectionInfo",e.ParentSpaces="parentSpaces",e.Picture="picture",e.PictureETag="pictureETag",e.PinnedItems="pinnedItems",e.RetentionHorizon="retentionHorizon",e.RetentionHorizonV2="retentionHorizonV2",e.RosterVersion="rosterVersion",e.SharepointRootLibrary="sharepointRootLibrary",e.SensitivityLabelDisplayName="sensitivityLabelDisplayName",e.SensitivityLabelId="sensitivityLabelId",e.SensitivityLabelName="sensitivityLabelName",e.SensitivityLabelParentDisplayName="sensitivityLabelParentDisplayName",e.SensitivityLabelParentName="sensitivityLabelParentName",e.SensitivityLabelParentTooltip="sensitivityLabelParentTooltip",e.SensitivityLabelTooltip="sensitivityLabelToolTip",e.SensitivityLabelIsCopyBlocked="sensitivityLabelIsCopyBlocked",e.ShareHistoryTime="sharehistorytime",e.SiteUrl="sharepointSiteUrl",e.SpaceId="spaceId",e.SpaceThreadTopic="spaceThreadTopic",e.SpaceThreadVersion="spaceThreadVersion",e.SpaceType="spaceType",e.SpaceType_Class="class",e.SpaceType_Edu="edu",e.SpaceType_HealthcareCareCoordination="healthcareCareCoordination",e.SpaceType_Plc="plc",e.SpaceType_Staff="staff",e.SpaceType_Standard="standard",e.SpaceType_Community="community",e.SpaceTypes="spaceTypes",e.SubstrateGroupId="substrateGroupId",e.SharedInSpaces="sharedInSpaces",e.TabType="tab::",e.TeamAdminSettings="spaceAdminSettings",e.TeamSmtpAddress="teamSmtpAddress",e.TeamStatus="teamStatus",e.TemplateType="templateType",e.TemplateInformation="templateInformation",e.TenantId="tenantid",e.ThreadType="threadType",e.TopicDescription="description",e.TopicThreadTopic="topicThreadTopic",e.TopicThreadVersion="topicThreadVersion",e.Version="version",e.Visibility="visibility",e.Topics="topics",e.Liveness="awareness_conversationLiveState",e.TopicName="topic",e.GroupTemplate="groupTemplate",e.XTeamName="spaceThreadTopic",e.ExtensionDefinitionContainer="extensionDefinitionContainer",e.Hidden="hidden",e.P2PChatDefaultNotesInfo="groupDefaultNotesInfo",e.P2PChatFilesIndexId="chatFilesIndexId",e.P2PChatFilesIndexId_Value="2",e.P2PChatFixedRosters="fixedRoster",e.P2PChatUniqueRosterThread="uniquerosterthread",e.P2PMessagingDisabled="messagingdisabled",e.isRgBackedThread="isRgBackedThread"}(Ue||(Ue={})),function(e){e.IsNewConversation="isNewConversation"}(Be||(Be={}));const We=[Ue.IsDeleted,Ue.LastJoinAt,Ue.LastLeaveAt,Ue.ShareHistoryTime,Ue.SpaceId,Ue.ThreadType,Ue.Picture];var Ge,Ve,He,$e,ze,qe,Je;!function(e){e.Chat="Chat",e.Conversation="Conversation",e.Meeting="Meeting",e.OneOnOne="1on1",e.PhoneChat="PhoneChat",e.ReplyChain="ReplyChain",e.Team="Space",e.StreamOfNotes="StreamOfNotes",e.Thread="Thread",e.Topic="Topic"}(Ge||(Ge={})),function(e){e.Scheduled="Scheduled",e.Broadcast="Broadcast",e.Adhoc="Adhoc",e.Recurring="Recurring",e.MeetNow="MeetNow"}(Ve||(Ve={})),function(e){e.AcceptPending="AcceptPending",e.ExtendedDirectoryAcceptPending="ExtendedDirectoryAcceptPending",e.Accepted="Accepted",e.Blocked="Blocked",e.Quarantined="Quarantined"}(He||(He={})),function(e){e.AddedBy="addedBy",e.AddedByTenantId="addedByTenantId",e.Alerts="alerts",e.BlockedAtTime="conversationblockedat",e.ClearHistoryTime="clearHistoryTime",e.ChatHistoryHiddenTime="historyHiddenTime",e.Collapsed="collapsed",e.ConsumptionHorizon="consumptionhorizon",e.ConsumptionHorizonBookmark="consumptionHorizonBookmark",e.DraftVersion="draftVersion",e.Favorite="favorite",e.Followed="isfollowed",e.Hidden="hidden",e.HiddenTime="unpinnedTime",e.InteropConversationStatus="interopconversationstatus",e.isDeleted="isDeleted",e.isPinned="ispinned",e.LastImportantImTime="lastimportantimreceivedtime",e.LastUrgentImTime="lasturgentimreceivedtime",e.Loud="loud",e.Muted="muted",e.Normal="normal",e.PinnedConsumptionHorizon="consumptionHorizonForPinnedMessages",e.PinnedItems="pinnedItems",e.RetentionHorizon="retentionHorizon",e.RetentionHorizonV2="retentionHorizonV2",e.SmartReplies="quickReplyAugmentation",e.Subscription="subscription",e.SuggestedActions="augmentation",e.Version="spaceConversationVersion"}($e||($e={})),function(e){e.None="none",e.Space="space",e.Topic="topic"}(ze||(ze={})),function(e){e.ChannelOnlyMember="channelOnlyMember",e.ExpirationTime="memberExpirationTime",e.ExplicitlyAdded="explicitlyAdded",e.Following="isFollowing",e.IsFavorite="isFavorite",e.IsModerator="isModerator",e.IsPinned="isPinned",e.Reader="isReader",e.Role="role",e.RelationshipState="relationshipState",e.MemberMaskId="memberMaskId"}(qe||(qe={})),function(e){e.AddCustomApp="ThreadActivity/AddCustomApp",e.AddMember="ThreadActivity/AddMember",e.BotMessageBack="BotMessageBack",e.Call="Event/Call",e.CallPushNotification="Signal/Flamingo",e.CallRecording="RichText/Media_CallRecording",e.CallLogRecording="RichText/Media_CallLogRecording",e.CallTranscript="RichText/Media_CallTranscript",e.CallLogTranscript="RichText/Media_CallLogTranscript",e.MeetingObjects="RichText/Media_MeetingObjects",e.ClearTyping="Control/ClearTyping",e.Collaborate="Collaborate",e.ConsumptionHorizonUpdate="ThreadActivity/MemberConsumptionHorizonUpdate",e.Contacts="RichText/Contacts",e.Custom="Custom",e.DeleteCustomApp="ThreadActivity/DeleteCustomApp",e.DeleteMember="ThreadActivity/DeleteMember",e.Embed="Embed",e.Files="RichText/Files",e.FlikMessage="RichText/Media_FlikMsg",e.HistoryDisclosedUpdate="ThreadActivity/HistoryDisclosedUpdate",e.HTML="RichText/Html",e.IsReaderUpdated="ThreadActivity/MemberFeatureFlagUpdate",e.JoiningEnabledUpdate="ThreadActivity/JoiningEnabledUpdate",e.LegacyMemberAdded="ThreadActivity/LegacyMemberAdded",e.LegacyMemberUpgraded="ThreadActivity/LegacyMemberUpgraded",e.Location="RichText/Location",e.MediaCard="RichText/Media_Card",e.Meeting="Meeting",e.MeetingPolicyUpdated="ThreadActivity/MeetingPolicyUpdated",e.MemberConsumptionHorizonUpdate="ThreadActivity/MemberConsumptionHorizonUpdate",e.MemberJoined="ThreadActivity/MemberJoined",e.MemberLeft="ThreadActivity/MemberLeft",e.Moji="RichText/Media_FlikMsg",e.PictureUpdate="ThreadActivity/PictureUpdate",e.RetentionDeleted="ThreadActivity/RetentionDeleted",e.RichText="RichText",e.RoleUpdate="ThreadActivity/RoleUpdate",e.ScreenShare="ScreenShare",e.Sms="RichText/Sms",e.SpaceDescriptionUpdated="ThreadActivity/SpaceDescriptionUpdated",e.SpaceThreadChannelAdded="ThreadActivity/SpaceThreadChannelAdded",e.SpaceThreadChannelDeleted="ThreadActivity/SpaceThreadChannelDeleted",e.SpaceThreadChannelRenamed="ThreadActivity/SpaceThreadChannelRenamed",e.SharedInSpacesUpdated="ThreadActivity/SharedInSpacesUpdated",e.SpaceTopicUpdated="ThreadActivity/SpaceTopicUpdated",e.TabUpdated="ThreadActivity/TabUpdated",e.Text="Text",e.ThreadActivityMessageTypePrefix="ThreadActivity/",e.ThreadArchivalUpdate="ThreadActivity/ThreadArchivalUpdate",e.TopicDeleted="ThreadActivity/TopicDeleted",e.TopicDescriptionUpdated="ThreadActivity/TopicDescriptionUpdated",e.TopicTopicUpdated="ThreadActivity/TopicTopicUpdated",e.TopicUpdated="ThreadActivity/TopicUpdate",e.ThreadShared="ThreadActivity/ThreadShared",e.Typing="Control/Typing",e.UpdateFavDefault="ThreadActivity/UpdateFavDefault",e.UpgradeCustomApp="ThreadActivity/UpgradeCustomApp",e.URIObject="RichText/UriObject",e.Video="Event/SkypeVideoMessage",e.ShowHiddenChatHistory="ThreadActivity/ShowChatHistory",e.PinnedItemsUpdate="ThreadActivity/PinnedItemsUpdate",e.ConsentInvites="ThreadActivity/ConsentInvites"}(Je||(Je={}));const Qe=[Je.AddMember,Je.DeleteMember,Je.RoleUpdate,Je.ThreadShared,Je.TopicTopicUpdated,Je.TopicUpdated,Je.TopicDeleted,Je.SpaceTopicUpdated,Je.SpaceThreadChannelAdded,Je.SpaceThreadChannelDeleted,Je.SpaceDescriptionUpdated,Je.TopicDescriptionUpdated,Je.SharedInSpacesUpdated,Je.PictureUpdate,Je.HistoryDisclosedUpdate,Je.JoiningEnabledUpdate,Je.LegacyMemberAdded,Je.LegacyMemberUpgraded,Je.AddCustomApp,Je.DeleteCustomApp,Je.UpgradeCustomApp,Je.UpdateFavDefault,Je.MemberJoined,Je.MemberLeft,Je.ThreadArchivalUpdate,Je.RetentionDeleted,Je.TabUpdated,Je.MeetingPolicyUpdated,Je.PinnedItemsUpdate];var Ke,Ye,Xe,Ze,et,tt,nt,it;!function(e){e.Activity="activity",e.AdminDelete="adminDelete",e.CallLog="call-log",e.Cards="cards",e.CrossPostId="crossPostId",e.DeleteTime="deletetime",e.DeliveryState="deliveryState",e.DraftId="draftId",e.EditTime="edittime",e.EmailDetails="emaildetails",e.Emotions="emotions",e.Files="files",e.GenericStreamMetadata="genericStreamMetadata",e.HardDeleteReason="hardDeleteReason",e.HardDeleteTime="hardDeleteTime",e.Importance="importance",e.InnerThreadId="innerThreadId",e.InteropType="interopType",e.IsRead="isread",e.Links="links",e.Meeting="meeting",e.MeetingScheduledInfo="scheduledmeetinginfo",e.MeetingTitle="meetingtitle",e.MeetingType="@type",e.Mentions="mentions",e.Meta="meta",e.OnBehalfOf="onbehalfof",e.ParentsAnnouncementsStatus="parentsAnnouncementsStatus",e.Pinned="pinned",e.PolicyViolation="policyViolation",e.ReplyPermissions="replyPermission",e.SendAt="sendAt",e.SkipFanoutToBots="skipfanouttobots",e.Starred="starred",e.Subject="subject",e.SystemDelete="systemdelete",e.Title="title",e.UserMetaData="userMetaData"}(Ke||(Ke={})),function(e){e.ConversationUpdate="ConversationUpdate",e.CustomUserProperties="CustomUserProperties",e.MessageUpdate="MessageUpdate",e.NewMessage="NewMessage",e.ThreadPropertyUpdate="ThreadPropertyUpdate",e.ThreadUpdate="ThreadUpdate",e.ResolveConversationLie="ResolveConversationLie",e.NewDraft="NewDraft"}(Ye||(Ye={})),function(e){e.MemberConsumptionHorizonUpdate="ThreadActivity/MemberConsumptionHorizonUpdate"}(Xe||(Xe={})),function(e){e[e.None=0]="None",e[e.Network=1]="Network",e[e.Local=2]="Local"}(Ze||(Ze={})),function(e){e.Admin="Admin",e.User="User",e.Guest="Guest",e.Shadow="Shadow",e.None="None"}(et||(et={})),function(e){e.MeetingsUserParticipatesIn="participated",e.MeetingsUserIsInvitedTo="all",e.MeetingsManuallyUnmuted="none"}(tt||(tt={})),function(e){e.Unknown="0",e.Available="1",e.NotAvailable="2"}(nt||(nt={})),function(e){e[e.ChatWithRestrictedUserNotAllowed=40323]="ChatWithRestrictedUserNotAllowed",e[e.ChatWithLimitedUserNotAllowed=40324]="ChatWithLimitedUserNotAllowed",e[e.GroupChatNotAllowed=40325]="GroupChatNotAllowed",e[e.AddUserToChatNotAllowed=40326]="AddUserToChatNotAllowed",e[e.AddRestrictedUserInvalidOwnerNotAllowed=40327]="AddRestrictedUserInvalidOwnerNotAllowed",e[e.AddRestrictedUserNoOwnerNotAllowed=40328]="AddRestrictedUserNoOwnerNotAllowed",e[e.RemoveChatOwnerNotAllowed=40329]="RemoveChatOwnerNotAllowed",e[e.RemoveUserFromChatNotAllowed=40330]="RemoveUserFromChatNotAllowed",e[e.LeaveChatNotAllowed=40331]="LeaveChatNotAllowed",e[e.ChatWithExternalNotAllowed=40332]="ChatWithExternalNotAllowed",e[e.AddRestrictedUserExternalNotAllowed=40333]="AddRestrictedUserExternalNotAllowed",e[e.RemoveFullUserNotAllowed=40334]="RemoveFullUserNotAllowed",e[e.AddRestrictedUserFederatedChatNotAllowed=40335]="AddRestrictedUserFederatedChatNotAllowed",e[e.RemoveUserFromFederatedChatNotAllowed=40336]="RemoveUserFromFederatedChatNotAllowed"}(it||(it={}))},96843:(e,t,n)=>{"use strict";n.d(t,{ab:()=>E,_W:()=>D,WD:()=>P,Q5:()=>M,dV:()=>j,mh:()=>R,W7:()=>x,Nl:()=>O,Cq:()=>L,oJ:()=>U,lp:()=>B,mr:()=>W,mJ:()=>G,IM:()=>V,vX:()=>H,m:()=>$,vC:()=>z,y:()=>q,Fd:()=>J,Q2:()=>Q,EG:()=>Y,$i:()=>X,xn:()=>Z,_c:()=>ee,o_:()=>te,P5:()=>ne,tv:()=>ae,uY:()=>oe,zH:()=>re,iK:()=>se,PA:()=>le,Ue:()=>de,Vq:()=>ce,bl:()=>ue,cQ:()=>me,yj:()=>ge,MR:()=>pe,vq:()=>he,Q:()=>ve,tL:()=>Se,TV:()=>fe,eZ:()=>ye,kz:()=>ke,B4:()=>Ce,YQ:()=>be,mA:()=>Te,Kt:()=>we,i4:()=>_e,y1:()=>Ae,pu:()=>Ne,gs:()=>Ee,lh:()=>De,eb:()=>Fe,n:()=>Pe,gu:()=>Me,j6:()=>je,u5:()=>Re,fP:()=>xe,nN:()=>Oe,o7:()=>Le,e9:()=>Ue,ug:()=>Be,WA:()=>We,kw:()=>Ve});var i=n(71503),a=n(82039),o=n(34255),r=n(67462),s=n(78808),l=n(74898),d=n(85350),c=n(31821),u=n(6766),m=n(57078);const g=s.at.SkypeSpacesUser+s.f0,p=s.at.SkypeSpacesUser+s.pW,h=s.at.SkypeSpacesUser+s.iO,v=s.at.SkypeSpacesUser+s.Md,S=s.at.SkypeSpacesUser+s.Dr,f=s.at.SkypeSpacesUser+s.Mt,y=s.at.SkypeSpacesUser+s.TO,k=s.at.SkypeSpacesUser+s.ng,C=s.at.SkypeSpacesUser+s.pk,b=s.at.SkypeSpacesUser+s.Fp,T=s.at.SkypeSpacesUser+s.P_,w=s.at.SkypeSpacesUser+s.cz,_="tfl:",I=s.at.SkypeSpacesUser+_,A="sfc:",N=s.at.SkypeSpacesUser+A,E="receiverSfB",D="Text";function F(e,t){return!!e&&e.startsWith(t)}function P(e){return e>=400&&e<500}function M(e,t){return F(e,s.at.SkypeSpacesThread)||R(e,t)}function j(e){return F(e,s.at.PrivateFeed)}function R(e,t){return j(e)||F(t,s.rf)}function x(e=""){const t=/syncState=([^&]+)/;let n;return e&&t.test(e)&&(n=e.match(t)[1]),n}function O(e){if(!e||!e.startsWith(s.IK))return!1;const t=e.split(":");return 2===t.length||3===t.length&&(n=t[1],-1!==s.$H.indexOf(n));var n}function L(e){return!!e&&e.startsWith(I)}function U(e){return e&&L(e)?e.replace(_,""):e}function B(e){return!!e&&(W(e)||q(e)||O(e)||e.startsWith(I)||G(e)||V(e)||H(e)||$(e)||z(e))}function W(e){return!!e&&(e.startsWith(g)||e.startsWith(p))}function G(e){return!!e&&(e.startsWith(h)||e.startsWith(v))}function V(e){return!!e&&(e.startsWith(S)||e.startsWith(f))}function H(e){return!!e&&(e.startsWith(y)||e.startsWith(k))}function $(e){return!!e&&(e.startsWith(C)||e.startsWith(b))}function z(e){return!!e&&(e.startsWith(T)||e.startsWith(w))}function q(e){return!!e&&(e.startsWith(s.dT)||e.startsWith(s.Sj))}function J(e){return!!e&&(W(e)||G(e)||V(e)||H(e)||$(e)||z(e))}function Q(e){if((0,o.isString)(e)&&!(0,o.isEmpty)(e)){if(Y(e))return K("PSTN",e,i.A4.PhoneNumber);if(O(e)||X(e))return K("SfC",e,i.A4.Identity)}return e}const K=(e,t,n)=>`${e}-${new a.F(t,n).scrub()}`;function Y(e){return!!e&&0===e.indexOf(s.at.Pstn)}function X(e){return!!e&&e.startsWith(s.Pc)}function Z(e){return Boolean("unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com"===e||e===s.j2)}function ee(e,t){let n=e;return t&&(n=[e,s.XM,t].join("")),n}function te(e){return we((0,r.F)(e.conversationLink)).conversationId}function ne(e){if(!e||!e.conversationLink)throw TypeError("Chat-Service-Utils: Missing conversationLink");const t=we((0,o.last)(e.conversationLink.split("/"))||"");return t.isValid?t.itemId:e.id}function ie(e){const t=Number(e);return!t||t<s.hV}function ae(e){const{properties:t}=e;if(!t)return;const n=t[s.BM.EditTime];return n?Number(n):void 0}function oe(e){const{properties:t}=e;if(!t)return;const n=t[s.BM.DeleteTime];return n?Number(n):void 0}function re(e){const{properties:t}=e;if(!t)return;const n=t[s.BM.HardDeleteTime];return n?Number(n):void 0}function se(e,t,n){const i=e;if(t&&(t[s.Q5.ExtensionDefinitionContainer]||t[s.Q5.P2PChatUniqueRosterThread]&&i&&i.length>2)){const{members:t,botMembers:i}=le(e,n);return{members:t,botMembers:i}}return{members:i,botMembers:[]}}function le(e,t){if(e&&e.length>2){const n=(0,o.partition)(e,(e=>!ue(e.id)||t&&t.indexOf(e.id)>-1));return{members:n[0],botMembers:n[1]}}return{members:e,botMembers:[]}}const de=e=>e.startsWith(s.eA),ce=e=>e.startsWith(s.dT)||e.startsWith(s.eA)||e.startsWith(s.q0)||e.startsWith(s.Y3)||e.startsWith(s.aJ);function ue(e){return!!e&&(!e.startsWith(s.GE.VoiceAppPrefix)&&(e.startsWith(s.at.BotPrefix)||e.startsWith(s.GE.BotPrefixOld)))}const me=e=>!!e&&e.startsWith(s.kR),ge=e=>e.startsWith(s.B_),pe=e=>e&&e.startsWith(s.VJ)||!1,he=e=>e&&e.split(":")[2]||"",ve=e=>O(e)&&!e.startsWith(I)?e.replace(s.at.SkypeSpacesUser,s.at.SkypeSpacesUser+_):e,Se=e=>O(e)&&!e.startsWith(N)?e.replace(s.at.SkypeSpacesUser,s.at.SkypeSpacesUser+A):e,fe=(e,t=s.Jq)=>B(e)||ue(e)||Y(e)||Ce(e,t)||ge(e)||pe(e),ye=e=>B(e)&&!ce(e),ke=e=>{const t=Number(e),n=Date.now()+30*m.Zd;return 0!==t&&!isNaN(t)&&t<n},Ce=(e,t)=>{if(!e)return!1;const n=s.at.BotPrefix+t;return e.startsWith(n)};function be(e){return!!ue(e)&&s.BB.InterceptorBotMris.some((t=>t===e))}function Te(e){return!!e&&e.includes(s.ep)}function we(e){if(!e)return{isValid:!1,conversationId:"",itemId:""};const t=e.split(";");if(1===t.length)return{isValid:!1,conversationId:t[0],itemId:""};if(2!==t.length||0!==t[1].indexOf(s.ep)||t[1].indexOf(s.Jh)>-1)return{isValid:!1,conversationId:"",itemId:""};const n=t[1].substr(s.ep.length);return{isValid:!ie(n),conversationId:t[0],itemId:n}}function _e(e){switch(e){case l.T.Team:return s.i1.Team;case l.T.Topic:return s.i1.Topic;case l.T.SfbInteropChat:case l.T.Chat:return s.i1.Chat;case l.T.Meeting:return s.i1.Meeting;case l.T.PhoneChat:return s.i1.PhoneChat;case l.T.Community:return s.i1.Team;default:return s.i1.Thread}}function Ie(e){const{properties:t}=e;return t&&t[s.BM.Importance]?t[s.BM.Importance]:s.fA.NORMAL}function Ae(e){return Ie(e)===s.fA.HIGH}function Ne(e){return Ie(e)===s.fA.URGENT}function Ee(e){return(0,o.includes)(s.lZ,e.messagetype)}function De(e){switch(e){case d.UB.Admin:return s.nL.Admin;case d.UB.Guest:return s.nL.Guest;case d.UB.User:return s.nL.User;case d.UB.Shadow:return s.nL.Shadow;case d.UB.Undefined:default:return s.nL.None}}const Fe=(e,t)=>{if(e){const n=e[s.BM.Emotions],i=n&&(0,o.find)(n,{key:"star"}),a=i&&i.users;if(a)return!!(0,o.some)(a,{mri:t})}return!1},Pe=({resourceType:e,resource:t})=>{switch(e){case"NewMessage":case"MessageUpdate":return t.conversationid||te(t);case"ThreadUpdate":case"ConversationUpdate":return t.id;default:return}},Me=({resourceType:e,resource:t})=>{switch(e){case"NewMessage":case"MessageUpdate":return ne(t);default:return}},je=e=>e===l.T.StreamOfNotifications,Re=e=>e===l.T.StreamOfCalllogs,xe=e=>e===l.T.StreamOfDrafts,Oe=e=>e===l.T.StreamOfNotes,Le=e=>{var t;if(!e)return"";if((0,o.isString)(e)){const t=e;return 0===t.lastIndexOf(s.IK,0)||0===t.lastIndexOf(s.at.BotPrefix,0)||Y(t)||ge(t)||pe(t)?t:s.IK+t}return null!==(t=(0,o.first)(e.mris))&&void 0!==t?t:""},Ue=e=>null==e?void 0:e.startsWith(s.PA);function Be(e){if(!e)return!1;if(!e.startsWith(s.IK))return!1;return(e.startsWith(g)||e.startsWith(s.XT)||e.startsWith(s.CZ))&&3===e.split(":").length}const We=e=>{const{enableTfwTflFederation:t}=e.get(c.J.Messaging),{enableGuardiansChat:n}=e.get(c.J.Guardians),{licenseType:i}=e.get(c.J.UserResources);return!!(t||n&&Ge(i))},Ge=e=>e===u.oj.Teacher,Ve=e=>{if(!e)return;const t=Number(e.sendAt);return isNaN(t)?new Date(e.sendAt).getTime():t}},68282:(e,t,n)=>{"use strict";n.d(t,{dP:()=>i,qN:()=>a,iv:()=>o,vO:()=>s,VS:()=>u,uD:()=>l,f1:()=>m,b:()=>g});var i,a,o,r,s,l,d,c=n(78808);!function(e){e.ScheduledDraft="ScheduledDraft"}(i||(i={})),function(e){e[e.Sync=1]="Sync",e[e.LongPoll=2]="LongPoll",e[e.SfB=3]="SfB",e[e.SyncRelated=4]="SyncRelated",e[e.Local=5]="Local",e[e.CSAReplyChain=6]="CSAReplyChain",e[e.DeltaSync=7]="DeltaSync",e[e.SyncOnDemandFromLongpoll=8]="SyncOnDemandFromLongpoll",e[e.AdHocPropertyUpdate=9]="AdHocPropertyUpdate"}(a||(a={})),function(e){e[e.Sending=0]="Sending",e[e.Delivered=1]="Delivered",e[e.Received=2]="Received",e[e.Error=3]="Error",e[e.Deleted=4]="Deleted"}(o||(o={})),function(e){e[e.Muted=0]="Muted",e[e.Simple=1]="Simple",e[e.Important=2]="Important",e[e.Mentioned=3]="Mentioned"}(r||(r={})),function(e){e[e.StartupSyncClean=1]="StartupSyncClean",e[e.StartupSyncUpdate=2]="StartupSyncUpdate",e[e.ThreadDetailsSync=3]="ThreadDetailsSync",e[e.LongPoll=4]="LongPoll",e[e.ResolverPutConversation=5]="ResolverPutConversation",e[e.LocalUpdate=6]="LocalUpdate",e[e.PutConversationLie=7]="PutConversationLie",e[e.AddUsersToConversation=8]="AddUsersToConversation",e[e.ConversationFetchJob=9]="ConversationFetchJob",e[e.GroupChatsStartupJob=10]="GroupChatsStartupJob",e[e.OneToOneChatFetchJob=11]="OneToOneChatFetchJob",e[e.NonRecentChatsStartupJob=12]="NonRecentChatsStartupJob",e[e.NonRecentChatsStartupRetryJob=13]="NonRecentChatsStartupRetryJob"}(s||(s={}));class u{}u.NotificationConversationId=`${c.at.PrivateFeed}notifications`,u.StarredConversationId=`${c.at.PrivateFeed}starred`,u.CallLogConversationId=`${c.at.PrivateFeed}calllogs`,u.AnnotationsConversationId=`${c.at.PrivateFeed}annotations`,function(e){e.userGraphSettings="userGraphSettings"}(l||(l={})),function(e){e[e.Message=0]="Message"}(d||(d={}));const m="x-ms-request-priority";var g;!function(e){e[e.RealTimeSync=0]="RealTimeSync",e[e.ForegroundSync=10]="ForegroundSync",e[e.BackgroundSync=20]="BackgroundSync"}(g||(g={}))},85350:(e,t,n)=>{"use strict";n.d(t,{wC:()=>m,N:()=>g,x6:()=>p,F3:()=>h,aO:()=>v,Be:()=>S,$_:()=>f,ex:()=>y,Ky:()=>k,LC:()=>C,D2:()=>b,bn:()=>T,TU:()=>w,aX:()=>_,cL:()=>I,C9:()=>A,B5:()=>N,eU:()=>E,tG:()=>F,yt:()=>P,s8:()=>M,jK:()=>j,zW:()=>R,UB:()=>x,XI:()=>O,Wr:()=>L,RQ:()=>U,m1:()=>B,xu:()=>W,Vn:()=>G,wJ:()=>V,fD:()=>H,uN:()=>$,mr:()=>z,eO:()=>q,iO:()=>J,gB:()=>Q,k2:()=>K,AO:()=>Y,lT:()=>X,A6:()=>Z,FG:()=>ee,kN:()=>te,lR:()=>ne});var i=n(13637),a=n(6766),o=n(75068),r=n(31821),s=n(1702),l=n(52397),d=n(25118),c=n(18548),u=n(38923);const m=1,g=200,p="api/v1/",h="api/v2/",v="api/v3/",S=12e4,f=12e4,y="https://chatsvcagg.teams.microsoft.com",k="https://teams.microsoft.com/api/csa",C={startupclean:"teams/users/me",startupdelta:"teams/users/me/updates",startupgroupchats:"teams/users/me/groupchats",startupnonrecentchats:"teams/users/me/nonrecentchats",startupcleananonymous:"teams/users/anonymous",startupdeltaanonymous:"teams/users/anonymous/updates"},b="xx",T=100,w=50,_=50,I=50;var A,N,E,D,F,P,M,j,R,x,O,L,U,B,W,G,V,H,$,z,q,J,Q,K,Y,X,Z,ee;!function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff",e[e.HealthcareCareCoordination=5]="HealthcareCareCoordination",e[e.Community=6]="Community"}(A||(A={})),function(e){e.None="none",e.Owners="owners",e.Members="members",e.OwnersAndMembers="ownersAndMembers"}(N||(N={})),function(e){e[e.None=0]="None",e[e.Private=1]="Private",e[e.Secret=2]="Secret",e[e.Public=3]="Public",e[e.HiddenMembership=4]="HiddenMembership",e[e.Unknown=5]="Unknown",e[e.All=6]="All"}(E||(E={})),function(e){e[e.InProgress=0]="InProgress",e[e.Success=1]="Success",e[e.Error=2]="Error"}(D||(D={})),function(e){e[e.None=0]="None",e[e.Private=1]="Private",e[e.TenantWide=2]="TenantWide",e[e.Shared=4]="Shared"}(F||(F={})),function(e){e[e.Everyone=0]="Everyone",e[e.Moderators=1]="Moderators"}(P||(P={})),function(e){e[e.Everyone=0]="Everyone",e[e.Moderators=1]="Moderators"}(M||(M={})),function(e){e[e.NotAllowed=0]="NotAllowed",e[e.Allowed=1]="Allowed"}(j||(j={})),function(e){e[e.NotAllowed=0]="NotAllowed",e[e.Allowed=1]="Allowed"}(R||(R={})),function(e){e[e.Undefined=0]="Undefined",e[e.User=1]="User",e[e.Admin=2]="Admin",e[e.Guest=3]="Guest",e[e.Shadow=4]="Shadow"}(x||(x={})),function(e){e[e.Everyone=0]="Everyone",e[e.Moderators=1]="Moderators",e[e.EveryoneButGuests=2]="EveryoneButGuests"}(O||(O={})),function(e){e[e.Unknown=-1]="Unknown",e[e.Private=1]="Private",e[e.Channel=2]="Channel"}(L||(L={})),function(e){e[e.AnyonePost=0]="AnyonePost",e[e.AnyoneWithWarning=1]="AnyoneWithWarning",e[e.OwnersPost=2]="OwnersPost"}(U||(U={})),function(e){e[e.Strict=0]="Strict",e[e.Moderate=1]="Moderate",e[e.NoRestriction=2]="NoRestriction"}(B||(B={})),function(e){e[e.Standard=0]="Standard",e[e.Private=1]="Private",e[e.Shared=4]="Shared"}(W||(W={})),function(e){e[e.Single=0]="Single",e[e.Occurrence=1]="Occurrence",e[e.Exception=2]="Exception",e[e.RecurringMaster=3]="RecurringMaster"}(G||(G={})),function(e){e[e.None=0]="None",e[e.Adhoc=1]="Adhoc",e[e.Scheduled=2]="Scheduled",e[e.Recurring=3]="Recurring",e[e.Broadcast=4]="Broadcast",e[e.MeetNow=5]="MeetNow"}(V||(V={})),function(e){e[e.None=0]="None",e[e.Daily=1]="Daily",e[e.Weekly=2]="Weekly",e[e.Monthly=3]="Monthly",e[e.RelativeMonthly=4]="RelativeMonthly",e[e.Yearly=5]="Yearly",e[e.RelativeYearly=6]="RelativeYearly"}(H||(H={})),function(e){e[e.First=0]="First",e[e.Second=1]="Second",e[e.Third=2]="Third",e[e.Fourth=3]="Fourth",e[e.Last=4]="Last"}($||($={})),function(e){e[e.January=1]="January",e[e.February=2]="February",e[e.March=3]="March",e[e.April=4]="April",e[e.May=5]="May",e[e.June=6]="June",e[e.July=7]="July",e[e.August=8]="August",e[e.September=9]="September",e[e.October=10]="October",e[e.November=11]="November",e[e.December=12]="December"}(z||(z={})),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(q||(q={})),function(e){e[e.First=0]="First",e[e.Second=1]="Second",e[e.Third=2]="Third",e[e.Fourth=3]="Fourth",e[e.Last=4]="Last"}(J||(J={})),function(e){e[e.None=0]="None",e[e.Sfb=1]="Sfb"}(Q||(Q={})),function(e){e[e.Meeting=1]="Meeting",e[e.None=0]="None",e[e.Channel=2]="Channel"}(K||(K={})),function(e){e[e.Success=0]="Success",e[e.TranslationFailed=1]="TranslationFailed",e[e.MessageNotFound=2]="MessageNotFound",e[e.VersionNotFound=3]="VersionNotFound",e[e.SkipTranslation=4]="SkipTranslation",e[e.ContentIsEmpty=5]="ContentIsEmpty",e[e.LanguageDetectionFailed=6]="LanguageDetectionFailed",e[e.UnsupportedSourceLanguage=7]="UnsupportedSourceLanguage",e[e.UnknownError=10]="UnknownError"}(Y||(Y={})),function(e){e.Badges="badges",e.Chat="chat",e.ChatMessages="chatmessages",e.ChatMessage="chatmessage",e.Chats="chats",e.ChatsV2="chats_v2",e.ChatsV3="chats_v3",e.ChatsByTitle="chatsByTitle",e.ChatWithUser="chatwithuser",e.CrossPost="crosspost",e.GetPost="getPost",e.GetSupportedTranslationLanguages="getSupportedTranslationLanguages",e.PostAuthors="postAuthors",e.ReplyChain="replychain",e.ReplyChains="replychains",e.ReplyChainsV2="replychains_v2",e.RepliesInChain="repliesInChain",e.StartupGroupChats="startupgroupchats",e.StartupNonRecentChats="startupnonrecentchats",e.ScheduleMessage="schedulemessage",e.SystemMessages="systemmessages",e.Teams="teams",e.TranslateMessages="translatemessages",e.PinnedChannels="pinnedChannels",e.PinnedPost="pins",e.PinPost="pinPost",e.UnpinPost="unpinPost",e.Parents="parents"}(X||(X={})),function(e){e.ContentType="content-type",e.XChatserviceEndpoint="x-csendpoint",e.XClientUiLanguage="x-client-ui-language",e.XRequestPriority="x-ms-request-priority"}(Z||(Z={})),function(e){e[e.Embed=4]="Embed"}(ee||(ee={}));function te(e){const{apiConstants:t}=e.get(r.J.CsaService),{resource:n=y,version:i=p,endpoints:a=C}=t||{};return{resource:n,version:i,endpoints:a}}function ne(e,t){return(0,i.mG)(this,void 0,void 0,(function*(){const{csaHostOverrideUrl:n}=e.get(r.J.Test),m=`${k}/`;if(n)return(0,c.m)(n)||m;const{host:g}=e.get(r.J.CsaService).apiConstants||{};if(!!e.get(r.J.CsaService).useHostFromGtmTable){const n=e.get(r.J.Core).endpointsManagerBaseUrlResolutionTimeoutInMs||12e4,p=(yield((e,t)=>(0,i.mG)(void 0,void 0,void 0,(function*(){const n=e.regionGtm(a.Pn.chatSvcAggAfd);return(0,d.E)(n,t,l.A.BaseUrlTimeout).catch((e=>{if(!(0,s.B)(e)&&!(0,d.T)(e))throw(0,u.Tr)(l.A.BaseUrlFailedToResolve,o.jK.FailedToGet,"getCSAHostFromGtm",void 0,null==e?void 0:e.message)}))})))(t,n))||g||m;return(0,c.m)(p)}{const e=g||m;return(0,c.m)(e)}}))}},95067:(e,t,n)=>{"use strict";n.d(t,{wT:()=>c,io:()=>T,MQ:()=>N,dk:()=>b,Xc:()=>E,gw:()=>F,_T:()=>A,Bu:()=>f,c_:()=>m,GS:()=>u,_2:()=>p,Iy:()=>S,re:()=>k,mO:()=>C,x:()=>w,X5:()=>_,vJ:()=>y,LQ:()=>h,Jn:()=>v,B8:()=>g,$n:()=>I,DA:()=>D});var i=n(31821),a=n(78808),o=n(74898),r=n(34255),s=n(68282),l=n(96843),d=n(57078);const c=({isActionToAccept:e,isUserBlocked:t,isInQuarantine:n,quarantineCounter:o,creator:r,currentUserMri:s},l)=>{let d=a.uI.Accepted;if(e){if(t){const e=r===s,{maxInviteFreeQuarantineCounter:t}=l.get(i.J.People),c=o>=(t||0);n&&!e?d=a.uI.AcceptPending:e&&c&&(d=a.uI.Quarantined)}}else d=a.uI.Blocked;return d},u=(e,t)=>m(e.id,t)&&p(e,t),m=(e,t)=>{if(e===a.kK||e===a.Ov||e.includes(a.YP))return!1;const{overrideThreadTypeForPrivateFeeds:n}=t.get(i.J.Sync);return!(0,l.dV)(e)||!n},g=e=>e.startsWith(a.IK)?"MRI conv id":e,p=(e,t)=>!(h(e)&&!function(e){const{msgEnableSfbCloudFromBVD:t}=e.get(i.J.Messaging),{isSfbCloud:n,isSipEnabled:a,isSfbCloudInBVD:o,isSipEnabledInBVD:r}=e.get(i.J.UserResources);return!!(t?r&&o:a&&n)}(t));function h(e){return((0,r.isString)(e)?e:e.id).endsWith(a.GQ)}const v=e=>h(e),S=e=>{var t;const n=null===(t=e.memberProperties)||void 0===t?void 0:t[a.e0.RelationshipState];return!!(null==n?void 0:n.edRedemptionRequired)},f=e=>{var t;const n=null===(t=e.memberProperties)||void 0===t?void 0:t[a.e0.RelationshipState];return!!(null==n?void 0:n.blockTime)};const y=e=>{var t;return!!(null===(t=e.memberProperties)||void 0===t?void 0:t[a.e0.IsModerator])},k=e=>e.threadProperties&&!!e.threadProperties[a.Q5.ParentSpaces],C=e=>e.threadProperties&&e.threadProperties[a.Q5.ThreadType]===o.T.Team&&k(e),b=e=>{var t,n;if(e.threadProperties&&(null===(t=e.threadProperties)||void 0===t?void 0:t[a.Q5.ParentSpaces]))try{const t=JSON.parse(null===(n=e.threadProperties)||void 0===n?void 0:n[a.Q5.ParentSpaces]);return t&&t.linkedSpaceInfoItems&&t.linkedSpaceInfoItems[0]&&t.linkedSpaceInfoItems[0].spaceThreadId&&t.linkedSpaceInfoItems[0].spaceThreadId.length>0}catch(e){return!1}return!1},T=e=>{if(e.threadProperties)try{const t=e.threadProperties.meeting,n=t?JSON.parse(t):void 0;return n?n.meetingType:void 0}catch(e){return}},w=e=>_(e.type),_=e=>!!e&&e.toLowerCase&&e.toLowerCase()===a.i1.Meeting.toLowerCase(),I=e=>{let t;if(w(e)&&e.threadProperties.meeting)try{const n=JSON.parse(e.threadProperties.meeting);n.subject&&(t=n.subject)}catch(e){return t}return t},A=e=>e===a.Cs.Text||e===a.Cs.RichText||e===a.Cs.HTML,N=e=>{var t;return!!(null===(t=e.members)||void 0===t?void 0:t.some((e=>(0,l.Nl)(e.id))))},E=e=>{var t;return e.id===s.VS.CallLogConversationId||(0,l.u5)(null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)},D=e=>{const t=1209600*d.kg*.5;if(!e||isNaN(e))return!0;return e-Date.now()<t},F=e=>(null==e?void 0:e.threadProperties)&&((null==e?void 0:e.threadProperties[a.Q5.ThreadType])===o.T.Community||(null==e?void 0:e.threadProperties[a.Q5.SpaceType])===a.Q5.SpaceType_Community)},26863:(e,t,n)=>{"use strict";n.d(t,{MJ:()=>u,K6:()=>m,Du:()=>g,ut:()=>p,uY:()=>h,pl:()=>v,ky:()=>S,Fz:()=>f,zb:()=>y,s6:()=>k,rt:()=>C,xb:()=>b,eb:()=>T,HU:()=>w,X3:()=>_,Dq:()=>A,iX:()=>N,S5:()=>E,$V:()=>D,JJ:()=>F,J6:()=>P,sL:()=>M,pi:()=>j,Cd:()=>R,hk:()=>x,rj:()=>O,Fv:()=>L,hu:()=>U,dO:()=>B,BL:()=>W,jo:()=>G,nZ:()=>V,iE:()=>H,hP:()=>$,qo:()=>z,bf:()=>q,xV:()=>K,CB:()=>Y,Hs:()=>X,au:()=>Z,ZY:()=>ee,T7:()=>te,Xg:()=>ne,YP:()=>ie,dG:()=>le,Su:()=>de,rP:()=>ce,As:()=>ue,nL:()=>me,Bl:()=>ge,mB:()=>pe,Eu:()=>he,hC:()=>ve,DZ:()=>Se,me:()=>fe,BU:()=>ye,Ii:()=>ke,$c:()=>Ce,tl:()=>be,Ts:()=>Te,wU:()=>we,jM:()=>Ae,Il:()=>Ne,Fx:()=>Ee,Ki:()=>De,rf:()=>Fe,cu:()=>Pe,ln:()=>Me,iK:()=>je});var i=n(68282),a=n(34255),o=n(31821),r=n(96843),s=n(78808),l=n(74898),d=n(85350),c=n(95067);var u;!function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO"}(u||(u={}));const m=e=>{const t=T(e);return(0,c.LQ)(e)?t:t||(0,c.Jn)(e)},g=e=>{var t;return(null===(t=e.threadProperties)||void 0===t?void 0:t[s.Q5.Creator])||null},p=e=>e.threadProperties&&e.threadProperties[s.Q5.CreatedAt]?e.threadProperties[s.Q5.CreatedAt]:null,h=e=>{if(!e)throw new Error("Invalid conversation passed to isDeleted()");if(!e.threadProperties)return!1;const t=e.threadProperties.isDeleted||e.threadProperties[s.Q5.IsDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},v=e=>{if(!e)throw new Error("Invalid conversation passed to isConversationDeleted()");if(!e.properties)return!1;const t=e.properties.isDeleted||e.properties[s.Ff.isDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},S=(e,t)=>{if(!e)throw new Error("Invalid conversation passed to shouldConversationDeletedByDeleteChat()");const n=B(e,t);return 0!==n&&(!(0,a.isNil)(e.lastMessageTimeUtc)&&n>=e.lastMessageTimeUtc)},f=e=>{var t;return!(!e.properties||!e.properties[s.Ff.Followed])&&"true"===(null===(t=e.properties[s.Ff.Followed])||void 0===t?void 0:t.toLowerCase())},y=e=>{var t;return!(!e.properties||!e.properties[s.Ff.Collapsed])&&"true"===(null===(t=e.properties[s.Ff.Collapsed])||void 0===t?void 0:t.toLowerCase())},k=e=>-1===e.detailsVersion?-1===e.threadVersion:0===e.threadVersion,C=e=>k(e)||!$(e);function b(e){return e.includes(s.YP)||e===s.kK}const T=e=>{var t;return(0,r.Q5)(e.id,null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)&&b(e.id)},w=e=>e.threadProperties&&(e.threadProperties[s.Q5.ThreadType]===l.T.Team||e.threadProperties[s.Q5.ThreadType]===l.T.Community)&&!(0,c.re)(e),_=e=>j(e)?fe(e)||"":te(e)||"";function I(e){return!!e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===l.T.Team}const A=e=>{var t;if(e.properties){if(e.properties[s.Ff.Favorite])return"true"===(null===(t=e.properties[s.Ff.Favorite])||void 0===t?void 0:t.toLowerCase());if(I(e))return!0}return!1},N=(e,t=!1)=>E(e.type,t),E=(e,t=!1)=>!(0,a.isNil)(e)&&(e.toLowerCase()===s.i1.Chat.toLowerCase()||e.toLowerCase()===s.i1.PhoneChat.toLowerCase()||e.toLowerCase()===s.i1.OneOnOne.toLowerCase()||e.toLowerCase()===s.i1.StreamOfNotes.toLowerCase()||!t&&(0,c.X5)(e)),D=e=>{var t;return e.id===i.VS.NotificationConversationId||(0,r.j6)(null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)},F=e=>e===i.VS.AnnotationsConversationId,P=e=>e.type===s.i1.Team||e.type===s.i1.Topic,M=e=>z(e)===d.xu.Shared,j=e=>(0,c.mO)(e)&&(0,c.dk)(e)&&z(e)===d.xu.Private,R=e=>w(e)&&!!e.memberProperties&&!!e.memberProperties[s.e0.ChannelOnlyMember],x=e=>{if(!(0,c.x)(e))return!1;const t=(0,c.io)(e);return!!t&&t===s.wJ.Adhoc},O=e=>{if(!(0,c.x)(e))return!1;const t=(0,c.io)(e);return!!t&&t===s.wJ.Scheduled},L=(e,t)=>e.from.substring(e.from.indexOf("/")+1)===(-1===t.indexOf(s.rK)?s.rK+t:t),U=(e,t)=>{if(!e.threadProperties)return 0;const{enableRetentionHorizonBasedPruning:n}=t.get(o.J.Sync),i=n||M(e)?e.threadProperties.retentionHorizonV2:0;return i&&isFinite(Number(i))?Number(i):0},B=(e,t)=>{if(!e.properties)return 0;if(v(e))return e.lastMessageTimeUtc?e.lastMessageTimeUtc+1:864e13;const n=(!t||!!t.get(o.J.Messaging).enableDeleteChat)&&N(e)?e.properties.clearHistoryTime:0;return n&&isFinite(Number(n))?Number(n):0},W=e=>!!e.mruEvictedTime&&e.mruEvictedTime>0,G=(e,t,n)=>{const i=U(t,n);return!isNaN(Number(e))&&!isNaN(i)&&Number(e)<i},V=(e,t,n)=>{const i=B(t,n),a=Number(e);return!isNaN(a)&&!isNaN(i)&&a<i},H=(e,t,n=!1)=>{var i;if((0,r.Q5)(e.id,null===(i=null==e?void 0:e.threadProperties)||void 0===i?void 0:i.threadType)&&!k(e)){if(e.memberProperties&&n)return e.memberProperties[s.e0.ExpirationTime];if(e.members&&t){const n=(0,a.find)(e.members,(e=>e&&e.id===t));return n&&n.memberExpirationTime}return e.memberProperties&&e.memberProperties[s.e0.ExpirationTime]}},$=(e,t)=>{var n;return!(0,r.Q5)(e.id,null===(n=null==e?void 0:e.threadProperties)||void 0===n?void 0:n.threadType)||!k(e)&&!h(e)&&((0,a.isArray)(e.members)&&t?(0,a.some)(e.members,(e=>e&&e.id===t)):!(e.threadProperties&&P(e)&&!e.threadProperties[s.Q5.LastLeaveAt]&&!e.threadProperties[s.Q5.LastJoinAt])&&!(e.threadProperties&&e.threadProperties[s.Q5.LastLeaveAt]&&(!e.threadProperties[s.Q5.LastJoinAt]||e.threadProperties[s.Q5.LastJoinAt]<e.threadProperties[s.Q5.LastLeaveAt])))};function z(e){if(!e||!P(e))return;const t=e.threadProperties[s.Q5.SpaceTypes],n=t?parseInt(t,10):0;return!!e.threadProperties[s.Q5.SubstrateGroupId]?d.xu.Shared:(n&d.tG.Private)===d.tG.Private?d.xu.Private:d.xu.Standard}const q=e=>Q(e.properties&&e.properties[s.Ff.ConsumptionHorizon]||s.Mp);function J(e){return Q(e.properties&&e.properties[s.Ff.ConsumptionHorizonBookmark]||s.Mp)}function Q(e){const[t,n,i]=function(e){const t=3,n=e.split(";");return n&&n.length===t&&n[0]&&!isNaN(Number(n[0]))&&n[1]&&!isNaN(Number(n[1]))&&n[2]&&!(0,a.isNil)(Number(n[2]))?n:s.Mp.split(";")}(e),o=Number(n)||0;return{originalArrivalTime:Number(t)||0,timeStamp:o,clientMessageId:i}}const K=e=>{var t;const n=q(e),i=J(e);let o=e.lastMessageTimeUtc;if((0,a.isNil)(o)){const n=null===(t=e.lastMessage)||void 0===t?void 0:t.originalarrivaltime;o=n&&new Date(n).getTime()||0}return o<=n.originalArrivalTime&&0===i.originalArrivalTime},Y=(e,t)=>{var n;if(!!e.threadProperties.isLastMessageFromMe)return!0;const i=null===(n=e.lastMessage)||void 0===n?void 0:n.from;if(!i)return!1;return t===(0,a.last)(i.split("/"))};const X=(e,t)=>{let n="";e.lastMessage&&((0,r.gs)(e.lastMessage)?n=function(e){let t="";if((0,r.gs)(e)&&e.content){const n=e.content.match(/<initiator>(.*?)<\/initiator>/i);n&&n[1]&&(t=n[1].trim())}return t}(e.lastMessage)||"":e.lastMessage.from&&(n=(0,a.last)(e.lastMessage.from.split("/"))||""));const i=J(e);return K(e)||-1!==n.indexOf(t)&&0===i.originalArrivalTime},Z=(e,t)=>(0,a.reduce)(e.members,((e,n)=>{const i=n.id;return i&&i!==t&&e.push(i),e}),[]),ee=(e,t,n)=>{let i;const o=!e.members||!!e.members&&(0,a.some)(e.members,(e=>!e));if(n&&!o){const a=Z(e,t);i=T(e)&&1===a.length?n[a[0]]:n[e.id]}return i},te=e=>{if(!e)throw new Error("Invalid conversation passed to topicName");if(e.threadProperties){if(N(e)){let t=e.threadProperties.topic;if(t&&-1!==t.indexOf(":")&&(t=void 0),!t&&(0,c.x)(e)){const n=(0,c.$n)(e);n&&(t=n)}return t}if(I(e)&&le(e)){const t=fe(e);if(t&&t.trim())return t}else{const t=e.threadProperties.topic,n=e.threadProperties[s.Q5.TopicThreadTopic];if(t&&t.trim())return t;if(n&&n.trim())return n}}return""},ne=(e,t=!1)=>N(e,!0)&&!ie(e,t),ie=(e,t=!1)=>{var n;const i=e.members&&e.members.length<=2;return N(e,!0)&&i&&(T(e)||se(e)||!t&&re(e)||ae(e))&&!(null===(n=e.members)||void 0===n?void 0:n.some((e=>(0,r.$i)(e.id))))},ae=e=>e.members&&e.members.length<=2&&oe(e)&&(e.type===s.i1.PhoneChat||e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===l.T.PhoneChat),oe=e=>(0,a.some)(e.members,(e=>!!e.id&&e.id.startsWith(s.at.Pstn))),re=e=>N(e,!0)&&e.members&&2===e.members.length&&!(0,a.isNil)(e.threadProperties)&&parseInt(e.threadProperties[s.Q5.CreatedAt],10)<s.Yv,se=e=>{var t,n;return!!e.id&&e.id.indexOf(s.B3)>-1||"true"===(null===(n=null===(t=e.threadProperties[s.Q5.P2PChatUniqueRosterThread])||void 0===t?void 0:t.toString())||void 0===n?void 0:n.toLowerCase())||_e(e)},le=e=>e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===l.T.Topic||j(e)||M(e),de=e=>ge(e&&e.id),ce=e=>(e=>(0,c.Jn)(e))(e)||(e=>ue(e))(e)||de(e),ue=e=>{const t=(0,a.isString)(e)?e:e.id;return(0,a.endsWith)(t,s.M9)||(0,a.endsWith)(t,s.IS)||(0,a.startsWith)(t,s.X2)},me=e=>ue(e)||we(e),ge=e=>!!e&&((0,a.endsWith)(e,s.RS)||(0,a.startsWith)(e,s.QV)),pe=e=>e===s.Z,he=e=>{const t=(0,a.endsWith)(e,s.M9)||(0,a.endsWith)(e,s.IS)||(0,a.startsWith)(e,s.X2),n=e.endsWith(s.GQ),i=ge(e);return t||n||i},ve=e=>{const t=H(e),n=t&&t<Date.now();return $(e)&&!n},Se=e=>{if(e.threadProperties&&e.threadProperties[s.Q5.Topics]){const t=e.threadProperties[s.Q5.Topics];if("["!==t.substr(0,1))return t.split("|").map((e=>({id:e,name:"Unknown"})));try{return JSON.parse(t)}catch(e){return[]}}return[]},fe=e=>{if(e.threadProperties){if(e.threadProperties[s.Q5.XTeamName])return e.threadProperties[s.Q5.XTeamName];if(e.type===s.i1.Team&&e.threadProperties.topic)return e.threadProperties.topic}},ye=e=>{const t=Se(e),n=fe(e);return t.map((t=>{const i={},a=t.name;return i[s.Q5.CreatedAt]=parseInt(t.createdat,10),i[s.Q5.Picture]=t.picture,i[s.Q5.IsDeleted]=t.isdeleted,i[s.Q5.XTeamName]=t.isShared?a:n,i.topic=a,i[s.Q5.TopicThreadTopic]=a,{threadProperties:i,id:t.id,members:[],messages:"",properties:{},version:0,type:s.i1.Topic,threadVersion:0,detailsVersion:-1,oldConsumptionHorizonKeys:[],teamId:e.id,lastMessageTimeUtc:0,isPending:void 0,memberProperties:{},mruEvictedTime:0,rosterVersion:0,rosterSummary:void 0,botMembers:[],lastSeenSkipRosterState:void 0,lastMessage:void 0,localClientId:"",isUserMember:!1,source:e.source}}))},ke=e=>{if(e.parentId)return e.parentId;if((0,c.re)(e))try{const t=JSON.parse(e.threadProperties[s.Q5.ParentSpaces]),n=t.linkedSpaceInfoItems[0].spaceThreadId;if(!(0,a.isEmpty)(n))return n}catch(e){return}},Ce=e=>{const t=e.threadProperties&&e.threadProperties[s.Q5.SpaceId];return(w(e)?e.id:(0,c.re)(e)?ke(e):t)||e.teamId},be=e=>{var t;const n=e.properties?null===(t=e.properties[s.Ff.Alerts])||void 0===t?void 0:t.trim().toLowerCase():void 0;return"true"!==n&&("false"===n||void 0)},Te=e=>e.threadProperties&&((0,a.isBoolean)(e.threadProperties[s.Q5.GapDetectionEnabled])?e.threadProperties[s.Q5.GapDetectionEnabled]:"true"===(0,a.lowerCase)(e.threadProperties[s.Q5.GapDetectionEnabled])),we=e=>{const t=Ae(e);return t&&!ue(e)&&ie(e)&&(0,a.some)(e.members,(e=>e.tenantId&&e.tenantId!==t))||Ie(e.id)||Ie(e.localClientId||"")},_e=e=>{var t,n;return!(0,a.isNil)(e.threadProperties)&&(e.threadProperties[s.Q5.TemplateType]===s.Q5.ImmutableRoster||"true"===(null===(n=null===(t=e.threadProperties[s.Q5.IsStickyThread])||void 0===t?void 0:t.toString())||void 0===n?void 0:n.toLowerCase()))},Ie=e=>(0,a.startsWith)(e,s.At),Ae=e=>e.threadProperties&&e.threadProperties[s.Q5.TenantId],Ne=e=>{const t=w(e)&&e.threadProperties[s.Q5.ArchivalLevel]&&e.threadProperties[s.Q5.ArchivalLevel].toLowerCase()===s.C8.Space.toLowerCase(),n=P(e)&&e.threadProperties[s.Q5.ArchivalLevel]&&e.threadProperties[s.Q5.ArchivalLevel].toLowerCase()===s.C8.Topic.toLowerCase();return t||n},Ee=e=>function(e){if(!e.properties)return!1;return function(e){if(!e)return 0;const t=new Date(e),n=t?t.getTime():0;return isNaN(n)?0:n}(e.properties[s.Ff.LastImportantImTime])>Number(De(e).originalArrivalTime)}(e),De=e=>(0,a.isEmpty)(e.properties&&e.properties[s.Ff.ConsumptionHorizonBookmark])?q(e):J(e);const Fe=e=>{if(!e||!e.properties)return!1;const t=e.properties[s.Ff.isPinned];return!!t&&("boolean"==typeof t?t:"string"==typeof t&&"true"===t.toLowerCase())},Pe=e=>{var t;const n=null===(t=e.memberProperties)||void 0===t?void 0:t[s.e0.RelationshipState];return!!(null==n?void 0:n.inQuarantine)},Me=e=>{var t;const n=null===(t=e.memberProperties)||void 0===t?void 0:t[s.e0.RelationshipState];return"number"==typeof(null==n?void 0:n.quarantineCounter)?null==n?void 0:n.quarantineCounter:0},je=e=>{var t;return!!(null===(t=e.memberProperties)||void 0===t?void 0:t[s.e0.ExplicitlyAdded])}},59193:(e,t,n)=>{"use strict";var i;n.d(t,{U:()=>i,$:()=>a}),function(e){e.feed="TeamsFeed",e.syncFeed="TeamsFeedSync"}(i||(i={}));const a={defaultSection:"TeamsFeed",defaultTimeSortedSection:"TeamsFeedTimeSorted",defaultItemsToFetch:3,defaultLoadMoreItemsCount:5,defaultItemsToCompare:3,defaultReadSignalMinDwellTime:5e3,defaultDataSyncIntervalTime:3e5,defaultDiscoverTriagingTime:3e5}},29289:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{m1:()=>i,Wp:()=>a,zd:()=>o}),function(e){e[e.Success=0]="Success",e[e.Success_NoChanges=1]="Success_NoChanges",e[e.Abandoned_ClientVeryActive=2]="Abandoned_ClientVeryActive",e[e.Abandoned_NoNetwork=3]="Abandoned_NoNetwork",e[e.Error_TimedOut=4]="Error_TimedOut",e[e.Error_TransformFailed=5]="Error_TransformFailed",e[e.Error_BrowserError=6]="Error_BrowserError",e[e.Error_Unknown=7]="Error_Unknown",e[e.NotStarted=8]="NotStarted"}(i||(i={})),function(e){e[e.AbortWhenVeryActive=0]="AbortWhenVeryActive",e[e.ContinueWhenVeryActive=1]="ContinueWhenVeryActive"}(a||(a={})),function(e){e[e.Manual=0]="Manual",e[e.FixedInterval=1]="FixedInterval",e[e.WhenExpired=2]="WhenExpired"}(o||(o={}))},91073:(e,t,n)=>{"use strict";n.d(t,{X:()=>C});var i=n(13637),a=n(21580),o=n(52397),r=n(29289),s=n(24211),l=n(20448),d=n(55997),c=n(34255);const u="MicrosoftTeams",m="https://config.teams.microsoft.com",g="1.0.0.0",p={audienceGroup:"general",environment:"prod"},h=(e,t)=>Promise.resolve({constructRequest:(t,n,i)=>({apiName:"getConfiguration",url:e,method:"GET",headers:i?Object.assign({"If-None-Match":i}):void 0,correlationId:t}),customTelemetry:S,transformResponse:f(t),allowedResponses:[d.qb.OK,d.qb.NOT_MODIFIED,d.qb.CREATED,d.qb.NO_CONTENT]});function v(e,t){const n=function(e){const t=e.client||u;return`${e.hostUrl||m}/config/v1/${t}/`}(e),i=function(e){const t=e.platformId||1415,n=e.version||g;e.filters=e.filters?e.filters:p;const i=[];if((0,c.forOwn)(e.filters,((e,t)=>{e&&i.push(`${t}=${e}`)})),e.namespaces){const t=e.namespaces.join(",");i.push(`agents=${t}`)}else i.push("agents=TeamsNorthstar,Segmentation");const a=`?${i.join("&")}`;return`${t}_${n}${a}`}(e);return{endpointUrl:`${n}${i}`,endpointModels:()=>({baseUrl:n,serviceName:l.EJ.ECS,models:{getConfiguration:h(i,t)}})}}function S(e,t,n){return JSON.stringify({correlationId:e,serviceName:t,eTag:n,initialFetch:void 0===n})}const f=e=>t=>(0,i.mG)(void 0,void 0,void 0,(function*(){var n,i;switch(e.debug(`Response headers: ${JSON.stringify(t.headers)}`),t.status){case d.qb.OK:const e=yield t.body.json(),a=null!==(n=t.headers.expires)&&void 0!==n?n:e.Headers.Expires,o=null!==(i=t.headers.etag)&&void 0!==i?i:e.Headers.ETag;return{requestStatus:r.m1.Success,ecsConfiguration:e,headers:y(a,o)};case d.qb.NOT_MODIFIED:case d.qb.CREATED:case d.qb.NO_CONTENT:return{requestStatus:r.m1.Success_NoChanges,headers:y(t.headers.expires,t.headers.etag)};default:throw new Error(`Response status ${t.status} unexpectedly allowed`)}})),y=(e,t)=>{let n=Date.parse(e);if(isNaN(n)){const t=e.match(/\d+/g);if(t&&1===t.length&&(n=Number.parseInt(e,10)),isNaN(n))throw new Error(`Invalid or missing expiration date: '${e}'`)}if(!t)throw new Error("Missing etag value");return{ETag:t,Expires:new Date(n)}},k=18e5;class C{constructor(e,t,n,i,a,o,s,l=r.Wp.AbortWhenVeryActive){this.serviceName=t,this.endpointsManager=n,this.host=i,this.clientStateProvider=o,this.networkStateProvider=s,this.clientVeryActiveMode=l,this.fetchMode=r.zd.Manual,this.logger=a.newLogger(`EcsClient_${this.serviceName}`);const{endpointUrl:d,endpointModels:c}=v(e,this.logger);this.fetchUrl=d,this.ecsApi=this.endpointsManager.createApi(c)}updateParameters(e){const t=this.fetchUrl,{endpointUrl:n,endpointModels:i}=v(e,this.logger);return this.fetchUrl=n,this.ecsApi=this.endpointsManager.createApi(i),t!==this.fetchUrl}getDiagnosticInfo(){return{configIds:this.configIds,etag:this.eTag,fetchUrl:this.fetchUrl,lastAttemptedFetch:this.lastAttemptedFetch,lastSuccessfulFetch:this.lastSuccessfulFetch,nextScheduledFetch:this.nextScheduledFetch,clientVeryActiveMode:this.clientVeryActiveMode,fetchMode:this.fetchMode,fixedFetchIntervalInMinutes:this.fixedFetchIntervalInMinutes,expirationTime:this.expirationTime}}getConfigurationAsync(){return(0,i.mG)(this,void 0,void 0,(function*(){let e={requestStatus:r.m1.NotStarted};const t=void 0===this.eTag,n=(0,s.v4)();if(this.lastAttemptedFetch=new Date,this.validateEnvironment(e,n)){this.logger.log(`Getting ECS configuration from ${this.fetchUrl}. correlationId=${n}, isInitialFetch=${t}`);try{e=yield this.ecsApi.getConfiguration(n,this.serviceName,this.eTag),this.onSuccess(e,n)}catch(t){this.onError(t,e,n)}this.logger.log(`ECS configuration fetch complete. status=${r.m1[e.requestStatus]}, correlationId=${n}, isInitialFetch=${t}`)}return this.scheduleNextConfigurationFetch(),e}))}startFixedIntervalFetchSchedule(e,t){this.fixedFetchIntervalInMinutes=t,this.callbackFunction=e,this.fetchMode=r.zd.FixedInterval,this.logger.debug(`Starting ECS configuration fetch schedule in FixedInterval mode. IntervalInMinutes=${t}`),this.scheduleNextConfigurationFetch()}startWhenExpiredFetchSchedule(e,t){t&&(this.expirationTime=t),this.callbackFunction=e,this.fetchMode=r.zd.WhenExpired,this.logger.debug(`Starting ECS configuration fetch schedule in WhenExpired mode. InitialExpirationTime=${t}`),this.scheduleNextConfigurationFetch()}stopFetchSchedule(){this.fetchMode=r.zd.Manual,this.clearConfigurationFetchSchedule()}validateEnvironment(e,t){var n;return this.networkStateProvider&&!this.networkStateProvider.isOnline()?(this.logger.debug(`Skipping ECS configuration fetch due to app being offline. correlationId=${t}`),e.requestStatus=r.m1.Abandoned_NoNetwork,!1):this.clientVeryActiveMode!==r.Wp.AbortWhenVeryActive||(null===(n=this.clientStateProvider)||void 0===n?void 0:n.getState())!==a.pk.VeryActive||(this.logger.debug(`Skipping ECS configuration fetch due to app being in a very active state. correlationId=${t}`),e.requestStatus=r.m1.Abandoned_ClientVeryActive,!1)}onSuccess(e,t){try{switch(e.requestStatus){case r.m1.Success:if(!e.ecsConfiguration)throw new Error("ECS configuration is unexpectedly undefined on a successful response");if(!e.headers)throw new Error("Headers object is unexpectedly undefined on a successful response");this.eTag=e.headers.ETag,this.expirationTime=e.headers.Expires,this.configIds=e.ecsConfiguration.ConfigIDs;break;case r.m1.Success_NoChanges:if(!e.headers)throw new Error("Headers object is unexpectedly undefined on a successful response");this.eTag=e.headers.ETag,this.expirationTime=e.headers.Expires,this.logger.debug(`ECS configuration is unchanged. eTag=${this.eTag}, correlationId=${t}`);break;default:throw new Error(`Received unexpected request status of ${r.m1[e.requestStatus]}`)}}catch(t){throw e.requestStatus=r.m1.Error_Unknown,t}this.lastSuccessfulFetch=this.lastAttemptedFetch}onError(e,t,n){var i,a;const s=this.processErrorText(e,"unknown error");switch(t.errorMessage=s,null==e?void 0:e.reason){case o.A.TimedOut:t.requestStatus=r.m1.Error_TimedOut;break;case o.A.TransformFailed:t.requestStatus=r.m1.Error_TransformFailed;break;default:(null==e?void 0:e.reason)===o.A.RejectHttpError&&void 0===(null===(i=null==e?void 0:e.serverResponse)||void 0===i?void 0:i.status)?t.requestStatus=r.m1.Error_BrowserError:t.requestStatus=r.m1.Error_Unknown}this.logger.error(`Fetching ECS configuration failed. error=${e}, innerExceptionMessage=${null===(a=e.innerException)||void 0===a?void 0:a.message} correlationId=${n}`)}processErrorText(e,t){var n;let i=t;return e&&(i=(null===(n=Object.keys(e))||void 0===n?void 0:n.length)>0?JSON.stringify(e):e.message,e.innerException&&(i+=` innerExceptionMessage: ${e.innerException.message}`)),i}clearConfigurationFetchSchedule(){this.setTimeoutHandle&&(this.host.clearTimeout(this.setTimeoutHandle),this.setTimeoutHandle=void 0,this.logger.debug("Cleared existing queued configuration fetch"))}scheduleNextConfigurationFetch(){if(this.clearConfigurationFetchSchedule(),this.fetchMode===r.zd.Manual)return void this.logger.debug("No need to queue configuration fetch in manual mode, ignoring...");const e=this.calculateFetchInterval();this.setTimeoutHandle=this.host.setTimeout((()=>(0,i.mG)(this,void 0,void 0,(function*(){const e=yield this.getConfigurationAsync();this.callbackFunction&&this.callbackFunction(e)}))),e),this.nextScheduledFetch=new Date(Date.now()+e),this.logger.debug(`Next ECS configuration fetch will occur in ${e}ms at ${this.nextScheduledFetch}`)}calculateFetchInterval(){var e;switch(this.fetchMode){case r.zd.FixedInterval:const t=void 0===this.fixedFetchIntervalInMinutes?C.DefaultRefreshIntervalInMilliseconds:6e4*this.fixedFetchIntervalInMinutes;return t<C.MinimumFixedRefreshIntervalInMilliseconds?(this.logger.warn(`Specified fixed fetch interval of ${t}ms was less than the allowed minimum of ${C.MinimumFixedRefreshIntervalInMilliseconds}ms. Minimum value will be used instead.`),C.MinimumFixedRefreshIntervalInMilliseconds):t;case r.zd.WhenExpired:const n=(null!==(e=this.expirationTime)&&void 0!==e?e:new Date).valueOf()-Date.now();return n<C.MinimumExpiredRefreshIntervalInMilliseconds?(this.logger.warn(`Calculated refresh interval of ${n}ms based on expires header was below the allowed minimum of ${C.MinimumExpiredRefreshIntervalInMilliseconds}ms. Minimum value will be used instead.`),C.MinimumExpiredRefreshIntervalInMilliseconds):n;default:throw new Error(`Calculating fetch interval is not supported when using ${r.zd[this.fetchMode]} fetch mode.`)}}}C.MinimumFixedRefreshIntervalInMilliseconds=6e4,C.MinimumExpiredRefreshIntervalInMilliseconds=k,C.DefaultRefreshIntervalInMilliseconds=k},18402:(e,t,n)=>{"use strict";var i,a;n.d(t,{$:()=>i,f:()=>a}),function(e){e.Locked="Locked",e.Unlocked="Unlocked",e.Unknown="Unknown",e.Resumed="Resumed",e.Suspending="Suspending"}(i||(i={})),function(e){e.Light="Light",e.Dark="Dark",e.Contrast="Contrast",e.OSTheme="OSTheme"}(a||(a={}))},57153:(e,t,n)=>{"use strict";var i;n.d(t,{$:()=>i}),function(e){e.None="none",e.DayStart="dayStart",e.MeetingPrep="meetingPrep",e.MeetingStart="meetingStart",e.MeetingStarted="meetingStarted",e.MeetingEnd="meetingEnd",e.Feedback="feedback",e.InMeetingActionStatusUpdated="inMeetingActionStatusUpdated",e.InMeetingGreeting="inMeetingGreeting",e.InMeetingShareFile="inMeetingShareFile",e.RunningLate="inMeetingRunningLate",e.ReportUsage="reportUsage"}(i||(i={}))},25402:(e,t,n)=>{"use strict";n.d(t,{$:()=>u,A:()=>v});var i=n(6766),a=n(20448),o=n(55997),r=n(3984),s=n(78091),l=n(50396),d=n(38923),c=n(75068);const u=({discover:e,authenticationResources:t,platformService:n,config:o})=>{const s=(0,r.h)(n,o);return{baseUrlPromise:()=>e.regionGtm(i.Pn.middleTier),serviceName:a.EJ.MiddleTier,authResource:t.mtAuthResource,models:{searchUsers:m(s),getUsersFromInstantScd:g(s),getUsersFromSMSThreads:h(s),getUsersFromSearchUsers:p(s),getUsersExternally:S(s)}}},m=e=>Promise.resolve({constructRequest:(t,n,i)=>({url:n,method:"POST",headers:Object.assign(Object.assign({},e),{"Content-Type":"application/json;charset=UTF-8",Accept:"application/json"}),body:t,apiName:i}),allowedResponses:[o.qj.HTTP_2XX],transformResponse:e=>e.body.json().then((e=>e.value))}),g=e=>Promise.resolve({constructRequest:(t,n,i)=>({url:"beta/scd/lookup",method:"POST",body:JSON.stringify({emails:t,phones:n}),headers:Object.assign(Object.assign({},e),{"Content-Type":"application/json;charset=UTF-8",Accept:"application/json","x-ms-client-caller":i}),apiName:l.l.InstantScdSearchJob.toString()}),allowedResponses:[o.qj.HTTP_2XX],transformResponse:e=>e.body.json().then((e=>e.value))}),p=e=>Promise.resolve({constructRequest:(t,n,i)=>({url:"beta/users/searchUsers",method:"POST",body:JSON.stringify({emails:t,phones:n}),headers:Object.assign(Object.assign({},e),{"Content-Type":"application/json;charset=UTF-8",Accept:"application/json","x-ms-client-caller":i}),apiName:l.l.SearchUsersJob.toString()}),allowedResponses:[o.qj.HTTP_2XX],transformResponse:e=>v(e)}),h=e=>Promise.resolve({constructRequest:(t,n)=>({url:"beta/users/me/lookup/phones",method:"POST",body:JSON.stringify({phones:t}),headers:Object.assign(Object.assign({},e),{"Content-Type":"application/json;charset=UTF-8",Accept:"application/json","x-ms-client-caller":n}),apiName:l.l.SMSThreadSearchJob.toString()}),transformResponse:e=>e.body.json().then((e=>e.results))}),v=e=>{const t=[];return e.body.json().then((e=>(Object.keys(e).forEach((n=>{const i=e[n],a=i.status.toLowerCase();if(a!==s.iu.success&&a!==s.iu.notFound){const e=a===s.iu.notAllowed;throw(0,d.Tr)("PeoplePickerEndpoint",c.jK.FailedToFetch,"getUsersFromSearchUsers",void 0,`Error in finding a user with MT response status code ${a}`,void 0,e)}t.push(...i.userProfiles)})),t)))},S=e=>Promise.resolve({constructRequest:(t,n,i,a)=>({url:i=i.replace("{searchQuery}",t),method:"GET",headers:Object.assign(Object.assign({},e),{"Content-Type":"application/json;charset=UTF-8",Accept:"application/json","x-ms-client-caller":n}),apiName:a}),allowedResponses:[o.qj.HTTP_2XX],transformResponse:e=>e.body.json()})},50396:(e,t,n)=>{"use strict";var i;n.d(t,{l:()=>i}),function(e){e.InstantScdSearchJob="instantScdSearch",e.SMSThreadSearchJob="SMSThreadSearch",e.SearchUsersJob="SearchUsers",e.SearchExternalV3Job="SearchExternalV3",e.XTapSearchJob="xTapSearch",e.SearchV2="SearchV2"}(i||(i={}))},10792:(e,t,n)=>{"use strict";n.d(t,{Y:()=>d});var i=n(13637),a=n(31821),o=n(55997),r=n(20448),s=n(25402),l=n(31583);const d=(e,t,n)=>{const{enableEndpointsManagerOnPeoplePickerService:i}=t.get(a.J.People);return n&&i?c(n):u(e)},c=e=>e.createApi(s.$),u=e=>({searchUsers:m(e),getUsersFromInstantScd:g(e),getUsersFromSMSThreads:h(e),getUsersFromSearchUsers:p(e),getUsersExternally:v(e)}),m=e=>(t,n,a)=>(0,i.mG)(void 0,void 0,void 0,(function*(){return y(e,t,n,"",a,void 0,o.qj.HTTP_2XX)})),g=e=>(t,n,i,a,o)=>{const r=JSON.stringify({emails:t,phones:n});return y(e,r,a,i,o)},p=e=>(t,n,i,a,o)=>{const r=JSON.stringify({emails:t,phones:n});return k(e,r,a,i,o)},h=e=>(t,n,i,a)=>{const o=JSON.stringify({phones:t});return y(e,o,i,n,a)},v=e=>(t,n,a,r)=>(0,i.mG)(void 0,void 0,void 0,(function*(){a=a.replace("{searchQuery}",t);const i=yield f(e,a,r,o.qj.HTTP_2XX,n);return S(i)})),S=e=>e.body.json().then((e=>e)).catch((e=>Promise.reject(e))),f=(e,t,n,i,a)=>(0,l.B)(e,i)({url:t,method:"GET",headers:{"content-type":"application/json","x-ms-client-caller":a},serviceName:r.EJ.MiddleTier,apiName:n}),y=(e,t,n,i,a,o={},s)=>(s?(0,l.B)(e,s):e)({url:n,method:"POST",body:t,headers:Object.assign({"Content-Type":"application/json;charset=UTF-8",Accept:"application/json","x-ms-client-caller":i},o),serviceName:r.EJ.MiddleTier,apiName:a}).then((e=>e.body.json())).then((e=>e.value)),k=(e,t,n,i,a,o={})=>e({url:n,method:"POST",body:t,headers:Object.assign({"Content-Type":"application/json;charset=UTF-8",Accept:"application/json","x-ms-client-caller":i},o),serviceName:r.EJ.MiddleTier,apiName:a}).then((e=>(0,s.A)(e)))},41177:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{TS:()=>i,Cb:()=>a,H8:()=>o,zt:()=>r,GM:()=>s,rh:()=>l,Tj:()=>d}),function(e){e.addToCall="addToCall",e.addToChat="addToChat",e.addToMeeting="addToMeeting",e.addToMeetingForSharedChannel="addToMeetingForSharedChannel",e.addToSpeedDialOrContacts="addToSpeedDialOrContacts",e.addToTeam="addToTeam",e.atMention="atMention",e.callForwardGroupSelection="callForwardGroupSelection",e.calendarPeoplePicker="calendarPeoplePicker",e.callRouting="callToRouting",e.delegationSelection="delegationSelection",e.meetingSchedule="meetingSchedule",e.newChat="newChat",e.orgChart="orgChart",e.presenceSettings="presenceSettings",e.priorityContactsSelection="priorityContactsSelection",e.searchResults="searchResults",e.searchPeopleFilter="searchPeopleFilter",e.searchSuggestions="searchSuggestions",e.shareToTeams="shareToTeams",e.taggedContactsSelection="taggedContactSelection",e.transfer="transfer",e.escalateMessage="escalateMessage",e.allFalse="allFalse",e.allTrue="allTrue",e.meetingRoomCall="meetingRoomCall",e.custom="custom"}(i||(i={})),function(e){e.AADTenant="AADTenant",e.Bot="Bot",e.CallQandAA="CallQandAA",e.DisabledUser="DisabledUser",e.DL="DL",e.Federated="Federated",e.FederatedConsumer="FederatedConsumer",e.Guest="Guest",e.ModernGroup="ModernGroup",e.PersonalContact="PersonalContact",e.Pstn="Pstn",e.Room="Room",e.UserDefinedGroup="UserDefinedGroup",e.TeamTags="TeamTags",e.PstnNonE164="PstnNonE164",e.LetterMapNumbers="LetterMapNumbers",e.GroupChats="GroupChats",e.Meetings="Meetings",e.Xtap="Xtap",e.TflOffNetworkEmails="TflOffNetworkEmails",e.TflOffNetworkPhones="TflOffNetworkPhones",e.TflConsumer="TflConsumer",e.TflSmsName="TflSmsName",e.ImplicitContacts="ImplicitContacts",e.ExtendedDirectoryUsers="ExtendedDirectoryUsers",e.MTOUsers="MTOUsers"}(a||(a={})),function(e){e.AAD="AAD",e.IndexedDb="IndexedDB",e.MiddleTier="MT",e.Substrate="3S",e.TopNCache="TopNCache",e.Memory="Memory",e.TFLZeroState="TFLZeroState"}(o||(o={}));const r={IDBFedBot:"IDB-FedBot",IDBPeopleGroup:"IDB-PeopleGroup",TeamTag:"TeamTag",Memory:"Memory",MT:"MT"},s={EntityActionTaken:"EntityActionTaken",EntityClicked:"EntityClicked",MouseHover:"MouseHover"},l={OpenContactCard:"OpenContactCard",Remove:"Remove"},d={Vertical:"vertical"}},36007:(e,t,n)=>{"use strict";n.d(t,{a:()=>m,B:()=>u});var i=n(41177);const a=[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.PersonalContact,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA,i.Cb.Room,i.Cb.TeamTags,i.Cb.GroupChats,i.Cb.Xtap,i.Cb.TflOffNetworkEmails,i.Cb.TflOffNetworkPhones,i.Cb.TflConsumer,i.Cb.ImplicitContacts],o=[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA,i.Cb.Room,i.Cb.TeamTags,i.Cb.GroupChats,i.Cb.Xtap,i.Cb.TflOffNetworkEmails,i.Cb.TflOffNetworkPhones,i.Cb.TflConsumer,i.Cb.ImplicitContacts],r=[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA,i.Cb.Room,i.Cb.TeamTags,i.Cb.GroupChats,i.Cb.Xtap,i.Cb.TflOffNetworkEmails,i.Cb.TflOffNetworkPhones,i.Cb.TflConsumer,i.Cb.ImplicitContacts],s=[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA,i.Cb.Room,i.Cb.GroupChats,i.Cb.Xtap,i.Cb.Meetings,i.Cb.TflSmsName],l=(i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.PersonalContact,i.Cb.UserDefinedGroup,i.Cb.Pstn,{[i.TS.callForwardGroupSelection]:[i.Cb.AADTenant,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.allTrue]:a,[i.TS.meetingRoomCall]:o,[i.TS.searchSuggestions]:s,[i.TS.addToMeetingForSharedChannel]:r,[i.TS.calendarPeoplePicker]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.DisabledUser,i.Cb.PersonalContact,i.Cb.ModernGroup,i.Cb.DL],[i.TS.searchResults]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.addToTeam]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.Pstn],[i.TS.newChat]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.TeamTags,i.Cb.Room,i.Cb.TflSmsName,i.Cb.ExtendedDirectoryUsers],[i.TS.transfer]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.addToCall]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.UserDefinedGroup,i.Cb.Pstn],[i.TS.addToChat]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.DisabledUser,i.Cb.TeamTags,i.Cb.Room],[i.TS.searchPeopleFilter]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.Pstn,i.Cb.TeamTags],[i.TS.callRouting]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.delegationSelection]:[i.Cb.AADTenant],[i.TS.presenceSettings]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Pstn],[i.TS.addToMeeting]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn],[i.TS.meetingSchedule]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.DL,i.Cb.ModernGroup,i.Cb.Pstn],[i.TS.addToSpeedDialOrContacts]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.atMention]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Bot,i.Cb.Pstn],[i.TS.orgChart]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Pstn],[i.TS.priorityContactsSelection]:[i.Cb.AADTenant,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Pstn],[i.TS.taggedContactsSelection]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.DL],[i.TS.shareToTeams]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.DisabledUser,i.Cb.UserDefinedGroup],[i.TS.escalateMessage]:[i.Cb.AADTenant],[i.TS.allFalse]:[],[i.TS.custom]:[]});var d=n(34255);const c=(e,t)=>(0,d.flatten)(e.filter((([e,n])=>e===t)).map((([e,t])=>t))),u={[i.H8.Substrate]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.GroupChats,i.Cb.DL,i.Cb.ModernGroup,i.Cb.Room,i.Cb.ExtendedDirectoryUsers,i.Cb.PersonalContact,i.Cb.MTOUsers],[i.H8.AAD]:[i.Cb.Guest],[i.H8.IndexedDb]:[i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.Pstn],[i.H8.MiddleTier]:[],[i.H8.TopNCache]:[],[i.H8.Memory]:[],[i.H8.TFLZeroState]:[]};class m{constructor(e,t){this.includeFeatures=e,this.name=t,this.includeAADTenant=!1,this.includeGuest=!1,this.includeFederated=!1,this.includeFederatedConsumer=!1,this.includeBot=!1,this.includeDisabledUser=!1,this.includeDL=!1,this.includeModernGroup=!1,this.includePersonalContact=!1,this.includeUserDefinedGroup=!1,this.includePstn=!1,this.includeCallQandAA=!1,this.includeRoom=!1,this.includeTeamTags=!1,this.includeGroupChats=!1,this.includeMeetingChats=!1,this.includeXtap=!1,this.includeOffNetworkEmails=!1,this.includeOffNetworkPhones=!1,this.includeTflConsumer=!1,this.includeTflSmsName=!1,this.includeImplicitContacts=!1,this.includeExtendedDirectoryUsers=!1,this.includeMTOUsers=!1,this.includeAADTenant=(0,d.includes)(e,i.Cb.AADTenant),this.includeGuest=(0,d.includes)(e,i.Cb.Guest),this.includeFederated=(0,d.includes)(e,i.Cb.Federated),this.includeFederatedConsumer=(0,d.includes)(e,i.Cb.FederatedConsumer),this.includeBot=(0,d.includes)(e,i.Cb.Bot),this.includeDisabledUser=(0,d.includes)(e,i.Cb.DisabledUser),this.includeDL=(0,d.includes)(e,i.Cb.DL),this.includeModernGroup=(0,d.includes)(e,i.Cb.ModernGroup),this.includePersonalContact=(0,d.includes)(e,i.Cb.PersonalContact),this.includeUserDefinedGroup=(0,d.includes)(e,i.Cb.UserDefinedGroup),this.includePstn=(0,d.includes)(e,i.Cb.Pstn),this.includeCallQandAA=(0,d.includes)(e,i.Cb.CallQandAA),this.includeRoom=(0,d.includes)(e,i.Cb.Room),this.includeTeamTags=(0,d.includes)(e,i.Cb.TeamTags),this.includeGroupChats=(0,d.includes)(e,i.Cb.GroupChats),this.includeMeetingChats=(0,d.includes)(e,i.Cb.Meetings),this.includeXtap=(0,d.includes)(e,i.Cb.Xtap),this.includeOffNetworkEmails=(0,d.includes)(e,i.Cb.TflOffNetworkEmails),this.includeOffNetworkPhones=(0,d.includes)(e,i.Cb.TflOffNetworkPhones),this.includeTflConsumer=(0,d.includes)(e,i.Cb.TflConsumer),this.includeTflSmsName=(0,d.includes)(e,i.Cb.TflSmsName),this.includeImplicitContacts=(0,d.includes)(e,i.Cb.ImplicitContacts),this.includeExtendedDirectoryUsers=(0,d.includes)(e,i.Cb.ExtendedDirectoryUsers),this.includeMTOUsers=(0,d.includes)(e,i.Cb.MTOUsers)}}m.fromName=(e,t=[])=>{if(!(e in l))throw new TypeError("Invalid `name` attribute passed. Please make sure it exists in PEOPLE_FILTER_NAME_CONFIG.");const n=c(t,!0),i=c(t,!1),a=d.without.apply(null,[(0,d.concat)(l[e],n),...i]);return new m(a,e)},m.createFrom=(e,t,n)=>new m(t||e.includeFeatures,n||e.name),m.includesAll=(e,t)=>(0,d.every)(t,(t=>(0,d.includes)(e.includeFeatures,t))),m.includesAny=(e,t)=>(0,d.some)(t,(t=>(0,d.includes)(e.includeFeatures,t)))},78091:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{WH:()=>i,xd:()=>a,$D:()=>o,Zh:()=>r,z_:()=>s,Ei:()=>l,iu:()=>d,UJ:()=>c,Je:()=>u,IE:()=>m}),function(e){e.ConsumerUser="ConsumerUser",e.NotFound="NotFound",e.Success="Success"}(i||(i={})),function(e){e[e.CoreScenario=0]="CoreScenario",e[e.DialToneScenario=1]="DialToneScenario",e[e.BackgroundTask=2]="BackgroundTask"}(a||(a={})),function(e){e.XSmall="HR32x32",e.Small="HR64x64",e.Medium="HR96x96",e.XMedium="HR120x120",e.Large="HR196x196"}(o||(o={}));const r=["Large","XMedium","Medium","Small","XSmall"];var s,l,d,c,u;!function(e){e.Mobile="Mobile",e.Business="Business",e.Home="Home",e.Other="Other"}(s||(s={})),function(e){e.Private="Private",e.Public="Public"}(l||(l={})),function(e){e.success="success",e.invalid="invalid",e.inTenantUser="intenantuser",e.consumerUser="consumeruser",e.notFound="notfound",e.notAllowed="notallowed",e.failed="failed",e.missingResponse="missingresponse",e.backendrequestfailed="backendrequestfailed"}(d||(d={})),function(e){e.UpdateMSASearchabilityStamping="updateMSASearchabilityStamping",e.UpdateMsaAliasVisibilitySetting="updateMsaAliasVisibilitySetting",e.GetPeopleProfilesByMris="getPeopleProfilesByMris",e.GetFederatedPeopleProfilesByMris="getFederatedPeopleProfilesByMris",e.GetPeopleProfilesByEmails="getPeopleProfilesByEmails",e.GetFederatedPeopleProfilesByEmails="getFederatedPeopleProfilesByEmails",e.GetMeProfile="getMeProfile",e.GetOfficeGroup="getOfficeGroup",e.GetUser="getUser",e.FetchAllUsersByMrisInSharedChannel="people_get_all_users_sharedChannel",e.FetchAllUsersByMrisInSharedChannelBatch="people_get_users_sharedChannel_batch",e.UpdateMsaUserName="update_msa_profile_displayname",e.UpdateMsaProfileAvatar="update_msa_profile_avatar",e.removeSelfProfilePicture="remove_msa_profile_picture",e.UpdateGroupProfileAvatar="update_group_profile_avatar",e.DeleteGroupProfileAvatar="delete-group-profile-avatar",e.GetTflConsumerProfilesByMris="getTflConsumerProfilesByMris",e.GetSkypeConsumerProfilesByMris="getSkypeConsumerProfilesByMris",e.FetchWorkingSet="fetchWorkingSet"}(c||(c={})),function(e){e.GET="GET",e.POST="POST",e.PATCH="PATCH",e.PUT="PUT",e.DELETE="DELETE"}(u||(u={}));const m=["displayName","imageUri"]},86631:(e,t,n)=>{"use strict";n.d(t,{MD:()=>i,t:()=>a,vf:()=>o,cT:()=>r});const i={saveUnknownUser:"unknown_user_profile_generated",unknownUserFromDB:"unknown_user_from_index_db"},a={botType:"BOT"},o={member:"Member",guest:"Guest",anonymousUser:"AnonymousUser",voiceApp:"ADVoiceApp",DistributionList:"Group",Bot:"Bot",person:"Person",federated:"Federated",skypeConsumer:"SkypeConsumer",tflUser:"TFLUser",tflOffNetwork:"TFLOffNetwork",personalContactUser:"PersonalContactUser",tflConsumer:"TflConsumer",pstn:"pstn",extendedDirectoryUser:"EDUser",PendingOrgContact:"PendingOrgContact",OrgContact:"OrgContact",MTOUser:"MTOUser"},r={showWarningBannerMinimumThreshold:20,type:{team:"team",channel:"channel",person:"person",webhook:"webhook",bot:"BOT",addABot:"addABot",app:"app"},hintElement:"ts-hint"}},79058:(e,t,n)=>{"use strict";n.d(t,{M:()=>u,T0:()=>p,wo:()=>S,DS:()=>f,Im:()=>y,S4:()=>k,$V:()=>C,eo:()=>b});var i=n(13637),a=n(41177),o=n(31821),r=n(54808),s=n(86631),l=n(57078),d=n(34255),c=n(36007);const u="unknown_email_address@invalid.teams.ms",m=l.Xg*l.A_*16,g=2*l.Yx*l.Ix*l.Xg*l.A_,p="4:",h="8:tfloffnetwork:",v="50:sms:",S="50:smsunverified:",f="unknown user",y="8:teamsvisitor:",k="8:guest:",C="TflContacts";class b{static isUnknownUser(e){return e.email===u||"unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com"===e.email}static getUnknownUserEmail(){return u}static getRequestCount(e){return e&&e.requestCount||e.$$requestCount||0}static sanitizeUserProfileObject(e){if(!e)throw new Error("Invalid user profile object passed");const t=Object.assign({isSelf:void 0,managerLevel:void 0},e),{isSelf:n,managerLevel:a,userClassification:o}=t;return(0,i._T)(t,["isSelf","managerLevel","userClassification"])}static getCacheExpiryCallbackForUser(e,t=null){return function(n){if(n.isAnonymousUser)return 0;const i=n.skypeTeamsInfo&&n.skypeTeamsInfo.isSkypeTeamsUser,{enableNonTeamsUserShortCacheExpiry:a}=e.get(o.J.People);return a&&!i?m:t||g}}static addDescription(e,t=!1,n=!1){if(e.description||this.isBot(e))return;if(n&&e.type===s.vf.federated)return void(e.description=e.tenantName||"");const i=e.userPrincipalName.substr(0,e.userPrincipalName.indexOf("@")).toUpperCase();e.description=e.jobTitle?`(${i}) ${e.jobTitle}`:e.userType===s.vf.guest||t?e.email||e.userPrincipalName:i}static addUserDisplaynamePostFix(e,t,n){const{enableTaglessNameForAnonConsumerUser:i}=t.get(o.J.People),a=i&&e.isAnonymousUser;return e.displayName=b.removeMismatchedPostFix(i,e.displayName,n),a?this.addExternalIndicator(e,n):this.addGuestIndicator(e,n)}static addExternalIndicator(e,t){const n=t.stringTranslate("peoplePicker","external_user_postfix"),i=e.guestlessDisplayName&&e.guestlessDisplayName.indexOf(n);if(i&&i>=0)return void(e.guestlessDisplayName=e.guestlessDisplayName.substring(0,i-1));!e.displayName.includes(n)&&e.displayName!==t.stringTranslate("peoplePicker","default_external_displayname")&&(e.displayName=`${e.displayName} ${n}`),e.givenName&&(e.guestGivenName=`${e.givenName} ${n}`),e.surname&&(e.guestSurname=`${e.surname} ${n}`)}static addGuestIndicator(e,t){const n=t.stringTranslate("peoplePicker","guest_user_postfix"),i=e.guestlessDisplayName.indexOf(n);i>-1?e.guestlessDisplayName=e.guestlessDisplayName.substring(0,i).trimRight():(e.displayName=`${e.displayName} ${n}`,e.givenName&&(e.guestGivenName=`${e.givenName} ${n}`),e.surname&&(e.guestSurname=`${e.surname} ${n}`))}static getUserDisplaynamePostFix(e,t,n,i,a,s,l,d){var c;if(!t)return null;const{enableTaglessNameForAnonConsumerUser:u}=i.get(o.J.People),m=i.get(o.J.Metadata).environment===r.s.life,g=e.startsWith(y),p=e.startsWith(k);if(m&&p)t=u?b.removeMismatchedPostFix(u,t,a):b.checkAndAddGuestTag(t,a);else if(!m&&g)t=b.removeMismatchedPostFix(u,t,a),t=u?b.checkAndAddExternalTag(t,a):b.checkAndAddGuestTag(t,a);else if(n||s){let e=!1;n&&(e=Boolean(null===(c=null==i?void 0:i.get(o.J.Messaging))||void 0===c?void 0:c.enableConsumerConversations)),e||(t=b.checkAndAddExternalTag(t,a))}else(l||d)&&(t=b.checkAndAddExternalTag(t,a));return t}static checkAndAddGuestTag(e,t){const n=this.getDefaultGuestDisplayName(t),i=this.getGuestUserTag(t);let a=e;return e.includes(i)||e===n||(a+=` ${i}`),a}static checkAndAddExternalTag(e,t){const n=this.getDefaultExternalDisplayname(t),i=this.getExternalTag(t);let a=e;return e.includes(i)||e===n||(a+=` ${i}`),a}static getDefaultGuestDisplayName(e){return e.stringTranslate("peoplePicker","default_guest_displayname",{defaultValue:"Guest"})}static getGuestUserTag(e){return e.stringTranslate("peoplePicker","guest_user_postfix",{defaultValue:"(Guest)"})}static getDefaultExternalDisplayname(e){return e.stringTranslate("peoplePicker","default_external_displayname",{defaultValue:"External"})}static getExternalTag(e){return e.stringTranslate("peoplePicker","external_user_postfix",{defaultValue:"(External)"})}static removeMismatchedPostFix(e,t,n){const i=e?"guest_user_postfix":"external_user_postfix",a=n.stringTranslate("peoplePicker",i),o=t.indexOf(a);return o>-1?t.substring(0,o).trimRight():t}static addUserTypeInfo(e){e.type&&"ADUser"===e.type||"User"===e.objectType?(e.type=s.cT.type.person,e.$$subType="ADUser"):e.type&&(e.$$subType=e.type)}static applyFeatureFlagSettings(e,t){let n=e.includeFeatures;const i=Boolean(t.get(o.J.Messaging).enableConsumerConversations);switch(e.name){case a.TS.addToMeeting:{const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:r}=t.get(o.J.Federated);r||(n=(0,d.difference)(n,[a.Cb.Federated])),e&&(n=(0,d.difference)(n,[a.Cb.Bot])),n=i?(0,d.difference)(n,[a.Cb.Federated]):(0,d.difference)(n,[a.Cb.TflConsumer]);break}case a.TS.allTrue:{const{enableTflTfwFederation:e,enableTfwTflFederation:r}=t.get(o.J.Host);i?e&&(n=(0,d.difference)(n,[a.Cb.Federated])):r&&(n=(0,d.difference)(n,[a.Cb.TflConsumer]));break}case a.TS.meetingSchedule:const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:r}=t.get(o.J.Federated);r||(n=(0,d.difference)(n,[a.Cb.Federated])),e&&(n=(0,d.difference)(n,[a.Cb.Bot]));break;case a.TS.addToChat:const{enableFederatedUsersInAddToChat:s}=t.get(o.J.Federated),{enableTfwFederationOnTfl:l,enableTfwTflFederation:c}=t.get(o.J.Host);i?l||(n=(0,d.difference)(n,[a.Cb.Federated])):(s||(n=(0,d.difference)(n,[a.Cb.Federated])),c||(n=(0,d.difference)(n,[a.Cb.TflConsumer])));const{enableDLsInAddToChat:u}=t.get(o.J.DistributionLists);u||(n=(0,d.difference)(n,[a.Cb.DL]));break;case a.TS.addToTeam:const{enableFederatedUsersInAddToTeam:m}=t.get(o.J.Federated);m||(n=(0,d.difference)(n,[a.Cb.Federated]));break;case a.TS.addToSpeedDialOrContacts:const{enableFederatedUsersInAddToSpeedDialOrContacts:g}=t.get(o.J.Federated);g||(n=(0,d.difference)(n,[a.Cb.Federated]))}return c.a.createFrom(e,n)}static filterSearchResults(e,t,n){let i=t;return(e=b.applyFeatureFlagSettings(e,n)).includeFederated||(i=i.filter((e=>!(b.isFederatedUser(e)||b.isSfcUser(e)||b.isTFLConsumerUser(e))))),e.includeGuest||(i=i.filter((e=>!b.isGuestUser(e)))),e.includeBot||(i=i.filter((e=>!b.isBot(e)))),e.includeDL||(i=i.filter((e=>!b.isDistributionList(e)))),e.includePstn||(i=i.filter((e=>!b.isPSTNUser(e)))),e.includeAADTenant||(i=i.filter((e=>!b.isInTenantUser(e)))),e.includeCallQandAA||(i=i.filter((e=>!b.isCallQorAAUser(e)))),e.includeTflConsumer||(i=i.filter((e=>!b.isTFLConsumerUser(e)))),e.includeTflSmsName||(i=i.filter((e=>!b.isTFLSmsFriendlyNameUser(e)))),i}static getTflOffNetworkUserDefaultDisplayName(e){return e&&e.substring(e.lastIndexOf(":")+1)}static matchEmailAliasInMeProfile(e,t){return!(0,d.isEmpty)(t)&&(0,d.some)(t,(t=>{var n;return e.toLowerCase()===(null===(n=t.address)||void 0===n?void 0:n.toLowerCase())}))}static matchPhoneAliasInMeProfile(e,t){return!(0,d.isEmpty)(t)&&(0,d.some)(t,(t=>e===t.number))}static generatePstnProfile(e,t){return{mri:e,displayName:t,givenName:t,surname:"",userPrincipalName:e,accountEnabled:!1,jobTitle:"",type:s.vf.pstn}}static convertStringToBlobFile(e){const t=e.split(",")[1];if((0,d.isEmpty)(t))return;const n=atob(t),i=e.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(n.length),o=new Uint8Array(a);for(let e=0;e<n.length;e++)o[e]=n.charCodeAt(e);return new Blob([o],{type:i})}static getPhoneNumbers(e){let t=[];return(null==e?void 0:e.telephoneNumber)&&t.push(e.telephoneNumber),(null==e?void 0:e.phones)&&e.phones.length>0&&(t=t.concat(e.phones.map((e=>e.number)))),t}static getExtendedDirectoryPhoneNumber(e){return b.getPhoneNumbers(e)[0]}static isPartialSCContext(e,t){return!!(e&&!t||!e&&t)}static getFederationType(e,t){let n;const i={type:t};return e?b.isTFLUser(i)?n="tflWithTfl":b.isFederatedUser(i)&&(n="tflWithTfw"):b.isSfcUser(i)?n="tfwWithSfc":b.isTFLConsumerUser(i)?n="tfwWithTfl":b.isFederatedUser(i)&&(n="tfwWithTfwFederated"),n}static getEdUserState(e,t={}){const{mri:n,userType:i}=e,{excludeOffNetwork:a=!0}=t;return!a&&this.isTFLOffNetworkUser(n)?"offNetwork":this.isPEUPUser(i)?"Pending":this.isEUPUser(i)?"Confirmed":void 0}static getTflExtendedDirectoryMembership(e){return!0===e?"pending":!1===e?"accepted":void 0}}b.isFederatedUser=e=>!!e.isFederated||e.type===s.vf.federated,b.isGuestUser=e=>e.type===s.vf.guest||e.userType===s.vf.guest,b.isPersonalContactUser=e=>e.type===s.vf.personalContactUser,b.isTFLUser=e=>e.type===s.vf.tflUser,b.isTFLConsumerUser=e=>e.type===s.vf.tflConsumer,b.isTFLSmsUser=e=>e.id&&b.isTFLSmsMri(e.id),b.isTFLSmsFriendlyNameUser=e=>e.id&&b.isTFLSmsMri(e.id)&&e.friendlyName,b.isInTenantUser=e=>{var t;return!((null===(t=e.type)||void 0===t?void 0:t.toLowerCase())!==s.cT.type.person.toLowerCase()&&"ADUser"!==e.type||b.isGuestUser(e)||e.isFederated)},b.isBot=e=>{var t;return(null===(t=e.type)||void 0===t?void 0:t.toUpperCase())===s.t.botType},b.isDistributionList=e=>e.type===s.vf.DistributionList&&(!e.objectType||e.objectType===s.vf.DistributionList),b.isPSTNUser=e=>e.mri&&0===e.mri.indexOf(p),b.isSfcUser=e=>e.type===s.vf.skypeConsumer,b.isMTOUser=e=>e.userType===s.vf.MTOUser,b.isExtendedDirectoryUser=e=>b.isPEUPUser(e.userType)||b.isEUPUser(e.userType)||e.type===s.vf.extendedDirectoryUser,b.isPEUPUser=e=>e===s.vf.PendingOrgContact,b.isEUPUser=e=>e===s.vf.OrgContact,b.isSfBUser=e=>Boolean(e.mri&&-1!==e.mri.indexOf("sfb:")),b.isCallQorAAUser=e=>e.type===s.vf.voiceApp,b.isMaskedOrExternalUser=e=>null==e?void 0:e.startsWith(y),b.isTFLOffNetworkUser=e=>0===(null==e?void 0:e.indexOf(h)),b.isTFLOffNetworkPhoneUser=e=>0===(null==e?void 0:e.indexOf("8:tfloffnetwork:phone:")),b.isTFLOffNetworkEmailUser=e=>0===(null==e?void 0:e.indexOf("8:tfloffnetwork:email:")),b.isTFLSmsUnVerifiedMri=e=>0===(null==e?void 0:e.indexOf(S)),b.isTFLSmsVerifiedMri=e=>0===(null==e?void 0:e.indexOf(v)),b.isTFLSmsMri=e=>0===(null==e?void 0:e.indexOf(v))||0===(null==e?void 0:e.indexOf(S)),b.isTFLSmsOrOffNetworkPhoneMri=e=>b.isTFLOffNetworkPhoneUser(e)||b.isTFLSmsMri(e),b.isTflSmsUnverifiedOrOffNetworkPhoneMri=e=>b.isTFLSmsUnVerifiedMri(e)||b.isTFLOffNetworkPhoneUser(e),b.isEnterpriseUserMri=e=>0===(null==e?void 0:e.indexOf("8:orgid:")),b.isDisplayNameUnknownUser=e=>(null==e?void 0:e.toLowerCase())===f||"unknown"===(null==e?void 0:e.toLowerCase()),b.isConversationItem=e=>{var t;return 0===(null===(t=e.id)||void 0===t?void 0:t.indexOf("19:"))},b.isTag=e=>"Tag"===e.type,b.getPhoneNumberFromMri=e=>e&&b.isTFLSmsUnVerifiedMri(e)?e.slice(S.length):""},86125:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{f5:()=>i,Ko:()=>a,r1:()=>o}),function(e){e.ActiveUserOperation="AUO",e.PassiveOperation="PO",e.BackgroundOperation="BO"}(i||(i={})),function(e){e.UploadFile="ShareUploadFile",e.RemoveFile="ShareAbort"}(a||(a={})),function(e){e.Unknown="Unknown",e.Inline="Inline",e.Attached="Attached"}(o||(o={}))},10994:(e,t,n)=>{"use strict";n.d(t,{K:()=>J});var i=n(89925),a=n(6766),o=n(20448),r=n(55997),s=n(3984),l=n(84275),d=n(13637),c=n(19249),u=n(52397);const m=()=>({apiName:"canCreateTWT",url:"beta/teams/canCreateTWT",method:"GET"}),g=e=>({apiName:"createTeam",url:"beta/teams/create",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),p=(e,t)=>({apiName:"editTeam",url:`beta/teams/${e}`,method:"PATCH",body:JSON.stringify(t),headers:{"content-type":"application/json"}}),h=e=>({apiName:"findJoinRequests",url:"beta/teams/findJoinRequests",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),v=e=>({apiName:"getChannelEmailSettingsRequest",url:`beta/channels/${e}/email`,method:"GET",headers:{"content-type":"application/json"}}),S=(e,t)=>({apiName:"createChannelEmailSettingsRequest",url:`beta/channels/${e}/email`,body:JSON.stringify(t),method:"POST",headers:{"content-type":"application/json"}}),f=(e,t)=>({apiName:"updateChannelEmailSettingsRequest",url:`beta/channels/${e}/email`,body:JSON.stringify(t),method:"PUT",headers:{"content-type":"application/json"}}),y=e=>({apiName:"removeChannelEmailSettingsRequest",url:`beta/channels/${e}/email`,method:"DELETE",headers:{"content-type":"application/json"}}),k=(e,t)=>({apiName:"handleBulkJoinRequests",url:`beta/teams/bulkJoinRequestAdminAction?silentAction=${t}`,method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),C=(e,t)=>({apiName:"handleJoinRequest",url:`beta/teams/joinRequestAdminAction?silentAction=${t}`,method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),b=(e,t,n)=>({apiName:"leaveChannel",url:`beta/teams/${e}/channels/${t}/members/${n}`,method:"DELETE",headers:{"content-type":"application/json"}}),T=e=>({apiName:"userGroupSettings",url:"beta/users/groupsSettings",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),w=(e,t,n)=>({apiName:"removePrivateChannelMembership",url:`beta/teams/${e}/channels/${t}/members/${n}`,method:"DELETE",headers:{"content-type":"application/json"}}),_=(e,t)=>({apiName:"restoreChannel",url:`beta/teams/${encodeURIComponent(e)}/channels/${encodeURIComponent(t)}/restore`,method:"PATCH"}),I=()=>({apiName:"getSensitivityLabels",url:"beta/users/sensitivityLabels",method:"GET"}),A=()=>({apiName:"getSensitivityPolicySettings",url:"beta/users/sensitivityPolicySettings",method:"GET"}),N=(e,t)=>({apiName:"sponsorJoinRequest",url:`beta/teams/sponsorJoinRequest/${e}`,method:"POST",body:JSON.stringify(t),headers:{"content-type":"application/json"}}),E=e=>e.body.json().then((e=>e&&e.value)).catch((()=>{throw(0,c.T)(u.A.TransformFailed,e)})),D=e=>(0,d.mG)(void 0,void 0,void 0,(function*(){const t=yield e.body.json();if(t&&t.joinRequestsPerTeam){const e=t.joinRequestsPerTeam,n=Object.keys(e),i=[];for(const t of n)if(e[t])for(const n of e[t])n.teamId=t,i.push(n);return t.joinRequestsPerTeam=i,t}})),F=e=>({apiName:"validateTeamName",url:"beta/teams/validateNaming",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),P=e=>({apiName:"allChannels",url:`beta/teams/${e}/allchannels`,method:"PUT",body:JSON.stringify({Channels:[{Type:"standard",State:["deleted"]},{Type:"private",State:["deleted"]},{Type:"shared",State:["deleted"]}]}),headers:{"content-type":"application/json"}}),M=(e,t)=>({apiName:"updateTeamMembership",url:`beta/teams/${encodeURIComponent(e)}/members`,method:"PUT",body:JSON.stringify(t),headers:{"content-type":"application/json"}}),j=(e,t,n,i)=>({apiName:"updateTeamMembership",url:`beta/teams/${e}/members`,method:"PUT",body:JSON.stringify({groupId:t,userMri:n,updateType:i}),headers:{"content-type":"application/json"}}),R=(e,t,n,i)=>({apiName:"updatePrivateChannelMembership",url:`beta/teams/${e}/channels/${t}/members/${n}`,method:"PATCH",body:JSON.stringify({mri:n,role:i}),headers:{"content-type":"application/json"}}),x=e=>({apiName:"resetTeamJoinCode",url:`beta/teams/${e}/joinCode`,method:"PUT",headers:{"content-type":"application/json"}}),O=e=>({apiName:"removeTeamJoinCode",url:`beta/teams/${e}/joinCode`,method:"DELETE",headers:{"content-type":"application/json"}}),L=e=>({apiName:"renewTeam",url:`beta/teams/${e}/renew`,method:"POST"}),U=(e,t)=>({apiName:"updateTeamDiscoverability",url:`beta/teams/${e}/discoverable`,method:"PUT",body:JSON.stringify(t)}),B=e=>({apiName:"getRecommendedTeams",url:`beta/teams/suggested?accessType=${e}`,method:"GET"}),W=e=>({apiName:"joinTeamById",url:`beta/teams/joinRequest/${e}`,method:"POST",headers:{"content-type":"application/json"}}),G=(e,t,n)=>({apiName:"searchRecommendedTeams",url:`beta/teams/find?keywords=${encodeURIComponent(t)}&accessType=${e}&enableKeywordSearch=false&top=100&skipToken=${encodeURIComponent(n||"")}`,method:"GET"}),V=e=>({apiName:"joinTeamWithCode",url:"beta/teams/joinByCode",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),H=(e,t)=>({apiName:"setChannelShowForMember",url:`beta/teams/${e}/setDefaultChannel`,method:t?"PUT":"DELETE",headers:{"content-type":"application/json"}}),$=e=>{const{authenticationResources:t,discover:n,platformService:i,config:r}=e,d=(0,s.h)(i,r),c=(0,l.g)(z,d);return{baseUrlPromise:()=>n.regionGtm(a.Pn.middleTier),serviceName:o.EJ.MiddleTier,authResource:t.mtAuthWithSkypeXTokenResource,models:{canCreateTWT:c(m),createTeam:c(g).withTransform(E),deletedChannels:c(P),editTeam:c(p),findJoinRequests:c(h).withTransform(D),getChannelEmailSettings:c(v),createChannelEmailSettings:c(S),updateChannelEmailSettings:c(f),removeChannelEmailSettings:c(y),handleBulkJoinRequests:c(k),handleJoinRequest:c(C),leaveChannel:c(b),myGroupSettings:c(T),removePrivateChannelMembership:c(w),restoreChannel:c(_),sensitivityLabels:c(I),sensitivityPolicySettings:c(A),sponsorJoinRequest:c(N),updatePrivateChannelMembership:c(R),updateTeamMembership:c(j),validateTeamName:c(F),removeTeamMembership:c(M),resetTeamJoinCode:c(x),removeTeamJoinCode:c(O),renewTeam:c(L),updateTeamDiscoverability:c(U),getRecommendedTeams:c(B),joinTeamById:c(W),searchRecommendedTeams:c(G),joinTeamWithCode:c(V),setChannelShowForMember:c(H)}}};function z(e){return Promise.resolve({constructRequest:e,allowedResponses:[r.qj.HTTP_2XX]})}var q=n(85350);class J{constructor(e){this._transport=e.createApi($)}canCreateTWT(){return this._transport.canCreateTWT()}createTeam(e){const t=Object.assign(Object.assign({},e),{accessType:this.convertTeamAccessType(e.accessType)});return this._transport.createTeam(t)}deletedChannels(e){return this._transport.deletedChannels(e)}editTeam(e,t){return this._transport.editTeam(e,t)}findJoinRequests(e){return this._transport.findJoinRequests(e)}getChannelEmailSettings(e){return this._transport.getChannelEmailSettings(e)}createChannelEmailSettings(e,t){return this._transport.createChannelEmailSettings(e,t)}updateChannelEmailSettings(e,t){return this._transport.updateChannelEmailSettings(e,t)}removeChannelEmailSettings(e){return this._transport.removeChannelEmailSettings(e)}handleBulkJoinRequests(e,t){return this._transport.handleBulkJoinRequests(e,t)}handleJoinRequest(e,t){return this._transport.handleJoinRequest(e,t)}leaveChannel(e,t,n){return this._transport.leaveChannel(e,t,n)}removePrivateChannelMembership(e,t,n){return this._transport.removePrivateChannelMembership(e,t,n)}removeTeamMembership(e,t){return this._transport.removeTeamMembership(e,t)}restoreChannel(e,t){return this._transport.restoreChannel(e,t)}myGroupSettings(e){return this._transport.myGroupSettings(e)}sensitivityLabels(){return this._transport.sensitivityLabels()}sensitivityPolicySettings(){return this._transport.sensitivityPolicySettings()}sponsorJoinRequest(e,t){return this._transport.sponsorJoinRequest(e,t)}validateTeamName(e){return this._transport.validateTeamName(e)}updateTeamMembership(e,t,n,i){return this._transport.updateTeamMembership(e,t,n,i)}updatePrivateChannelMembership(e,t,n,i){return this._transport.updatePrivateChannelMembership(e,t,n,i)}resetTeamJoinCode(e){return this._transport.resetTeamJoinCode(e)}removeTeamJoinCode(e){return this._transport.removeTeamJoinCode(e)}renewTeam(e){return this._transport.renewTeam(e)}updateTeamDiscoverability(e,t){return this._transport.updateTeamDiscoverability(e,t)}getRecommendedTeams(e){return this._transport.getRecommendedTeams(e)}joinTeamById(e){return this._transport.joinTeamById(e)}searchRecommendedTeams(e,t,n){return this._transport.searchRecommendedTeams(e,t,n)}joinTeamWithCode(e){return this._transport.joinTeamWithCode(e)}setChannelShowForMember(e,t){return this._transport.setChannelShowForMember(e,t)}convertTeamAccessType(e){switch(e){case i.TeamAccessType.Public:return q.eU.Public;default:return q.eU.Private}}}},58741:(e,t,n)=>{"use strict";n.d(t,{Em:()=>i,kz:()=>o,vi:()=>r,yw:()=>s,eI:()=>l,j7:()=>d,me:()=>c,vH:()=>u,Ju:()=>m,yR:()=>g,VD:()=>p,GF:()=>h,IC:()=>v,ex:()=>S,gh:()=>f,MX:()=>y,Q0:()=>k,Gq:()=>C,fh:()=>b,Sq:()=>T,LC:()=>w,CQ:()=>_});var i,a=n(51581);!function(e){e.getVoicemails="getVoicemails",e.getAttachments="getAttachments",e.markReadUnread="markReadUnread",e.deleteVoicemail="deleteVoicemail"}(i||(i={}));const o="voicemail-service",r="application/json",s="odata.metadata=none",l="odata.streaming=true",d="odata.metadata=minimal",c="IEEE754Compatible=false",u="charset=utf-8",m=(0,a.LQ)(`${r};${d};${l};${c};${u}`),g="x-serverrequestid",p="<MESSAGE_ID>",h="<GROUP_ID>",v="DeletedItems",S="https://outlook.office.com/",f="api/v2.0/",y="api/beta/",k=9e5,C="voicemails_refreshed",b=(0,a.LQ)("&$filter=SingleValueExtendedProperties/Any(ep: ep/PropertyId eq 'String 0x1a' and ep/Value eq 'IPM.Note.Microsoft.Voicemail.UM.CA')"),T=(0,a.LQ)("?$expand=SingleValueExtendedProperties($filter=PropertyId eq 'Integer {00020328-0000-0000-C000-000000000046} Id 0x6801' or PropertyId eq 'String {00020386-0000-0000-C000-000000000046} Name X-VoiceMessageConfidenceLevel' or PropertyId eq 'String {00020386-0000-0000-C000-000000000046} Name X-VoiceMessageTranscription')&$top=30&$select=From,Body,IsRead,Id,ReceivedDateTime,InternetMessageHeaders"),w=[{id:i.getVoicemails,path:"me/mailfolders/voicemail/messages"},{id:i.getAttachments,path:"me/messages/<MESSAGE_ID>/attachments"},{id:i.markReadUnread,path:"me/messages/<MESSAGE_ID>"},{id:i.deleteVoicemail,path:"me/messages/<MESSAGE_ID>/move"}],_=[{id:i.getVoicemails,path:"groups/<GROUP_ID>/messages"},{id:i.getAttachments,path:"groups/<GROUP_ID>/messages/<MESSAGE_ID>/attachments"},{id:i.markReadUnread,path:"groups/<GROUP_ID>/messages/<MESSAGE_ID>"},{id:i.deleteVoicemail,path:"groups/<GROUP_ID>/messages/<MESSAGE_ID>/move"}]},73491:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});class i{constructor(){this.outstandingRequests=void 0,this.mostRecentRequest=void 0,this.requestsMapping=void 0,this.decimalPlaces=void 0,this.subscriber=void 0,this.decimalPlaces=3}static get Instance(){return i._instance||(i._instance=new i),i._instance}processRequest(e,t,n){if(!this.subscriber)return;const{requests:i}=this.outstandingRequests;i.has(e)||i.set(e,{requestsByName:new Map});const{requestsByName:a}=i.get(e),o=a.get(t)||0;a.set(t,o+1),this.requestsMapping.set(n,{operationName:t,operationType:e}),this.notify()}processResponse(e,t){if(!this.subscriber||!this.requestsMapping.has(e))return;const{operationName:n,operationType:i}=this.requestsMapping.get(e);if("subscription"===i)return;this.requestsMapping.delete(e);const a=this.outstandingRequests&&this.outstandingRequests.requests;if(a.has(i)){const{requestsByName:e}=a.get(i);let t=e.get(n);1===t?e.delete(n):t>0&&e.set(n,--t)}const o={requestInfo:{operationName:n,operationType:i},responseTime:t&&parseFloat(t.toFixed(this.decimalPlaces))};this.mostRecentRequest=o,this.notify()}subscribe(e){this.subscriber=e,this.outstandingRequests={requests:new Map},this.requestsMapping=new Map}unsubscribe(){this.subscriber=void 0,this.outstandingRequests=void 0,this.requestsMapping=void 0}notify(){this.subscriber.processUpdate(this.outstandingRequests,this.mostRecentRequest)}}i._instance=void 0},84275:(e,t,n)=>{"use strict";n.d(t,{K:()=>s,g:()=>l});var i=n(13637),a=n(70467),o=n(6766),r=n(3984);const s=(e,t,n)=>s=>{const{discover:l,authenticationResources:c,platformService:u,config:m}=s,g=(0,r.h)(u,m),{headers:p}=t,h=(0,i._T)(t,["headers"]),v=Object.assign(Object.assign({},g),p);return{baseUrlPromise:()=>l.regionGtm(o.Pn.middleTier),serviceName:e,authResource:c.mtAuthResource,models:n((e=>{const t=Promise.resolve(Object.assign({constructRequest:(0,a.$)(e,v)},h));return d(t)}))}},l=(e,t,n)=>i=>{const o=e((0,a.$)(i,t),n);return d(o)},d=e=>{const t=Object.assign(e,{allow:n=>(e.then((e=>e.allowedResponses=n)),t),withCustomTelemetry:n=>(e.then((e=>e.customTelemetry=n)),t),withRetry:n=>(e.then((e=>e.retryPolicy=n)),t),withResponse:n=>(e.then((e=>e.responseType=n)),t),withTransform:n=>(e.then((e=>e.transformResponse=n)),t)});return t}},52397:(e,t,n)=>{"use strict";var i;n.d(t,{A:()=>i}),function(e){e.AuthFailed="AuthFailed",e.AuthResolveFailed="AuthResolveFailed",e.FailedToFetch="FailedToFetch",e.InvalidUrl="InvalidUrl",e.InvalidParameters="Invalid pararameters",e.NotImplemented="NotImplemented",e.RejectHttpError="RejectHttpError",e.RequireStatusFailed="RequireStatusFailed",e.RequestCancelled="RequestCancelled",e.TimedOut="TimedOut",e.BaseUrlTimeout="BaseUrlTimeout",e.BaseUrlFailedToResolve="BaseUrlFailedToResolve",e.ModelTimeOut="ModelTimeOut",e.ModelFailedToInitialize="ModelFailedToInitialize",e.TransformFailed="TransformFailed",e.CustomTelemetryFailed="CustomTelemetryFailed"}(i||(i={}))},55997:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{qb:()=>i,qj:()=>a,nz:()=>o}),function(e){e[e.OK=200]="OK",e[e.CREATED=201]="CREATED",e[e.ACCEPTED=202]="ACCEPTED",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.PARTIAL_CONTENT=206]="PARTIAL_CONTENT",e[e.MULTI_STATUS=207]="MULTI_STATUS",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.NOT_AUTHORIZED=401]="NOT_AUTHORIZED",e[e.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.NOT_ALLOWED=405]="NOT_ALLOWED",e[e.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",e[e.PROXY_AUTHENTICATION_REQUIRED=407]="PROXY_AUTHENTICATION_REQUIRED",e[e.REQUEST_TIMEOUT=408]="REQUEST_TIMEOUT",e[e.CONFLICT=409]="CONFLICT",e[e.GONE=410]="GONE",e[e.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",e[e.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",e[e.REQUEST_ENTITY_TOO_LARGE=413]="REQUEST_ENTITY_TOO_LARGE",e[e.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",e[e.REQUEST_RANGE_NOT_SATISFIABLE=416]="REQUEST_RANGE_NOT_SATISFIABLE",e[e.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.THROTTLED=429]="THROTTLED",e[e.ENCRYPTION_ERROR=463]="ENCRYPTION_ERROR",e[e.REQUEST_TERMINATED=487]="REQUEST_TERMINATED",e[e.SERVER_ERROR=500]="SERVER_ERROR",e[e.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",e[e.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",e[e.BANDWIDTH_LIMIT_EXCEEDED=509]="BANDWIDTH_LIMIT_EXCEEDED",e[e.SERVER_TIMEOUT=599]="SERVER_TIMEOUT"}(i||(i={})),function(e){e.HTTP_2XX="2xx",e.HTTP_5XX="5xx"}(a||(a={})),function(e){e.Initial="Initial",e.Auth="Auth",e.AuthDecorate="AuthDecorate",e.AuthResolve="AuthResolve",e.Retry="Retry",e.RetryDelay="RetryDelay",e.Redirect="Redirect",e.Throttle="Throttle"}(o||(o={}))},19249:(e,t,n)=>{"use strict";function i(e,t,n){const i=new Error(e);return Object.assign(i,{reason:e,serverResponse:t,innerException:n})}n.d(t,{T:()=>i})},70467:(e,t,n)=>{"use strict";function i(e,t){return t?(...n)=>{const i=e(...n);return Object.assign(Object.assign({},i),{headers:Object.assign(Object.assign({},t),i.headers)})}:e}n.d(t,{$:()=>i})},26632:(e,t,n)=>{"use strict";n.d(t,{hA:()=>d,w2:()=>c,KD:()=>u,$O:()=>g,jo:()=>p,Pg:()=>h,Q3:()=>v,fY:()=>S,DP:()=>f});var i=n(13637),a=n(18548);const o="/v1/objects",r="/views/video",s=/^\/asm\/[a-z]+/i,l=/^\/asm\/[a-z]+\/v1\/objects/i;var d,c;function u(e){if(e&&g(e)){const t=new RegExp("/v1/objects/([\\w|\\-]+)","i"),n=e.match(t);return n&&n[1]||""}return""}function m(e){const t=(0,a.Lp)(e).toLowerCase(),n=(0,a.DW)(e);return t.endsWith("asm.skype.com")||"api.ams.gcc.teams.microsoft.com"===t||"api.ams.gov.teams.microsoft.us"===t||"api.ams.dod.teams.microsoft.us"===t||"api.asyncgw.teams.microsoft.scloud"===t||"api.asyncgw.teams.microsoftonline.cn"===t||t.endsWith("asyncgw.teams.microsoft.com")||"teams.microsoft.com"===t&&s.test(n)}function g(e){if(f(e))return!0;const t=(0,a.DW)(e);return m(e)&&(t.startsWith(o)||l.test(t))}function p(e){if(!e)return!1;const t=(0,a.DW)(e);return!(!f(e)||!t.endsWith(r))||m(e)&&t.endsWith(r)}function h(e){return p(e)?c.Video:g(e)?c.Image:c.None}function v(e){var t;return(0,i.mG)(this,void 0,void 0,(function*(){const n=e instanceof Blob?new Uint8Array(yield null===(t=e.arrayBuffer)||void 0===t?void 0:t.call(e)):e;if(!n||n.length<6)return!1;if(71!==n[0]||73!==n[1]||70!==n[2])return function(e){if(!e)return!1;let t=-1,n=-1;for(let i=0;i<e.length-4;i++)if(97===e[i]&&99===e[i+1]&&84===e[i+2]&&76===e[i+3]&&(n=i),73===e[i]&&68===e[i+1]&&65===e[i+2]&&84===e[i+3]){t=i;break}return n>=0&&t>n}(n);let i=0;for(let e=0;e<n.length-9&&!(33===n[e]&&249===n[e+1]&&4===n[e+2]&&44===n[e+8]&&(i++,i>1));e++);return i>1}))}function S(e,t){if(!e||!g(e)||!t||e.startsWith(t))return e;return[t,new URL(e).pathname.substring(1)].join("")}function f(e){return(0,a.DW)(e).toLowerCase().startsWith("/ams/v1/objects")}!function(e){e[e.IMAGE_SIZE_TOO_LARGE=10001]="IMAGE_SIZE_TOO_LARGE",e[e.UNSUPPORTED_IMAGE_FORMAT=10002]="UNSUPPORTED_IMAGE_FORMAT"}(d||(d={})),function(e){e.None="None",e.Image="Image",e.Video="Video"}(c||(c={}))},93355:(e,t,n)=>{"use strict";n.d(t,{E:()=>r,I:()=>i});var i,a=n(31821);class o{constructor(e,t){this.host=e,this.parentLeakDetector=t,this.trackedObjectsByKey={}}track(e,t){var n,i;(null===(n=this.host)||void 0===n?void 0:n.WeakRef)&&(this.trackedObjectsByKey[e]||(this.trackedObjectsByKey[e]=[]),null===(i=this.parentLeakDetector)||void 0===i||i.track(e,t),this.trackedObjectsByKey[e].push({weakReference:new this.host.WeakRef(t)}))}getLeaks(e){return this.cleanupReferencesOfType(e),this.trackedObjectsByKey[e]?this.trackedObjectsByKey[e].map((e=>e.weakReference.deref())):[]}getAllLeaks(){const e={};for(const t of Object.keys(this.trackedObjectsByKey)){const n=this.getLeaks(t);n.length>0&&(e[t]=n)}return e}cleanup(){for(const e of Object.keys(this.trackedObjectsByKey))this.cleanupReferencesOfType(e)}cleanupReferencesOfType(e){this.trackedObjectsByKey[e]&&(this.trackedObjectsByKey[e]=this.trackedObjectsByKey[e].filter((e=>void 0!==e.weakReference.deref())),0===this.trackedObjectsByKey[e].length&&delete this.trackedObjectsByKey[e])}}!function(e){e.UnwrappedWindow="unwrappedWindow",e.DataClient="dataClient",e.ApolloCache="apolloCache",e.ChatPaneContainer="ChatPaneContainer",e.CalendarMainSlotContentContainer="CalendarMainSlotContentContainer",e.CalendarRenderer="CalendarRenderer",e.CalendarSchedulingFormRenderer="CalendarSchedulingFormRenderer",e.ChannelPaneContainer="ChannelPaneContainer",e.ChannelRepliesPaneContainer="ChannelRepliesPaneContainer",e.GridViewContainer="GridViewContainer",e.SearchAllPaneContainer="SearchAllPaneContainer",e.SingleTeamViewContainer="SingleTeamViewContainer",e.PlatformAppViewsContainer="PlatformAppViewsContainer",e.ChannelListContainer="ChannelListContainer",e.ActivityFeedContainer="ActivityFeedContainer",e.ChatRailContainer="ChatRailContainer",e.CallMonitorPopout="CallMonitorPopout"}(i||(i={}));class r{constructor(e,t){this.coreSettings=e,this.host=t,this.leakDetectorReferences=[],this.leaksAggregator=new o(t)}create(){var e;if(!(null===(e=this.host)||void 0===e?void 0:e.WeakRef))return;const t=new o(this.host,this.leaksAggregator),n=new this.host.WeakRef(t);return this.leakDetectorReferences.push(n),this.cleanup(),t}getReachableObjects(e){this.cleanup();const t=this.leaksAggregator.getLeaks(e);return new Set(t)}getReachableObjectsByKey(){this.cleanup();const e={},t=this.leaksAggregator.getAllLeaks();for(const n of Object.keys(t))e[n]=new Set(t[n]);return e}getReachableObjectCountsByKey(){const e={},t=this.getReachableObjectsByKey();for(const n of Object.keys(t))e[n]=t[n].size;return e}getReachableObjectsTrackingInfo(){this.cleanup();const e={};return this.addWindowLeakInfo(e),this.addApolloCacheLeakInfo(e),e}cleanup(){this.leaksAggregator.cleanup(),this.leakDetectorReferences=this.leakDetectorReferences.filter((e=>void 0!==e.deref())),this.leakDetectorReferences.forEach((e=>{var t;null===(t=e.deref())||void 0===t||t.cleanup()}))}getTelemetry(){var e,t,n,o,r,s,l,d,c,u,m,g,p,h;const{enableOLDStats:v}=this.coreSettings.get(a.J.Core),S=v&&this.getReachableObjectCountsByKey();if(S)return{ChatPaneContainer:null!==(e=S[i.ChatPaneContainer])&&void 0!==e?e:0,ChannelPaneContainer:null!==(t=S[i.ChannelPaneContainer])&&void 0!==t?t:0,ChannelRepliesPaneContainer:null!==(n=S[i.ChannelRepliesPaneContainer])&&void 0!==n?n:0,CalendarMainSlotContentContainer:null!==(o=S[i.CalendarMainSlotContentContainer])&&void 0!==o?o:0,CalendarRenderer:null!==(r=S[i.CalendarRenderer])&&void 0!==r?r:0,CalendarSchedulingFormRenderer:null!==(s=S[i.CalendarSchedulingFormRenderer])&&void 0!==s?s:0,GridViewContainer:null!==(l=S[i.GridViewContainer])&&void 0!==l?l:0,SearchAllPaneContainer:null!==(d=S[i.SearchAllPaneContainer])&&void 0!==d?d:0,SingleTeamViewContainer:null!==(c=S[i.SingleTeamViewContainer])&&void 0!==c?c:0,PlatformAppViewsContainer:null!==(u=S[i.PlatformAppViewsContainer])&&void 0!==u?u:0,ChannelListContainer:null!==(m=S[i.ChannelListContainer])&&void 0!==m?m:0,ActivityFeedContainer:null!==(g=S[i.ActivityFeedContainer])&&void 0!==g?g:0,ChatRailContainer:null!==(p=S[i.ChatRailContainer])&&void 0!==p?p:0,CallMonitorPopout:null!==(h=S[i.CallMonitorPopout])&&void 0!==h?h:0}}addApolloCacheLeakInfo(e){const t=this.leaksAggregator.getLeaks(i.ApolloCache).map((e=>e.apolloLeakInfo));t.length>0&&(e[i.ApolloCache]=t)}addWindowLeakInfo(e){const t=this.leaksAggregator.getLeaks(i.UnwrappedWindow).map((e=>e.windowLeakInfo));t.length>0&&(e[i.UnwrappedWindow]=t)}}},99342:(e,t,n)=>{"use strict";n.d(t,{J:()=>a,l:()=>o});var i=n(45657);function a(){return i.n.getInstance().window}function o(e,...t){const n=window.electronSafeIpc;n&&n.send(e,...t)}},94856:(e,t,n)=>{"use strict";n.d(t,{V:()=>i});const i={type:"safelinks",safelinksAtpMT:{type:"safelinksmt",getUrlReputationRestEndpoint:"beta/atpsafelinks/geturlreputationrest/",getpolicyEndpoint:"beta/atpsafelinks/getpolicy/",RESOURCE_KEY:"https://dataservice.o365filtering.com"},telemetry:{getPolicy:"atp_get_policy",getUrlReputation:"atp_get_url_reputation"},policyKey:"atp-safelinks-policy"}},667:(e,t,n)=>{"use strict";n.d(t,{c:()=>c});var i=n(13637),a=n(31821),o=n(55997),r=n(20448),s=n(82250),l=n(94856),d=n(31583);class c{constructor(e,t,n,i,a,o){this.send=e,this.authenticationService=t,this.coreSettings=n,this.scenarioFactory=i,this.localStorage=o,this.handleGetATPAuthToken=()=>this.authenticationService.acquireToken(l.V.safelinksAtpMT.RESOURCE_KEY),this.logger=a.newLogger("AtpSafelinksService")}initPolicy(){const e=this.scenarioFactory.newScenario(s.RG.ATPGetPolicyTask);this.getPolicy().then((()=>e.stop())).catch((t=>{const n=`Error getting ATP Safelinks policy: ${t.message||""}`;this.logger.error(n),e.fail({errors:n})}))}getPolicy(){var e;return(0,i.mG)(this,void 0,void 0,(function*(){return null!==(e=this.getPolicyFromLocalStore())&&void 0!==e?e:this.getPolicyFromRemote()}))}getUrlReputationRestMT(e,t){return(0,i.mG)(this,void 0,void 0,(function*(){const{enabledATPSafelinks:n}=this.coreSettings.get(a.J.Messaging);if(!n||!this._isAtpSafelinksSubscriptionEnabled())return this.logger.log("enabledATPSafelinks false"),{status:o.qb.OK,url:t};try{const n=yield this.handleGetATPAuthToken(),i=yield this._post(l.V.safelinksAtpMT.getUrlReputationRestEndpoint,this._getRequestBody(t,n),this._getHeaders(e));this.logger.log("getUrlReputationRestMT started");const a=yield i.body.json();return{url:t,status:i.status,data:a&&a.isATPSafelinksEnabled?a:{isATPSafelinksEnabled:!1}}}catch(e){return this.logger.error(`AtpSafelinks MT API failed with Error: ${e&&e.message}`),{url:t,status:-1}}}))}getPolicyFromLocalStore(){let e=null;try{const t=this.localStorage.get(l.V.policyKey);if(t){const n=JSON.parse(t);((e,t)=>{if(e&&t){const t=/^(.*); expires=(.*); path=\/$/,n=2,i=e.match(t);if(i)return new Date(i[n]).getTime()>Date.now()}return!1})(n.cookie,n.webAffinitizedUrl)?e=n:this.logger.error("Invalid policy found from localStorage")}}catch(e){this.logger.error(`Error while getting ATP safelinks policy from localStorage: ${e}`)}return e}getPolicyFromRemote(){return(0,i.mG)(this,void 0,void 0,(function*(){let e=null;const t=this.scenarioFactory.newScenario(s.RG.ATPGetPolicy);try{const n=yield this._get(l.V.safelinksAtpMT.getpolicyEndpoint),i=yield n.body.json();this.localStorage&&this.localStorage.setSafe(l.V.policyKey,JSON.stringify(i));const a=`getPolicy status: ${n.status}`;this.logger.debug(a),t.stop({reason:a}),e=i}catch(e){this.logger.error(`AtpSafelinks GetPolicy API failed with Error: ${e&&e.message}`),t.fail({errors:`${l.V.telemetry.getPolicy}_failed`})}return e}))}_getRequestBody(e,t){return{urlList:[e],atptoken:t}}_getHeaders(e){const t={"content-type":"application/json"};return e&&(this._addHeader(e.user,"X-sourceUser",t),this._addHeader(e.id,"X-sourceId",t),this._addHeader(e.detail,"X-sourceDetail",t)),t}_addHeader(e,t,n){n[t]=e}_post(e,t,n){return(0,i.mG)(this,void 0,void 0,(function*(){return(0,d.B)(this.send,o.qb.OK)({url:e,method:"POST",body:JSON.stringify(t),headers:n,serviceName:r.EJ.MiddleTier,apiName:"safelink"})}))}_get(e){return(0,i.mG)(this,void 0,void 0,(function*(){return(0,d.B)(this.send,o.qb.OK)({url:e,method:"GET",serviceName:r.EJ.MiddleTier,apiName:"safelink"})}))}_isAtpSafelinksSubscriptionEnabled(){const{licenseSettings:e}=this.coreSettings.get(a.J.UserResources);return!(!e||!e.isAtpSafelinksEnabled)}}},60780:(e,t,n)=>{"use strict";n.d(t,{aw:()=>i,ZU:()=>a,Fz:()=>o,l6:()=>r,$N:()=>s,yc:()=>l,DT:()=>d,SM:()=>c,wK:()=>u,IY:()=>m,rz:()=>g,ru:()=>p,op:()=>h,ej:()=>v,Hw:()=>S,QN:()=>y,gX:()=>k,ex:()=>b,s9:()=>T,uI:()=>w,rF:()=>_,zP:()=>I,GA:()=>A,f:()=>N,j:()=>E,Tv:()=>D});const i="TflFreProfileCardDisplayed",a="LogoutState",o="authSessionId",r="tmp.previous.silent.signin",s="in-progress",l={nopa:"2"},d={coa:"1"},c={AuthProviderLoadError:"AuthProviderLoadError",ErrorGetUserWhenAnonNotSupported:"ErrorGetUserWhenAnonNotSupported",InitFailure:"Core-auth init failure",InteractionRequired:"InteractionRequired",InvalidScopeResource:"invalid_scope",MultipleUsersPresentWithSpecifiedIdentifier:"MultipleUsersPresentWithSpecifiedIdentifier",NativeAuthModuleNotPresent:"NativeAuthModuleNotPresent",NoAccountFound:"NoAccountFound",RemoteOperationFailed:"RemoteOperationFailed",SignInRestrictions:"SignInRestrictions",SsoFirstAccountFailed:"SsoFirstAccountFailed",TenantUnredeemed:"TenantUnredeemed",UserNotAuthenticated:"UserNotAuthenticated",UserNotFoundError:"User not found",LoginRequired:"login_required",ConsentRequired:"consent_required",PopUpWindowError:"popup_window_error",EmptyResponse:"EmptyResponse",InvalidResponse:"InvalidResponse",InvalidToken:"InvalidToken",UnsupportedParameter:"UnsupportedParameter"},u={NoNetwork:"NoNetwork",ApiContractViolation:"ApiContractViolation",UiAlreadyShowing:"Cannot sign in when UI is showing"},m="InteractionRequiredAuthError",g="skype-token",p="discover-user-details",h="discover-region-gtm";var v,S;!function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.SIGNIN_RESTRICTIONS_KEY="SignInRestrictions",e.AUTHZ_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite"}(v||(v={})),function(e){e.openId="openId",e.profile="profile"}(S||(S={}));let f=["[auth][authserviceBack][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","aborted","A silent sign-in request was sent but none of the currently signed in user(s) match the requested login hint","Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","Cannot start retry fetch of ADAL tokens, isPassive: false","Cancelling all retries due to: orchestration authenticationService_offline","Cancelling all retries due to: Relogin succeeded. Need to refresh tokens","Due to current app state cannot start retry fetch of ADAL tokens","noAccessForResource","resourceRequiresConsent","resourceDisabled","Seamless single sign on failed for the user. This can happen if the user is unable to access on premises AD or intranet zone is not configured correctly","tokenRevoked","tpmError","Webclient Auth request reached maximum timeout - 60000.","popup_window_error"];const y=e=>(e&&(f=[...f,...e]),f),k=()=>f;let C=[];const b=e=>(e&&(C=[...C,...e]),C),T=e=>C.includes(e);var w,_;!function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.SIXTEEN=16]="SIXTEEN",e[e.THIRTY=30]="THIRTY"}(w||(w={})),function(e){e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.SECONDS_FIVE_MINUTES=300]="SECONDS_FIVE_MINUTES",e[e.ONE_HOUR=36e5]="ONE_HOUR"}(_||(_={}));const I="9188040d-6c67-4c5b-b112-36a304b66dad",A="wids",N="74ebf54e-8a4c-453c-a5ea-3ff41b70afe6",E=(w.TWO,_.MILLI_PER_SECOND,_.SECONDS_PER_MINUTE,{SKYPE_REQUEST:"skype_request_start",SKYPE_REQUEST_STOP:"skype_request_stop",SKYPE_SEND_REQUEST:"skype_send_request_start",SKYPE_SEND_REQUEST_STOP:"skype_send_request_stop",SKYPE_RECEIVED_RESPONSE:"skype_received_response",SKYPE_SEND_REQUEST_DESKTOP:"skype_send_request_desktop",SKYPE_SEND_REQUEST_WORKER:"skype_send_request_worker",SKYPE_TOKEN_RECEIVED_WORKER:"skype_token_received_worker",RECEIVE_CLAIM:"receive_claim"}),D={MTO:"MTO"}},14209:(e,t,n)=>{"use strict";n.d(t,{q:()=>a});var i=n(41731);const a=new class{constructor(){this.logLevel=i.in.Info,this.localCallback=void 0,this.error=e=>this.logMessage(i.in.Error,e),this.warning=e=>this.logMessage(i.in.Warning,e),this.warn=e=>this.logMessage(i.in.Warning,e),this.info=e=>this.logMessage(i.in.Info,e),this.log=e=>this.logMessage(i.in.Info,e),this.verbose=e=>this.logMessage(i.in.Verbose,e),this.debug=e=>this.logMessage(i.in.Verbose,e)}initialize(e,t=i.in.Info){this.localCallback=e,this.logLevel=t}executeCallback(e,t){this.localCallback?this.localCallback(e,t):console&&console.log(t)}logMessage(e,t){if(e>this.logLevel)return;const n=`[Auth]: ${t}`;this.executeCallback(e,n)}}},90649:(e,t,n)=>{"use strict";n.d(t,{OU:()=>c,cv:()=>g,ld:()=>m,Tu:()=>p});var i=n(13637),a=n(14209),o=n(12354),r=n(6554);class s{}s._authTelemetryCollection={},s._correlationMap={},s.getAuthTelemetry=e=>s._authTelemetryCollection[e],s.setAuthTelemetry=(e,t)=>s._authTelemetryCollection[e]=t,s.delete=e=>{delete s._authTelemetryCollection[e];const t=Object.keys(s._correlationMap);for(const n in t)if(s._correlationMap.hasOwnProperty(t[n])){const i=t[n],a=s._correlationMap[i];a&&(s._correlationMap[i]=a.filter((t=>t!==e)))}},s.getCorrelation=e=>s._correlationMap[e],s.setCorrelation=e=>{const t=s.getCorrelation(e.scenarioName)||[];-1===t.indexOf(e.id)&&t.push(e.id),s._correlationMap[e.scenarioName]=t};class l{constructor(e,t,n,i,l,d,c){this._scenarioFactory=e,this._correlation=t,this._subContext=n,this._shouldCreateScenario=i,this._telemetryService=d,this._eventData=[],this._loggingPrefix="",this.appendScenarioEventData=e=>{this._scenario?this._scenario.appendEventData(e):this.addEventData([(0,o.u4)(e)])},this.addEventData=e=>{Array.prototype.push.apply(this._eventData,e)},this.getEventData=()=>[...this._eventData],this.addScenarioMark=(e,t={},n)=>{n=this._mapEventData(t,n),this._scenario?this._scenario.mark(e,t,n):this.addEventData([`${e}:${n}`]),a.q.log(`${this._loggingPrefix} [${e}][${n}][e][${(0,o.u4)(t)}]`)},this.closeScenario=(e={},t,n)=>{if(t=this._mapEventData(e,t),n)return e.reason&&this.addEventData([`reason:${e.reason}`]),e.errorCode&&this.addEventData([`errorCode:${e.errorCode}`]),void this.addEventData([`${this._subContext}$:${t}`]);if(!this._scenario){const t=this._shouldCreateScenario?a.q.warn:a.q.log,n=this._shouldCreateScenario?"[N/A]":"";return this.logEventData(t,`${this._loggingPrefix} [stop]${n} [e]`,e),void s.delete(this._correlation.id)}switch(t){case"incomplete":this._scenario.incomplete(e);break;case"failure":this._scenario.fail(e);break;case"abandoned":this._scenario.cancel(e);break;default:this._scenario.stop(e)}const i="failure"===t?a.q.error:a.q.log;this.logEventData(i,`${this._loggingPrefix} [stop][${t}] [e]`,e),s.delete(this._correlation.id)},this.createScenario=(e,t,n)=>{this._scenario?a.q.warn(`createScenario called with [${this._subContext}][${(0,o.u4)(this._correlation)}]::${e}, but there is already a scenario with that correltion id`):(this._createScenario(e,n),t&&this.appendScenarioEventData(t),a.q.log(`${this._loggingPrefix} [create] - scenario created`))},this.setUserToTelemetryContext=e=>{var t,n,i,a,o;if(e){const{id:r,oid:s,tid:l,type:d,role:c}=e;void 0!==r&&(null===(t=this._telemetryService)||void 0===t||t.setCoreContext("userId",r===s?"":r)),void 0!==s&&(null===(n=this._telemetryService)||void 0===n||n.setCoreContext("UserInfo.Id",s)),void 0!==l&&(null===(i=this._telemetryService)||void 0===i||i.setCoreContext("UserInfo.TenantId",l)),void 0!==d&&(null===(a=this._telemetryService)||void 0===a||a.setCoreContext("UserInfo.Type",d)),void 0!==c&&(null===(o=this._telemetryService)||void 0===o||o.setCoreContext("UserInfo.Role",c)),this.addScenarioMark(`${this._correlation.scenarioName}_set_user_on_telemetry_context`)}},this.setUserDetailsToTelemetryContext=e=>{var t;if(e){const{region:n}=e;void 0!==n&&(null===(t=this._telemetryService)||void 0===t||t.setCoreContext("UserInfo.Region",n)),this.addScenarioMark(`${this._correlation.scenarioName}_set_tenant_details_on_telemetry_context`)}},this._mapEventData=(e,t)=>{var n,i;return e.subContext=e.subContext||this._subContext,e.error&&(e.message=`[message]${null!==(n=e.message)&&void 0!==n?n:""} [errorMessage]${e.error.message}`,e.errorCode=null!==(i=e.error.code)&&void 0!==i?i:e.error.errorCode,this.addEventData([`errorCode:${e.error.errorCode}`])),!t&&e.error&&(t=(0,r.ZG)(e.error)?"incomplete":"failure"),e.eventData=this._eventData.join(","),t=t||"success"},this._createScenario=(e,t)=>{var n,i,o;const r=t?{timeoutMs:t}:{};this._scenario=null!==(n=this._scenarioFactory.findScenario(e))&&void 0!==n?n:this._scenarioFactory.newScenario(e,r);try{null===(o=(i=this._scenarioFactory).hoistScenarioToCore)||void 0===o||o.call(i,this._scenario)}catch(e){a.q.log(`${this._loggingPrefix} ${e.message}`)}this._scenario.appendEventData({secondaryCorrelationId:this._correlation.id,commandSource:this._correlation.source}),this._shouldCreateScenario=!0},this.loggingPrefix=()=>`[Telemetry][${this._correlation.id}][${this._correlation.scenarioName}]`,this.logEventData=(e,t,n)=>{const i=this.splitStringEqually((0,o.u4)(n));for(const n of i)e(`${t}${n}`)},this.splitStringEqually=(e,t=300)=>{const n=new RegExp(`.{1,${t}}`,"g"),i=e.match(n);return i||[]},this._loggingPrefix=this.loggingPrefix(),i&&(c?this._scenario=c:this._createScenario(this._correlation.scenarioName,l)),a.q.log(`${this._loggingPrefix} [start] - telemetry provider created for ${this._subContext}, source: ${this._correlation.source} with shouldCreateScenario: [${i}]`),this._eventData.push(`^source:${this._correlation.source},fn:${this._subContext}`)}get correlation(){return Object.assign({},this._correlation)}}class d{constructor(e,t){this._scenarioProvider=e,this._telemetryService=t,this.create=e=>this._createScenario(e,!0),this.createNew=e=>{const t=new l(this._scenarioProvider,e.correlation,e.subContext,!0,e.timeoutMs,this._telemetryService);return e.scenarioEventData&&t.appendScenarioEventData(e.scenarioEventData),t},this.createWithoutScenario=e=>this._createScenario(e,!1),this.getCorrelation=e=>s.getCorrelation(e)||[],this._createScenario=(e,t)=>{var n,i;const{correlation:a,subContext:o,scenarioEventData:r,timeoutMs:d,scenario:c}=e;let u=s.getAuthTelemetry(a.id);if(u)u.addEventData([`fn:${o}`]);else{const r=null===(n=this._telemetryService)||void 0===n?void 0:n.getTelemetryServicesCache().get(null===(i=e.scenarioEventData)||void 0===i?void 0:i.accountId);u=new l((null==r?void 0:r.coreScenarioFactory)||this._scenarioProvider,a,o,t,d,(null==r?void 0:r.telemetryService)||this._telemetryService,c),s.setAuthTelemetry(a.id,u)}return r&&u.appendScenarioEventData(r),s.setCorrelation(a),u}}}const c=e=>{var t,n,a,r,s,l;e.options.correlation={id:null!==(n=null===(t=e.options.correlation)||void 0===t?void 0:t.id)&&void 0!==n?n:(0,o.pW)(),scenarioName:null!==(r=null===(a=e.options.correlation)||void 0===a?void 0:a.scenarioName)&&void 0!==r?r:e.scenarioName,source:null!==(l=null===(s=e.options.correlation)||void 0===s?void 0:s.source)&&void 0!==l?l:e.source};const{options:{correlation:d}}=e,c=(0,i._T)(e,["options"]);return u(Object.assign({correlation:d},c))},u=e=>{const{correlation:t,subContext:n,scenarioEventData:i,eventData:a,timeoutMs:o,scenario:r}=e,l=s.getAuthTelemetry(t.id),d=(e.startWithoutScenario?g.createWithoutScenario:g.create)({correlation:t,subContext:n,scenarioEventData:i,timeoutMs:o,scenario:r});a&&d.addEventData(a);return[d,(e,t)=>d.closeScenario(e,t,!!l)]},m=e=>g.getCorrelation(e);let g;const p=(e,t)=>{g||(g=new d(e,t),a.q.log("authTelemetryProvider initialized"))}},60025:(e,t,n)=>{"use strict";n.d(t,{K:()=>a,b:()=>o});var i=n(68602);function a(e){var t;const{oid:n,tid:a,puid:o}=e.profile,r=n||`8:defaultOid:${a}`;return{cloud:e.cloud||i.G7.prod,profile:{objectId:r,tenantId:a,puid:o||null},id:null!==(t=e.id)&&void 0!==t?t:n,isAuthenticated:e.isAuthenticated&&!0,role:e.role||i.w4.Member,type:e.type||i.Ch.Aad,subType:e.subType||i.Yf.Default,loginUserName:e.userName||null}}function o(e){return e.id}},6554:(e,t,n)=>{"use strict";n.d(t,{Tr:()=>a,Yf:()=>o,ZG:()=>r});var i=n(60780);function a(e){const t=new Error(e.message);return Object.assign(t,{context:e.context,subContext:e.subContext,reason:e.reason,errorCode:e.errorCode,serverResponse:e.serverResponse,correlationId:e.correlationId,isExpected:e.isExpected,innerError:e.innerError})}function o(e){return(0,i.gX)().indexOf(e)>=0}function r(e){return e&&(e.isExpected||o(e.errorCode)||!!(t=e.message)&&(0,i.gX)().map((e=>t.indexOf(e)>=0)).filter(Boolean).length>0);var t}},12354:(e,t,n)=>{"use strict";n.d(t,{u4:()=>a,VK:()=>o,pW:()=>l});const i=globalThis;function a(e,t){const n=new WeakSet;return JSON.stringify(e,((e,t)=>{if(!n.has(t)){if(t&&"object"==typeof t){if(n.add(t),t instanceof Map||t instanceof Set)return Array.from(t);if(null==t?void 0:t.errorCode)return t;if(t instanceof Error)return`${t.name}: ${t.message}`;if(t.constructor&&t.constructor!==Object&&t.constructor!==Array||t.prototype)return}return t}}),t)}function o(e,t=!0){if(null==e)return"";if("string"==typeof e)return e;try{return JSON.stringify(e,s(r(t)))}catch(e){return"Stringifying error failed"}}const r=(e=!0)=>(t,n)=>{if(n instanceof Error){const t={};return Object.getOwnPropertyNames(n).forEach((i=>{"stack"===i?e||(t[i]=("string"==typeof n.stack?n.stack:"").split("\n").map((e=>e.trim())).filter((e=>!!e))):t[i]=n[i]})),t}return n},s=e=>{const t=new WeakSet;return(n,i)=>{if("object"==typeof i&&null!==i){if(t.has(i))return;t.add(i)}return e(n,i)}},l=()=>{try{const e=i.msCrypto||i.crypto;return`${[1e7]}-1000-4000-8000-100000000000`.replace(/[018]/g,(t=>(t^e.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)))}catch(e){const t="xxxxxxxx-xxxx-8xxx-yxxx-xxxxxxxxxxxx",n="0123456789abcdef";let i=0,a="";for(let e=0;e<36;e++)"-"!==t[e]&&"4"!==t[e]&&(i=16*Math.random()|0),"x"===t[e]?a+=n[i]:"y"===t[e]?(i&=3,i|=8,a+=n[i]):a+=t[e];return a}}},85330:(e,t,n)=>{"use strict";n.d(t,{iV:()=>a,G5:()=>o,gZ:()=>r});const i="__",a=e=>e.split(i)[1],o=e=>e.split(i)[2],r=e=>{if(e){const t=e.stream,n=null==t?void 0:t.wamsStreamingUrl,i=!!(null==t?void 0:t.decryptionToken),a=e.altStream,o=null==a?void 0:a.wamsStreamingUrl,r=!!(null==a?void 0:a.decryptionToken);return!!(n&&i||o&&r)}return!1}},3605:(e,t,n)=>{"use strict";n.d(t,{sj:()=>i,NI:()=>r,gU:()=>d});var i,a=n(34255);!function(e){e.Adaptive="application/vnd.microsoft.card.adaptive"}(i||(i={}));const o="</at>",r=e=>{var t;const n=null!==(t=e.msTeams)&&void 0!==t?t:e.msteams;if(!n||!(0,a.isObject)(n)||!n.entities)return;let i;try{i=s(n.entities)}catch(e){return}return i},s=e=>{const t=new Map;let n=0;return e.forEach((e=>{e.type&&"mention"===e.type&&!u(e.text)&&e.mentioned&&!u(e.mentioned.id)&&l(e.text)&&!t.has(e.text)&&t.set(e.text,{itemId:(n++).toString(),mentionType:"person",displayName:e.mentioned.name,userId:e.mentioned.id,id:`${e.mentioned.id}|person`})})),t},l=e=>{const t=e.toLowerCase(),n=0===t.lastIndexOf("<at>"),i=t.indexOf(o)===t.length-o.length;return n&&i},d=(e,t,n)=>{c(e,t,n)},c=(e,t,n)=>{(0,a.forEach)(e,((i,o)=>{(0,a.isEqual)(t,{[o]:i})&&n(e),i instanceof Array?(0,a.forEach)(i,(e=>{c(e,t,n)})):(0,a.isObject)(i)&&c(i,t,n)}))},u=e=>!e||!e.trim()},25366:(e,t,n)=>{"use strict";n.d(t,{Hk:()=>o,By:()=>r});var i=n(13637);function a(e,t){if(!e.startsWith("blob"))return Promise.reject("invalid blob url");const n=new XMLHttpRequest;return n.open("GET",e,!0),n.responseType=t,new Promise(((e,t)=>{n.onload=()=>{200===n.status&&n.response?e(n.response):t(200!==n.status?{status:n.status,statusText:n.statusText}:{status:404,statusText:"no response data"})},n.send()}))}function o(e){return(0,i.mG)(this,void 0,void 0,(function*(){return yield a(e,"blob")}))}function r(e){return(0,i.mG)(this,void 0,void 0,(function*(){return e.then((e=>URL.createObjectURL(e)))}))}},42771:(e,t,n)=>{"use strict";n.d(t,{I:()=>a});var i=n(19898);function a(e,t){var n;const a=null!==(n=null==t?void 0:t.clientTypeServiceHeader)&&void 0!==n?n:e.config.clientType,o=null==t?void 0:t.embedContext;return a===i.Bh.CDLWorker?i.Bh.CDLWorker:a===i.Bh.Embed&&o?`${i.Bh.Embed}-${o}`:a}},85369:(e,t,n)=>{"use strict";function i(){const e={};return e.promise=new Promise(((t,n)=>{e.resolve=t,e.reject=n})),e}n.d(t,{P:()=>i})},91902:(e,t,n)=>{"use strict";n.d(t,{cN:()=>i,BC:()=>a,df:()=>o,yX:()=>r,YM:()=>s,cS:()=>l});class i{constructor(e,t,n){this.maxDelay=e,this.initialDelay=t,this.calculate=n,this.errCount=0}get errorCount(){return this.errCount}next(){return Math.min(this.maxDelay,this.calculate(this.initialDelay,++this.errCount))}reset(){this.errCount=0}}class a extends i{constructor(e,t){super(e,t,((e,t)=>Math.pow(e,t)))}}class o extends i{constructor(e,t,n){super(n,e,((e,n)=>e*Math.pow(t,n-1)))}}class r extends i{constructor(e){super(e,e,(()=>e))}}class s extends i{constructor(e){super(e,e,(()=>Math.floor(Math.random()*e)))}}class l extends i{constructor(e,t){super(t,e,((e,t)=>{const n=Math.random()*Math.pow(2,t-1);return Math.floor((.5*Math.pow(4,t-1)+n)*e)}))}}},39419:(e,t,n)=>{"use strict";function i(e){let t=5381;for(let n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return t>>>0}n.d(t,{E:()=>i})},43978:(e,t,n)=>{"use strict";n.d(t,{mT:()=>g});var i=n(13637),a=n(75068),o=n(38923),r=n(82250),s=n(62174),l=n(18548);function d(e){const{code:t=a.jK.Undefined,context:n="DynamicImport",reason:i={innerError:{}}}=e,r=`${n}:${t}`,s=JSON.stringify(e,(0,o.cm)()),d=`[${(0,o.tJ)(s)}]`,c=i.innerError.message,u=i.innerError.request;let m;const g=u&&(0,l.y4)(void 0,(e=>e),u),p=g&&g.hostname,h=g&&g.pathname;if(h){const e=h.slice(h.lastIndexOf("/")+1),t=e.lastIndexOf("-");m=-1!==t?e.slice(0,t):e}return{errorCode:r,errors:d,dataSource:p,referrer:m,message:c}}const c=(e,t)=>(0,i.mG)(void 0,void 0,void 0,(function*(){let n=0;const r=e=>(0,i.mG)(void 0,void 0,void 0,(function*(){const i="DynamicImport",r="recover",l={innerError:e},c=n<2;if(!e.request)throw(0,o.Tr)(i,a.jK.ScriptCodeError,r,l);if(e.type||-1===e.message.indexOf("Loading CSS chunk")){if("ChunkLoadError"===e.name){const n=function(e){let t;switch(e.type){case"missing":t=a.jK.ScriptEvalError;break;case"error":t=a.jK.ScriptLoadError;break;case"timeout":t=a.jK.ChunkLoadTimedOut;break;default:t=a.jK.Undefined}return t}(e),s=(0,o.Tr)(i,n,r,l);if(!c||n===a.jK.ScriptEvalError)throw s;t&&t.appendEventData(d(s))}}else{const e=(0,o.Tr)(i,a.jK.CSSLoadError,r,l);if(!c)throw e;t&&t.appendEventData(d(e))}n++,t&&t.appendEventData({size:n}),"timeout"===e.type&&(n=2),yield(0,s._)(2e3)}));for(;;)try{return yield e()}catch(e){yield r(e)}}));var u;!function(e){e[e.Loading=0]="Loading",e[e.Loaded=1]="Loaded",e[e.Failed=2]="Failed"}(u||(u={}));const m=new Map,g=(e,t,n)=>(0,i.mG)(void 0,void 0,void 0,(function*(){const i=!m.has(t)||m.get(t)===u.Failed;i&&m.set(t,u.Loading);const a=i?n&&n.createScenarioWithoutStarting(r.RG.DynamicImport,{timeoutMs:18e4}):void 0;a&&a.appendEventData({origin:t});try{const i=yield c(e,a);if(m.set(t,u.Loaded),a){const e=a.eventData.size;e&&e>0&&a.stop(),n&&n.clearScenario(a)}return i}catch(e){const n=d(e);a&&a.fail(n),m.set(t,u.Failed);const i=n.referrer||t;throw e.subContext=i,e.message=`${e.code}, failed to load bundle: ${i}`,e}}))},90181:(e,t,n)=>{"use strict";n.d(t,{dR:()=>a,TL:()=>r});var i=n(13637);const a=Symbol("ForEachAsyncIteratorContinue"),o=Symbol("ForEachAsyncIteratorBreak");function r(e,t){let n,r=!1,l=e=>Promise.reject(e);"function"==typeof e.return&&(n=e.return,l=t=>{const i=()=>Promise.reject(t);return n.call(e).then(i,i)});const d=function(e,t){return function(n){return n.done?Promise.resolve(n):function(e,t){return new Promise((n=>n(t(e))))}(n.value,e).then(s,t)}}(t,l);return{next(){return(0,i.mG)(this,void 0,void 0,(function*(){if(r)return this.return();{let t=yield e.next(),n=yield d(t);for(;!n.done&&n.value===a;)t=yield e.next(),n=yield d(t);return n.value===o||n.value===a?this.return():n}}))},return:()=>(r=!0,n?n.call(e).then(d):Promise.resolve({value:void 0,done:!0})),throw:t=>(r=!0,"function"==typeof e.throw?e.throw(t).then(d):Promise.reject(t).catch(l)),[Symbol.asyncIterator](){return this}}}function s(e){return{value:e,done:!1}}},51581:(e,t,n)=>{"use strict";n.d(t,{Uw:()=>a,XC:()=>o,ZT:()=>r,LQ:()=>l,u4:()=>d});var i=n(34255);function a(e,t,n){return e=s(e,t,n=n||o),1===t.length&&"object"==typeof t[0]&&(e=s(e,t[0],n)),e}function o(e){if(null===e)return"null";if(void 0===e)return"undefined";const t=typeof e;if("string"===t)return e;if("number"===t||"boolean"===t)return String(e);if("function"===t)return"";if((0,i.isDate)(e))return e.toISOString();try{return JSON.stringify(e)}catch(t){return d(e)}}function r(e,t){if(!t){const t=e;return t.message||t.name||`${t}`}return o(e)}function s(e,t,n){for(const i in t)t.hasOwnProperty(i)&&(e=e.replace(`{${i}}`,n(t[i])));return l(e)}function l(e){return null==e||0===e.length?e:` ${e}`.substr(1)}function d(e,t){const n=new WeakSet;return JSON.stringify(e,((e,t)=>{if(!n.has(t)){if(t&&"object"==typeof t){if(n.add(t),t instanceof Map||t instanceof Set)return Array.from(t);if(t instanceof Error)return`${t.name}: ${t.message}`;if(t.constructor&&t.constructor!==Object&&t.constructor!==Array||t.prototype)return}return t}}),t)}},66695:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});const i=(e,t={},n)=>{let i;try{if(void 0===e)throw new Error('"undefined" is not valid JSON');i=JSON.parse(e)}catch(e){i=t,null==n||n(e)}return i}},91178:(e,t,n)=>{"use strict";n.d(t,{J:()=>o,G:()=>r});var i=n(38923),a=n(75068);function o(e){if(!e)throw(0,i.Tr)(a.w5.Authentication,a.jK.InvalidInput,"parseJWT",void 0,`invalid token, value = ${e}`);try{const[,t]=e.split("."),n=r(t);return JSON.parse(n)}catch(t){throw(0,i.Tr)(a.w5.Authentication,a.jK.InvalidInput,"parseJWT",{innerError:t},`token contains dot = ${e.includes(".")}; token length = ${e.length}`)}}function r(e){if(!e)throw(0,i.Tr)(a.w5.Authentication,a.jK.InvalidInput,"base64DecodeStringUrlSafe",void 0,`invalid base64 string input, value = ${e}`);return e=e.replace(/-/g,"+").replace(/_/g,"/"),decodeURIComponent(escape(atob(e)))}},67462:(e,t,n)=>{"use strict";n.d(t,{F:()=>a});var i=n(18548);function a(e){const t=(0,i.y4)(e,(e=>e.pathname),e,"https://example.com");return decodeURIComponent(t.slice(t.lastIndexOf("/")+1))}},33107:(e,t,n)=>{"use strict";n.d(t,{g:()=>a});var i=n(34255);const a=(e,t)=>{if((0,i.isArray)(e))return t}},13931:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i,a=n(13637);!function(e){e[e.Value=0]="Value",e[e.Error=1]="Error"}(i||(i={}));var o=n(82250),r=n(34255);class s{constructor(e=100,t,n,i,a){if(this.newScenario=t,this.logger=i,this.getDroppedEventMetadataFn=a,e<0)throw new TypeError("BufferLimit has to be > 0");this._isComplete=!1,this._values=[],this._promiseResolutionFunctions=[],this._bufferLimit=e,this._overflowScenario=null,this._droppedEvents=0,this._operationName=n,this._droppedEventMetadataToCount=new Map}next(e){this._push({type:i.Value,value:e})}error(e){this._push({type:i.Error,error:e})}complete(){for(this._isComplete=!0;this._promiseResolutionFunctions.length>0;)this._promiseResolutionFunctions.shift().resolve({done:!0})}onUnsubscribe(){this.complete(),this._promiseResolutionFunctions=[],this._values=[]}nextPromise(){if(this._overflowScenario&&this._values.length<this._bufferLimit){let e=`AsyncIterableObserver buffer is no longer full for operation ${this._operationName}. Dropped ${this._droppedEvents} events.`;if(this.getDroppedEventMetadataFn){const t=(0,r.maxBy)(Array.from(this._droppedEventMetadataToCount.keys()),(e=>this._droppedEventMetadataToCount.get(e)));e=`${e} Max dropped event metadata: ${t}.`,this._overflowScenario.appendEventData({context:JSON.stringify(Array.from(this._droppedEventMetadataToCount.entries())),reason:t})}this.logger&&this.logger.warn(e),this._overflowScenario.stop({size:this._droppedEvents}),this._overflowScenario=null,this._droppedEvents=0,this._droppedEventMetadataToCount=new Map}if(this._values.length>0){const{type:e,value:t,error:n}=this._values.shift();return e===i.Error?Promise.reject(n):Promise.resolve({done:!1,value:t})}return this._isComplete?Promise.resolve({done:!0}):new Promise(((e,t)=>{this._promiseResolutionFunctions.push({resolve:e,reject:t})}))}_push(e){if(this._promiseResolutionFunctions.length>0){const{resolve:t,reject:n}=this._promiseResolutionFunctions.shift();e.type===i.Error?n(e.error):t({done:!1,value:e.value})}else{if(this._values.length>this._bufferLimit-1){if(this._droppedEvents+=1,this.getDroppedEventMetadataFn&&e.value){const t=this.getDroppedEventMetadataFn(e.value),n=this._droppedEventMetadataToCount.get(t);this._droppedEventMetadataToCount.set(t,n?n+1:1)}throw!this._overflowScenario&&this.newScenario&&(this._overflowScenario=this.newScenario(o.RG.OnAsyncIterableObserverOverflow),this._overflowScenario.appendEventData({operationName:this._operationName})),new Error("AsyncIterableObserver buffer is full, all future events will be dropped")}this._values.push(e)}}}function l(e,t,n,i,a,o,r){return new d(e,t,n,i,a,o,r)}class d{constructor(e,t,n,i,a,o,r){this.error=null;try{this.observer=new s(t,n,i,a,o),this.subscription=e.subscribe(this.observer),this.running=!0,this.cancellationListenerSubscription=null==r?void 0:r.subscribe(this.onCancelledSubscription)}catch(e){this.running=!1,this.error=e}}[Symbol.asyncIterator](){return this}next(){return(0,a.mG)(this,void 0,void 0,(function*(){if(this.running&&this.observer)try{const e=yield this.observer.nextPromise();if(this.running&&!e.done)return e}catch(e){return this.throw(e)}return this.error?this.throw(this.error):this.return()}))}return(e){return this.onCancelledSubscription(),Promise.resolve({done:!0,value:void 0})}throw(e){return this.onCancelledSubscription(),Promise.reject(e)}onCancelledSubscription(){var e,t,n;this.running=!1,null===(e=this.subscription)||void 0===e||e.unsubscribe(),null===(t=this.observer)||void 0===t||t.onUnsubscribe(),null===(n=this.cancellationListenerSubscription)||void 0===n||n.unsubscribe()}}},3700:(e,t,n)=>{"use strict";n.d(t,{i:()=>o});var i=n(13637),a=n(34255);function o(e,t){function n(e){if(!(0,a.isArray)(e)&&!(0,a.isObject)(e)||(0,a.isDate)(e))return e;const n={};(0,a.forOwn)(e,((e,i)=>{n[i]=o(e,t)}));const r=n,s=t;r[s];return(0,i._T)(r,["symbol"==typeof s?s:s+""])}return(0,a.isArray)(e)?e.map(n):n(e)}},31583:(e,t,n)=>{"use strict";n.d(t,{B:()=>o});var i=n(38923),a=n(75068);function o(e,...t){return n=>e(n).then((e=>{if(t.indexOf(e.status)>-1||t.filter(r).map((e=>new RegExp(e.replace(/x/gi,"\\d")))).some((t=>t.test(e.status.toString()))))return e;throw(0,i.Tr)(a.w5.RequireStatus,a.jK.RemoteOperationFailed,a.w5.RequireStatus,{requiredStatus:1===t.length?t[0]:t,status:e.status},void 0,e)}))}function r(e){return"string"==typeof e}},84575:(e,t,n)=>{"use strict";n.d(t,{X:()=>d,m:()=>c});var i=n(13637),a=n(40474),o=n(50103),r=n(38923),s=n(75068),l=n(62174);const d=(e,t)=>(...n)=>(0,i.mG)(void 0,void 0,void 0,(function*(){for(;;)try{return yield e(...n)}catch(e){yield t(e,...n)}})),c=(e,t)=>{const{maxRetries:n,retryWindow:d,backoffTime:c,shouldRetry:u}=t,m=e=>d-(Date.now()-e);return(...t)=>(0,i.mG)(void 0,void 0,void 0,(function*(){const i=Date.now();let d=0,g=m(i);for(;d++<=n&&g>0;)try{return yield Promise.resolve(e.apply(e,t))}catch(e){if(e instanceof a.Y)throw e;const t=yield(0,o.tE)(e);if(u&&!u(t))throw t?(0,r.Tr)(t.context,t.code,t.subContext?t.subContext:"",t.reason,t.message,t.serverResponse):(0,r.Tr)("RetryWithBackoff",s.jK.MaxLimitReached,"elapsed",void 0,`All retries elapsed or retryWindow expired, RetryCount: ${d}, RemainingTime: ${g}`);if(d>=n||m(i)<=0)break;yield(0,l._)(c),g=m(i)}throw(0,r.Tr)("RetryWithBackoff",s.jK.MaxLimitReached,"elapsed",void 0,`All retries elapsed or retryWindow expired, RetryCount: ${d}, RemainingTime: ${g}`)}))}},62174:(e,t,n)=>{"use strict";function i(e){return new Promise(((t,n)=>{e<0?n(new Error("negative timeout")):setTimeout(t,e)}))}n.d(t,{_:()=>i})},25686:(e,t,n)=>{"use strict";n.d(t,{GW:()=>a,Kx:()=>o});const i=/[xy]/g;function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(i,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function o(e,t){return t|e}},25118:(e,t,n)=>{"use strict";n.d(t,{E:()=>r,T:()=>s});var i=n(62174),a=n(75068),o=n(38923);function r(e,t,n,a){return Promise.race([e,(0,i._)(t).then((()=>{throw null==a||a.abort(),l(t,n)}))]).catch((e=>{if(e instanceof DOMException&&"AbortError"===e.name&&20===e.code)throw l(t,n);throw e}))}const s=e=>e&&e.context===a.w5.Timed&&e.code===a.jK.TimedOut,l=(e,t)=>(0,o.Tr)(a.w5.Timed,a.jK.TimedOut,a.w5.Timed,{ms:e},t)},18548:(e,t,n)=>{"use strict";n.d(t,{y4:()=>a,N0:()=>o,Lp:()=>r,DW:()=>s,Nm:()=>d,_K:()=>c,ZN:()=>u,nz:()=>m,IC:()=>g,m:()=>p});var i=n(34255);function a(e,t,n,i){try{return t(new URL(n,i))}catch(t){return e}}function o(e){const t=new URL(e);return t.protocol+"//"+t.host}function r(e){return l(e)}function s(e){return l(e,!0)}function l(e,t=!1){let n=e.indexOf("://");n=n<=0?0:n+"://".length;const a=e.indexOf(":",n),o=e.indexOf("/",n),r=e.indexOf("?",n),s=[o,r,a,e.length],l=Math.min.apply(Math,(0,i.without)(s,-1));if(!t)return e.slice(n,l).toLowerCase();let d=l;if(a===l){const t=[o,r,e.length];d=Math.min.apply(Math,(0,i.without)(t,-1))}return e.slice(d).toLowerCase()}function d(e,t){if(!e)return"";if(e.startsWith("/"))return e;const n=e.indexOf(":");if(n<=0)return"";const i=(e=(e=(e=(e=e.replace(/(\')/g,"%27")).replace(/(\")/g,"%22")).replace(/{/g,"%7B")).replace(/}/g,"%7D")).substring(0,n).toLowerCase();for(const n of t)if(i===n)return e;return"http"===i?`https${e.substring(n)}`:""}function c(e,t){if(!t)return t;const n=new RegExp(`[?&]${e}=([^&#]*)`).exec(t);return n&&n.length>1?decodeURI(n[1]):""}function u(e,t,n){if(!e||!t||e.match(new RegExp(`[?&]${t}=`)))return e;const i=`${e.indexOf("?")>=0?"&":"?"}${t}=${n}`;if(-1!==e.indexOf("#")){const t=e.split("#");return`${t[0]}${i}#${t[1]}`}return`${e}${i}`}const m=(e,t)=>new RegExp(`^(blob:)(${t})`,"i").test(e);function g(e){if(!e)return e;return e.indexOf("#")>=0?e.substring(0,e.indexOf("#")):e}const p=e=>(e.endsWith("/")||(e+="/"),e)},3984:(e,t,n)=>{"use strict";n.d(t,{h:()=>o});var i=n(20448),a=n(42771);function o(e,t,n,o){return{[i.f_.xMsClientType]:(0,a.I)(e,t),[i.f_.xMsClientVersion]:e.config.clientVersion,[i.f_.xMsSessionId]:e.host.sessionId,[i.f_.xMsRequestId]:n||"",[i.f_.xMsClientCaller]:o||""}}},6181:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{gT:()=>i,lP:()=>a,ej:()=>o}),function(e){e[e.Two=2]="Two",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.TWENTY_FOUR=24]="TWENTY_FOUR",e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.MILLI_PER_MINUTE=6e4]="MILLI_PER_MINUTE",e[e.MILLISECONDS_PER_HOUR=36e5]="MILLISECONDS_PER_HOUR",e[e.MILLISECONDS_PER_DAY=864e5]="MILLISECONDS_PER_DAY"}(i||(i={})),function(e){e[e.LOAD_FRAME_TIMEOUT=15e3]="LOAD_FRAME_TIMEOUT",e[e.EXPIRE_OFFSET_SECONDS=600]="EXPIRE_OFFSET_SECONDS",e[e.MT_TOKEN_INTERVAL=12e4]="MT_TOKEN_INTERVAL",e[e.ACQUIRE_TOKEN_TIMEOUT=6e4]="ACQUIRE_TOKEN_TIMEOUT",e[e.DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES=3]="DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES",e[e.DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW=3e4]="DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW",e[e.DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME=2e3]="DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME",e[e.ELECTRON_ACQUIRE_TOKEN_TIMEOUT=22e4]="ELECTRON_ACQUIRE_TOKEN_TIMEOUT",e[e.ACQUIRE_TOKEN_SCENARIO_TIMEOUT=24e4]="ACQUIRE_TOKEN_SCENARIO_TIMEOUT",e[e.DEFAULT_SKYPE_MAX_DELAY_TIME_MS=3e4]="DEFAULT_SKYPE_MAX_DELAY_TIME_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_DURATION_MS=15e3]="DEFAULT_SKYPE_MAX_RETRY_DURATION_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_COUNT=3]="DEFAULT_SKYPE_MAX_RETRY_COUNT",e[e.DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS=1e3]="DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS",e[e.DEFAULT_SKYPE_EXP_DELAY_FACTOR=2]="DEFAULT_SKYPE_EXP_DELAY_FACTOR"}(a||(a={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.AUTHZ_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.UNIFIED_CONSENT_WEB_AUTH_URL="https://consentservice.microsoft.com/web/UnifiedUserConsent.ReadWrite",e.UNIFIED_CONSENT_CHECKIN_AUTH_URL="https://consentservice.microsoft.com/checkin/UnifiedUserConsent.Read"}(o||(o={}))},32531:(e,t,n)=>{"use strict";n.d(t,{x:()=>i});const i=["sq-al","ar-sa","az-latn-az","eu-es","bg-bg","ca-es","zh-cn","zh-sg","zh-hk","zh-mo","zh-tw","hr-hr","cs-cz","da-dk","nl-be","nl-nl","en-au","en-bz","en-ca","en-029","en-in","en-ie","en-jm","en-my","en-nz","en-ph","en-sg","en-za","en-tt","en-gb","en-us","en-zw","et-ee","fil-ph","fi-fi","fr-be","fr-ca","fr-fr","fr-lu","fr-mc","fr-ch","gl-es","ka-ge","de-at","de-de","de-li","de-lu","de-ch","el-gr","he-il","hi-in","hu-hu","is-is","id-id","it-it","it-ch","ja-jp","kk-kz","ko-kr","lv-lv","lt-lt","mk-mk","nb-no","nn-no","pl-pl","pseudo","pseudo_rtl","pt-br","pt-pt","ro-ro","fl-ip","ru-ru","sr-latn-rs","sk-sk","sl-si","es-ar","es-ve","es-bo","es-cl","es-co","es-cr","es-do","es-ec","es-sv","es-gt","es-hn","es-mx","es-ni","es-py","es-pa","es-pe","es-pr","es-es","es-us","es-uy","sv-fi","sv-se","th-th","tr-tr","uk-ua","ca-es-valencia","vi-vn","cy-gb"]},18961:(e,t,n)=>{"use strict";var i;n.d(t,{V:()=>i}),function(e){e.User="8:orgid:",e.Pstn="4:",e.Bot="28:",e.GcchUser="8:gcch:",e.DodUser="8:dod:",e.AcsUser="8:acs:"}(i||(i={}))},57078:(e,t,n)=>{"use strict";n.d(t,{A_:()=>i,kg:()=>a,Xg:()=>o,Z_:()=>r,Yr:()=>s,JJ:()=>l,NO:()=>d,Ix:()=>c,Yx:()=>u,Zd:()=>m,ee:()=>g,bS:()=>p,tL:()=>h,qc:()=>v});const i=6e4,a=1e3,o=60,r=1440,s=3600,l=60,d=1e3,c=24,u=7,m=864e5,g=36e5,p=6e4,h=300;var v,S,f,y,k,C;!function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(v||(v={})),function(e){e.Sunday="sunday",e.Monday="monday",e.Tuesday="tuesday",e.Wednesday="wednesday",e.Thursday="thursday",e.Friday="friday",e.Saturday="saturday"}(S||(S={})),function(e){e.January="January",e.Febuary="February",e.March="March",e.April="April",e.May="May",e.June="June",e.July="July",e.August="August",e.September="September",e.October="October",e.November="November",e.December="December"}(f||(f={})),function(e){e.Day="day",e.Week="week",e.Month="month",e.Year="year"}(y||(y={})),function(e){e.First="first",e.Second="second",e.Third="third",e.Fourth="fourth",e.Last="last"}(k||(k={})),function(e){e.Sunday="sunday",e.Monday="monday",e.Tuesday="tuesday",e.Wednesday="wednesday",e.Thursday="thursday",e.Friday="friday",e.Saturday="saturday"}(C||(C={}));f.January,f.Febuary,f.March,f.April,f.May,f.June,f.July,f.August,f.September,f.October,f.November,f.December},52989:(e,t,n)=>{"use strict";n.d(t,{J:()=>a});var i=n(57078);const a=e=>{const t=/^P.*T(?:([.,\d]+)H)?(?:([.,\d]+)M)?(?:([.,\d]+)S)?/.exec(e);function n(e){return t&&t[e]?Number(t[e].replace(",",".")):0}return n(3)+n(2)*i.JJ+n(1)*i.Yr}},50103:(e,t,n)=>{"use strict";n.d(t,{E6:()=>r,tE:()=>s});var i=n(13637),a=n(75068),o=n(38923);const r=e=>{if(!e)return null;const{graphQLErrors:t}=e;return t&&t.length>0&&t[0]&&t[0].originalError?(0,o.Jn)(t[0].originalError,a.w5.Apollo,a.jK.ApolloError,"getOriginalError",{status:t[0].originalError.code}):null},s=e=>(0,i.mG)(void 0,void 0,void 0,(function*(){if(!e)return null;let t=null;const{graphQLErrors:n,networkError:r}=e;var s;return r&&(t=l(r)),!t&&n&&n.length>0&&n[0].originalError&&(t=yield(s=n[0],(0,i.mG)(void 0,void 0,void 0,(function*(){var e,t,n;let i=null;try{if(i=s.originalError,!(null===(e=null==i?void 0:i.serverResponse)||void 0===e?void 0:e.body))return i;const a=null===(t=null==i?void 0:i.serverResponse)||void 0===t?void 0:t.status,o=yield null===(n=null==i?void 0:i.serverResponse)||void 0===n?void 0:n.body.json();if(!m(o))return i;i.reason={status:a,errorCode:o.errorCode,errorSubCode:o.errorSubCode}}catch(e){}return i})))),t||(t=n&&n.length>0&&n[0]&&n[0].originalError?(0,o.Jn)(n[0].originalError,a.w5.Apollo,a.jK.ApolloError,"getOriginalError",{status:n[0].originalError.code}):null),t})),l=e=>{let t=null;try{const n=JSON.parse(e.message);if(n){const i=JSON.parse(n.message);if(i){const n=JSON.parse(i.reason);n&&(t=Object.assign(Object.assign({},e),{reason:{status:u(n)?n.status:void 0,errorCode:m(n)?n.errorCode:void 0}}))}}}catch(n){t=d(e)}return t},d=e=>{var t;if(!e.serverResponse)return null;const n=Object.assign({},null==e?void 0:e.reason);return(0,o.Tr)(e.context,e.code,e.subContext?e.subContext:"",Object.assign({status:e.serverResponse.status,errorCode:null!==(t=n.errorCode)&&void 0!==t?t:void 0,reason:e.reason},n),e.message,e.serverResponse)},c=e=>"number"==typeof e,u=e=>!!e&&void 0!==e.status&&c(e.status),m=e=>!!e&&void 0!==e.errorCode&&c(e.errorCode)},38923:(e,t,n)=>{"use strict";n.d(t,{o7:()=>r,zg:()=>s,Tr:()=>l,Jn:()=>d,dK:()=>c,O$:()=>u,B9:()=>m,VK:()=>g,qZ:()=>p,Wc:()=>h,K3:()=>v,cm:()=>y,_S:()=>w,tJ:()=>_});var i=n(34255),a=n(75068),o=n(52397);function r(e,t=[]){return e>=500&&e<600&&-1===t.indexOf(e)}function s(e){return a.lX.get(e)||a.jK.Unknown}function l(e,t,n,i,a=`${e}::${n}::${t}`,o,r){const s=new Error(a);return Object.assign(s,{context:e,subContext:n,reason:i,code:t,serverResponse:o,isExpected:r})}function d(e,t,n,i,a,o,r){const s=l(t,n,i,a,o,r);return s.reason=s.reason||{},s.reason.innerError=e,s}function c(e,t,n,a,o){return!(!(t||n||a||o)||!e)&&((void 0===t||e.context===t)&&(void 0===n||e.code===n)&&(void 0===a||!!e.reason&&(0,i.every)(a,((t,n)=>{const a=(null==e?void 0:e.reason)?e.reason[n]:null;return Array.isArray(t)?t.some((e=>(0,i.isEqual)(e,a))):(0,i.isEqual)(t,a)})))&&(void 0===o||e.subContext===o))}function u(e,t,n){return e&&e.reason&&void 0!==e.reason[t]?e.reason[t]:n}function m(e){return e&&e.message?e.message:e}function g(e,t=!0){if(null==e)return"";if("string"==typeof e)return e;try{return JSON.stringify(e,f(S(t)))}catch(e){return"Stringifying error failed"}}function p(e){return e&&e.code?e.code:a.jK.Unknown}function h(e){var t,n,i,a,o,r;return!!((null==e?void 0:e.isExpected)||(null===(i=null===(n=null===(t=null==e?void 0:e.reason)||void 0===t?void 0:t.innerError)||void 0===n?void 0:n.response)||void 0===i?void 0:i.isExpected)||(null===(a=null==e?void 0:e.innerException)||void 0===a?void 0:a.isExpected)||(null===(r=null===(o=null==e?void 0:e.innerException)||void 0===o?void 0:o.reason)||void 0===r?void 0:r.isExpected))}function v(e,t){return e===o.A.RejectHttpError||t===o.A.RejectHttpError}const S=(e=!1)=>(t,n)=>n instanceof Error?Object.assign({name:n.name,message:n.message,stack:e?[]:("string"==typeof n.stack?n.stack:"").split("\n").map((e=>e.trim())).filter((e=>!!e))},n):n,f=e=>{const t=new WeakSet;return(n,i)=>{if("object"==typeof i&&null!==i){if(t.has(i))return;t.add(i)}return e(n,i)}},y=()=>f(S()),k=new RegExp('("[^"]*[.]((doc[x]?)|(xls[x]?)|(ppt[x]?)|(pdf))[^"]*")',"g"),C=new RegExp("\\b[a-zA-Z0-9.!#$%&'*+\\/?^_`{|}~-]+(@|_(A|a)(T|t)_|%40)(?!(T|t)(H|h)(R|r)(E|e)(A|a)(D|d).(V|v)2)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*","g"),b=new RegExp("=+[a-zA-Z0-9.!#$%&'*+\\/?^_`{|}~-]+(@|_(A|a)(T|t)_|%40)(?!(T|t)(H|h)(R|r)(E|e)(A|a)(D|d).(V|v)2)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*","g"),T={file:k,email:C,ssn:new RegExp("(\\d{3}[-]\\d{2}[-]\\d{4})","g"),creditCard:new RegExp("(\\d{4}\\s\\d{4}\\s\\d{4}\\s\\d{4})","g")},w=e=>{if((0,i.isNil)(e)||!(0,i.isString)(e))return e;let t=e;return(0,i.keys)(T).forEach((e=>{t=t.replace(T[e],`${e}-euii`)})),t},_=e=>{if((0,i.isNil)(e)||!(0,i.isString)(e))return e;let t=e;return t=t.replace(b,"=email-euii"),t}},8302:(e,t,n)=>{"use strict";n.d(t,{Fd:()=>o,wm:()=>s,LY:()=>l});var i=n(34255),a=n(78808);function o(e,t){try{const n=r(e);if("https://local.teams.office.com"===new URL(e).origin)return!0;for(const e of(0,i.uniqBy)(t,(e=>e.toLowerCase()))){let t="";const i=e.split(".");for(let e=0;e<i.length;e++)t+=(e>0?"[.]":"")+i[e].replace("*","[^/^.]+");const a=new RegExp(`^https://${t}((/|\\?).*)?$`,"i");if(n.match(a))return!0}}catch(e){return!1}return!1}const r=e=>new URL(e).href,s=e=>"newchat"===e||(null==e?void 0:e.includes("preview")),l=(e,t=a.Cs.Call)=>t===a.Cs.Call&&/<partlist/.test(e)&&!d(e,t),d=(e,t=a.Cs.Call)=>t===a.Cs.Call&&(-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e))},22835:(e,t,n)=>{"use strict";n.d(t,{le:()=>i});const i={filePickerSource:{upload_from_pc:"upload_from_pc",share_from_odb:{key:"share_from_odb",sourceName:"OneDrive",icon:"fluent-onedrive"}},telemetry:{errorCodes:{messageSentBeforeSyncLinkConversion:"MessageAlreadySent",asyncLinkConversionPretransformFailure:"PretransformRuntimeError",asyncLinkMultiplePretransform:"MultiplePretransform",fileSharingErrorBoundaryError:"FileSharingErrorBoundaryError",asyncImportFailed:"AsyncImportFailed",pickerLocaleLoadFailed:"PickerLocaleLoadFailed",itemsViewStringsNotPresentInWindow:"ItemsViewStringsNotPresentInWindow",siteInfoError:"SiteInfoError"},errors:{messageSentBeforeLinkConversion:"message_sent_before_link_conversion"},markers:{auth_token_call_start:"auth_token_call_start",auth_token_received:"auth_token_received",auth_token_empty:"auth_token_empty",auth_token_requested_with_claims_challenge:"auth_token_requested_with_claims_challenge",super_picker_initialisation_auth_token_start:"super_picker_initialisation_auth_token_start",super_picker_initialisation_auth_token_received:"super_picker_initialisation_auth_token_received",super_picker_render_auth_token_start:"super_picker_render_auth_token_start",super_picker_render_auth_token_end:"super_picker_render_auth_token_end",super_picker_render_third_party_providers:"super_picker_render_third_party_providers",render_third_party_providers_start:"render_third_party_providers_start",render_third_party_providers_end:"render_third_party_providers_end",render_third_party_provider_content_start:"render_third_party_provider_content_start",render_third_party_provider_with_provider_type:"render_third_party_provider_with_provider_type",render_third_party_provider_content_end:"render_third_party_provider_content_end",super_picker_render_auth_token_failed:"super_picker_render_auth_token_failed",auth_token_call_failed:"auth_token_call_failed",claims_challenge_auth_token_call_start:"claims_challenge_auth_token_call_start",claims_challenge_auth_token_received:"claims_challenge_auth_token_received",claims_challenge_auth_token_failed:"claims_challenge_auth_token_failed",claims_challenge_auth_token_empty:"claims_challenge_auth_token_empty",site_info_call_started:"site_info_call_started",site_info_data_received:"site_info_data_received",async_bundle_import_start:"async_bundle_import_start",async_bundle_import_complete:"async_bundle_import_complete",picker_locale_load_start:"locale_load_start",picker_locale_retry:"picker_locale_retry",picker_locale_load_end:"picker_locale_load_end",items_view_strings_loaded_on_host:"items_view_strings_loaded_on_host",items_view_strings_loaded_on_parent:"items_view_strings_loaded_on_parent"},reasons:{auth_token_call_failed:"auth_token_call_failed",personal_site_info_query_failed:"personal_site_info_query_failed",personal_site_info_query_empty:"personal_site_info_query_empty",invalid_site_info_data:"invalid_site_info_data",async_bundle_import_fail:"async_bundle_import_fail",picker_locale_load_fail:"picker_locale_load_fail",error_loading_component_package:"error_loading_component_package"}},localeRetries:1,asyncLinkToChicletConversionIdentifier:"unprocessed-filelink",odsp2013IllegalCharsRegex:/[~"#%&*:<>?/\\{|}\r?\n\r]/g,odspM365IllegalCharsRegex:/["*:<>?/\\|\r?\n\r]/g,odspIllegalWordRegex:/_vti_/gi,odspUnsupportedFilenameList:["con","prn","aux","nul","com0","com1","com2","com3","com4","com5","com6","com7","com8","com9","lpt0","lpt1","lpt2","lpt3","lpt4","lpt5","lpt6","lpt7","lpt8","lpt9"],odspUnsupportedFilenameWithExtList:[".lock","desktop.ini"]};var a,o;!function(e){e.Treatment="TEAMS-TREATMENT",e.Control="TEAMS-CONTROL"}(a||(a={})),function(e){e.teamsElectron="TEAMS-ELECTRON",e.teamsWeb="TEAMS-WEB"}(o||(o={}));var r,s;!function(e){e.teamsElectron="TEAMS-ELECTRON",e.teamsWeb="TEAMS-WEB"}(r||(r={})),function(e){e.ODPicker="ODPicker",e.SharePointLink="SharePointLink",e.Slimpicker="Slimpicker",e.Superpicker="Superpicker"}(s||(s={}))},59929:(e,t,n)=>{"use strict";n.d(t,{gD:()=>u,fM:()=>m});var i=n(95831),a=n(98871);const o=new RegExp(a.yH.oneNoteTargetRegex),r=new RegExp(a.yH.oneNoteSectionRegex),s=e=>{const t=o.exec(e);let n="";return t&&(n=t[1]),n},l=e=>{const t=r.exec(e);let n="";return t&&(n=t[1]),n},d=new RegExp(a.yH.oneDriveFile),c=new RegExp(a.yH.sharePointFile),u=(e,t,n)=>{const o=(0,i.Q)(e),r=o?o.replace(a.yH.trailingSlashRegex,""):"";let s=null;if(d.test(e)){s={sourceTeamName:a.HV.personal,sourceChannelName:r.split("/").pop()}}else if(c.test(e)){const t=r.split("/").pop()||"",n=2;s={sourceTeamName:decodeURIComponent(t),sourceChannelName:decodeURIComponent(e.substring(r.length-1).split("/")[n])}}if(t===a.BY.extension&&-1!==(null==n?void 0:n.indexOf(a.BY.extensionWithDot))){const e=p(n);(null==e?void 0:e.sectionGroup)&&s&&(s.sourceChannelName=`${s.sourceChannelName} > ${e.sectionGroup}`),(null==e?void 0:e.section)&&s&&(s.sourceChannelName=`${s.sourceChannelName} > ${e.section}`)}return s},m=(e,t)=>{let n=null;const i=decodeURIComponent(e);let a=s(i),o=l(a),r="";if(o.includes("/")){const e=o.lastIndexOf("/");a=a.substring(e+1),o=o.substring(e+1)}o=g(o);const d=t;t=o;const c=a.indexOf("/");if(-1!==c){const e=a.lastIndexOf("|");let n=a.substring(c+1,e);n=g(n),t=n,r=o}return n={title:t,noteBook:d,section:r},n},g=e=>e.replace(/(?:\\(.))/g,"$1"),p=e=>{let t=null,n="",i="",a="";e&&(n=decodeURIComponent(e));let o=s(n),r=l(o);if(r.includes("/")){const e=r.lastIndexOf("/");if(a=r.substring(0,e),a){const e=a.split("/");let t="";e.forEach((e=>{t=""===t?e:`${t} > ${e}`})),a=t}o=o.substring(e+1),r=r.substring(e+1)}return-1!==o.indexOf("/")&&(i=r),t={sectionGroup:g(a),section:g(i)},t}},95831:(e,t,n)=>{"use strict";n.d(t,{Q:()=>r});var i=n(98871);const a=new RegExp(i.yH.oneDriveFile),o=new RegExp(i.yH.sharePointFile),r=(e,t)=>{if(t){const n=t.replace(i.yH.leadingAndTrailingSlashesRegex,"").split("/");n.pop();const a=n.join("/");return`${new URL(e).origin}/${a}/`}if(o.test(e)){const t=e.match(o);return t?t[0]:null}if(a.test(e)){const t=e.match(a);return t?t[0]:null}return e}},63190:(e,t,n)=>{"use strict";n.d(t,{K3:()=>o,mD:()=>r,f_:()=>s});var i=n(34255),a=n(22835);const o=e=>{if(e){if(-1===e.indexOf("."))return e;{const t=/(.+)\.[^.]+$/.exec(e);if(null==t)return e;{const e=t[1];return void 0!==e?e:""}}}return""},r=e=>{const t=new RegExp("(?:\\.([^.]+))?$").exec(e);return(0,i.toLower)(t&&t[1]?t[1]:"")},s=(e,t=-1,n=!0)=>{let i=o(e),a=e.substr(i.length);if(i=u(n,c(i)),a=u(n,c(a)),i&&t>-1&&(i=i.substr(0,t)),l(i))return;const r=a?`${i}${a}`:i;return d(r)?void 0:r},l=e=>!e||a.le.odspUnsupportedFilenameList.includes(e.toLowerCase()),d=e=>!e||a.le.odspUnsupportedFilenameWithExtList.includes(e.toLowerCase()),c=e=>e.replace(a.le.odspIllegalWordRegex,"vti"),u=(e,t)=>t.replace(e?a.le.odsp2013IllegalCharsRegex:a.le.odspM365IllegalCharsRegex,"").trim()},98871:(e,t,n)=>{"use strict";n.d(t,{as:()=>i,Ho:()=>a,HV:()=>o,yH:()=>r,v$:()=>s,wg:()=>l,BY:()=>d,Bx:()=>c,MI:()=>u,BS:()=>p,Fk:()=>h,Z2:()=>v,Z$:()=>S,Mc:()=>f,xK:()=>y});const i={url:{getDriveItemAndPermissions:"/_api/v2.0/shares/{shareID}",fetchShareInfo:"/_api/v2.0/shares/{shareID}/driveItem",getDriveItemWithId:"/_api/v2.0/sites/root/items/{fileId}/driveItem",defaultPermissionsWithFileId:"/_api/v2.0/sites/root/items/{fileID}/driveItem/commands",getLinkPermissions:"/_api/v2.0/shares/{shareID}/permission",fetchVideoInfoWithThumbnails:"/_api/v2.0/shares/{shareID}/driveItem?$expand=thumbnails",createLinkWithId:"/_api/v2.1/sites/root/items/{id}/driveItem/createLink",createLinkWithShareId:"/_api/v2.1/shares/{shareId}/driveItem/createLink",getSharingInformation:"/_api/web/GetFileById(@a1)/ListItemAllFields/GetSharingInformation?@a1=guid",getSharingInformationByUrl:"_api/web/GetFileByUrl(@a1)/ListItemAllFields/GetSharingInformation?@a1="}},a={THREAD_ID_UPDATE_URL:"beta/teams/recent/files/backfillSpoIds?threadId={channelThreadId}",THREAD_ID_UPDATE_APINAME:"backfillSpoIds"},o={personal:"personal",teams:"teams"},r={leadingAndTrailingSlashesRegex:/(^\/|\/$)/g,oneDriveFile:`.*/${o.personal}/[^/]*/`,sharePointFile:`.*/(${o.teams}|sites)/[^/]*/`,trailingSlashRegex:/\/$/,oneNoteTargetRegex:/target\((.*)\/\)/,oneNoteSectionRegex:/(.*).one\|/,title:/^[^\\\/\:\*\?\"\<\>\|\#\%\t]*$/},s={personal:"personal",sharePoint:"share-point"},l={states:{active:"active",deleted:"deleted",reference:"reference",removed:"removed"}},d={type:"oneNote",extension:"one",extensionWithDot:".one"},c={clientError:-1,ok:200,badRequest:400,unauthorizedAccess:401,forbidden:403,notFound:404,notAcceptable:406,conflict:409,locked:423,tooManyRequests:429,internalServerError:500,serviceUnavailable:503,notModified:304},u={uploadCancelled:"UPLOAD_CANCELLED",conflicted:"-2130575257",conflicted_v2:"-2147024816",conflicted_v3:"nameAlreadyExists",folderDoesNotExist:"-2147024893",locked:"-2147018894",spQuotaReached:"-2147023080",quotaLimitReached:"quotaLimitReached",fileNotFound:"-2130575338",itemNotFound:"itemNotFound",fileAccessDenied:"FileAccessDenied",sessionInProgress:"-2130575142",unauthorizedAccessException:"-2147024891",cobaltException:"-1, Cobalt.ErrorException",resourceLockedException:"-2147018887",audienceUriValidationFailedException:"Microsoft.IdentityModel.Tokens.AudienceUriValidationFailedException",unauthenticated:"unauthenticated",invalidAudienceUri:"invalidAudienceUri",siteRenameFailure:"-2147024809",notAllowed:"notAllowed",resourceLocked:"resourceLocked"};var m,g,p,h;!function(e){e.filePropertiesMissing="FILE_PROPERTIES_MISSING",e.maxFilesAttachment="MAX_FILES_ATTACHMENT",e.nullFiles="NULL_FILES",e.zeroSizeFile="ZERO_SIZE_FILE",e.titleContainSpecialCharacter="TITLE_CONTAIN_SPECIAL_CHARACTER",e.blacklistedFiletype="BLACK_LIST_FILE_TYPE",e.fileNameTooLong="FILE_NAME_TOO_LONG",e.siteInfoNotFound="SITE_INFO_NOT_FOUND",e.spQuotaReached="SP_QUOTA_REACHED",e.fileNotPresent="FILE_NOT_PRESENT",e.fileAccessDenied="FILE_ACCESS_DENIED",e.fileLocked="FILE_LOCKED",e.siteNotProvisioned="SITE_NOT_PROVISIONED",e.siteNotProvisionedSubtext="SITE_NOT_PROVISIONED_SUBTEXT",e.channelSiteNotProvisioned="CHANNEL_SITE_NOT_PROVISIONED",e.channelSiteNotProvisionedSubtext="CHANNEL_SITE_NOT_PROVISIONED_SUBTEXT",e.fileAlreadyAttachedInMessage="FILE_WITH_SAME_NAME_ALREADY_ATTACHED_IN_MESSAGE",e.audienceUriValidationFailed="INVALID_AUDIENCE_URI"}(m||(m={})),function(e){e.UNKNOWN_UPLOAD_ERROR="UNKNOWN_UPLOAD_ERROR"}(g||(g={})),function(e){e.InvalidRequest="invalidRequest",e.Unhandled="Unhandled"}(p||(p={})),function(e){e.ShareLinkCSL="files_messages_sharelink_csl",e.ShareLinkPSLWithoutIndividualAccess="files_messages_sharelink_psl_without_individual_access",e.ShareLinkPSLWithoutIndividualWrite="files_messages_sharelink_psl_without_individual_write_access",e.ShareLinkPSLWithoutFutureAccess="files_messages_sharelink_psl_without_future_access",e.ShareLinkPSLWithoutFullAndFutureAccess="files_messages_sharelink_psl_without_full_and_future_access",e.ShareLinkPSLWithoutWriteAndFutureAccess="files_messages_sharelink_psl_without_write_and_future_access",e.ShareLinkFederatedAndGuestCSL="files_messages_sharelink_federated_and_guest_csl",e.ShareLinkFederatedCSL="files_messages_sharelink_federated_csl"}(h||(h={}));const v=100,S=10485760,f=3e5;var y;!function(e){e.GRAPH_URL_KEY="@microsoft.graph.downloadUrl",e.CONTENT_URL_KEY="@content.downloadUrl"}(y||(y={}));var k;!function(e){e.InvalidURL="InvalidURL",e.InvalidURLProtocol="InvalidURLProtocol",e.Invalid3PURLDomain="Invalid3PURLDomain",e.InvalidSPOOrPersonalSiteDomain="InvalidSPOOrPersonalSiteDomain",e.DifferentURLDomains="DifferentURLDomains"}(k||(k={}))},57792:(e,t,n)=>{"use strict";var i;n.d(t,{z:()=>i}),function(e){e.logErrorMessage="logErrorMessage",e.internalErrorCode="internalErrorCode",e.spoInnerErrorCode="spoInnerErrorCode",e.correlationId="correlationId",e.httpCode="httpCode"}(i||(i={}))},78756:(e,t,n)=>{"use strict";var i;n.d(t,{W:()=>i}),function(e){e.Calendar="Calendar",e.Contacts="Contacts"}(i||(i={}))},23569:(e,t,n)=>{"use strict";var i;n.d(t,{zj:()=>i,Dx:()=>a,$4:()=>o}),function(e){e.color="color",e.bgColor="background-color",e.background="background",e.itemProps="data-itemprops",e.itemtype="itemtype",e.mentionId="data-mention-id",e.height="height",e.itemid="itemid",e.itemscope="itemscope",e.src="src",e.style="style",e.width="width",e.alt="alt",e.mri="mri",e.stale="stale",e.type="type",e.originalSrc="originalsrc",e.cacheKey="data-cache-key",e.duration="data-duration",e.uploadProgress="data-upload-progress",e.thumbnailUploadProgress="data-thumbnail-upload-progress"}(i||(i={}));const a=["abbr","align","alt","axis","aria-label","bgcolor","border","cellpadding","cellspacing","class","clear","color","cols","colspan","compact","content","contenteditable","coords","data-ams-src","data-duration","data-inline-image","data-itemprops","data-preview-src","data-src","data-ts-imgid","data-ts-imglen","dir","face","fluid-url","headers","height","href","hreflang","hspace","id","ismap","itemid","itemprop","itemscope","itemtype","lang","language","nohref","nowrap","rel","rev","rows","rowspan","rules","scope","scrolling","shape","size","span","src","start","style","summary","target","title","type","usemap","valign","value","vspace","width",...[i.mri,i.type,i.originalSrc,i.stale,i.cacheKey]],o="data-ignore-semantic-link"},82059:(e,t,n)=>{"use strict";var i;n.d(t,{s:()=>i,e:()=>o}),function(e){e.span="span",e.mention="mention",e.sematicObject="semantic-object",e.card="card",e.readonly="readonly",e.spacer="spacer",e.video="video",e.topic="topic"}(i||(i={}));const a=[i.mention,i.sematicObject,i.card,i.readonly,i.spacer,i.video,i.topic],o=["a","abbr","acronym","address","area","article","aside","b","bdi","bdo","big","blockquote","br","caption","center","cite","code","col","colgroup","dd","del","dfn","dir","div","dl","dt","em","figcaption","figure","font","footer","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","img","img","ins","kbd","label","li","map","map","mark","menu","nav","ol","p","pre","q","rp","rp","rt","rt","ruby","s","samp","section","small",i.span,"strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","wbr",...a]},37464:(e,t,n)=>{"use strict";var i;n.d(t,{T:()=>i}),function(e){e.mention="http://schema.skype.com/Mention",e.inputExtension="http://schema.skype.com/InputExtension",e.amsVideo="http://schema.skype.com/AMSVideo",e.amsImage="http://schema.skype.com/AMSImage",e.emoji="http://schema.skype.com/Emoji",e.live="http://schema.skype.com/Live",e.giphy="http://schema.skype.com/Giphy",e.filesHyperlink="http://schema.skype.com/HyperLink/Files",e.hyperLink="http://schema.skype.com/HyperLink",e.reply="http://schema.skype.com/Reply",e.fluidLink="http://schema.skype.com/FluidLink",e.fluidEmbedLink="http://schema.skype.com/FluidEmbedLink",e.fluidEmbedCard="http://schema.skype.com/FluidEmbedCard",e.cachedImage="http://schema.skype.com/CachedImage",e.scheduledMeetingCreated="http://schema.skype.com/ScheduledMeetingCreated",e.scheduledMeetingUpdated="http://schema.skype.com/ScheduledMeetingUpdated",e.scheduledMeetingCancelled="http://schema.skype.com/ScheduledMeetingCancelled",e.topic="http://schema.skype.com/Topic",e.sticker="http://schema.skype.com/Sticker",e.inlineImageCard="http://schema.skype.com/InlineImageCard",e.virtualEventsPersonalizationToken="http://schema.skype.com/VirtualEventsPersonalizationToken"}(i||(i={}))},13242:(e,t,n)=>{"use strict";n.d(t,{P:()=>a});var i=n(46742);function a(e){const t=e.performance;let n,a,o;const r=null==t?void 0:t.memory;return r&&(n=(0,i.kl)(r.jsHeapSizeLimit),a=(0,i.kl)(r.totalJSHeapSize),o=(0,i.kl)(r.usedJSHeapSize)),{jsHeapSizeLimit:n,totalJSHeapSize:a,usedJSHeapSize:o}}},63945:(e,t,n)=>{"use strict";n.d(t,{qB:()=>i,rF:()=>a,IJ:()=>o,Zw:()=>r});const i={SSO_TOKEN:"OutlookSSOToken",ADDIN_ERROR:"OutlookAddInError",SSO_READY:"OutlookSSOReady",USE_CACHED_SSO_TOKEN:"OutlookUseCachedSSOToken",SSO_COMPLETE_TIME:"OutlookSSOCompleteTime",DIALOG_TRIGGER_TIME:"OutlookDialogTriggerTime",CONTEXT:"STTOutlookContext",STEP_MARKERS:"STTOutlookStepMarkers",AUTH_STRAP_ERROR:"STTOutlookAuthStrapError",AUTH_STRAP_REDIRECT_TIME:"STTOutlookAuthStrapRedirect",OAUTH_START_TIME:"OutlookOAuthStartTime",OAUTH_ELAPSED_TIME:"OutlookOAuthElapsedTime",PLATFORM_INFO:"OutlookPlatformInfo",STT_START_TIME:"STTExperienceStartTime"};var a,o,r;!function(e){e[e.HOURS_PER_DAY=24]="HOURS_PER_DAY",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MILLISECS_PER_SECOND=1e3]="MILLISECS_PER_SECOND",e[e.TOKEN_EXP_MINUTE=10]="TOKEN_EXP_MINUTE",e[e.SSO_TIMEOUT_MILLISEC=7e3]="SSO_TIMEOUT_MILLISEC",e[e.SSO_RETRY_INTERVAL=100]="SSO_RETRY_INTERVAL",e[e.SSO_CLAIM_TIMEOUT_MINUTES=5]="SSO_CLAIM_TIMEOUT_MINUTES",e[e.SSO_CLAIM_TIMEOUT_MILLISEC=3e5]="SSO_CLAIM_TIMEOUT_MILLISEC",e[e.SSO_CLAIM_RETRY_INTERVAL=1e3]="SSO_CLAIM_RETRY_INTERVAL",e[e.STT_USAGE_EXPIRATION_DAYS=15]="STT_USAGE_EXPIRATION_DAYS",e[e.STT_USAGE_EXPIRATION_MILLISEC=1296e6]="STT_USAGE_EXPIRATION_MILLISEC"}(a||(a={})),function(e){e.NotProvided="NotProvided",e.Expired="Expired",e.Valid="Valid",e.Invalid="Invalid"}(o||(o={})),function(e){e.SSO="SSO",e.OAuth="OAuth"}(r||(r={}))},75351:(e,t,n)=>{"use strict";n.d(t,{EG:()=>a,Ol:()=>r,DI:()=>s});var i=n(18961);const a=e=>Boolean(e&&e.startsWith(i.V.Pstn)),o=e=>e.indexOf("_"),r=e=>{let t=e.slice(i.V.Pstn.length);const n=o(t);return-1!==n&&(t=t.slice(0,n)),t},s=e=>e?`4:${e.replace(/-/g,"").replace(/\s/g,"")}`:""},36223:(e,t,n)=>{"use strict";function i(e=1){const t=new Uint32Array(e),i=n.g;if(i.msCrypto)i.msCrypto.getRandomValues(t);else if(i.crypto)i.crypto.getRandomValues(t);else{let n=e;for(;n--;){const e=4294967296;t[n]=Math.floor(Math.random()*e)}}return Array.from(t)}n.d(t,{M:()=>i})},15976:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});var i=n(49206),a=n(64452),o=n(70918);const r=(e,t,n,r)=>(0,i.z)((0,a.R)(((n,i)=>Array.from(function*(e,t,n,i){const a=e[Symbol.iterator](),o=t[Symbol.iterator]();let r=a.next(),s=o.next();for(;!s.done||!r.done;)s.done||!r.done&&s.value.id>r.value[0].id?(i(r.value[1]),r=a.next()):r.done||s.value.id<r.value[0].id?(yield[s.value,n(s.value)],s=o.next()):(yield[s.value,r.value[1]],r=a.next(),s=o.next())}(n,Array.from(i).sort(((e,t)=>e.id.localeCompare(t.id))),(t=>{try{return{type:"value",value:e(t)}}catch(e){return r&&r(t,e),{type:"error",error:e}}}),(e=>{if("error"!==e.type)return t(e.value)})))),[]),(0,o.U)((e=>e.filter((e=>"value"===e[1].type)).map((e=>n(e[0],e[1].value))))))},18519:(e,t,n)=>{"use strict";n.d(t,{hN:()=>i,jE:()=>o,PI:()=>c,Xn:()=>u,BN:()=>g,Np:()=>p,cE:()=>v,t_:()=>S,gC:()=>k});var i,a,o,r=n(78808),s=n(96843),l=n(34255),d=n(86631);!function(e){e.TeamsOnly="TeamsOnly",e.SfBOnly="SfBOnly",e.SfBWithTeamsCollab="SfBWithTeamsCollab",e.SfBWithTeamsCollabAndMeetings="SfBWithTeamsCollabAndMeetings",e.Islands="Islands",e.IslandsWithTempInterop="IslandsWithTempInterop",e.IslandsWithVoipDeepLinking="IslandsWithVoipDeepLinking"}(i||(i={})),function(e){e[e.Islands=1]="Islands",e[e.IslandsWithTempInterop=2]="IslandsWithTempInterop",e[e.IslandsWithVoipDeepLinking=3]="IslandsWithVoipDeepLinking",e[e.SfBOnly=4]="SfBOnly",e[e.SfBWithTeamsCollab=5]="SfBWithTeamsCollab",e[e.SfBWithTeamsCollabAndMeetings=6]="SfBWithTeamsCollabAndMeetings",e[e.TeamsOnly=7]="TeamsOnly",e[e.Legacy=8]="Legacy"}(a||(a={})),function(e){e[e.Teams=0]="Teams",e[e.SfB=1]="SfB",e[e.Federated=2]="Federated",e[e.NativeFederated=3]="NativeFederated"}(o||(o={}));const c=e=>!(e!==i.TeamsOnly),u=e=>!(-1===[i.Islands,i.IslandsWithTempInterop,i.IslandsWithVoipDeepLinking].indexOf(e)),m=(e,t,n=!1)=>{const i=[r.Jq,r.Dr,r.iO,r.TO,r.pk,r.P_],a=e.split(":");return i.some((e=>{const i=a.findIndex((t=>t===e.slice(0,-1)));return i>=0&&(n?a.splice(i+1,1):a.splice(i+1,0,t.slice(0,-1)),!0)})),a.join(":")},g=e=>!!e&&!(0,l.startsWith)(r.at.SkypeSpacesUser+r.pW,e)&&e.includes(r.pW),p=e=>!e||g(e)?e:e.includes(r.at.SkypeSpacesUser)?m(e,r.pW):void 0,h=e=>!!e&&!(0,l.startsWith)(r.at.SkypeSpacesUser+r.m_,e)&&e.includes(r.m_),v=e=>!e||h(e)?e:e.includes(r.at.SkypeSpacesUser)?m(e,r.m_):void 0,S=e=>{const t=h(e);return f(e)||g(e)||t?t?e.replace(r.m_,""):e.replace(r.pW,"").replace(r.zt,""):e},f=e=>!!e&&!(0,l.startsWith)(r.at.SkypeSpacesUser+r.zt,e)&&e.includes(r.zt),y=(e,t,n,i)=>{const o=e.isFederated,r=(s=e.mri||"",(0,l.endsWith)(s,"@sfbonprem.unq.gbl.spaces"));var s;if(t&&o&&!r&&e.coExistenceMode){const t=a[e.coExistenceMode],o=n===a.TeamsOnly&&t===a.TeamsOnly;return o||i.log(`isNativeFederationMode is false - currentUserMessagingPolicyMode:${a[n]} recipientCoexistenceMode:${a[t]}`),o}return i.log(`isNativeFederationMode is false - enableNativeP2PFederatedChats:${t} isFederated:${o} isOnPremFederated:${r} coExistenceMode:${e.coExistenceMode}`),!1},k=(e,t,n,i,r,l)=>{if(!(e&&e.mri&&e.userType!==d.vf.guest&&e.type!==d.vf.skypeConsumer&&e.type!==d.vf.tflUser&&(0,s.eZ)(e.mri)))return n.log("getUserChatMode - Defaulting to teams chat mode as user profile is undefined or Guest or TFL user or is not a real user mri"),o.Teams;if(e.isFederated)return n.log(`getUserChatMode - federated user - mri: ${e.mri}, coExistenceMode: ${e.coExistenceMode}`),y(e,r,l,n)?o.NativeFederated:o.Federated;const c=((e,t,n)=>{const i=e.coExistenceMode,r=a[i];if(n.log(`getCoexistenceChatMode - caller: ${t}, mri: ${e.mri}, isShortProfile: ${e.isShortProfile}, coExistenceMode: ${a[r]}, MT coExistenceMode: ${i}`),a[r]!==i&&n.error(`getUserChatMode - Mapping error - coExistenceMode : ${a[r]}, MT coExistenceMode: ${i}`),r){const e=[a.SfBOnly,a.SfBWithTeamsCollab,a.SfBWithTeamsCollabAndMeetings],t=[a.TeamsOnly,a.Islands,a.IslandsWithVoipDeepLinking];if(e.includes(r))return o.SfB;if(t.includes(r))return o.Teams;n.warn(`getUserChatMode - unknown coExistenceMode ${a[r]}`)}else e.isShortProfile||n.warn(`getUserChatMode - full profile has no coExistenceMode for mri ${e.mri}`)})(e,t,n);if(c)return c;const u=g(e.mri),m=e.isSkypeTeamsUser,p=(e=>!(!e.isFederated&&void 0!==e.isPrivateChatEnabled)||e.isPrivateChatEnabled)(e);return n.log(`getUserChatMode - caller: ${t}, mri: ${e.mri}, isSfbMri: ${u}, isTeamsChatEnabled: ${p}, hasLoggedInToTeams: ${m}, isSipDisabled: ${e.isSipDisabled}, isSfBEligible: ${i}`),!u&&m&&p||e.isSipDisabled||!i?o.Teams:o.SfB}},22779:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(7029);const a=(e,t)=>{try{return e.matchMedia(i.s0.ColorContrastOverride).matches?i.f8.Contrast:e.matchMedia(i.s0.Dark).matches?i.f8.Dark:i.f8.Light}catch(e){return void(null==t||t.log(`Couldn't resolve getOsTheme: ${e.message}`))}}},66563:(e,t,n)=>{"use strict";n.d(t,{as:()=>i});const i=(e,t)=>{if(e.is(t))return t;throw new TypeError}},87229:(e,t,n)=>{"use strict";n.d(t,{R2:()=>s,tl:()=>d,VI:()=>c,cJ:()=>u,$N:()=>m,gj:()=>g,pw:()=>p,dp:()=>y,bR:()=>k});const i={landscape:400,portrait:200,square:250},a={landscape:225,portrait:355,square:250},o=1.7777778,r=.5625,s="Video-Clip",l=new RegExp("^[0-9]+/[1-9][0-9]+$"),d=(e,t)=>`${e}/${t}`,c=e=>({progress:+e.split("/")[0],total:+e.split("/")[1]}),u=e=>l.test(e),m=(e,t)=>`${e}v1/objects/${t}/views/video`,g=e=>{const t={height:void 0,width:void 0};if(e.width&&e.height)t.width=+e.width,t.height=+e.height;else if(e.style){e.style.split(";").forEach((e=>{const[n,i]=e.split(":"),a=null==n?void 0:n.trim();if("height"===a||"width"===a){const e=i&&parseInt(i.trim(),10);t[a]=e||void 0}}))}return t},p=(e,t)=>e&&t?e<t?h(e,t):e>t?v(e,t):S():f(),h=(e,t)=>{const n=i.portrait,o=a.portrait;return e/t<r?{width:e/t*o,height:o}:{width:n,height:t/e*n}},v=(e,t)=>{const n=i.landscape,r=a.landscape;return e/t<o?{width:e/t*r,height:r}:{width:n,height:t/e*n}},S=()=>({width:i.square,height:a.square}),f=()=>({width:i.landscape,height:a.landscape}),y={volume:1,muted:!1},k="tmp.onePlayerSettings"},53910:(e,t,n)=>{"use strict";n.d(t,{Sq:()=>i,wX:()=>a,hq:()=>o,ij:()=>r,OE:()=>s,ZU:()=>l,If:()=>d,cQ:()=>c,an:()=>u,JH:()=>m});const i="video-message",a="video-message-gc",o="Creation-Epoch",r="tmp.recorder-status",s=(e,t)=>{const n=parseInt(t||"",10);return isNaN(n)||e-n>144e5},l=(e,t)=>e-t>2592e5,d=e=>u(e,"videoBlob"),c=e=>u(e,"thumbnailBlob"),u=(e,t)=>`${i}?cacheId=${e}&type=${t}`,m=e=>{try{const t=new URL(e);if(t.pathname.slice(Math.max(0,t.pathname.length-i.length))!==i)return;const n=t.searchParams.get("cacheId"),a=t.searchParams.get("type"),o="videoBlob"===a||"thumbnailBlob"===a?a:void 0;return n&&o?{cacheId:n,type:o}:void 0}catch(e){return}}},22057:(e,t,n)=>{var i={"./ar-sa/activity.js":[null],"./ar-sa/artifacts-platform.js":[null],"./ar-sa/audience-view-dialog.js":[null],"./ar-sa/auth.js":[null],"./ar-sa/autosuggest.js":[null],"./ar-sa/avatar.js":[null],"./ar-sa/biometric-enrollment.js":[null],"./ar-sa/breakout-rooms.js":[null],"./ar-sa/broadcast.js":[null],"./ar-sa/calendar.js":[null],"./ar-sa/calling.js":[null],"./ar-sa/campaign-notifications.js":[null],"./ar-sa/carousel-multi-card.js":[null],"./ar-sa/cast.js":[null],"./ar-sa/channels.js":[null],"./ar-sa/chat-list.js":[null],"./ar-sa/coach-report.js":[null],"./ar-sa/communities.js":[null],"./ar-sa/compose.js":[48512,5622],"./ar-sa/contacts.js":[null],"./ar-sa/datepicker.js":[null],"./ar-sa/desktop.js":[null],"./ar-sa/digital-signage.js":[null],"./ar-sa/discover-surface.js":[null],"./ar-sa/edu.js":[null],"./ar-sa/embed.js":[null],"./ar-sa/errors.js":[null],"./ar-sa/esp.js":[null],"./ar-sa/extensibility-ptz-extension.js":[null],"./ar-sa/extensibility-room-remote.js":[null],"./ar-sa/extensibility.js":[null],"./ar-sa/files.js":[null],"./ar-sa/framework.js":[6173,5622],"./ar-sa/freemium-upgrade.js":[null],"./ar-sa/freemium.js":[null],"./ar-sa/funstuff.js":[null],"./ar-sa/gallery.js":[null],"./ar-sa/growth.js":[null],"./ar-sa/guardians.js":[null],"./ar-sa/health.js":[null],"./ar-sa/hololens.js":[null],"./ar-sa/lightbox.js":[null],"./ar-sa/live-persona-card.js":[null],"./ar-sa/lms-integration.js":[null],"./ar-sa/meet-for-work.js":[null],"./ar-sa/meeting-analytics.js":[null],"./ar-sa/meeting-apis-app.js":[null],"./ar-sa/meeting-bot.js":[null],"./ar-sa/meeting-flyout.js":[null],"./ar-sa/meeting-meet-app.js":[null],"./ar-sa/meeting-options.js":[null],"./ar-sa/meeting-recap.js":[null],"./ar-sa/meeting-room-console.js":[null],"./ar-sa/meeting-stream-app.js":[null],"./ar-sa/message-escalate-dialog.js":[null],"./ar-sa/messaging.js":[85498,5622],"./ar-sa/mtma-missed-notifications.js":[null],"./ar-sa/nova.js":[null],"./ar-sa/people-app.js":[null],"./ar-sa/people-picker.js":[null],"./ar-sa/people-targeting.js":[null],"./ar-sa/people.js":[null],"./ar-sa/phonelink-sms.js":[null],"./ar-sa/pre-core.js":[null],"./ar-sa/premium-benefits.js":[null],"./ar-sa/recurrence.js":[null],"./ar-sa/rsc-application-permissions.js":[null],"./ar-sa/search.js":[null],"./ar-sa/semantic-object.js":[null],"./ar-sa/settings.js":[null],"./ar-sa/share-in-meetings.js":[null],"./ar-sa/share-to-teams-outlook-addin.js":[null],"./ar-sa/share-to-teams-third-party.js":[null],"./ar-sa/share-to-teams.js":[null],"./ar-sa/shortcut.js":[null],"./ar-sa/shortcuts.js":[null],"./ar-sa/smart-device.js":[null],"./ar-sa/survey.js":[null],"./ar-sa/sv-flyout.js":[null],"./ar-sa/teams-and-channels.js":[null],"./ar-sa/tfl-onboarding.js":[null],"./ar-sa/toast-notifications.js":[null],"./ar-sa/unified-search.js":[null],"./ar-sa/unsupported-browser.js":[null],"./ar-sa/url-preview.js":[null],"./ar-sa/video-capture.js":[null],"./ar-sa/video-message.js":[null],"./ar-sa/virtual-events.js":[null],"./ar-sa/webinar.js":[87909,5622],"./ar-sa/whats-new.js":[null],"./ar-sa/wiki.js":[null],"./az-latn-az/activity.js":[null],"./az-latn-az/artifacts-platform.js":[null],"./az-latn-az/audience-view-dialog.js":[null],"./az-latn-az/auth.js":[null],"./az-latn-az/autosuggest.js":[null],"./az-latn-az/avatar.js":[null],"./az-latn-az/biometric-enrollment.js":[null],"./az-latn-az/breakout-rooms.js":[null],"./az-latn-az/broadcast.js":[null],"./az-latn-az/calendar.js":[null],"./az-latn-az/calling.js":[null],"./az-latn-az/campaign-notifications.js":[null],"./az-latn-az/carousel-multi-card.js":[null],"./az-latn-az/cast.js":[null],"./az-latn-az/channels.js":[null],"./az-latn-az/chat-list.js":[null],"./az-latn-az/coach-report.js":[null],"./az-latn-az/communities.js":[null],"./az-latn-az/compose.js":[59118,1822],"./az-latn-az/contacts.js":[null],"./az-latn-az/datepicker.js":[null],"./az-latn-az/desktop.js":[null],"./az-latn-az/digital-signage.js":[null],"./az-latn-az/discover-surface.js":[null],"./az-latn-az/edu.js":[null],"./az-latn-az/embed.js":[null],"./az-latn-az/errors.js":[null],"./az-latn-az/esp.js":[null],"./az-latn-az/extensibility-ptz-extension.js":[null],"./az-latn-az/extensibility-room-remote.js":[null],"./az-latn-az/extensibility.js":[null],"./az-latn-az/files.js":[null],"./az-latn-az/framework.js":[67296,1822],"./az-latn-az/freemium-upgrade.js":[null],"./az-latn-az/freemium.js":[null],"./az-latn-az/funstuff.js":[null],"./az-latn-az/gallery.js":[null],"./az-latn-az/growth.js":[null],"./az-latn-az/guardians.js":[null],"./az-latn-az/health.js":[null],"./az-latn-az/hololens.js":[null],"./az-latn-az/lightbox.js":[null],"./az-latn-az/live-persona-card.js":[null],"./az-latn-az/lms-integration.js":[null],"./az-latn-az/meet-for-work.js":[null],"./az-latn-az/meeting-analytics.js":[null],"./az-latn-az/meeting-apis-app.js":[null],"./az-latn-az/meeting-bot.js":[null],"./az-latn-az/meeting-flyout.js":[null],"./az-latn-az/meeting-meet-app.js":[null],"./az-latn-az/meeting-options.js":[null],"./az-latn-az/meeting-recap.js":[null],"./az-latn-az/meeting-room-console.js":[null],"./az-latn-az/meeting-stream-app.js":[null],"./az-latn-az/message-escalate-dialog.js":[null],"./az-latn-az/messaging.js":[46971,1822],"./az-latn-az/mtma-missed-notifications.js":[null],"./az-latn-az/nova.js":[null],"./az-latn-az/people-app.js":[null],"./az-latn-az/people-picker.js":[null],"./az-latn-az/people-targeting.js":[null],"./az-latn-az/people.js":[null],"./az-latn-az/phonelink-sms.js":[null],"./az-latn-az/pre-core.js":[null],"./az-latn-az/premium-benefits.js":[null],"./az-latn-az/recurrence.js":[null],"./az-latn-az/rsc-application-permissions.js":[null],"./az-latn-az/search.js":[null],"./az-latn-az/semantic-object.js":[null],"./az-latn-az/settings.js":[null],"./az-latn-az/share-in-meetings.js":[null],"./az-latn-az/share-to-teams-outlook-addin.js":[null],"./az-latn-az/share-to-teams-third-party.js":[null],"./az-latn-az/share-to-teams.js":[null],"./az-latn-az/shortcut.js":[null],"./az-latn-az/shortcuts.js":[null],"./az-latn-az/smart-device.js":[null],"./az-latn-az/survey.js":[null],"./az-latn-az/sv-flyout.js":[null],"./az-latn-az/teams-and-channels.js":[null],"./az-latn-az/tfl-onboarding.js":[null],"./az-latn-az/toast-notifications.js":[null],"./az-latn-az/unified-search.js":[null],"./az-latn-az/unsupported-browser.js":[null],"./az-latn-az/url-preview.js":[null],"./az-latn-az/video-capture.js":[null],"./az-latn-az/video-message.js":[null],"./az-latn-az/virtual-events.js":[null],"./az-latn-az/webinar.js":[69951,1822],"./az-latn-az/whats-new.js":[null],"./az-latn-az/wiki.js":[null],"./bg-bg/activity.js":[null],"./bg-bg/artifacts-platform.js":[null],"./bg-bg/audience-view-dialog.js":[null],"./bg-bg/auth.js":[null],"./bg-bg/autosuggest.js":[null],"./bg-bg/avatar.js":[null],"./bg-bg/biometric-enrollment.js":[null],"./bg-bg/breakout-rooms.js":[null],"./bg-bg/broadcast.js":[null],"./bg-bg/calendar.js":[null],"./bg-bg/calling.js":[null],"./bg-bg/campaign-notifications.js":[null],"./bg-bg/carousel-multi-card.js":[null],"./bg-bg/cast.js":[null],"./bg-bg/channels.js":[null],"./bg-bg/chat-list.js":[null],"./bg-bg/coach-report.js":[null],"./bg-bg/communities.js":[null],"./bg-bg/compose.js":[40584,747],"./bg-bg/contacts.js":[null],"./bg-bg/datepicker.js":[null],"./bg-bg/desktop.js":[null],"./bg-bg/digital-signage.js":[null],"./bg-bg/discover-surface.js":[null],"./bg-bg/edu.js":[null],"./bg-bg/embed.js":[null],"./bg-bg/errors.js":[null],"./bg-bg/esp.js":[null],"./bg-bg/extensibility-ptz-extension.js":[null],"./bg-bg/extensibility-room-remote.js":[null],"./bg-bg/extensibility.js":[null],"./bg-bg/files.js":[null],"./bg-bg/framework.js":[74608,747],"./bg-bg/freemium-upgrade.js":[null],"./bg-bg/freemium.js":[null],"./bg-bg/funstuff.js":[null],"./bg-bg/gallery.js":[null],"./bg-bg/growth.js":[null],"./bg-bg/guardians.js":[null],"./bg-bg/health.js":[null],"./bg-bg/hololens.js":[null],"./bg-bg/lightbox.js":[null],"./bg-bg/live-persona-card.js":[null],"./bg-bg/lms-integration.js":[null],"./bg-bg/meet-for-work.js":[null],"./bg-bg/meeting-analytics.js":[null],"./bg-bg/meeting-apis-app.js":[null],"./bg-bg/meeting-bot.js":[null],"./bg-bg/meeting-flyout.js":[null],"./bg-bg/meeting-meet-app.js":[null],"./bg-bg/meeting-options.js":[null],"./bg-bg/meeting-recap.js":[null],"./bg-bg/meeting-room-console.js":[null],"./bg-bg/meeting-stream-app.js":[null],"./bg-bg/message-escalate-dialog.js":[null],"./bg-bg/messaging.js":[53968,747],"./bg-bg/mtma-missed-notifications.js":[null],"./bg-bg/nova.js":[null],"./bg-bg/people-app.js":[null],"./bg-bg/people-picker.js":[null],"./bg-bg/people-targeting.js":[null],"./bg-bg/people.js":[null],"./bg-bg/phonelink-sms.js":[null],"./bg-bg/pre-core.js":[null],"./bg-bg/premium-benefits.js":[null],"./bg-bg/recurrence.js":[null],"./bg-bg/rsc-application-permissions.js":[null],"./bg-bg/search.js":[null],"./bg-bg/semantic-object.js":[null],"./bg-bg/settings.js":[null],"./bg-bg/share-in-meetings.js":[null],"./bg-bg/share-to-teams-outlook-addin.js":[null],"./bg-bg/share-to-teams-third-party.js":[null],"./bg-bg/share-to-teams.js":[null],"./bg-bg/shortcut.js":[null],"./bg-bg/shortcuts.js":[null],"./bg-bg/smart-device.js":[null],"./bg-bg/survey.js":[null],"./bg-bg/sv-flyout.js":[null],"./bg-bg/teams-and-channels.js":[null],"./bg-bg/tfl-onboarding.js":[null],"./bg-bg/toast-notifications.js":[null],"./bg-bg/unified-search.js":[null],"./bg-bg/unsupported-browser.js":[null],"./bg-bg/url-preview.js":[null],"./bg-bg/video-capture.js":[null],"./bg-bg/video-message.js":[null],"./bg-bg/virtual-events.js":[null],"./bg-bg/webinar.js":[56834,747],"./bg-bg/whats-new.js":[null],"./bg-bg/wiki.js":[null],"./ca-es-valencia/activity.js":[null],"./ca-es-valencia/artifacts-platform.js":[null],"./ca-es-valencia/audience-view-dialog.js":[null],"./ca-es-valencia/auth.js":[null],"./ca-es-valencia/autosuggest.js":[null],"./ca-es-valencia/avatar.js":[null],"./ca-es-valencia/biometric-enrollment.js":[null],"./ca-es-valencia/breakout-rooms.js":[null],"./ca-es-valencia/broadcast.js":[null],"./ca-es-valencia/calendar.js":[null],"./ca-es-valencia/calling.js":[null],"./ca-es-valencia/campaign-notifications.js":[null],"./ca-es-valencia/carousel-multi-card.js":[null],"./ca-es-valencia/cast.js":[null],"./ca-es-valencia/channels.js":[null],"./ca-es-valencia/chat-list.js":[null],"./ca-es-valencia/coach-report.js":[null],"./ca-es-valencia/communities.js":[null],"./ca-es-valencia/compose.js":[74365,7220],"./ca-es-valencia/contacts.js":[null],"./ca-es-valencia/datepicker.js":[null],"./ca-es-valencia/desktop.js":[null],"./ca-es-valencia/digital-signage.js":[null],"./ca-es-valencia/discover-surface.js":[null],"./ca-es-valencia/edu.js":[null],"./ca-es-valencia/embed.js":[null],"./ca-es-valencia/errors.js":[null],"./ca-es-valencia/esp.js":[null],"./ca-es-valencia/extensibility-ptz-extension.js":[null],"./ca-es-valencia/extensibility-room-remote.js":[null],"./ca-es-valencia/extensibility.js":[null],"./ca-es-valencia/files.js":[null],"./ca-es-valencia/framework.js":[55604,7220],"./ca-es-valencia/freemium-upgrade.js":[null],"./ca-es-valencia/freemium.js":[null],"./ca-es-valencia/funstuff.js":[null],"./ca-es-valencia/gallery.js":[null],"./ca-es-valencia/growth.js":[null],"./ca-es-valencia/guardians.js":[null],"./ca-es-valencia/health.js":[null],"./ca-es-valencia/hololens.js":[null],"./ca-es-valencia/lightbox.js":[null],"./ca-es-valencia/live-persona-card.js":[null],"./ca-es-valencia/lms-integration.js":[null],"./ca-es-valencia/meet-for-work.js":[null],"./ca-es-valencia/meeting-analytics.js":[null],"./ca-es-valencia/meeting-apis-app.js":[null],"./ca-es-valencia/meeting-bot.js":[null],"./ca-es-valencia/meeting-flyout.js":[null],"./ca-es-valencia/meeting-meet-app.js":[null],"./ca-es-valencia/meeting-options.js":[null],"./ca-es-valencia/meeting-recap.js":[null],"./ca-es-valencia/meeting-room-console.js":[null],"./ca-es-valencia/meeting-stream-app.js":[null],"./ca-es-valencia/message-escalate-dialog.js":[null],"./ca-es-valencia/messaging.js":[3674,7220],"./ca-es-valencia/mtma-missed-notifications.js":[null],"./ca-es-valencia/nova.js":[null],"./ca-es-valencia/people-app.js":[null],"./ca-es-valencia/people-picker.js":[null],"./ca-es-valencia/people-targeting.js":[null],"./ca-es-valencia/people.js":[null],"./ca-es-valencia/phonelink-sms.js":[null],"./ca-es-valencia/pre-core.js":[null],"./ca-es-valencia/premium-benefits.js":[null],"./ca-es-valencia/recurrence.js":[null],"./ca-es-valencia/rsc-application-permissions.js":[null],"./ca-es-valencia/search.js":[null],"./ca-es-valencia/semantic-object.js":[null],"./ca-es-valencia/settings.js":[null],"./ca-es-valencia/share-in-meetings.js":[null],"./ca-es-valencia/share-to-teams-outlook-addin.js":[null],"./ca-es-valencia/share-to-teams-third-party.js":[null],"./ca-es-valencia/share-to-teams.js":[null],"./ca-es-valencia/shortcut.js":[null],"./ca-es-valencia/shortcuts.js":[null],"./ca-es-valencia/smart-device.js":[null],"./ca-es-valencia/survey.js":[null],"./ca-es-valencia/sv-flyout.js":[null],"./ca-es-valencia/teams-and-channels.js":[null],"./ca-es-valencia/tfl-onboarding.js":[null],"./ca-es-valencia/toast-notifications.js":[null],"./ca-es-valencia/unified-search.js":[null],"./ca-es-valencia/unsupported-browser.js":[null],"./ca-es-valencia/url-preview.js":[null],"./ca-es-valencia/video-capture.js":[null],"./ca-es-valencia/video-message.js":[null],"./ca-es-valencia/virtual-events.js":[null],"./ca-es-valencia/webinar.js":[34011,7220],"./ca-es-valencia/whats-new.js":[null],"./ca-es-valencia/wiki.js":[null],"./ca-es/activity.js":[null],"./ca-es/artifacts-platform.js":[null],"./ca-es/audience-view-dialog.js":[null],"./ca-es/auth.js":[null],"./ca-es/autosuggest.js":[null],"./ca-es/avatar.js":[null],"./ca-es/biometric-enrollment.js":[null],"./ca-es/breakout-rooms.js":[null],"./ca-es/broadcast.js":[null],"./ca-es/calendar.js":[null],"./ca-es/calling.js":[null],"./ca-es/campaign-notifications.js":[null],"./ca-es/carousel-multi-card.js":[null],"./ca-es/cast.js":[null],"./ca-es/channels.js":[null],"./ca-es/chat-list.js":[null],"./ca-es/coach-report.js":[null],"./ca-es/communities.js":[null],"./ca-es/compose.js":[61357,3240],"./ca-es/contacts.js":[null],"./ca-es/datepicker.js":[null],"./ca-es/desktop.js":[null],"./ca-es/digital-signage.js":[null],"./ca-es/discover-surface.js":[null],"./ca-es/edu.js":[null],"./ca-es/embed.js":[null],"./ca-es/errors.js":[null],"./ca-es/esp.js":[null],"./ca-es/extensibility-ptz-extension.js":[null],"./ca-es/extensibility-room-remote.js":[null],"./ca-es/extensibility.js":[null],"./ca-es/files.js":[null],"./ca-es/framework.js":[8222,3240],"./ca-es/freemium-upgrade.js":[null],"./ca-es/freemium.js":[null],"./ca-es/funstuff.js":[null],"./ca-es/gallery.js":[null],"./ca-es/growth.js":[null],"./ca-es/guardians.js":[null],"./ca-es/health.js":[null],"./ca-es/hololens.js":[null],"./ca-es/lightbox.js":[null],"./ca-es/live-persona-card.js":[null],"./ca-es/lms-integration.js":[null],"./ca-es/meet-for-work.js":[null],"./ca-es/meeting-analytics.js":[null],"./ca-es/meeting-apis-app.js":[null],"./ca-es/meeting-bot.js":[null],"./ca-es/meeting-flyout.js":[null],"./ca-es/meeting-meet-app.js":[null],"./ca-es/meeting-options.js":[null],"./ca-es/meeting-recap.js":[null],"./ca-es/meeting-room-console.js":[null],"./ca-es/meeting-stream-app.js":[null],"./ca-es/message-escalate-dialog.js":[null],"./ca-es/messaging.js":[69388,3240],"./ca-es/mtma-missed-notifications.js":[null],"./ca-es/nova.js":[null],"./ca-es/people-app.js":[null],"./ca-es/people-picker.js":[null],"./ca-es/people-targeting.js":[null],"./ca-es/people.js":[null],"./ca-es/phonelink-sms.js":[null],"./ca-es/pre-core.js":[null],"./ca-es/premium-benefits.js":[null],"./ca-es/recurrence.js":[null],"./ca-es/rsc-application-permissions.js":[null],"./ca-es/search.js":[null],"./ca-es/semantic-object.js":[null],"./ca-es/settings.js":[null],"./ca-es/share-in-meetings.js":[null],"./ca-es/share-to-teams-outlook-addin.js":[null],"./ca-es/share-to-teams-third-party.js":[null],"./ca-es/share-to-teams.js":[null],"./ca-es/shortcut.js":[null],"./ca-es/shortcuts.js":[null],"./ca-es/smart-device.js":[null],"./ca-es/survey.js":[null],"./ca-es/sv-flyout.js":[null],"./ca-es/teams-and-channels.js":[null],"./ca-es/tfl-onboarding.js":[null],"./ca-es/toast-notifications.js":[null],"./ca-es/unified-search.js":[null],"./ca-es/unsupported-browser.js":[null],"./ca-es/url-preview.js":[null],"./ca-es/video-capture.js":[null],"./ca-es/video-message.js":[null],"./ca-es/virtual-events.js":[null],"./ca-es/webinar.js":[45923,3240],"./ca-es/whats-new.js":[null],"./ca-es/wiki.js":[null],"./cs-cz/activity.js":[null],"./cs-cz/artifacts-platform.js":[null],"./cs-cz/audience-view-dialog.js":[null],"./cs-cz/auth.js":[null],"./cs-cz/autosuggest.js":[null],"./cs-cz/avatar.js":[null],"./cs-cz/biometric-enrollment.js":[null],"./cs-cz/breakout-rooms.js":[null],"./cs-cz/broadcast.js":[null],"./cs-cz/calendar.js":[null],"./cs-cz/calling.js":[null],"./cs-cz/campaign-notifications.js":[null],"./cs-cz/carousel-multi-card.js":[null],"./cs-cz/cast.js":[null],"./cs-cz/channels.js":[null],"./cs-cz/chat-list.js":[null],"./cs-cz/coach-report.js":[null],"./cs-cz/communities.js":[null],"./cs-cz/compose.js":[76964,2076],"./cs-cz/contacts.js":[null],"./cs-cz/datepicker.js":[null],"./cs-cz/desktop.js":[null],"./cs-cz/digital-signage.js":[null],"./cs-cz/discover-surface.js":[null],"./cs-cz/edu.js":[null],"./cs-cz/embed.js":[null],"./cs-cz/errors.js":[null],"./cs-cz/esp.js":[null],"./cs-cz/extensibility-ptz-extension.js":[null],"./cs-cz/extensibility-room-remote.js":[null],"./cs-cz/extensibility.js":[null],"./cs-cz/files.js":[null],"./cs-cz/framework.js":[87042,2076],"./cs-cz/freemium-upgrade.js":[null],"./cs-cz/freemium.js":[null],"./cs-cz/funstuff.js":[null],"./cs-cz/gallery.js":[null],"./cs-cz/growth.js":[null],"./cs-cz/guardians.js":[null],"./cs-cz/health.js":[null],"./cs-cz/hololens.js":[null],"./cs-cz/lightbox.js":[null],"./cs-cz/live-persona-card.js":[null],"./cs-cz/lms-integration.js":[null],"./cs-cz/meet-for-work.js":[null],"./cs-cz/meeting-analytics.js":[null],"./cs-cz/meeting-apis-app.js":[null],"./cs-cz/meeting-bot.js":[null],"./cs-cz/meeting-flyout.js":[null],"./cs-cz/meeting-meet-app.js":[null],"./cs-cz/meeting-options.js":[null],"./cs-cz/meeting-recap.js":[null],"./cs-cz/meeting-room-console.js":[null],"./cs-cz/meeting-stream-app.js":[null],"./cs-cz/message-escalate-dialog.js":[null],"./cs-cz/messaging.js":[14264,2076],"./cs-cz/mtma-missed-notifications.js":[null],"./cs-cz/nova.js":[null],"./cs-cz/people-app.js":[null],"./cs-cz/people-picker.js":[null],"./cs-cz/people-targeting.js":[null],"./cs-cz/people.js":[null],"./cs-cz/phonelink-sms.js":[null],"./cs-cz/pre-core.js":[null],"./cs-cz/premium-benefits.js":[null],"./cs-cz/recurrence.js":[null],"./cs-cz/rsc-application-permissions.js":[null],"./cs-cz/search.js":[null],"./cs-cz/semantic-object.js":[null],"./cs-cz/settings.js":[null],"./cs-cz/share-in-meetings.js":[null],"./cs-cz/share-to-teams-outlook-addin.js":[null],"./cs-cz/share-to-teams-third-party.js":[null],"./cs-cz/share-to-teams.js":[null],"./cs-cz/shortcut.js":[null],"./cs-cz/shortcuts.js":[null],"./cs-cz/smart-device.js":[null],"./cs-cz/survey.js":[null],"./cs-cz/sv-flyout.js":[null],"./cs-cz/teams-and-channels.js":[null],"./cs-cz/tfl-onboarding.js":[null],"./cs-cz/toast-notifications.js":[null],"./cs-cz/unified-search.js":[null],"./cs-cz/unsupported-browser.js":[null],"./cs-cz/url-preview.js":[null],"./cs-cz/video-capture.js":[null],"./cs-cz/video-message.js":[null],"./cs-cz/virtual-events.js":[null],"./cs-cz/webinar.js":[94524,2076],"./cs-cz/whats-new.js":[null],"./cs-cz/wiki.js":[null],"./cy-gb/activity.js":[null],"./cy-gb/artifacts-platform.js":[null],"./cy-gb/audience-view-dialog.js":[null],"./cy-gb/auth.js":[null],"./cy-gb/autosuggest.js":[null],"./cy-gb/avatar.js":[null],"./cy-gb/biometric-enrollment.js":[null],"./cy-gb/breakout-rooms.js":[null],"./cy-gb/broadcast.js":[null],"./cy-gb/calendar.js":[null],"./cy-gb/calling.js":[null],"./cy-gb/campaign-notifications.js":[null],"./cy-gb/carousel-multi-card.js":[null],"./cy-gb/cast.js":[null],"./cy-gb/channels.js":[null],"./cy-gb/chat-list.js":[null],"./cy-gb/coach-report.js":[null],"./cy-gb/communities.js":[null],"./cy-gb/compose.js":[2422,2344],"./cy-gb/contacts.js":[null],"./cy-gb/datepicker.js":[null],"./cy-gb/desktop.js":[null],"./cy-gb/digital-signage.js":[null],"./cy-gb/discover-surface.js":[null],"./cy-gb/edu.js":[null],"./cy-gb/embed.js":[null],"./cy-gb/errors.js":[null],"./cy-gb/esp.js":[null],"./cy-gb/extensibility-ptz-extension.js":[null],"./cy-gb/extensibility-room-remote.js":[null],"./cy-gb/extensibility.js":[null],"./cy-gb/files.js":[null],"./cy-gb/framework.js":[21199,2344],"./cy-gb/freemium-upgrade.js":[null],"./cy-gb/freemium.js":[null],"./cy-gb/funstuff.js":[null],"./cy-gb/gallery.js":[null],"./cy-gb/growth.js":[null],"./cy-gb/guardians.js":[null],"./cy-gb/health.js":[null],"./cy-gb/hololens.js":[null],"./cy-gb/lightbox.js":[null],"./cy-gb/live-persona-card.js":[null],"./cy-gb/lms-integration.js":[null],"./cy-gb/meet-for-work.js":[null],"./cy-gb/meeting-analytics.js":[null],"./cy-gb/meeting-apis-app.js":[null],"./cy-gb/meeting-bot.js":[null],"./cy-gb/meeting-flyout.js":[null],"./cy-gb/meeting-meet-app.js":[null],"./cy-gb/meeting-options.js":[null],"./cy-gb/meeting-recap.js":[null],"./cy-gb/meeting-room-console.js":[null],"./cy-gb/meeting-stream-app.js":[null],"./cy-gb/message-escalate-dialog.js":[null],"./cy-gb/messaging.js":[99699,2344],"./cy-gb/mtma-missed-notifications.js":[null],"./cy-gb/nova.js":[null],"./cy-gb/people-app.js":[null],"./cy-gb/people-picker.js":[null],"./cy-gb/people-targeting.js":[null],"./cy-gb/people.js":[null],"./cy-gb/phonelink-sms.js":[null],"./cy-gb/pre-core.js":[null],"./cy-gb/premium-benefits.js":[null],"./cy-gb/recurrence.js":[null],"./cy-gb/rsc-application-permissions.js":[null],"./cy-gb/search.js":[null],"./cy-gb/semantic-object.js":[null],"./cy-gb/settings.js":[null],"./cy-gb/share-in-meetings.js":[null],"./cy-gb/share-to-teams-outlook-addin.js":[null],"./cy-gb/share-to-teams-third-party.js":[null],"./cy-gb/share-to-teams.js":[null],"./cy-gb/shortcut.js":[null],"./cy-gb/shortcuts.js":[null],"./cy-gb/smart-device.js":[null],"./cy-gb/survey.js":[null],"./cy-gb/sv-flyout.js":[null],"./cy-gb/teams-and-channels.js":[null],"./cy-gb/tfl-onboarding.js":[null],"./cy-gb/toast-notifications.js":[null],"./cy-gb/unified-search.js":[null],"./cy-gb/unsupported-browser.js":[null],"./cy-gb/url-preview.js":[null],"./cy-gb/video-capture.js":[null],"./cy-gb/video-message.js":[null],"./cy-gb/virtual-events.js":[null],"./cy-gb/webinar.js":[87450,2344],"./cy-gb/whats-new.js":[null],"./cy-gb/wiki.js":[null],"./da-dk/activity.js":[null],"./da-dk/artifacts-platform.js":[null],"./da-dk/audience-view-dialog.js":[null],"./da-dk/auth.js":[null],"./da-dk/autosuggest.js":[null],"./da-dk/avatar.js":[null],"./da-dk/biometric-enrollment.js":[null],"./da-dk/breakout-rooms.js":[null],"./da-dk/broadcast.js":[null],"./da-dk/calendar.js":[null],"./da-dk/calling.js":[null],"./da-dk/campaign-notifications.js":[null],"./da-dk/carousel-multi-card.js":[null],"./da-dk/cast.js":[null],"./da-dk/channels.js":[null],"./da-dk/chat-list.js":[null],"./da-dk/coach-report.js":[null],"./da-dk/communities.js":[null],"./da-dk/compose.js":[33217,6990],"./da-dk/contacts.js":[null],"./da-dk/datepicker.js":[null],"./da-dk/desktop.js":[null],"./da-dk/digital-signage.js":[null],"./da-dk/discover-surface.js":[null],"./da-dk/edu.js":[null],"./da-dk/embed.js":[null],"./da-dk/errors.js":[null],"./da-dk/esp.js":[null],"./da-dk/extensibility-ptz-extension.js":[null],"./da-dk/extensibility-room-remote.js":[null],"./da-dk/extensibility.js":[null],"./da-dk/files.js":[null],"./da-dk/framework.js":[28214,6990],"./da-dk/freemium-upgrade.js":[null],"./da-dk/freemium.js":[null],"./da-dk/funstuff.js":[null],"./da-dk/gallery.js":[null],"./da-dk/growth.js":[null],"./da-dk/guardians.js":[null],"./da-dk/health.js":[null],"./da-dk/hololens.js":[null],"./da-dk/lightbox.js":[null],"./da-dk/live-persona-card.js":[null],"./da-dk/lms-integration.js":[null],"./da-dk/meet-for-work.js":[null],"./da-dk/meeting-analytics.js":[null],"./da-dk/meeting-apis-app.js":[null],"./da-dk/meeting-bot.js":[null],"./da-dk/meeting-flyout.js":[null],"./da-dk/meeting-meet-app.js":[null],"./da-dk/meeting-options.js":[null],"./da-dk/meeting-recap.js":[null],"./da-dk/meeting-room-console.js":[null],"./da-dk/meeting-stream-app.js":[null],"./da-dk/message-escalate-dialog.js":[null],"./da-dk/messaging.js":[12086,6990],"./da-dk/mtma-missed-notifications.js":[null],"./da-dk/nova.js":[null],"./da-dk/people-app.js":[null],"./da-dk/people-picker.js":[null],"./da-dk/people-targeting.js":[null],"./da-dk/people.js":[null],"./da-dk/phonelink-sms.js":[null],"./da-dk/pre-core.js":[null],"./da-dk/premium-benefits.js":[null],"./da-dk/recurrence.js":[null],"./da-dk/rsc-application-permissions.js":[null],"./da-dk/search.js":[null],"./da-dk/semantic-object.js":[null],"./da-dk/settings.js":[null],"./da-dk/share-in-meetings.js":[null],"./da-dk/share-to-teams-outlook-addin.js":[null],"./da-dk/share-to-teams-third-party.js":[null],"./da-dk/share-to-teams.js":[null],"./da-dk/shortcut.js":[null],"./da-dk/shortcuts.js":[null],"./da-dk/smart-device.js":[null],"./da-dk/survey.js":[null],"./da-dk/sv-flyout.js":[null],"./da-dk/teams-and-channels.js":[null],"./da-dk/tfl-onboarding.js":[null],"./da-dk/toast-notifications.js":[null],"./da-dk/unified-search.js":[null],"./da-dk/unsupported-browser.js":[null],"./da-dk/url-preview.js":[null],"./da-dk/video-capture.js":[null],"./da-dk/video-message.js":[null],"./da-dk/virtual-events.js":[null],"./da-dk/webinar.js":[92657,6990],"./da-dk/whats-new.js":[null],"./da-dk/wiki.js":[null],"./de-de/activity.js":[null],"./de-de/artifacts-platform.js":[null],"./de-de/audience-view-dialog.js":[null],"./de-de/auth.js":[null],"./de-de/autosuggest.js":[null],"./de-de/avatar.js":[null],"./de-de/biometric-enrollment.js":[null],"./de-de/breakout-rooms.js":[null],"./de-de/broadcast.js":[null],"./de-de/calendar.js":[null],"./de-de/calling.js":[null],"./de-de/campaign-notifications.js":[null],"./de-de/carousel-multi-card.js":[null],"./de-de/cast.js":[null],"./de-de/channels.js":[null],"./de-de/chat-list.js":[null],"./de-de/coach-report.js":[null],"./de-de/communities.js":[null],"./de-de/compose.js":[71071,6397],"./de-de/contacts.js":[null],"./de-de/datepicker.js":[null],"./de-de/desktop.js":[null],"./de-de/digital-signage.js":[null],"./de-de/discover-surface.js":[null],"./de-de/edu.js":[null],"./de-de/embed.js":[null],"./de-de/errors.js":[null],"./de-de/esp.js":[null],"./de-de/extensibility-ptz-extension.js":[null],"./de-de/extensibility-room-remote.js":[null],"./de-de/extensibility.js":[null],"./de-de/files.js":[null],"./de-de/framework.js":[9707,6397],"./de-de/freemium-upgrade.js":[null],"./de-de/freemium.js":[null],"./de-de/funstuff.js":[null],"./de-de/gallery.js":[null],"./de-de/growth.js":[null],"./de-de/guardians.js":[null],"./de-de/health.js":[null],"./de-de/hololens.js":[null],"./de-de/lightbox.js":[null],"./de-de/live-persona-card.js":[null],"./de-de/lms-integration.js":[null],"./de-de/meet-for-work.js":[null],"./de-de/meeting-analytics.js":[null],"./de-de/meeting-apis-app.js":[null],"./de-de/meeting-bot.js":[null],"./de-de/meeting-flyout.js":[null],"./de-de/meeting-meet-app.js":[null],"./de-de/meeting-options.js":[null],"./de-de/meeting-recap.js":[null],"./de-de/meeting-room-console.js":[null],"./de-de/meeting-stream-app.js":[null],"./de-de/message-escalate-dialog.js":[null],"./de-de/messaging.js":[32515,6397],"./de-de/mtma-missed-notifications.js":[null],"./de-de/nova.js":[null],"./de-de/people-app.js":[null],"./de-de/people-picker.js":[null],"./de-de/people-targeting.js":[null],"./de-de/people.js":[null],"./de-de/phonelink-sms.js":[null],"./de-de/pre-core.js":[null],"./de-de/premium-benefits.js":[null],"./de-de/recurrence.js":[null],"./de-de/rsc-application-permissions.js":[null],"./de-de/search.js":[null],"./de-de/semantic-object.js":[null],"./de-de/settings.js":[null],"./de-de/share-in-meetings.js":[null],"./de-de/share-to-teams-outlook-addin.js":[null],"./de-de/share-to-teams-third-party.js":[null],"./de-de/share-to-teams.js":[null],"./de-de/shortcut.js":[null],"./de-de/shortcuts.js":[null],"./de-de/smart-device.js":[null],"./de-de/survey.js":[null],"./de-de/sv-flyout.js":[null],"./de-de/teams-and-channels.js":[null],"./de-de/tfl-onboarding.js":[null],"./de-de/toast-notifications.js":[null],"./de-de/unified-search.js":[null],"./de-de/unsupported-browser.js":[null],"./de-de/url-preview.js":[null],"./de-de/video-capture.js":[null],"./de-de/video-message.js":[null],"./de-de/virtual-events.js":[null],"./de-de/webinar.js":[48598,6397],"./de-de/whats-new.js":[null],"./de-de/wiki.js":[null],"./el-gr/activity.js":[null],"./el-gr/artifacts-platform.js":[null],"./el-gr/audience-view-dialog.js":[null],"./el-gr/auth.js":[null],"./el-gr/autosuggest.js":[null],"./el-gr/avatar.js":[null],"./el-gr/biometric-enrollment.js":[null],"./el-gr/breakout-rooms.js":[null],"./el-gr/broadcast.js":[null],"./el-gr/calendar.js":[null],"./el-gr/calling.js":[null],"./el-gr/campaign-notifications.js":[null],"./el-gr/carousel-multi-card.js":[null],"./el-gr/cast.js":[null],"./el-gr/channels.js":[null],"./el-gr/chat-list.js":[null],"./el-gr/coach-report.js":[null],"./el-gr/communities.js":[null],"./el-gr/compose.js":[13030,4766],"./el-gr/contacts.js":[null],"./el-gr/datepicker.js":[null],"./el-gr/desktop.js":[null],"./el-gr/digital-signage.js":[null],"./el-gr/discover-surface.js":[null],"./el-gr/edu.js":[null],"./el-gr/embed.js":[null],"./el-gr/errors.js":[null],"./el-gr/esp.js":[null],"./el-gr/extensibility-ptz-extension.js":[null],"./el-gr/extensibility-room-remote.js":[null],"./el-gr/extensibility.js":[null],"./el-gr/files.js":[null],"./el-gr/framework.js":[13107,4766],"./el-gr/freemium-upgrade.js":[null],"./el-gr/freemium.js":[null],"./el-gr/funstuff.js":[null],"./el-gr/gallery.js":[null],"./el-gr/growth.js":[null],"./el-gr/guardians.js":[null],"./el-gr/health.js":[null],"./el-gr/hololens.js":[null],"./el-gr/lightbox.js":[null],"./el-gr/live-persona-card.js":[null],"./el-gr/lms-integration.js":[null],"./el-gr/meet-for-work.js":[null],"./el-gr/meeting-analytics.js":[null],"./el-gr/meeting-apis-app.js":[null],"./el-gr/meeting-bot.js":[null],"./el-gr/meeting-flyout.js":[null],"./el-gr/meeting-meet-app.js":[null],"./el-gr/meeting-options.js":[null],"./el-gr/meeting-recap.js":[null],"./el-gr/meeting-room-console.js":[null],"./el-gr/meeting-stream-app.js":[null],"./el-gr/message-escalate-dialog.js":[null],"./el-gr/messaging.js":[80246,4766],"./el-gr/mtma-missed-notifications.js":[null],"./el-gr/nova.js":[null],"./el-gr/people-app.js":[null],"./el-gr/people-picker.js":[null],"./el-gr/people-targeting.js":[null],"./el-gr/people.js":[null],"./el-gr/phonelink-sms.js":[null],"./el-gr/pre-core.js":[null],"./el-gr/premium-benefits.js":[null],"./el-gr/recurrence.js":[null],"./el-gr/rsc-application-permissions.js":[null],"./el-gr/search.js":[null],"./el-gr/semantic-object.js":[null],"./el-gr/settings.js":[null],"./el-gr/share-in-meetings.js":[null],"./el-gr/share-to-teams-outlook-addin.js":[null],"./el-gr/share-to-teams-third-party.js":[null],"./el-gr/share-to-teams.js":[null],"./el-gr/shortcut.js":[null],"./el-gr/shortcuts.js":[null],"./el-gr/smart-device.js":[null],"./el-gr/survey.js":[null],"./el-gr/sv-flyout.js":[null],"./el-gr/teams-and-channels.js":[null],"./el-gr/tfl-onboarding.js":[null],"./el-gr/toast-notifications.js":[null],"./el-gr/unified-search.js":[null],"./el-gr/unsupported-browser.js":[null],"./el-gr/url-preview.js":[null],"./el-gr/video-capture.js":[null],"./el-gr/video-message.js":[null],"./el-gr/virtual-events.js":[null],"./el-gr/webinar.js":[89920,4766],"./el-gr/whats-new.js":[null],"./el-gr/wiki.js":[null],"./en-gb/activity.js":[null],"./en-gb/artifacts-platform.js":[null],"./en-gb/audience-view-dialog.js":[null],"./en-gb/auth.js":[null],"./en-gb/autosuggest.js":[null],"./en-gb/avatar.js":[null],"./en-gb/biometric-enrollment.js":[null],"./en-gb/breakout-rooms.js":[null],"./en-gb/broadcast.js":[null],"./en-gb/calendar.js":[null],"./en-gb/calling.js":[null],"./en-gb/campaign-notifications.js":[null],"./en-gb/carousel-multi-card.js":[null],"./en-gb/cast.js":[null],"./en-gb/channels.js":[null],"./en-gb/chat-list.js":[null],"./en-gb/coach-report.js":[null],"./en-gb/communities.js":[null],"./en-gb/compose.js":[29922,4937],"./en-gb/contacts.js":[null],"./en-gb/datepicker.js":[null],"./en-gb/desktop.js":[null],"./en-gb/digital-signage.js":[null],"./en-gb/discover-surface.js":[null],"./en-gb/edu.js":[null],"./en-gb/embed.js":[null],"./en-gb/errors.js":[null],"./en-gb/esp.js":[null],"./en-gb/extensibility-ptz-extension.js":[null],"./en-gb/extensibility-room-remote.js":[null],"./en-gb/extensibility.js":[null],"./en-gb/files.js":[null],"./en-gb/framework.js":[47093,4937],"./en-gb/freemium-upgrade.js":[null],"./en-gb/freemium.js":[null],"./en-gb/funstuff.js":[null],"./en-gb/gallery.js":[null],"./en-gb/growth.js":[null],"./en-gb/guardians.js":[null],"./en-gb/health.js":[null],"./en-gb/hololens.js":[null],"./en-gb/lightbox.js":[null],"./en-gb/live-persona-card.js":[null],"./en-gb/lms-integration.js":[null],"./en-gb/meet-for-work.js":[null],"./en-gb/meeting-analytics.js":[null],"./en-gb/meeting-apis-app.js":[null],"./en-gb/meeting-bot.js":[null],"./en-gb/meeting-flyout.js":[null],"./en-gb/meeting-meet-app.js":[null],"./en-gb/meeting-options.js":[null],"./en-gb/meeting-recap.js":[null],"./en-gb/meeting-room-console.js":[null],"./en-gb/meeting-stream-app.js":[null],"./en-gb/message-escalate-dialog.js":[null],"./en-gb/messaging.js":[69756,4937],"./en-gb/mtma-missed-notifications.js":[null],"./en-gb/nova.js":[null],"./en-gb/people-app.js":[null],"./en-gb/people-picker.js":[null],"./en-gb/people-targeting.js":[null],"./en-gb/people.js":[null],"./en-gb/phonelink-sms.js":[null],"./en-gb/pre-core.js":[null],"./en-gb/premium-benefits.js":[null],"./en-gb/recurrence.js":[null],"./en-gb/rsc-application-permissions.js":[null],"./en-gb/search.js":[null],"./en-gb/semantic-object.js":[null],"./en-gb/settings.js":[null],"./en-gb/share-in-meetings.js":[null],"./en-gb/share-to-teams-outlook-addin.js":[null],"./en-gb/share-to-teams-third-party.js":[null],"./en-gb/share-to-teams.js":[null],"./en-gb/shortcut.js":[null],"./en-gb/shortcuts.js":[null],"./en-gb/smart-device.js":[null],"./en-gb/survey.js":[null],"./en-gb/sv-flyout.js":[null],"./en-gb/teams-and-channels.js":[null],"./en-gb/tfl-onboarding.js":[null],"./en-gb/toast-notifications.js":[null],"./en-gb/unified-search.js":[null],"./en-gb/unsupported-browser.js":[null],"./en-gb/url-preview.js":[null],"./en-gb/video-capture.js":[null],"./en-gb/video-message.js":[null],"./en-gb/virtual-events.js":[null],"./en-gb/webinar.js":[61179,4937],"./en-gb/whats-new.js":[null],"./en-gb/wiki.js":[null],"./en-us/activity.js":[null],"./en-us/artifacts-platform.js":[null],"./en-us/audience-view-dialog.js":[null],"./en-us/auth.js":[null],"./en-us/autosuggest.js":[null],"./en-us/avatar.js":[null],"./en-us/biometric-enrollment.js":[null],"./en-us/breakout-rooms.js":[null],"./en-us/broadcast.js":[null],"./en-us/calendar.js":[null],"./en-us/calling.js":[null],"./en-us/campaign-notifications.js":[null],"./en-us/carousel-multi-card.js":[null],"./en-us/cast.js":[null],"./en-us/channels.js":[null],"./en-us/chat-list.js":[null],"./en-us/coach-report.js":[null],"./en-us/communities.js":[null],"./en-us/compose.js":[52407,906],"./en-us/contacts.js":[null],"./en-us/datepicker.js":[null],"./en-us/desktop.js":[null],"./en-us/digital-signage.js":[null],"./en-us/discover-surface.js":[null],"./en-us/edu.js":[null],"./en-us/embed.js":[null],"./en-us/errors.js":[null],"./en-us/esp.js":[null],"./en-us/extensibility-ptz-extension.js":[null],"./en-us/extensibility-room-remote.js":[null],"./en-us/extensibility.js":[null],"./en-us/files.js":[null],"./en-us/framework.js":[54208,906],"./en-us/freemium-upgrade.js":[null],"./en-us/freemium.js":[null],"./en-us/funstuff.js":[null],"./en-us/gallery.js":[null],"./en-us/growth.js":[null],"./en-us/guardians.js":[null],"./en-us/health.js":[null],"./en-us/hololens.js":[null],"./en-us/lightbox.js":[null],"./en-us/live-persona-card.js":[null],"./en-us/lms-integration.js":[null],"./en-us/meet-for-work.js":[null],"./en-us/meeting-analytics.js":[null],"./en-us/meeting-apis-app.js":[null],"./en-us/meeting-bot.js":[null],"./en-us/meeting-flyout.js":[null],"./en-us/meeting-meet-app.js":[null],"./en-us/meeting-options.js":[null],"./en-us/meeting-recap.js":[null],"./en-us/meeting-room-console.js":[null],"./en-us/meeting-stream-app.js":[null],"./en-us/message-escalate-dialog.js":[null],"./en-us/messaging.js":[17698,906],"./en-us/mtma-missed-notifications.js":[null],"./en-us/nova.js":[null],"./en-us/people-app.js":[null],"./en-us/people-picker.js":[null],"./en-us/people-targeting.js":[null],"./en-us/people.js":[null],"./en-us/phonelink-sms.js":[null],"./en-us/pre-core.js":[null],"./en-us/premium-benefits.js":[null],"./en-us/recurrence.js":[null],"./en-us/rsc-application-permissions.js":[null],"./en-us/search.js":[null],"./en-us/semantic-object.js":[null],"./en-us/settings.js":[null],"./en-us/share-in-meetings.js":[null],"./en-us/share-to-teams-outlook-addin.js":[null],"./en-us/share-to-teams-third-party.js":[null],"./en-us/share-to-teams.js":[null],"./en-us/shortcut.js":[null],"./en-us/shortcuts.js":[null],"./en-us/smart-device.js":[null],"./en-us/survey.js":[null],"./en-us/sv-flyout.js":[null],"./en-us/teams-and-channels.js":[null],"./en-us/tfl-onboarding.js":[null],"./en-us/toast-notifications.js":[null],"./en-us/unified-search.js":[null],"./en-us/unsupported-browser.js":[null],"./en-us/url-preview.js":[null],"./en-us/video-capture.js":[null],"./en-us/video-message.js":[null],"./en-us/virtual-events.js":[null],"./en-us/webinar.js":[89665,906],"./en-us/whats-new.js":[null],"./en-us/wiki.js":[null],"./es-es/activity.js":[null],"./es-es/artifacts-platform.js":[null],"./es-es/audience-view-dialog.js":[null],"./es-es/auth.js":[null],"./es-es/autosuggest.js":[null],"./es-es/avatar.js":[null],"./es-es/biometric-enrollment.js":[null],"./es-es/breakout-rooms.js":[null],"./es-es/broadcast.js":[null],"./es-es/calendar.js":[null],"./es-es/calling.js":[null],"./es-es/campaign-notifications.js":[null],"./es-es/carousel-multi-card.js":[null],"./es-es/cast.js":[null],"./es-es/channels.js":[null],"./es-es/chat-list.js":[null],"./es-es/coach-report.js":[null],"./es-es/communities.js":[null],"./es-es/compose.js":[22715,184],"./es-es/contacts.js":[null],"./es-es/datepicker.js":[null],"./es-es/desktop.js":[null],"./es-es/digital-signage.js":[null],"./es-es/discover-surface.js":[null],"./es-es/edu.js":[null],"./es-es/embed.js":[null],"./es-es/errors.js":[null],"./es-es/esp.js":[null],"./es-es/extensibility-ptz-extension.js":[null],"./es-es/extensibility-room-remote.js":[null],"./es-es/extensibility.js":[null],"./es-es/files.js":[null],"./es-es/framework.js":[81449,184],"./es-es/freemium-upgrade.js":[null],"./es-es/freemium.js":[null],"./es-es/funstuff.js":[null],"./es-es/gallery.js":[null],"./es-es/growth.js":[null],"./es-es/guardians.js":[null],"./es-es/health.js":[null],"./es-es/hololens.js":[null],"./es-es/lightbox.js":[null],"./es-es/live-persona-card.js":[null],"./es-es/lms-integration.js":[null],"./es-es/meet-for-work.js":[null],"./es-es/meeting-analytics.js":[null],"./es-es/meeting-apis-app.js":[null],"./es-es/meeting-bot.js":[null],"./es-es/meeting-flyout.js":[null],"./es-es/meeting-meet-app.js":[null],"./es-es/meeting-options.js":[null],"./es-es/meeting-recap.js":[null],"./es-es/meeting-room-console.js":[null],"./es-es/meeting-stream-app.js":[null],"./es-es/message-escalate-dialog.js":[null],"./es-es/messaging.js":[99921,184],"./es-es/mtma-missed-notifications.js":[null],"./es-es/nova.js":[null],"./es-es/people-app.js":[null],"./es-es/people-picker.js":[null],"./es-es/people-targeting.js":[null],"./es-es/people.js":[null],"./es-es/phonelink-sms.js":[null],"./es-es/pre-core.js":[null],"./es-es/premium-benefits.js":[null],"./es-es/recurrence.js":[null],"./es-es/rsc-application-permissions.js":[null],"./es-es/search.js":[null],"./es-es/semantic-object.js":[null],"./es-es/settings.js":[null],"./es-es/share-in-meetings.js":[null],"./es-es/share-to-teams-outlook-addin.js":[null],"./es-es/share-to-teams-third-party.js":[null],"./es-es/share-to-teams.js":[null],"./es-es/shortcut.js":[null],"./es-es/shortcuts.js":[null],"./es-es/smart-device.js":[null],"./es-es/survey.js":[null],"./es-es/sv-flyout.js":[null],"./es-es/teams-and-channels.js":[null],"./es-es/tfl-onboarding.js":[null],"./es-es/toast-notifications.js":[null],"./es-es/unified-search.js":[null],"./es-es/unsupported-browser.js":[null],"./es-es/url-preview.js":[null],"./es-es/video-capture.js":[null],"./es-es/video-message.js":[null],"./es-es/virtual-events.js":[null],"./es-es/webinar.js":[60716,184],"./es-es/whats-new.js":[null],"./es-es/wiki.js":[null],"./es-mx/activity.js":[null],"./es-mx/artifacts-platform.js":[null],"./es-mx/audience-view-dialog.js":[null],"./es-mx/auth.js":[null],"./es-mx/autosuggest.js":[null],"./es-mx/avatar.js":[null],"./es-mx/biometric-enrollment.js":[null],"./es-mx/breakout-rooms.js":[null],"./es-mx/broadcast.js":[null],"./es-mx/calendar.js":[null],"./es-mx/calling.js":[null],"./es-mx/campaign-notifications.js":[null],"./es-mx/carousel-multi-card.js":[null],"./es-mx/cast.js":[null],"./es-mx/channels.js":[null],"./es-mx/chat-list.js":[null],"./es-mx/coach-report.js":[null],"./es-mx/communities.js":[null],"./es-mx/compose.js":[24017,2701],"./es-mx/contacts.js":[null],"./es-mx/datepicker.js":[null],"./es-mx/desktop.js":[null],"./es-mx/digital-signage.js":[null],"./es-mx/discover-surface.js":[null],"./es-mx/edu.js":[null],"./es-mx/embed.js":[null],"./es-mx/errors.js":[null],"./es-mx/esp.js":[null],"./es-mx/extensibility-ptz-extension.js":[null],"./es-mx/extensibility-room-remote.js":[null],"./es-mx/extensibility.js":[null],"./es-mx/files.js":[null],"./es-mx/framework.js":[63817,2701],"./es-mx/freemium-upgrade.js":[null],"./es-mx/freemium.js":[null],"./es-mx/funstuff.js":[null],"./es-mx/gallery.js":[null],"./es-mx/growth.js":[null],"./es-mx/guardians.js":[null],"./es-mx/health.js":[null],"./es-mx/hololens.js":[null],"./es-mx/lightbox.js":[null],"./es-mx/live-persona-card.js":[null],"./es-mx/lms-integration.js":[null],"./es-mx/meet-for-work.js":[null],"./es-mx/meeting-analytics.js":[null],"./es-mx/meeting-apis-app.js":[null],"./es-mx/meeting-bot.js":[null],"./es-mx/meeting-flyout.js":[null],"./es-mx/meeting-meet-app.js":[null],"./es-mx/meeting-options.js":[null],"./es-mx/meeting-recap.js":[null],"./es-mx/meeting-room-console.js":[null],"./es-mx/meeting-stream-app.js":[null],"./es-mx/message-escalate-dialog.js":[null],"./es-mx/messaging.js":[32222,2701],"./es-mx/mtma-missed-notifications.js":[null],"./es-mx/nova.js":[null],"./es-mx/people-app.js":[null],"./es-mx/people-picker.js":[null],"./es-mx/people-targeting.js":[null],"./es-mx/people.js":[null],"./es-mx/phonelink-sms.js":[null],"./es-mx/pre-core.js":[null],"./es-mx/premium-benefits.js":[null],"./es-mx/recurrence.js":[null],"./es-mx/rsc-application-permissions.js":[null],"./es-mx/search.js":[null],"./es-mx/semantic-object.js":[null],"./es-mx/settings.js":[null],"./es-mx/share-in-meetings.js":[null],"./es-mx/share-to-teams-outlook-addin.js":[null],"./es-mx/share-to-teams-third-party.js":[null],"./es-mx/share-to-teams.js":[null],"./es-mx/shortcut.js":[null],"./es-mx/shortcuts.js":[null],"./es-mx/smart-device.js":[null],"./es-mx/survey.js":[null],"./es-mx/sv-flyout.js":[null],"./es-mx/teams-and-channels.js":[null],"./es-mx/tfl-onboarding.js":[null],"./es-mx/toast-notifications.js":[null],"./es-mx/unified-search.js":[null],"./es-mx/unsupported-browser.js":[null],"./es-mx/url-preview.js":[null],"./es-mx/video-capture.js":[null],"./es-mx/video-message.js":[null],"./es-mx/virtual-events.js":[null],"./es-mx/webinar.js":[94914,2701],"./es-mx/whats-new.js":[null],"./es-mx/wiki.js":[null],"./et-ee/activity.js":[null],"./et-ee/artifacts-platform.js":[null],"./et-ee/audience-view-dialog.js":[null],"./et-ee/auth.js":[null],"./et-ee/autosuggest.js":[null],"./et-ee/avatar.js":[null],"./et-ee/biometric-enrollment.js":[null],"./et-ee/breakout-rooms.js":[null],"./et-ee/broadcast.js":[null],"./et-ee/calendar.js":[null],"./et-ee/calling.js":[null],"./et-ee/campaign-notifications.js":[null],"./et-ee/carousel-multi-card.js":[null],"./et-ee/cast.js":[null],"./et-ee/channels.js":[null],"./et-ee/chat-list.js":[null],"./et-ee/coach-report.js":[null],"./et-ee/communities.js":[null],"./et-ee/compose.js":[41010,8304],"./et-ee/contacts.js":[null],"./et-ee/datepicker.js":[null],"./et-ee/desktop.js":[null],"./et-ee/digital-signage.js":[null],"./et-ee/discover-surface.js":[null],"./et-ee/edu.js":[null],"./et-ee/embed.js":[null],"./et-ee/errors.js":[null],"./et-ee/esp.js":[null],"./et-ee/extensibility-ptz-extension.js":[null],"./et-ee/extensibility-room-remote.js":[null],"./et-ee/extensibility.js":[null],"./et-ee/files.js":[null],"./et-ee/framework.js":[95682,8304],"./et-ee/freemium-upgrade.js":[null],"./et-ee/freemium.js":[null],"./et-ee/funstuff.js":[null],"./et-ee/gallery.js":[null],"./et-ee/growth.js":[null],"./et-ee/guardians.js":[null],"./et-ee/health.js":[null],"./et-ee/hololens.js":[null],"./et-ee/lightbox.js":[null],"./et-ee/live-persona-card.js":[null],"./et-ee/lms-integration.js":[null],"./et-ee/meet-for-work.js":[null],"./et-ee/meeting-analytics.js":[null],"./et-ee/meeting-apis-app.js":[null],"./et-ee/meeting-bot.js":[null],"./et-ee/meeting-flyout.js":[null],"./et-ee/meeting-meet-app.js":[null],"./et-ee/meeting-options.js":[null],"./et-ee/meeting-recap.js":[null],"./et-ee/meeting-room-console.js":[null],"./et-ee/meeting-stream-app.js":[null],"./et-ee/message-escalate-dialog.js":[null],"./et-ee/messaging.js":[33965,8304],"./et-ee/mtma-missed-notifications.js":[null],"./et-ee/nova.js":[null],"./et-ee/people-app.js":[null],"./et-ee/people-picker.js":[null],"./et-ee/people-targeting.js":[null],"./et-ee/people.js":[null],"./et-ee/phonelink-sms.js":[null],"./et-ee/pre-core.js":[null],"./et-ee/premium-benefits.js":[null],"./et-ee/recurrence.js":[null],"./et-ee/rsc-application-permissions.js":[null],"./et-ee/search.js":[null],"./et-ee/semantic-object.js":[null],"./et-ee/settings.js":[null],"./et-ee/share-in-meetings.js":[null],"./et-ee/share-to-teams-outlook-addin.js":[null],"./et-ee/share-to-teams-third-party.js":[null],"./et-ee/share-to-teams.js":[null],"./et-ee/shortcut.js":[null],"./et-ee/shortcuts.js":[null],"./et-ee/smart-device.js":[null],"./et-ee/survey.js":[null],"./et-ee/sv-flyout.js":[null],"./et-ee/teams-and-channels.js":[null],"./et-ee/tfl-onboarding.js":[null],"./et-ee/toast-notifications.js":[null],"./et-ee/unified-search.js":[null],"./et-ee/unsupported-browser.js":[null],"./et-ee/url-preview.js":[null],"./et-ee/video-capture.js":[null],"./et-ee/video-message.js":[null],"./et-ee/virtual-events.js":[null],"./et-ee/webinar.js":[42460,8304],"./et-ee/whats-new.js":[null],"./et-ee/wiki.js":[null],"./eu-es/activity.js":[null],"./eu-es/artifacts-platform.js":[null],"./eu-es/audience-view-dialog.js":[null],"./eu-es/auth.js":[null],"./eu-es/autosuggest.js":[null],"./eu-es/avatar.js":[null],"./eu-es/biometric-enrollment.js":[null],"./eu-es/breakout-rooms.js":[null],"./eu-es/broadcast.js":[null],"./eu-es/calendar.js":[null],"./eu-es/calling.js":[null],"./eu-es/campaign-notifications.js":[null],"./eu-es/carousel-multi-card.js":[null],"./eu-es/cast.js":[null],"./eu-es/channels.js":[null],"./eu-es/chat-list.js":[null],"./eu-es/coach-report.js":[null],"./eu-es/communities.js":[null],"./eu-es/compose.js":[91961,7957],"./eu-es/contacts.js":[null],"./eu-es/datepicker.js":[null],"./eu-es/desktop.js":[null],"./eu-es/digital-signage.js":[null],"./eu-es/discover-surface.js":[null],"./eu-es/edu.js":[null],"./eu-es/embed.js":[null],"./eu-es/errors.js":[null],"./eu-es/esp.js":[null],"./eu-es/extensibility-ptz-extension.js":[null],"./eu-es/extensibility-room-remote.js":[null],"./eu-es/extensibility.js":[null],"./eu-es/files.js":[null],"./eu-es/framework.js":[51524,7957],"./eu-es/freemium-upgrade.js":[null],"./eu-es/freemium.js":[null],"./eu-es/funstuff.js":[null],"./eu-es/gallery.js":[null],"./eu-es/growth.js":[null],"./eu-es/guardians.js":[null],"./eu-es/health.js":[null],"./eu-es/hololens.js":[null],"./eu-es/lightbox.js":[null],"./eu-es/live-persona-card.js":[null],"./eu-es/lms-integration.js":[null],"./eu-es/meet-for-work.js":[null],"./eu-es/meeting-analytics.js":[null],"./eu-es/meeting-apis-app.js":[null],"./eu-es/meeting-bot.js":[null],"./eu-es/meeting-flyout.js":[null],"./eu-es/meeting-meet-app.js":[null],"./eu-es/meeting-options.js":[null],"./eu-es/meeting-recap.js":[null],"./eu-es/meeting-room-console.js":[null],"./eu-es/meeting-stream-app.js":[null],"./eu-es/message-escalate-dialog.js":[null],"./eu-es/messaging.js":[14744,7957],"./eu-es/mtma-missed-notifications.js":[null],"./eu-es/nova.js":[null],"./eu-es/people-app.js":[null],"./eu-es/people-picker.js":[null],"./eu-es/people-targeting.js":[null],"./eu-es/people.js":[null],"./eu-es/phonelink-sms.js":[null],"./eu-es/pre-core.js":[null],"./eu-es/premium-benefits.js":[null],"./eu-es/recurrence.js":[null],"./eu-es/rsc-application-permissions.js":[null],"./eu-es/search.js":[null],"./eu-es/semantic-object.js":[null],"./eu-es/settings.js":[null],"./eu-es/share-in-meetings.js":[null],"./eu-es/share-to-teams-outlook-addin.js":[null],"./eu-es/share-to-teams-third-party.js":[null],"./eu-es/share-to-teams.js":[null],"./eu-es/shortcut.js":[null],"./eu-es/shortcuts.js":[null],"./eu-es/smart-device.js":[null],"./eu-es/survey.js":[null],"./eu-es/sv-flyout.js":[null],"./eu-es/teams-and-channels.js":[null],"./eu-es/tfl-onboarding.js":[null],"./eu-es/toast-notifications.js":[null],"./eu-es/unified-search.js":[null],"./eu-es/unsupported-browser.js":[null],"./eu-es/url-preview.js":[null],"./eu-es/video-capture.js":[null],"./eu-es/video-message.js":[null],"./eu-es/virtual-events.js":[null],"./eu-es/webinar.js":[81415,7957],"./eu-es/whats-new.js":[null],"./eu-es/wiki.js":[null],"./fi-fi/activity.js":[null],"./fi-fi/artifacts-platform.js":[null],"./fi-fi/audience-view-dialog.js":[null],"./fi-fi/auth.js":[null],"./fi-fi/autosuggest.js":[null],"./fi-fi/avatar.js":[null],"./fi-fi/biometric-enrollment.js":[null],"./fi-fi/breakout-rooms.js":[null],"./fi-fi/broadcast.js":[null],"./fi-fi/calendar.js":[null],"./fi-fi/calling.js":[null],"./fi-fi/campaign-notifications.js":[null],"./fi-fi/carousel-multi-card.js":[null],"./fi-fi/cast.js":[null],"./fi-fi/channels.js":[null],"./fi-fi/chat-list.js":[null],"./fi-fi/coach-report.js":[null],"./fi-fi/communities.js":[null],"./fi-fi/compose.js":[42372,6211],"./fi-fi/contacts.js":[null],"./fi-fi/datepicker.js":[null],"./fi-fi/desktop.js":[null],"./fi-fi/digital-signage.js":[null],"./fi-fi/discover-surface.js":[null],"./fi-fi/edu.js":[null],"./fi-fi/embed.js":[null],"./fi-fi/errors.js":[null],"./fi-fi/esp.js":[null],"./fi-fi/extensibility-ptz-extension.js":[null],"./fi-fi/extensibility-room-remote.js":[null],"./fi-fi/extensibility.js":[null],"./fi-fi/files.js":[null],"./fi-fi/framework.js":[51030,6211],"./fi-fi/freemium-upgrade.js":[null],"./fi-fi/freemium.js":[null],"./fi-fi/funstuff.js":[null],"./fi-fi/gallery.js":[null],"./fi-fi/growth.js":[null],"./fi-fi/guardians.js":[null],"./fi-fi/health.js":[null],"./fi-fi/hololens.js":[null],"./fi-fi/lightbox.js":[null],"./fi-fi/live-persona-card.js":[null],"./fi-fi/lms-integration.js":[null],"./fi-fi/meet-for-work.js":[null],"./fi-fi/meeting-analytics.js":[null],"./fi-fi/meeting-apis-app.js":[null],"./fi-fi/meeting-bot.js":[null],"./fi-fi/meeting-flyout.js":[null],"./fi-fi/meeting-meet-app.js":[null],"./fi-fi/meeting-options.js":[null],"./fi-fi/meeting-recap.js":[null],"./fi-fi/meeting-room-console.js":[null],"./fi-fi/meeting-stream-app.js":[null],"./fi-fi/message-escalate-dialog.js":[null],"./fi-fi/messaging.js":[79263,6211],"./fi-fi/mtma-missed-notifications.js":[null],"./fi-fi/nova.js":[null],"./fi-fi/people-app.js":[null],"./fi-fi/people-picker.js":[null],"./fi-fi/people-targeting.js":[null],"./fi-fi/people.js":[null],"./fi-fi/phonelink-sms.js":[null],"./fi-fi/pre-core.js":[null],"./fi-fi/premium-benefits.js":[null],"./fi-fi/recurrence.js":[null],"./fi-fi/rsc-application-permissions.js":[null],"./fi-fi/search.js":[null],"./fi-fi/semantic-object.js":[null],"./fi-fi/settings.js":[null],"./fi-fi/share-in-meetings.js":[null],"./fi-fi/share-to-teams-outlook-addin.js":[null],"./fi-fi/share-to-teams-third-party.js":[null],"./fi-fi/share-to-teams.js":[null],"./fi-fi/shortcut.js":[null],"./fi-fi/shortcuts.js":[null],"./fi-fi/smart-device.js":[null],"./fi-fi/survey.js":[null],"./fi-fi/sv-flyout.js":[null],"./fi-fi/teams-and-channels.js":[null],"./fi-fi/tfl-onboarding.js":[null],"./fi-fi/toast-notifications.js":[null],"./fi-fi/unified-search.js":[null],"./fi-fi/unsupported-browser.js":[null],"./fi-fi/url-preview.js":[null],"./fi-fi/video-capture.js":[null],"./fi-fi/video-message.js":[null],"./fi-fi/virtual-events.js":[null],"./fi-fi/webinar.js":[52711,6211],"./fi-fi/whats-new.js":[null],"./fi-fi/wiki.js":[null],"./fil-ph/activity.js":[null],"./fil-ph/artifacts-platform.js":[null],"./fil-ph/audience-view-dialog.js":[null],"./fil-ph/auth.js":[null],"./fil-ph/autosuggest.js":[null],"./fil-ph/avatar.js":[null],"./fil-ph/biometric-enrollment.js":[null],"./fil-ph/breakout-rooms.js":[null],"./fil-ph/broadcast.js":[null],"./fil-ph/calendar.js":[null],"./fil-ph/calling.js":[null],"./fil-ph/campaign-notifications.js":[null],"./fil-ph/carousel-multi-card.js":[null],"./fil-ph/cast.js":[null],"./fil-ph/channels.js":[null],"./fil-ph/chat-list.js":[null],"./fil-ph/coach-report.js":[null],"./fil-ph/communities.js":[null],"./fil-ph/compose.js":[22503,117],"./fil-ph/contacts.js":[null],"./fil-ph/datepicker.js":[null],"./fil-ph/desktop.js":[null],"./fil-ph/digital-signage.js":[null],"./fil-ph/discover-surface.js":[null],"./fil-ph/edu.js":[null],"./fil-ph/embed.js":[null],"./fil-ph/errors.js":[null],"./fil-ph/esp.js":[null],"./fil-ph/extensibility-ptz-extension.js":[null],"./fil-ph/extensibility-room-remote.js":[null],"./fil-ph/extensibility.js":[null],"./fil-ph/files.js":[null],"./fil-ph/framework.js":[12749,117],"./fil-ph/freemium-upgrade.js":[null],"./fil-ph/freemium.js":[null],"./fil-ph/funstuff.js":[null],"./fil-ph/gallery.js":[null],"./fil-ph/growth.js":[null],"./fil-ph/guardians.js":[null],"./fil-ph/health.js":[null],"./fil-ph/hololens.js":[null],"./fil-ph/lightbox.js":[null],"./fil-ph/live-persona-card.js":[null],"./fil-ph/lms-integration.js":[null],"./fil-ph/meet-for-work.js":[null],"./fil-ph/meeting-analytics.js":[null],"./fil-ph/meeting-apis-app.js":[null],"./fil-ph/meeting-bot.js":[null],"./fil-ph/meeting-flyout.js":[null],"./fil-ph/meeting-meet-app.js":[null],"./fil-ph/meeting-options.js":[null],"./fil-ph/meeting-recap.js":[null],"./fil-ph/meeting-room-console.js":[null],"./fil-ph/meeting-stream-app.js":[null],"./fil-ph/message-escalate-dialog.js":[null],"./fil-ph/messaging.js":[2910,117],"./fil-ph/mtma-missed-notifications.js":[null],"./fil-ph/nova.js":[null],"./fil-ph/people-app.js":[null],"./fil-ph/people-picker.js":[null],"./fil-ph/people-targeting.js":[null],"./fil-ph/people.js":[null],"./fil-ph/phonelink-sms.js":[null],"./fil-ph/pre-core.js":[null],"./fil-ph/premium-benefits.js":[null],"./fil-ph/recurrence.js":[null],"./fil-ph/rsc-application-permissions.js":[null],"./fil-ph/search.js":[null],"./fil-ph/semantic-object.js":[null],"./fil-ph/settings.js":[null],"./fil-ph/share-in-meetings.js":[null],"./fil-ph/share-to-teams-outlook-addin.js":[null],"./fil-ph/share-to-teams-third-party.js":[null],"./fil-ph/share-to-teams.js":[null],"./fil-ph/shortcut.js":[null],"./fil-ph/shortcuts.js":[null],"./fil-ph/smart-device.js":[null],"./fil-ph/survey.js":[null],"./fil-ph/sv-flyout.js":[null],"./fil-ph/teams-and-channels.js":[null],"./fil-ph/tfl-onboarding.js":[null],"./fil-ph/toast-notifications.js":[null],"./fil-ph/unified-search.js":[null],"./fil-ph/unsupported-browser.js":[null],"./fil-ph/url-preview.js":[null],"./fil-ph/video-capture.js":[null],"./fil-ph/video-message.js":[null],"./fil-ph/virtual-events.js":[null],"./fil-ph/webinar.js":[76429,117],"./fil-ph/whats-new.js":[null],"./fil-ph/wiki.js":[null],"./fr-ca/activity.js":[null],"./fr-ca/artifacts-platform.js":[null],"./fr-ca/audience-view-dialog.js":[null],"./fr-ca/auth.js":[null],"./fr-ca/autosuggest.js":[null],"./fr-ca/avatar.js":[null],"./fr-ca/biometric-enrollment.js":[null],"./fr-ca/breakout-rooms.js":[null],"./fr-ca/broadcast.js":[null],"./fr-ca/calendar.js":[null],"./fr-ca/calling.js":[null],"./fr-ca/campaign-notifications.js":[null],"./fr-ca/carousel-multi-card.js":[null],"./fr-ca/cast.js":[null],"./fr-ca/channels.js":[null],"./fr-ca/chat-list.js":[null],"./fr-ca/coach-report.js":[null],"./fr-ca/communities.js":[null],"./fr-ca/compose.js":[62766,7164],"./fr-ca/contacts.js":[null],"./fr-ca/datepicker.js":[null],"./fr-ca/desktop.js":[null],"./fr-ca/digital-signage.js":[null],"./fr-ca/discover-surface.js":[null],"./fr-ca/edu.js":[null],"./fr-ca/embed.js":[null],"./fr-ca/errors.js":[null],"./fr-ca/esp.js":[null],"./fr-ca/extensibility-ptz-extension.js":[null],"./fr-ca/extensibility-room-remote.js":[null],"./fr-ca/extensibility.js":[null],"./fr-ca/files.js":[null],"./fr-ca/framework.js":[95512,7164],"./fr-ca/freemium-upgrade.js":[null],"./fr-ca/freemium.js":[null],"./fr-ca/funstuff.js":[null],"./fr-ca/gallery.js":[null],"./fr-ca/growth.js":[null],"./fr-ca/guardians.js":[null],"./fr-ca/health.js":[null],"./fr-ca/hololens.js":[null],"./fr-ca/lightbox.js":[null],"./fr-ca/live-persona-card.js":[null],"./fr-ca/lms-integration.js":[null],"./fr-ca/meet-for-work.js":[null],"./fr-ca/meeting-analytics.js":[null],"./fr-ca/meeting-apis-app.js":[null],"./fr-ca/meeting-bot.js":[null],"./fr-ca/meeting-flyout.js":[null],"./fr-ca/meeting-meet-app.js":[null],"./fr-ca/meeting-options.js":[null],"./fr-ca/meeting-recap.js":[null],"./fr-ca/meeting-room-console.js":[null],"./fr-ca/meeting-stream-app.js":[null],"./fr-ca/message-escalate-dialog.js":[null],"./fr-ca/messaging.js":[44231,7164],"./fr-ca/mtma-missed-notifications.js":[null],"./fr-ca/nova.js":[null],"./fr-ca/people-app.js":[null],"./fr-ca/people-picker.js":[null],"./fr-ca/people-targeting.js":[null],"./fr-ca/people.js":[null],"./fr-ca/phonelink-sms.js":[null],"./fr-ca/pre-core.js":[null],"./fr-ca/premium-benefits.js":[null],"./fr-ca/recurrence.js":[null],"./fr-ca/rsc-application-permissions.js":[null],"./fr-ca/search.js":[null],"./fr-ca/semantic-object.js":[null],"./fr-ca/settings.js":[null],"./fr-ca/share-in-meetings.js":[null],"./fr-ca/share-to-teams-outlook-addin.js":[null],"./fr-ca/share-to-teams-third-party.js":[null],"./fr-ca/share-to-teams.js":[null],"./fr-ca/shortcut.js":[null],"./fr-ca/shortcuts.js":[null],"./fr-ca/smart-device.js":[null],"./fr-ca/survey.js":[null],"./fr-ca/sv-flyout.js":[null],"./fr-ca/teams-and-channels.js":[null],"./fr-ca/tfl-onboarding.js":[null],"./fr-ca/toast-notifications.js":[null],"./fr-ca/unified-search.js":[null],"./fr-ca/unsupported-browser.js":[null],"./fr-ca/url-preview.js":[null],"./fr-ca/video-capture.js":[null],"./fr-ca/video-message.js":[null],"./fr-ca/virtual-events.js":[null],"./fr-ca/webinar.js":[83620,7164],"./fr-ca/whats-new.js":[null],"./fr-ca/wiki.js":[null],"./fr-fr/activity.js":[null],"./fr-fr/artifacts-platform.js":[null],"./fr-fr/audience-view-dialog.js":[null],"./fr-fr/auth.js":[null],"./fr-fr/autosuggest.js":[null],"./fr-fr/avatar.js":[null],"./fr-fr/biometric-enrollment.js":[null],"./fr-fr/breakout-rooms.js":[null],"./fr-fr/broadcast.js":[null],"./fr-fr/calendar.js":[null],"./fr-fr/calling.js":[null],"./fr-fr/campaign-notifications.js":[null],"./fr-fr/carousel-multi-card.js":[null],"./fr-fr/cast.js":[null],"./fr-fr/channels.js":[null],"./fr-fr/chat-list.js":[null],"./fr-fr/coach-report.js":[null],"./fr-fr/communities.js":[null],"./fr-fr/compose.js":[34120,325],"./fr-fr/contacts.js":[null],"./fr-fr/datepicker.js":[null],"./fr-fr/desktop.js":[null],"./fr-fr/digital-signage.js":[null],"./fr-fr/discover-surface.js":[null],"./fr-fr/edu.js":[null],"./fr-fr/embed.js":[null],"./fr-fr/errors.js":[null],"./fr-fr/esp.js":[null],"./fr-fr/extensibility-ptz-extension.js":[null],"./fr-fr/extensibility-room-remote.js":[null],"./fr-fr/extensibility.js":[null],"./fr-fr/files.js":[null],"./fr-fr/framework.js":[56931,325],"./fr-fr/freemium-upgrade.js":[null],"./fr-fr/freemium.js":[null],"./fr-fr/funstuff.js":[null],"./fr-fr/gallery.js":[null],"./fr-fr/growth.js":[null],"./fr-fr/guardians.js":[null],"./fr-fr/health.js":[null],"./fr-fr/hololens.js":[null],"./fr-fr/lightbox.js":[null],"./fr-fr/live-persona-card.js":[null],"./fr-fr/lms-integration.js":[null],"./fr-fr/meet-for-work.js":[null],"./fr-fr/meeting-analytics.js":[null],"./fr-fr/meeting-apis-app.js":[null],"./fr-fr/meeting-bot.js":[null],"./fr-fr/meeting-flyout.js":[null],"./fr-fr/meeting-meet-app.js":[null],"./fr-fr/meeting-options.js":[null],"./fr-fr/meeting-recap.js":[null],"./fr-fr/meeting-room-console.js":[null],"./fr-fr/meeting-stream-app.js":[null],"./fr-fr/message-escalate-dialog.js":[null],"./fr-fr/messaging.js":[36121,325],"./fr-fr/mtma-missed-notifications.js":[null],"./fr-fr/nova.js":[null],"./fr-fr/people-app.js":[null],"./fr-fr/people-picker.js":[null],"./fr-fr/people-targeting.js":[null],"./fr-fr/people.js":[null],"./fr-fr/phonelink-sms.js":[null],"./fr-fr/pre-core.js":[null],"./fr-fr/premium-benefits.js":[null],"./fr-fr/recurrence.js":[null],"./fr-fr/rsc-application-permissions.js":[null],"./fr-fr/search.js":[null],"./fr-fr/semantic-object.js":[null],"./fr-fr/settings.js":[null],"./fr-fr/share-in-meetings.js":[null],"./fr-fr/share-to-teams-outlook-addin.js":[null],"./fr-fr/share-to-teams-third-party.js":[null],"./fr-fr/share-to-teams.js":[null],"./fr-fr/shortcut.js":[null],"./fr-fr/shortcuts.js":[null],"./fr-fr/smart-device.js":[null],"./fr-fr/survey.js":[null],"./fr-fr/sv-flyout.js":[null],"./fr-fr/teams-and-channels.js":[null],"./fr-fr/tfl-onboarding.js":[null],"./fr-fr/toast-notifications.js":[null],"./fr-fr/unified-search.js":[null],"./fr-fr/unsupported-browser.js":[null],"./fr-fr/url-preview.js":[null],"./fr-fr/video-capture.js":[null],"./fr-fr/video-message.js":[null],"./fr-fr/virtual-events.js":[null],"./fr-fr/webinar.js":[32433,325],"./fr-fr/whats-new.js":[null],"./fr-fr/wiki.js":[null],"./gl-es/activity.js":[null],"./gl-es/artifacts-platform.js":[null],"./gl-es/audience-view-dialog.js":[null],"./gl-es/auth.js":[null],"./gl-es/autosuggest.js":[null],"./gl-es/avatar.js":[null],"./gl-es/biometric-enrollment.js":[null],"./gl-es/breakout-rooms.js":[null],"./gl-es/broadcast.js":[null],"./gl-es/calendar.js":[null],"./gl-es/calling.js":[null],"./gl-es/campaign-notifications.js":[null],"./gl-es/carousel-multi-card.js":[null],"./gl-es/cast.js":[null],"./gl-es/channels.js":[null],"./gl-es/chat-list.js":[null],"./gl-es/coach-report.js":[null],"./gl-es/communities.js":[null],"./gl-es/compose.js":[64900,4496],"./gl-es/contacts.js":[null],"./gl-es/datepicker.js":[null],"./gl-es/desktop.js":[null],"./gl-es/digital-signage.js":[null],"./gl-es/discover-surface.js":[null],"./gl-es/edu.js":[null],"./gl-es/embed.js":[null],"./gl-es/errors.js":[null],"./gl-es/esp.js":[null],"./gl-es/extensibility-ptz-extension.js":[null],"./gl-es/extensibility-room-remote.js":[null],"./gl-es/extensibility.js":[null],"./gl-es/files.js":[null],"./gl-es/framework.js":[15333,4496],"./gl-es/freemium-upgrade.js":[null],"./gl-es/freemium.js":[null],"./gl-es/funstuff.js":[null],"./gl-es/gallery.js":[null],"./gl-es/growth.js":[null],"./gl-es/guardians.js":[null],"./gl-es/health.js":[null],"./gl-es/hololens.js":[null],"./gl-es/lightbox.js":[null],"./gl-es/live-persona-card.js":[null],"./gl-es/lms-integration.js":[null],"./gl-es/meet-for-work.js":[null],"./gl-es/meeting-analytics.js":[null],"./gl-es/meeting-apis-app.js":[null],"./gl-es/meeting-bot.js":[null],"./gl-es/meeting-flyout.js":[null],"./gl-es/meeting-meet-app.js":[null],"./gl-es/meeting-options.js":[null],"./gl-es/meeting-recap.js":[null],"./gl-es/meeting-room-console.js":[null],"./gl-es/meeting-stream-app.js":[null],"./gl-es/message-escalate-dialog.js":[null],"./gl-es/messaging.js":[35954,4496],"./gl-es/mtma-missed-notifications.js":[null],"./gl-es/nova.js":[null],"./gl-es/people-app.js":[null],"./gl-es/people-picker.js":[null],"./gl-es/people-targeting.js":[null],"./gl-es/people.js":[null],"./gl-es/phonelink-sms.js":[null],"./gl-es/pre-core.js":[null],"./gl-es/premium-benefits.js":[null],"./gl-es/recurrence.js":[null],"./gl-es/rsc-application-permissions.js":[null],"./gl-es/search.js":[null],"./gl-es/semantic-object.js":[null],"./gl-es/settings.js":[null],"./gl-es/share-in-meetings.js":[null],"./gl-es/share-to-teams-outlook-addin.js":[null],"./gl-es/share-to-teams-third-party.js":[null],"./gl-es/share-to-teams.js":[null],"./gl-es/shortcut.js":[null],"./gl-es/shortcuts.js":[null],"./gl-es/smart-device.js":[null],"./gl-es/survey.js":[null],"./gl-es/sv-flyout.js":[null],"./gl-es/teams-and-channels.js":[null],"./gl-es/tfl-onboarding.js":[null],"./gl-es/toast-notifications.js":[null],"./gl-es/unified-search.js":[null],"./gl-es/unsupported-browser.js":[null],"./gl-es/url-preview.js":[null],"./gl-es/video-capture.js":[null],"./gl-es/video-message.js":[null],"./gl-es/virtual-events.js":[null],"./gl-es/webinar.js":[61330,4496],"./gl-es/whats-new.js":[null],"./gl-es/wiki.js":[null],"./he-il/activity.js":[null],"./he-il/artifacts-platform.js":[null],"./he-il/audience-view-dialog.js":[null],"./he-il/auth.js":[null],"./he-il/autosuggest.js":[null],"./he-il/avatar.js":[null],"./he-il/biometric-enrollment.js":[null],"./he-il/breakout-rooms.js":[null],"./he-il/broadcast.js":[null],"./he-il/calendar.js":[null],"./he-il/calling.js":[null],"./he-il/campaign-notifications.js":[null],"./he-il/carousel-multi-card.js":[null],"./he-il/cast.js":[null],"./he-il/channels.js":[null],"./he-il/chat-list.js":[null],"./he-il/coach-report.js":[null],"./he-il/communities.js":[null],"./he-il/compose.js":[51415,5333],"./he-il/contacts.js":[null],"./he-il/datepicker.js":[null],"./he-il/desktop.js":[null],"./he-il/digital-signage.js":[null],"./he-il/discover-surface.js":[null],"./he-il/edu.js":[null],"./he-il/embed.js":[null],"./he-il/errors.js":[null],"./he-il/esp.js":[null],"./he-il/extensibility-ptz-extension.js":[null],"./he-il/extensibility-room-remote.js":[null],"./he-il/extensibility.js":[null],"./he-il/files.js":[null],"./he-il/framework.js":[22681,5333],"./he-il/freemium-upgrade.js":[null],"./he-il/freemium.js":[null],"./he-il/funstuff.js":[null],"./he-il/gallery.js":[null],"./he-il/growth.js":[null],"./he-il/guardians.js":[null],"./he-il/health.js":[null],"./he-il/hololens.js":[null],"./he-il/lightbox.js":[null],"./he-il/live-persona-card.js":[null],"./he-il/lms-integration.js":[null],"./he-il/meet-for-work.js":[null],"./he-il/meeting-analytics.js":[null],"./he-il/meeting-apis-app.js":[null],"./he-il/meeting-bot.js":[null],"./he-il/meeting-flyout.js":[null],"./he-il/meeting-meet-app.js":[null],"./he-il/meeting-options.js":[null],"./he-il/meeting-recap.js":[null],"./he-il/meeting-room-console.js":[null],"./he-il/meeting-stream-app.js":[null],"./he-il/message-escalate-dialog.js":[null],"./he-il/messaging.js":[46480,5333],"./he-il/mtma-missed-notifications.js":[null],"./he-il/nova.js":[null],"./he-il/people-app.js":[null],"./he-il/people-picker.js":[null],"./he-il/people-targeting.js":[null],"./he-il/people.js":[null],"./he-il/phonelink-sms.js":[null],"./he-il/pre-core.js":[null],"./he-il/premium-benefits.js":[null],"./he-il/recurrence.js":[null],"./he-il/rsc-application-permissions.js":[null],"./he-il/search.js":[null],"./he-il/semantic-object.js":[null],"./he-il/settings.js":[null],"./he-il/share-in-meetings.js":[null],"./he-il/share-to-teams-outlook-addin.js":[null],"./he-il/share-to-teams-third-party.js":[null],"./he-il/share-to-teams.js":[null],"./he-il/shortcut.js":[null],"./he-il/shortcuts.js":[null],"./he-il/smart-device.js":[null],"./he-il/survey.js":[null],"./he-il/sv-flyout.js":[null],"./he-il/teams-and-channels.js":[null],"./he-il/tfl-onboarding.js":[null],"./he-il/toast-notifications.js":[null],"./he-il/unified-search.js":[null],"./he-il/unsupported-browser.js":[null],"./he-il/url-preview.js":[null],"./he-il/video-capture.js":[null],"./he-il/video-message.js":[null],"./he-il/virtual-events.js":[null],"./he-il/webinar.js":[6705,5333],"./he-il/whats-new.js":[null],"./he-il/wiki.js":[null],"./hi-in/activity.js":[null],"./hi-in/artifacts-platform.js":[null],"./hi-in/audience-view-dialog.js":[null],"./hi-in/auth.js":[null],"./hi-in/autosuggest.js":[null],"./hi-in/avatar.js":[null],"./hi-in/biometric-enrollment.js":[null],"./hi-in/breakout-rooms.js":[null],"./hi-in/broadcast.js":[null],"./hi-in/calendar.js":[null],"./hi-in/calling.js":[null],"./hi-in/campaign-notifications.js":[null],"./hi-in/carousel-multi-card.js":[null],"./hi-in/cast.js":[null],"./hi-in/channels.js":[null],"./hi-in/chat-list.js":[null],"./hi-in/coach-report.js":[null],"./hi-in/communities.js":[null],"./hi-in/compose.js":[16649,716],"./hi-in/contacts.js":[null],"./hi-in/datepicker.js":[null],"./hi-in/desktop.js":[null],"./hi-in/digital-signage.js":[null],"./hi-in/discover-surface.js":[null],"./hi-in/edu.js":[null],"./hi-in/embed.js":[null],"./hi-in/errors.js":[null],"./hi-in/esp.js":[null],"./hi-in/extensibility-ptz-extension.js":[null],"./hi-in/extensibility-room-remote.js":[null],"./hi-in/extensibility.js":[null],"./hi-in/files.js":[null],"./hi-in/framework.js":[21740,716],"./hi-in/freemium-upgrade.js":[null],"./hi-in/freemium.js":[null],"./hi-in/funstuff.js":[null],"./hi-in/gallery.js":[null],"./hi-in/growth.js":[null],"./hi-in/guardians.js":[null],"./hi-in/health.js":[null],"./hi-in/hololens.js":[null],"./hi-in/lightbox.js":[null],"./hi-in/live-persona-card.js":[null],"./hi-in/lms-integration.js":[null],"./hi-in/meet-for-work.js":[null],"./hi-in/meeting-analytics.js":[null],"./hi-in/meeting-apis-app.js":[null],"./hi-in/meeting-bot.js":[null],"./hi-in/meeting-flyout.js":[null],"./hi-in/meeting-meet-app.js":[null],"./hi-in/meeting-options.js":[null],"./hi-in/meeting-recap.js":[null],"./hi-in/meeting-room-console.js":[null],"./hi-in/meeting-stream-app.js":[null],"./hi-in/message-escalate-dialog.js":[null],"./hi-in/messaging.js":[57891,716],"./hi-in/mtma-missed-notifications.js":[null],"./hi-in/nova.js":[null],"./hi-in/people-app.js":[null],"./hi-in/people-picker.js":[null],"./hi-in/people-targeting.js":[null],"./hi-in/people.js":[null],"./hi-in/phonelink-sms.js":[null],"./hi-in/pre-core.js":[null],"./hi-in/premium-benefits.js":[null],"./hi-in/recurrence.js":[null],"./hi-in/rsc-application-permissions.js":[null],"./hi-in/search.js":[null],"./hi-in/semantic-object.js":[null],"./hi-in/settings.js":[null],"./hi-in/share-in-meetings.js":[null],"./hi-in/share-to-teams-outlook-addin.js":[null],"./hi-in/share-to-teams-third-party.js":[null],"./hi-in/share-to-teams.js":[null],"./hi-in/shortcut.js":[null],"./hi-in/shortcuts.js":[null],"./hi-in/smart-device.js":[null],"./hi-in/survey.js":[null],"./hi-in/sv-flyout.js":[null],"./hi-in/teams-and-channels.js":[null],"./hi-in/tfl-onboarding.js":[null],"./hi-in/toast-notifications.js":[null],"./hi-in/unified-search.js":[null],"./hi-in/unsupported-browser.js":[null],"./hi-in/url-preview.js":[null],"./hi-in/video-capture.js":[null],"./hi-in/video-message.js":[null],"./hi-in/virtual-events.js":[null],"./hi-in/webinar.js":[97294,716],"./hi-in/whats-new.js":[null],"./hi-in/wiki.js":[null],"./hr-hr/activity.js":[null],"./hr-hr/artifacts-platform.js":[null],"./hr-hr/audience-view-dialog.js":[null],"./hr-hr/auth.js":[null],"./hr-hr/autosuggest.js":[null],"./hr-hr/avatar.js":[null],"./hr-hr/biometric-enrollment.js":[null],"./hr-hr/breakout-rooms.js":[null],"./hr-hr/broadcast.js":[null],"./hr-hr/calendar.js":[null],"./hr-hr/calling.js":[null],"./hr-hr/campaign-notifications.js":[null],"./hr-hr/carousel-multi-card.js":[null],"./hr-hr/cast.js":[null],"./hr-hr/channels.js":[null],"./hr-hr/chat-list.js":[null],"./hr-hr/coach-report.js":[null],"./hr-hr/communities.js":[null],"./hr-hr/compose.js":[66539,9109],"./hr-hr/contacts.js":[null],"./hr-hr/datepicker.js":[null],"./hr-hr/desktop.js":[null],"./hr-hr/digital-signage.js":[null],"./hr-hr/discover-surface.js":[null],"./hr-hr/edu.js":[null],"./hr-hr/embed.js":[null],"./hr-hr/errors.js":[null],"./hr-hr/esp.js":[null],"./hr-hr/extensibility-ptz-extension.js":[null],"./hr-hr/extensibility-room-remote.js":[null],"./hr-hr/extensibility.js":[null],"./hr-hr/files.js":[null],"./hr-hr/framework.js":[25667,9109],"./hr-hr/freemium-upgrade.js":[null],"./hr-hr/freemium.js":[null],"./hr-hr/funstuff.js":[null],"./hr-hr/gallery.js":[null],"./hr-hr/growth.js":[null],"./hr-hr/guardians.js":[null],"./hr-hr/health.js":[null],"./hr-hr/hololens.js":[null],"./hr-hr/lightbox.js":[null],"./hr-hr/live-persona-card.js":[null],"./hr-hr/lms-integration.js":[null],"./hr-hr/meet-for-work.js":[null],"./hr-hr/meeting-analytics.js":[null],"./hr-hr/meeting-apis-app.js":[null],"./hr-hr/meeting-bot.js":[null],"./hr-hr/meeting-flyout.js":[null],"./hr-hr/meeting-meet-app.js":[null],"./hr-hr/meeting-options.js":[null],"./hr-hr/meeting-recap.js":[null],"./hr-hr/meeting-room-console.js":[null],"./hr-hr/meeting-stream-app.js":[null],"./hr-hr/message-escalate-dialog.js":[null],"./hr-hr/messaging.js":[47983,9109],"./hr-hr/mtma-missed-notifications.js":[null],"./hr-hr/nova.js":[null],"./hr-hr/people-app.js":[null],"./hr-hr/people-picker.js":[null],"./hr-hr/people-targeting.js":[null],"./hr-hr/people.js":[null],"./hr-hr/phonelink-sms.js":[null],"./hr-hr/pre-core.js":[null],"./hr-hr/premium-benefits.js":[null],"./hr-hr/recurrence.js":[null],"./hr-hr/rsc-application-permissions.js":[null],"./hr-hr/search.js":[null],"./hr-hr/semantic-object.js":[null],"./hr-hr/settings.js":[null],"./hr-hr/share-in-meetings.js":[null],"./hr-hr/share-to-teams-outlook-addin.js":[null],"./hr-hr/share-to-teams-third-party.js":[null],"./hr-hr/share-to-teams.js":[null],"./hr-hr/shortcut.js":[null],"./hr-hr/shortcuts.js":[null],"./hr-hr/smart-device.js":[null],"./hr-hr/survey.js":[null],"./hr-hr/sv-flyout.js":[null],"./hr-hr/teams-and-channels.js":[null],"./hr-hr/tfl-onboarding.js":[null],"./hr-hr/toast-notifications.js":[null],"./hr-hr/unified-search.js":[null],"./hr-hr/unsupported-browser.js":[null],"./hr-hr/url-preview.js":[null],"./hr-hr/video-capture.js":[null],"./hr-hr/video-message.js":[null],"./hr-hr/virtual-events.js":[null],"./hr-hr/webinar.js":[85866,9109],"./hr-hr/whats-new.js":[null],"./hr-hr/wiki.js":[null],"./hu-hu/activity.js":[null],"./hu-hu/artifacts-platform.js":[null],"./hu-hu/audience-view-dialog.js":[null],"./hu-hu/auth.js":[null],"./hu-hu/autosuggest.js":[null],"./hu-hu/avatar.js":[null],"./hu-hu/biometric-enrollment.js":[null],"./hu-hu/breakout-rooms.js":[null],"./hu-hu/broadcast.js":[null],"./hu-hu/calendar.js":[null],"./hu-hu/calling.js":[null],"./hu-hu/campaign-notifications.js":[null],"./hu-hu/carousel-multi-card.js":[null],"./hu-hu/cast.js":[null],"./hu-hu/channels.js":[null],"./hu-hu/chat-list.js":[null],"./hu-hu/coach-report.js":[null],"./hu-hu/communities.js":[null],"./hu-hu/compose.js":[15903,323],"./hu-hu/contacts.js":[null],"./hu-hu/datepicker.js":[null],"./hu-hu/desktop.js":[null],"./hu-hu/digital-signage.js":[null],"./hu-hu/discover-surface.js":[null],"./hu-hu/edu.js":[null],"./hu-hu/embed.js":[null],"./hu-hu/errors.js":[null],"./hu-hu/esp.js":[null],"./hu-hu/extensibility-ptz-extension.js":[null],"./hu-hu/extensibility-room-remote.js":[null],"./hu-hu/extensibility.js":[null],"./hu-hu/files.js":[null],"./hu-hu/framework.js":[99476,323],"./hu-hu/freemium-upgrade.js":[null],"./hu-hu/freemium.js":[null],"./hu-hu/funstuff.js":[null],"./hu-hu/gallery.js":[null],"./hu-hu/growth.js":[null],"./hu-hu/guardians.js":[null],"./hu-hu/health.js":[null],"./hu-hu/hololens.js":[null],"./hu-hu/lightbox.js":[null],"./hu-hu/live-persona-card.js":[null],"./hu-hu/lms-integration.js":[null],"./hu-hu/meet-for-work.js":[null],"./hu-hu/meeting-analytics.js":[null],"./hu-hu/meeting-apis-app.js":[null],"./hu-hu/meeting-bot.js":[null],"./hu-hu/meeting-flyout.js":[null],"./hu-hu/meeting-meet-app.js":[null],"./hu-hu/meeting-options.js":[null],"./hu-hu/meeting-recap.js":[null],"./hu-hu/meeting-room-console.js":[null],"./hu-hu/meeting-stream-app.js":[null],"./hu-hu/message-escalate-dialog.js":[null],"./hu-hu/messaging.js":[92174,323],"./hu-hu/mtma-missed-notifications.js":[null],"./hu-hu/nova.js":[null],"./hu-hu/people-app.js":[null],"./hu-hu/people-picker.js":[null],"./hu-hu/people-targeting.js":[null],"./hu-hu/people.js":[null],"./hu-hu/phonelink-sms.js":[null],"./hu-hu/pre-core.js":[null],"./hu-hu/premium-benefits.js":[null],"./hu-hu/recurrence.js":[null],"./hu-hu/rsc-application-permissions.js":[null],"./hu-hu/search.js":[null],"./hu-hu/semantic-object.js":[null],"./hu-hu/settings.js":[null],"./hu-hu/share-in-meetings.js":[null],"./hu-hu/share-to-teams-outlook-addin.js":[null],"./hu-hu/share-to-teams-third-party.js":[null],"./hu-hu/share-to-teams.js":[null],"./hu-hu/shortcut.js":[null],"./hu-hu/shortcuts.js":[null],"./hu-hu/smart-device.js":[null],"./hu-hu/survey.js":[null],"./hu-hu/sv-flyout.js":[null],"./hu-hu/teams-and-channels.js":[null],"./hu-hu/tfl-onboarding.js":[null],"./hu-hu/toast-notifications.js":[null],"./hu-hu/unified-search.js":[null],"./hu-hu/unsupported-browser.js":[null],"./hu-hu/url-preview.js":[null],"./hu-hu/video-capture.js":[null],"./hu-hu/video-message.js":[null],"./hu-hu/virtual-events.js":[null],"./hu-hu/webinar.js":[51170,323],"./hu-hu/whats-new.js":[null],"./hu-hu/wiki.js":[null],"./id-id/activity.js":[null],"./id-id/artifacts-platform.js":[null],"./id-id/audience-view-dialog.js":[null],"./id-id/auth.js":[null],"./id-id/autosuggest.js":[null],"./id-id/avatar.js":[null],"./id-id/biometric-enrollment.js":[null],"./id-id/breakout-rooms.js":[null],"./id-id/broadcast.js":[null],"./id-id/calendar.js":[null],"./id-id/calling.js":[null],"./id-id/campaign-notifications.js":[null],"./id-id/carousel-multi-card.js":[null],"./id-id/cast.js":[null],"./id-id/channels.js":[null],"./id-id/chat-list.js":[null],"./id-id/coach-report.js":[null],"./id-id/communities.js":[null],"./id-id/compose.js":[86157,3846],"./id-id/contacts.js":[null],"./id-id/datepicker.js":[null],"./id-id/desktop.js":[null],"./id-id/digital-signage.js":[null],"./id-id/discover-surface.js":[null],"./id-id/edu.js":[null],"./id-id/embed.js":[null],"./id-id/errors.js":[null],"./id-id/esp.js":[null],"./id-id/extensibility-ptz-extension.js":[null],"./id-id/extensibility-room-remote.js":[null],"./id-id/extensibility.js":[null],"./id-id/files.js":[null],"./id-id/framework.js":[77620,3846],"./id-id/freemium-upgrade.js":[null],"./id-id/freemium.js":[null],"./id-id/funstuff.js":[null],"./id-id/gallery.js":[null],"./id-id/growth.js":[null],"./id-id/guardians.js":[null],"./id-id/health.js":[null],"./id-id/hololens.js":[null],"./id-id/lightbox.js":[null],"./id-id/live-persona-card.js":[null],"./id-id/lms-integration.js":[null],"./id-id/meet-for-work.js":[null],"./id-id/meeting-analytics.js":[null],"./id-id/meeting-apis-app.js":[null],"./id-id/meeting-bot.js":[null],"./id-id/meeting-flyout.js":[null],"./id-id/meeting-meet-app.js":[null],"./id-id/meeting-options.js":[null],"./id-id/meeting-recap.js":[null],"./id-id/meeting-room-console.js":[null],"./id-id/meeting-stream-app.js":[null],"./id-id/message-escalate-dialog.js":[null],"./id-id/messaging.js":[84210,3846],"./id-id/mtma-missed-notifications.js":[null],"./id-id/nova.js":[null],"./id-id/people-app.js":[null],"./id-id/people-picker.js":[null],"./id-id/people-targeting.js":[null],"./id-id/people.js":[null],"./id-id/phonelink-sms.js":[null],"./id-id/pre-core.js":[null],"./id-id/premium-benefits.js":[null],"./id-id/recurrence.js":[null],"./id-id/rsc-application-permissions.js":[null],"./id-id/search.js":[null],"./id-id/semantic-object.js":[null],"./id-id/settings.js":[null],"./id-id/share-in-meetings.js":[null],"./id-id/share-to-teams-outlook-addin.js":[null],"./id-id/share-to-teams-third-party.js":[null],"./id-id/share-to-teams.js":[null],"./id-id/shortcut.js":[null],"./id-id/shortcuts.js":[null],"./id-id/smart-device.js":[null],"./id-id/survey.js":[null],"./id-id/sv-flyout.js":[null],"./id-id/teams-and-channels.js":[null],"./id-id/tfl-onboarding.js":[null],"./id-id/toast-notifications.js":[null],"./id-id/unified-search.js":[null],"./id-id/unsupported-browser.js":[null],"./id-id/url-preview.js":[null],"./id-id/video-capture.js":[null],"./id-id/video-message.js":[null],"./id-id/virtual-events.js":[null],"./id-id/webinar.js":[67844,3846],"./id-id/whats-new.js":[null],"./id-id/wiki.js":[null],"./is-is/activity.js":[null],"./is-is/artifacts-platform.js":[null],"./is-is/audience-view-dialog.js":[null],"./is-is/auth.js":[null],"./is-is/autosuggest.js":[null],"./is-is/avatar.js":[null],"./is-is/biometric-enrollment.js":[null],"./is-is/breakout-rooms.js":[null],"./is-is/broadcast.js":[null],"./is-is/calendar.js":[null],"./is-is/calling.js":[null],"./is-is/campaign-notifications.js":[null],"./is-is/carousel-multi-card.js":[null],"./is-is/cast.js":[null],"./is-is/channels.js":[null],"./is-is/chat-list.js":[null],"./is-is/coach-report.js":[null],"./is-is/communities.js":[null],"./is-is/compose.js":[99106,3993],"./is-is/contacts.js":[null],"./is-is/datepicker.js":[null],"./is-is/desktop.js":[null],"./is-is/digital-signage.js":[null],"./is-is/discover-surface.js":[null],"./is-is/edu.js":[null],"./is-is/embed.js":[null],"./is-is/errors.js":[null],"./is-is/esp.js":[null],"./is-is/extensibility-ptz-extension.js":[null],"./is-is/extensibility-room-remote.js":[null],"./is-is/extensibility.js":[null],"./is-is/files.js":[null],"./is-is/framework.js":[62425,3993],"./is-is/freemium-upgrade.js":[null],"./is-is/freemium.js":[null],"./is-is/funstuff.js":[null],"./is-is/gallery.js":[null],"./is-is/growth.js":[null],"./is-is/guardians.js":[null],"./is-is/health.js":[null],"./is-is/hololens.js":[null],"./is-is/lightbox.js":[null],"./is-is/live-persona-card.js":[null],"./is-is/lms-integration.js":[null],"./is-is/meet-for-work.js":[null],"./is-is/meeting-analytics.js":[null],"./is-is/meeting-apis-app.js":[null],"./is-is/meeting-bot.js":[null],"./is-is/meeting-flyout.js":[null],"./is-is/meeting-meet-app.js":[null],"./is-is/meeting-options.js":[null],"./is-is/meeting-recap.js":[null],"./is-is/meeting-room-console.js":[null],"./is-is/meeting-stream-app.js":[null],"./is-is/message-escalate-dialog.js":[null],"./is-is/messaging.js":[75169,3993],"./is-is/mtma-missed-notifications.js":[null],"./is-is/nova.js":[null],"./is-is/people-app.js":[null],"./is-is/people-picker.js":[null],"./is-is/people-targeting.js":[null],"./is-is/people.js":[null],"./is-is/phonelink-sms.js":[null],"./is-is/pre-core.js":[null],"./is-is/premium-benefits.js":[null],"./is-is/recurrence.js":[null],"./is-is/rsc-application-permissions.js":[null],"./is-is/search.js":[null],"./is-is/semantic-object.js":[null],"./is-is/settings.js":[null],"./is-is/share-in-meetings.js":[null],"./is-is/share-to-teams-outlook-addin.js":[null],"./is-is/share-to-teams-third-party.js":[null],"./is-is/share-to-teams.js":[null],"./is-is/shortcut.js":[null],"./is-is/shortcuts.js":[null],"./is-is/smart-device.js":[null],"./is-is/survey.js":[null],"./is-is/sv-flyout.js":[null],"./is-is/teams-and-channels.js":[null],"./is-is/tfl-onboarding.js":[null],"./is-is/toast-notifications.js":[null],"./is-is/unified-search.js":[null],"./is-is/unsupported-browser.js":[null],"./is-is/url-preview.js":[null],"./is-is/video-capture.js":[null],"./is-is/video-message.js":[null],"./is-is/virtual-events.js":[null],"./is-is/webinar.js":[21989,3993],"./is-is/whats-new.js":[null],"./is-is/wiki.js":[null],"./it-it/activity.js":[null],"./it-it/artifacts-platform.js":[null],"./it-it/audience-view-dialog.js":[null],"./it-it/auth.js":[null],"./it-it/autosuggest.js":[null],"./it-it/avatar.js":[null],"./it-it/biometric-enrollment.js":[null],"./it-it/breakout-rooms.js":[null],"./it-it/broadcast.js":[null],"./it-it/calendar.js":[null],"./it-it/calling.js":[null],"./it-it/campaign-notifications.js":[null],"./it-it/carousel-multi-card.js":[null],"./it-it/cast.js":[null],"./it-it/channels.js":[null],"./it-it/chat-list.js":[null],"./it-it/coach-report.js":[null],"./it-it/communities.js":[null],"./it-it/compose.js":[61395,1983],"./it-it/contacts.js":[null],"./it-it/datepicker.js":[null],"./it-it/desktop.js":[null],"./it-it/digital-signage.js":[null],"./it-it/discover-surface.js":[null],"./it-it/edu.js":[null],"./it-it/embed.js":[null],"./it-it/errors.js":[null],"./it-it/esp.js":[null],"./it-it/extensibility-ptz-extension.js":[null],"./it-it/extensibility-room-remote.js":[null],"./it-it/extensibility.js":[null],"./it-it/files.js":[null],"./it-it/framework.js":[26910,1983],"./it-it/freemium-upgrade.js":[null],"./it-it/freemium.js":[null],"./it-it/funstuff.js":[null],"./it-it/gallery.js":[null],"./it-it/growth.js":[null],"./it-it/guardians.js":[null],"./it-it/health.js":[null],"./it-it/hololens.js":[null],"./it-it/lightbox.js":[null],"./it-it/live-persona-card.js":[null],"./it-it/lms-integration.js":[null],"./it-it/meet-for-work.js":[null],"./it-it/meeting-analytics.js":[null],"./it-it/meeting-apis-app.js":[null],"./it-it/meeting-bot.js":[null],"./it-it/meeting-flyout.js":[null],"./it-it/meeting-meet-app.js":[null],"./it-it/meeting-options.js":[null],"./it-it/meeting-recap.js":[null],"./it-it/meeting-room-console.js":[null],"./it-it/meeting-stream-app.js":[null],"./it-it/message-escalate-dialog.js":[null],"./it-it/messaging.js":[10444,1983],"./it-it/mtma-missed-notifications.js":[null],"./it-it/nova.js":[null],"./it-it/people-app.js":[null],"./it-it/people-picker.js":[null],"./it-it/people-targeting.js":[null],"./it-it/people.js":[null],"./it-it/phonelink-sms.js":[null],"./it-it/pre-core.js":[null],"./it-it/premium-benefits.js":[null],"./it-it/recurrence.js":[null],"./it-it/rsc-application-permissions.js":[null],"./it-it/search.js":[null],"./it-it/semantic-object.js":[null],"./it-it/settings.js":[null],"./it-it/share-in-meetings.js":[null],"./it-it/share-to-teams-outlook-addin.js":[null],"./it-it/share-to-teams-third-party.js":[null],"./it-it/share-to-teams.js":[null],"./it-it/shortcut.js":[null],"./it-it/shortcuts.js":[null],"./it-it/smart-device.js":[null],"./it-it/survey.js":[null],"./it-it/sv-flyout.js":[null],"./it-it/teams-and-channels.js":[null],"./it-it/tfl-onboarding.js":[null],"./it-it/toast-notifications.js":[null],"./it-it/unified-search.js":[null],"./it-it/unsupported-browser.js":[null],"./it-it/url-preview.js":[null],"./it-it/video-capture.js":[null],"./it-it/video-message.js":[null],"./it-it/virtual-events.js":[null],"./it-it/webinar.js":[70361,1983],"./it-it/whats-new.js":[null],"./it-it/wiki.js":[null],"./ja-jp/activity.js":[null],"./ja-jp/artifacts-platform.js":[null],"./ja-jp/audience-view-dialog.js":[null],"./ja-jp/auth.js":[null],"./ja-jp/autosuggest.js":[null],"./ja-jp/avatar.js":[null],"./ja-jp/biometric-enrollment.js":[null],"./ja-jp/breakout-rooms.js":[null],"./ja-jp/broadcast.js":[null],"./ja-jp/calendar.js":[null],"./ja-jp/calling.js":[null],"./ja-jp/campaign-notifications.js":[null],"./ja-jp/carousel-multi-card.js":[null],"./ja-jp/cast.js":[null],"./ja-jp/channels.js":[null],"./ja-jp/chat-list.js":[null],"./ja-jp/coach-report.js":[null],"./ja-jp/communities.js":[null],"./ja-jp/compose.js":[94212,4615],"./ja-jp/contacts.js":[null],"./ja-jp/datepicker.js":[null],"./ja-jp/desktop.js":[null],"./ja-jp/digital-signage.js":[null],"./ja-jp/discover-surface.js":[null],"./ja-jp/edu.js":[null],"./ja-jp/embed.js":[null],"./ja-jp/errors.js":[null],"./ja-jp/esp.js":[null],"./ja-jp/extensibility-ptz-extension.js":[null],"./ja-jp/extensibility-room-remote.js":[null],"./ja-jp/extensibility.js":[null],"./ja-jp/files.js":[null],"./ja-jp/framework.js":[82063,4615],"./ja-jp/freemium-upgrade.js":[null],"./ja-jp/freemium.js":[null],"./ja-jp/funstuff.js":[null],"./ja-jp/gallery.js":[null],"./ja-jp/growth.js":[null],"./ja-jp/guardians.js":[null],"./ja-jp/health.js":[null],"./ja-jp/hololens.js":[null],"./ja-jp/lightbox.js":[null],"./ja-jp/live-persona-card.js":[null],"./ja-jp/lms-integration.js":[null],"./ja-jp/meet-for-work.js":[null],"./ja-jp/meeting-analytics.js":[null],"./ja-jp/meeting-apis-app.js":[null],"./ja-jp/meeting-bot.js":[null],"./ja-jp/meeting-flyout.js":[null],"./ja-jp/meeting-meet-app.js":[null],"./ja-jp/meeting-options.js":[null],"./ja-jp/meeting-recap.js":[null],"./ja-jp/meeting-room-console.js":[null],"./ja-jp/meeting-stream-app.js":[null],"./ja-jp/message-escalate-dialog.js":[null],"./ja-jp/messaging.js":[74781,4615],"./ja-jp/mtma-missed-notifications.js":[null],"./ja-jp/nova.js":[null],"./ja-jp/people-app.js":[null],"./ja-jp/people-picker.js":[null],"./ja-jp/people-targeting.js":[null],"./ja-jp/people.js":[null],"./ja-jp/phonelink-sms.js":[null],"./ja-jp/pre-core.js":[null],"./ja-jp/premium-benefits.js":[null],"./ja-jp/recurrence.js":[null],"./ja-jp/rsc-application-permissions.js":[null],"./ja-jp/search.js":[null],"./ja-jp/semantic-object.js":[null],"./ja-jp/settings.js":[null],"./ja-jp/share-in-meetings.js":[null],"./ja-jp/share-to-teams-outlook-addin.js":[null],"./ja-jp/share-to-teams-third-party.js":[null],"./ja-jp/share-to-teams.js":[null],"./ja-jp/shortcut.js":[null],"./ja-jp/shortcuts.js":[null],"./ja-jp/smart-device.js":[null],"./ja-jp/survey.js":[null],"./ja-jp/sv-flyout.js":[null],"./ja-jp/teams-and-channels.js":[null],"./ja-jp/tfl-onboarding.js":[null],"./ja-jp/toast-notifications.js":[null],"./ja-jp/unified-search.js":[null],"./ja-jp/unsupported-browser.js":[null],"./ja-jp/url-preview.js":[null],"./ja-jp/video-capture.js":[null],"./ja-jp/video-message.js":[null],"./ja-jp/virtual-events.js":[null],"./ja-jp/webinar.js":[77228,4615],"./ja-jp/whats-new.js":[null],"./ja-jp/wiki.js":[null],"./ka-ge/activity.js":[null],"./ka-ge/artifacts-platform.js":[null],"./ka-ge/audience-view-dialog.js":[null],"./ka-ge/auth.js":[null],"./ka-ge/autosuggest.js":[null],"./ka-ge/avatar.js":[null],"./ka-ge/biometric-enrollment.js":[null],"./ka-ge/breakout-rooms.js":[null],"./ka-ge/broadcast.js":[null],"./ka-ge/calendar.js":[null],"./ka-ge/calling.js":[null],"./ka-ge/campaign-notifications.js":[null],"./ka-ge/carousel-multi-card.js":[null],"./ka-ge/cast.js":[null],"./ka-ge/channels.js":[null],"./ka-ge/chat-list.js":[null],"./ka-ge/coach-report.js":[null],"./ka-ge/communities.js":[null],"./ka-ge/compose.js":[54162,562],"./ka-ge/contacts.js":[null],"./ka-ge/datepicker.js":[null],"./ka-ge/desktop.js":[null],"./ka-ge/digital-signage.js":[null],"./ka-ge/discover-surface.js":[null],"./ka-ge/edu.js":[null],"./ka-ge/embed.js":[null],"./ka-ge/errors.js":[null],"./ka-ge/esp.js":[null],"./ka-ge/extensibility-ptz-extension.js":[null],"./ka-ge/extensibility-room-remote.js":[null],"./ka-ge/extensibility.js":[null],"./ka-ge/files.js":[null],"./ka-ge/framework.js":[72417,562],"./ka-ge/freemium-upgrade.js":[null],"./ka-ge/freemium.js":[null],"./ka-ge/funstuff.js":[null],"./ka-ge/gallery.js":[null],"./ka-ge/growth.js":[null],"./ka-ge/guardians.js":[null],"./ka-ge/health.js":[null],"./ka-ge/hololens.js":[null],"./ka-ge/lightbox.js":[null],"./ka-ge/live-persona-card.js":[null],"./ka-ge/lms-integration.js":[null],"./ka-ge/meet-for-work.js":[null],"./ka-ge/meeting-analytics.js":[null],"./ka-ge/meeting-apis-app.js":[null],"./ka-ge/meeting-bot.js":[null],"./ka-ge/meeting-flyout.js":[null],"./ka-ge/meeting-meet-app.js":[null],"./ka-ge/meeting-options.js":[null],"./ka-ge/meeting-recap.js":[null],"./ka-ge/meeting-room-console.js":[null],"./ka-ge/meeting-stream-app.js":[null],"./ka-ge/message-escalate-dialog.js":[null],"./ka-ge/messaging.js":[56109,562],"./ka-ge/mtma-missed-notifications.js":[null],"./ka-ge/nova.js":[null],"./ka-ge/people-app.js":[null],"./ka-ge/people-picker.js":[null],"./ka-ge/people-targeting.js":[null],"./ka-ge/people.js":[null],"./ka-ge/phonelink-sms.js":[null],"./ka-ge/pre-core.js":[null],"./ka-ge/premium-benefits.js":[null],"./ka-ge/recurrence.js":[null],"./ka-ge/rsc-application-permissions.js":[null],"./ka-ge/search.js":[null],"./ka-ge/semantic-object.js":[null],"./ka-ge/settings.js":[null],"./ka-ge/share-in-meetings.js":[null],"./ka-ge/share-to-teams-outlook-addin.js":[null],"./ka-ge/share-to-teams-third-party.js":[null],"./ka-ge/share-to-teams.js":[null],"./ka-ge/shortcut.js":[null],"./ka-ge/shortcuts.js":[null],"./ka-ge/smart-device.js":[null],"./ka-ge/survey.js":[null],"./ka-ge/sv-flyout.js":[null],"./ka-ge/teams-and-channels.js":[null],"./ka-ge/tfl-onboarding.js":[null],"./ka-ge/toast-notifications.js":[null],"./ka-ge/unified-search.js":[null],"./ka-ge/unsupported-browser.js":[null],"./ka-ge/url-preview.js":[null],"./ka-ge/video-capture.js":[null],"./ka-ge/video-message.js":[null],"./ka-ge/virtual-events.js":[null],"./ka-ge/webinar.js":[86662,562],"./ka-ge/whats-new.js":[null],"./ka-ge/wiki.js":[null],"./kk-kz/activity.js":[null],"./kk-kz/artifacts-platform.js":[null],"./kk-kz/audience-view-dialog.js":[null],"./kk-kz/auth.js":[null],"./kk-kz/autosuggest.js":[null],"./kk-kz/avatar.js":[null],"./kk-kz/biometric-enrollment.js":[null],"./kk-kz/breakout-rooms.js":[null],"./kk-kz/broadcast.js":[null],"./kk-kz/calendar.js":[null],"./kk-kz/calling.js":[null],"./kk-kz/campaign-notifications.js":[null],"./kk-kz/carousel-multi-card.js":[null],"./kk-kz/cast.js":[null],"./kk-kz/channels.js":[null],"./kk-kz/chat-list.js":[null],"./kk-kz/coach-report.js":[null],"./kk-kz/communities.js":[null],"./kk-kz/compose.js":[16436,8456],"./kk-kz/contacts.js":[null],"./kk-kz/datepicker.js":[null],"./kk-kz/desktop.js":[null],"./kk-kz/digital-signage.js":[null],"./kk-kz/discover-surface.js":[null],"./kk-kz/edu.js":[null],"./kk-kz/embed.js":[null],"./kk-kz/errors.js":[null],"./kk-kz/esp.js":[null],"./kk-kz/extensibility-ptz-extension.js":[null],"./kk-kz/extensibility-room-remote.js":[null],"./kk-kz/extensibility.js":[null],"./kk-kz/files.js":[null],"./kk-kz/framework.js":[36806,8456],"./kk-kz/freemium-upgrade.js":[null],"./kk-kz/freemium.js":[null],"./kk-kz/funstuff.js":[null],"./kk-kz/gallery.js":[null],"./kk-kz/growth.js":[null],"./kk-kz/guardians.js":[null],"./kk-kz/health.js":[null],"./kk-kz/hololens.js":[null],"./kk-kz/lightbox.js":[null],"./kk-kz/live-persona-card.js":[null],"./kk-kz/lms-integration.js":[null],"./kk-kz/meet-for-work.js":[null],"./kk-kz/meeting-analytics.js":[null],"./kk-kz/meeting-apis-app.js":[null],"./kk-kz/meeting-bot.js":[null],"./kk-kz/meeting-flyout.js":[null],"./kk-kz/meeting-meet-app.js":[null],"./kk-kz/meeting-options.js":[null],"./kk-kz/meeting-recap.js":[null],"./kk-kz/meeting-room-console.js":[null],"./kk-kz/meeting-stream-app.js":[null],"./kk-kz/message-escalate-dialog.js":[null],"./kk-kz/messaging.js":[96721,8456],"./kk-kz/mtma-missed-notifications.js":[null],"./kk-kz/nova.js":[null],"./kk-kz/people-app.js":[null],"./kk-kz/people-picker.js":[null],"./kk-kz/people-targeting.js":[null],"./kk-kz/people.js":[null],"./kk-kz/phonelink-sms.js":[null],"./kk-kz/pre-core.js":[null],"./kk-kz/premium-benefits.js":[null],"./kk-kz/recurrence.js":[null],"./kk-kz/rsc-application-permissions.js":[null],"./kk-kz/search.js":[null],"./kk-kz/semantic-object.js":[null],"./kk-kz/settings.js":[null],"./kk-kz/share-in-meetings.js":[null],"./kk-kz/share-to-teams-outlook-addin.js":[null],"./kk-kz/share-to-teams-third-party.js":[null],"./kk-kz/share-to-teams.js":[null],"./kk-kz/shortcut.js":[null],"./kk-kz/shortcuts.js":[null],"./kk-kz/smart-device.js":[null],"./kk-kz/survey.js":[null],"./kk-kz/sv-flyout.js":[null],"./kk-kz/teams-and-channels.js":[null],"./kk-kz/tfl-onboarding.js":[null],"./kk-kz/toast-notifications.js":[null],"./kk-kz/unified-search.js":[null],"./kk-kz/unsupported-browser.js":[null],"./kk-kz/url-preview.js":[null],"./kk-kz/video-capture.js":[null],"./kk-kz/video-message.js":[null],"./kk-kz/virtual-events.js":[null],"./kk-kz/webinar.js":[30398,8456],"./kk-kz/whats-new.js":[null],"./kk-kz/wiki.js":[null],"./ko-kr/activity.js":[null],"./ko-kr/artifacts-platform.js":[null],"./ko-kr/audience-view-dialog.js":[null],"./ko-kr/auth.js":[null],"./ko-kr/autosuggest.js":[null],"./ko-kr/avatar.js":[null],"./ko-kr/biometric-enrollment.js":[null],"./ko-kr/breakout-rooms.js":[null],"./ko-kr/broadcast.js":[null],"./ko-kr/calendar.js":[null],"./ko-kr/calling.js":[null],"./ko-kr/campaign-notifications.js":[null],"./ko-kr/carousel-multi-card.js":[null],"./ko-kr/cast.js":[null],"./ko-kr/channels.js":[null],"./ko-kr/chat-list.js":[null],"./ko-kr/coach-report.js":[null],"./ko-kr/communities.js":[null],"./ko-kr/compose.js":[33207,7526],"./ko-kr/contacts.js":[null],"./ko-kr/datepicker.js":[null],"./ko-kr/desktop.js":[null],"./ko-kr/digital-signage.js":[null],"./ko-kr/discover-surface.js":[null],"./ko-kr/edu.js":[null],"./ko-kr/embed.js":[null],"./ko-kr/errors.js":[null],"./ko-kr/esp.js":[null],"./ko-kr/extensibility-ptz-extension.js":[null],"./ko-kr/extensibility-room-remote.js":[null],"./ko-kr/extensibility.js":[null],"./ko-kr/files.js":[null],"./ko-kr/framework.js":[47577,7526],"./ko-kr/freemium-upgrade.js":[null],"./ko-kr/freemium.js":[null],"./ko-kr/funstuff.js":[null],"./ko-kr/gallery.js":[null],"./ko-kr/growth.js":[null],"./ko-kr/guardians.js":[null],"./ko-kr/health.js":[null],"./ko-kr/hololens.js":[null],"./ko-kr/lightbox.js":[null],"./ko-kr/live-persona-card.js":[null],"./ko-kr/lms-integration.js":[null],"./ko-kr/meet-for-work.js":[null],"./ko-kr/meeting-analytics.js":[null],"./ko-kr/meeting-apis-app.js":[null],"./ko-kr/meeting-bot.js":[null],"./ko-kr/meeting-flyout.js":[null],"./ko-kr/meeting-meet-app.js":[null],"./ko-kr/meeting-options.js":[null],"./ko-kr/meeting-recap.js":[null],"./ko-kr/meeting-room-console.js":[null],"./ko-kr/meeting-stream-app.js":[null],"./ko-kr/message-escalate-dialog.js":[null],"./ko-kr/messaging.js":[88132,7526],"./ko-kr/mtma-missed-notifications.js":[null],"./ko-kr/nova.js":[null],"./ko-kr/people-app.js":[null],"./ko-kr/people-picker.js":[null],"./ko-kr/people-targeting.js":[null],"./ko-kr/people.js":[null],"./ko-kr/phonelink-sms.js":[null],"./ko-kr/pre-core.js":[null],"./ko-kr/premium-benefits.js":[null],"./ko-kr/recurrence.js":[null],"./ko-kr/rsc-application-permissions.js":[null],"./ko-kr/search.js":[null],"./ko-kr/semantic-object.js":[null],"./ko-kr/settings.js":[null],"./ko-kr/share-in-meetings.js":[null],"./ko-kr/share-to-teams-outlook-addin.js":[null],"./ko-kr/share-to-teams-third-party.js":[null],"./ko-kr/share-to-teams.js":[null],"./ko-kr/shortcut.js":[null],"./ko-kr/shortcuts.js":[null],"./ko-kr/smart-device.js":[null],"./ko-kr/survey.js":[null],"./ko-kr/sv-flyout.js":[null],"./ko-kr/teams-and-channels.js":[null],"./ko-kr/tfl-onboarding.js":[null],"./ko-kr/toast-notifications.js":[null],"./ko-kr/unified-search.js":[null],"./ko-kr/unsupported-browser.js":[null],"./ko-kr/url-preview.js":[null],"./ko-kr/video-capture.js":[null],"./ko-kr/video-message.js":[null],"./ko-kr/virtual-events.js":[null],"./ko-kr/webinar.js":[52066,7526],"./ko-kr/whats-new.js":[null],"./ko-kr/wiki.js":[null],"./lt-lt/activity.js":[null],"./lt-lt/artifacts-platform.js":[null],"./lt-lt/audience-view-dialog.js":[null],"./lt-lt/auth.js":[null],"./lt-lt/autosuggest.js":[null],"./lt-lt/avatar.js":[null],"./lt-lt/biometric-enrollment.js":[null],"./lt-lt/breakout-rooms.js":[null],"./lt-lt/broadcast.js":[null],"./lt-lt/calendar.js":[null],"./lt-lt/calling.js":[null],"./lt-lt/campaign-notifications.js":[null],"./lt-lt/carousel-multi-card.js":[null],"./lt-lt/cast.js":[null],"./lt-lt/channels.js":[null],"./lt-lt/chat-list.js":[null],"./lt-lt/coach-report.js":[null],"./lt-lt/communities.js":[null],"./lt-lt/compose.js":[41041,1205],"./lt-lt/contacts.js":[null],"./lt-lt/datepicker.js":[null],"./lt-lt/desktop.js":[null],"./lt-lt/digital-signage.js":[null],"./lt-lt/discover-surface.js":[null],"./lt-lt/edu.js":[null],"./lt-lt/embed.js":[null],"./lt-lt/errors.js":[null],"./lt-lt/esp.js":[null],"./lt-lt/extensibility-ptz-extension.js":[null],"./lt-lt/extensibility-room-remote.js":[null],"./lt-lt/extensibility.js":[null],"./lt-lt/files.js":[null],"./lt-lt/framework.js":[96939,1205],"./lt-lt/freemium-upgrade.js":[null],"./lt-lt/freemium.js":[null],"./lt-lt/funstuff.js":[null],"./lt-lt/gallery.js":[null],"./lt-lt/growth.js":[null],"./lt-lt/guardians.js":[null],"./lt-lt/health.js":[null],"./lt-lt/hololens.js":[null],"./lt-lt/lightbox.js":[null],"./lt-lt/live-persona-card.js":[null],"./lt-lt/lms-integration.js":[null],"./lt-lt/meet-for-work.js":[null],"./lt-lt/meeting-analytics.js":[null],"./lt-lt/meeting-apis-app.js":[null],"./lt-lt/meeting-bot.js":[null],"./lt-lt/meeting-flyout.js":[null],"./lt-lt/meeting-meet-app.js":[null],"./lt-lt/meeting-options.js":[null],"./lt-lt/meeting-recap.js":[null],"./lt-lt/meeting-room-console.js":[null],"./lt-lt/meeting-stream-app.js":[null],"./lt-lt/message-escalate-dialog.js":[null],"./lt-lt/messaging.js":[7707,1205],"./lt-lt/mtma-missed-notifications.js":[null],"./lt-lt/nova.js":[null],"./lt-lt/people-app.js":[null],"./lt-lt/people-picker.js":[null],"./lt-lt/people-targeting.js":[null],"./lt-lt/people.js":[null],"./lt-lt/phonelink-sms.js":[null],"./lt-lt/pre-core.js":[null],"./lt-lt/premium-benefits.js":[null],"./lt-lt/recurrence.js":[null],"./lt-lt/rsc-application-permissions.js":[null],"./lt-lt/search.js":[null],"./lt-lt/semantic-object.js":[null],"./lt-lt/settings.js":[null],"./lt-lt/share-in-meetings.js":[null],"./lt-lt/share-to-teams-outlook-addin.js":[null],"./lt-lt/share-to-teams-third-party.js":[null],"./lt-lt/share-to-teams.js":[null],"./lt-lt/shortcut.js":[null],"./lt-lt/shortcuts.js":[null],"./lt-lt/smart-device.js":[null],"./lt-lt/survey.js":[null],"./lt-lt/sv-flyout.js":[null],"./lt-lt/teams-and-channels.js":[null],"./lt-lt/tfl-onboarding.js":[null],"./lt-lt/toast-notifications.js":[null],"./lt-lt/unified-search.js":[null],"./lt-lt/unsupported-browser.js":[null],"./lt-lt/url-preview.js":[null],"./lt-lt/video-capture.js":[null],"./lt-lt/video-message.js":[null],"./lt-lt/virtual-events.js":[null],"./lt-lt/webinar.js":[14362,1205],"./lt-lt/whats-new.js":[null],"./lt-lt/wiki.js":[null],"./lv-lv/activity.js":[null],"./lv-lv/artifacts-platform.js":[null],"./lv-lv/audience-view-dialog.js":[null],"./lv-lv/auth.js":[null],"./lv-lv/autosuggest.js":[null],"./lv-lv/avatar.js":[null],"./lv-lv/biometric-enrollment.js":[null],"./lv-lv/breakout-rooms.js":[null],"./lv-lv/broadcast.js":[null],"./lv-lv/calendar.js":[null],"./lv-lv/calling.js":[null],"./lv-lv/campaign-notifications.js":[null],"./lv-lv/carousel-multi-card.js":[null],"./lv-lv/cast.js":[null],"./lv-lv/channels.js":[null],"./lv-lv/chat-list.js":[null],"./lv-lv/coach-report.js":[null],"./lv-lv/communities.js":[null],"./lv-lv/compose.js":[42524,926],"./lv-lv/contacts.js":[null],"./lv-lv/datepicker.js":[null],"./lv-lv/desktop.js":[null],"./lv-lv/digital-signage.js":[null],"./lv-lv/discover-surface.js":[null],"./lv-lv/edu.js":[null],"./lv-lv/embed.js":[null],"./lv-lv/errors.js":[null],"./lv-lv/esp.js":[null],"./lv-lv/extensibility-ptz-extension.js":[null],"./lv-lv/extensibility-room-remote.js":[null],"./lv-lv/extensibility.js":[null],"./lv-lv/files.js":[null],"./lv-lv/framework.js":[91326,926],"./lv-lv/freemium-upgrade.js":[null],"./lv-lv/freemium.js":[null],"./lv-lv/funstuff.js":[null],"./lv-lv/gallery.js":[null],"./lv-lv/growth.js":[null],"./lv-lv/guardians.js":[null],"./lv-lv/health.js":[null],"./lv-lv/hololens.js":[null],"./lv-lv/lightbox.js":[null],"./lv-lv/live-persona-card.js":[null],"./lv-lv/lms-integration.js":[null],"./lv-lv/meet-for-work.js":[null],"./lv-lv/meeting-analytics.js":[null],"./lv-lv/meeting-apis-app.js":[null],"./lv-lv/meeting-bot.js":[null],"./lv-lv/meeting-flyout.js":[null],"./lv-lv/meeting-meet-app.js":[null],"./lv-lv/meeting-options.js":[null],"./lv-lv/meeting-recap.js":[null],"./lv-lv/meeting-room-console.js":[null],"./lv-lv/meeting-stream-app.js":[null],"./lv-lv/message-escalate-dialog.js":[null],"./lv-lv/messaging.js":[47054,926],"./lv-lv/mtma-missed-notifications.js":[null],"./lv-lv/nova.js":[null],"./lv-lv/people-app.js":[null],"./lv-lv/people-picker.js":[null],"./lv-lv/people-targeting.js":[null],"./lv-lv/people.js":[null],"./lv-lv/phonelink-sms.js":[null],"./lv-lv/pre-core.js":[null],"./lv-lv/premium-benefits.js":[null],"./lv-lv/recurrence.js":[null],"./lv-lv/rsc-application-permissions.js":[null],"./lv-lv/search.js":[null],"./lv-lv/semantic-object.js":[null],"./lv-lv/settings.js":[null],"./lv-lv/share-in-meetings.js":[null],"./lv-lv/share-to-teams-outlook-addin.js":[null],"./lv-lv/share-to-teams-third-party.js":[null],"./lv-lv/share-to-teams.js":[null],"./lv-lv/shortcut.js":[null],"./lv-lv/shortcuts.js":[null],"./lv-lv/smart-device.js":[null],"./lv-lv/survey.js":[null],"./lv-lv/sv-flyout.js":[null],"./lv-lv/teams-and-channels.js":[null],"./lv-lv/tfl-onboarding.js":[null],"./lv-lv/toast-notifications.js":[null],"./lv-lv/unified-search.js":[null],"./lv-lv/unsupported-browser.js":[null],"./lv-lv/url-preview.js":[null],"./lv-lv/video-capture.js":[null],"./lv-lv/video-message.js":[null],"./lv-lv/virtual-events.js":[null],"./lv-lv/webinar.js":[22197,926],"./lv-lv/whats-new.js":[null],"./lv-lv/wiki.js":[null],"./mk-mk/activity.js":[null],"./mk-mk/artifacts-platform.js":[null],"./mk-mk/audience-view-dialog.js":[null],"./mk-mk/auth.js":[null],"./mk-mk/autosuggest.js":[null],"./mk-mk/avatar.js":[null],"./mk-mk/biometric-enrollment.js":[null],"./mk-mk/breakout-rooms.js":[null],"./mk-mk/broadcast.js":[null],"./mk-mk/calendar.js":[null],"./mk-mk/calling.js":[null],"./mk-mk/campaign-notifications.js":[null],"./mk-mk/carousel-multi-card.js":[null],"./mk-mk/cast.js":[null],"./mk-mk/channels.js":[null],"./mk-mk/chat-list.js":[null],"./mk-mk/coach-report.js":[null],"./mk-mk/communities.js":[null],"./mk-mk/compose.js":[37823,8437],"./mk-mk/contacts.js":[null],"./mk-mk/datepicker.js":[null],"./mk-mk/desktop.js":[null],"./mk-mk/digital-signage.js":[null],"./mk-mk/discover-surface.js":[null],"./mk-mk/edu.js":[null],"./mk-mk/embed.js":[null],"./mk-mk/errors.js":[null],"./mk-mk/esp.js":[null],"./mk-mk/extensibility-ptz-extension.js":[null],"./mk-mk/extensibility-room-remote.js":[null],"./mk-mk/extensibility.js":[null],"./mk-mk/files.js":[null],"./mk-mk/framework.js":[63391,8437],"./mk-mk/freemium-upgrade.js":[null],"./mk-mk/freemium.js":[null],"./mk-mk/funstuff.js":[null],"./mk-mk/gallery.js":[null],"./mk-mk/growth.js":[null],"./mk-mk/guardians.js":[null],"./mk-mk/health.js":[null],"./mk-mk/hololens.js":[null],"./mk-mk/lightbox.js":[null],"./mk-mk/live-persona-card.js":[null],"./mk-mk/lms-integration.js":[null],"./mk-mk/meet-for-work.js":[null],"./mk-mk/meeting-analytics.js":[null],"./mk-mk/meeting-apis-app.js":[null],"./mk-mk/meeting-bot.js":[null],"./mk-mk/meeting-flyout.js":[null],"./mk-mk/meeting-meet-app.js":[null],"./mk-mk/meeting-options.js":[null],"./mk-mk/meeting-recap.js":[null],"./mk-mk/meeting-room-console.js":[null],"./mk-mk/meeting-stream-app.js":[null],"./mk-mk/message-escalate-dialog.js":[null],"./mk-mk/messaging.js":[42921,8437],"./mk-mk/mtma-missed-notifications.js":[null],"./mk-mk/nova.js":[null],"./mk-mk/people-app.js":[null],"./mk-mk/people-picker.js":[null],"./mk-mk/people-targeting.js":[null],"./mk-mk/people.js":[null],"./mk-mk/phonelink-sms.js":[null],"./mk-mk/pre-core.js":[null],"./mk-mk/premium-benefits.js":[null],"./mk-mk/recurrence.js":[null],"./mk-mk/rsc-application-permissions.js":[null],"./mk-mk/search.js":[null],"./mk-mk/semantic-object.js":[null],"./mk-mk/settings.js":[null],"./mk-mk/share-in-meetings.js":[null],"./mk-mk/share-to-teams-outlook-addin.js":[null],"./mk-mk/share-to-teams-third-party.js":[null],"./mk-mk/share-to-teams.js":[null],"./mk-mk/shortcut.js":[null],"./mk-mk/shortcuts.js":[null],"./mk-mk/smart-device.js":[null],"./mk-mk/survey.js":[null],"./mk-mk/sv-flyout.js":[null],"./mk-mk/teams-and-channels.js":[null],"./mk-mk/tfl-onboarding.js":[null],"./mk-mk/toast-notifications.js":[null],"./mk-mk/unified-search.js":[null],"./mk-mk/unsupported-browser.js":[null],"./mk-mk/url-preview.js":[null],"./mk-mk/video-capture.js":[null],"./mk-mk/video-message.js":[null],"./mk-mk/virtual-events.js":[null],"./mk-mk/webinar.js":[82103,8437],"./mk-mk/whats-new.js":[null],"./mk-mk/wiki.js":[null],"./nb-no/activity.js":[null],"./nb-no/artifacts-platform.js":[null],"./nb-no/audience-view-dialog.js":[null],"./nb-no/auth.js":[null],"./nb-no/autosuggest.js":[null],"./nb-no/avatar.js":[null],"./nb-no/biometric-enrollment.js":[null],"./nb-no/breakout-rooms.js":[null],"./nb-no/broadcast.js":[null],"./nb-no/calendar.js":[null],"./nb-no/calling.js":[null],"./nb-no/campaign-notifications.js":[null],"./nb-no/carousel-multi-card.js":[null],"./nb-no/cast.js":[null],"./nb-no/channels.js":[null],"./nb-no/chat-list.js":[null],"./nb-no/coach-report.js":[null],"./nb-no/communities.js":[null],"./nb-no/compose.js":[6129,4128],"./nb-no/contacts.js":[null],"./nb-no/datepicker.js":[null],"./nb-no/desktop.js":[null],"./nb-no/digital-signage.js":[null],"./nb-no/discover-surface.js":[null],"./nb-no/edu.js":[null],"./nb-no/embed.js":[null],"./nb-no/errors.js":[null],"./nb-no/esp.js":[null],"./nb-no/extensibility-ptz-extension.js":[null],"./nb-no/extensibility-room-remote.js":[null],"./nb-no/extensibility.js":[null],"./nb-no/files.js":[null],"./nb-no/framework.js":[66244,4128],"./nb-no/freemium-upgrade.js":[null],"./nb-no/freemium.js":[null],"./nb-no/funstuff.js":[null],"./nb-no/gallery.js":[null],"./nb-no/growth.js":[null],"./nb-no/guardians.js":[null],"./nb-no/health.js":[null],"./nb-no/hololens.js":[null],"./nb-no/lightbox.js":[null],"./nb-no/live-persona-card.js":[null],"./nb-no/lms-integration.js":[null],"./nb-no/meet-for-work.js":[null],"./nb-no/meeting-analytics.js":[null],"./nb-no/meeting-apis-app.js":[null],"./nb-no/meeting-bot.js":[null],"./nb-no/meeting-flyout.js":[null],"./nb-no/meeting-meet-app.js":[null],"./nb-no/meeting-options.js":[null],"./nb-no/meeting-recap.js":[null],"./nb-no/meeting-room-console.js":[null],"./nb-no/meeting-stream-app.js":[null],"./nb-no/message-escalate-dialog.js":[null],"./nb-no/messaging.js":[62883,4128],"./nb-no/mtma-missed-notifications.js":[null],"./nb-no/nova.js":[null],"./nb-no/people-app.js":[null],"./nb-no/people-picker.js":[null],"./nb-no/people-targeting.js":[null],"./nb-no/people.js":[null],"./nb-no/phonelink-sms.js":[null],"./nb-no/pre-core.js":[null],"./nb-no/premium-benefits.js":[null],"./nb-no/recurrence.js":[null],"./nb-no/rsc-application-permissions.js":[null],"./nb-no/search.js":[null],"./nb-no/semantic-object.js":[null],"./nb-no/settings.js":[null],"./nb-no/share-in-meetings.js":[null],"./nb-no/share-to-teams-outlook-addin.js":[null],"./nb-no/share-to-teams-third-party.js":[null],"./nb-no/share-to-teams.js":[null],"./nb-no/shortcut.js":[null],"./nb-no/shortcuts.js":[null],"./nb-no/smart-device.js":[null],"./nb-no/survey.js":[null],"./nb-no/sv-flyout.js":[null],"./nb-no/teams-and-channels.js":[null],"./nb-no/tfl-onboarding.js":[null],"./nb-no/toast-notifications.js":[null],"./nb-no/unified-search.js":[null],"./nb-no/unsupported-browser.js":[null],"./nb-no/url-preview.js":[null],"./nb-no/video-capture.js":[null],"./nb-no/video-message.js":[null],"./nb-no/virtual-events.js":[null],"./nb-no/webinar.js":[33161,4128],"./nb-no/whats-new.js":[null],"./nb-no/wiki.js":[null],"./nl-nl/activity.js":[null],"./nl-nl/artifacts-platform.js":[null],"./nl-nl/audience-view-dialog.js":[null],"./nl-nl/auth.js":[null],"./nl-nl/autosuggest.js":[null],"./nl-nl/avatar.js":[null],"./nl-nl/biometric-enrollment.js":[null],"./nl-nl/breakout-rooms.js":[null],"./nl-nl/broadcast.js":[null],"./nl-nl/calendar.js":[null],"./nl-nl/calling.js":[null],"./nl-nl/campaign-notifications.js":[null],"./nl-nl/carousel-multi-card.js":[null],"./nl-nl/cast.js":[null],"./nl-nl/channels.js":[null],"./nl-nl/chat-list.js":[null],"./nl-nl/coach-report.js":[null],"./nl-nl/communities.js":[null],"./nl-nl/compose.js":[88338,4652],"./nl-nl/contacts.js":[null],"./nl-nl/datepicker.js":[null],"./nl-nl/desktop.js":[null],"./nl-nl/digital-signage.js":[null],"./nl-nl/discover-surface.js":[null],"./nl-nl/edu.js":[null],"./nl-nl/embed.js":[null],"./nl-nl/errors.js":[null],"./nl-nl/esp.js":[null],"./nl-nl/extensibility-ptz-extension.js":[null],"./nl-nl/extensibility-room-remote.js":[null],"./nl-nl/extensibility.js":[null],"./nl-nl/files.js":[null],"./nl-nl/framework.js":[57889,4652],"./nl-nl/freemium-upgrade.js":[null],"./nl-nl/freemium.js":[null],"./nl-nl/funstuff.js":[null],"./nl-nl/gallery.js":[null],"./nl-nl/growth.js":[null],"./nl-nl/guardians.js":[null],"./nl-nl/health.js":[null],"./nl-nl/hololens.js":[null],"./nl-nl/lightbox.js":[null],"./nl-nl/live-persona-card.js":[null],"./nl-nl/lms-integration.js":[null],"./nl-nl/meet-for-work.js":[null],"./nl-nl/meeting-analytics.js":[null],"./nl-nl/meeting-apis-app.js":[null],"./nl-nl/meeting-bot.js":[null],"./nl-nl/meeting-flyout.js":[null],"./nl-nl/meeting-meet-app.js":[null],"./nl-nl/meeting-options.js":[null],"./nl-nl/meeting-recap.js":[null],"./nl-nl/meeting-room-console.js":[null],"./nl-nl/meeting-stream-app.js":[null],"./nl-nl/message-escalate-dialog.js":[null],"./nl-nl/messaging.js":[95026,4652],"./nl-nl/mtma-missed-notifications.js":[null],"./nl-nl/nova.js":[null],"./nl-nl/people-app.js":[null],"./nl-nl/people-picker.js":[null],"./nl-nl/people-targeting.js":[null],"./nl-nl/people.js":[null],"./nl-nl/phonelink-sms.js":[null],"./nl-nl/pre-core.js":[null],"./nl-nl/premium-benefits.js":[null],"./nl-nl/recurrence.js":[null],"./nl-nl/rsc-application-permissions.js":[null],"./nl-nl/search.js":[null],"./nl-nl/semantic-object.js":[null],"./nl-nl/settings.js":[null],"./nl-nl/share-in-meetings.js":[null],"./nl-nl/share-to-teams-outlook-addin.js":[null],"./nl-nl/share-to-teams-third-party.js":[null],"./nl-nl/share-to-teams.js":[null],"./nl-nl/shortcut.js":[null],"./nl-nl/shortcuts.js":[null],"./nl-nl/smart-device.js":[null],"./nl-nl/survey.js":[null],"./nl-nl/sv-flyout.js":[null],"./nl-nl/teams-and-channels.js":[null],"./nl-nl/tfl-onboarding.js":[null],"./nl-nl/toast-notifications.js":[null],"./nl-nl/unified-search.js":[null],"./nl-nl/unsupported-browser.js":[null],"./nl-nl/url-preview.js":[null],"./nl-nl/video-capture.js":[null],"./nl-nl/video-message.js":[null],"./nl-nl/virtual-events.js":[null],"./nl-nl/webinar.js":[74272,4652],"./nl-nl/whats-new.js":[null],"./nl-nl/wiki.js":[null],"./nn-no/activity.js":[null],"./nn-no/artifacts-platform.js":[null],"./nn-no/audience-view-dialog.js":[null],"./nn-no/auth.js":[null],"./nn-no/autosuggest.js":[null],"./nn-no/avatar.js":[null],"./nn-no/biometric-enrollment.js":[null],"./nn-no/breakout-rooms.js":[null],"./nn-no/broadcast.js":[null],"./nn-no/calendar.js":[null],"./nn-no/calling.js":[null],"./nn-no/campaign-notifications.js":[null],"./nn-no/carousel-multi-card.js":[null],"./nn-no/cast.js":[null],"./nn-no/channels.js":[null],"./nn-no/chat-list.js":[null],"./nn-no/coach-report.js":[null],"./nn-no/communities.js":[null],"./nn-no/compose.js":[11995,3190],"./nn-no/contacts.js":[null],"./nn-no/datepicker.js":[null],"./nn-no/desktop.js":[null],"./nn-no/digital-signage.js":[null],"./nn-no/discover-surface.js":[null],"./nn-no/edu.js":[null],"./nn-no/embed.js":[null],"./nn-no/errors.js":[null],"./nn-no/esp.js":[null],"./nn-no/extensibility-ptz-extension.js":[null],"./nn-no/extensibility-room-remote.js":[null],"./nn-no/extensibility.js":[null],"./nn-no/files.js":[null],"./nn-no/framework.js":[24013,3190],"./nn-no/freemium-upgrade.js":[null],"./nn-no/freemium.js":[null],"./nn-no/funstuff.js":[null],"./nn-no/gallery.js":[null],"./nn-no/growth.js":[null],"./nn-no/guardians.js":[null],"./nn-no/health.js":[null],"./nn-no/hololens.js":[null],"./nn-no/lightbox.js":[null],"./nn-no/live-persona-card.js":[null],"./nn-no/lms-integration.js":[null],"./nn-no/meet-for-work.js":[null],"./nn-no/meeting-analytics.js":[null],"./nn-no/meeting-apis-app.js":[null],"./nn-no/meeting-bot.js":[null],"./nn-no/meeting-flyout.js":[null],"./nn-no/meeting-meet-app.js":[null],"./nn-no/meeting-options.js":[null],"./nn-no/meeting-recap.js":[null],"./nn-no/meeting-room-console.js":[null],"./nn-no/meeting-stream-app.js":[null],"./nn-no/message-escalate-dialog.js":[null],"./nn-no/messaging.js":[39151,3190],"./nn-no/mtma-missed-notifications.js":[null],"./nn-no/nova.js":[null],"./nn-no/people-app.js":[null],"./nn-no/people-picker.js":[null],"./nn-no/people-targeting.js":[null],"./nn-no/people.js":[null],"./nn-no/phonelink-sms.js":[null],"./nn-no/pre-core.js":[null],"./nn-no/premium-benefits.js":[null],"./nn-no/recurrence.js":[null],"./nn-no/rsc-application-permissions.js":[null],"./nn-no/search.js":[null],"./nn-no/semantic-object.js":[null],"./nn-no/settings.js":[null],"./nn-no/share-in-meetings.js":[null],"./nn-no/share-to-teams-outlook-addin.js":[null],"./nn-no/share-to-teams-third-party.js":[null],"./nn-no/share-to-teams.js":[null],"./nn-no/shortcut.js":[null],"./nn-no/shortcuts.js":[null],"./nn-no/smart-device.js":[null],"./nn-no/survey.js":[null],"./nn-no/sv-flyout.js":[null],"./nn-no/teams-and-channels.js":[null],"./nn-no/tfl-onboarding.js":[null],"./nn-no/toast-notifications.js":[null],"./nn-no/unified-search.js":[null],"./nn-no/unsupported-browser.js":[null],"./nn-no/url-preview.js":[null],"./nn-no/video-capture.js":[null],"./nn-no/video-message.js":[null],"./nn-no/virtual-events.js":[null],"./nn-no/webinar.js":[88642,3190],"./nn-no/whats-new.js":[null],"./nn-no/wiki.js":[null],"./pl-pl/activity.js":[null],"./pl-pl/artifacts-platform.js":[null],"./pl-pl/audience-view-dialog.js":[null],"./pl-pl/auth.js":[null],"./pl-pl/autosuggest.js":[null],"./pl-pl/avatar.js":[null],"./pl-pl/biometric-enrollment.js":[null],"./pl-pl/breakout-rooms.js":[null],"./pl-pl/broadcast.js":[null],"./pl-pl/calendar.js":[null],"./pl-pl/calling.js":[null],"./pl-pl/campaign-notifications.js":[null],"./pl-pl/carousel-multi-card.js":[null],"./pl-pl/cast.js":[null],"./pl-pl/channels.js":[null],"./pl-pl/chat-list.js":[null],"./pl-pl/coach-report.js":[null],"./pl-pl/communities.js":[null],"./pl-pl/compose.js":[35028,3062],"./pl-pl/contacts.js":[null],"./pl-pl/datepicker.js":[null],"./pl-pl/desktop.js":[null],"./pl-pl/digital-signage.js":[null],"./pl-pl/discover-surface.js":[null],"./pl-pl/edu.js":[null],"./pl-pl/embed.js":[null],"./pl-pl/errors.js":[null],"./pl-pl/esp.js":[null],"./pl-pl/extensibility-ptz-extension.js":[null],"./pl-pl/extensibility-room-remote.js":[null],"./pl-pl/extensibility.js":[null],"./pl-pl/files.js":[null],"./pl-pl/framework.js":[60633,3062],"./pl-pl/freemium-upgrade.js":[null],"./pl-pl/freemium.js":[null],"./pl-pl/funstuff.js":[null],"./pl-pl/gallery.js":[null],"./pl-pl/growth.js":[null],"./pl-pl/guardians.js":[null],"./pl-pl/health.js":[null],"./pl-pl/hololens.js":[null],"./pl-pl/lightbox.js":[null],"./pl-pl/live-persona-card.js":[null],"./pl-pl/lms-integration.js":[null],"./pl-pl/meet-for-work.js":[null],"./pl-pl/meeting-analytics.js":[null],"./pl-pl/meeting-apis-app.js":[null],"./pl-pl/meeting-bot.js":[null],"./pl-pl/meeting-flyout.js":[null],"./pl-pl/meeting-meet-app.js":[null],"./pl-pl/meeting-options.js":[null],"./pl-pl/meeting-recap.js":[null],"./pl-pl/meeting-room-console.js":[null],"./pl-pl/meeting-stream-app.js":[null],"./pl-pl/message-escalate-dialog.js":[null],"./pl-pl/messaging.js":[2794,3062],"./pl-pl/mtma-missed-notifications.js":[null],"./pl-pl/nova.js":[null],"./pl-pl/people-app.js":[null],"./pl-pl/people-picker.js":[null],"./pl-pl/people-targeting.js":[null],"./pl-pl/people.js":[null],"./pl-pl/phonelink-sms.js":[null],"./pl-pl/pre-core.js":[null],"./pl-pl/premium-benefits.js":[null],"./pl-pl/recurrence.js":[null],"./pl-pl/rsc-application-permissions.js":[null],"./pl-pl/search.js":[null],"./pl-pl/semantic-object.js":[null],"./pl-pl/settings.js":[null],"./pl-pl/share-in-meetings.js":[null],"./pl-pl/share-to-teams-outlook-addin.js":[null],"./pl-pl/share-to-teams-third-party.js":[null],"./pl-pl/share-to-teams.js":[null],"./pl-pl/shortcut.js":[null],"./pl-pl/shortcuts.js":[null],"./pl-pl/smart-device.js":[null],"./pl-pl/survey.js":[null],"./pl-pl/sv-flyout.js":[null],"./pl-pl/teams-and-channels.js":[null],"./pl-pl/tfl-onboarding.js":[null],"./pl-pl/toast-notifications.js":[null],"./pl-pl/unified-search.js":[null],"./pl-pl/unsupported-browser.js":[null],"./pl-pl/url-preview.js":[null],"./pl-pl/video-capture.js":[null],"./pl-pl/video-message.js":[null],"./pl-pl/virtual-events.js":[null],"./pl-pl/webinar.js":[97858,3062],"./pl-pl/whats-new.js":[null],"./pl-pl/wiki.js":[null],"./pt-br/activity.js":[null],"./pt-br/artifacts-platform.js":[null],"./pt-br/audience-view-dialog.js":[null],"./pt-br/auth.js":[null],"./pt-br/autosuggest.js":[null],"./pt-br/avatar.js":[null],"./pt-br/biometric-enrollment.js":[null],"./pt-br/breakout-rooms.js":[null],"./pt-br/broadcast.js":[null],"./pt-br/calendar.js":[null],"./pt-br/calling.js":[null],"./pt-br/campaign-notifications.js":[null],"./pt-br/carousel-multi-card.js":[null],"./pt-br/cast.js":[null],"./pt-br/channels.js":[null],"./pt-br/chat-list.js":[null],"./pt-br/coach-report.js":[null],"./pt-br/communities.js":[null],"./pt-br/compose.js":[96313,928],"./pt-br/contacts.js":[null],"./pt-br/datepicker.js":[null],"./pt-br/desktop.js":[null],"./pt-br/digital-signage.js":[null],"./pt-br/discover-surface.js":[null],"./pt-br/edu.js":[null],"./pt-br/embed.js":[null],"./pt-br/errors.js":[null],"./pt-br/esp.js":[null],"./pt-br/extensibility-ptz-extension.js":[null],"./pt-br/extensibility-room-remote.js":[null],"./pt-br/extensibility.js":[null],"./pt-br/files.js":[null],"./pt-br/framework.js":[39618,928],"./pt-br/freemium-upgrade.js":[null],"./pt-br/freemium.js":[null],"./pt-br/funstuff.js":[null],"./pt-br/gallery.js":[null],"./pt-br/growth.js":[null],"./pt-br/guardians.js":[null],"./pt-br/health.js":[null],"./pt-br/hololens.js":[null],"./pt-br/lightbox.js":[null],"./pt-br/live-persona-card.js":[null],"./pt-br/lms-integration.js":[null],"./pt-br/meet-for-work.js":[null],"./pt-br/meeting-analytics.js":[null],"./pt-br/meeting-apis-app.js":[null],"./pt-br/meeting-bot.js":[null],"./pt-br/meeting-flyout.js":[null],"./pt-br/meeting-meet-app.js":[null],"./pt-br/meeting-options.js":[null],"./pt-br/meeting-recap.js":[null],"./pt-br/meeting-room-console.js":[null],"./pt-br/meeting-stream-app.js":[null],"./pt-br/message-escalate-dialog.js":[null],"./pt-br/messaging.js":[48531,928],"./pt-br/mtma-missed-notifications.js":[null],"./pt-br/nova.js":[null],"./pt-br/people-app.js":[null],"./pt-br/people-picker.js":[null],"./pt-br/people-targeting.js":[null],"./pt-br/people.js":[null],"./pt-br/phonelink-sms.js":[null],"./pt-br/pre-core.js":[null],"./pt-br/premium-benefits.js":[null],"./pt-br/recurrence.js":[null],"./pt-br/rsc-application-permissions.js":[null],"./pt-br/search.js":[null],"./pt-br/semantic-object.js":[null],"./pt-br/settings.js":[null],"./pt-br/share-in-meetings.js":[null],"./pt-br/share-to-teams-outlook-addin.js":[null],"./pt-br/share-to-teams-third-party.js":[null],"./pt-br/share-to-teams.js":[null],"./pt-br/shortcut.js":[null],"./pt-br/shortcuts.js":[null],"./pt-br/smart-device.js":[null],"./pt-br/survey.js":[null],"./pt-br/sv-flyout.js":[null],"./pt-br/teams-and-channels.js":[null],"./pt-br/tfl-onboarding.js":[null],"./pt-br/toast-notifications.js":[null],"./pt-br/unified-search.js":[null],"./pt-br/unsupported-browser.js":[null],"./pt-br/url-preview.js":[null],"./pt-br/video-capture.js":[null],"./pt-br/video-message.js":[null],"./pt-br/virtual-events.js":[null],"./pt-br/webinar.js":[56296,928],"./pt-br/whats-new.js":[null],"./pt-br/wiki.js":[null],"./pt-pt/activity.js":[null],"./pt-pt/artifacts-platform.js":[null],"./pt-pt/audience-view-dialog.js":[null],"./pt-pt/auth.js":[null],"./pt-pt/autosuggest.js":[null],"./pt-pt/avatar.js":[null],"./pt-pt/biometric-enrollment.js":[null],"./pt-pt/breakout-rooms.js":[null],"./pt-pt/broadcast.js":[null],"./pt-pt/calendar.js":[null],"./pt-pt/calling.js":[null],"./pt-pt/campaign-notifications.js":[null],"./pt-pt/carousel-multi-card.js":[null],"./pt-pt/cast.js":[null],"./pt-pt/channels.js":[null],"./pt-pt/chat-list.js":[null],"./pt-pt/coach-report.js":[null],"./pt-pt/communities.js":[null],"./pt-pt/compose.js":[99750,7828],"./pt-pt/contacts.js":[null],"./pt-pt/datepicker.js":[null],"./pt-pt/desktop.js":[null],"./pt-pt/digital-signage.js":[null],"./pt-pt/discover-surface.js":[null],"./pt-pt/edu.js":[null],"./pt-pt/embed.js":[null],"./pt-pt/errors.js":[null],"./pt-pt/esp.js":[null],"./pt-pt/extensibility-ptz-extension.js":[null],"./pt-pt/extensibility-room-remote.js":[null],"./pt-pt/extensibility.js":[null],"./pt-pt/files.js":[null],"./pt-pt/framework.js":[31538,7828],"./pt-pt/freemium-upgrade.js":[null],"./pt-pt/freemium.js":[null],"./pt-pt/funstuff.js":[null],"./pt-pt/gallery.js":[null],"./pt-pt/growth.js":[null],"./pt-pt/guardians.js":[null],"./pt-pt/health.js":[null],"./pt-pt/hololens.js":[null],"./pt-pt/lightbox.js":[null],"./pt-pt/live-persona-card.js":[null],"./pt-pt/lms-integration.js":[null],"./pt-pt/meet-for-work.js":[null],"./pt-pt/meeting-analytics.js":[null],"./pt-pt/meeting-apis-app.js":[null],"./pt-pt/meeting-bot.js":[null],"./pt-pt/meeting-flyout.js":[null],"./pt-pt/meeting-meet-app.js":[null],"./pt-pt/meeting-options.js":[null],"./pt-pt/meeting-recap.js":[null],"./pt-pt/meeting-room-console.js":[null],"./pt-pt/meeting-stream-app.js":[null],"./pt-pt/message-escalate-dialog.js":[null],"./pt-pt/messaging.js":[80504,7828],"./pt-pt/mtma-missed-notifications.js":[null],"./pt-pt/nova.js":[null],"./pt-pt/people-app.js":[null],"./pt-pt/people-picker.js":[null],"./pt-pt/people-targeting.js":[null],"./pt-pt/people.js":[null],"./pt-pt/phonelink-sms.js":[null],"./pt-pt/pre-core.js":[null],"./pt-pt/premium-benefits.js":[null],"./pt-pt/recurrence.js":[null],"./pt-pt/rsc-application-permissions.js":[null],"./pt-pt/search.js":[null],"./pt-pt/semantic-object.js":[null],"./pt-pt/settings.js":[null],"./pt-pt/share-in-meetings.js":[null],"./pt-pt/share-to-teams-outlook-addin.js":[null],"./pt-pt/share-to-teams-third-party.js":[null],"./pt-pt/share-to-teams.js":[null],"./pt-pt/shortcut.js":[null],"./pt-pt/shortcuts.js":[null],"./pt-pt/smart-device.js":[null],"./pt-pt/survey.js":[null],"./pt-pt/sv-flyout.js":[null],"./pt-pt/teams-and-channels.js":[null],"./pt-pt/tfl-onboarding.js":[null],"./pt-pt/toast-notifications.js":[null],"./pt-pt/unified-search.js":[null],"./pt-pt/unsupported-browser.js":[null],"./pt-pt/url-preview.js":[null],"./pt-pt/video-capture.js":[null],"./pt-pt/video-message.js":[null],"./pt-pt/virtual-events.js":[null],"./pt-pt/webinar.js":[20379,7828],"./pt-pt/whats-new.js":[null],"./pt-pt/wiki.js":[null],"./ro-ro/activity.js":[null],"./ro-ro/artifacts-platform.js":[null],"./ro-ro/audience-view-dialog.js":[null],"./ro-ro/auth.js":[null],"./ro-ro/autosuggest.js":[null],"./ro-ro/avatar.js":[null],"./ro-ro/biometric-enrollment.js":[null],"./ro-ro/breakout-rooms.js":[null],"./ro-ro/broadcast.js":[null],"./ro-ro/calendar.js":[null],"./ro-ro/calling.js":[null],"./ro-ro/campaign-notifications.js":[null],"./ro-ro/carousel-multi-card.js":[null],"./ro-ro/cast.js":[null],"./ro-ro/channels.js":[null],"./ro-ro/chat-list.js":[null],"./ro-ro/coach-report.js":[null],"./ro-ro/communities.js":[null],"./ro-ro/compose.js":[37636,1554],"./ro-ro/contacts.js":[null],"./ro-ro/datepicker.js":[null],"./ro-ro/desktop.js":[null],"./ro-ro/digital-signage.js":[null],"./ro-ro/discover-surface.js":[null],"./ro-ro/edu.js":[null],"./ro-ro/embed.js":[null],"./ro-ro/errors.js":[null],"./ro-ro/esp.js":[null],"./ro-ro/extensibility-ptz-extension.js":[null],"./ro-ro/extensibility-room-remote.js":[null],"./ro-ro/extensibility.js":[null],"./ro-ro/files.js":[null],"./ro-ro/framework.js":[95766,1554],"./ro-ro/freemium-upgrade.js":[null],"./ro-ro/freemium.js":[null],"./ro-ro/funstuff.js":[null],"./ro-ro/gallery.js":[null],"./ro-ro/growth.js":[null],"./ro-ro/guardians.js":[null],"./ro-ro/health.js":[null],"./ro-ro/hololens.js":[null],"./ro-ro/lightbox.js":[null],"./ro-ro/live-persona-card.js":[null],"./ro-ro/lms-integration.js":[null],"./ro-ro/meet-for-work.js":[null],"./ro-ro/meeting-analytics.js":[null],"./ro-ro/meeting-apis-app.js":[null],"./ro-ro/meeting-bot.js":[null],"./ro-ro/meeting-flyout.js":[null],"./ro-ro/meeting-meet-app.js":[null],"./ro-ro/meeting-options.js":[null],"./ro-ro/meeting-recap.js":[null],"./ro-ro/meeting-room-console.js":[null],"./ro-ro/meeting-stream-app.js":[null],"./ro-ro/message-escalate-dialog.js":[null],"./ro-ro/messaging.js":[18390,1554],"./ro-ro/mtma-missed-notifications.js":[null],"./ro-ro/nova.js":[null],"./ro-ro/people-app.js":[null],"./ro-ro/people-picker.js":[null],"./ro-ro/people-targeting.js":[null],"./ro-ro/people.js":[null],"./ro-ro/phonelink-sms.js":[null],"./ro-ro/pre-core.js":[null],"./ro-ro/premium-benefits.js":[null],"./ro-ro/recurrence.js":[null],"./ro-ro/rsc-application-permissions.js":[null],"./ro-ro/search.js":[null],"./ro-ro/semantic-object.js":[null],"./ro-ro/settings.js":[null],"./ro-ro/share-in-meetings.js":[null],"./ro-ro/share-to-teams-outlook-addin.js":[null],"./ro-ro/share-to-teams-third-party.js":[null],"./ro-ro/share-to-teams.js":[null],"./ro-ro/shortcut.js":[null],"./ro-ro/shortcuts.js":[null],"./ro-ro/smart-device.js":[null],"./ro-ro/survey.js":[null],"./ro-ro/sv-flyout.js":[null],"./ro-ro/teams-and-channels.js":[null],"./ro-ro/tfl-onboarding.js":[null],"./ro-ro/toast-notifications.js":[null],"./ro-ro/unified-search.js":[null],"./ro-ro/unsupported-browser.js":[null],"./ro-ro/url-preview.js":[null],"./ro-ro/video-capture.js":[null],"./ro-ro/video-message.js":[null],"./ro-ro/virtual-events.js":[null],"./ro-ro/webinar.js":[90210,1554],"./ro-ro/whats-new.js":[null],"./ro-ro/wiki.js":[null],"./ru-ru/activity.js":[null],"./ru-ru/artifacts-platform.js":[null],"./ru-ru/audience-view-dialog.js":[null],"./ru-ru/auth.js":[null],"./ru-ru/autosuggest.js":[null],"./ru-ru/avatar.js":[null],"./ru-ru/biometric-enrollment.js":[null],"./ru-ru/breakout-rooms.js":[null],"./ru-ru/broadcast.js":[null],"./ru-ru/calendar.js":[null],"./ru-ru/calling.js":[null],"./ru-ru/campaign-notifications.js":[null],"./ru-ru/carousel-multi-card.js":[null],"./ru-ru/cast.js":[null],"./ru-ru/channels.js":[null],"./ru-ru/chat-list.js":[null],"./ru-ru/coach-report.js":[null],"./ru-ru/communities.js":[null],"./ru-ru/compose.js":[5132,4743],"./ru-ru/contacts.js":[null],"./ru-ru/datepicker.js":[null],"./ru-ru/desktop.js":[null],"./ru-ru/digital-signage.js":[null],"./ru-ru/discover-surface.js":[null],"./ru-ru/edu.js":[null],"./ru-ru/embed.js":[null],"./ru-ru/errors.js":[null],"./ru-ru/esp.js":[null],"./ru-ru/extensibility-ptz-extension.js":[null],"./ru-ru/extensibility-room-remote.js":[null],"./ru-ru/extensibility.js":[null],"./ru-ru/files.js":[null],"./ru-ru/framework.js":[11500,4743],"./ru-ru/freemium-upgrade.js":[null],"./ru-ru/freemium.js":[null],"./ru-ru/funstuff.js":[null],"./ru-ru/gallery.js":[null],"./ru-ru/growth.js":[null],"./ru-ru/guardians.js":[null],"./ru-ru/health.js":[null],"./ru-ru/hololens.js":[null],"./ru-ru/lightbox.js":[null],"./ru-ru/live-persona-card.js":[null],"./ru-ru/lms-integration.js":[null],"./ru-ru/meet-for-work.js":[null],"./ru-ru/meeting-analytics.js":[null],"./ru-ru/meeting-apis-app.js":[null],"./ru-ru/meeting-bot.js":[null],"./ru-ru/meeting-flyout.js":[null],"./ru-ru/meeting-meet-app.js":[null],"./ru-ru/meeting-options.js":[null],"./ru-ru/meeting-recap.js":[null],"./ru-ru/meeting-room-console.js":[null],"./ru-ru/meeting-stream-app.js":[null],"./ru-ru/message-escalate-dialog.js":[null],"./ru-ru/messaging.js":[987,4743],"./ru-ru/mtma-missed-notifications.js":[null],"./ru-ru/nova.js":[null],"./ru-ru/people-app.js":[null],"./ru-ru/people-picker.js":[null],"./ru-ru/people-targeting.js":[null],"./ru-ru/people.js":[null],"./ru-ru/phonelink-sms.js":[null],"./ru-ru/pre-core.js":[null],"./ru-ru/premium-benefits.js":[null],"./ru-ru/recurrence.js":[null],"./ru-ru/rsc-application-permissions.js":[null],"./ru-ru/search.js":[null],"./ru-ru/semantic-object.js":[null],"./ru-ru/settings.js":[null],"./ru-ru/share-in-meetings.js":[null],"./ru-ru/share-to-teams-outlook-addin.js":[null],"./ru-ru/share-to-teams-third-party.js":[null],"./ru-ru/share-to-teams.js":[null],"./ru-ru/shortcut.js":[null],"./ru-ru/shortcuts.js":[null],"./ru-ru/smart-device.js":[null],"./ru-ru/survey.js":[null],"./ru-ru/sv-flyout.js":[null],"./ru-ru/teams-and-channels.js":[null],"./ru-ru/tfl-onboarding.js":[null],"./ru-ru/toast-notifications.js":[null],"./ru-ru/unified-search.js":[null],"./ru-ru/unsupported-browser.js":[null],"./ru-ru/url-preview.js":[null],"./ru-ru/video-capture.js":[null],"./ru-ru/video-message.js":[null],"./ru-ru/virtual-events.js":[null],"./ru-ru/webinar.js":[77637,4743],"./ru-ru/whats-new.js":[null],"./ru-ru/wiki.js":[null],"./sk-sk/activity.js":[null],"./sk-sk/artifacts-platform.js":[null],"./sk-sk/audience-view-dialog.js":[null],"./sk-sk/auth.js":[null],"./sk-sk/autosuggest.js":[null],"./sk-sk/avatar.js":[null],"./sk-sk/biometric-enrollment.js":[null],"./sk-sk/breakout-rooms.js":[null],"./sk-sk/broadcast.js":[null],"./sk-sk/calendar.js":[null],"./sk-sk/calling.js":[null],"./sk-sk/campaign-notifications.js":[null],"./sk-sk/carousel-multi-card.js":[null],"./sk-sk/cast.js":[null],"./sk-sk/channels.js":[null],"./sk-sk/chat-list.js":[null],"./sk-sk/coach-report.js":[null],"./sk-sk/communities.js":[null],"./sk-sk/compose.js":[18387,7199],"./sk-sk/contacts.js":[null],"./sk-sk/datepicker.js":[null],"./sk-sk/desktop.js":[null],"./sk-sk/digital-signage.js":[null],"./sk-sk/discover-surface.js":[null],"./sk-sk/edu.js":[null],"./sk-sk/embed.js":[null],"./sk-sk/errors.js":[null],"./sk-sk/esp.js":[null],"./sk-sk/extensibility-ptz-extension.js":[null],"./sk-sk/extensibility-room-remote.js":[null],"./sk-sk/extensibility.js":[null],"./sk-sk/files.js":[null],"./sk-sk/framework.js":[87181,7199],"./sk-sk/freemium-upgrade.js":[null],"./sk-sk/freemium.js":[null],"./sk-sk/funstuff.js":[null],"./sk-sk/gallery.js":[null],"./sk-sk/growth.js":[null],"./sk-sk/guardians.js":[null],"./sk-sk/health.js":[null],"./sk-sk/hololens.js":[null],"./sk-sk/lightbox.js":[null],"./sk-sk/live-persona-card.js":[null],"./sk-sk/lms-integration.js":[null],"./sk-sk/meet-for-work.js":[null],"./sk-sk/meeting-analytics.js":[null],"./sk-sk/meeting-apis-app.js":[null],"./sk-sk/meeting-bot.js":[null],"./sk-sk/meeting-flyout.js":[null],"./sk-sk/meeting-meet-app.js":[null],"./sk-sk/meeting-options.js":[null],"./sk-sk/meeting-recap.js":[null],"./sk-sk/meeting-room-console.js":[null],"./sk-sk/meeting-stream-app.js":[null],"./sk-sk/message-escalate-dialog.js":[null],"./sk-sk/messaging.js":[56016,7199],"./sk-sk/mtma-missed-notifications.js":[null],"./sk-sk/nova.js":[null],"./sk-sk/people-app.js":[null],"./sk-sk/people-picker.js":[null],"./sk-sk/people-targeting.js":[null],"./sk-sk/people.js":[null],"./sk-sk/phonelink-sms.js":[null],"./sk-sk/pre-core.js":[null],"./sk-sk/premium-benefits.js":[null],"./sk-sk/recurrence.js":[null],"./sk-sk/rsc-application-permissions.js":[null],"./sk-sk/search.js":[null],"./sk-sk/semantic-object.js":[null],"./sk-sk/settings.js":[null],"./sk-sk/share-in-meetings.js":[null],"./sk-sk/share-to-teams-outlook-addin.js":[null],"./sk-sk/share-to-teams-third-party.js":[null],"./sk-sk/share-to-teams.js":[null],"./sk-sk/shortcut.js":[null],"./sk-sk/shortcuts.js":[null],"./sk-sk/smart-device.js":[null],"./sk-sk/survey.js":[null],"./sk-sk/sv-flyout.js":[null],"./sk-sk/teams-and-channels.js":[null],"./sk-sk/tfl-onboarding.js":[null],"./sk-sk/toast-notifications.js":[null],"./sk-sk/unified-search.js":[null],"./sk-sk/unsupported-browser.js":[null],"./sk-sk/url-preview.js":[null],"./sk-sk/video-capture.js":[null],"./sk-sk/video-message.js":[null],"./sk-sk/virtual-events.js":[null],"./sk-sk/webinar.js":[20889,7199],"./sk-sk/whats-new.js":[null],"./sk-sk/wiki.js":[null],"./sl-si/activity.js":[null],"./sl-si/artifacts-platform.js":[null],"./sl-si/audience-view-dialog.js":[null],"./sl-si/auth.js":[null],"./sl-si/autosuggest.js":[null],"./sl-si/avatar.js":[null],"./sl-si/biometric-enrollment.js":[null],"./sl-si/breakout-rooms.js":[null],"./sl-si/broadcast.js":[null],"./sl-si/calendar.js":[null],"./sl-si/calling.js":[null],"./sl-si/campaign-notifications.js":[null],"./sl-si/carousel-multi-card.js":[null],"./sl-si/cast.js":[null],"./sl-si/channels.js":[null],"./sl-si/chat-list.js":[null],"./sl-si/coach-report.js":[null],"./sl-si/communities.js":[null],"./sl-si/compose.js":[75805,9151],"./sl-si/contacts.js":[null],"./sl-si/datepicker.js":[null],"./sl-si/desktop.js":[null],"./sl-si/digital-signage.js":[null],"./sl-si/discover-surface.js":[null],"./sl-si/edu.js":[null],"./sl-si/embed.js":[null],"./sl-si/errors.js":[null],"./sl-si/esp.js":[null],"./sl-si/extensibility-ptz-extension.js":[null],"./sl-si/extensibility-room-remote.js":[null],"./sl-si/extensibility.js":[null],"./sl-si/files.js":[null],"./sl-si/framework.js":[19960,9151],"./sl-si/freemium-upgrade.js":[null],"./sl-si/freemium.js":[null],"./sl-si/funstuff.js":[null],"./sl-si/gallery.js":[null],"./sl-si/growth.js":[null],"./sl-si/guardians.js":[null],"./sl-si/health.js":[null],"./sl-si/hololens.js":[null],"./sl-si/lightbox.js":[null],"./sl-si/live-persona-card.js":[null],"./sl-si/lms-integration.js":[null],"./sl-si/meet-for-work.js":[null],"./sl-si/meeting-analytics.js":[null],"./sl-si/meeting-apis-app.js":[null],"./sl-si/meeting-bot.js":[null],"./sl-si/meeting-flyout.js":[null],"./sl-si/meeting-meet-app.js":[null],"./sl-si/meeting-options.js":[null],"./sl-si/meeting-recap.js":[null],"./sl-si/meeting-room-console.js":[null],"./sl-si/meeting-stream-app.js":[null],"./sl-si/message-escalate-dialog.js":[null],"./sl-si/messaging.js":[20294,9151],"./sl-si/mtma-missed-notifications.js":[null],"./sl-si/nova.js":[null],"./sl-si/people-app.js":[null],"./sl-si/people-picker.js":[null],"./sl-si/people-targeting.js":[null],"./sl-si/people.js":[null],"./sl-si/phonelink-sms.js":[null],"./sl-si/pre-core.js":[null],"./sl-si/premium-benefits.js":[null],"./sl-si/recurrence.js":[null],"./sl-si/rsc-application-permissions.js":[null],"./sl-si/search.js":[null],"./sl-si/semantic-object.js":[null],"./sl-si/settings.js":[null],"./sl-si/share-in-meetings.js":[null],"./sl-si/share-to-teams-outlook-addin.js":[null],"./sl-si/share-to-teams-third-party.js":[null],"./sl-si/share-to-teams.js":[null],"./sl-si/shortcut.js":[null],"./sl-si/shortcuts.js":[null],"./sl-si/smart-device.js":[null],"./sl-si/survey.js":[null],"./sl-si/sv-flyout.js":[null],"./sl-si/teams-and-channels.js":[null],"./sl-si/tfl-onboarding.js":[null],"./sl-si/toast-notifications.js":[null],"./sl-si/unified-search.js":[null],"./sl-si/unsupported-browser.js":[null],"./sl-si/url-preview.js":[null],"./sl-si/video-capture.js":[null],"./sl-si/video-message.js":[null],"./sl-si/virtual-events.js":[null],"./sl-si/webinar.js":[4843,9151],"./sl-si/whats-new.js":[null],"./sl-si/wiki.js":[null],"./sq-al/activity.js":[null],"./sq-al/artifacts-platform.js":[null],"./sq-al/audience-view-dialog.js":[null],"./sq-al/auth.js":[null],"./sq-al/autosuggest.js":[null],"./sq-al/avatar.js":[null],"./sq-al/biometric-enrollment.js":[null],"./sq-al/breakout-rooms.js":[null],"./sq-al/broadcast.js":[null],"./sq-al/calendar.js":[null],"./sq-al/calling.js":[null],"./sq-al/campaign-notifications.js":[null],"./sq-al/carousel-multi-card.js":[null],"./sq-al/cast.js":[null],"./sq-al/channels.js":[null],"./sq-al/chat-list.js":[null],"./sq-al/coach-report.js":[null],"./sq-al/communities.js":[null],"./sq-al/compose.js":[42515,1331],"./sq-al/contacts.js":[null],"./sq-al/datepicker.js":[null],"./sq-al/desktop.js":[null],"./sq-al/digital-signage.js":[null],"./sq-al/discover-surface.js":[null],"./sq-al/edu.js":[null],"./sq-al/embed.js":[null],"./sq-al/errors.js":[null],"./sq-al/esp.js":[null],"./sq-al/extensibility-ptz-extension.js":[null],"./sq-al/extensibility-room-remote.js":[null],"./sq-al/extensibility.js":[null],"./sq-al/files.js":[null],"./sq-al/framework.js":[16396,1331],"./sq-al/freemium-upgrade.js":[null],"./sq-al/freemium.js":[null],"./sq-al/funstuff.js":[null],"./sq-al/gallery.js":[null],"./sq-al/growth.js":[null],"./sq-al/guardians.js":[null],"./sq-al/health.js":[null],"./sq-al/hololens.js":[null],"./sq-al/lightbox.js":[null],"./sq-al/live-persona-card.js":[null],"./sq-al/lms-integration.js":[null],"./sq-al/meet-for-work.js":[null],"./sq-al/meeting-analytics.js":[null],"./sq-al/meeting-apis-app.js":[null],"./sq-al/meeting-bot.js":[null],"./sq-al/meeting-flyout.js":[null],"./sq-al/meeting-meet-app.js":[null],"./sq-al/meeting-options.js":[null],"./sq-al/meeting-recap.js":[null],"./sq-al/meeting-room-console.js":[null],"./sq-al/meeting-stream-app.js":[null],"./sq-al/message-escalate-dialog.js":[null],"./sq-al/messaging.js":[86002,1331],"./sq-al/mtma-missed-notifications.js":[null],"./sq-al/nova.js":[null],"./sq-al/people-app.js":[null],"./sq-al/people-picker.js":[null],"./sq-al/people-targeting.js":[null],"./sq-al/people.js":[null],"./sq-al/phonelink-sms.js":[null],"./sq-al/pre-core.js":[null],"./sq-al/premium-benefits.js":[null],"./sq-al/recurrence.js":[null],"./sq-al/rsc-application-permissions.js":[null],"./sq-al/search.js":[null],"./sq-al/semantic-object.js":[null],"./sq-al/settings.js":[null],"./sq-al/share-in-meetings.js":[null],"./sq-al/share-to-teams-outlook-addin.js":[null],"./sq-al/share-to-teams-third-party.js":[null],"./sq-al/share-to-teams.js":[null],"./sq-al/shortcut.js":[null],"./sq-al/shortcuts.js":[null],"./sq-al/smart-device.js":[null],"./sq-al/survey.js":[null],"./sq-al/sv-flyout.js":[null],"./sq-al/teams-and-channels.js":[null],"./sq-al/tfl-onboarding.js":[null],"./sq-al/toast-notifications.js":[null],"./sq-al/unified-search.js":[null],"./sq-al/unsupported-browser.js":[null],"./sq-al/url-preview.js":[null],"./sq-al/video-capture.js":[null],"./sq-al/video-message.js":[null],"./sq-al/virtual-events.js":[null],"./sq-al/webinar.js":[40773,1331],"./sq-al/whats-new.js":[null],"./sq-al/wiki.js":[null],"./sr-latn-rs/activity.js":[null],"./sr-latn-rs/artifacts-platform.js":[null],"./sr-latn-rs/audience-view-dialog.js":[null],"./sr-latn-rs/auth.js":[null],"./sr-latn-rs/autosuggest.js":[null],"./sr-latn-rs/avatar.js":[null],"./sr-latn-rs/biometric-enrollment.js":[null],"./sr-latn-rs/breakout-rooms.js":[null],"./sr-latn-rs/broadcast.js":[null],"./sr-latn-rs/calendar.js":[null],"./sr-latn-rs/calling.js":[null],"./sr-latn-rs/campaign-notifications.js":[null],"./sr-latn-rs/carousel-multi-card.js":[null],"./sr-latn-rs/cast.js":[null],"./sr-latn-rs/channels.js":[null],"./sr-latn-rs/chat-list.js":[null],"./sr-latn-rs/coach-report.js":[null],"./sr-latn-rs/communities.js":[null],"./sr-latn-rs/compose.js":[4031,5285],"./sr-latn-rs/contacts.js":[null],"./sr-latn-rs/datepicker.js":[null],"./sr-latn-rs/desktop.js":[null],"./sr-latn-rs/digital-signage.js":[null],"./sr-latn-rs/discover-surface.js":[null],"./sr-latn-rs/edu.js":[null],"./sr-latn-rs/embed.js":[null],"./sr-latn-rs/errors.js":[null],"./sr-latn-rs/esp.js":[null],"./sr-latn-rs/extensibility-ptz-extension.js":[null],"./sr-latn-rs/extensibility-room-remote.js":[null],"./sr-latn-rs/extensibility.js":[null],"./sr-latn-rs/files.js":[null],"./sr-latn-rs/framework.js":[72242,5285],"./sr-latn-rs/freemium-upgrade.js":[null],"./sr-latn-rs/freemium.js":[null],"./sr-latn-rs/funstuff.js":[null],"./sr-latn-rs/gallery.js":[null],"./sr-latn-rs/growth.js":[null],"./sr-latn-rs/guardians.js":[null],"./sr-latn-rs/health.js":[null],"./sr-latn-rs/hololens.js":[null],"./sr-latn-rs/lightbox.js":[null],"./sr-latn-rs/live-persona-card.js":[null],"./sr-latn-rs/lms-integration.js":[null],"./sr-latn-rs/meet-for-work.js":[null],"./sr-latn-rs/meeting-analytics.js":[null],"./sr-latn-rs/meeting-apis-app.js":[null],"./sr-latn-rs/meeting-bot.js":[null],"./sr-latn-rs/meeting-flyout.js":[null],"./sr-latn-rs/meeting-meet-app.js":[null],"./sr-latn-rs/meeting-options.js":[null],"./sr-latn-rs/meeting-recap.js":[null],"./sr-latn-rs/meeting-room-console.js":[null],"./sr-latn-rs/meeting-stream-app.js":[null],"./sr-latn-rs/message-escalate-dialog.js":[null],"./sr-latn-rs/messaging.js":[22600,5285],"./sr-latn-rs/mtma-missed-notifications.js":[null],"./sr-latn-rs/nova.js":[null],"./sr-latn-rs/people-app.js":[null],"./sr-latn-rs/people-picker.js":[null],"./sr-latn-rs/people-targeting.js":[null],"./sr-latn-rs/people.js":[null],"./sr-latn-rs/phonelink-sms.js":[null],"./sr-latn-rs/pre-core.js":[null],"./sr-latn-rs/premium-benefits.js":[null],"./sr-latn-rs/recurrence.js":[null],"./sr-latn-rs/rsc-application-permissions.js":[null],"./sr-latn-rs/search.js":[null],"./sr-latn-rs/semantic-object.js":[null],"./sr-latn-rs/settings.js":[null],"./sr-latn-rs/share-in-meetings.js":[null],"./sr-latn-rs/share-to-teams-outlook-addin.js":[null],"./sr-latn-rs/share-to-teams-third-party.js":[null],"./sr-latn-rs/share-to-teams.js":[null],"./sr-latn-rs/shortcut.js":[null],"./sr-latn-rs/shortcuts.js":[null],"./sr-latn-rs/smart-device.js":[null],"./sr-latn-rs/survey.js":[null],"./sr-latn-rs/sv-flyout.js":[null],"./sr-latn-rs/teams-and-channels.js":[null],"./sr-latn-rs/tfl-onboarding.js":[null],"./sr-latn-rs/toast-notifications.js":[null],"./sr-latn-rs/unified-search.js":[null],"./sr-latn-rs/unsupported-browser.js":[null],"./sr-latn-rs/url-preview.js":[null],"./sr-latn-rs/video-capture.js":[null],"./sr-latn-rs/video-message.js":[null],"./sr-latn-rs/virtual-events.js":[null],"./sr-latn-rs/webinar.js":[45407,5285],"./sr-latn-rs/whats-new.js":[null],"./sr-latn-rs/wiki.js":[null],"./sv-se/activity.js":[null],"./sv-se/artifacts-platform.js":[null],"./sv-se/audience-view-dialog.js":[null],"./sv-se/auth.js":[null],"./sv-se/autosuggest.js":[null],"./sv-se/avatar.js":[null],"./sv-se/biometric-enrollment.js":[null],"./sv-se/breakout-rooms.js":[null],"./sv-se/broadcast.js":[null],"./sv-se/calendar.js":[null],"./sv-se/calling.js":[null],"./sv-se/campaign-notifications.js":[null],"./sv-se/carousel-multi-card.js":[null],"./sv-se/cast.js":[null],"./sv-se/channels.js":[null],"./sv-se/chat-list.js":[null],"./sv-se/coach-report.js":[null],"./sv-se/communities.js":[null],"./sv-se/compose.js":[5208,8681],"./sv-se/contacts.js":[null],"./sv-se/datepicker.js":[null],"./sv-se/desktop.js":[null],"./sv-se/digital-signage.js":[null],"./sv-se/discover-surface.js":[null],"./sv-se/edu.js":[null],"./sv-se/embed.js":[null],"./sv-se/errors.js":[null],"./sv-se/esp.js":[null],"./sv-se/extensibility-ptz-extension.js":[null],"./sv-se/extensibility-room-remote.js":[null],"./sv-se/extensibility.js":[null],"./sv-se/files.js":[null],"./sv-se/framework.js":[20102,8681],"./sv-se/freemium-upgrade.js":[null],"./sv-se/freemium.js":[null],"./sv-se/funstuff.js":[null],"./sv-se/gallery.js":[null],"./sv-se/growth.js":[null],"./sv-se/guardians.js":[null],"./sv-se/health.js":[null],"./sv-se/hololens.js":[null],"./sv-se/lightbox.js":[null],"./sv-se/live-persona-card.js":[null],"./sv-se/lms-integration.js":[null],"./sv-se/meet-for-work.js":[null],"./sv-se/meeting-analytics.js":[null],"./sv-se/meeting-apis-app.js":[null],"./sv-se/meeting-bot.js":[null],"./sv-se/meeting-flyout.js":[null],"./sv-se/meeting-meet-app.js":[null],"./sv-se/meeting-options.js":[null],"./sv-se/meeting-recap.js":[null],"./sv-se/meeting-room-console.js":[null],"./sv-se/meeting-stream-app.js":[null],"./sv-se/message-escalate-dialog.js":[null],"./sv-se/messaging.js":[89162,8681],"./sv-se/mtma-missed-notifications.js":[null],"./sv-se/nova.js":[null],"./sv-se/people-app.js":[null],"./sv-se/people-picker.js":[null],"./sv-se/people-targeting.js":[null],"./sv-se/people.js":[null],"./sv-se/phonelink-sms.js":[null],"./sv-se/pre-core.js":[null],"./sv-se/premium-benefits.js":[null],"./sv-se/recurrence.js":[null],"./sv-se/rsc-application-permissions.js":[null],"./sv-se/search.js":[null],"./sv-se/semantic-object.js":[null],"./sv-se/settings.js":[null],"./sv-se/share-in-meetings.js":[null],"./sv-se/share-to-teams-outlook-addin.js":[null],"./sv-se/share-to-teams-third-party.js":[null],"./sv-se/share-to-teams.js":[null],"./sv-se/shortcut.js":[null],"./sv-se/shortcuts.js":[null],"./sv-se/smart-device.js":[null],"./sv-se/survey.js":[null],"./sv-se/sv-flyout.js":[null],"./sv-se/teams-and-channels.js":[null],"./sv-se/tfl-onboarding.js":[null],"./sv-se/toast-notifications.js":[null],"./sv-se/unified-search.js":[null],"./sv-se/unsupported-browser.js":[null],"./sv-se/url-preview.js":[null],"./sv-se/video-capture.js":[null],"./sv-se/video-message.js":[null],"./sv-se/virtual-events.js":[null],"./sv-se/webinar.js":[86673,8681],"./sv-se/whats-new.js":[null],"./sv-se/wiki.js":[null],"./th-th/activity.js":[null],"./th-th/artifacts-platform.js":[null],"./th-th/audience-view-dialog.js":[null],"./th-th/auth.js":[null],"./th-th/autosuggest.js":[null],"./th-th/avatar.js":[null],"./th-th/biometric-enrollment.js":[null],"./th-th/breakout-rooms.js":[null],"./th-th/broadcast.js":[null],"./th-th/calendar.js":[null],"./th-th/calling.js":[null],"./th-th/campaign-notifications.js":[null],"./th-th/carousel-multi-card.js":[null],"./th-th/cast.js":[null],"./th-th/channels.js":[null],"./th-th/chat-list.js":[null],"./th-th/coach-report.js":[null],"./th-th/communities.js":[null],"./th-th/compose.js":[83654,6240],"./th-th/contacts.js":[null],"./th-th/datepicker.js":[null],"./th-th/desktop.js":[null],"./th-th/digital-signage.js":[null],"./th-th/discover-surface.js":[null],"./th-th/edu.js":[null],"./th-th/embed.js":[null],"./th-th/errors.js":[null],"./th-th/esp.js":[null],"./th-th/extensibility-ptz-extension.js":[null],"./th-th/extensibility-room-remote.js":[null],"./th-th/extensibility.js":[null],"./th-th/files.js":[null],"./th-th/framework.js":[23631,6240],"./th-th/freemium-upgrade.js":[null],"./th-th/freemium.js":[null],"./th-th/funstuff.js":[null],"./th-th/gallery.js":[null],"./th-th/growth.js":[null],"./th-th/guardians.js":[null],"./th-th/health.js":[null],"./th-th/hololens.js":[null],"./th-th/lightbox.js":[null],"./th-th/live-persona-card.js":[null],"./th-th/lms-integration.js":[null],"./th-th/meet-for-work.js":[null],"./th-th/meeting-analytics.js":[null],"./th-th/meeting-apis-app.js":[null],"./th-th/meeting-bot.js":[null],"./th-th/meeting-flyout.js":[null],"./th-th/meeting-meet-app.js":[null],"./th-th/meeting-options.js":[null],"./th-th/meeting-recap.js":[null],"./th-th/meeting-room-console.js":[null],"./th-th/meeting-stream-app.js":[null],"./th-th/message-escalate-dialog.js":[null],"./th-th/messaging.js":[39743,6240],"./th-th/mtma-missed-notifications.js":[null],"./th-th/nova.js":[null],"./th-th/people-app.js":[null],"./th-th/people-picker.js":[null],"./th-th/people-targeting.js":[null],"./th-th/people.js":[null],"./th-th/phonelink-sms.js":[null],"./th-th/pre-core.js":[null],"./th-th/premium-benefits.js":[null],"./th-th/recurrence.js":[null],"./th-th/rsc-application-permissions.js":[null],"./th-th/search.js":[null],"./th-th/semantic-object.js":[null],"./th-th/settings.js":[null],"./th-th/share-in-meetings.js":[null],"./th-th/share-to-teams-outlook-addin.js":[null],"./th-th/share-to-teams-third-party.js":[null],"./th-th/share-to-teams.js":[null],"./th-th/shortcut.js":[null],"./th-th/shortcuts.js":[null],"./th-th/smart-device.js":[null],"./th-th/survey.js":[null],"./th-th/sv-flyout.js":[null],"./th-th/teams-and-channels.js":[null],"./th-th/tfl-onboarding.js":[null],"./th-th/toast-notifications.js":[null],"./th-th/unified-search.js":[null],"./th-th/unsupported-browser.js":[null],"./th-th/url-preview.js":[null],"./th-th/video-capture.js":[null],"./th-th/video-message.js":[null],"./th-th/virtual-events.js":[null],"./th-th/webinar.js":[61e3,6240],"./th-th/whats-new.js":[null],"./th-th/wiki.js":[null],"./tr-tr/activity.js":[null],"./tr-tr/artifacts-platform.js":[null],"./tr-tr/audience-view-dialog.js":[null],"./tr-tr/auth.js":[null],"./tr-tr/autosuggest.js":[null],"./tr-tr/avatar.js":[null],"./tr-tr/biometric-enrollment.js":[null],"./tr-tr/breakout-rooms.js":[null],"./tr-tr/broadcast.js":[null],"./tr-tr/calendar.js":[null],"./tr-tr/calling.js":[null],"./tr-tr/campaign-notifications.js":[null],"./tr-tr/carousel-multi-card.js":[null],"./tr-tr/cast.js":[null],"./tr-tr/channels.js":[null],"./tr-tr/chat-list.js":[null],"./tr-tr/coach-report.js":[null],"./tr-tr/communities.js":[null],"./tr-tr/compose.js":[7535,2574],"./tr-tr/contacts.js":[null],"./tr-tr/datepicker.js":[null],"./tr-tr/desktop.js":[null],"./tr-tr/digital-signage.js":[null],"./tr-tr/discover-surface.js":[null],"./tr-tr/edu.js":[null],"./tr-tr/embed.js":[null],"./tr-tr/errors.js":[null],"./tr-tr/esp.js":[null],"./tr-tr/extensibility-ptz-extension.js":[null],"./tr-tr/extensibility-room-remote.js":[null],"./tr-tr/extensibility.js":[null],"./tr-tr/files.js":[null],"./tr-tr/framework.js":[52269,2574],"./tr-tr/freemium-upgrade.js":[null],"./tr-tr/freemium.js":[null],"./tr-tr/funstuff.js":[null],"./tr-tr/gallery.js":[null],"./tr-tr/growth.js":[null],"./tr-tr/guardians.js":[null],"./tr-tr/health.js":[null],"./tr-tr/hololens.js":[null],"./tr-tr/lightbox.js":[null],"./tr-tr/live-persona-card.js":[null],"./tr-tr/lms-integration.js":[null],"./tr-tr/meet-for-work.js":[null],"./tr-tr/meeting-analytics.js":[null],"./tr-tr/meeting-apis-app.js":[null],"./tr-tr/meeting-bot.js":[null],"./tr-tr/meeting-flyout.js":[null],"./tr-tr/meeting-meet-app.js":[null],"./tr-tr/meeting-options.js":[null],"./tr-tr/meeting-recap.js":[null],"./tr-tr/meeting-room-console.js":[null],"./tr-tr/meeting-stream-app.js":[null],"./tr-tr/message-escalate-dialog.js":[null],"./tr-tr/messaging.js":[38294,2574],"./tr-tr/mtma-missed-notifications.js":[null],"./tr-tr/nova.js":[null],"./tr-tr/people-app.js":[null],"./tr-tr/people-picker.js":[null],"./tr-tr/people-targeting.js":[null],"./tr-tr/people.js":[null],"./tr-tr/phonelink-sms.js":[null],"./tr-tr/pre-core.js":[null],"./tr-tr/premium-benefits.js":[null],"./tr-tr/recurrence.js":[null],"./tr-tr/rsc-application-permissions.js":[null],"./tr-tr/search.js":[null],"./tr-tr/semantic-object.js":[null],"./tr-tr/settings.js":[null],"./tr-tr/share-in-meetings.js":[null],"./tr-tr/share-to-teams-outlook-addin.js":[null],"./tr-tr/share-to-teams-third-party.js":[null],"./tr-tr/share-to-teams.js":[null],"./tr-tr/shortcut.js":[null],"./tr-tr/shortcuts.js":[null],"./tr-tr/smart-device.js":[null],"./tr-tr/survey.js":[null],"./tr-tr/sv-flyout.js":[null],"./tr-tr/teams-and-channels.js":[null],"./tr-tr/tfl-onboarding.js":[null],"./tr-tr/toast-notifications.js":[null],"./tr-tr/unified-search.js":[null],"./tr-tr/unsupported-browser.js":[null],"./tr-tr/url-preview.js":[null],"./tr-tr/video-capture.js":[null],"./tr-tr/video-message.js":[null],"./tr-tr/virtual-events.js":[null],"./tr-tr/webinar.js":[16198,2574],"./tr-tr/whats-new.js":[null],"./tr-tr/wiki.js":[null],"./uk-ua/activity.js":[null],"./uk-ua/artifacts-platform.js":[null],"./uk-ua/audience-view-dialog.js":[null],"./uk-ua/auth.js":[null],"./uk-ua/autosuggest.js":[null],"./uk-ua/avatar.js":[null],"./uk-ua/biometric-enrollment.js":[null],"./uk-ua/breakout-rooms.js":[null],"./uk-ua/broadcast.js":[null],"./uk-ua/calendar.js":[null],"./uk-ua/calling.js":[null],"./uk-ua/campaign-notifications.js":[null],"./uk-ua/carousel-multi-card.js":[null],"./uk-ua/cast.js":[null],"./uk-ua/channels.js":[null],"./uk-ua/chat-list.js":[null],"./uk-ua/coach-report.js":[null],"./uk-ua/communities.js":[null],"./uk-ua/compose.js":[65639,4618],"./uk-ua/contacts.js":[null],"./uk-ua/datepicker.js":[null],"./uk-ua/desktop.js":[null],"./uk-ua/digital-signage.js":[null],"./uk-ua/discover-surface.js":[null],"./uk-ua/edu.js":[null],"./uk-ua/embed.js":[null],"./uk-ua/errors.js":[null],"./uk-ua/esp.js":[null],"./uk-ua/extensibility-ptz-extension.js":[null],"./uk-ua/extensibility-room-remote.js":[null],"./uk-ua/extensibility.js":[null],"./uk-ua/files.js":[null],"./uk-ua/framework.js":[13932,4618],"./uk-ua/freemium-upgrade.js":[null],"./uk-ua/freemium.js":[null],"./uk-ua/funstuff.js":[null],"./uk-ua/gallery.js":[null],"./uk-ua/growth.js":[null],"./uk-ua/guardians.js":[null],"./uk-ua/health.js":[null],"./uk-ua/hololens.js":[null],"./uk-ua/lightbox.js":[null],"./uk-ua/live-persona-card.js":[null],"./uk-ua/lms-integration.js":[null],"./uk-ua/meet-for-work.js":[null],"./uk-ua/meeting-analytics.js":[null],"./uk-ua/meeting-apis-app.js":[null],"./uk-ua/meeting-bot.js":[null],"./uk-ua/meeting-flyout.js":[null],"./uk-ua/meeting-meet-app.js":[null],"./uk-ua/meeting-options.js":[null],"./uk-ua/meeting-recap.js":[null],"./uk-ua/meeting-room-console.js":[null],"./uk-ua/meeting-stream-app.js":[null],"./uk-ua/message-escalate-dialog.js":[null],"./uk-ua/messaging.js":[51010,4618],"./uk-ua/mtma-missed-notifications.js":[null],"./uk-ua/nova.js":[null],"./uk-ua/people-app.js":[null],"./uk-ua/people-picker.js":[null],"./uk-ua/people-targeting.js":[null],"./uk-ua/people.js":[null],"./uk-ua/phonelink-sms.js":[null],"./uk-ua/pre-core.js":[null],"./uk-ua/premium-benefits.js":[null],"./uk-ua/recurrence.js":[null],"./uk-ua/rsc-application-permissions.js":[null],"./uk-ua/search.js":[null],"./uk-ua/semantic-object.js":[null],"./uk-ua/settings.js":[null],"./uk-ua/share-in-meetings.js":[null],"./uk-ua/share-to-teams-outlook-addin.js":[null],"./uk-ua/share-to-teams-third-party.js":[null],"./uk-ua/share-to-teams.js":[null],"./uk-ua/shortcut.js":[null],"./uk-ua/shortcuts.js":[null],"./uk-ua/smart-device.js":[null],"./uk-ua/survey.js":[null],"./uk-ua/sv-flyout.js":[null],"./uk-ua/teams-and-channels.js":[null],"./uk-ua/tfl-onboarding.js":[null],"./uk-ua/toast-notifications.js":[null],"./uk-ua/unified-search.js":[null],"./uk-ua/unsupported-browser.js":[null],"./uk-ua/url-preview.js":[null],"./uk-ua/video-capture.js":[null],"./uk-ua/video-message.js":[null],"./uk-ua/virtual-events.js":[null],"./uk-ua/webinar.js":[99832,4618],"./uk-ua/whats-new.js":[null],"./uk-ua/wiki.js":[null],"./vi-vn/activity.js":[null],"./vi-vn/artifacts-platform.js":[null],"./vi-vn/audience-view-dialog.js":[null],"./vi-vn/auth.js":[null],"./vi-vn/autosuggest.js":[null],"./vi-vn/avatar.js":[null],"./vi-vn/biometric-enrollment.js":[null],"./vi-vn/breakout-rooms.js":[null],"./vi-vn/broadcast.js":[null],"./vi-vn/calendar.js":[null],"./vi-vn/calling.js":[null],"./vi-vn/campaign-notifications.js":[null],"./vi-vn/carousel-multi-card.js":[null],"./vi-vn/cast.js":[null],"./vi-vn/channels.js":[null],"./vi-vn/chat-list.js":[null],"./vi-vn/coach-report.js":[null],"./vi-vn/communities.js":[null],"./vi-vn/compose.js":[53838,9545],"./vi-vn/contacts.js":[null],"./vi-vn/datepicker.js":[null],"./vi-vn/desktop.js":[null],"./vi-vn/digital-signage.js":[null],"./vi-vn/discover-surface.js":[null],"./vi-vn/edu.js":[null],"./vi-vn/embed.js":[null],"./vi-vn/errors.js":[null],"./vi-vn/esp.js":[null],"./vi-vn/extensibility-ptz-extension.js":[null],"./vi-vn/extensibility-room-remote.js":[null],"./vi-vn/extensibility.js":[null],"./vi-vn/files.js":[null],"./vi-vn/framework.js":[50930,9545],"./vi-vn/freemium-upgrade.js":[null],"./vi-vn/freemium.js":[null],"./vi-vn/funstuff.js":[null],"./vi-vn/gallery.js":[null],"./vi-vn/growth.js":[null],"./vi-vn/guardians.js":[null],"./vi-vn/health.js":[null],"./vi-vn/hololens.js":[null],"./vi-vn/lightbox.js":[null],"./vi-vn/live-persona-card.js":[null],"./vi-vn/lms-integration.js":[null],"./vi-vn/meet-for-work.js":[null],"./vi-vn/meeting-analytics.js":[null],"./vi-vn/meeting-apis-app.js":[null],"./vi-vn/meeting-bot.js":[null],"./vi-vn/meeting-flyout.js":[null],"./vi-vn/meeting-meet-app.js":[null],"./vi-vn/meeting-options.js":[null],"./vi-vn/meeting-recap.js":[null],"./vi-vn/meeting-room-console.js":[null],"./vi-vn/meeting-stream-app.js":[null],"./vi-vn/message-escalate-dialog.js":[null],"./vi-vn/messaging.js":[43458,9545],"./vi-vn/mtma-missed-notifications.js":[null],"./vi-vn/nova.js":[null],"./vi-vn/people-app.js":[null],"./vi-vn/people-picker.js":[null],"./vi-vn/people-targeting.js":[null],"./vi-vn/people.js":[null],"./vi-vn/phonelink-sms.js":[null],"./vi-vn/pre-core.js":[null],"./vi-vn/premium-benefits.js":[null],"./vi-vn/recurrence.js":[null],"./vi-vn/rsc-application-permissions.js":[null],"./vi-vn/search.js":[null],"./vi-vn/semantic-object.js":[null],"./vi-vn/settings.js":[null],"./vi-vn/share-in-meetings.js":[null],"./vi-vn/share-to-teams-outlook-addin.js":[null],"./vi-vn/share-to-teams-third-party.js":[null],"./vi-vn/share-to-teams.js":[null],"./vi-vn/shortcut.js":[null],"./vi-vn/shortcuts.js":[null],"./vi-vn/smart-device.js":[null],"./vi-vn/survey.js":[null],"./vi-vn/sv-flyout.js":[null],"./vi-vn/teams-and-channels.js":[null],"./vi-vn/tfl-onboarding.js":[null],"./vi-vn/toast-notifications.js":[null],"./vi-vn/unified-search.js":[null],"./vi-vn/unsupported-browser.js":[null],"./vi-vn/url-preview.js":[null],"./vi-vn/video-capture.js":[null],"./vi-vn/video-message.js":[null],"./vi-vn/virtual-events.js":[null],"./vi-vn/webinar.js":[90513,9545],"./vi-vn/whats-new.js":[null],"./vi-vn/wiki.js":[null],"./zh-cn/activity.js":[null],"./zh-cn/artifacts-platform.js":[null],"./zh-cn/audience-view-dialog.js":[null],"./zh-cn/auth.js":[null],"./zh-cn/autosuggest.js":[null],"./zh-cn/avatar.js":[null],"./zh-cn/biometric-enrollment.js":[null],"./zh-cn/breakout-rooms.js":[null],"./zh-cn/broadcast.js":[null],"./zh-cn/calendar.js":[null],"./zh-cn/calling.js":[null],"./zh-cn/campaign-notifications.js":[null],"./zh-cn/carousel-multi-card.js":[null],"./zh-cn/cast.js":[null],"./zh-cn/channels.js":[null],"./zh-cn/chat-list.js":[null],"./zh-cn/coach-report.js":[null],"./zh-cn/communities.js":[null],"./zh-cn/compose.js":[42487,2742],"./zh-cn/contacts.js":[null],"./zh-cn/datepicker.js":[null],"./zh-cn/desktop.js":[null],"./zh-cn/digital-signage.js":[null],"./zh-cn/discover-surface.js":[null],"./zh-cn/edu.js":[null],"./zh-cn/embed.js":[null],"./zh-cn/errors.js":[null],"./zh-cn/esp.js":[null],"./zh-cn/extensibility-ptz-extension.js":[null],"./zh-cn/extensibility-room-remote.js":[null],"./zh-cn/extensibility.js":[null],"./zh-cn/files.js":[null],"./zh-cn/framework.js":[95029,2742],"./zh-cn/freemium-upgrade.js":[null],"./zh-cn/freemium.js":[null],"./zh-cn/funstuff.js":[null],"./zh-cn/gallery.js":[null],"./zh-cn/growth.js":[null],"./zh-cn/guardians.js":[null],"./zh-cn/health.js":[null],"./zh-cn/hololens.js":[null],"./zh-cn/lightbox.js":[null],"./zh-cn/live-persona-card.js":[null],"./zh-cn/lms-integration.js":[null],"./zh-cn/meet-for-work.js":[null],"./zh-cn/meeting-analytics.js":[null],"./zh-cn/meeting-apis-app.js":[null],"./zh-cn/meeting-bot.js":[null],"./zh-cn/meeting-flyout.js":[null],"./zh-cn/meeting-meet-app.js":[null],"./zh-cn/meeting-options.js":[null],"./zh-cn/meeting-recap.js":[null],"./zh-cn/meeting-room-console.js":[null],"./zh-cn/meeting-stream-app.js":[null],"./zh-cn/message-escalate-dialog.js":[null],"./zh-cn/messaging.js":[93396,2742],"./zh-cn/mtma-missed-notifications.js":[null],"./zh-cn/nova.js":[null],"./zh-cn/people-app.js":[null],"./zh-cn/people-picker.js":[null],"./zh-cn/people-targeting.js":[null],"./zh-cn/people.js":[null],"./zh-cn/phonelink-sms.js":[null],"./zh-cn/pre-core.js":[null],"./zh-cn/premium-benefits.js":[null],"./zh-cn/recurrence.js":[null],"./zh-cn/rsc-application-permissions.js":[null],"./zh-cn/search.js":[null],"./zh-cn/semantic-object.js":[null],"./zh-cn/settings.js":[null],"./zh-cn/share-in-meetings.js":[null],"./zh-cn/share-to-teams-outlook-addin.js":[null],"./zh-cn/share-to-teams-third-party.js":[null],"./zh-cn/share-to-teams.js":[null],"./zh-cn/shortcut.js":[null],"./zh-cn/shortcuts.js":[null],"./zh-cn/smart-device.js":[null],"./zh-cn/survey.js":[null],"./zh-cn/sv-flyout.js":[null],"./zh-cn/teams-and-channels.js":[null],"./zh-cn/tfl-onboarding.js":[null],"./zh-cn/toast-notifications.js":[null],"./zh-cn/unified-search.js":[null],"./zh-cn/unsupported-browser.js":[null],"./zh-cn/url-preview.js":[null],"./zh-cn/video-capture.js":[null],"./zh-cn/video-message.js":[null],"./zh-cn/virtual-events.js":[null],"./zh-cn/webinar.js":[17122,2742],"./zh-cn/whats-new.js":[null],"./zh-cn/wiki.js":[null],"./zh-tw/activity.js":[null],"./zh-tw/artifacts-platform.js":[null],"./zh-tw/audience-view-dialog.js":[null],"./zh-tw/auth.js":[null],"./zh-tw/autosuggest.js":[null],"./zh-tw/avatar.js":[null],"./zh-tw/biometric-enrollment.js":[null],"./zh-tw/breakout-rooms.js":[null],"./zh-tw/broadcast.js":[null],"./zh-tw/calendar.js":[null],"./zh-tw/calling.js":[null],"./zh-tw/campaign-notifications.js":[null],"./zh-tw/carousel-multi-card.js":[null],"./zh-tw/cast.js":[null],"./zh-tw/channels.js":[null],"./zh-tw/chat-list.js":[null],"./zh-tw/coach-report.js":[null],"./zh-tw/communities.js":[null],"./zh-tw/compose.js":[50178,5921],"./zh-tw/contacts.js":[null],"./zh-tw/datepicker.js":[null],"./zh-tw/desktop.js":[null],"./zh-tw/digital-signage.js":[null],"./zh-tw/discover-surface.js":[null],"./zh-tw/edu.js":[null],"./zh-tw/embed.js":[null],"./zh-tw/errors.js":[null],"./zh-tw/esp.js":[null],"./zh-tw/extensibility-ptz-extension.js":[null],"./zh-tw/extensibility-room-remote.js":[null],"./zh-tw/extensibility.js":[null],"./zh-tw/files.js":[null],"./zh-tw/framework.js":[13717,5921],"./zh-tw/freemium-upgrade.js":[null],"./zh-tw/freemium.js":[null],"./zh-tw/funstuff.js":[null],"./zh-tw/gallery.js":[null],"./zh-tw/growth.js":[null],"./zh-tw/guardians.js":[null],"./zh-tw/health.js":[null],"./zh-tw/hololens.js":[null],"./zh-tw/lightbox.js":[null],"./zh-tw/live-persona-card.js":[null],"./zh-tw/lms-integration.js":[null],"./zh-tw/meet-for-work.js":[null],"./zh-tw/meeting-analytics.js":[null],"./zh-tw/meeting-apis-app.js":[null],"./zh-tw/meeting-bot.js":[null],"./zh-tw/meeting-flyout.js":[null],"./zh-tw/meeting-meet-app.js":[null],"./zh-tw/meeting-options.js":[null],"./zh-tw/meeting-recap.js":[null],"./zh-tw/meeting-room-console.js":[null],"./zh-tw/meeting-stream-app.js":[null],"./zh-tw/message-escalate-dialog.js":[null],"./zh-tw/messaging.js":[76764,5921],"./zh-tw/mtma-missed-notifications.js":[null],"./zh-tw/nova.js":[null],"./zh-tw/people-app.js":[null],"./zh-tw/people-picker.js":[null],"./zh-tw/people-targeting.js":[null],"./zh-tw/people.js":[null],"./zh-tw/phonelink-sms.js":[null],"./zh-tw/pre-core.js":[null],"./zh-tw/premium-benefits.js":[null],"./zh-tw/recurrence.js":[null],"./zh-tw/rsc-application-permissions.js":[null],"./zh-tw/search.js":[null],"./zh-tw/semantic-object.js":[null],"./zh-tw/settings.js":[null],"./zh-tw/share-in-meetings.js":[null],"./zh-tw/share-to-teams-outlook-addin.js":[null],"./zh-tw/share-to-teams-third-party.js":[null],"./zh-tw/share-to-teams.js":[null],"./zh-tw/shortcut.js":[null],"./zh-tw/shortcuts.js":[null],"./zh-tw/smart-device.js":[null],"./zh-tw/survey.js":[null],"./zh-tw/sv-flyout.js":[null],"./zh-tw/teams-and-channels.js":[null],"./zh-tw/tfl-onboarding.js":[null],"./zh-tw/toast-notifications.js":[null],"./zh-tw/unified-search.js":[null],"./zh-tw/unsupported-browser.js":[null],"./zh-tw/url-preview.js":[null],"./zh-tw/video-capture.js":[null],"./zh-tw/video-message.js":[null],"./zh-tw/virtual-events.js":[null],"./zh-tw/webinar.js":[54344,5921],"./zh-tw/whats-new.js":[null],"./zh-tw/wiki.js":[null]};function a(e){if(!n.o(i,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],a=t[0];return Promise.all(t.slice(1).map(n.e)).then((()=>n(a)))}a.keys=()=>Object.keys(i),a.id=22057,e.exports=a},32668:()=>{},17774:()=>{},59455:e=>{"use strict";e.exports=JSON.parse('{"clientId":"5e3ce6c0-2b1f-4285-8d4b-75ee78787346","fallbackLocale":"en-us","basePath":"registration","experienceName":"webinar-registration","build":{"ckeditor":true},"loggingConstants":{"appTokens":{"test":"0b15014f683e4999989a5e66bc942700-51caff43-39b8-4cc9-a7d5-fcbf318ce0c2-6867"},"silent":false,"telemetryserver":"https://teams.events.data.microsoft.com/Collector/3.0/"},"webAuth":{"cacheLocation":"localStorage","navigateToLoginRequestUrl":true,"top":{"popUp":false},"iframe":{"redirectPath":"auth"}},"anon":[{"anonUrlMatch":"/registration/"}],"enableDevTools":true,"shouldExecuteDefaultCommand":true,"preloadedI18nNamespaces":["webinar","compose","framework","messaging"],"partitionCacheByExperience":true}')}}]);