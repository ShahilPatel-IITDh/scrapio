"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["storefront.action.v1.build"],{"./ally-core/clientlibs/core/v2/src/js/modal/constants.js":(e,t,n)=>{n.d(t,{BT:()=>a,C7:()=>r,FP:()=>d,Fh:()=>c,On:()=>i,TG:()=>o,Xc:()=>s,al:()=>l,ot:()=>p});const s="allysf",i="-hide",o="-in",a="allysf-modal-layer",c="allysf-modal-wrap",r="modalLayer",l={history:[],isModalOpen:!1},d={CLOSE:"modal.close",CLOSED:"modal.closed",INITIALIZED:"modal.initialized",OPEN:"modal.open",OPENED:"modal.opened"},p=/googlebot|bingbot/gi},"./ally-core/components/content/action/v1/action/clientlibs/src/js/component.js":(e,t,n)=>{n.d(t,{a:()=>m});var s=n("../../../../../node_modules/@allysf/logger/dist/logger.build.js"),i=n("./ally-core/clientlibs/utils/js/component/index.js"),o=n("./ally-core/clientlibs/core/v2/src/js/modal/constants.js"),a=n("./ally-core/clientlibs/ui/tooltip/index.js"),c=n("./ally-core/components/content/action/v1/action/clientlibs/src/js/config/constants.js"),r=n("./ally-core/clientlibs/utils/js/component/get-env.js");function l(e){const{cookieName:t,cookieValue:n,cookieExpiry:s}=e.target.parentElement.dataset;t&&((e,t,n)=>{const s={[r.O_]:"localhost",[r.Gw]:"aem-dev.ally.com",[r.xD]:"staging.ally.com",[r.QN]:"www.ally.com"}[(0,r.dU)()]||"www.ally.com",i=new Date(Date.now()+n);document.cookie=`${e}=${t};expires=${i};domain=${s};path=/`})(t,n,parseInt(s,10))}var d=n("./ally-core/components/content/action/v1/action/clientlibs/src/js/utils/handler.js"),p=n("./ally-core/clientlibs/services/bank/rate.js");function h(e){this.termID&&this.termID!==e.termId||function(e,t){if(t.product){const n=`${(0,p.t)(t.product)}${t.term?`-${t.term}`:""}`,[s,i]=e.href.split("?"),o=new URLSearchParams(i);o.set("OAP",n),e.setAttribute("href",`${s}?${o.toString()}`)}}(this.anchor,e)}let u=null;class m extends i.wA{constructor(e){super(e,c.lP,c.Ke),[this.anchor]=this.el.getElementsByClassName(`allysf-${this.name.toLowerCase()}-${this.version}-anchor`);const t=this.el.dataset.trackingType;if(this.trackingType=t?this.el.dataset.trackingType:c.jg.DAO,this.actions={},this.anchor)this.init();else{const e=`${c.g0} Anchor element (.allysf-${this.name.toLowerCase()}-${this.version}-anchor) does not exist`;(0,s.LOGROCKET)(e,this.lrTags)}}initLink(){this.anchor.href=(0,d.DO)(this.anchor,this.trackingType),this.termID=this.anchor.dataset.termId,this.trackingType===c.jg.DAO&&window.ALLYSF("subscribe","term.change",{callback:h.bind(this)})}initInterstitial(){this.anchor.href=(0,d.DO)(this.anchor,this.trackingType),this.anchor.addEventListener("click",d._Y),window.ALLYSF("subscribe",o.FP.OPENED,{callback:e=>d.IF.apply(this,[e])})}initInterstitialContinue(){this.anchor.addEventListener("click",d.VE)}initTooltip(){(0,a.LF)(),this.anchor.setAttribute("aria-describedby",a.Nh.DESCRIBEDBY),this.anchor.addEventListener("click",(e=>{e.preventDefault(),clearTimeout(u);const t=(0,a.ZO)();t&&t.classList.contains(a.Nh.SHOW)?(0,a.i8)():(0,a.hJ)(e)})),this.anchor.addEventListener("mouseenter",(e=>{clearTimeout(u),u=setTimeout((()=>{(0,a.hJ)(e)}),c.Ve)})),this.anchor.addEventListener("mouseleave",(()=>{clearTimeout(u),u=setTimeout((()=>{(0,a.i8)()}),c.ds)}))}init(){this.el.dataset.cookieName&&this.anchor.addEventListener("click",l);const{actionType:e}=this.anchor.dataset;this.actions={...this.actions,[c.aI.LINK]:this.initLink,[c.aI.INTERSTITIAL]:this.initInterstitial,[c.aI.INTERSTITIAL_CONTINUE]:this.initInterstitialContinue,[c.aI.TOOL_TIP]:this.initTooltip,[c.aI.MODAL]:()=>this.anchor.addEventListener("click",d._Y),[c.aI.PAGE_SCROLL]:()=>this.anchor.addEventListener("click",d.fP)},this.actions[e]&&this.actions[e].bind(this)()}}},"./ally-core/components/content/action/v1/action/clientlibs/src/js/config/constants.js":(e,t,n)=>{n.d(t,{A$:()=>c,J9:()=>s,KY:()=>u,Ke:()=>o,Ve:()=>h,_i:()=>r,aI:()=>l,ds:()=>p,g0:()=>a,jg:()=>d,lP:()=>i});const s="Content",i="Action",o="v1",a=`ALLYSF ${s}/${i}:`,c="staticParams",r={ANCHOR:"allysf-action-v1-anchor"},l={INTERSTITIAL:"interstitial",INTERSTITIAL_CONTINUE:"interstitialContinue",LINK:"link",MODAL:"modal",PAGE_SCROLL:"pagescroll",TOOL_TIP:"tooltip"},d={NONE:"none",DAO:"dao",LADDER_LIFE:"ladderLife",AUTO_INSURANCE:"autoInsurance",ALLY_AUTO_DIRECT:"allyAutoDirect",DIRECT_ALLY:"directAlly",NON_ALLY:"nonAlly"},p=1e3,h=250,u={[d.DAO]:{OAP:"OAP",CP:"CP",source:"source",cjevent:"cjevent",campaigned:"campaigned",mbsy:"mbsy",mbsy_source:"mbsy_source"},[d.LADDER_LIFE]:{[c]:{lddr_source:"ally"},CP:"lddr_name",mid:"external_id"},[d.AUTO_INSURANCE]:{CP:"CP",mid:"mid"},[d.ALLY_AUTO_DIRECT]:{[c]:{partnerId:"10321",productName:"Refinance"},pid:"partnerId",pcid:"partnerClientId",accountNumber:"accountNumber"},[d.DIRECT_ALLY]:{[c]:{partnerId:"9042",productName:"LeaseBuyout"},pcid:"partnerClientId",accountNumber:"accountNumber"},[d.NON_ALLY]:{[c]:{partnerId:"10321",productName:"LeaseBuyout"},pid:"partnerId",pcid:"partnerClientId",accountNumber:"accountNumber"}}},"./ally-core/components/content/action/v1/action/clientlibs/src/js/utils/handler.js":(e,t,n)=>{n.d(t,{DO:()=>r,IF:()=>h,VE:()=>l,_Y:()=>d,fP:()=>p});var s=n("./ally-core/clientlibs/utils/js/component/get-ref.js"),i=n("./ally-core/clientlibs/core/v2/src/js/modal/constants.js"),o=n("./ally-core/clientlibs/utils/js/dom/closest-ancestor.js"),a=n("./ally-core/clientlibs/ui/js/window/index.js"),c=n("./ally-core/components/content/action/v1/action/clientlibs/src/js/config/constants.js");function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.jg.DAO;if("object"!=typeof e||!e.href||""===e.href)return"";if(t===c.jg.NONE)return e.href;const[n,s]=e.href.split("?"),i=new URLSearchParams(s);Object.keys(c.KY[t]).forEach((e=>{if(e===c.A$){const n=c.KY[t][e];Object.keys(n).forEach((e=>{i.set(e,n[e])}))}else{const n=sessionStorage.getItem(e);n&&i.set(c.KY[t][e],n)}}));const o=i.toString();return o.length?`${n}?${o}`:n}function l(e){window.ALLYSF("publish",i.FP.CLOSE,{triggerOverride:e.currentTarget})}function d(e){e.preventDefault();const t=(0,s.l)(e.currentTarget.dataset.fragmentUrl);(0,o.Y)(e.currentTarget,`[data-modal-ref="${t}"]`)?window.ALLYSF("publish",i.FP.CLOSE,{triggerOverride:e.currentTarget}):window.ALLYSF("publish",i.FP.OPEN,{modalTrigger:e.currentTarget})}function p(e){e.preventDefault();const{scrollTarget:t}=e.currentTarget.dataset;(0,a.Qj)(t)}function h(e){let{trigger:t,openElem:n={}}=e;if(this.anchor===t){const{dataset:e,href:s}=t;if("interstitial"===e.actionType){const e=n.querySelector(`[data-action-type="${c.aI.INTERSTITIAL_CONTINUE}"]`);e&&(e.href=s)}}}},"./ally-core/components/template/page/v1/page/clientlibs/src/js/constants.js":(e,t,n)=>{n.d(t,{HA:()=>s,Us:()=>a,eW:()=>i,tv:()=>o});const s="source",i="CP",o="Web-Contact-Us",a=[new RegExp("accountNumber",""),new RegExp("campaigned",""),new RegExp("cjevent",""),new RegExp("CP",""),new RegExp("mbsy_source",""),new RegExp("mbsy",""),new RegExp("mid",""),new RegExp("OAP",""),new RegExp("pcid",""),new RegExp("pd",""),new RegExp("pid",""),new RegExp("source",""),new RegExp("term","")]},"./storefront/components/content/action/v1/action/clientlibs/src/index.js":(e,t,n)=>{var s=n("./ally-core/clientlibs/utils/js/component/index.js");const i="Content",o="Action",a=`ALLYSF ${i}/${o}:`,c="better",r={BETTER_LEAD:`${o}.betterLead`},l={process:"ALLYSF",script:o,version:"v1"};var d=n("./ally-core/components/content/action/v1/action/clientlibs/src/js/component.js"),p=n("../../../../../node_modules/@allysf/logger/dist/logger.build.js"),h=n("./ally-core/components/template/page/v1/page/clientlibs/src/js/constants.js"),u=n("./ally-core/clientlibs/core/v2/src/js/modal/constants.js");const m={betterPurchase:"Purchase",betterRefinance:"Refinance"};class g extends d.a{init(){this.actions[c]=()=>{var e;(e=this.anchor).addEventListener("click",(t=>{let n;t.preventDefault(),(window.ALLYSF||{}).API&&window.ALLYSF.API.BETTER&&(n=`${window.ALLYSF.API.BETTER.domain}/acs/better/api/leads`);const s=sessionStorage.getItem(h.eW);fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tracking:{...s&&{CP:sessionStorage.getItem(h.eW)},source:sessionStorage.getItem(h.HA)||h.tv},sourceName:"ally",loanPurpose:m[e.dataset.betterType]||"Purchase"})}).then((e=>{if(!e.ok||200!==e.status)throw new Error(`${a} Better Service error`);return e.json()})).then((t=>{let{leadUuid:n,preapprovalUuid:s,preapprovalUrl:i=""}=t;if(window.ALLYSF("publish",r.BETTER_LEAD,{element:e,leadUuid:n,preapprovalUuid:s,preapprovalUrl:i}),i)return n&&sessionStorage.setItem("leadUuid",n),s&&sessionStorage.setItem("preapprovalUuid",s),i;throw new Error(`${a} Better Service no URL in response`)})).then((e=>(window.location.href=e,e))).catch((t=>{(0,p.LOGROCKET)(t,l),window.ALLYSF("publish",u.FP.OPEN,{modalTrigger:e})}))}))},super.init()}}(0,s.xp)({group:i,name:o,version:"v1",class:g})}},e=>{e.O(0,["allysf.build"],(()=>{return t="./storefront/components/content/action/v1/action/clientlibs/src/index.js",e(e.s=t);var t}));e.O()}]);