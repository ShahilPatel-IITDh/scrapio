PG.Stores.Project=PG.Stores.ClientServerValidates.extend(page.helpers.projectRoles).extend({idAttribute:"uid",urlRoot:page.routes.project,defaults:{created_at:new Date(2012,1,1),project_name:""},init:function(){this.validations={project_name:{project_name_falsy:"validatePresence",project_name_long:"validateNameLength"}},this.dontClearOnNavigate=!0,this.register(this.handleDispatch.bind(this)),PG.Stores.ClientServerValidates.prototype.init.call(this)},handleDispatch:function(e){e.source===page.constants.VIEW_SOURCE&&"project"===e.action.type&&this.isCurrentNewProject&&this.handleViewAction(e.action),e.source===page.constants.DATA_SOURCE&&"project"===e.action.type&&e.action.data.projectId===this.get("uid")&&this.set(e.action.data)},handleViewAction:function(e){"update"===e.concern?this.set({project_name:e.data.project_name},{validate:!0,validates:"partial"}):"create"===e.concern&&this.save(null,{error:this.handleServerError.bind(this),success:this.handleServerSuccess.bind(this),validates:"complete"})},handleServerSuccess:function(e,t){page.actions.locationShouldUpdate(String.expand(page.routes.firstUpload,{projectId:t.project_id})),page.actions.analyticsShouldUpdate("projectListCreateComplete",{project:t.project_id})},getFeaturesList:function(){var e=this.get("features")||[],t="NEW_DOCUMENTS";return e.push(page.constants.projectFeatures[t]),e},hasFeatureFlag:function(e){const t=this.getFeaturesList();return t.indexOf(e)>-1},validateNameLength:function(e){return!e.value||e.value.length<=140},isSlipinsEnabled:function(){var e=this.get("profile");return e&&e.options&&e.options.sheets_slip_ins},isWorkspace:function(){var e=this.get("project_type");return"workspace"===e}}),"undefined"!=typeof module&&(module.exports=PG.Stores.Project),PG.Stores.Projects=Backbone.Collection.extend({model:PG.Stores.Project,url:page.routes.projects,init:function(){this.dontClearOnNavigate=!0,this.register(this.handleDispatch.bind(this))},handleDispatch:function(e){e.source===page.constants.VIEW_SOURCE&&"project"===e.action.type?this.handleViewAction(e.action):e.source===page.constants.ROUTE_TYPE&&this.handleRouteAction(e.action)},handleViewAction:function(e){"deleteUser"===e.concern?this.rmUser(e.data):"delete"===e.concern&&this.get(e.data.projectId).destroy({success:function(){page.actions.locationShouldUpdate(page.routes.projects)}})},handleRouteAction:function(e){e.data.fetch.indexOf("projects")!==-1&&reqwest({method:"GET",url:page.routes.projectsAjax,success:this.successfulFetch.bind(this),type:"json",contentType:"application/json"})},rmUser:function(e){reqwest({method:"DELETE",url:String.expand(page.routes.usersProjects,{projectId:e.projId}),data:{user_id:e.userId},success:function(){page.dispatcher.dispatchDataAction({type:"user",concern:"read"}),this.handleServerSuccess(e)}.bind(this)})},handleServerSuccess:function(e){this.deletedProjects||(this.deletedProjects=[]);var t,r=e.projId;r&&(t=this.remove(r),this.deletedProjects.push(t)),this.emitChange()},getInvalidMembers:function(){return this.filter(function(e){return e.validationError})},comparator:function(e){return e.get("project_name").toLowerCase()},getCurrentProject:function(){if(page.stores.route&&page.stores.route.get("routeOptions")&&page.stores.route.get("routeOptions").data.currentProject)return this.get(page.stores.route.get("routeOptions").data.currentProject)},getSheetCount:function(){var e=0;return this.models.forEach(function(t){t.has("parent_project_uid")||(e+=parseInt(t.get("page_nb"),10))}),e},successfulFetch:function(e){var t=this.getCurrentProject();t&&(e=e.filter(function(e){return e.uid!==t.get("uid")}).concat([t.attributes])),this.reset(e),this.emitChange()}}),"undefined"!=typeof module&&(module.exports=PG.Stores.Projects),PG.Stores.Confirm=Backbone.Model.extend({defaults:{success:page.util.noop,error:page.util.noop},init:function(){this.register(function(e){e.source===page.constants.VIEW_SOURCE&&"confirm"===e.action.type&&this.handleConfirmAction(e.action)})},handleConfirmAction:function(e){"create"===e.concern&&(this.clear(),this.set(e.data),this.emitChange()),"destroy"===e.concern&&(this.clear(),this.emitChange())},getProps:function(){return{confirmHandler:this.get("success"),closeHandler:this.get("error"),cancelHandler:this.get("error"),showDarkBackground:this.get("showDarkBackground"),confirmText:this.get("confirmText"),confirmRole:this.get("confirmRole"),cancelText:this.get("cancelText"),title:this.get("title"),textContent:this.get("textContent"),hideCancelButton:this.get("hideCancelButton")}}}),PG.Stores.Prompt=Backbone.Model.extend({defaults:{success:page.util.noop,error:page.util.noop},init:function(){this.register(function(e){e.source===page.constants.VIEW_SOURCE&&"prompt"===e.action.type&&this.handleConfirmAction(e.action)})},handleConfirmAction:function(e){"create"===e.concern&&(this.clear(),this.set(e.data),this.emitChange()),"destroy"===e.concern&&(this.clear(),this.emitChange())},getProps:function(){return{confirmHandler:this.get("success"),closeHandler:this.get("error"),placeholderText:this.get("placeholderText"),confirmText:this.get("confirmText"),confirmRole:this.get("confirmRole"),cancelText:this.get("cancelText"),title:this.get("title"),textContent:this.get("textContent")}}}),PG.Stores.Notifications=Backbone.Collection.extend({init:function(){this.register(function(e){e.source===page.constants.VIEW_SOURCE&&"notification"===e.action.type&&this.handleNotificationAction(e.action)})},handleNotificationAction:function(e){"create"===e.concern&&(this.add(e.data),this.emitChange()),"destroy"===e.concern&&(this.remove(e.data.id),this.emitChange())}}),_.extend(page.actions,{confirm:function(e){page.dispatcher.dispatchViewAction({type:"confirm",concern:"create",data:e})},uploader:function(e){page.dispatcher.dispatchViewAction({type:"uploader",concern:"create",data:{viewComponent:e.viewComponent,props:e.props}})},uploaderClose:function(){page.dispatcher.dispatchViewAction({type:"uploader",concern:"destroy",data:{}})},prompt:function(e){page.dispatcher.dispatchViewAction({type:"prompt",concern:"create",data:e})},notify:function(e,t){("string"==typeof e||e instanceof Array)&&(e={props:{text:e},timeout:t}),e.id=e.id||page.util.guidGenerator(),page.dispatcher.dispatchViewAction({type:"notification",concern:"create",data:e}),e.timeout||(e.timeout=page.constants.NOTIFICATION_LIFESPAN),setTimeout(function(){page.dispatcher.dispatchViewAction({type:"notification",concern:"destroy",data:e})},e.timeout)},notifyError:function(e,t){return page.actions.notify({props:{text:e,error:!0},timeout:t})},generalNetworkError:function(e,t){var r,n,a,o=t&&t.msgData;if(e&&e.response)if("object"==typeof e.response)a=e.response;else if("string"==typeof e.response)try{a=JSON.parse(e.response)}catch(e){}return a&&a.error_msg_t?n=I18n.t(a.error_msg_t,o):r=a&&a.status?page.constants.responseCodes[a.status.toString()]:e&&e.status&&page.constants.responseCodes[e.status.toString()]?page.constants.responseCodes[e.status.toString()]:"NETWORK_ERROR",page.actions.notify({props:{type:r,text:n,error:!0},timeout:4500})},preloadImage:function(e){var t=new Image;t.src=e}}),"undefined"!=typeof module&&(module.exports=page.actions);var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};PG.Components.Layout=React.createClass({displayName:"Layout",mixins:[page.mixins.requires],statics:{componentName:"layout",requires:{translations:{projects:"nav.projects",oldBrowser:"banner.old_browser",windowsApp:"banner.windows_app",windowsAppAction:"banner.windows_app_action"},stores:["projects","user","olark","confirm","uploader","notifications","photoViewer","prompt"]}},getInitialState:function(){var e=this.stateFromStores();return e.loading=!0,e.showSubmittals=!1,e},componentDidMount:function(){var e=this;window.WebpackBackports.shared.MyEntitlements.hasSubmittalsOrSpecExtraction(page.features,page.data.rawCurrentProject).then(function(t){e.setState({loading:!1,showSubmittals:t})})},handleEmit:function(){this.setState(this.stateFromStores())},stateFromStores:function(){return{fullName:page.stores.user.getFullName(),projects:page.stores.projects.toJSON(),currentProject:page.stores.projects.getCurrentProject(),opsAvailable:this.isChatAvailable(),isOnTrial:page.stores.user.isOnTrial(),daysLeftInTrial:page.stores.user.getDaysLeftInTrial(),organizationInviteAccepted:page.stores.user.organizationInviteAccepted,modalView:page.stores.confirm.get("view"),modalProps:page.stores.confirm.getProps(),promptView:page.stores.prompt.get("view"),promptProps:page.stores.prompt.getProps(),photoViewerView:page.stores.photoViewer.get("view"),photoViewerProps:page.stores.photoViewer.getProps(),uploaderComponent:page.stores.uploader.getViewComponent(),uploaderProps:page.stores.uploader.getProps(),notifications:page.stores.notifications.toJSON()}},isChatAvailable:function(){return page.features.FF_OLARK_CHAT?page.stores.olark.getOpsAvailable():page.features.FF_ZENDESK_CHAT?!!window.$zopim:page.features.FF_LIVE_CHAT?void 0!==window.LC_API:void 0},render:function(){var e,t=this.props,r=t.wrap,n=t.renderModalContainer,a=this.state.projects.map(function(e){var t={uid:e.uid,name:e.project_name,features:e.features};return e.hasOwnProperty("parent_project_uid")&&(t=Object.assign({},t,{parent_project_uid:e.parent_project_uid})),t}),o=this.hasTrialBanner();e=classNames({"page-content":!0,"with-side-nav":!o&&this.hasSideNav(),"with-trial-banner":o});var s=React.createElement("div",{className:"flex flex-column page-layout"},this.renderBanners(),this.renderTopbar(a),React.createElement("div",{className:"page-content-wrapper"},React.createElement("div",{className:e},this.renderSideNav(),React.createElement("div",{className:"app-center-view"},React.createElement(this.props.centerView,_extends({},this.props.centerViewProps,{project:this.state.currentProject}))),this.renderFooter()),this.renderUploader(),this.renderConfirmModal(),this.renderPhotoViewerModal(),this.renderPromptModal(),this.renderNotifications(),n&&n()));return r?r(s):s},renderTopbar:function(e){return this.hasTopbar()?React.createElement(PG.Components.Topbar,{projects:e,rawProjects:this.state.projects,text:this.state.currentProject?this.state.currentProject.get("project_name"):this.state.i18n.projects,selectedProject:this.state.currentProject?this.state.currentProject.get("uid"):null,userName:this.state.fullName,opsAvailable:this.state.opsAvailable}):null},renderBanners:function(){var e=window.WebpackBackports.shared.components.TrialBanner;return!this.state.organizationInviteAccepted&&this.state.isOnTrial&&this.state.daysLeftInTrial>=0&&page.features.FF_NEW_TRIAL_FLOW?React.createElement(e,{daysLeftInTrial:this.state.daysLeftInTrial}):page.browserInfo.onWindows&&page.features.FF_SHOW_WINDOWS_BANNER?React.createElement(PG.Components.Banner,{text:this.state.i18n.windowsApp,actionText:this.state.i18n.windowsAppAction,actionEventName:"banner.windows.download.click",closeEventName:"banner.windows.close",actionUrl:"https://plangrid-windows-installer.s3-accelerate.amazonaws.com/production/PlanGridSetup.exe"}):page.browserInfo.oldIe?React.createElement(PG.Components.Banner,{text:this.state.i18n.oldBrowser}):null},renderSideNav:function(){if(this.hasSideNav()){var e=window.WebpackBackports.shared.components.SideNav;return React.createElement(e,{projectId:this.state.currentProject.get("uid"),features:page.features,loading:this.state.loading,showSubmittals:this.state.showSubmittals})}},renderFooter:function(){return this.props.footer},renderConfirmModal:function(){if(this.state.modalView)return React.createElement(this.state.modalView,this.state.modalProps)},renderPhotoViewerModal:function(){if(this.state.photoViewerView)return React.createElement(this.state.photoViewerView,this.state.photoViewerProps)},renderUploader:function(){if(this.state.uploaderComponent)return React.createElement(this.state.uploaderComponent,this.state.uploaderProps)},renderPromptModal:function(){if(this.state.promptView)return React.createElement(this.state.promptView,this.state.promptProps)},renderNotifications:function(){if(this.state.notifications.length)return React.createElement("div",{className:"notify-stack"},this.state.notifications.map(function(e){var t=e.view||PG.Components.LayoutNotification;return React.createElement(t,_extends({},e.props,{id:e.id,key:e.id}))}))},hasSideNav:function(){return!this.props.noSideNav&&!!this.state.currentProject},hasTopbar:function(){var e=window.location.href,t=[/projects\/[\w-]*\/review\/[\w-]*\/numbers/,/projects\/[\w-]*\/review\/[\w-]*\/titles/],r=t.some(function(t){return e.match(t)});return!r},hasTrialBanner:function(){return this.state.isOnTrial}}),"undefined"!=typeof module&&(module.exports=PG.Components.Layout),PG.Components.BasicLayout=React.createClass({displayName:"BasicLayout",mixins:[page.mixins.requires],statics:{componentName:"basicLayout",requires:{translations:{},stores:[]}},componentWillMount:function(){this.preloadBgImage()},isChatAvailable:function(){return page.features.FF_OLARK_CHAT?page.stores.olark.getOpsAvailable():page.features.FF_ZENDESK_CHAT?!!window.$zopim:void 0},preloadBgImage:function(){var e=this,t=page.constants.breakpoints.BREAKPOINT_TABLET,r="(min-width: "+t+")";if(!window.matchMedia||window.matchMedia(r).matches){var n=new Image;n.onload=function(){e.showBgImage()},n.src=this.props.route.bgImage}},showBgImage:function(){this.setState({showBgImage:!0})},render:function(){var e,t;e=classNames({"page-content":!0,"no-padding":!0,"bg-gradient":!0}),t=classNames({"app-center-view":!0,"basic-layout":!0});var r=this.state.showBgImage?"bg-image":"",n=this.state.showBgImage?{background:"url("+this.props.route.bgImage+") no-repeat",backgroundSize:"cover"}:{};return React.createElement("div",{className:"page-layout"},React.createElement("div",{className:"bg split-display "+r},React.createElement("div",{className:"content-container",style:n},React.createElement("div",{className:e},React.createElement("div",{className:t},this.props.children)))),this.renderFooter())},renderFooterNavLinks:function(){var e=[{label:this.props.route.translate("FL.footer.legal"),href:"https://www.plangrid.com/PlanGrid-EULA.pdf"},{label:this.props.route.translate("FL.footer.privacy"),href:"https://www.plangrid.com/PlanGrid-Privacy-Policy.pdf"},{label:this.props.route.translate("FL.footer.careers"),href:"https://www.plangrid.com/jobs/"},{label:this.props.route.translate("FL.footer.support"),href:"https://help.plangrid.com/hc/en-us/"}];return React.createElement("span",{className:"footer-nav-links"},e.map(function(e){return React.createElement("span",{key:e.href},React.createElement("a",{href:e.href},e.label))}))},renderFooter:function(){var e=(new Date).getFullYear();return React.createElement("footer",{className:"window-footer"},React.createElement("div",{className:"footer-content-wrapper"},React.createElement("div",{className:"pull-left"},React.createElement("span",{className:"footer-copyright-text"},"\xa9 ",e," - PlanGrid, Inc.")),React.createElement("div",{className:"pull-right"},this.renderFooterNavLinks())))}}),"undefined"!=typeof module&&(module.exports=PG.Components.BasicLayout),PG.Components.Topbar=React.createClass({displayName:"Topbar",mixins:[page.mixins.requires],statics:{componentName:"topbar",requires:{translations:{projects:"nav.projects",helpButtonText:"header.help_center",fullListText:"projects_list.view_full_list",chatOnlineBtnText:"chat.online",chatOfflineBtnText:"chat.offline"}}},handleLiveChat:function(){page.features.FF_OLARK_CHAT?page.actions.olarkWidgetExpand():page.features.FF_ZENDESK_CHAT?window.$zopim.livechat.window.show():page.features.FF_LIVE_CHAT&&window.LC_API.show_full_view()},render:function(){var e=[{text:this.state.i18n.fullListText,callback:function(){window.location=page.routes.projects}}];return React.createElement("div",{className:"top-bar"},React.createElement(PG.Components.NavBar,null,React.createElement("div",{className:"top-bar-left"},React.createElement("a",{href:"/",className:"top-bar-logo",onClick:this.topBarHandler}),React.createElement(PG.Components.DeprecatedProjectsDropdown,{currentProjectId:this.props.selectedProject,text:this.props.text,menuTitle:this.state.i18n.projects,projects:this.props.projects,rawProjects:this.props.rawProjects,actions:e})),React.createElement("div",{"data-qa":"topbarChat",className:"top-bar-right"},React.createElement("a",{href:page.routes.helpCenter,onClick:this.helpClickHandler,className:"button minimal small",target:"_blank"},React.createElement("span",{className:"help-button"},this.state.i18n.helpButtonText)),React.createElement(PG.Components.AccountDropdown,{userName:this.props.userName}))))},helpClickHandler:function(){page.actions.analyticsShouldUpdate("clickHelpCenterLink")},topBarHandler:function(){page.actions.analyticsShouldUpdate("clickPGNavLogo")},renderChatButton:function(){if("undefined"!=typeof this.props.opsAvailable){var e,t;return this.props.opsAvailable?(e="inverted",t=this.state.i18n.chatOnlineBtnText):(e="minimal",t=this.state.i18n.chatOfflineBtnText),React.createElement(PG.Components.Button,{text:t,role:e,clickHandler:this.handleLiveChat})}}}),"undefined"!=typeof module&&(module.exports=PG.Components.Topbar),PG.Components.AccountDropdown=React.createClass({displayName:"AccountDropdown",mixins:[page.mixins.requires],statics:{componentName:"accountDropdown",requires:{translations:{myAccount:"user.my_account",accountSettings:"user.account_settings",logout:"user.log_out"}}},propTypes:{userName:React.PropTypes.string,logoutRedirect:React.PropTypes.string},selectHandler:function(e,t){t===page.routes.account?page.actions.analyticsShouldUpdate("selectAccountSettings"):t===page.routes.logout&&page.actions.analyticsShouldUpdate("selectLogout")},clickHandler:function(e){e===!0&&page.actions.analyticsShouldUpdate("openSettingsDropdown")},render:function(){var e=this.props.logoutRedirect?this.props.logoutRedirect:page.routes.logout,t="accountSettings",r=[{url:page.routes.account,text:this.state.i18n[t],value:page.routes.account,id:"test-accountPage"},{url:e,text:this.state.i18n.logout,value:e,id:"test-logout"}];return React.createElement(PG.Components.Dropdown,{text:this.props.userName,id:"test-accountDropdown",size:"small",role:"minimal",alignment:"right",clickHandler:this.clickHandler,selectHandler:this.selectHandler,items:r})}}),"undefined"!=typeof module&&(module.exports=PG.Components.AccountDropdown),PG.Components.GlobalNotification=React.createClass({displayName:"GlobalNotification",allowedRoles:["primary","secondary","additive","destructive"],getDefaultProps:function(){return{role:"primary"}},render:function(){var e=this.getClassSet(),t=classNames(e);return React.createElement("div",{className:t},this.props.children)},getClassSet:function(){var e={"global-notification":!0,primary:this.allowedRoles.indexOf(this.props.role)===-1};return e[this.props.role]=this.allowedRoles.indexOf(this.props.role)>-1,e}}),"undefined"!=typeof module&&(module.exports=PG.Components.GlobalNotification),PG.Components.Banner=React.createClass({displayName:"Banner",getDefaultProps:function(){return{text:"",actionText:null,actionUrl:""}},closeBanner:function(e){e.preventDefault(),e.stopPropagation(),this.props.closeEventName&&page.actions.analyticsShouldUpdate("logEvent",[this.props.closeEventName]),reqwest({method:"delete",url:page.routes.feature("show_windows_banner"),type:"json",contentType:"application/json",success:function(){window.location.reload()}})},trackAction:function(){this.props.actionEventName&&page.actions.analyticsShouldUpdate("logEvent",[this.props.actionEventName])},renderAction:function(){return this.props.actionText?React.createElement("a",{onClick:this.trackAction,className:"global-bannerAction",href:this.props.actionUrl},this.props.actionText):null},render:function(){return React.createElement("div",{className:"global-banner"},this.props.text," ",this.renderAction(),React.createElement("a",{href:"",onClick:this.closeBanner},React.createElement("i",{className:"icon-close",onClick:this.closeBanner})))}}),"undefined"!=typeof module&&(module.exports=PG.Components.Banner),PG.Components.DeprecatedProjectsDropdown=React.createClass({displayName:"DeprecatedProjectsDropdown",propTypes:{rawProjects:React.PropTypes.array,currentProjectId:React.PropTypes.string},render:function(){var e=window.WebpackBackports.shared.components.Topbar.nestWorkspaces;return React.createElement(WebpackBackports.shared.components.Topbar.ProjectsDropdown,{projects:e(this.props.rawProjects),currentProjectId:this.props.currentProjectId})}}),"undefined"!=typeof module&&(module.exports=PG.Components.DeprecatedProjectsDropdown);var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};PG.Components.LayoutNotification=React.createClass({displayName:"LayoutNotification",mixins:[page.mixins.requires],statics:{componentName:"layoutNotifications",requires:{translations:{NETWORK_ERROR:"networking.errors.generic_fail",AUTHORIZATION_ERROR:"networking.errors.auth_fail",NOT_FOUND:"networking.errors.not_found",SERVER_ERROR:"networking.errors.server_error",INVALID_REQUEST:"networking.errors.invalid_request",MAINTINANCE_MODE:"networking.errors.maintinance",TIMEOUT_ERROR:"networking.errors.timeout_fail",ALREADY_EXISTS:"networking.errors.already_exists",NO_LONGER_EXISTS:"networking.errors.no_longer_exists",RATELIMIT_ERROR:"networking.errors.ratelimited"}}},render:function(){return React.createElement(PG.Components.Notification,_extends({},this.props,{text:this.renderText(),clickHandler:this.handleClose}))},renderText:function(){return this.state.i18n[this.props.type]?this.state.i18n[this.props.type]:this.props.text},handleClose:function(){page.dispatcher.dispatchViewAction({type:"notification",concern:"destroy",data:{id:this.props.id}}),page.actions.analyticsShouldUpdate("toasterDismiss")}}),PG.Components.Progress=React.createClass({displayName:"Progress",render:function(){return React.createElement("span",{className:"progress"},React.createElement("span",{className:"bar",style:{width:this.calcPercentage()}}))},calcPercentage:function(){return 100*this.props.progress+"%"}}),PG.Components.MobileButtons=React.createClass({displayName:"MobileButtons",statics:{componentName:"mobileButtons"},propTypes:{page:React.PropTypes.string},handleAppStore:function(){page.actions.analyticsShouldUpdate("mobileAppClick","appStore",this.props.page),page.actions.locationShouldUpdate("https://itunes.apple.com/us/app/plangrid-construction-collaboration/id498795789?mt=8")},handlePlayStore:function(){page.actions.analyticsShouldUpdate("mobileAppClick","playStore",this.props.page),page.actions.locationShouldUpdate("http://bit.ly/1FS9KPD")},handleWindows:function(){page.actions.analyticsShouldUpdate("mobileAppClick","windows",this.props.page),page.actions.locationShouldUpdate("https://plangrid.com/en/windows")},render:function(){return React.createElement(PG.Components.ButtonGroup,null,React.createElement("div",{className:"mobile-clients"},React.createElement("div",{className:"app-store"},React.createElement(PG.Components.Button,{clickHandler:this.handleAppStore,text:""})),React.createElement("div",{className:"play-store"},React.createElement(PG.Components.Button,{clickHandler:this.handlePlayStore,text:""})),React.createElement("div",{className:"windows"},React.createElement(PG.Components.Button,{clickHandler:this.handleWindows,text:""}))))}}),"undefined"!=typeof module&&(module.exports=PG.Components.MobileButtons),PG.Components.ModalHeader=React.createClass({displayName:"ModalHeader",render:function(){return React.createElement("header",{className:"modal-header"},React.createElement("h1",{className:"main-modal-title"},this.props.title),React.createElement("h2",{className:"modal-subtitle"},this.props.subtitle))}}),"undefined"!=typeof module&&(module.exports=PG.Components.ModalHeader),PG.Components.FileUploader=React.createClass({displayName:"FileUploader",mixins:[page.mixins.requires],statics:{componentName:"fileUploader",requires:{translations:{singleFailureSingleErrorType:"shared.uploader.errors.single_failure_single_error_type",multipleFailuresSingleErrorType:"shared.uploader.errors.multiple_failures_single_error_type",multipleFailuresMultipleErrorTypes:"shared.uploader.errors.multiple_failures_multiple_error_types",unsupported_format:"shared.uploader.errors.unsupported_format",largeFile:"shared.uploader.errors.large_file",failed_upload:"shared.uploader.errors.failed_upload",retryAllFailed:"shared.uploader.retry_all",removeAllFailed:"shared.uploader.remove_all"}}},propTypes:{directUploadHandler:React.PropTypes.func,failedMessage:React.PropTypes.node,lightboxCloseHandler:React.PropTypes.func,showCloseButton:React.PropTypes.bool,renderHeader:React.PropTypes.func,headerText:React.PropTypes.string,renderHeaderButton:React.PropTypes.func,subheadText:React.PropTypes.string,subheadTextBold:React.PropTypes.string,dropdownComponent:React.PropTypes.element,fileTypes:React.PropTypes.array,handleUploadItemCancel:React.PropTypes.func,multiselect:React.PropTypes.bool,uploading:React.PropTypes.bool,uploadItems:React.PropTypes.array,renderDoneButton:React.PropTypes.bool,renderAdditionalInfo:React.PropTypes.func,renderFooter:React.PropTypes.func,wrapperClass:React.PropTypes.string,allowDeletionAfterUpload:React.PropTypes.bool,allowErrorRetry:React.PropTypes.bool,allowErrorRemoval:React.PropTypes.bool},getDefaultProps:function(){return{uploadItems:[],renderDoneButton:!1,allowDeletionAfterUpload:!1,allowErrorRetry:!1,allowErrorRemoval:!1}},getInitialState:function(){return{dragged:!1}},componentDidMount:function(){PG.getFlag||console.error("PG.getFlag is not defined.")},render:function(){var e=this.props.wrapperClass||"";return React.createElement(PG.Components.Lightbox,{closeHandler:this.props.lightboxCloseHandler,showCloseButton:this.props.showCloseButton},React.createElement("form",{id:"uploader",className:"uploader"},this.renderHeaderText(),this.renderSubheadText(),this.renderDropdown(),this.renderAdditionalInfo(),this.renderFailedMessage(),React.createElement("div",{className:e},this.renderDropZone(),this.renderHiddenUploadFields(),React.createElement("div",{className:"button-bar"},this.renderUploadButtons())),this.renderFooter(),this.renderDoneButton()))},kickStartUpload:function(e){e.stopPropagation(),e.preventDefault();var t=ReactDOM.findDOMNode(this.refs.fileInput).files;t&&this.props.kickStartUpload&&this.props.kickStartUpload(e,t)},renderUploadButtons:function(){var e="direct-upload";this.props.uploading&&(e+="-disabled");var t=[React.createElement(PG.Components.Button,{key:e,image:"icon "+e,role:"primary",disabled:this.props.uploading,text:this.props.leftButtonText,clickHandler:this.handleDirectUpload})];return t},renderHeaderButton:function(){return this.props.renderHeaderButton?this.props.renderHeaderButton():null},renderFooter:function(){return this.props.renderFooter?this.props.renderFooter(this.kickStartUpload):null},renderDoneButton:function(){if(this.props.renderDoneButton)return React.createElement("div",{className:"button-done-uploading"},React.createElement(PG.Components.Button,{role:"emphasis",disabled:this.props.toggleDoneButton,text:this.props.doneButtonText,clickHandler:this.props.lightboxCloseHandler}))},handleDirectUpload:function(e){e.currentTarget.blur(),ReactDOM.findDOMNode(this.refs.fileInput).click()},renderFailedMessage:function(){if(!this.props.uploadItems)return null;var e=this.props.uploadItems.filter(function(e){return"error"===e.status});if(0===e.length)return null;if(this.props.failedMessage)return this.props.failedMessage;var t=e.map(function(e){return e.errorMessageKey||"FL.shared.uploader.errors.failed_upload"});if(0===t.length)return null;var r=e.map(function(e){return e.file&&e.file.size>=1e9}),n=e.map(function(e){var t=e.file||{};return{fileSizes:t.size||"",fileNames:t.name||"",fileTypes:t.type||""}}),a=e.length,o=_.uniq(t).length,s=null;return 1===a&&1===o&&r[0]?(s=this.state.i18n.largeFile.one,this.oversizeFileAnylyticsError(n[0].fileSizes,n[0].fileNames,n[0].fileTypes)):a>1&&1===o&&r[0]?s=this.state.i18n.largeFile.other:1===a&&1===o?s=String.expand(this.state.i18n.singleFailureSingleErrorType,{filename:e[0].filename,error_type:I18n.t(t[0])}):a>1&&1===o?s=String.expand(this.state.i18n.multipleFailuresSingleErrorType,{file_count:a,error_type:I18n.t(t[0])}):a>1&&o>1&&(s=String.expand(this.state.i18n.multipleFailuresMultipleErrorTypes,{file_count:a})),React.createElement("div",{className:"failed-message"},s,this.renderRetryAllFailed())},renderRetryAllFailed:function(){if(this.props.allowErrorRetry&&!this.props.uploadItems.every(function(e){return"error"!==e.status}))return React.createElement("div",{className:"failed-upload-actions"},React.createElement("span",{className:"retry-all-link",onClick:this.props.retryAllFailedHandler},this.state.i18n.retryAllFailed),React.createElement("span",null,"\xa0|\xa0"),React.createElement("span",{className:"remove-all-link",onClick:this.props.removeAllFailedHandler},this.state.i18n.removeAllFailed))},oversizeFileAnylyticsError:function(e,t,r){page.actions.analyticsShouldUpdate("attachmentsListUploadErrorFileLimit",{filesize:e,filename:t,type:r})},renderHiddenUploadFields:function(){var e=this.props.fileTypes.map(function(e){return"."+e});return React.createElement("input",{key:"fileInput",type:"file",className:"hidden",ref:"fileInput",onChange:this.handleFileSelector,onClick:this.clearClickValue,name:"file",multiple:this.props.multiselect,accept:e.join(", ")})},clearClickValue:function(e){e.target.value=null},handleFileSelector:function(e){this.directUploadHandler(e,"computer")},handleFileDragDrop:function(e){this.directUploadHandler(e,"dragdrop")},clearFileInput:function(){ReactDOM.findDOMNode(this.refs.fileInput).value=""},renderHeaderText:function(){return this.props.renderHeader?this.props.renderHeader():React.createElement("h1",{className:"uploader-header flex items-center"},React.createElement("span",{className:"flex-auto"},this.props.headerText),this.renderHeaderButton())},toggleDragState:function(e){return this.setState({dragged:e}),!1},renderSubheadText:function(){return this.props.subheadText?React.createElement("h2",{className:"uploader-subhead"},String.insert(this.props.subheadText,{boldedPart:React.createElement("b",null,this.props.subheadTextBold)})):null},renderDropdown:function(){return this.props.dropdownComponent?React.createElement("div",{className:"dropdown-container"},this.props.dropdownComponent):null},renderAdditionalInfo:function(){return this.props.renderAdditionalInfo?this.props.renderAdditionalInfo():null},renderDropZone:function(){return this.props.uploadItems.length?React.createElement(PG.Components.DropZone,{dragged:this.state.dragged,dragOverHandler:this.toggleDragState.bind(this,!0),dragLeaveHandler:this.toggleDragState.bind(this,!1),fileDropHandler:this.handleFileDragDrop,disabled:this.props.uploading},React.createElement("div",{className:"upload-list"},this.props.uploadItems.map(function(e,t){return React.createElement(PG.Components.UploadItem,{key:e.filename+t,status:e.status,errorMessageKey:e.errorMessageKey,progress:e.progress,filename:e.filename,uid:e.uid||"",newVersionInfo:e.newVersionInfo,actionInFlight:e.actionInFlight,keepAsSeparateFile:this.props.keepAsSeparateFile,discardNewVersion:this.props.discardNewVersion,replaceDuplicate:this.replaceDuplicate,uploading:this.props.uploading,allowDeletionAfterUpload:this.props.allowDeletionAfterUpload,allowErrorRetry:this.props.allowErrorRetry,allowErrorRemoval:this.props.allowErrorRemoval,retryHandler:this.props.uploadItemRetryHandler,closeHandler:this.props.uploadItemCancelHandler})}.bind(this)))):React.createElement(PG.Components.DropZone,{dragged:this.state.dragged,dragOverHandler:this.toggleDragState.bind(this,!0),dragLeaveHandler:this.toggleDragState.bind(this,!1),fileDropHandler:this.handleFileDragDrop,disabled:this.props.uploading},React.createElement(PG.Components.DropZoneTip,{fileType:this.props.fileTypes,dragged:this.state.dragged}))},replaceDuplicate:function(e,t,r){this.props.replaceDuplicate&&this.props.replaceDuplicate(e,t,r)},directUploadHandler:function(e,t){var r=e.dataTransfer?e.dataTransfer.files:e.target.files;e.stopPropagation(),e.preventDefault(),this.setState({dragged:!1}),r&&0!==r.length&&this.props.directUploadHandler&&this.props.directUploadHandler(e,r,t)}}),"undefined"!=typeof module&&(module.exports=PG.Components.FileUploader),PG.Components.DropZone=React.createClass({displayName:"DropZone",propTypes:{dragOverHandler:React.PropTypes.func,dragEnterHandler:React.PropTypes.func,dragLeaveHandler:React.PropTypes.func,
fileDropHandler:React.PropTypes.func,dragged:React.PropTypes.bool,disabled:React.PropTypes.bool},render:function(){var e=classNames({dragged:this.props.dragged,disabled:this.props.disabled,"drop-zone":!0});return React.createElement("div",{className:e,draggable:!0,onDragOver:this.dragOver,onDragLeave:this.dragLeave,onDragEnter:this.dragEnter,onDrop:this.handleFileSelect},this.props.children)},dragOver:function(e){e.preventDefault(),this.props.disabled||this.props.dragOverHandler&&this.props.dragOverHandler(e)},dragLeave:function(e){this.props.disabled||this.props.dragLeaveHandler&&this.props.dragLeaveHandler(e)},dragEnter:function(e){e.preventDefault(),this.props.disabled||this.props.dragEnterHandler&&this.props.dragEnterHandler(e)},handleFileSelect:function(e){e.preventDefault(),this.props.disabled||this.props.fileDropHandler&&this.props.fileDropHandler(e)}}),"undefined"!=typeof module&&(module.exports=PG.Components.DropZone),PG.Components.DropZoneTip=React.createClass({displayName:"DropZoneTip",mixins:[page.mixins.requires],statics:{componentName:"dropZone",requires:{translations:{beginUpload:"shared.uploader.on_drag_tip",dropTip:"shared.uploader.drop_zone_tip",dropTipGeneric:"shared.uploader.drop_zone_tip_generic",dropTipPDF:"shared.uploader.drop_zone_tip_pdf",dropTipPhoto:"shared.uploader.drop_zone_tip_photo"}}},getDefaultTooltipText:function(){if(1!==this.props.fileType.length)return this.state.i18n.dropTipGeneric;var e={pdf:this.state.i18n.dropTipPDF,img:this.state.i18n.dropTipPhoto};return String.expand(this.state.i18n.dropTip,{fileTypeText:e[this.props.fileType[0]]})},getDropzoneText:function(){return this.props.dragged?this.state.i18n.beginUpload:this.getDefaultTooltipText()},isSuggestiveExperiment:function(){return window.__experiments__&&window.__experiments__.documents_suggestive_icons},renderSuggestiveIcons:function(){return this.isSuggestiveExperiment()?React.createElement("div",{className:"fileicon-container"},React.createElement("i",{className:"pdf large"}),React.createElement("i",{className:"spreadsheet large"}),React.createElement("i",{className:"image large"}),React.createElement("i",{className:"doc large"})):null},renderSuggestiveText:function(){return this.isSuggestiveExperiment()?React.createElement("div",null,"You can upload PDFs, documents, spreadsheets, photos and more."):null},render:function(){return React.createElement("span",{className:"dropzone-tip"},this.renderSuggestiveIcons(),React.createElement("span",{className:"dropzone-icon "+this.props.fileType}),React.createElement("span",{className:"dropzone-text"},this.getDropzoneText(),this.renderSuggestiveText()))}}),"undefined"!=typeof module&&(module.exports=PG.Components.DropZoneTip),PG.Components.UploadItem=React.createClass({displayName:"UploadItem",mixins:[page.mixins.requires],statics:{componentName:"uploadItem",requires:{translations:{uploaded:"shared.uploader.upload_item_finished",duplicate:"shared.uploader.upload_item_duplicate",uploadDuplicate:"shared.uploader.upload_duplicate",keepAsSeparateFile:"shared.uploader.keep_as_separate_file",discardVersion:"shared.uploader.discard_version",versioningHelptext:"shared.uploader.upload_item_new_version",versioningSubtitle:"shared.uploader.versioning_subtitle",retry:"shared.uploader.retry"}}},propTypes:{allowErrorRetry:React.PropTypes.bool,allowErrorRemoval:React.PropTypes.bool,status:React.PropTypes.oneOf(["staged","uploading","fin","error","new","proc","duplicate","","fin-duplicate","discarded-duplicate"]),errorMessageKey:React.PropTypes.string,filename:React.PropTypes.string,closeHandler:React.PropTypes.func,progress:React.PropTypes.number},getDefaultProps:function(){return{allowErrorRetry:!1,allowErrorRemoval:!1,errorMessageKey:"FL.shared.uploader.errors.failed_upload"}},render:function(){switch(this.props.status){case"error":return this.renderErrorItem();case"fin":case"":return this.renderFinishedItem();case"duplicate":return this.renderDuplicate();case"fin-duplicate":return this.renderNewVersioningDuplicate();case"discarded-duplicate":return React.createElement("div",null);default:return this.renderUploadingItem()}},renderTitle:function(){if(!page.features.document_versioning)return this.props.filename;if(!this.props.newVersionInfo)return this.props.filename;var e=this.props.actionInFlight?React.createElement("span",null,"\xa0\xa0",React.createElement("div",{className:"upload-spinner-icon-container"},React.createElement(PG.Components.StatusIcon,{spinner:!0,size:"small"}))):null;return React.createElement("div",{title:this.props.filename+" (V"+(this.props.newVersionInfo.version+1)+")"},this.props.filename,"\xa0\xa0",React.createElement("div",{className:"icon version-background"},React.createElement("span",{className:"version-text"},"V"+(this.props.newVersionInfo.version+1))),e)},renderUploadingItem:function(){return React.createElement("div",{className:"uploading-item"},React.createElement("span",{className:"icon-cell"},this.renderFileTypeItem()),React.createElement("div",{className:"uploading-cell"},React.createElement(PG.Components.TitleSubtitleCell,{title:this.renderTitle(),subtitle:this.renderProgressBar()}),this.renderCloseIcon()))},renderFinishedItem:function(){return React.createElement("div",{className:"uploading-item status-finished"},React.createElement("span",{className:"icon-cell"},this.renderFileTypeItem()),React.createElement("div",{className:"uploading-cell"},React.createElement(PG.Components.TitleSubtitleCell,{title:this.props.filename,subtitle:this.state.i18n.uploaded}),this.props.allowDeletionAfterUpload&&this.renderCloseIcon()))},renderActionLinks:function(){return this.props.actionInFlight?null:React.createElement("p",null,String.insert(this.state.i18n.versioningSubtitle,{keepAsSeparateFile:React.createElement("span",{key:"separate-file",className:"sheet-link",onClick:this.props.keepAsSeparateFile.bind(null,this.props.newVersionInfo.uid,this.props.uid)},this.state.i18n.keepAsSeparateFile),discardVersion:React.createElement("span",{key:"discard-version",className:"sheet-link",onClick:this.props.discardNewVersion.bind(null,this.props.newVersionInfo.uid,this.props.uid)},this.state.i18n.discardVersion)}))},renderNewVersioningDuplicate:function(){return React.createElement("div",{className:"uploading-item status-duplicate"},React.createElement("span",{className:"icon-cell"},this.renderFileTypeItem()),React.createElement("div",{className:"uploading-cell"},React.createElement(PG.Components.TitleSubtitleCell,{title:this.renderTitle(),subtitle:React.createElement("div",null,this.state.i18n.versioningHelptext,this.renderActionLinks())})))},renderDuplicate:function(){return React.createElement("div",{className:"uploading-item status-duplicate"},React.createElement("span",{className:"icon-cell"},this.renderFileTypeItem()),React.createElement("div",{className:"uploading-cell"},React.createElement(PG.Components.TitleSubtitleCell,{title:this.props.filename,subtitle:this.state.i18n.duplicate}),React.createElement("div",{className:"actions"},React.createElement(PG.Components.Button,{text:this.state.i18n.uploadDuplicate,id:"test-replaceFile",role:"simple",clickHandler:this.replaceDuplicate}))))},replaceDuplicate:function(e){this.props.replaceDuplicate&&this.props.replaceDuplicate(e,this.props.uid,this.props.filename)},renderErrorItem:function(){return React.createElement("div",{className:"uploading-item status-error"},React.createElement("span",{className:"icon-cell"},React.createElement("span",{className:"error-file-icon"})),React.createElement("div",{className:"uploading-cell"},React.createElement(PG.Components.TitleSubtitleCell,{title:this.props.filename,subtitle:I18n.t(this.props.errorMessageKey||"FL.shared.uploader.errors.failed_upload")}),this.props.allowErrorRetry&&this.renderRetryIcon(),this.props.allowErrorRemoval&&this.renderCloseIcon()))},renderRetryIcon:function(){return this.props.uploading?null:React.createElement("span",{className:"retry-cell"},React.createElement("span",{className:"retry-link",onClick:this.handleRetry},this.state.i18n.retry))},handleRetry:function(e){this.props.retryHandler&&this.props.retryHandler(e,this.props.uid)},renderCloseIcon:function(){return this.props.uploading?null:React.createElement("span",{className:"close-cell"},React.createElement("span",{className:"close-icon",onClick:this.handleClose}))},handleClose:function(e){this.props.closeHandler&&this.props.closeHandler(e,this.props.uid)},renderFileTypeItem:function(){var e,t=page.util.getFileExtension(this.props.filename);return e="pdf"===t?"icon-pdf":page.util.getFileCategory(t),React.createElement("span",null,React.createElement("i",{className:e}))},renderProgressBar:function(){return React.createElement(PG.Components.Progress,{progress:this.props.progress})}}),"undefined"!=typeof module&&(module.exports=PG.Components.UploadItem),PG.Components.ConfirmModal=React.createClass({displayName:"ConfirmModal",getDefaultProps:function(){return{confirmRole:"emphasis",showDarkBackground:!1}},propTypes:{cancelHandler:React.PropTypes.func,confirmHandler:React.PropTypes.func,title:React.PropTypes.node,textContent:React.PropTypes.node,confirmRole:React.PropTypes.string,cancelText:React.PropTypes.string,confirmText:React.PropTypes.string,hideCancelButton:React.PropTypes.bool},showCancelButton:function(){if(!this.props.hideCancelButton)return React.createElement(PG.Components.Button,{role:"primary",text:this.props.cancelText,clickHandler:this.props.cancelHandler})},render:function(){return React.createElement(PG.Components.Lightbox,{showDarkBackground:this.props.showDarkBackground,closeHandler:this.props.cancelHandler,lockScrolling:!0,showCloseButton:!0},React.createElement("form",{className:"confirmation-modal"},React.createElement("h1",{className:"confirmation-title"},this.props.title),React.createElement("p",{className:"confirmation-text"},this.props.textContent),React.createElement("div",{className:"button-tray"},this.showCancelButton(),React.createElement(PG.Components.Button,{role:this.props.confirmRole,text:this.props.confirmText,clickHandler:this.props.confirmHandler}))))}}),"undefined"!=typeof module&&(module.exports=PG.Components.ConfirmModal);var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};PG.Components.DefaultConfirmModal=React.createClass({displayName:"DefaultConfirmModal",mixins:[page.mixins.requires],statics:{componentName:"defaultConfirmModal",requires:{translations:{title:"shared.confirm_title",textContent:"shared.confirm_body",confirmText:"shared.confirm_action",cancelText:"shared.cancel_action"}}},render:function(){return React.createElement(PG.Components.ConfirmModal,_extends({},this.props,{title:this.props.title||this.state.i18n.title,textContent:void 0===this.props.textContent?this.state.i18n.textContent:this.props.textContent,confirmText:this.props.confirmText||this.state.i18n.confirmText,cancelText:this.props.cancelText||this.state.i18n.cancelText,cancelHandler:this.cancel,confirmHandler:this.confirm,confirmRole:this.props.confirmRole}))},confirm:function(e){this.props.confirmHandler&&this.props.confirmHandler(e),page.dispatcher.dispatchViewAction({concern:"destroy",type:"confirm"})},cancel:function(e){this.props.cancelHandler&&this.props.cancelHandler(e),page.dispatcher.dispatchViewAction({concern:"destroy",type:"confirm"})}}),"undefined"!=typeof module&&(module.exports=PG.Components.DefaultConfirmModal),PG.Stores.SingleFileUpload=Backbone.Model.extend({idAttribute:"uid",storeUploadDataAction:function(e){"create"===e.concern&&(this.failed=!1,this.uploading=!0,this.set(e.data),this.emitChange()),"update"===e.concern&&(e.data.failed?(this.failed=!0,this.uploading=!1,this.clear()):(this.failed=!1,this.set(e.data)),this.emitChange()),"destroy"===e.concern&&(this.failed=!1,this.open=!1,this.uploading=!1,delete this.success,this.clear(),this.emitChange())},isDirectUpload:function(){return!!this.get("file")},getFilename:function(){return this.get("file").name},getFileSize:function(){return this.get("file").size}}),"undefined"!=typeof module&&(module.exports=PG.Stores.SingleFileUpload),PG.Stores.SheetsAttachmentUploader=PG.Stores.SingleFileUpload.extend({init:function(){this.uploads=[],this.register(function(e){e.source===page.constants.VIEW_SOURCE&&this.handleViewAction(e.action),e.source===page.constants.DATA_SOURCE&&this.handleDataAction(e.action)})},handleDataAction:function(e){"sheetsAttachment"===e.type&&(this.storeUploadDataAction(e),"update"===e.concern&&e.data.filename&&(this.uploads=[{status:e.data.status,progress:e.data.progress,filename:e.data.filename,errorType:"error"===e.data.status?"failed_upload":null}]),this.emitChange())},handleViewAction:function(e){"sheetsAttachment"===e.type&&("update"===e.concern&&e.data.clear&&(this.uploading=!1,this.clear()),"destroy"===e.concern&&(this.failed=!1,this.uploading=!1,this.uploads=[],this.clear()),this.emitChange())},getUploads:function(){return this.uploads}}),"undefined"!=typeof module&&(module.exports=PG.Stores.SheetsAttachmentUploader),PG.Stores.PhotoViewer=Backbone.Model.extend({defaults:{success:page.util.noop,error:page.util.noop},init:function(){this.register(function(e){e.source===page.constants.VIEW_SOURCE&&"photoViewer"===e.action.type&&this.handleConfirmAction(e.action),e.source===page.constants.DATA_SOURCE&&"photoViewer"===e.action.type&&this.handleNewData(e.action)})},handleConfirmAction:function(e){"create"===e.concern&&(this.clear(),this.set(e.data),this.emitChange()),"destroy"===e.concern&&(this.clear(),this.emitChange())},handleNewData:function(e){if("updatePhoto"===e.concern){var t=this.get("photos"),r=t.find(function(t){return t.uid===e.data.uid});r[e.data.field]=e.data.value,this.set("photos",t),this.emitChange()}},getProps:function(){return this.toJSON()}}),PG.Stores.Uploader=Backbone.Model.extend({init:function(){this.register(function(e){e.source===page.constants.VIEW_SOURCE&&"uploader"===e.action.type&&this.handleUploaderAction(e.action)})},handleUploaderAction:function(e){"create"===e.concern&&(this.clear(),this.set(e.data),this.emitChange()),"destroy"===e.concern&&(this.clear(),this.emitChange())},getViewComponent:function(){return this.get("viewComponent")},getProps:function(){return this.get("props")}}),PG.Components.PromptModal=React.createClass({displayName:"PromptModal",getDefaultProps:function(){return{confirmRole:"emphasis"}},propTypes:{cancelHandler:React.PropTypes.func,confirmHandler:React.PropTypes.func,title:React.PropTypes.node,textContent:React.PropTypes.node,confirmRole:React.PropTypes.string,cancelText:React.PropTypes.string,confirmText:React.PropTypes.string},getInitialState:function(){return{value:""}},render:function(){return React.createElement(PG.Components.Lightbox,{closeHandler:this.props.cancelHandler,lockScrolling:!0,showCloseButton:!0},React.createElement("form",{className:"confirmation-modal"},React.createElement("h1",null,this.props.title),React.createElement("p",null,this.props.textContent),React.createElement("p",null,React.createElement(PG.Components.FormField,null,React.createElement(PG.Components.InputField,{type:"text",value:this.state.value,changeHandler:this.handleChange}))),React.createElement("div",{className:"button-tray"},React.createElement(PG.Components.Button,{role:"primary",text:this.props.cancelText,clickHandler:this.props.cancelHandler}),React.createElement(PG.Components.Button,{role:this.props.confirmRole,type:"submit",text:this.props.confirmText,clickHandler:this.props.confirmHandler.bind(null,this.state.value)}))))},handleChange:function(e){this.setState({value:e.target.value})}});var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};PG.Components.DefaultPromptModal=React.createClass({displayName:"DefaultPromptModal",mixins:[page.mixins.requires],statics:{componentName:"defaultPromptModal",requires:{translations:{title:"shared.prompt_title",textContent:"shared.prompt_body",confirmText:"shared.submit",cancelText:"shared.cancel_action"}}},render:function(){return React.createElement(PG.Components.PromptModal,_extends({},this.props,{title:this.props.title||this.state.i18n.title,textContent:this.props.textContent||this.state.i18n.textContent,confirmText:this.props.confirmText||this.state.i18n.confirmText,cancelText:this.props.cancelText||this.state.i18n.cancelText,cancelHandler:this.cancel,confirmHandler:this.confirm}))},confirm:function(e,t){this.props.confirmHandler&&this.props.confirmHandler(e,t),page.dispatcher.dispatchViewAction({concern:"destroy",type:"prompt"})},cancel:function(e){this.props.cancelHandler&&this.props.cancelHandler(e),page.dispatcher.dispatchViewAction({concern:"destroy",type:"prompt"})}}),"undefined"!=typeof module&&(module.exports=PG.Components.DefaultPromptModal);