/*!
 * Colcade v0.2.0
 * Lightweight masonry layout
 * by David DeSandro
 * MIT license
 */(function(b,a){typeof define=='function'&&define.amd?define(a):typeof module=='object'&&module.exports?module.exports=a():b.Colcade=a()})(window,function(){var a,e,c;function b(a,b){if(a=g(a),a&&a.colcadeGUID){var d=c[a.colcadeGUID];return d.option(b),d}this.element=a,this.options={},this.option(b),this.lastAppend=[],this.lastColumnHeights=[],this.create(),a.classList.add('cr-colcade-loaded')}a=b.prototype,a.option=function(a){this.options=h(this.options,a)},e=0,c={},a.create=function(){this.errorCheck();var a=this.guid=++e;this.element.colcadeGUID=a,c[a]=this,this.reload(),this._windowResizeHandler=this.onWindowResize.bind(this),this._loadHandler=this.onLoad.bind(this),window.addEventListener('resize',this._windowResizeHandler),this.element.addEventListener('load',this._loadHandler,!0)},a.errorCheck=function(){var a=[];if(this.element||a.push('Bad element: '+this.element),this.options.columns||a.push('columns option required: '+this.options.columns),this.options.items||a.push('items option required: '+this.options.items),a.length)throw new Error('[Colcade error] '+a.join('. '))},a.reload=function(){this.updateColumns(),this.updateItems(),this.layout()},a.updateColumns=function(){this.columns=d(this.options.columns,this.element)},a.updateItems=function(){this.items=d(this.options.items,this.element)},a.getActiveColumns=function(){return this.columns.filter(function(a){var b=getComputedStyle(a);return b.display!='none'})},a.layout=function(){this.activeColumns=this.getActiveColumns(),this._layout()},a._layout=function(){this.columnHeights=this.activeColumns.map(function(){return 0}),this.layoutItems(this.items)},a.layoutItems=function(a){a.forEach(this.layoutItem,this)},a.layoutItem=function(a){var c=Math.min.apply(Math,this.columnHeights),b=this.columnHeights.indexOf(c);this.activeColumns[b].appendChild(a),this.columnHeights[b]+=a.offsetHeight||1},a.append=function(b){var a=this.getQueryItems(b);this.items=this.items.concat(a),this.lastAppend.length=0,this.lastAppend=a.slice(),this.lastColumnHeights.length=0,this.lastColumnHeights=this.columnHeights.slice(),this.layoutItems(a)},a.prepend=function(a){var b=this.getQueryItems(a);this.items=b.concat(this.items),this._layout()},a.getQueryItems=function(a){a=f(a);var b=document.createDocumentFragment();return a.forEach(function(a){b.appendChild(a)}),d(this.options.items,b)},a.empty=function(){this.lastAppend.length=0,this.lastColumnHeights.length=0,this.items.forEach(function(a){a.remove()},this),this.items.length=0,this._layout()},a.measureColumnHeight=function(a){var b=this.element.getBoundingClientRect();this.activeColumns.forEach(function(c,d){if(!a||c.contains(a)){var e=c.lastElementChild.getBoundingClientRect();this.columnHeights[d]=e.bottom-b.top}},this)},a.onWindowResize=function(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){this.onDebouncedResize()}.bind(this),100)},a.onDebouncedResize=function(){var a=this.getActiveColumns(),c=a.length==this.activeColumns.length,b=!0;if(this.activeColumns.forEach(function(c,d){b=b&&c==a[d]}),c&&b)return;this.activeColumns=a,this._layout()},a.onLoad=function(a){this.measureColumnHeight(a.target),0<this.lastColumnHeights.length&&0<this.lastAppend.length&&(this.columnHeights.length=0,this.columnHeights=this.lastColumnHeights.slice(),this.layoutItems(this.lastAppend))},a.destroy=function(){this.items.forEach(function(a){this.element.appendChild(a)},this),window.removeEventListener('resize',this._windowResizeHandler),this.element.removeEventListener('load',this._loadHandler,!0),delete this.element.colcadeGUID,delete c[this.guid]},j(function(){var a=d('[data-colcade]');a.forEach(i)});function i(a){var d=a.getAttribute('data-colcade'),e=d.split(','),c={};e.forEach(function(b){var a=b.split(':'),d=a[0].trim(),e=a[1].trim();c[d]=e}),new b(a,c)}b.data=function(a){a=g(a);var b=a&&a.colcadeGUID;return b&&c[b]},b.makeJQueryPlugin=function(a){if(a=a||window.jQuery,!a)return;a.fn.colcade=function(a){if(typeof a=='string'){var b=Array.prototype.slice.call(arguments,1);return c(this,a,b)}return d(this,a),this};function c(c,d,e){var b;return c.each(function(h,f){var c=a.data(f,'colcade'),g;if(!c)return;g=c[d].apply(c,e),b=b===void 0?g:b}),b!==void 0?b:c}function d(d,c){d.each(function(f,e){var d=a.data(e,'colcade');d?(d.option(c),d.layout()):(d=new b(e,c),a.data(e,'colcade',d))})}},b.makeJQueryPlugin();function h(a,b){for(var c in b)a[c]=b[c];return a}function f(a){var b=[],c;if(Array.isArray(a))b=a;else if(a&&typeof a.length=='number')for(c=0;c<a.length;c++)b.push(a[c]);else b.push(a);return b}function d(b,a){a=a||document;var c=a.querySelectorAll(b);return f(c)}function g(a){return typeof a=='string'&&(a=document.querySelector(a)),a}function j(a){if(document.readyState=='complete'){a();return}document.addEventListener('DOMContentLoaded',a)}return b})