"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[529],{5926:function(e,s,t){var r=t(5893),a=t(7294),i=t(4184),n=t.n(i),o=t(1163),l=t(4994),c=t(4480),u=t(6655),d=t(3440),m=t(1664),x=t.n(m),p=t(3499),f=t(1841);let h=e=>{let{setSelectedLogin:s,shouldNotRedirect:t}=e,[i,m]=a.useState(null),[h,g]=(0,c.FV)(u.L),b=(0,o.useRouter)(),j="/login"===b.pathname,y=()=>{let e=document.getElementById("form-subscribe-title");if(e){var s=e.getBoundingClientRect().top+window.pageYOffset-200;window.scrollTo({top:s,behavior:"smooth"})}},v=async e=>{e.preventDefault(),m({status:"fetching"});let s=new FormData(e.target),r=await d.W.login(s.get("username").toString(),s.get("password").toString());y(),r.success?(g(r.user),t||b.push("/user/".concat(d.W.userValue.uid)),m({status:"success"})):m({status:"error",message:r.message})};return(0,a.useEffect)(()=>{h&&h.uid&&b.push("/user/".concat(d.W.userValue.uid))},[]),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h2",{id:"form-subscribe-title",className:"font-playfair text-2xl sm:text-3xl font-semibold mb-6",children:"J'ai d\xe9j\xe0 un compte"}),!j&&(0,r.jsx)("p",{onClick:()=>s(!1),className:"underline cursor-pointer hover:text-lpj-primary",children:"Vous n'avez pas encore de compte\xa0?"})]}),(0,r.jsxs)("form",{className:n()("grid gap-6"),onSubmit:v,children:[(null==i?void 0:i.message)&&(null==i?void 0:i.status)==="error"&&(0,r.jsx)(p.Z,{children:i.message}),(null==i?void 0:i.message)&&(null==i?void 0:i.status)==="success"&&(0,r.jsx)(f.Z,{children:"Connexion r\xe9ussie, redirection en cours..."}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsxs)("label",{htmlFor:"username",className:"uppercase font-semibold text-lpj-gray",children:["Nom d'utilisateur"," ",(0,r.jsx)("span",{className:"text-sm text-red-500",children:"*"})]}),(0,r.jsx)("input",{id:"username",name:"username",maxLength:255,required:!0,className:"px-2 py-3 border-2 border-gray focus:outline-dotted focus:outline-offset-2 focus:ring-0 focus:outline-link focus:border-gray"}),(0,r.jsx)("p",{className:"text-sm text-text",children:"Vous pouvez vous connectez avec l'email choisi lors de votre inscription."})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsxs)("label",{htmlFor:"password",className:"uppercase font-semibold text-lpj-gray",children:["Mot de passe"," ",(0,r.jsx)("span",{className:"text-sm text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"password",id:"password",name:"password",required:!0,className:"px-2 py-3 border-2 border-gray focus:outline-dotted focus:outline-offset-2 focus:ring-0 focus:outline-link focus:border-gray"}),(0,r.jsx)("p",{className:"text-sm text-text",children:"Saisissez le mot de passe correspondant \xe0 votre nom d'utilisateur."})]}),(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"submit",className:" transition-all flex items-center bg-lpj-primary hover:bg-lpj-primary-light px-8 py-2 rounded-full font-semibold text-base cursor-pointer text-white mt-2 ",disabled:(null==i?void 0:i.status)==="fetching",value:(null==i?void 0:i.status)==="fetching"||(null==i?void 0:i.status)==="success"?"En cours...":"Se connecter"})}),(0,r.jsxs)(x(),{href:"/reset-pass",className:"flex items-center",children:[(0,r.jsx)("span",{className:"w-4",children:(0,r.jsx)(l.Z,{})}),(0,r.jsx)("span",{className:"ml-2 hover:text-lpj-primary",children:"Vous avez oubli\xe9 votre mot de passe ?"})]})]})]})};s.Z=h},7187:function(e,s,t){t.d(s,{Z:function(){return b}});var r=t(5893),a=t(3499),i=t(1841),n=t(3879),o=t(1664),l=t.n(o),c=t(1163),u=t(7294),d=t(4853),m=t(4480),x=t(7949),p=t(6655);let f=async e=>{let s=await (0,n.r)("https://backoffice.lepetitjournal.com/lpj_user/check-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_email:e})});return s.json()},h=async e=>{let s=await (0,n.r)("https://backoffice.lepetitjournal.com/lpj_user/check-username",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_username:e})});return s.json()},g=e=>{let[s,t]=(0,u.useState)(null),[o,g]=(0,m.FV)(x.tl),[b,j]=(0,m.FV)(p.L),[y,v]=(0,u.useState)(""),[N,w]=(0,u.useState)(""),[_,S]=(0,u.useState)(""),[k,C]=(0,u.useState)(""),[F,T]=(0,u.useState)(""),[q,z]=(0,u.useState)(""),[V,Z]=(0,u.useState)(""),[L,O]=(0,u.useState)(null),{setSelectedLogin:E}=e,J=(0,u.useRef)(null),A=(0,c.useRouter)(),R="/login"===A.pathname,W=u.createRef(),[B,D]=(0,u.useState)({}),I=()=>T(y!==N?"Les mots de passe ne correspondent pas.":""),P=e=>{S(e),clearTimeout(L);let s=setTimeout(async()=>{await f(e).then(e=>{z(e.success?"":"Cet email est d\xe9j\xe0 utilis\xe9")})},500);O(s)},G=e=>{C(e),clearTimeout(L);let s=setTimeout(async()=>{await h(e).then(e=>{Z(e.success?"":"Ce nom est d\xe9j\xe0 utilis\xe9")})},500);O(s)},M=async e=>{if(e)try{t({status:"fetching"});let s=await (0,n.r)("/api/register",{method:"POST",body:JSON.stringify({formObject:B,captcha:e}),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()});if(void 0!==s.formStatus)return t(s.formStatus);{let e=await s;throw Error(e.message)}}catch(e){return t({status:"error",message:"Une erreur est survenue, nous ne sommes pas en mesure de cr\xe9er votre compte pour le moment."})}finally{}},U=async e=>{e.preventDefault();let s=new FormData(e.target),t=Object.fromEntries(s.entries());D(t),W.current.execute()};return(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"font-playfair text-2xl sm:text-3xl font-semibold mb-6",children:"Cr\xe9er mon compte"}),!R&&(0,r.jsx)("p",{onClick:()=>E(!0),className:"underline cursor-pointer hover:text-lpj-primary",children:"Vous avez d\xe9j\xe0 un compte\xa0?"})]}),(0,r.jsxs)("form",{className:"grid gap-6",onSubmit:U,ref:J,children:[(0,r.jsx)(d.Z,{ref:W,size:"invisible",sitekey:"6Ld20bYeAAAAAGInXH5NFNoIJGVRi0mWmWwjOqZr",onChange:M}),(null==s?void 0:s.message)&&(null==s?void 0:s.status)==="error"&&(0,r.jsx)(a.Z,{children:s.message}),(null==s?void 0:s.message)?(null==s?void 0:s.status)==="success"&&(0,r.jsx)(i.Z,{children:s.message}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsxs)("label",{htmlFor:"edition",className:"uppercase font-semibold text-text",children:["mon \xe9dition"," ",(0,r.jsx)("span",{className:"text-sm text-red-500",children:"*"})]}),(0,r.jsxs)("select",{id:"edition",name:"edition",required:!0,className:"px-2 py-3 border-2 border-gray focus:outline-dotted focus:outline-offset-2 focus:ring-0 focus:outline-link focus:border-gray",children:[(0,r.jsx)("option",{value:"",children:"Choisissez votre \xe9dition"}),(0,r.jsx)("option",{value:"0",children:"Internationale"}),o.map(e=>(0,r.jsx)("option",{value:e.drupal_internal__tid,children:e.name},e.id))]}),(0,r.jsx)("p",{className:"text-sm text-text",children:"Choisissez votre \xe9dition favorite."})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsxs)("label",{htmlFor:"email_subscribe",className:"uppercase font-semibold text-lpj-gray",children:["Adresse email"," ",(0,r.jsx)("span",{className:"text-sm text-red-500",children:"*"})]}),(0,r.jsx)("input",{id:"email_subscribe",name:"email_subscribe",maxLength:255,type:"email",required:!0,onChange:e=>P(e.target.value),className:"px-2 py-3 border-2 focus:outline-dotted focus:outline-offset-2 focus:ring-0 focus:outline-link focus:border-gray ".concat(q?"border-red-500":"border-gray")}),q&&(0,r.jsx)("p",{className:"text-sm text-text text-red-500",children:q}),(0,r.jsx)("p",{className:"text-sm text-text",children:"Une adresse de courriel valide. Tous les courriels de la part du syst\xe8me seront envoy\xe9s \xe0 cette adresse. L'adresse de courriel n'est pas publique et ne sera utilis\xe9e que si vous souhaitez recevoir un nouveau mot de passe, certaines actualit\xe9s ou des notifications par courriel."})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsxs)("label",{htmlFor:"username_register",className:"uppercase font-semibold text-lpj-gray",children:["Nom d'utilisateur"," ",(0,r.jsx)("span",{className:"text-sm text-red-500",children:"*"})]}),(0,r.jsx)("input",{id:"username_register",name:"username_register",maxLength:255,required:!0,onChange:e=>G(e.target.value),className:"px-2 py-3 border-2 border-gray focus:outline-dotted focus:outline-offset-2 focus:ring-0 focus:outline-link focus:border-gray ".concat(V?"border-red-500":"border-gray")}),V&&(0,r.jsx)("p",{className:"text-sm text-text text-red-500",children:V}),(0,r.jsx)("p",{className:"text-sm text-text",children:"Plusieurs caract\xe8res sp\xe9ciaux sont autoris\xe9s : l'espace, le point (.), le tiret (-), l'apostrophe ('), le tiret bas (_) et le signe @."})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsxs)("label",{htmlFor:"password_subscribe",className:"uppercase font-semibold text-text",children:["Mot de passe"," ",(0,r.jsx)("span",{className:"text-sm text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"password",id:"password_subscribe",name:"password_subscribe",required:!0,onBlur:()=>I(),onChange:e=>v(e.target.value),className:"px-2 py-3 border-2 border-gray focus:outline-dotted focus:outline-offset-2 focus:ring-0 focus:outline-link focus:border-gray"})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsxs)("label",{htmlFor:"password_subscribe_confirm",className:"uppercase font-semibold text-text",children:["Confirmer votre mot de passe"," ",(0,r.jsx)("span",{className:"text-sm text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"password",id:"password_subscribe_confirm",name:"password_subscribe_confirm",required:!0,onChange:e=>w(e.target.value),onBlur:()=>I(),className:"px-2 py-3 border-2 focus:outline-dotted focus:outline-offset-2 focus:ring-0 focus:outline-link focus:border-gray ".concat(F?"border-red-500":"border-gray")}),F&&(0,r.jsx)("p",{className:"text-sm text-text text-red-500",children:F}),(0,r.jsx)("p",{className:"text-sm text-text",children:"Saisissez un mot de passe pour le nouveau compte dans les deux champs."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"checkbox",id:"newsletter",name:"newsletter",defaultChecked:!0,className:"px-2 py-3 border-2 border-gray focus:outline-dotted focus:outline-offset-2 focus:ring-0 focus:outline-link focus:border-gray"}),(0,r.jsx)("label",{htmlFor:"newsletter",className:"ml-2 uppercase font-semibold text-text",children:"Je m'inscris \xe0 la newsletter de mon \xe9dition"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"checkbox",id:"terms",name:"terms",required:!0,className:"px-2 py-3 border-2 border-gray focus:outline-dotted focus:outline-offset-2 focus:ring-0 focus:outline-link focus:border-gray"}),(0,r.jsxs)("label",{htmlFor:"terms",className:"ml-2 uppercase font-semibold text-text",children:["J'accepte les"," ",(0,r.jsx)(l(),{href:"/legal",className:"text-lpj-primary",children:"conditions d'utilisation"})," ","du site lepetitjournal.com"]})]}),(0,r.jsxs)("div",{children:[F&&(0,r.jsx)("p",{className:"text-sm text-text text-red-500",children:"Le formulaire comporte des erreurs, merci de les corriger avant de soumettre."}),(0,r.jsx)("input",{type:"submit",className:"\n                                    transition-all\n                                    flex\n                                    items-center\n                                    bg-lpj-primary\n                                    hover:bg-lpj-primary-light\n                                    px-8\n                                    py-2\n                                    rounded-full\n                                    font-semibold\n                                    text-base\n                                    cursor-pointer\n                                    text-white\n                                    mt-2\n                                    ".concat(F||q||V?"cursor-not-allowed":"","\n                            "),disabled:""!==F||""!==q||""!==V||(null==s?void 0:s.status)==="fetching",value:(null==s?void 0:s.status)==="fetching"?"En cours ...":"Cr\xe9er un compte"})]})]})]})]})};var b=g},3499:function(e,s,t){var r=t(5893);t(7294);let a=e=>{let{children:s}=e;return(0,r.jsx)("p",{className:"mb-6 bg-red-500/[.2] rounded-md p-4",children:s})};s.Z=a}}]);