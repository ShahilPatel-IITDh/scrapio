"object"!==typeof phx.tcf&&(phx.tcf={});
(function(c){function a(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&!0===a[c]&&b.push(c);return","+b+","}var b="",e="",f=",,",n=",,",h=",,",w="";phx.tcf.triggerCollection=function(){c&&(c("getTCString",2,function(a){b=a}),c("getPermission",2,function(a){e=a?"1":"0"},"googleAc"),c("getTCData",2,function(b){""!==b.tcString&&(n=a(b.publisher.consents),f=a(b.purpose.consents),h=a(b.specialFeatureOptins))}),c("getTCFVersion",2,function(a){w=a}))};phx.tcf.getTcfData=function(){return{tcString:b,acString:e,
publisher:n,purpose:f,special:h,version:w}}})(window.__tcfapi);"object"!==typeof phx.iac&&(phx.iac={});
(function(c,a,b,e,f){function n(){try{return a.isConnected()}catch(d){return!1}}function h(){return K.hasClass("page-startpage")}function w(d){return"string"===typeof d&&32===d.length}function J(d,a,b){F=(new Date).getTime();Wicket.Ajax.post({u:phx.getVar("iac.callbackUrl"),dep:[function(){return d}],bh:[function(){x="initializing"}],bsh:[function(){x="running"}],sh:[function(){x="succeeded"}],fh:[function(d,q){x="failed;cause:"+q;c(document).trigger(e.IAC_USE_CASE_FAILED,{usecase:a,timezone:b})}]})}
function m(){return"function"==typeof c.cookie&&c.cookie("phx.iac.debug")}function t(d,a,b){m()&&console.log("mailer says: handleUsecase",arguments);var q=(new Date).getTimezoneOffset(),k=[{name:"usecase",value:encodeURIComponent(d)},{name:"sender",value:encodeURIComponent(a)}];h()&&(Q(k,q),c(document).trigger(e.IAC_RESET_FALLBACK_TIMEOUT));L(k,b);y(function(){return J(k,d,q)},function(){k.push({name:"permissionsNotUpdated",value:!0});return J(k,d,q)},0)}function Q(a,b){var d=f.getTcfData();a.push({name:"screenWidth",
value:encodeURIComponent(screen.width)});a.push({name:"screenHeight",value:encodeURIComponent(screen.height)});a.push({name:"utcOffset",value:b});a.push({name:"tcString",value:d.tcString});a.push({name:"acString",value:d.acString});a.push({name:"tcfPublisher",value:d.publisher});a.push({name:"tcfPurpose",value:d.purpose});a.push({name:"tcfSpecial",value:d.special});a.push({name:"tcfVersion",value:d.version})}function L(a,b){"object"===typeof b?Object.keys(b).forEach(function(d){a.push({name:d,value:encodeURIComponent(b[d])})}):
a.push({name:"arg",value:encodeURIComponent(b)})}function y(a,b,c){phx.getVar("useLPS")&&h()&&!u&&40>c?window.setTimeout(function(){y(a,b,++c)},50):phx.getVar("useLPS")&&h()&&!u&&20<=c?b():a()}function g(a){return function(b,d){t(a,b,d)}}function C(a){return function(b,d){d="object"===typeof d?JSON.stringify(d):d;t(a,b,d)}}function D(a,b){var d=h()?"application_bootstrap":"open_mail";E||t(d,a,b);E&&phx.statistics&&phx.statistics.trackLastPageImpressionAgain()}function G(a,b){m()&&console.log("mailer says: onPermissionsUpdated",
b);b&&b.permissions&&b.permissions.data&&(b=b.permissions.data.map(function(a){return{usecase:a.usecase,status:a.status}}),b={permissions:JSON.stringify(b)},t("permissions_updated",a,b),u=!0)}function M(){a.listen(b.EVENT,"onrestart",g("onrestart"));a.listen(b.EVENT,"onblur",function(){phx.event.publish(e.APPLICATION_BLUR)});a.listen(b.EVENT,"onresumefocus",function(){E=!1;phx.event.publish(e.APPLICATION_RESUME_FOCUS)});a.listen(b.EVENT,"ondisabled",function(){phx.event.publish(e.APP_DISABLED)});
a.listen(b.EVENT,"onenabled",function(){phx.event.publish(e.APP_ENABLED)});h()||a.listen(b.EVENT,"onfocus",function(a,b){E=!0;t("onfocus",a,b)})}function R(){m()&&console.log("mailer says: IAC client connected");var a,b;if(b=v.length){try{for(a=0;a<b;a++){var c=v[a];c.method(c.usecase,c.payload)}}catch(O){}v=[]}}function p(){return w(z)?(z!==c.cookie("iac_token")&&c.cookie("iac_token",z,{secure:"https:"===document.location.protocol,path:"/"}),z):w(c.cookie("iac_token"))?c.cookie("iac_token"):null}
function H(b,c){m()&&console.log("jump",arguments);n()?c?a.createUsecase(b,c).send():a.createUsecase(b).send():v.push({method:H,usecase:b,payload:c})}function I(b,c){m()&&console.log("mailer says: calling IAC notify",arguments);n()?c?a.createUsecase(b,c).asRPE().send():a.createUsecase(b).asRPE().send():v.push({method:I,usecase:b,payload:c})}var K=c("html"),z=phx.vars["iac.token"],N=phx.vars["iac.serviceId"],v=[],E=!1,x="unknown",F=0,u=!1;window.addEventListener("message",function(a){h()||"postMessageFallback"!==
a.data||window.parent.postMessage("stopPostMessageFallback","*")},!1);phx.iac.openNewsletter=function(a,b,g,e){phx.iac.jump("open_goto_feature",{goto_feature:b,mediacode:g,data:e});c.get(a)};phx.iac.handleUseCase=t;phx.iac.getExecutionInfo=function(){var a=(new Date).getTime()-F;return"connected:"+n()+";status:"+x+";interval:"+a};phx.iac.notify=I;phx.iac.jump=H;if("object"===typeof nx&&window.top!==window.self)var A=!0;else K.removeClass("iac"),A=!1;A&&(m()&&console.log("mailer says: initializing IAC client"),
window.parent.postMessage("iacClientInit","*"),a.init({appname:N||"mail",context_token:p()}),a.listen(b.USECASE,"mail_compose",g("mail_compose")),a.listen(b.USECASE,"mail_compose_encrypted",g("mail_compose_encrypted")),a.listen(b.USECASE,"mail_read",g("mail_read")),a.listen(b.USECASE,"mail_reply",g("mail_reply")),a.listen(b.USECASE,"new_mail",g("new_mail")),a.listen(b.USECASE,"inbox_friends_sort_unread",g("inbox_friends_sort_unread")),a.listen(b.USECASE,"inbox_unread",g("inbox_unread")),a.listen(b.USECASE,
"inbox_spam",g("inbox_spam")),a.listen(b.USECASE,"inbox_unbekannt_sort_unread",g("inbox_unbekannt_sort_unread")),a.listen(b.USECASE,"inbox_shopping",g("inbox_shopping")),a.listen(b.USECASE,"inbox_newsletter",g("inbox_newsletter")),a.listen(b.USECASE,"inbox_social_media",g("inbox_social_media")),a.listen(b.USECASE,"search_mails",g("search_mails")),a.listen(b.USECASE,"show_mail_folder",g("show_mail_folder")),a.listen(b.USECASE,"show_favorite_mails",g("show_favorite_mails")),a.listen(b.USECASE,"mail_open_contracts",
g("mail_open_contracts")),a.listen(b.USECASE,"settings_mailcollector",g("settings_mailcollector")),a.listen(b.USECASE,"settings_spam",g("settings_spam")),a.listen(b.USECASE,"settings_mail_folder_overview",g("settings_mail_folder_overview")),a.listen(b.USECASE,"settings_returnaddress",g("settings_returnaddress")),a.listen(b.USECASE,"settings_pop3imap",g("settings_pop3imap")),a.listen(b.USECASE,"settings_signature",g("settings_signature")),a.listen(b.USECASE,"settings_encryption",g("settings_encryption")),
a.listen(b.USECASE,"settings_smartinbox",g("settings_smartinbox")),a.listen(b.USECASE,"settings_reclassify",g("settings_reclassify")),a.listen(b.USECASE,"settings_filterrules",g("settings_filterrules")),a.listen(b.USECASE,"attachment_saved_to_cloud",g("attachment_saved_to_cloud")),a.listen(b.USECASE,"attachment_added_from_cloud",C("attachment_added_from_cloud")),a.listen(b.USECASE,"new_mail_with_attachments",C("new_mail_with_attachments")),a.listen(b.USECASE,"theme_switched",C("theme_switched")),
a.listen(b.USECASE,"permissions_updated",G),a.listen(b.USECASE,"open_mail",D),a.listen(b.USECASE,"twsp_deactivation_layer_closed",g("twsp_deactivation_layer_closed")),M(),window.parent.postMessage("iacClientConnect","*"),a.connect(R));phx.getVar("useLPS")&&h()?I("permissions_sync",null):m()&&(console.log("mailer says: NOT calling IAC notify for permissions_sync",phx.getVar("useLPS"),h()),console.log("mailer says: current html classes:",document.getElementById("html-tag").classList));h()&&f&&f.triggerCollection();
m()&&(phx.iac.onPermissionsUpdated=G,phx.iac.onOpenMailUsecase=D)})(jQuery,nx.iac.Client,nx.iac.type,phx.events,phx.tcf);(function(c,a,b,e,f){function n(a){return(a=document.documentElement.className.match(new RegExp(a+"-?(\\d+)")))?parseInt(a[1]):0}function h(a,b,c){if(a&&a.parentNode){var l=+a.parentNode.getAttribute("data-maxwidth");c=c||a.parentNode.getAttribute("data-type");l<b.width&&(b.width=l);B[c].resize(b,a);O.trigger("advertisement.resize")}}function w(a){"300xfull"===a||"300x100%"===a?a={width:300,height:"100%"}:(a=a.split("x"),a={width:parseInt(a[0]),height:parseInt(a[1])});h(this,a)}function J(b,c){c&&
(c=d.params({id:c,url:a.eic.getEicClientUrl()}),b=a.eic.generateUrl(b,c));return b}function m(a){var b=[];a=Math.max.apply(Math,a.map(function(a){return a.width}));b.push("wi="+A);b.push("prf%5Bmaxwidth%5D="+a);(a=y())&&b.push("prf%5Btdid%5D="+a);return b.join("&")}function t(a,b){var c=[];-1!==b&&c.push("viewwidth="+b);a.map(function(a){c.push("adsize="+a.width+"x"+a.height)});c.push("tile="+A);c.push("transactionid="+A);return c.join("&")}function Q(a,c,d){a=a.attr("data-url-params");c=b.useExternalAdServerForBanners?
m(c):phx.vars.useMailintCommercialParams?"adsize="+c.map(function(a){return a.width+"x"+a.height}).join(","):t(c,d);return a?a+"&"+c:c}function L(a){return k.hasClass("can-have-"+a)&&!k.hasClass("no-"+a)}function y(){return c(".mail-head-data, webmailer-mail-detail").filter(":visible").attr("data-trusted-dialog-id")}function g(a,b){var c=J(b,a.attr("data-eic-id"));q||window.requestAnimationFrame(function(){return a.attr("src",c)})}function C(a,b,d){a=c("<iframe ></iframe>",{frameborder:0,scrolling:"no",
"class":d,name:a,fetchPriority:"low"});a.css(b);return a}function D(){c("iframe.adframe, iframe.abiframe").each(function(a,c){c.src=b.blankUrl})}function G(a,c,d){k.hasClass(c)&&(k.removeClass(c),a&&("sky"===d&&h(a,u,d),a.src=b.blankUrl),M())}function M(){f.publish(e.FORCE_CLUSTERING);window.setTimeout(function(){f.publish(e.DOMCHANGE,{refreshCaches:!0})},0)}function R(a,b){var l=c(a);a=l.data("timerId");window.clearTimeout(a);a=l.data("timestamp")||0;a=Date.now()-a;a=window.setTimeout(function(){if(L(b)){var a=
"adframe";l.hasClass("abi")&&(a="abiframe");var e=l.children("iframe");var f=n(b);var r=B[b].getAdSizes(f);f=r[r.length-1]||u;var k=B[b].getViewWidth(n(b));f.width&&f.height?(r=Q(l,r,k),"sky"===b&&y()&&(f=u),0===e.length?(a=C(r,f,a),a.prependTo(l)):(a=C(r,f,a),e.replaceWith(a)),f=e.get(0),e=a.get(0),f=d.frames.indexOf(f),0<=f?(r=f,d.frames[f]=e):(r=d.frames.length,d.frames.push(e)),c(e).attr("data-eic-id",r),e=a):(h(e.get(0),f,b),e=null);a=l.attr("data-url");g(e,a);l.data("timestamp",Date.now());
O.trigger("advertisement.shown")}},Math.max(0,3E3-a));l.data("timerId",a)}function p(){var a=c(".ad, .abi");H(a)}function H(d){"function"==typeof c.cookie&&c.cookie("phx.iac.debug")&&console.trace("updating ads",d);A=a.getRandomInt(1E8,999999999).toString(10);d.each(function(a,d){a:{a=d.getAttribute("data-type");var e="can-have-"+a,f=d.getElementsByTagName("iframe")[0],l=c(".mail-head-area, webmailer-mail-detail").filter(":visible").hasClass("trusted-internal-mail"),g="adb"===a&&y();if(l||g||c("#mail-list").hasClass("nma-auto-open"))G(f,
e,a);else if(c(".spa-content-panel-contracts.spa-content-panel__active").length)G(f,e,a);else{if(B[a].available&&!k.hasClass(e)&&(k.addClass(e),"sky"===a&&f&&(e={width:160,height:600},y()&&(e=u),h(f,e,a)),M(),!f))break a;L(a)?R(d,a):f&&(f.src=b.blankUrl)}}})}function I(){window.setTimeout(function(){f.subscribe(e.WICKET_AJAX_DONE,function(a){a=c(a.added).find(".ad, .abi");a.length&&H(a)});f.subscribe(e.APPLICATION_FOCUS,function(){P=!0;p()})},3E3)}function K(){phx.event.subscribe(phx.events.APPLICATION_BLUR,
function(){P=!1;D()})}function z(){c(".ad, .abi").each(function(a,b){a=b.getAttribute("data-type");a=n(a);b.setAttribute("data-maxwidth",a)})}function N(){D();q=!0}function v(){0===c("html.slideshow-visible").length&&(q=!1,p())}function E(){z();p()}function x(){c(document).on("visibilitychange",function(){document.hidden?D():P&&p()})}function F(){if(d){nx.eicJumpTo&&(d.commands.jumpto=nx.eicJumpTo);d.commands.resize=w;d.hasOwnProperty("isListen")&&d.isListen||(d.listen(),d.isListen=!0);for(var a in B)B.hasOwnProperty(a)&&
(B[a].available=k.hasClass("can-have-"+a));z();f.subscribe(e.RESIZE_HANDLED,E);f.subscribe(e.UPDATE_ADS,p);f.subscribe(e.MAIL_SHOWN,p);f.subscribe(e.FOLDER_SWITCH,p);f.subscribe(e.APP_DISABLED,N);f.subscribe(e.APP_ENABLED,v);f.subscribe(e.MODAL_DIALOG_OPEN,N);f.subscribe(e.MODAL_DIALOG_CLOSE,v);I();K();x();p()}}var u={width:0,height:0},A,d=window.com&&window.com.unitedinternet&&window.com.unitedinternet.eic,q=!1,k=c("html"),O=c(document),P=!0,B={sky:{available:!1,resize:function(a,b){var d=c(".section-content");
var g=a.width;c(b).css(a);d.css({"margin-right":g?g+10:0});c(".ad.sky, .abi.sky").css(a);f.publish(e.DOMCHANGE,{target:d,source:"ad.sky"})},getAdSizes:function(a){var b=phx.vars.useMailintCommercialParams?[120,200,300,160]:[120,300,320,160];var c=[];b.forEach(function(b){b<=a&&c.push({height:600,width:b})});return c},getViewWidth:function(a){switch(a){case 120:return 0;case 160:return 1;case 300:return 2;case 320:return 3;default:return-1}}},adb:{available:!1,resize:function(){},getAdSizes:function(){return[{height:90,
width:728}]},getViewWidth:function(){return-1}}};window.onload=function(){k.is(".can-have-sky, .can-have-adb")&&0<c(".ad, .abi").length&&(k.is(".page-htmleditorpage")?f.subscribe(e.EDITOR_LOADED,F):F())}})(jQuery,phx.util,phx.vars,phx.events,phx.event);

