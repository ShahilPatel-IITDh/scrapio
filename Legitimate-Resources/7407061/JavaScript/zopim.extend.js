(function($){var isDebug=false;var isChatLoaded=false,isChatWindowOpened=false;var loadiframe=0,isloadjs=false;var openChat=function(title,strlenth,item){try{$zopim.livechat.window.setTitle(title.replace(' Support','')+' Support');if(!isDebug){if($(".loadchat").length==0){$("body").append('<div class="loadchat" style="position:fixed;width:275px;background:#ffffff;right:4px;z-index:9999999999;height:120px;bottom:0;font-size:17px;color:black;padding:15px;border:1px solid #b1adad;border-radius:3px;line-height:27px;">Connecting to online customer service,please wait<br/><p style="text-align:center;font-weight:bold;">...</p></div>');strlenth=".";}
if($("iframe[data-test-id='ChatWidgetMobileWindow']").length==0&&loadiframe<10){loadiframe+=1;throw "loadifrme";}
$(".loadchat").hide();}
$zopim.livechat.departments.clearVisitorDepartment();$zopim.livechat.departments.setVisitorDepartment(title);$zopim.livechat.window.show();if(isChatLoaded){return false;}
startMonitor(item);isChatLoaded=true;}catch(e){if(strlenth!=null){$(".loadchat p").text(strlenth);if(strlenth.length==6){strlenth="";}
strlenth+=".";}
setTimeout(function(){openChat(title,strlenth,item)},300);}};var startMonitor=function(item){var a=document.createElement("a");a.href=location.href;var url1="<p>If your fifa coins account order  has issues, to get quick response, please submit questions <a href=\""+a.origin+"/problem\" target=\"_blank\">here</a></p>";var url2="<p> If you want to check your order status or fix your order issues by yourself, Please check <a href =\""+a.origin+"/order\" target=\"_blank\">here</a></p>";var text=url2;var isEnterInner=false;var iframes=$("iframe");for(var i=0;i<iframes.length;i++){var d=null;try{d=iframes[i].contentDocument;}catch(e){continue}
var chatWindow=$(d).find(".container .meshim_widget_widgets_ViewStack:visible");if(chatWindow.length>0&&!isChatWindowOpened){isChatWindowOpened=true;var orderhead=($(".chat-tips").data("orderhead")||"")+"\\d{6,}[a-z\\d]{8,}[a-z\\d_-]*";var queryType=0;var html=$(".chat-tips").prop("outerHTML");$(".chat-tips").remove();var panel=$(html).css({display:'block'});chatWindow.children("div").append(panel);var openChatConfirm=function(target,o,message){var t2=$(target).text().trim();var content=decodeURI($(target).data("content"));var c0=$(target).parents(".chat-tips-content:first");if(c0.length>0){t2=c0.siblings("a").text().trim();}else{c0=$(target).siblings(".chat-tips-content:first");}
var menus=[t2];var a1=$(target).parents(".chat-tips-sec:first").siblings("a");if(a1.length>0){menus.push(a1.text().trim());var a0=a1.parents(".chat-tips-sec:first").siblings("a");if(a0.length>0){menus.push(a0.text().trim());var a3=a0.parents(".chat-tips-sec:first").siblings("a");if(a3.length>0){menus.push(a3.text().trim());}}}
menus.reverse();if(!o){var order=c0.find(".orderno,.email");if(order.length>0){var orderno=order.val().trim();if(orderno){menus.push(orderno);$(target).attr("data-orderno",orderno);}}}else{menus.push(o);$(target).attr("data-orderno",o);}
if(message){menus.push(message);}
var chatTips=$(target).parents(".chat-tips");chatTips.siblings("form").find("[name='message']").prop("style","font-style:normal!important;").val(menus.join(" â†’ "));if(content){if(content.indexOf('/')>-1||content.indexOf('http')>-1){window.open(content);}}
if(o){openChatWindow(target);}};var openChatWindow=function(target){var qid=$(target).parents("li[data-id]:first").data("id");var orn=$(target).attr("data-orderno")||"";$.ajax({type:"POST",url:"/order/startChatting",data:{orderno:orn,qid:qid},success:function(data){console.log("start chatting: "+data.status);}});var chatTips=$(target).parents(".chat-tips"),startBtn=$(target).parents(".meshim_widget_widgets_ViewStack").find(".submit.meshim_widget_widgets_ConnAwareSubmit"),dept=$(target).parents(".chat-tips-content").siblings("a:first").attr("data-dept");chatTips.slideUp(300,function(){chatTips.remove();});if(orn){if(orn.indexOf("@")==-1){delCookie('_gachat_email');if(orn.toLowerCase().endsWith("-k")||orn.toLowerCase().endsWith("-s")){dept="Sell To Us Service";}else{dept="Customer Support";}}else{var d=new Date();d.setMonth(d.getMonth()+1);SetCookie("_gachat_email",orn,{expires:d});}}
if(dept){$zopim.livechat.window.setTitle(dept);$zopim.livechat.departments.clearVisitorDepartment();$zopim.livechat.departments.setVisitorDepartment(dept);}
startBtn.trigger("click");};var checkFormat=function(target,check){if(!(target instanceof jQuery)){target=$(target);}
queryType=0;var regEmail=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i);var regOrder=new RegExp(orderhead,"i");var regOrderSell=new RegExp(orderhead+"-[SK]{1,}","i");var cdiv=target.parents(".chat-tips-content:first");var error=cdiv.find("#chat-tips-error");var val=target.val().trim();if(val){var checks=[];if(target.hasClass("email")&&!target.hasClass("orderno")){queryType=1;checks.push(regEmail.test(val));}
if(!target.hasClass("email")&&target.hasClass("orderno")){queryType=2;checks.push(regOrder.test(val));}
if(target.hasClass("email")&&target.hasClass("orderno")){queryType=3;checks.push(regEmail.test(val));checks.push(regOrder.test(val));}
if(checks.length>0){if($.inArray(true,checks)>-1){if(error.length>0){error.remove();}}else{if(error.length==0){cdiv.find(".chat-tips-reply").remove();error=$('<div id="chat-tips-error" style=\"color:red;\">Incorrect format</div>');var b=cdiv.find(":button.back");if(b.length>0){error.insertBefore(b);}
else{cdiv.append(error);}}
if(!check){return false;}}}}else{error.remove();}
return val!="";};$(d).on("click",".chat-confirm .back",function(){$(this).parents(".chat-confirm:first").slideToggle(300);});$(d).on("click",".chat-confirm .chatting,.chat-confirm .chat",function(){var _this=$(this);var flag=true;var values=[];var elements=_this.parents(".chat-tips-content:first").find(".required");for(var i=0;i<elements.length;i++){var e=$(elements[i]);var val=e.val().trim();if(!val||!checkFormat(e,false)){flag=false;e.focus();break;}else{values.push(val);}}
if(elements.length>0){if(flag){if(values[0].indexOf("@")>-1){openChatConfirm(_this,values[0],values[1]);return;}
var qid=_this.parents("li:first").data("id");var cdiv=_this.parents(".chat-tips-content:first");showLoad("");$.ajax({type:"POST",url:"/order/queryChatOrder",data:{orderno:values[0],qid:qid,queryType:3},success:function(data){cdiv.find(".chat-tips-reply").remove();if(data.status>0||!data.message){openChatConfirm(_this,values[0],values[1]);}else{var reply=$('<div class="chat-tips-reply"></div>');reply.html(data.message);reply.insertBefore(cdiv.find(":button.back"));}},complete:function(){closeLoad();}});}}else{if(flag){openChatConfirm(_this);openChatWindow(_this);}}});$(d).on("click","a.level0,a.level1,a.level2,a.open",function(){var t=$(this).siblings("div:first");$(this).parents(".chat-tips-ul:first").find("li>div").not(t).hide();t.slideToggle(300);if($(this).hasClass("open")&&t.is(":visible")){openChatConfirm(this);}});$(d).on("keyup change",".hsint,.email",function(){checkFormat(this,true);});$(d).on("click",".hsbtn",function(){var _this=$(this);var qid=_this.parents("li:first").data("id");var cdiv=_this.parents(".chat-tips-content:first");var input=_this.siblings("input");var orderno=input.val().trim();if(!orderno){input.focus();return;}
if(!checkFormat(input,false)){return;}
if(orderno.indexOf('@')>-1){var reply=$('<div class="chat-tips-reply chat-confirm"></div>');var html='<input class="meshim_widget_widgets_Submit back" type="button" value="Back" />'+
'<input class="meshim_widget_widgets_Submit chat" type = "button" value = "Chatting" data-orderno="'+orderno+'" />';reply.html(html);cdiv.find(".chat-tips-reply").remove();cdiv.append(reply);return;}
showLoad("");$.ajax({type:"POST",url:"/order/queryChatOrder",data:{orderno:orderno,qid:qid,queryType:queryType,querySchema:1},success:function(data){if(_this.data("open")){if(data.status>0){openChatConfirm(cdiv.siblings("a:first"),data.orderno);return;}}
var reply=$('<div class="chat-tips-reply"></div>');switch(data.status){case 0:if(data.message){reply.html(data.message);}else{openChatConfirm(cdiv.siblings("a:first"),data.orderno);}
break;case 1:openChatConfirm(cdiv.siblings("a:first"),data.orderno);break;case 2:reply.addClass("chat-confirm");reply.html('<input class="meshim_widget_widgets_Submit back" type="button" value="Back" />');reply.html('<input class="meshim_widget_widgets_Submit chat" type = "button" value = "Chatting" data-orderno="'+data.orderno+'" />');window.open(location.origin+"/order/"+data.orderno);break;case 3:reply.html("<span>Error:&nbsp;<em>"+data.message+"</em></span>");break;}
cdiv.find(".chat-tips-reply").remove();cdiv.append(reply);},complete:function(){closeLoad();}});});var defaultItem=$(d).find("[data-default='"+item+"']");if(defaultItem.length>0){defaultItem.trigger("click");}
var emailLast=getCookie('_gachat_email');if(emailLast){$(d).find("input.email").each(function(){$(this).val(emailLast);});}}
var c=$(d).find(".meshim_widget_components_chatWindow_chatPanel_ChatLogContainer");if(c.length==0){c=$(d).find(".chatlog_container")}
if(c.length!=0){var css="<style type=\"text/css\">"+
".chat_banner{position:absolute;background:#ededed;z-index:999999;margin:10px;color:#545454;padding:0 10px 25px;box-shadow:0 1px 5px rgba(0,0,0,.45);border-radius:2px;top:40px;left:-11px;width:100.4%;}"+
".chat_banner a{display:inline-block;height:20px;background:#b73723;padding:0 5px;border-radius:5px;text-decoration:none;line-height:20px;margin:0 0 5px;color:#fff}"+
".chat_banner_close{position:absolute;z-index:100;bottom:5px;right:5%;cursor:coiner;background:#b73723;border-radius:5px;height:20px;width:54px;color:#eee;text-align:center;line-height:20px}"+
".chat_banner_button{position:absolute;z-index:9999999;height:48px;width:66px;text-align:center;right:24px;top:56px;cursor:coiner}"+
".chat_banner p{margin:5px 0;padding:5px;background:#f5e9e9;border-radius:5px;border:1px solid #e1bfbf;line-height:20px}"+
".profile_back{position:absolute;top:12px;right:80px;padding:6px 10px;border-radius:3px;background:#890000;color:#fff;cursor:pointer;}"+
".profile_back:hover{background:#a52828;}"+
"</style>";$(d).find("body").append(css);var left="-11px",width="100.4%";var addBanner=function(){c.prevAll(".chat_banner_button").remove();if(c.prevAll(".chat_banner").length>0){c.prevAll(".chat_banner").show();return}
var animateShowTimer;var banner=$("<div class=\"chat_banner\"><span class=\"chat_banner_close\">Hide</span>"+text+"</div>");banner.mouseover(function(){if(animateShowTimer){clearTimeout(animateShowTimer)}});banner.mouseout(function(){animateShowTimer=setTimeout(animateShow,1000)});c.before(banner);var animateShow=function(){banner.animate({left:"350px",width:"0px",height:banner.outerHeight(),opacity:"hide"},1000,addBannerButton)};var sidebar=getCookie("_gachat_sidebar");if(sidebar==""){animateShowTimer=setTimeout(animateShow,60000);var d=new Date();d.setMinutes(d.getMinutes()+30);SetCookie("_gachat_sidebar","1",{expires:d})}else{banner.hide(0,addBannerButton)}
c.parent().find(".chat_banner_close").click(animateShow)};var addBannerButton=function(){var banner=$(this).unbind("mouseover").unbind("mouseout");var bannerButton22=banner.siblings(".chat_banner_button");var isShow=!banner.is(":hidden")||banner.is(":visible")||banner.css("display")!="none";if(bannerButton22.length>0){if(!isShow){bannerButton22.show()}
return}else if(isShow){banner.hide()}
var bannerButton=$("<div class=\"chat_banner_button\"><img src=\"/images/chatmark.png\" alt=\"\"/></div>");bannerButton.click(function(){$(this).hide();banner.animate({left:left,width:width,opacity:"show"})});banner.after(bannerButton)};addBanner();var viewStack=$(d).find(".jx_ui_ViewStack");if(viewStack.length>0&&$(d).find(".profile_back").length==0){$('<div class="profile_back">End Chat</div>').insertAfter(viewStack);$(d).on("click",".profile_back",function(){var w=$(this).parents(".meshim_widget_components_ChatWindow,.meshim_widget_components_MobileChatWindow");w.find("button.settings,.meshim_widget_widgets_MobileOptionsMenuIcon").trigger("click");setTimeout(function(){var endChatBtn=w.find(".end_chat");if(endChatBtn.length>0){endChatBtn.trigger("click");var timer=setInterval(function(){var messageDivs=w.find(".jx_ui_html_div");for(var i=0;i<messageDivs.length;i++){if($(messageDivs[i]).text().trim()=="Chat ended"){clearInterval(timer);isChatLoaded=false;isChatWindowOpened=false;w.find("div[title='Minimize']:visible").trigger("click");break;}}},200);}},100);});}
isEnterInner=true;}}
if(isDebug){console.log(new Date().toLocaleString()+"\t"+isEnterInner);}
if(!isEnterInner){setTimeout(startMonitor,200);}else if(item){setTimeout(function(){startMonitor(item);},200);}};$.extend($.fn,{showChat:function(title,item){return $(this).click(function(){if(!isloadjs&&!isDebug){window.$zopim||(function(d,s){var z=$zopim=function(c){z._.push(c)},$=z.s=d.createElement(s),e=d.getElementsByTagName(s)[0];z.set=function(o){z.set._.push(o)};z._=[];z.set._=[];$.async=!0;$.setAttribute("charset","utf-8");$.src="https://v2.zopim.com/?4ekbISevzRQdA2sAr9esPEWvuvMUbd01";z.t=+new Date;$.type="text/javascript";e.parentNode.insertBefore($,e);$zopim(function(){$zopim.livechat.cookieLaw.comply();$zopim.livechat.cookieLaw.setDefaultImplicitConsent();});})(document,"script");isloadjs=true;}
openChat(title,null,item);});}});var zlcstore=JSON.parse(localStorage.getItem("__zlcstore")||"{}");for(var prop in zlcstore){var chatDisplay=zlcstore[prop]["ui"]["chat_window"]["display$bool"];if(chatDisplay){zlcstore[prop]["ui"]["chat_window"]["display$bool"]=false;localStorage.setItem("__zlcstore",JSON.stringify(zlcstore));}}})(jQuery);