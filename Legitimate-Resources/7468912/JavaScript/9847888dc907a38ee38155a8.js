(self.webpackChunkweb_fr_portal_20=self.webpackChunkweb_fr_portal_20||[]).push([[9847],{9847:function(t,e,s){"use strict";s(7042),s(7327),s(1539),s(9600),s(9826),s(8674),function(t,e,s){var i="selectability",o=0;function n(e,s){this.$element=t(e),this.options=t.extend({},t.fn[i].defaults,this.$element.data(),s),this._name=i,this.init(),this.$element.trigger("plugin_selectability:ready",this)}t.fn[i]=function(e){var s=arguments;return this.each((function(){t.data(this,"plugin_"+i)?"string"===t.type(e)&&t.data(this,"plugin_"+i)[e].apply(t.data(this,"plugin_"+i),Array.prototype.slice.call(s,1)):t.data(this,"plugin_"+i,new n(this,e))}))},t.fn[i].defaults={KEY_ENTER:13,KEY_SPACE:32,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_ESCAPE:27},n.prototype.instance=function(){return this},n.prototype.init=function(){this.isInputSelect=void 0!==this.$element.attr("data-select-with-input"),this.isFilteredOnLabelOnly=void 0!==this.$element.attr("data-filter-on-label"),this.isFilteredOnStartWith=void 0!==this.$element.attr("data-filter-on-start-with"),this.cssElementClasses=this.$element.attr("class"),this.buildElements(),this.stealLabel(),this.synchronizeAttributes(),this.populateText(),this.registerHandlers(),this.$element.attr("tabindex",-1).removeClass(this.cssElementClasses).addClass("c-select__select")},n.prototype.idGen=function(){var e;do{e="selectability"+o++}while(t("#"+e).length);return e},n.prototype.buildElements=function(){this.buildCombobox(),this.$element.before(this.combobox)},n.prototype.stealLabel=function(){var e=this.$element.attr("id"),s=this.$element.attr("aria-label");if(s)this.combobox.attr("aria-label",s);else if(e){var i=this,o=[];t("label[for]").filter((function(){return t(this).attr("for")===e})).each((function(){var e=t(this),s=i.idGen();e.attr("id",s),o.push(s)})),this.combobox.attr("aria-labelledby",o.join(" "))}},n.prototype.populateText=function(t){if(!t||!t.selectability){var e=this.$element.find(":selected");e.length&&(this.isInputSelect?this.inputbox.value=e.attr("label")||e.text():this.textbox.text(e.attr("label")||e.text()))}},n.prototype.synchronizeAttributes=function(){if(this.$element.prop("multiple"))throw new Error("Can only bind to single selection widgets");this.disabled=!!this.$element.prop("disabled"),this.combobox.addClass(this.disabled?"is-disabled":""),this.combobox.addClass(this.$element.prop("required")?"c-select_required":"")},n.prototype.registerHandlers=function(){this.observeProperties(),this.registerEvents()},n.prototype.observeProperties=function(){var s=t.proxy(this.synchronizeAttributes,this),i=e.MutationObserver||e.MozMutationObserver||e.WebkitMutationObserver;i?(this.observer=new i(s),this.observer.observe(this.$element[0],{attributes:!0,attributeFilter:["multiple","disabled","required"]})):this.$element.on({"propertychange.selectability":s,"focus.selectability":s}),this.$element.on("change",t.proxy(this.populateText,this))},n.prototype.registerEvents=function(){var e=this;this.combobox.on({focusout:function(i){var o=this;setTimeout((function(){t.contains(o,s.activeElement)||e.closeCombobox()}),0)},click:t.proxy(this.comboboxClick,this),keydown:t.proxy(this.comboboxKeydown,this)}),this.listbox.on({mouseover:t.proxy(this.listboxOver,this),click:t.proxy(this.listboxClick,this),keydown:t.proxy(this.listboxKeydown,this)}),this.isInputSelect&&this.inputbox.on({keyup:t.proxy(this.inputboxKeydown,this)}),this.$element.on({change:t.proxy(this.syncWithOriginalSelect,this),clear:t.proxy(this.clearListbox,this)})},n.prototype.comboboxClick=function(){this.disabled||this.toggleCombobox()},n.prototype.comboboxKeydown=function(t){if(!this.disabled)switch(t.which){case this.options.KEY_ENTER:case this.options.KEY_SPACE:if(this.combobox.hasClass("is-expanded"))return this.closeCombobox(),this.combobox.focus(),t.preventDefault(),!1;case this.options.KEY_UP:case this.options.KEY_DOWN:case this.options.KEY_LEFT:case this.options.KEY_RIGHT:return this.combobox.hasClass("is-expanded")||this.openCombobox(),null!=this.optionFocused&&(this.optionFocused.focus(),this.focusActiveOption()),t.preventDefault(),!1;case this.options.KEY_ESCAPE:return this.closeCombobox(),this.combobox.focus(),t.preventDefault(),!1}},n.prototype.listboxOver=function(e){var s=t(e.target);s.hasClass("c-select__option")&&(s.hasClass("is-disabled")||(this.optionFocused=s,this.focusActiveOption()))},n.prototype.listboxClick=function(e){var s=t(e.target);if(s.hasClass("c-select__option")&&!s.hasClass("is-disabled"))return this.select(t(e.target)),this.closeCombobox(),e.preventDefault(),!1},n.prototype.inputboxKeydown=function(t){0===this.inputbox.val().length&&(this.clearListbox(),this.populateListbox()),(t.which>=48&&t.which<=105||229===t.which)&&this.filterListbox(this.inputbox.val())},n.prototype.filterListbox=function(t){var e=this,s=this.$element.children().toArray().filter((function(s){var i=s.textContent.toLowerCase(),o=s.value.toLowerCase(),n=i.indexOf(t.toLowerCase()),l=o.indexOf(t.toLowerCase());return e.isFilteredOnStartWith?0===n||!e.isFilteredOnLabelOnly&&0===l:-1!==n||!e.isFilteredOnLabelOnly&&-1!==l}));this.clearListbox(),this.populateListbox(s)},n.prototype.syncWithOriginalSelect=function(){this.listbox.children().length<=0&&this.populateListbox(),this.isInputSelect&&(this.clearListbox(),this.populateListbox());var t=this.$element.val();if(t!==this.listbox.find(".is-selected").val()){var e,s=this.$element.find('option[value="'+t+'"]');e=s.length>1?s[0].label:s.text(),this.listbox.find(".is-selected").removeClass("is-selected");var i=this.listbox.find(".c-select__option:contains("+e+")").first();this.selected=i,this.optionFocused=i,this.optionFocused.addClass("is-selected"),this.focusActiveOption(),this.isInputSelect?this.inputbox.val(i.attr("label")||i.text()):this.textbox.text(i.attr("label")||i.text())}},n.prototype.clearListbox=function(){this.listbox.empty()},n.prototype.select=function(e){var s=t(e).attr("data-value"),i=this.$element.val(),o=t.Event("change",{val:s,selectability:!0});if(this.$element.val()!==s){this.$element.val(s);try{this.$element.trigger(o)}finally{o.isDefaultPrevented()?this.$element.val(i):(this.selected&&this.selected.removeClass("is-selected"),this.selected=e,this.optionFocused=e,this.optionFocused.addClass("is-selected"),this.focusActiveOption(),this.isInputSelect?this.inputbox.val(e.attr("label")||e.text()):this.textbox.text(e.attr("label")||e.text()))}}else this.isInputSelect&&this.inputbox.val(e.attr("label")||e.text())},n.prototype.listboxKeydown=function(e){switch(e.which){case this.options.KEY_ENTER:case this.options.KEY_SPACE:return this.select(t(e.target)),this.closeCombobox(),this.combobox.focus(),e.preventDefault(),!1;case this.options.KEY_LEFT:case this.options.KEY_UP:return e.preventDefault(),this.moveFocusUp(),!1;case this.options.KEY_RIGHT:case this.options.KEY_DOWN:return e.preventDefault(),this.moveFocusDown(),!1}},n.prototype.toggleCombobox=function(){this.isInputSelect?(this.combobox.hasClass("is-expanded")||(this.openCombobox(),this.optionFocused&&this.optionFocused.focus()),this.inputbox.focus()):this.combobox.hasClass("is-expanded")?this.closeCombobox():(this.openCombobox(),this.optionFocused&&this.optionFocused.focus())},n.prototype.closeCombobox=function(){var t=this;this.textbox.removeClass("is-open"),this.combobox.removeClass("is-expanded"),this.listbox.removeClass("is-open"),this.listboxContainer.removeClass("is-shadowed"),this.listboxContainer.removeClass("is-open"),this.listbox.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",(function(){t.listbox.hasClass("is-open")||t.listboxContainer.removeClass("is-still-open")}))},n.prototype.focusActiveOption=function(){this.previousOptionFocused&&this.previousOptionFocused.removeClass("is-focused"),this.optionFocused&&this.optionFocused.addClass("is-focused"),this.previousOptionFocused=this.optionFocused},n.prototype.openCombobox=function(){this.listbox.children().length<=0&&this.populateListbox(),this.selected&&(this.optionFocused=this.selected),this.focusActiveOption(),this.textbox.addClass("is-open"),this.combobox.addClass("is-expanded"),this.listbox.addClass("is-open"),this.listboxContainer.addClass("is-open"),this.listboxContainer.addClass("is-still-open"),this.listboxContainer.addClass("is-shadowed")},n.prototype.populateListbox=function(e){if(this.populateText(),void 0!==e)var s=e;else s=this.$element.children();var i=function e(s){var i=t("<div></div>"),o=this;return t.each(s,(function(s,n){var l=t("<div></div>");if((n=t(n)).is("option"))l.text(n.attr("label")||n.text()).attr("tabindex",-1).attr("data-value",n.val()).addClass("c-select__option").addClass(n.prop("disabled")?"is-disabled":"is-selectable"),n.val()===o.$element.val()&&(l.addClass("is-selected"),o.selected=l,o.optionFocused=l),l.appendTo(i),n.prop("disabled")?l.removeAttr("tabindex"):n.val()===o.$element.val()&&(o.optionFocused=l);else if(n.is("optgroup")){var a=e.call(o,n.children());if(a.children().length){a.children().length;var h=t('<div class="c-select__heading"></div>').html("<span>"+n.attr("label")+"</span>").addClass("c-select__heading");l.addClass("c-select__optgroup").append(a.prepend(h).children()).appendTo(i)}}})),i}.call(this,s).children();this.listbox.append(i)},n.prototype.moveFocusUp=function(){for(var e=this.listbox.find(".c-select__option"),s=e.index(this.optionFocused[0])-1;s>=0;s--){var i=t(e[s]);if(i.hasClass("is-selectable")){this.optionFocused=i,this.optionFocused.focus(),this.focusActiveOption();break}}},n.prototype.moveFocusDown=function(){for(var e=this.listbox.find(".c-select__option"),s=e.index(this.optionFocused[0])+1;s<e.length;s++){var i=t(e[s]);if(i.hasClass("is-selectable")){this.optionFocused=i,this.optionFocused.focus(),this.focusActiveOption();break}}},n.prototype.buildCombobox=function(){if(this.textbox=t("<div></div>").addClass("c-select__textbox").attr("tabindex",-1),this.isInputSelect){var e=this.$element.children(":selected")[0].textContent||"";this.inputbox=t('<input placeholder="'+e+'" type="text">'),this.textbox.append(this.inputbox)}this.listbox=t("<div></div>").addClass("c-select__listbox").attr("tabindex",-1).append(this.selector),this.combobox=t("<div></div>").addClass(this.cssElementClasses).attr("tabindex",0),this.listboxContainer=t("<div></div>").addClass("c-select__listbox-container").append(this.textbox).append(this.listbox),this.combobox.append(this.listboxContainer)},n.prototype.refresh=function(){this.buildCombobox(),this.$element.prev().replaceWith(this.combobox),this.stealLabel(),this.synchronizeAttributes(),this.populateText(),this.registerHandlers()}}(s(9755),window,document)}}]);