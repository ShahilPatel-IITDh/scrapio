/*! For license information please see foot_trading79ae1494793bcaf35a57.js.LICENSE.txt */
(self.webpackChunkweb_fr_portal_20=self.webpackChunkweb_fr_portal_20||[]).push([[9175],{7019:function(e,t,a){"use strict";var r,n,o;function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e){return e.getClientRects().length?(t=e.getBoundingClientRect(),a=e.ownerDocument.defaultView,{top:t.top+a.pageYOffset,left:t.left+a.pageXOffset}):{top:0,left:0};var t,a}function s(e){var t,a={x:0,y:0};return"touchstart"==e.type||"touchmove"==e.type||"touchend"==e.type?(t=e.touches[0]||e.changedTouches[0],a.x=t.pageX,a.y=t.pageY):(a.x=e.pageX,a.y=e.pageY),a}function c(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4==e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""}function d(e){return e=e.replace(/^rgba?\(|\s+|\)$/g,"").split(","),parseFloat(e[3])}function u(e,t){var a;return e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,a,r){return t+t+a+a+r+r})),a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),"rgba("+parseInt(a[1],16)+","+parseInt(a[2],16)+","+parseInt(a[3],16)+","+t+")"}function h(e,t){return e=""+e,t.substring(0,t.length-e.length)+e}function p(e,t){if(t)return e.toFixed(1)+" %";var a=Math.abs(e);return a>1e3?function(e,t){e=e.toFixed(0)+"";for(var a=/(\d+)(\d{3})/;a.test(e);)e=e.replace(a,"$1 $2");return e}(e):a>100?e.toFixed(1):a>2?e.toFixed(2):e.toFixed(3)}function m(e,t){e+="";var a=parseInt(e.substr(6));return 1==t?h(Math.floor(a/60),"00")+":"+h(a%60,"00"):2==t?e.substring(4,6)+"/"+e.substring(2,4)+"/20"+e.substring(0,2):e.substring(4,6)+"/"+e.substring(2,4)+" "+h(Math.floor(a/60),"00")+":"+h(a%60,"00")}function f(e){return e<60?e+" min":Math.floor(e/60)+"h "+e%60+"min"}function g(e,t){var a=new Date(864e5*e);switch(t){case 1:return h(a.getDate(),"00")+"/"+h(a.getMonth()+1,"00")+"/"+a.getFullYear().toString();case 2:return h(a.getDate(),"00")+"/"+h(a.getMonth()+1,"00")+"/"+a.getFullYear().toString().substring(2,4);case 3:return h(a.getDate(),"00")+"/"+h(a.getMonth()+1,"00");case 4:return h(a.getMonth()+1,"00")+"/"+a.getFullYear().toString()}}function v(e,t){switch(t){case"c":case"o":case"h":case"l":case"v1":return e[t];case"m":return(e.h+e.l)/2;case"m2":return(e.h+e.l+e.c)/3;case"m3":return(e.o+e.h+e.l+e.c)/4;default:return e.c}}a(4916),a(4723),a(7042),a(1539),a(9714),a(3123),a(5306),a(6977),a(658),a(4747),a(7941),a(5438),a(3290),a(561),a(3210),a(2526),a(1817),a(2165),a(6992),a(8783),a(3948),function(){function e(e){for(var t="rgba(255,0,0,1)",a="rgba(0,0,192,1)",r="rgba(0,0,255,1)",n="rgba(61,68,241,0.9)",o="rgba(61,68,241,0.5)",i="rgba(192,0,0,1)",l="rgba(192,0,0,0.9)",s="rgba(192,0,0,0.5)",c="rgba(192,0,0,0.8)",d="rgba(0,0,0,1)",u="rgba(0,140,0,1)",h="rgba(0,128,0,0.5)",p="rgba(0,128,0,0.8)",m="rgba(51,153,102,1)",f="rgba(96,96,96,1)",g=[{type:"actu",params:{},color:s},{type:"evt",params:{},color:s},{type:"evenements",params:{},color:s},{type:"line",color:"rgba(17,66,87,0.9)",color2:"rgba(24, 106, 142,0.8)",params:{c:[lang.l_trace,lang.l_remplis],w:["sw"]}},{type:"line2",color:"rgba(17,66,87,1)",params:{c:[lang.l_trace],w:["sw"]}},{type:"candle",color:"rgba(0,255,0,1)",color2:t,color3:f,params:{c:[lang.l_hausses,lang.l_baisses,lang.l_ombres]}},{type:"mm",color:t,param1:20,params:{p:[lang.l_prd],c:[lang.l_moymobile],w:["sw"]}},{type:"cmoy",color:t,w1:2,params:{c:["Cours moyen"],w:["sw"]}},{type:"barcolor",color:r,color2:t,params:{c:[lang.l_hausses,lang.l_baisses]}},{type:"bar",color:"rgba(17,66,87,1)",params:{c:["Bar Chart"]}},{type:"perf",color:"rgba(17,66,87,0.9)",color2:"rgba(24, 106, 142,0.8)",params:{c:[lang.l_trace,lang.l_remplis],w:["sw"]}},{type:"volume",color:"rgba(3,170,2,0.75)",color2:"rgba(255,0,0,0.75)",params:{c:[lang.l_hausses,lang.l_baisses],w:["o","o"]}},{type:"boll",color:"rgba(244,143,0,0.7)",color2:"rgba(244,143,0,0.15)",param1:20,param2:2,params:{p:[lang.l_prd,lang.l_ec],c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"volumecash",color:"rgba(3,170,2,0.75)",color2:"rgba(255,0,0,0.75)",params:{c:[lang.l_hausses,lang.l_baisses],w:["o","o"]}},{type:"rsi",color:a,param1:14,sh:70,sb:30,params:{c:["RSI"],p:[lang.l_prd],w:["sw"]}},{type:"fr",color:n,color2:o,params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"cmo",color:a,param1:10,sh:50,sb:-50,params:{c:["CMO"],p:[lang.l_prd],w:["sw"]}},{type:"cci",color:a,param1:20,sh:100,sb:-100,params:{c:["CCI"],p:[lang.l_prd],w:["sw"]}},{type:"mom",color:l,color2:s,param1:12,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}},{type:"macd",color:a,color2:i,color3:h,param1:12,param2:26,param3:9,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2","Signal"],c:["MACD","Signal",lang.l_histogram],w:["sw","sw"]}},{type:"sto",color:r,color2:t,param1:14,param2:3,param3:3,sh:9999,sb:9999,params:{p:[lang.l_prd,lang.l_stok,lang.l_stod],c:["%K","%D"],w:["sw","sw"]}},{type:"ichimoku",color:r,color2:"rgba(210,0,0,1)",color3:u,color4:"rgba(64,64,255,1)",color5:"rgba(64,64,255,1)",color6:"rgba(64,64,255,0.3)",param1:26,param2:9,params:{c:["Kijun-Sen","Tenkan-Sen","Chikou-Span","Senkou A","Senkou B","Kumo"],p:["Kijun-Sen","Tenkan-Sen"],w:["sw","sw","sw","sw","sw","o"]}},{type:"phpb",color:u,color2:"rgba(210,0,0,1)",param1:20,params:{c:[lang.l_hausses,lang.l_baisses],p:[lang.l_prd]}},{type:"lineard",param1:30,param2:1,color:d,color2:"rgba(0,128,128,1)",color3:i,params:{p:[lang.l_prd,lang.l_ec],c:[lang.l_droitereg,"Resistance","Support"],w:["w","w","w"]}},{type:"supres",param1:5,color:h,color2:"rgba(255,0,0,0.4)",params:{p:[lang.l_barrep],c:[lang.l_hausses,lang.l_baisses],w:["o","o"]}},{type:"coppock",param1:11,param2:14,param3:10,color:"rgba(0,0,128,0.8)",color2:"rgba(0,0,128,0.3)",params:{p:["ROC 1","ROC2",lang.l_moyenne],c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"compare",color:t,params:{c:["Style"],w:["sw"]}},{type:"pivots",color:"rgba(0,0,0,0.7)",color2:"rgba(255,0,0,0.7)",color3:"rgba(0,128,0,0.7)",params:{c:["Pivot","Supports","Resistances"]}},{type:"zig zag",color:t,param1:3,params:{p:[lang.l_variation],c:["Zig Zag"],w:["sw"]}},{type:"mmp",color:"rgba(180,0,0,1)",param1:15,params:{p:[lang.l_prd],c:[lang.l_moymobp],w:["sw"]}},{type:"mmh",color:"rgba(180,0,0,1)",param1:9,params:{p:[lang.l_prd],c:[lang.l_mmh2],w:["sw"]}},{type:"double EMA",color:t,param1:20,params:{p:[lang.l_prd],c:["Double EMA"],w:["sw"]}},{type:"triple EMA",color:r,param1:20,params:{p:[lang.l_prd],c:["Triple EMA"],w:["sw"]}},{type:"alligator",color:r,color2:t,color3:u,param1:13,param2:8,param3:5,params:{p:["Jaw","Teeth","Lips"],c:["Jaw","Teeth","Lips"],w:["sw","sw","sw"]}},{type:"mme",color:r,param1:30,params:{p:[lang.l_prd],c:[lang.l_moymobe],w:["sw"]}},{type:"mmt",color:r,param1:20,params:{p:[lang.l_prd],c:[lang.l_moymobt],w:["sw"]}},{type:"evmm",color:"rgba(192,0,0,0.7)",color2:"rgba(192,0,0,0.15)",param1:20,param2:2,params:{p:[lang.l_prd,lang.l_ecart],c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"donchian",color:"rgba(0,128,0,0.7)",color2:"rgba(0,128,0,0.15)",param1:20,params:{p:[lang.l_prd],c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"gmma",color:u,color2:i,params:{c:["Fast","Slow"],w:["sw","sw"]}},{type:"supertrend",color:i,color2:u,param1:10,param2:3,params:{p:[lang.l_prd,lang.l_coeff],c:["Resistance","Support"],w:["w","w"]}},{type:"keltner",color:"rgba(0,128,0,0.7)",color2:"rgba(0,128,0,0.20)",param1:20,param2:2,param3:10,params:{p:[lang.l_prd,lang.l_ecart2,lang.l_atrperiod],c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"heikin ashi",color:m,color2:"rgba(255,64,64,1)",color3:f,params:{c:[lang.l_hausses,lang.l_baisses,lang.l_ombres]}},{type:"renko",color:m,color2:t,color3:f,params:{p:[lang.l_tboite],c:[lang.l_hausses,lang.l_baisses,lang.l_border]},nolinearX:!0},{type:"point figure",color:m,color2:t,param2:3,params:{p:["Box","Reverse"],c:[lang.l_hausses,lang.l_baisses]},nolinearX:!0},{type:"kagi",color:"rgba(51,102,255,1)",color2:"rgba(255,64,64,1)",params:{p:[lang.l_tboite],c:["Yang","Yin"]},nolinearX:!0},{type:"equivolume",color:"rgba(51,102,255,1)",color2:"rgba(255,64,64,1)",params:{c:[lang.l_hausses,lang.l_baisses]},nolinearX:!0},{type:"line break",color:m,color2:t,color3:f,params:{p:[lang.l_lines],c:[lang.l_hausses,lang.l_baisses,lang.l_border]},nolinearX:!0},{type:"hollow",color:"rgba(7,103,69,1)",color2:t,color3:f,params:{c:[lang.l_hausses,lang.l_baisses,lang.l_ombres]}},{type:"accDist",color:l,color2:s,params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"obv",color:n,color2:o,params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"forceindex",color:n,color2:o,param1:13,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}},{type:"ulcer",color:r,param1:14,params:{c:["Ulcer Index"],p:[lang.l_prd],w:["sw"]}},{type:"perfi",color:n,color2:o,params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"kvo",color:"rgba(0,0,128,1)",color2:u,params:{c:["KVO","Signal"],w:["sw","sw"]}},{type:"ultimate",color:a,param1:7,param2:14,param3:28,sh:70,sb:30,params:{c:["Ultimate Osc."],p:[lang.l_mm2+" 1",lang.l_mm2+" 2",lang.l_mm2+" 3"],w:["sw"]}},{type:"bollb",color:a,param1:20,sh:100,sb:0,params:{c:["Bollinger %B"],p:[lang.l_prd],w:["sw"]}},{type:"bollw",color:"rgba(255,102,0,1)",param1:20,param2:2,params:{c:[lang.l_trace],p:[lang.l_prd,lang.l_ec],w:["sw"]}},{type:"atr",color:a,param1:14,params:{c:["ATR"],p:[lang.l_prd],w:["sw"]}},{type:"eom",color:l,color2:s,param1:14,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}},{type:"cmf",color:l,color2:s,param1:21,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}},{type:"dpo",color:l,color2:s,param1:20,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}},{type:"asi",color:l,color2:"rgba(192,0,0,0.4)",params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"nvi",color:i,params:{c:["NVI"],w:["sw"]}},{type:"pvi",color:a,params:{c:["PVI"],w:["sw"]}},{type:"macdzl",color:a,color2:i,color3:h,param1:12,param2:26,param3:9,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2","Signal"],c:["MACD Zéro Lag","Signal",lang.l_histogram],w:["sw","sw"]}},{type:"wto",color:a,color2:i,color3:h,param1:10,param2:21,sh:60,sb:-60,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2"],c:["Wave Trend Osc","Signal",lang.l_histogram],w:["sw","sw"]}},{type:"macdh",color:"rgba(0,0,192,0.8)",color2:c,param1:12,param2:26,param3:9,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2","Signal"],c:["MACD > Signal","MACD < Signal"]}},{type:"awesome",color:p,color2:c,param1:5,param2:34,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2"],c:[lang.l_ascend,lang.l_descend]}},{type:"bop",color:p,color2:c,color3:"rgba(128,128,128,0.8)",params:{c:[lang.l_acheteur,lang.l_vendeur,lang.l_neutre]}},{type:"qstick",color:p,color2:c,param1:5,params:{p:[lang.l_prd],c:[lang.l_hausses,lang.l_baisses]}},{type:"elderbear",color:i,color2:i,param1:13,params:{p:[lang.l_prd],c:[lang.l_hausses,lang.l_baisses]}},{type:"elderbull",color:u,color2:u,param1:13,params:{p:[lang.l_prd],c:[lang.l_hausses,lang.l_baisses]}},{type:"dmi",color:u,color2:i,color3:d,param1:14,params:{p:[lang.l_prd],c:["DI+","DI-","ADX"],w:["sw","sw","sw"]}},{type:"aroon",color:u,color2:i,param1:14,params:{p:[lang.l_prd],c:["Aroon up","Aroon down"],w:["sw","sw"]}},{type:"adx",color:d,color2:i,param1:14,sh:9999,sb:9999,params:{p:[lang.l_prd],c:["ADX","ADXR"],w:["sw","sw"]}},{type:"vortex",color:u,color2:i,param1:14,params:{p:[lang.l_prd],c:["+VI","-VI"],w:["sw","sw"]}},{type:"roc",color:a,param1:10,sh:9999,sb:9999,params:{c:["Rate of change"],p:[lang.l_prd],w:["sw"]}},{type:"std",color:a,param1:10,params:{c:["Std Deviation"],p:[lang.l_prd],w:["sw"]}},{type:"di",color:r,param1:10,params:{c:["Demand Index"],p:[lang.l_prd],w:["sw"]}},{type:"sto rsi",color:r,color2:t,param1:14,param2:3,param3:3,param4:14,sh:80,sb:20,params:{p:[lang.l_prd+" Sto.",lang.l_stok,lang.l_stod,lang.l_prd+" RSI"],c:["%K","%D"],w:["sw","sw"]}},{type:"smi",color:"rgba(128,128,128,1)",color2:t,param1:14,param2:3,param3:5,param4:3,sh:9999,sb:9999,params:{p:[lang.l_prd,lang.l_lissage+" 1",lang.l_lissage+" 2","Signal"],c:[lang.l_stochastic,"Signal"],w:["sw","sw"]}},{type:"tsi",color:d,color2:t,param1:25,param2:13,param3:13,sh:9999,sb:9999,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2","Signal"],c:["True Strength","Signal"],w:["sw","sw"]}},{type:"kst",color:r,color2:t,param1:10,param2:15,param3:20,param4:30,params:{p:["ROC 1","ROC 2","ROC 3","ROC 4"],c:["KST","Signal"],w:["sw","sw"]}},{type:"trix",color:a,param1:12,params:{c:["TRIX"],p:[lang.l_prd],w:["sw"]}},{type:"mass index",color:a,param1:25,params:{c:["Mass Index"],p:[lang.l_prd],w:["sw"]}},{type:"vroc",color:a,param1:10,params:{c:["Volume ROC"],p:[lang.l_prd],w:["sw"]}},{type:"moonphase",color:"rgba(255,153,0,0.9)",color2:"rgba(255,204,0,0.5)",params:{c:[lang.l_trace,lang.l_remplis],w:["sw"]}},{type:"ac will",color:"rgba(61,68,241,0.9)",color2:"rgba(61,68,241,0.5)",params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"will r",color:i,param1:14,sh:-20,sb:-80,params:{c:["Williams %R"],p:[lang.l_prd],w:["sw"]}},{type:"mfi",color:i,param1:14,sh:80,sb:20,params:{c:["Money flow idx"],p:[lang.l_prd],w:["sw"]}},{type:"sar",color:"rgba(210,0,0,1)",color2:u,param1:.02,param2:.2,params:{c:[lang.l_baisses,lang.l_hausses],p:[lang.l_accel]}},{type:"linearc",color:"rgba(255,0,255,1)",param1:10,params:{c:[lang.l_lineareg],p:[lang.l_prd],w:["sw"]}},{type:"linearo",color:l,color2:s,param1:10,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}}],v=g.length,y=0;y<v;y++)if(g[y].type==e)return g[y]}function t(){for(var e,a=1;a<arguments.length;a++)for(e in arguments[a])arguments[a].hasOwnProperty(e)&&("object"==i(arguments[0][e])&&"object"==i(arguments[a][e])?t(arguments[0][e],arguments[a][e]):arguments[0][e]=arguments[a][e]);return arguments[0]}function a(e){return(e=e.replace(/'/g,"%27")).replace(/"/g,"%22")}function r(){var e="test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}function o(e){try{return JSON.parse(JSON.stringify(e))}catch(e){}}function y(e,t,a){var r,n=e.QuoteTab,o=0,i=999999,l=n.length;for(t||(t=0),a?a>l&&(a=l):a=l,r=t;r<a;r++)n[r].h>o&&(o=n[r].h),n[r].l<i&&(i=n[r].l);return e.High=o,e.Low=i,e}var b,x;Math.log10=Math.log10||function(e){return Math.log(e)/Math.LN10},b=new function(){this.gi=function(e){return document.getElementById(e)},this.qsa=function(e){return document.querySelectorAll(e)},this.qs=function(e){return document.querySelector(e)},this.qsga=function(e,t){var a=this.qs(e);if(null!=a)return a.getAttribute(t)},this.idempty=function(e){var t=this.gi(e);null!=t&&(t.innerHTML="")},this.qsaempty=function(e){var t=this.qsa(e);[].forEach.call(t,(function(e){e.innerHTML=""}))},this.clrem=function(e){for(var t,a,r=0;r<e.length;r++)for(a=(t=document.getElementsByClassName(e[r])).item(0);a;)a.parentNode.removeChild(a),a=t.item(0)},this.idrem=function(e){var t=this.gi(e);null!=t&&t.parentNode.removeChild(t)},this.qsarem=function(e){var t=this.qsa(e);[].forEach.call(t,(function(e){e.parentNode.removeChild(e)}))},this.qsarclass=function(e,t){var a=this.qsa(e);[].forEach.call(a,(function(e){e.classList.remove(t)}))},this.qsaaclass=function(e,t){var a=this.qsa(e);[].forEach.call(a,(function(e){e.classList.add(t)}))},this.clcss=function(e,t,a){for(var r=document.getElementsByClassName(e),n=0;n<r.length;n++)r[n].style[t]=a},this.idst=function(e,t){var a=this.gi(e);null!=a&&(a.textContent=t)},this.idhtml=function(e,t){var a=this.gi(e);null!=a&&(a.innerHTML=t)},this.idcss=function(e,t,a){var r=this.gi(e);null!=r&&(r.style[t]=a)},this.gigt=function(e){var t=this.gi(e);return null!=t?t.textContent:""},this.qstxt=function(e,t){var a=this.qs(e);null!=a&&(a.textContent=t)},this.qshtml=function(e,t){var a=this.qs(e);null!=a&&(a.innerHTML=t)},this.clhide=function(e){for(var t=document.getElementsByClassName(e),a=0;a<t.length;a++)t[a].style.display="none"}},x=function(x){function w(e){var t="default";switch(e){case"c":t="crosshair";break;case"p":t="pointer";break;case"m":t="move";break;case"n":t="ns-resize";break;case"zi":t="zoom-in";break;default:t="default"}Lr.doc.style.cursor=t}function T(){Nr.tmp1=null,ca(),k()}function C(e){e.preventDefault();var t=l(b.gi(Ke("rodgraph-"))),a=s(e),r=parseInt(a.x-t.left),n=parseInt(a.y-t.top),o=Rr;r<o.innerWidth+o.paddingLeft&&r>o.paddingLeft&&n>o.paddingTop&&n<Dr[0].HeightPx+o.paddingTop&&(Nr.tmp1=r,Lr.doc.addEventListener("mouseup",P),Lr.doc.addEventListener("touchend",P),sa("mouseup",P),sa("touchend",P))}function S(e){var t,a,r;e.preventDefault();var n=l(b.gi(Ke("rodgraph-"))),o=s(e),i=parseInt(o.x-n.left),c=Rr,d=b.gi(Ke("overlay-")),u=d.getContext("2d");if(!Nr.tmp1)return u.strokeStyle=c.set.reticColor,u.clearRect(0,0,d.width,d.height),u.beginPath(),u.moveTo(i+.5,c.paddingTop),u.lineTo(i+.5,Dr[0].HeightPx+c.paddingTop),u.stroke(),t=new la(i,0),u.fillStyle=c.set.reticColor,void u.fillText(c.chartPeriod>=0?g(t.x,1):m(t.x),t.mx,Dr[0].HeightPx+c.paddingTop-3);Nr.tmp2=i,u.fillStyle="rgba(255,106,0,0.3)",u.clearRect(0,0,d.width,d.height),u.fillRect(Nr.tmp1,c.paddingTop,i-Nr.tmp1,Dr[0].HeightPx),a=new la(Math.min(Nr.tmp1,Nr.tmp2),0),r=new la(Math.max(Nr.tmp1,Nr.tmp2),0),u.fillStyle=c.set.reticColor,u.fillText(c.chartPeriod>=0?g(a.x,1):m(a.x),a.mx,Dr[0].HeightPx),u.fillText(c.chartPeriod>=0?g(r.x,1):m(r.x),r.mx,Dr[0].HeightPx+c.paddingTop-3)}function P(e){var t;e.preventDefault();for(var a=new la(Math.min(Nr.tmp1,Nr.tmp2),0),r=new la(Math.max(Nr.tmp1,Nr.tmp2),0),n=Ir.QuoteTab.length,o=0;o<n;o++)if(Ir.QuoteTab[o].d==a.x&&(Hr.minX=o),Ir.QuoteTab[o].d==r.x){Hr.maxX=o;break}(t=b.gi(Ke("overlay-"))).getContext("2d").clearRect(0,0,t.width,t.height),Y(),X(),T(),"function"==typeof extResetTools&&extResetTools()}function k(){var e,t;Nr.eventsActive||((e=b.gi(Ke("overlay-")).getContext("2d")).font=Rr.set.fontSize+"px Arial",e.strokeStyle=Rr.set.reticColor,e.lineWidth=1,e.setLineDash&&e.setLineDash([3]),Nr.lineNumber=999,Nr.cursorState=!1,VGP.noCommand&&b.clrem(["mci-p","closelayericon","eodmovedown","eodmoveup"]),Lr.doc.addEventListener("mousewheel",N),Lr.doc.addEventListener("DOMMouseScroll",N),Lr.doc.addEventListener("mouseleave",E),Lr.doc.addEventListener("touchmove",L),Lr.doc.addEventListener("mousemove",L),Lr.doc.addEventListener("mouseup",D),Lr.doc.addEventListener("touchend",D),Lr.doc.addEventListener("mousedown",I),Lr.doc.addEventListener("touchstart",I),(t=b.gi("indicList"))&&(t.addEventListener("mousedown",R),t.addEventListener("touchstart",R)),Nr.eventsActive=!0)}function M(a,r){var n,o,i,l;for(Rr=t(Rr,a),n=t(n=e(Rr.mainChart.type),Rr.mainChart.typedef),Rr.mainChart.typedef=n,i=Rr.mainChart.indicators.length,o=0;o<i;o++)n=t(n=e(Rr.mainChart.indicators[o].type),Rr.mainChart.indicators[o]),Rr.mainChart.indicators[o]=n;l=Rr.set.fontSize-11,Rr.set.yaxis?(null!=a.paddingRight?Rr.paddingRight+=4*l:Rr.paddingRight=10+4*l,null!=a.paddingLeft?Rr.paddingLeft+=4*l:Rr.paddingLeft=45+4*l):(null!=a.paddingRight?Rr.paddingRight+=4*l:Rr.paddingRight=45+4*l,null!=a.paddingLeft?Rr.paddingLeft+=4*l:Rr.paddingLeft=10+4*l),Rr.paddingTop+=l,Rr.paddingBottom+=l,Rr.innerWidth=Rr.widthGraph-Rr.paddingRight-Rr.paddingLeft,Rr.marginInter=3,Rr.usableHeight=Rr.heightGraph-Rr.paddingTop-Rr.paddingBottom-Rr.indicators.length*Rr.marginInter,Re(r)}function _(e){var t,a,r=e.mainChart.indicators.length;if(null!=e.isCompare&&1!=e.isCompare&&0!=e.isCompare){for(t=0;t<r;t++)"compare"==e.mainChart.indicators[t].type&&(e.mainChart.indicators[t].symbol=e.isCompare,e.isCompare=!0,a=1);a||(e.isCompare=!1)}null==e.isCompare&&(e.isCompare=!1)}function E(){var e,t,a,r,n,o,i,l,s=b.gi(Ke("overlay-"));if(s.getContext("2d").clearRect(0,0,s.width,s.height),!(e=Rr).mainChart.typedef.nolinearX){if(t=0,"perf"!=e.mainChart.type&&(t=Qe(e.chartPeriod<0).toFixed(2)),null!=(a=Dr[0].Bars[0][0])&&(e.chartPeriod<0?(r=Ir.qd).dt=m(a.d,2):(r=Ir.QuoteTab[a.i]).dt=g(a.d,1),r.var=t,e.mainChart.type,"function"==typeof extGetQuotesHover&&extGetQuotesHover(r)),"perf"!=e.mainChart.type)for(o=e.mainChart.indicators.length,n=0;n<o;n++)"lineard"!=(i=e.mainChart.indicators[n].type)&&"pivots"!=i&&"gmma"!=i&&b.qstxt("#mainIndic_"+n+" .value1",V(Dr[0].Bars[n+1][0]));if(null!=a)for(l=Dr.length,n=1;n<l;n++)"volume"!=Dr[n].type&&b.qstxt("#secondIndic_"+n+" .value2",V(Dr[n].Bars[a.d]))}}function V(e){if(null==e)return"";var t,a=e.length,r="";if(null==a)return Math.abs(e)<2?e.toFixed(3):e.toFixed(2);for(t=0;t<a;t++)r=Math.abs(e[t])<2?r+e[t].toFixed(3)+" - ":r+e[t].toFixed(2)+" - ";return r.substring(0,r.length-3)}function L(e){var t,a,r,n,o,i,c,d,u,h,p,f,v,y,x,T,C,S,P,k,M,_,E,L;if(Nr.isPinchZoom)return e.preventDefault(),void(2==e.touches.length&&(t=Math.hypot(e.touches[0].pageX-e.touches[1].pageX,e.touches[0].pageY-e.touches[1].pageY),Nr.distPinchZoom>0&&(t>Nr.distPinchZoom?B(.33):G(.33)),Nr.distPinchZoom=t));if("b"!=Rr.cursor){e.preventDefault();var R,I=l(b.gi(Ke("rodgraph-"))),D=s(e),q=parseInt(D.x-I.left),Y=parseInt(D.y-I.top),N=Rr;if(Nr.moveLayer){if(null==Nr.activeLayer)return;return void function(e,t){var a,r=Dr[t].RealY-e;Dr[t].HeightPx+r<30||Dr[t-1].HeightPx-r<30||(Dr[t].Move(e,r,t),Dr[t].DrawEncadre(),b.idcss(Ke("infoindic-")+t,"top",e+5+"px"),Dr[t-1].Move(Dr[t-1].RealY,-r,t-1),Dr[t-1].DrawEncadre(),1==Nr.activeLayer&&((a=b.gi(Ke("trace-"))).height=a.height-r),$(t))}(Y,Nr.activeLayer)}if(0!=Nr.moveZoomX&&0!=Nr.moveZoomY)return void A(q,Y);if(Nr.isVerticalZoom){var X=(Y-Nr.moveZoomY)*((Hr.maxY-Hr.minY)/N.heightGraph)*2;return Hr.minY=Hr.minY-X,Hr.maxY=Hr.maxY+X,Nr.moveZoomY=Y,void $(0)}if(a=Le(q,Y),"perf"==N.mainChart.type||N.mainChart.typedef.nolinearX||(Nr.lineNumber=H(q,Y,a)),"perf"!=Rr.mainChart.type&&Y>N.paddingTop&&(!N.set.yaxis&&q>N.widthGraph-N.paddingRight||N.set.yaxis&&q<N.paddingLeft))return void w("n");if(n=(r=b.gi(Ke("overlay-"))).getContext("2d"),q<r.width-N.paddingRight&&q>N.paddingLeft&&Y>N.paddingTop&&Y<r.height-N.paddingBottom){if(n.clearRect(0,0,r.width,r.height),null!=a){if(null!=Gr[q]){for(o=N.chartPeriod>=0?g(Gr[q],1):m(Gr[q]),Lr.lastdatehover=o,null!=(i=Dr[0].Bars)[0][Gr[q]]&&(d=0,(c=i[0][Gr[q]].i)>0&&(u=Ir.QuoteTab[c-1+Hr.minX].c,d="perf"==N.mainChart.type?parseFloat(i[0][Gr[q]].c):N.chartPeriod<0?100*(i[0][Gr[q]].c-Ir.qv.c)/Ir.qv.c:100*(i[0][Gr[q]].c-u)/u),d=d.toFixed(2),(h=Ir.QuoteTab[c+Hr.minX]).dt=o,h.var=d,"perf"==N.mainChart.type?i[0][Gr[q]]&&(p=$e(i[0][Gr[q]].c,N.logData)+N.paddingTop):p=$e(h.c,N.logData)+N.paddingTop,Lr.lastCloseHover={x:q,y:p,c:h.c},"function"==typeof extGetQuotesHover&&extGetQuotesHover(h)),Lr.hoverIndics=[],f=Dr.length,R=1;R<f;R++)"volume"!=Dr[R].type&&b.qstxt("#secondIndic_"+R+" .value2",V(Dr[R].Bars[Gr[q]])),v=Dr[R].RealY+Dr[R].V0-Dr[R].PxPointY*Dr[R].Bars[Gr[q]],Lr.hoverIndics.push({x:q,y:v,c:Dr[R].Indicator.color});if("perf"!=N.mainChart.type)for(f=N.mainChart.indicators.length,R=0;R<f;R++)if("lineard"!=(y=N.mainChart.indicators[R].type)&&null!=i[R+1])if(b.qstxt("#mainIndic_"+R+" .value1",V(i[R+1][Gr[q]])),"boll"==y||"keltner"==y||"evmm"==y||"donchian"==y||"ichimoku"==y||"alligator"==y)null!=i[R+1][Gr[q]]&&(null!=(T=i[R+1][Gr[q]])[0]&&(x=$e(T[0],N.logData)+N.paddingTop,Lr.hoverIndics.push({x:q,y:x,c:N.mainChart.indicators[R].color})),null!=T[1]&&(x=$e(T[1],N.logData)+N.paddingTop,"ichimoku"==y||"alligator"==y?Lr.hoverIndics.push({x:q,y:x,c:N.mainChart.indicators[R].color2}):Lr.hoverIndics.push({x:q,y:x,c:N.mainChart.indicators[R].color})),null!=T[2]&&(x=$e(T[2],N.logData)+N.paddingTop,Lr.hoverIndics.push({x:q,y:x,c:N.mainChart.indicators[R].color3})));else if("compare"==y){if(N.mainChart.indicators[R].datas2){var O=Ir.QuoteTab[Hr.minX].c,Q=N.mainChart.indicators[R].datas2.QuoteTab[Hr.minX].c,F=(i[R+1][Gr[q]]-Q)/Q,z=Dr[0].PxPointY*O,U=Math.round((Dr[0].V0-O)*Dr[0].PxPointY);x=$e(Dr[0].V0-(U-F*z)/Dr[0].PxPointY,N.logData)+N.paddingTop,Lr.hoverIndics.push({x:q,y:x,c:N.mainChart.indicators[R].color})}}else x=$e(i[R+1][Gr[q]],N.logData)+N.paddingTop,Lr.hoverIndics.push({x:q,y:x,c:N.mainChart.indicators[R].color})}else q-N.paddingLeft>Br.length-1?(C=Ve(Math.round((q-N.paddingLeft-(Br.length-1))/Dr[0].PxPointX)),o=N.chartPeriod>=0?g(C,1):m(C)):o=Lr.lastdatehover;if(n.fillStyle=N.set.reticColor,Lr.lastCloseHover&&!N.mainChart.typedef.nolinearX&&(n.beginPath(),n.arc(Lr.lastCloseHover.x,Lr.lastCloseHover.y,5,0,2*Math.PI),n.fill()),Lr.lastCloseHover&&(n.beginPath(),S=N.set.fontSize-11,"r"==N.cursor&&Lr.lastCloseHover.x&&(N.isCompare||Rr.mainChart.typedef.nolinearX||(n.moveTo(N.paddingLeft,Lr.lastCloseHover.y+.5),n.lineTo(r.width-N.paddingRight,Lr.lastCloseHover.y+.5)),n.moveTo(Lr.lastCloseHover.x+.5,N.paddingTop),n.lineTo(Lr.lastCloseHover.x+.5,r.height-N.paddingBottom),n.stroke()),(k=q-(P=68+2*S)/2)<N.paddingLeft&&(k=N.paddingLeft),n.fillRect(k,r.height-N.paddingBottom+1,P,N.paddingBottom-1),n.fillRect(k,-2,P,N.paddingTop+2),n.fillStyle=kt(N.set.reticColor),M=Math.round(n.measureText(o).width),n.fillText(o,Math.round(k+(P-M)/2),r.height-6),n.fillText(o,Math.round(k+(P-M)/2),11+S),N.chartPeriod>=0&&!N.isCompare&&!N.mainChart.typedef.nolinearX&&(E=null!=Ir.QuoteTab[Hr.minX]?Ir.QuoteTab[Hr.minX].c:Ir.QuoteTab[0].c,_=100*(Lr.lastCloseHover.c-E)/E,n.fillStyle=_>=0?"#008000":"#fe0000",N.set.yaxis?n.fillRect(0,Lr.lastCloseHover.y-8,N.paddingLeft,17+S):n.fillRect(N.widthGraph-N.paddingRight,Lr.lastCloseHover.y-8,N.paddingRight,18+S)),N.chartPeriod>=0&&!N.isCompare&&!N.mainChart.typedef.nolinearX&&(L=N.set.yaxis?2:r.width-N.paddingRight+5,_=_>0?"+"+_.toFixed(1)+"%":_.toFixed(1)+"%",n.fillStyle="#ffffff",n.fillText(_,L-2,Lr.lastCloseHover.y+5+S))),Lr.hoverIndics)for(R=0;R<Lr.hoverIndics.length;R++)n.fillStyle=Lr.hoverIndics[R].c,n.beginPath(),n.arc(Lr.hoverIndics[R].x,Lr.hoverIndics[R].y,5,0,2*Math.PI),n.fill()}}else n.clearRect(0,0,r.width,r.height);Nr.activeLayer=function(e){for(var t=Dr.length,a=1;a<t;a++)if(e>=Dr[a].RealY-4&&e<=Dr[a].RealY+1)return a;return null}(Y),null!=Nr.activeLayer?(w("n"),Nr.cursorState=!0):Nr.cursorState&&(Nr.cursorState=!1,w())}}function R(e){var t,a,r,n,o,i,l;switch(e.preventDefault(),(t=e.target).className){case"manageind2":Nr.flagSave=!0,It(),$t(null,null,t.parentNode.id.slice(-1));break;case"manageind1":Nr.flagSave=!0,It(),$t(a=(n=t.getAttribute("aria-label").split("_")).length>1?n[1]:null,n[0],null);break;case"closeind1":if(Nr.flagSave=!0,It(),o=(n=t.getAttribute("aria-label").split("_"))[0],a=n[1],Rr.mainChart.indicators.splice(a,1),Dr[0].Bars.splice(parseInt(a)+1,1),"compare"==o){for(i=Rr.mainChart.indicators.length,l=0,r=0;r<i;r++)"compare"==Rr.mainChart.indicators[r].type&&l++;if(0==l)for(Rr.isCompare=!1,r=1;r<Dr.length;r++)"fr"==Dr[r].Indicator.type&&Gt(r)}Rr.newsConfig&&(Nr.fiEvt=[],b.clrem(["svginfofi"])),$(0);break;case"closeind2":Nr.flagSave=!0,It(),Gt(t.parentNode.id.slice(-1))}}function I(e){var t,a,r;if(!Nr.isPinchZoom){if(e.touches&&2==e.touches.length)return Nr.isPinchZoom=!0,void(Nr.distPinchZoom=0);if("b"!=Rr.cursor){if(t=e.target,e.preventDefault(),(a=b.gi(Ke("overlay-"))).getContext("2d").clearRect(0,0,a.width,a.height),"A"!=t.tagName.toUpperCase()&&Ct(),!VGP.noCommand)switch(t.className){case"closelayericon":return e.stopPropagation(),void Gt(t.parentNode.id.slice(-1));case"eodmoveup":return e.stopPropagation(),void jt("up",t);case"eodmovedown":return e.stopPropagation(),void jt("down",t);case"eod_param":case"mci-p":return Nr.flagSave=!0,It(),void $t((r="mci-p"==t.className?t.parentNode.getAttribute("data-name").split("_"):t.getAttribute("data-name").split("_")).length>1?r[1]:null,r[0],null)}if("touchstart"!=e.type||"t"==Rr.cursor)if(999!=Nr.lineNumber)ea(Nr.lineNumber);else{if(Nr.cursorState)return void(Nr.moveLayer=!0);var n=s(e),o=l(b.gi(Ke("rodgraph-"))),i=parseInt(n.x-o.left),c=parseInt(n.y-o.top);if("perf"!=Rr.mainChart.type&&c>Rr.paddingTop&&(!Rr.set.yaxis&&i>Rr.widthGraph-Rr.paddingRight||Rr.set.yaxis&&i<Rr.paddingLeft))return Nr.isVerticalZoom=!0,void(Nr.moveZoomY=c);w("m"),Nr.moveZoomX=i,Nr.moveZoomY=c,Nr.initMaxY=Hr.maxY,Nr.initMinY=Hr.minY,Nr.initViewBegin=Hr.minX,Nr.initViewEnd=Hr.maxX}}}}function D(e){if(Nr.isPinchZoom)Nr.isPinchZoom=!1;else if(Nr.isVerticalZoom)Nr.isVerticalZoom=!1;else{if("touchend"==e.type&&!Rr.mainChart.typedef.nolinearX){var t=e.touches[0]||e.changedTouches[0],a=l(b.gi(Ke("rodgraph-"))),r=parseInt(t.pageX-a.left),n=parseInt(t.pageY-a.top);if(Nr.lineNumber=H(r,n,Le(r,n)),999!=Nr.lineNumber)return void ea(Nr.lineNumber)}Nr.moveLayer=!1,Nr.activeLayer=null,Nr.moveZoomX=0,Nr.moveZoomY=0,w()}}function A(e,t){var a,r,n,o=Nr.initViewBegin,i=t-Nr.moveZoomY,l=i/Dr[0].PxPointY;Math.abs(i)<7&&(l=0),(0!=(a=Math.round((e-Nr.moveZoomX)/Dr[0].PxPointX))||0!=l)&&(r=!0,n=!0,("perf"==Rr.mainChart.type||Rr.set.semilog||t>Dr[0].RealY+Dr[0].HeightPx)&&(l=0),0==l&&(n=!1),Hr.maxY=Nr.initMaxY+l,Hr.minY=Nr.initMinY+l,o-Hr.minX==a&&(r=!1),Br.length<=200&&a<0&&(r=!1),o-a<0&&(r=!1),r&&(Hr.minX=o-a,Hr.maxX=Nr.initViewEnd-a),r||n)&&X(!0)}function H(e,t,a){var r;if(0!=a||Rr.hideTrace)return w(),999;for(var n,o=t-Rr.paddingTop,i=e-Rr.paddingLeft,l=Ar.length,s=0;s<l;s++)switch((n=Ar[s]).type){case"c":if(Tr(i,o,n))return w("p"),s;break;case"t":case"wf":if(Sr(i,o,n))return w("p"),s;break;case"ewi":case"ewc":if(Cr(i,o,n))return w("p"),s;break;case"arrup":case"arrdw":case"arrrt":case"arrlt":case"sm1":case"sm2":if(wr(i,o,n))return w("p"),s;break;default:if(i>=Math.min(n.RealX0,n.RealX1)-2&&i<Math.max(n.RealX0,n.RealX1)+2)switch(n.type){case"r":case"rf":case"m":if(o<(r="rf"==n.type?Math.ceil(n.RealY0+.618*(n.RealY0-n.RealY1)):n.RealY0)+4&&o>r-4||o<n.RealY1+4&&o>n.RealY1-4||i>=n.RealX0-2&&i<=n.RealX0+2||i>=n.RealX1-2&&i<=n.RealX1+2)return w("p"),s;break;case"sr":case"h":if(o>n.RealY0-3&&o<n.RealY0+3)return w("p"),s;break;case"mv":if(o>Math.min(n.RealY0,n.RealY1)-3&&o<Math.max(n.RealY0,n.RealY1)+3)return w("p"),s;break;default:var c=xr(n,i,o),d=i-c.x,u=o-c.y;if(Math.abs(Math.sqrt(d*d+u*u))<5)return w("p"),s}}return w(),999}function B(e){if(null==Ir||0==Br.length||Br[Br.length-1].i<25||Hr.maxX-Hr.minX<25)return!0;var t=Hr.maxX-Hr.minX,a=Math.round((-75e-7*t*t+.025*t+7.8)*e);Hr.minX=Hr.minX+a,Y(),X(!0,!1)}function G(e){var t,a,r;if(null!=Ir){if(t=Hr.maxX-Hr.minX,a=Math.round((-75e-7*t*t+.025*t+7.8)*e),Rr.mainChart.typedef.nolinearX)Hr.minX>0?(Hr.minX=Hr.minX-a,Hr.minX<0&&(Hr.minX=0)):Hr.maxX=Hr.maxX+a,Hr.maxX>Hr.maxNL&&0==Hr.minX&&(Hr.maxX=Hr.maxNL);else if(Hr.minX>0)Hr.minX=Hr.minX-a,Hr.minX<0&&(Hr.minX=0);else if(Hr.maxX=Hr.maxX+a,Hr.maxX>Ir.QuoteTab.length-1)return Hr.maxX=Ir.QuoteTab.length-1,Y(),1!=Rr.histoLength||Rr.set.noVeilleIntra||((r=Ir.qv.c)>Hr.maxY&&(Hr.maxY=r),r<Hr.minY&&(Hr.minY=r)),X(!0,!1),!0;Y(),X(!0,!1)}}function q(e,t,a){var r=Rr,n=new XMLHttpRequest;n.open("POST",VGP.urlWS+"TraceGetSymbol",!0),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.onload=function(){var o,i;if(n.status>=200&&n.status<400){if(null!=(o=JSON.parse(n.responseText))&&null!=o.d){i='"'==o.d.substring(0,1)?o.d.substr(1,o.d.length-2):o.d;try{ke(r.symbol,JSON.parse(i)),VGP.drawings[r.symbol]=1,t&&(Ar=JSON.parse(i),X())}catch(e){Ar=[],localStorage.removeItem(r.symbol),ut(),delete VGP.drawings[r.symbol]}}e&&De(a)}},n.send(JSON.stringify({userid:VGP.userID,symbol:r.symbol}))}function Y(){var e,t=0,a=999999,r=0,n=Hr.minX,o=Hr.maxX,i=Ir.QuoteTab;for(Rr.mainChart.typedef.nolinearX&&(n=0,o=i.length-1),e=n;e<=o;e++)null!=i[e]&&(0==r&&(r=i[e].c),i[e].h>t&&(t=i[e].h),i[e].l<a&&(a=Ir.QuoteTab[e].l));Hr.maxY=t,Hr.minY=a,Rr.isCompare&&Be(t,a,r,n,o)}function N(e){var t=b.gi(Ke("overlay-"));t.getContext("2d").clearRect(0,0,t.width,t.height),((e.wheelDelta||-e.detail)>0?B(1):G(1))||e.preventDefault()}function X(e,t){Ee();var a,r=Dr.length;if(Rr.mainChart.typedef.nolinearX)return Dr[0].DrawEncadre(),_t(t),void He();for(a=0;a<r;a++)Dr[a].DrawEncadre();for(Ge(Ir,!1,e),a=1;a<r;a++)ze(Dr[a]);e||He()}function $(e,t){if(0==e)return Ee(),Dr[0].DrawEncadre(),Rr.mainChart.typedef.nolinearX?_t(t):Ge(Ir),void He();Dr[e-1].DrawEncadre(),Dr[e].DrawEncadre(),e-1==0&&Ge(Ir,!0),ze(Dr[e-1]),ze(Dr[e]),He()}function O(){var e,t;if(!VGP.chartSimple&&((t=(e=b.gi(Ke("trace-"))).getContext("2d")).clearRect(0,0,e.width,e.height),"perf"!=Rr.mainChart.type&&!Rr.hideTrace))for(var a=Ir.QuoteTab[Hr.minX].d,r=Hr.maxX>Ir.QuoteTab.length-1?Ve():Ir.QuoteTab[Hr.maxX].d,n=Ar.length,o=0;o<n;o++)if(null!=Ar[o])switch(Ar[o].type){case"fa":Ar[o].x0<r&&ae(t,Ar[o],a);break;case"t":Ar[o].x0<r&&ee(t,Ar[o],a);break;case"ewi":case"ewc":K(t,Ar[o],a);break;case"gg":case"ga":case"ff":Ar[o].x0<r&&Z(t,Ar[o],a);break;case"wf":te(t,Ar[o],a);break;case"arrup":case"arrdw":case"arrlt":case"arrrt":case"sm1":case"sm2":U(t,Ar[o],a);break;case"af":case"cf":case"an":case"c":case"ef":Z(t,Ar[o],a);break;case"sr":Ar[o].x0<r&&W(t,Ar[o],a);break;case"a":Ar[o].x0<r&&j(t,Ar[o],a);break;case"v":Ar[o].x0<r&&z(t,Ar[o],a);break;case"rf":case"r":case"m":(Ar[o].x1>a||Ar[o].x0>a)&&(Ar[o].x1<r||Ar[o].x0<r)&&J(t,Ar[o],a,r);break;case"h":F(t,Ar[o]);break;default:Ar[o].x1<=a&&Ar[o].x0<=a||Ar[o].x0>r?(Ar[o].RealX0=0,Ar[o].RealX1=0):Z(t,Ar[o],a)}}function Q(e,t,a,r,n){e.RealX0=t,e.RealY0=a,e.RealX1=r,e.RealY1=n}function F(e,t){var a;(a=Rr.set.semilog&&null!=Rr.logData?$e(t.y0,Rr.logData):Math.round((Dr[0].V0-t.y0)*Dr[0].PxPointY))>0&&a<Dr[0].HeightPx&&ve(e,{my:a,y:t.y0},t.style,t.width,t.color,"mg"==t.type?0:t.fontSize,t.type),Q(t,0,a,Rr.innerWidth,a)}function z(e,t,a){var r=new Se(t.x0,t.y0,a);ge(e,r,t.style,t.width,t.color,t.fontSize),Q(t,r.mx,0,r.mx,r.my)}function U(e,t,a){var r=new Se(t.x0,t.y0,a);if(r.mx<0&&(r.mx=0),r.my>0&&r.my<Dr[0].HeightPx)switch(t.type){case"arrup":case"arrdw":case"arrrt":case"arrlt":ie(e,r,t.color,t.type,t.color2,t.width);break;case"sm1":case"sm2":oe(e,r,t.color,t.type,t.width)}Q(t,r.mx,r.my,r.mx,r.my)}function W(e,t,a){var r=new Se(t.x0,t.y0,a);r.mx<0&&(r.mx=0),r.my>0&&r.my<Dr[0].HeightPx&&fe(e,r,t.style,t.width,t.color,t.fontSize),Q(t,r.mx,r.my,Rr.innerWidth,r.my)}function J(e,t,a,r){var n=new Se(t.x0,t.y0,a),o=new Se(t.x1,t.y1,a),i=n.my,l=o.my,s=n.mx,c=o.mx;t.x0<a&&(s=n.mx=0),t.x1>r&&(c=o.mx=Rr.innerWidth),t.x0>r&&(s=n.mx=Rr.innerWidth),t.x1<a&&(c=o.mx=0),Q(t,s,i,c,l),(0!=s||0!=c)&&("rf"==t.type&&Ce(e,t.color,t.color2,n,o,t.width,t.fontSize),("r"==t.type||"m"==t.type)&&Te(e,t.color,t.color2,n,o,t.type,t.h,t.width,t.style,t.fontSize))}function j(e,t,a){var r,n=new Se(t.x0,t.y0,a),o=unescape(t.h);if(e.save(),e.fillStyle=t.color,e.font=(null!=t.fontSize?t.fontSize:12)+"px Arial",r=e.measureText(o).width,n.mx+r<0)return Q(t,0,0,0,0),void e.restore();e.fillText(o,n.mx,n.my+4),e.restore(),Q(t,n.mx,n.my,n.mx+r,n.my)}function Z(e,t,a){var r,n=new Se(t.x0,t.y0,a),o=new Se(t.x1,t.y1,a);switch(t.type){case"ff":ce(e,t.color,t.style,t.width,n,o,t.fontSize);break;case"ga":de(e,t.color,t.style,t.width,n,o,t.fontSize);break;case"gg":ue(e,t.color,t.style,t.width,n,o);break;case"cf":re(e,t.color,t.style,t.width,n,o,0,t.fontSize);break;case"af":pe(e,t.color,t.style,t.width,n,o,t.fontSize);break;case"an":o.mx=he(e,t.color,t.style,t.width,n,o,t.h,t.fontSize);break;case"c":me(e,t.color,t.style,t.width,n,o,t.color2);break;default:r=t.h,"p"==t.type&&(r=Math.round(t.h*Dr[0].PxPointY)),be(e,t.type,t.color,t.style,t.width,r,n,o,t.color2,t.fontSize)}Q(t,n.mx,n.my,o.mx,o.my)}function K(e,t,a,r){for(var n=[],o=t.h.length,i=0;i<o;i++)n.push(new Se(t.h[i].x,t.h[i].y,a,r));le(e,n,t.color,t.width,t.style,t.fontSize),t.h=n}function ee(e,t,a){var r=new Se(t.x0,t.y0,a),n=new Se(t.x1,t.y1,a),o=new Se(t.h.C.x,t.h.C.y,a);se(e,r,n,o,t.color,t.color2,t.width),Q(t,r.mx,r.my,n.mx,n.my),t.h.C=o}function te(e,t,a){var r=new Se(t.x0,t.y0,a),n=new Se(t.x1,t.y1,a),o=new Se(t.h.C.x,t.h.C.y,a);Ta(e,r,n,o,t.color,t.color2,t.width,t.fontSize),Q(t,r.mx,r.my,n.mx,n.my),t.h.C=o}function ae(e,t,a){var r=new Se(t.x0,t.y0,a),n=new Se(t.x1,t.y1,a),o=new Se(t.h.B.x,t.h.B.y,a),i=new Se(t.h.C.x,t.h.C.y,a);ne(e,r,o,i,t.color,t.color2,t.width),Q(t,r.mx,r.my,n.mx,n.my),t.h.B=o,t.h.C=i}function re(e,t,a,r,n,o,i,l){var s,c,d,u,h;for(e.save(),e.strokeStyle=t,e.lineWidth=2,e.beginPath(),e.moveTo(n.mx,n.my),e.lineTo(o.mx,o.my),e.stroke(),s=o.mx-n.mx,c=[0,1,2,3,5,8,13,21,34,55],null!=a&&null!=r?(e.lineWidth=r,br(e,a)):e.lineWidth=1,e.fillStyle=t,e.font=(null!=l?l:12)+"px Arial",e.beginPath(),h=c.length,u=0;u<h;u++)d=n.mx+s*c[u]+.5,e.moveTo(d,0),e.lineTo(d,Dr[i].HeightPx),e.fillText(c[u],d+2,Dr[i].HeightPx-3);e.stroke(),e.restore()}function ne(e,t,a,r,n,o,i){var l,s,c,d;e.save(),e.strokeStyle=n,e.beginPath();var h=a.mx+Math.round((r.mx-a.mx)/2),p=a.my+Math.round((r.my-a.my)/2),m=(t.my-p)/(h-t.mx),f=3e3;return h<t.mx&&(f=-f),l=t.mx+f,s=t.my-f*m,e.lineWidth=null!=i?i:1,e.moveTo(a.mx+f,a.my-f*m),e.lineTo(a.mx,a.my),e.lineTo(r.mx,r.my),e.lineTo(r.mx+f,r.my-f*m),e.fillStyle=u(o,.15),e.fill(),e.moveTo(t.mx,t.my),e.lineTo(l,s),e.stroke(),e.setLineDash&&e.setLineDash([2]),e.beginPath(),c=a.mx+Math.round((h-a.mx)/2),d=a.my+Math.round((p-a.my)/2),e.moveTo(c,d),e.lineTo(c+f,d-f*m),c=h+Math.round((r.mx-h)/2),d=p+Math.round((r.my-p)/2),e.moveTo(c,d),e.lineTo(c+f,d-f*m),e.stroke(),e.restore(),{Dx:l,Dy:s}}function oe(e,t,a,r,n){var o,i,l=10+2*n,s=4+n;e.save(),e.strokeStyle=a,e.beginPath(),e.arc(t.mx,t.my,l,0,2*Math.PI,!1),e.lineWidth=2,e.stroke(),e.beginPath(),o=t.mx-s,i=t.my-s,e.arc(o,i,2,0,2*Math.PI,!1),o=t.mx+s,e.arc(o,i,2,0,2*Math.PI,!1),e.fillStyle=a,e.fill(),e.beginPath(),"sm1"==r?e.arc(t.mx,t.my,l-7,0,Math.PI,!1):e.arc(t.mx,t.my+l/2,l-7,Math.PI,2*Math.PI,!1),e.stroke(),e.restore()}function ie(e,t,a,r,n,o){var i,l;switch(r){case"arrup":case"arrlt":i=8.5+o,l=15.5+2*o;break;case"arrdw":case"arrrt":i=-8.5-o,l=-15.5-2*o}e.save(),e.strokeStyle=a,e.beginPath(),e.moveTo(t.mx,t.my),"arrlt"==r||"arrrt"==r?(e.lineTo(t.mx+i,t.my-6.5-o),e.lineTo(t.mx+i,t.my-1.5-o),e.lineTo(t.mx+l,t.my-1.5-o),e.lineTo(t.mx+l,t.my+1.5+o),e.lineTo(t.mx+i,t.my+1.5+o),e.lineTo(t.mx+i,t.my+6.5+o),e.lineTo(t.mx,t.my)):(e.lineTo(t.mx-6.5-o,t.my+i),e.lineTo(t.mx-1.5-o,t.my+i),e.lineTo(t.mx-1.5-o,t.my+l),e.lineTo(t.mx+1.5+o,t.my+l),e.lineTo(t.mx+1.5+o,t.my+i),e.lineTo(t.mx+6.5+o,t.my+i),e.lineTo(t.mx,t.my)),e.fillStyle=n,e.fill(),e.stroke(),e.restore()}function le(e,t,a,r,n,o){e.save(),e.strokeStyle=a,e.fillStyle=a,e.font=(null!=o?o:14)+"px Arial",null!=n&&null!=r?(e.lineWidth=r,br(e,n)):e.lineWidth=1,e.beginPath(),e.moveTo(t[0].mx,t[0].my);for(var i,l=t.length,s=6==t.length?["1","2","3","4","5"]:["a","b","c"],c=1;c<l;c++)e.lineTo(t[c].mx,t[c].my),i=t[c].my<t[c-1].my?-7:16,e.fillText(s[c-1],t[c].mx-4,t[c].my+i);e.stroke(),e.restore()}function se(e,t,a,r,n,o,i){e.strokeStyle=n,e.lineWidth=null!=i?i:1,e.beginPath(),e.moveTo(t.mx,t.my),e.lineTo(a.mx,a.my),e.lineTo(r.mx,r.my),e.lineTo(t.mx,t.my),e.stroke(),null!=o&&(e.fillStyle=u(o,.15),e.fill())}function ce(e,t,a,r,n,o,i){var l;e.save(),e.strokeStyle=t,e.lineWidth=2,e.beginPath(),e.moveTo(n.mx,n.my),e.lineTo(o.mx,o.my),e.stroke(),null!=a&&null!=r?(e.lineWidth=r,br(e,a)):e.lineWidth=1;var s,c,d,u,h=n.my-o.my,p=1500,m=200,f=[.25,.382,.5,.618,.75],g=["0.25","0.382","0.5","0.618","0.75"];for(e.fillStyle=t,e.font=(null!=i?i:12)+"px Arial",e.beginPath(),l=f.length,d=0;d<l;d++)u=Math.atan(h/f[d]/Math.abs(n.mx-o.mx)),s=n.my-p*Math.sin(u),c=n.mx+p*Math.cos(u),e.moveTo(n.mx,n.my),e.lineTo(c,s),s=n.my-m*Math.sin(u),c=n.mx+m*Math.cos(u),e.fillText(g[d],c,s),u=Math.atan(h*f[d]/Math.abs(n.mx-o.mx)),s=n.my-p*Math.sin(u),c=n.mx+p*Math.cos(u),e.moveTo(n.mx,n.my),e.lineTo(c,s),s=n.my-m*Math.sin(u),c=n.mx+m*Math.cos(u),e.fillText(g[d],c,s);e.stroke(),e.restore()}function de(e,t,a,r,n,o,i){var l;e.save(),e.strokeStyle=t,e.lineWidth=2,e.beginPath(),e.moveTo(n.mx,n.my),e.lineTo(o.mx,o.my),e.stroke(),null!=a&&null!=r?(e.lineWidth=r,br(e,a)):e.lineWidth=1;var s,c,d,u,h=n.my-o.my,p=[8,4,3,2,1,.5,.333,.25,.125],m=["8x1","4x1","3x1","2x1","1x1","1x2","1x3","1x4","1x8"];for(e.fillStyle=t,e.font=(null!=i?i:12)+"px Arial",e.beginPath(),l=p.length,d=0;d<l;d++)u=Math.atan(h/p[d]/Math.abs(n.mx-o.mx)),s=n.my-1500*Math.sin(u),c=n.mx+1500*Math.cos(u),e.moveTo(n.mx,n.my),e.lineTo(c,s),s=n.my-180*Math.sin(u),c=n.mx+180*Math.cos(u),e.fillText(m[d],c,s);e.stroke(),e.restore()}function ue(e,t,a,r,n,o){e.save(),e.strokeStyle=t,e.lineWidth=2,e.beginPath(),e.moveTo(n.mx,n.my),e.lineTo(o.mx,o.my),e.stroke(),null!=a&&null!=r?(e.lineWidth=r,br(e,a)):e.lineWidth=1;var i,l=(n.my-o.my)/Math.abs(n.mx-o.mx),s=n.mx-o.mx>0?-1:1,c=n.my-1500*l,d=n.mx+1500*s,u=2*(n.my-o.my),h=n.my+1500*l;for(e.beginPath(),i=-20;i<20;i++)e.moveTo(n.mx,n.my+u*i),e.lineTo(d,c+u*i),e.moveTo(n.mx,n.my+u*i),e.lineTo(d,h+u*i);e.stroke(),e.restore()}function he(e,t,a,r,n,o,i,l){var s,c;return e.save(),e.strokeStyle=t,e.beginPath(),e.moveTo(n.mx+50,n.my+.5),e.lineTo(n.mx,n.my+.5),e.stroke(),s=!(i>=0),e.beginPath(),e.arc(n.mx,n.my,30,-i,0,s),e.stroke(),c=(n.my-o.my)/Math.tan(i),null!=a&&null!=r?(e.lineWidth=r,br(e,a)):e.lineWidth=1,e.beginPath(),e.moveTo(n.mx,n.my),e.lineTo(n.mx+c,o.my),e.stroke(),e.fillStyle=t,e.font=(null!=l?l:12)+"px Arial",e.fillText((180*i/Math.PI).toFixed(0)+"°",n.mx+55,n.my),e.restore(),n.mx+c}function pe(e,t,a,r,n,o,i){var l,s,c,d,h;e.save();var p=Math.abs(n.mx-o.mx),m=Math.abs(n.my-o.my),f=Math.sqrt(p*p+m*m);for(e.strokeStyle=t,e.beginPath(),e.moveTo(n.mx,n.my),e.lineTo(o.mx,o.my),e.stroke(),null!=a&&null!=r?(e.lineWidth=r,br(e,a)):e.lineWidth=1,e.strokeStyle=u(t,.7),e.fillStyle=t,e.font=(null!=i?i:12)+"px Arial",l=!0,n.y>o.y&&(l=!1),h=(c=[.236,.5,.786,1,1.618,2.618]).length,d=0;d<h;d++)e.beginPath(),e.arc(n.mx,n.my,f*c[d],0,Math.PI,l),e.stroke(),s=l?n.my-f*c[d]-2:n.my+f*c[d]+10,e.fillText(c[d].toFixed(3),n.mx-15,s);e.restore()}function me(e,t,a,r,n,o,i){e.save(),e.beginPath();var l=Math.abs(n.mx-o.mx),s=Math.abs(n.my-o.my);e.translate(n.mx-l,n.my-s),e.scale(l,s),e.arc(1,1,1,0,2*Math.PI,!1),e.restore(),e.save(),e.strokeStyle=t,null!=a&&null!=r?(e.lineWidth=r,br(e,a)):e.lineWidth=1,e.stroke(),null!=i&&(e.fillStyle=u(i,.15),e.fill()),e.restore()}function fe(e,t,a,r,n,o){var i=.5;e.strokeStyle=n,e.save(),null!=a&&null!=r?(e.lineWidth=r,r%2==0&&(i=0),br(e,a)):e.lineWidth=1,e.beginPath(),e.moveTo(t.mx,t.my+i),e.lineTo(Rr.innerWidth,t.my+i),e.stroke(),e.fillStyle=n,e.font=(null!=o?o:12)+"px Arial",e.fillText(t.y.toFixed(2),t.mx+5,t.my-2),e.restore()}function ge(e,t,a,r,n,o){var i,l=.5;e.strokeStyle=n,e.save(),null!=a&&null!=r?(e.lineWidth=r,r%2==0&&(l=0),br(e,a)):e.lineWidth=1,e.beginPath(),e.moveTo(t.mx+l,0),e.lineTo(t.mx+l,Dr[0].HeightPx),e.stroke(),e.fillStyle=n,e.font=(null!=o?o:12)+"px Arial",i=t.mx+3,Rr.innerWidth-t.mx<60&&(i=t.mx-60),Rr.chartPeriod<0?e.fillText(m(t.x),i,Dr[0].HeightPx-2):e.fillText(g(t.x,2),i,Dr[0].HeightPx-2),e.restore()}function ve(e,t,a,r,n,o,i){var l,s,c=.5;if(e.strokeStyle=n,e.save(),null!=a&&null!=r?(e.lineWidth=r,r%2==0&&(c=0),br(e,a)):e.lineWidth=1,e.beginPath(),e.moveTo(0,t.my+c),e.lineTo(Rr.innerWidth,t.my+c),e.stroke(),e.font=(null!=o?o:12)+"px Arial",0!=o&&(e.fillStyle=n,l=t.y,e.fillText(l.toFixed(2),5,t.my-4)),"mg"==i){e.font="12px Arial";var d,u=t.y,h=0,p=0,m=Hr.maxX;for(m>=Ir.QuoteTab.length&&(m=Ir.QuoteTab.length-1),d=Hr.minX;d<=m;d++)Ir.QuoteTab[d].c>=u?h++:p++;s=0!=o?70:5,e.fillStyle="#fe0000",e.fillText((100*p/(h+p)).toFixed(0)+"%",s,t.my+15),e.fillStyle="#008000",e.fillText((100*h/(h+p)).toFixed(0)+"%",s,t.my-4),e.fillStyle="rgba(0,191,0,0.1)",e.fillRect(0,0,Rr.innerWidth,t.my),e.fillStyle="rgba(255,0,0,0.1)",e.fillRect(0,t.my,Rr.innerWidth,9999)}e.restore()}function ye(e,t,a,r,n){e.save(),e.font=(null!=a?a:"12")+"px Arial",e.fillStyle=r;var o=t.mx+e.measureText(n).width;return e.fillText(n,t.mx,t.my+4),e.restore(),Math.round(o)}function be(e,t,a,r,n,o,i,l,s,c){var d,h,p,m,f;return e.save(),br(e,r),e.strokeStyle=a,d=.5,null==n&&(n=1),e.lineWidth=n,n%2==0&&(d=0),e.beginPath(),("mv"==t||"mh"==t)&&(e.font=(null!=c?c:"12")+"px Arial",h=null!=c?parseInt(c)+2:12,e.fillStyle=a),"mv"==t?(e.moveTo(l.mx-10,l.my+.5),e.lineTo(l.mx+10,l.my+.5),e.moveTo(l.mx-10,i.my+.5),e.lineTo(l.mx+10,i.my+.5),l.y<i.y?(e.moveTo(l.mx-8,l.my-8),e.lineTo(l.mx,l.my),e.lineTo(l.mx+8,l.my-8)):(e.moveTo(l.mx-8,l.my+8),e.lineTo(l.mx,l.my+1),e.lineTo(l.mx+8,l.my+8)),e.moveTo(i.mx+.5,i.my),e.lineTo(l.mx+.5,l.my),e.stroke(),p=100*(l.y-i.y)/i.y,m=(l.y-i.y).toFixed(2),f=Math.min(l.my,i.my)+Math.abs((l.my-i.my)/2),e.fillText(m,l.mx+5,f),e.fillText(p.toFixed(2)+"%",l.mx+5,f+h+2),void e.restore()):"mh"==t?(e.moveTo(l.mx+.5,i.my-10),e.lineTo(l.mx+.5,i.my+10),e.moveTo(i.mx+.5,i.my-10),e.lineTo(i.mx+.5,i.my+10),e.moveTo(Math.max(l.mx,i.mx)-8,l.my-8),e.lineTo(Math.max(l.mx,i.mx),l.my),e.lineTo(Math.max(l.mx,i.mx)-8,l.my+8),e.moveTo(i.mx,i.my+.5),e.lineTo(l.mx,l.my+.5),e.stroke(),e.fillText(xe(i.x,l.x),Math.min(l.mx,i.mx)+5,i.my+h),void e.restore()):(e.moveTo(i.mx,i.my+d),e.lineTo(l.mx,l.my+d),"p"==t&&(e.moveTo(i.mx,i.my+o+d),e.lineTo(l.mx,l.my+o+d)),e.stroke(),"p"==t&&null!=s&&(e.moveTo(i.mx,i.my+d),e.lineTo(l.mx,l.my+d),e.lineTo(l.mx,l.my+o+d),e.lineTo(i.mx,i.my+o+d),e.fillStyle=u(s,.15),e.fill()),"ef"==t&&function(e,t,a,r,n,o,i){var l,s,c,d,h,p,m,f,g=s=a.my,v=l=t.my,y=t.mx,b=a.mx,x=t.y,w=a.y,T=Math.max(y,b);for(null==o&&(o=250),y>b&&(g=l,v=s,x=a.y,w=t.y),e.beginPath(),c=v-g,(1==e.lineWidth||3==e.lineWidth)&&(g+=.5),p=(d=[0,.236,.382,.5,.618,1,1.618,2.618]).length,h=0;h<p;h++)e.moveTo(T,g-Math.round(c*d[h])),e.lineTo(T+o,g-Math.round(c*d[h]));for(e.stroke(),null!=n&&(e.fillStyle=u(n,.15),e.fillRect(T,g,o,-Math.round(2.618*c))),g-=3,e.font=(null!=i?i:12)+"px Arial",e.fillStyle=r,h=0;h<p;h++)f=g-Math.round(c*d[h]),m=w+(w-x)*d[h],e.fillText(m.toFixed(2)+"  ("+(100*d[h]).toFixed(1)+"%)",T,f)}(e,i,l,a,s,o,c),"f"==t&&(1==o||null==o?we(e,i.mx,l.mx,i.my,l.my,a,n):we(e,l.mx,i.mx,l.my,i.my,a,n)),void e.restore())}function xe(e,t){var a="";return null!=Dr[0].Bars[0][e]&&null!=Dr[0].Bars[0][t]&&(a=" - "+Math.abs(Dr[0].Bars[0][t].i-Dr[0].Bars[0][e].i)+lang.l_barres),Rr.chartPeriod>=0?Math.abs(e-t)+lang.l_jours+a:""!=a?f(Math.abs((Dr[0].Bars[0][t].i-Dr[0].Bars[0][e].i)*parseInt(Rr.chartPeriod)))+a:f(Math.abs(t-e))}function we(e,t,a,r,n,o,i){var l,s,c,d=a,u=n,h=5+i;e.fillStyle=o,e.lineWidth=1,e.beginPath(),l=Math.atan2(n-r,a-t),s=h*Math.cos(l)+d,c=h*Math.sin(l)+u,e.moveTo(s,c),l+=1/3*2*Math.PI,s=h*Math.cos(l)+d,c=h*Math.sin(l)+u,e.lineTo(s,c),l+=1/3*2*Math.PI,s=h*Math.cos(l)+d,c=h*Math.sin(l)+u,e.lineTo(s,c),e.closePath(),e.fill()}function Te(e,t,a,r,n,o,i,l,s,c){var d,h,p,m,f,g,v=r.mx,y=n.mx,b=r.my,x=n.my,w=.5;if(null!=l?(e.lineWidth=l,l%2==0&&(w=0)):e.lineWidth=1,e.save(),br(e,s),e.strokeStyle=t,e.beginPath(),e.rect(v+w,b+w,y-v,x-b),e.stroke(),"m"==o){e.save(),e.setLineDash&&e.setLineDash([1,1]),d=Math.round((y+v)/2),e.moveTo(d+.5,b),e.lineTo(d+.5,x);var T=Math.min(b,x),C=Math.max(b,x),S=Math.min(v,y);0==i?(e.moveTo(d-5,C-5),e.lineTo(d,C),e.lineTo(d+5,C-5)):(e.moveTo(d-5,T+5),e.lineTo(d,T),e.lineTo(d+5,T+5)),h=Math.round((x+b)/2),e.moveTo(v,h+.5),e.lineTo(y,h+.5),e.lineTo(y-5,h-5),e.moveTo(y,h),e.lineTo(y-5,h+5),e.moveTo(v+5,h+5),e.lineTo(v,h),e.lineTo(v+5,h-5),e.stroke(),e.restore(),p=Math.min(r.y,n.y),m=Math.max(r.y,n.y),1==i?(f=100*(m-p)/p,g=(m-p).toFixed(2)+"€ ("+f.toFixed(2)+"%)"):(f=100*(p-m)/m,g=(p-m).toFixed(2)+"€ ("+f.toFixed(2)+"%)"),e.fillStyle=t,null==c&&(c=12),e.font=c+"px Arial",e.fillText(g,S+5,C-6),e.fillText(xe(r.x,n.x),S+5,C+11+(c-11))}null!=a&&(e.fillStyle=u(a,.15),e.fill()),e.restore()}function Ce(e,t,a,r,n,o,i,l){var s,c,d,h,p,m,f,g=.5;null!=o?(e.lineWidth=o,o%2==0&&(g=0)):e.lineWidth=1;var v=r.my,y=n.my,b=r.mx,x=n.mx,w=r.y,T=n.y;for(l&&(v=n.my,y=r.my,w=n.y,T=r.y),e.strokeStyle=t,e.beginPath(),s=v-y,y+=g,h=(c=[0,.236,.382,.5,.618,.786,1,1.618]).length,d=0;d<h;d++)e.moveTo(b,y+Math.round(s*c[d])),e.lineTo(x,y+Math.round(s*c[d]));for(e.stroke(),p=Math.min(b,x),null!=a&&(e.fillStyle=u(a,.15),e.fillRect(p,y,Math.abs(x-b),Math.round(1.618*s))),y-=1.5,e.font=(null!=i?i:12)+"px Arial",e.fillStyle=t,d=0;d<h;d++)m=y+Math.round(s*c[d]),f=T+(w-T)*c[d],e.fillText(f.toFixed(2)+"  ("+(100*c[d]).toFixed(1)+"%)",p,m)}function Se(e,t,a){var r,n,o,i,l,s;if(this.x=e,this.y=t,r=Rr,this.my=r.set.semilog&&null!=r.logData&&0!=t?$e(t,r.logData):Math.round((Dr[0].V0-t)*Dr[0].PxPointY),null!=Dr[0].Bars[0][e])this.mx=Math.round(Dr[0].Bars[0][e].i*Dr[0].PxPointX+r.padBarCandle);else if(o=Dr[0].Bars[0][0].d,e>=a){if(e>o)i=Dr[0].Bars[0][0].i,l=Pe(e-o),this.mx=Math.round((i+l)*Dr[0].PxPointX+r.padBarCandle);else for(n=e-5;n<=o;n++)if(null!=Dr[0].Bars[0][n]){this.mx=Math.round(Dr[0].Bars[0][n].i*Dr[0].PxPointX+r.padBarCandle);break}}else s=Ir.Xperiod<0?Math.floor((a-e+515)/1e4)>=1?(e-a+9485*Math.floor((a-e+515)/1e4))/-Ir.Xperiod:(e-a)*-Ir.Xperiod:Pe(e-a),this.mx=Math.round(s*Dr[0].PxPointX+r.padBarCandle)}function Pe(e){if(Ir.Xperiod<0)e*=-1/Ir.Xperiod;else switch(Ir.Xperiod){case 7:e/=7;break;case 30:e/=30;break;case 91:e/=91;break;case 365:e/=365;break;default:e=5*e/7}return e<1&&e>0?e=1:e>-1&&e<0&&(e=-1),e}function ke(e,t,a){if(!r())return!1;Rr.chartPeriod<0||a?sessionStorage.setItem(e,JSON.stringify(t)):localStorage.setItem(e,JSON.stringify(t))}function Me(e){var t;if(!r())return[];if(null!=(t=Rr.chartPeriod<0?sessionStorage.getItem(e):localStorage.getItem(e))&&""!=t&&"[]"!=t){for(var n=JSON.parse(t),o=n.length,i=0,l=0;l<o;l++)"a"==n[l].type&&(n[l].h=a(n[l].h),i=1);return 1==i&&localStorage.setItem(e,JSON.stringify(n)),n}return Rr.chartPeriod>=0&&localStorage.removeItem(e),[]}function _e(e){var t,a,r,n;switch(e){case"topinfo":(t=document.createElement("div")).id=Ke("eod_topinfo-"),t.setAttribute("class","eod_topinfo"),t.style.left=Rr.paddingLeft+2+"px",t.style.width=Rr.innerWidth+"px",t.style.color=Rr.set.txtColor,11!=Rr.set.fontSize&&(t.style.fontSize=Rr.set.fontSize+"px"),a=document.createElement("span"),t.appendChild(a),r=document.createElement("span"),t.appendChild(r),(n=document.createElement("span")).setAttribute("class","fr"),t.appendChild(n),Lr.doc.appendChild(t);break;case"overlay":(t=document.createElement("canvas")).id=Ke("overlay-"),t.setAttribute("height",Rr.heightGraph),t.setAttribute("width",Rr.widthGraph),Lr.doc.appendChild(t);break;case"trace":(t=document.createElement("canvas")).id=Ke("trace-"),t.style.left=Rr.paddingLeft+"px",t.style.top=Rr.paddingTop+"px",t.setAttribute("height",Dr[0].HeightPx),t.setAttribute("width",Rr.innerWidth),t.setAttribute("tabindex","0"),Lr.doc.appendChild(t);break;case"mainci":(t=document.createElement("div")).id=Ke("eod_mainchartinfos-"),t.setAttribute("class","eod_mainchartinfos"),t.style.left=Rr.paddingLeft+2+"px",t.style.top=Rr.paddingTop+4+"px",t.style.color=Rr.set.txtColor,11!=Rr.set.fontSize&&(t.style.fontSize=Rr.set.fontSize+"px"),Lr.doc.appendChild(t);break;case"rodgraph":Lr.doc.innerHTML='<canvas id="rodgraph-'+Lr.callID+'" style="background-color:'+Rr.set.bkcolor+'" width="'+Rr.widthGraph+'" height="'+Rr.heightGraph+'" ></canvas>'}}function Ee(){Lr.ctxback.clearRect(0,0,Rr.widthGraph,Rr.heightGraph),Lr.ctxback.font=Rr.set.fontSize+"px Arial"}function Ve(e){var t;if(null==e&&(e=Hr.maxX-(Ir.QuoteTab.length-1)),Ir.Xperiod<0)t=-Ir.Xperiod;else switch(Ir.Xperiod){case 7:t=7;break;case 30:t=30;break;case 91:t=91;break;case 365:t=365;break;default:t=1.4}return Math.round(t*e)+Ir.QuoteTab[Ir.QuoteTab.length-1].d}function Le(e,t){if(e>Rr.widthGraph-Rr.paddingRight||e<Rr.paddingLeft)return null;for(var a=Dr.length,r=0;r<a;r++)if(t>=Dr[r].RealY&&t<=Dr[r].RealY+Dr[r].HeightPx)return r;return null}function Re(e){_e("rodgraph");var t=b.gi(Ke("rodgraph-"));Lr.ctxback=t.getContext("2d"),Ee(),null!=e?function(e){var t,a,r,n,o,i=Rr,l=new Yt(0,e[0].Height,i.mainChart.type,Ke("main-"),0);for(l.Create(),l.DrawEncadre(),t=e.length,a=1;a<t;a++)(r=new Yt(e[a].Y,e[a].Height,e[a].Indicator,Ke("indic-")+a,i.marginInter*a)).Create(),r.DrawEncadre(),o=Math.round(e[a].Y*i.usableHeight)+i.paddingTop+i.marginInter*a+5,n=Rt(Lr.callID+a,e[a].Indicator.type,i.paddingLeft+5,o,i.innerWidth-7),Lr.doc.appendChild(n),t>2&&Ht(a,a==t-1)}(e):function(){var e,t,a,r,n,o,i,l,s;for(t=[0,.25,.2,.1666,.15,.13,.12][Rr.indicators.length],e=r=[1,.75,.6,.5002,.4,.35,.28][Rr.indicators.length],(n=new Yt(0,r,Rr.mainChart.type,Ke("main-"),0)).Create(),n.DrawEncadre(),o=Rr.indicators.length,a=0;a<o;a++)(i=new Yt(e,t,Rr.indicators[a],Ke("indic-")+(a+1),Rr.marginInter*(a+1))).Create(),i.DrawEncadre(),l=Math.round(e*Rr.usableHeight)+Rr.paddingTop+Rr.marginInter*(a+1)+5,s=Rt(Lr.callID+(a+1),Rr.indicators[a].type,Rr.paddingLeft+5,l,Rr.innerWidth-7),Lr.doc.appendChild(s),e+=t,o>1&&Ht(a+1,a==o-1)}(Lr.doc),VGP.chartSimple||(_e("topinfo"),_e("overlay"),_e("trace"),_e("mainci"),null!=Ir&&b.qstxt(Ke("#eod_topinfo-")+" span",Ir.Name))}function Ie(e){0==VGP.drawings[Rr.symbol]&&Rr.chartPeriod>=0&&!VGP.noCommand&&!VGP.noAutoReadTrace?q(!0,!1,e):De(e)}function De(e,t){var a,r,n,o,i,l;if(null==Rr.histoLength&&(Rr.histoLength=365),null==Rr.chartPeriod&&(Rr.chartPeriod=Rr.histoLength>20?0:-1),"function"==typeof stopTimers&&stopTimers(),VGP.noCommand||((a=b.gi(Ke("trace-"))).getContext("2d").clearRect(0,0,a.width,a.height),Ar=Me(Rr.symbol)),r=Rr.dataSource){if(""==(n=b.gigt(r)))return;null!=(o=JSON.parse(n))&&(Ir=y(o),Ae(o,e))}else i=VGP.urlWS+"GetTicksEOD","GET"==VGP.callType&&(i=i+"?symbol="+Rr.symbol+"&length="+Rr.histoLength+"&period="+Rr.chartPeriod+"&guid="+b.gigt("guid")),(l=new XMLHttpRequest).open(VGP.callType,i,!0),l.setRequestHeader("Content-Type","application/json;charset=UTF-8"),l.onload=function(){var a,r,n,o,i,s,c,d,u;if(l.status>=200&&l.status<400)if(null!=(a=JSON.parse(l.responseText))&&null!=a.d)if(Ir=y(a.d),r=Rr.mainChart.indicators,Rr.isCompare){for(s=r.length,c="",n=0;n<s;n++)"compare"==r[n].type&&(c+=r[n].symbol+";");""!=c&&(c=c.substring(0,c.length-1),d=VGP.urlWS+"GetTicksList","GET"==VGP.callType&&(d=d+"?symbols="+c+"&length="+Rr.histoLength+"&period="+Rr.chartPeriod+"&guid="+b.gigt("guid")),(u=new XMLHttpRequest).open(VGP.callType,d,!0),u.setRequestHeader("Content-Type","application/json;charset=UTF-8"),u.onload=function(){if(u.status>=200&&u.status<400){var t=JSON.parse(u.responseText);if(null!=t&&null!=t.d)for(i=t.d.length,n=0;n<s;n++)if("compare"==r[n].type)for(o=0;o<i;o++)if(t.d[o].SymbolId==r[n].symbol){r[n].datas2=t.d[o];break}Ae(a.d,e)}},u.send(JSON.stringify({symbols:c,length:Rr.histoLength,period:Rr.chartPeriod,guid:b.gigt("guid")})))}else Ae(a.d,e);else"function"==typeof DisplayAlert&&(Rr.chartPeriod<0?DisplayAlert(lang.l_msg3,3):DisplayAlert(lang.l_msg4,4)),t&&(Rr.chartPeriod=t.chartPeriod,Rr.histoLength=t.histoLength)},l.send(JSON.stringify({symbol:Rr.symbol,length:Rr.histoLength,period:Rr.chartPeriod,guid:b.gigt("guid")}))}function Ae(e,t){var a,r,n;if(Hr.minX=0,Hr.maxX=e.QuoteTab.length-1,Hr.maxY=e.High,Hr.minY=e.Low,Rr.isCompare&&Be(e.High,e.Low,Ir.QuoteTab[0].c),1!=Rr.histoLength||Rr.set.noVeilleIntra||((a=e.qv.c)>Hr.maxY&&(Hr.maxY=a),a<Hr.minY&&(Hr.minY=a)),Hr.qv=e.qv,Hr.qd=e.qd,Rr.chartPeriod=parseInt(e.Xperiod),0==t)if(Rr.mainChart.typedef.nolinearX)_t(!0);else for(Ge(e),n=Dr.length,r=1;r<n;r++)ze(Dr[r]);else X(!1,!0);VGP.chartSimple||(k(),b.qstxt(Ke("#eod_topinfo-")+" span",e.Name),je()),"function"==typeof launchTimers&&launchTimers(Lr.callID,Rr.chartPeriod,Rr.symbol),He()}function He(){if(Rr.mainChart.typedef.nolinearX)"function"==typeof extIndicatorsList&&extIndicatorsList({ind1:a,ind2:r});else{for(var e,t,a=[],r=[],n=0;n<Rr.mainChart.indicators.length;n++)"actu"!=(e=Rr.mainChart.indicators[n]).type&&"evt"!=e.type&&(t="compare"==e.type?e.datas2?e.datas2.Name:"NC":e.param1?" ("+e.param1+")":"",a[n]={id:n,name:e.type,color:e.color,param:t,bkcolor:kt(e.color)});for(n=1;n<Dr.length;n++)"volume"!=(e=Dr[n].Indicator).type&&(t=e.param1?" ("+e.param1+")":"",r[n]={id:n,name:e.type,color:e.color,param:t,bkcolor:kt(e.color)});"function"==typeof extIndicatorsList&&extIndicatorsList({ind1:a,ind2:r})}}function Be(e,t,a,r,n){for(var o,i,l,s,c=Rr.mainChart.indicators.length,d=-1e3,u=1e3,h=0;h<c;h++)"compare"==Rr.mainChart.indicators[h].type&&(l=Rr.mainChart.indicators[h].datas2)&&(s=l.QuoteTab[0].c,Rr.mainChart.indicators[h].datas2=y(Rr.mainChart.indicators[h].datas2,r,n),(o=(l.High-s)/s)>d&&(d=o),(i=(l.Low-s)/s)<u&&(u=i));(o=(e-a)/a)>d&&(d=o),(i=(t-a)/a)<u&&(u=i),Hr.maxY=a*(1+d),Hr.minY=a*(1+u)}function Ge(e,t,a){var r,o,i,l,s,d,h,p,f,y,x,w,T,C,S,P,k,M,_,E,V,L,R,I,D,A,H,B,G,q,Y,N,X,$,Q,F;if(null!=e){r={Name:e.Name,High:e.High,Low:e.Low,QuoteTab:e.QuoteTab},0==Hr.maxX&&0==Hr.minX&&(Hr.maxX=r.QuoteTab.length-1,Hr.minX=0),r.QuoteTab=qe(e.QuoteTab);var z,U=r.High,W=r.Low,J=r.QuoteTab.length,j=Dr[0];0==Hr.maxY&&0==Hr.minY?(Hr.maxY=U,Hr.minY=W):(U=Hr.maxY,W=Hr.minY),U==W&&(U*=1.01,W*=.99),o=Rr.mainChart.typedef,i=57,57==j.HeightPx&&(i=56),j.PxPointY=(j.HeightPx-i)/(U-W),j.V0=U+(i-20)/j.PxPointY;var Z,K=j.V0,ee=j.PxPointY,te=j.ctx;if(-1!=["bar","candle","barcolor","hollow","heikin ashi"].indexOf(Rr.mainChart.type)?((Z=Math.floor(Rr.innerWidth/J)-3)%2==0&&Z++,Z>19?Z=19:Z<3&&(Z=3),Rr.padBarCandle=2+Z):Rr.padBarCandle=0,l=Rr.paddingLeft+Rr.padBarCandle,"perf"==Rr.mainChart.type&&(W=(r=n.computePERFORMANCE(r)).Low<0?1.05*r.Low:.95*r.Low,U=r.High>0?1.05*r.High:.95*r.High,ee=(j.HeightPx-i)/(U-W),j.PxPointY=ee,K=U+(i-20)/j.PxPointY,j.V0=K),"heikin ashi"==Rr.mainChart.type&&!(r=function(e){var t,a,r,n,o,i,l,s={QuoteTab:e.QuoteTab},c=[],d=s.QuoteTab.length;if(d<2)return!1;for(i=s.QuoteTab[0],c[0]={d:i.d,o:i.o,h:i.h,l:i.l,c:i.c,v:i.v},t=1;t<d;t++)null!=(l=s.QuoteTab[t])&&(o=(l.o+l.h+l.l+l.c)/4,a=(c[t-1].o+c[t-1].c)/2,r=Math.max(l.h,o,a),n=Math.min(l.l,a,o),c[t]={d:l.d,o:+a.toFixed(3),h:+r.toFixed(3),l:+n.toFixed(3),c:+o.toFixed(3),v:l.v});return{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:c}}(r)))return Gr={},J=[],void(j.Bars[0]={});switch(s=null,Rr.set.semilog&&"perf"!=Rr.mainChart.type&&!Rr.isCompare&&(s=function(e,t){var a=(e-t)/100;(t-=a)<=0&&(t=.98*(t+a));var r=Math.log10(t)/Math.log10(10),n=Math.log10(e+4*a)/Math.log10(10);return{floor:r,ceil:n,range:n-r}}(U,W)),Rr.logData=s,Rr.isCompare?Ne(te,j.HeightPx,l,K,ee,!0):Rr.set.semilog&&"perf"!=Rr.mainChart.type?Ne(te,j.HeightPx,l,K,ee,!1,!0):Ne(te,j.HeightPx,l,K,ee),y=1==J?Rr.innerWidth-2*Rr.padBarCandle:(Rr.innerWidth-2*Rr.padBarCandle)/(J-1),j.PxPointX=y,t?Ye(j):Ye(j,!0,r.QuoteTab),Gr={},Br=[],j.Bars[0]={},x=l-1,w={},Rr.mainChart.type){case"perf":for(te.save(),te.beginPath(),h=(K-r.QuoteTab[0].c)*ee,te.moveTo(l,h),z=0;z<J;z++)if(null!=(T=r.QuoteTab[z])){if(d=Math.round(z*y+l),Br[d-Rr.paddingLeft]={d:T.d,i:z},te.lineTo(d+.5,Math.round((K-T.c)*ee)+.5),y<2)Gr[d]=T.d;else for(p=-1;p<=1;p++)Gr[d+p]=T.d;w[T.d]={c:T.c.toFixed(2),i:z},E=z}T=r.QuoteTab[E],w[0]={c:T.c.toFixed(2),i:E,d:T.d},o.v1||(te.strokeStyle=o.color,br(te,1,o),yr(te,o,1),te.stroke()),o.v2||(te.lineTo(d,K*ee),te.lineTo(l,K*ee),(M=te.createLinearGradient(0,0,0,j.HeightPx)).addColorStop(0,u(c(o.color2),.7)),M.addColorStop(1,u(c(o.color2),.1)),te.fillStyle=M,te.fill()),te.restore();break;case"line":case"line2":for(te.save(),te.beginPath(),V=null!=o.source?o.source:"c",h=$e(v(r.QuoteTab[0],V),s),te.moveTo(l,h),(L=[]).push({x:l,y:h}),z=0;z<J;z++)if(null!=(T=r.QuoteTab[z])){if(d=Math.round(z*y+l),Br[d-Rr.paddingLeft]={d:T.d,i:z},d-x>=1)if(h=$e(v(T,V),s)+.5,te.lineTo(d+.5,h),L.push({x:d+.5,y:h}),x=d,y<2)Gr[d]=T.d;else for(p=-1;p<=1;p++)Gr[d+p]=T.d;w[T.d]={o:T.o,h:T.h,l:T.l,c:T.c,i:z},E=z}if(T=r.QuoteTab[E],w[0]={o:T.o,h:T.h,l:T.l,c:T.c,i:E,d:T.d},"line"==Rr.mainChart.type&&(o.v2||(te.strokeStyle="transparent",te.lineTo(d,j.HeightPx),te.lineTo(l,j.HeightPx),te.lineTo(l,K),te.stroke(),0!=K-U&&((M=te.createLinearGradient(0,$e(r.High,s),0,j.HeightPx)).addColorStop(0,o.color2),null!=o.color3?M.addColorStop(1,o.color3):M.addColorStop(1,u(c(o.color2),.1)),te.fillStyle=M,te.fill()))),!o.v1){if(te.beginPath(),(R=L.length)>0)for(te.moveTo(L[0].x,L[0].y),p=1;p<R;p++)te.lineTo(L[p].x,L[p].y);yr(te,o,1),br(te,1,o),te.strokeStyle=o.color,te.stroke()}te.restore();break;case"bar":case"barcolor":te.save();var ae=.5,re=0,ne=Math.floor(Z/2),oe=ne+1;for(y>5&&(te.lineWidth=2,ae=0,re=1,ne+=1),te.strokeStyle=o.v1?"transparent":o.color,te.beginPath(),z=0;z<J;z++)if(null!=(T=r.QuoteTab[z])){for(d=Math.round(z*y+l),T.c>=T.o&&(P=$e(T.o,s)+ae,k=$e(T.c,s)+ae,C=$e(T.l,s),S=$e(T.h,s),Br[d-Rr.paddingLeft]={d:T.d,i:z},te.moveTo(d+ae,C+re),te.lineTo(d+ae,S-re),te.moveTo(d,P),te.lineTo(d-ne,P),te.moveTo(d,k),te.lineTo(d+oe,k)),f=-Z;f<=Z;f++)Gr[d+f]=T.d;E=z,w[T.d]={o:T.o,h:T.h,l:T.l,c:T.c,i:z}}for(T=r.QuoteTab[E],w[0]={o:T.o,h:T.h,l:T.l,c:T.c,i:E,d:T.d},te.stroke(),"barcolor"==Rr.mainChart.type&&(te.strokeStyle=o.v2?"transparent":o.color2),te.beginPath(),z=0;z<J;z++)null!=(T=r.QuoteTab[z])&&T.c<T.o&&(P=$e(T.o,s)+ae,k=$e(T.c,s)+ae,d=Math.round(z*y+l),C=$e(T.l,s),S=$e(T.h,s),Br[d-Rr.paddingLeft]={d:T.d,i:z},te.moveTo(d+ae,C+re),te.lineTo(d+ae,S-re),te.moveTo(d,P),te.lineTo(d-ne,P),te.moveTo(d,k),te.lineTo(d+oe,k));te.stroke(),te.restore();break;case"heikin ashi":case"candle":for(y>5&&y<7&&(Z=5),te.strokeStyle=o.color3,te.beginPath(),te.fillStyle=o.color,_=Math.floor(Z/2),z=0;z<J;z++)if(null!=(T=r.QuoteTab[z])){for(d=Math.round(z*y+l)-_,T.c>=T.o&&Et(te,Z,T,d,_,z,s),f=0;f<=Z;f++)Gr[d+f]=T.d;E=z,w[T.d]={o:T.o,h:T.h,l:T.l,c:T.c,i:z}}for(T=r.QuoteTab[E],w[0]={o:T.o,h:T.h,l:T.l,c:T.c,i:E,d:T.d},o.v1||(te.stroke(),te.fill()),te.beginPath(),te.fillStyle=o.color2,z=0;z<J;z++)null!=(T=r.QuoteTab[z])&&T.c<T.o&&Et(te,Z,T,d=Math.round(z*y+l)-_,_,z,s);o.v2||(te.stroke(),te.fill());break;case"hollow":for(y>5&&y<7&&(Z=5),te.strokeStyle=o.color,te.beginPath(),_=Math.floor(Z/2),z=1;z<J;z++)if(null!=(T=r.QuoteTab[z])){for(d=Math.round(z*y+l)-_,T.c>=T.o&&T.c>=r.QuoteTab[z-1].c&&Et(te,Z,T,d,_,z,s),f=0;f<=Z;f++)Gr[d+f]=T.d;E=z,w[T.d]={o:T.o,h:T.h,l:T.l,c:T.c,i:z}}for(null!=E&&(T=r.QuoteTab[E],w[0]={o:T.o,h:T.h,l:T.l,c:T.c,i:E,d:T.d}),o.v1||te.stroke(),te.strokeStyle=o.color2,te.beginPath(),z=1;z<J;z++)null!=(T=r.QuoteTab[z])&&(d=Math.round(z*y+l)-_,T.c>=T.o&&T.c<r.QuoteTab[z-1].c&&Et(te,Z,T,d,_,z,s));for(o.v2||te.stroke(),te.strokeStyle=o.color3,te.fillStyle=o.color,te.beginPath(),z=1;z<J;z++)null!=(T=r.QuoteTab[z])&&(d=Math.round(z*y+l)-_,T.c<=T.o&&T.c>=r.QuoteTab[z-1].c&&Et(te,Z,T,d,_,z,s));for(o.v1||(te.stroke(),te.fill()),te.fillStyle=o.color2,te.beginPath(),z=1;z<J;z++)null!=(T=r.QuoteTab[z])&&(d=Math.round(z*y+l)-_,T.c<=T.o&&T.c<r.QuoteTab[z-1].c&&Et(te,Z,T,d,_,z,s));o.v2||(te.stroke(),te.fill())}if(j.Bars[0]=w,0!=J&&null!=w[0]&&(Rr.set.nohighlow||Rr.isCompare||(Xe(te,K,r.High,ee,"rgba(0, 128, 0, 1)",!0,s),Xe(te,K,r.Low,ee,"rgba(192, 0, 0, 1)",!0,s)),Rr.set.nosticky||Xe(te,K,w[0].c,ee,null,!0,s)),t||a||VGP.chartSimple||(I="","perf"!=Rr.mainChart.type&&(I=Qe(Rr.chartPeriod<0).toFixed(2)),D="",VGP.noCommand||(D='<span class="mci-p"></span>'),A='<div><span class="eod_param" data-name="'+Rr.mainChart.type+'">'+D+lang.l_cours+"</span>",B=e.QuoteTab[e.QuoteTab.length-1],Rr.chartPeriod<0?(H=Ir.qd).dt=m(B.d,2):(H=B).dt=g(B.d,1),H.var=I,"function"==typeof extGetQuotesHover&&extGetQuotesHover(H),b.idhtml(Ke("eod_mainchartinfos-"),A)),Lt(Dr[0],!0,s),"perf"!=Rr.mainChart.type){for(G=Rr.mainChart.indicators.length,z=0;z<G;z++)switch((q=Rr.mainChart.indicators[z]).type){case"compare":gt(q,l,0,z);break;case"sar":bt(q,l,0,z,0,s);break;case"phpb":yt(q,l,0,z,0,s);break;case"ichimoku":ft(q,l,0,z,0,s);break;case"pivots":pt(q,0,z,0,s);break;case"supertrend":vt(q,l,0,z,0,s);break;default:Fe(q,l,0,z,0,s)}if(Rr.newsConfig&&(0==Nr.fiEvt.length&&"no"!=Nr.fiEvt?ht(l,z):wt(l,0,z)),""!=Rr.searchConfig){switch(X=r.QuoteTab,Rr.searchConfig){case"gaps":Y="G",N=n.computeGAP(X);break;case"dojis":Y="D",N=n.computeDOJI(X,Rr.chartPeriod);break;case"keyr":Y="K",N=n.computeKEYR(X);break;case"englob":Y="E",N=n.computeEnglobante(X);break;case"marteau":Y=lang.l_m,N=n.computeMarteau(X);break;case"pendu":Y=lang.l_p,N=n.computePendu(X);break;case"pinces":Y=lang.l_p,N=n.computePinces(X);break;case"marubozu":Y=lang.l_m,N=n.computeMarubozu(X);break;case"soldiers":Y=lang.l_s,N=n.computeSoldiers(X,"s");break;case"harami":Y="H",N=n.computeHarami(X);break;case"corbeaux":Y="C",N=n.computeSoldiers(X,"c");break;case"dragon":Y="D",N=n.computeDragonFly(X);break;case"shootings":Y="E",N=n.computeShootingStar(X)}for($=N.Values.length,z=0;z<$;z++)0!=N.Values[z].v1?(te.beginPath(),te.arc(Math.round(N.Values[z].i*y+l),$e(N.Values[z].v1,s)+20,8,0,2*Math.PI),te.fillStyle="#008000",te.fill()):0!=N.Values[z].v2&&(te.beginPath(),te.arc(Math.round(N.Values[z].i*y+l),$e(N.Values[z].v2,s)-20,8,0,2*Math.PI),te.fillStyle="#ff0000",te.fill());for(te.fillStyle="#fff",z=0;z<$;z++)0!=N.Values[z].v1?te.fillText(Y,Math.round(N.Values[z].i*y+l)-4,$e(N.Values[z].v1,s)+24):0!=N.Values[z].v2&&te.fillText(Y,Math.round(N.Values[z].i*y+l)-4,$e(N.Values[z].v2,s)-16)}}VGP.chartSimple||t||(Q=document.querySelectorAll(Ke("#eod_topinfo-")+" span")).length>1&&("perf"==Rr.mainChart.type?Q[1].innerHTML=lang.l_varperiod+" : "+St(r.QuoteTab,1).c.toFixed(2)+"%":Rr.set.noVarPeriod||(F=100*(St(r.QuoteTab,1).c-r.QuoteTab[0].c)/r.QuoteTab[0].c,Q[1].innerHTML=lang.l_varperiod+" : "+(F>0?"+":"")+F.toFixed(2)+"%")),O(),null!=Nr.orders&&(tt(),at())}}function qe(e){if(null==e)return e;for(var t=[],a=Hr.minX,r=Hr.maxX,n=a;n<=r;n++)t.push(e[n]);return t}function Ye(e,t,a,r){var n,o,i,l,s,c=Rr,d=Math.round((c.innerWidth-2*c.padBarCandle)/80),u=Hr.maxX-Hr.minX,h=Math.round(u/d);if(h<=0&&(h=1),(o=e.ctx).beginPath(),o.save(),o.strokeStyle=c.set.gridColor,!c.set.gridLine&&o.setLineDash&&o.setLineDash([3]),t&&(Lr.ctxback.fillStyle=c.set.txtColor),l=c.heightGraph-6,r)for(n=h;n<u;n+=h)null!=a[n]&&(i=Math.round(a[n].cu-a[0].cu+c.paddingLeft)+.5,c.set.gridV&&(o.moveTo(i,0),o.lineTo(i,e.HeightPx)),s=a[n].d,c.chartPeriod>=0?c.histoLength>365?Lr.ctxback.fillText(g(s,4),i-18,l):Lr.ctxback.fillText(g(s,3),i-18,l):c.histoLength>2?Lr.ctxback.fillText(m(s),i-18,l):Lr.ctxback.fillText(m(s,1),i-18,l));else for(n=h;n<u;n+=h)i=Math.round(n*Dr[0].PxPointX+c.paddingLeft+c.padBarCandle)+.5,c.set.gridV&&(o.moveTo(i,0),o.lineTo(i,e.HeightPx)),t&&(s=null==a[n]?Ve(n+1-Br[Br.length-1].i):a[n].d,c.chartPeriod>=0?c.histoLength>365?Lr.ctxback.fillText(g(s,4),i-18,l):Lr.ctxback.fillText(g(s,3),i-18,l):c.histoLength>2?Lr.ctxback.fillText(m(s),i-18,l):Lr.ctxback.fillText(m(s,1),i-18,l));o.stroke(),o.restore()}function Ne(e,t,a,r,n,o,i){var l,s,c,d,u,h,m,f="";r>=1e5&&(r/=1e3,n*=1e3,f="K"),i&&(c=Rr.logData),e.save(),e.beginPath(),!Rr.set.gridLine&&e.setLineDash&&e.setLineDash([3]),e.strokeStyle=Rr.set.gridColor,e.font=Rr.set.fontSize+"px Arial",e.fillStyle=Rr.set.txtColor,d=t/n,u=35,t<120&&(u=20);var g,v,y,b=Math.round(t/u),x=d/(b-1),w=Math.ceil(Math.log10(x)-1),T=Math.pow(10,w),C=Math.ceil(x/T)*T,S=Math.ceil((r-d)/C)*C;for(Rr.mainChart.typedef.nolinearX||(y=Ir.QuoteTab[Hr.minX].c),h=Rr.widthGraph-Rr.paddingRight,m=a-Rr.padBarCandle,l=0;l<=b&&(g=S+l*C,!((v=i?$e(g,c):Math.round((r-g)*n))<=5));l++)Rr.set.gridH&&(e.moveTo(m,v+.5),e.lineTo(h,v+.5)),s=o||"perf"==Rr.mainChart.type?"perf"==Rr.mainChart.type?p(g,!0):p(100*(g-y)/y,!0):p(g)+f,Rr.set.yaxis?e.fillText(s,2,v+2):e.fillText(s,h+5,v+2);e.stroke(),e.restore()}function Xe(e,t,a,r,n,o,i){var l,s,d,u,h,m,f=Rr;a=parseFloat(a),o?l=$e(a,i):(l=Math.round(t-a*r))<t+7&&(l-=7),null==n&&(n="rgba(51, 102, 255, 1)"),e.fillStyle=c(n),e.font=f.set.fontSize+"px Arial",d=f.widthGraph-f.paddingRight,u=f.paddingRight,f.set.yaxis&&(d=-2,u=f.paddingLeft-1),h=f.set.fontSize-11,e.fillRect(d+2,l-7,u,15+h),e.fillStyle=kt(n),o&&f.isCompare&&!f.mainChart.typedef.nolinearX&&"perf"!=f.mainChart.type?(a=100*(a-(s=Ir.QuoteTab[Hr.minX].c))/s,e.fillText(a.toFixed(2),d+5,l+4+h)):(m="",a>=1e5&&(a=Math.round(a/1e3),m="K"),e.fillText(p(a)+m,d+5,l+4+h))}function $e(e,t){return null==t?Math.round((Dr[0].V0-e)*Dr[0].PxPointY):Dr[0].HeightPx-Math.round((Math.log10(e)/Math.log10(10)-t.floor)/t.range*Dr[0].HeightPx)}function Oe(e,t){var a=Dr[0];return null==t?(a.V0*a.PxPointY-e)/a.PxPointY:Math.pow(10,Math.log10(10)*((a.HeightPx-e)*t.range/a.HeightPx+t.floor))}function Qe(e){if(e)return null!=Ir.qv?100*(St(Ir.QuoteTab,1).c-Ir.qv.c)/Ir.qv.c:0;var t=St(Ir.QuoteTab,2).c;return 100*(St(Ir.QuoteTab,1).c-t)/t}function Fe(e,t,a,r,o,i){var l,s,c,d,u={},h=Dr[0];switch(h.Bars[r+1]={},s=null!=e.source?e.source:"c",e.type){case"mm":l=n.computeMovingAverage(Ir.QuoteTab,e.param1,s);break;case"zig zag":l=n.computeZigZag(Ir.QuoteTab,e.param1/100,s);break;case"mmt":l=n.computeMovingAverageT(Ir.QuoteTab,e.param1,s);break;case"mmp":l=n.computeMovingAverageP(Ir.QuoteTab,e.param1,s);break;case"mmh":l=n.computeMovingAverageHull(Ir.QuoteTab,e.param1,s);break;case"double EMA":l=n.computeDoubleEMA(Ir.QuoteTab,e.param1,s);break;case"triple EMA":l=n.computeTripleEMA(Ir.QuoteTab,e.param1,s);break;case"linearc":l=n.computeLinearCurve(Ir.QuoteTab,e.param1,1,s);break;case"lineard":c=function(e,t,a,r){var n,o=e.length;if(o<=t)return null;var i,l=0,s=0,c=0,d=0,u=0;for(n=1;n<=t;n++)l+=n*(i=v(e[o-n],r)),s+=n,c+=i,d+=n*n,u+=i*i;var h=(l*t-s*c)/(t*d-s*s),p=(c-h*s)/t,m=p+h*t,f=p+h,g=Math.pow((t*u-c*c)/(t*(t-1)),.5);return{p0:new Se(e[o-t].d,m,Ir.QuoteTab[Hr.minX].d),p1:new Se(e[o-1].d,f,Ir.QuoteTab[Hr.minX].d),et:g,id:a}}(Ir.QuoteTab,e.param1,e,s);break;case"supres":Pr(Ir,e.param1,e);break;case"cmoy":l=kr(Ir.QuoteTab,Rr,e,s,i);break;case"mme":l=n.computeMovingAverageE(Ir.QuoteTab,e.param1,s);break;case"boll":null==e.param2&&(e.param2=2),l=n.computeBollinger(Ir.QuoteTab,e.param1,e.param2,s);break;case"donchian":l=n.computeDonchian(Ir.QuoteTab,e.param1);break;case"keltner":l=n.computeKeltner(Ir.QuoteTab,e.param1,e.param2,e.param3);break;case"evmm":l=n.computeEVMM(Ir.QuoteTab,e.param1,e.param2,s);break;case"alligator":l=n.computeAlligator(Ir.QuoteTab,e.param1,e.param2,e.param3);break;case"gmma":l=n.computeGMMA(Ir.QuoteTab)}if("lineard"!=e.type){if("supres"!=e.type&&null!=l){if(l.Values=qe(l.Values),"alligator"==e.type)return void function(e,t,a,r,n,o){for(var i,l,s,c,d,u,h=t.Values.length,p=e.ctx,m=e.PxPointX,f={},g=1;g<4;g++){for(s="v"+g,p.save(),p.strokeStyle=1==g?r[s]?"transparent":r.color:r[s]?"transparent":r["color"+g],p.beginPath(),yr(p,r,g),br(p,g,r),u=!1,l=1;l<h;l++)null!=(d=t.Values[l])&&null!=d[s]&&(i=Math.round(l*m+a),u||(p.moveTo(i,$e(d[s],n)+.5),u=!0),p.lineTo(i+.5,$e(d[s],n)+.5),3==g&&(c=l,f[d.d]=[d.v1,d.v2,d.v3]));p.stroke(),p.restore()}d=t.Values[c],f[0]=[d.v1,d.v2,d.v3],e.Bars[o+1]=f}(h,l,t,e,i,r);if("gmma"==e.type)return void function(e,t,a,r,n){for(var o,i,l,s=t.Values.length,c=e.ctx,d=e.PxPointX,u=1;u<13;u++){for(c.save(),c.strokeStyle=u<7?r.v1?"transparent":r.color:r.v2?"transparent":r.color2,c.beginPath(),u<7&&yr(c,r,1),u>=7&&yr(c,r,2),yr(c,r,u),br(c,u<7?1:2,r),l=!1,i=1;i<s;i++)null!=t.Values[i]&&(o=Math.round(i*d+a),l||(c.moveTo(o,$e(t.Values[i]["v"+u],n)+.5),l=!0),c.lineTo(o+.5,$e(t.Values[i]["v"+u],n)+.5));c.stroke(),c.restore()}}(h,l,t,e,i);var p,m,f,g,y=l.Values.length,b=h.ctx,x=t-1,w=h.PxPointX;if(b.strokeStyle=e.v1?"transparent":e.color,null==l.Values[0]&&(l.Values[0]={v1:Ir.QuoteTab[Hr.minX].c,d:Ir.QuoteTab[Hr.minX].d}),null==l.Values[0].v2){for(b.save(),b.beginPath(),b.moveTo(t,$e(l.Values[0].v1,i)+.5),yr(b,e,1),br(b,1,e),m=1;m<y;m++)null!=l.Values[m]&&((p=Math.round(m*w+t))-x>=1&&(b.lineTo(p+.5,$e(l.Values[m].v1,i)+.5),x=p),u[l.Values[m].d]=l.Values[m].v1,g=m);return null!=g&&(u[0]=l.Values[g].v1),h.Bars[r+1]=u,b.stroke(),void b.restore()}for(b.beginPath(),d=!1,m=y-1;m>=0;m--)null!=l.Values[m]&&(f=$e(l.Values[m].v1,i),d?(p=Math.round(m*w+t),b.lineTo(p+.5,Math.round(f)+.5)):(b.moveTo(Math.round(m*w+t)+.5,f+.5),d=!0));for(f=$e(l.Values[0].v1,i),b.lineTo(Rr.paddingLeft+1,f+.5),f=$e(l.Values[0].v2,i),b.lineTo(Rr.paddingLeft+1,f+.5),m=0;m<y;m++)null!=l.Values[m]&&(p=Math.round(m*w+t),f=$e(l.Values[m].v2,i),b.lineTo(p+.5,f+.5),u[l.Values[m].d]=[l.Values[m].v1,l.Values[m].v2],g=m);u[0]=[l.Values[g].v1,l.Values[g].v2],b.save(),yr(b,e,1),br(b,1,e),b.stroke(),b.restore(),e.v2||(b.fillStyle=e.color2,b.fill()),h.Bars[r+1]=u}}else!function(e,t){var a,r,n,o;if(e.save(),a=Rr.paddingLeft,null!=t){for(o=t.id.param2*t.et*Dr[0].PxPointY,r=1;r<4;r++)if(!t.id["v"+r]){switch(e.strokeStyle=1==r?t.id.color:t.id["color"+r],r){case 1:n=0;break;case 2:n=-o;break;case 3:n=o}e.lineWidth=null!=t.id["w"+r]?t.id["w"+r]:1,e.beginPath(),e.moveTo(t.p0.mx+a,t.p0.my+n),e.lineTo(t.p1.mx+a,t.p1.my+n),e.stroke()}e.restore()}}(h.ctx,c)}function ze(e){var t,a,r,o=e.Indicator,i=Ir.QuoteTab,l=null!=o.source?o.source:"c";switch(o.type){case"volume":We(n.computeVolume(i,Hr),e);break;case"accDist":Ue(n.computeAccDist(i),e,"curve",0);break;case"obv":Ue(n.computeOBV(i),e,"curve",0);break;case"bollb":Je(n.computeBollingerB(i,o.param1,2,l),e);break;case"bollw":Je(n.computeBollingerBandwith(i,o.param1,o.param2,l),e);break;case"perfi":Ue(n.computePERFORMANCE(Ir,!0),e,"curve",0);break;case"volumecash":We(n.computeVolume(i,Hr,!0),e);break;case"rsi":Je(n.computeRSI(i,o.param1,l),e);break;case"cmo":Je(n.computeCMO(i,o.param1),e);break;case"fr":if(Rr.isCompare){for(r=Rr.mainChart.indicators,t=0;t<r.length;t++)if("compare"==r[t].type&&r[t].datas2){a=r[t].datas2.QuoteTab;break}Ue(n.computeFR(i,a),e,"curve",0)}break;case"ultimate":Je(n.computeUltimateOsc(i,o.param1,o.param2,o.param3),e);break;case"atr":Je(n.computeATR(i,o.param1,"pma"),e);break;case"cci":Je(n.computeCCI(i,o.param1),e);break;case"eom":Ue(n.computeEaseOfMovement(i,o.param1),e,"curve",0);break;case"cmf":Ue(n.computeCMF(i,o.param1),e,"curve",0);break;case"dpo":Ue(n.computeDPO(i,o.param1),e,"curve",0);break;case"mom":Ue(n.computeMomentum(i,o.param1,l),e,"curve",0);break;case"asi":Ue(n.computeASI(i),e,"curve",0);break;case"coppock":Ue(n.computeCoppock(i,o.param1,o.param2,o.param3,l),e,"curve",0);break;case"nvi":Je(n.computeNVIPVI(i,l,"nvi"),e);break;case"pvi":Je(n.computeNVIPVI(i,l,"pvi"),e);break;case"macd":Je(n.computeMACD(i,o.param1,o.param2,o.param3,"macd",l),e);break;case"macdzl":Je(n.computeMACDZL(i,o.param1,o.param2,o.param3),e);break;case"wto":Je(n.computeWaveTrendOsc(i,o.param1,o.param2),e);break;case"dmi":Je(n.computeDMI(i,o.param1,"dmi"),e);break;case"aroon":Je(n.ComputeAroon(i,o.param1),e);break;case"adx":Je(n.computeDMI(i,o.param1,"adx"),e);break;case"vortex":Je(n.computeVortex(i,o.param1),e);break;case"macdh":Ue(n.computeMACD(i,o.param1,o.param2,o.param3,"macdh",l),e,"bar");break;case"awesome":Ue(n.computeAwesomeIndicator(i,o.param1,o.param2),e,"awesome");break;case"bop":Ue(n.computeBOP(i),e,"bop");break;case"qstick":Ue(n.computeQStick(i,o.param1),e,"bar");break;case"roc":Je(n.computeROC(i,o.param1,l,!0),e);break;case"std":Je(n.computeSTD(i,o.param1,l),e);break;case"ulcer":Je(n.computeUlcerIndex(i,o.param1,l),e);break;case"sto":Je(n.computeSTOCH(i,o.param1,o.param2,o.param3),e);break;case"di":Je(n.computeDI(i,o.param1),e);break;case"sto rsi":Je(n.computeStochRSI(i,o.param1,o.param2,o.param3,o.param4,l),e);break;case"smi":Je(n.computeSMI(i,o.param1,o.param2,o.param3,o.param4),e);break;case"tsi":Je(n.computeTSI(i,o.param1,o.param2,o.param3),e);break;case"kvo":Je(n.computeKVO(i),e);break;case"kst":Je(n.computeKST(i,o.param1,o.param2,o.param3,o.param4,l),e);break;case"trix":Je(n.computeTRIX(i,o.param1,l),e);break;case"mass index":Je(n.computeMassIndex(i,o.param1),e);break;case"vroc":Je(n.computeVROC(i,o.param1),e);break;case"ac will":Ue(n.computeWILAC(i),e,"curve",0);break;case"will r":Je(n.computeWILR(i,o.param1),e);break;case"mfi":Je(n.computeMFI(i,o.param1),e);break;case"linearo":Ue(n.computeLinearCurve(i,o.param1,2,l),e,"curve",0);break;case"moonphase":Rr.chartPeriod>=0&&Ue(n.computeMoonPhase(i),e,"curve",0);break;case"elderbull":Ue(n.computeElderRay(i,o.param1,"bull"),e,"bar");break;case"elderbear":Ue(n.computeElderRay(i,o.param1,"bear"),e,"bar");break;case"forceindex":Ue(n.computeForceIndex(i,o.param1,l),e,"curve",0)}}function Ue(e,t,a,r){var o,i,l,s,c,d,u,h,p,m,f,g=t.ctx;if(Ye(t),null!=e){null!=(i=(o=t.Indicator).mm)&&0!=i&&(e.Values=n.computeMM(e.Values,i)),e.Values=qe(e.Values);var v,y,b,x,w,T=e.High,C=e.Low,S=e.Values.length,P=5;if("moonphase"==o.type&&(P=0),t.PxPointY=(t.HeightPx-17-P)/(T-C),l=Dr[0].PxPointX,s=Rr.paddingLeft+Rr.padBarCandle,Ne(g,t.HeightPx,s,T+17/t.PxPointY,t.PxPointY),c=s-1,t.V0=Math.round(t.PxPointY*T)+17,d=t.V0-Math.round(r*t.PxPointY),t.Bars={},"curve"==a){for(g.strokeStyle=o.v1?"transparent":o.color,g.beginPath(),g.moveTo(s,d),v=0;v<S;v++)null!=e.Values[v]&&((y=Math.round(v*l+s))-c>=1&&(g.lineTo(y,t.V0-Math.round(e.Values[v].v1*t.PxPointY)),c=y),w=v,t.Bars[e.Values[v].d]=e.Values[v].v1);null!=w&&(t.Bars[0]=e.Values[w].v1),g.save(),yr(g,o,1),br(g,1,o),g.stroke(),g.restore(),g.lineTo(c,d),g.lineTo(s,d),o.v2||(g.fillStyle=o.color2,g.fill())}if("bar"==a){for(0!=Rr.padBarCandle?((m=Math.floor(Rr.innerWidth/S)-1)<1&&(m=1),s=Rr.paddingLeft+Rr.padBarCandle-Math.round(m/2)):(s=Rr.paddingLeft,m=2),h=o.v1?"transparent":o.color,p=o.v2?"transparent":o.color2,v=0;v<S;v++)null!=e.Values[v]&&(y=Math.round(v*l+s),u=Math.round(-e.Values[v].v1*t.PxPointY),y-c>=1&&(g.fillStyle=u<=0?h:p,g.fillRect(y,t.V0,m,u),c=y),w=v,t.Bars[e.Values[v].d]=e.Values[v].v1);null!=w&&(t.Bars[0]=e.Values[w].v1)}if("awesome"==a||"bop"==a){for(0!=Rr.padBarCandle?((m=Math.floor(Rr.innerWidth/S)-1)<1&&(m=1),s=Rr.paddingLeft+Rr.padBarCandle-Math.round(m/2)):(s=Rr.paddingLeft,m=2),w=0,b=1;b<4&&(x="v"+b,3!=b||"bop"==a);b++)for(g.fillStyle=1==b?o.v1?"transparent":o.color:o[x]?"transparent":o["color"+b],v=0;v<S;v++)null!=e.Values[v]&&null!=e.Values[v][x]&&(y=Math.round(v*l+s),u=Math.round(-e.Values[v][x]*t.PxPointY),g.fillRect(y,t.V0,m,u),t.Bars[e.Values[v].d]=e.Values[v][x],v>w&&(w=v,f=x));0!=w&&(t.Bars[0]=e.Values[w][f])}Pt(g,t,e.Values,s,l),Rr.set.nosticky||Xe(g,t.V0,t.Bars[0]||"",t.PxPointY,o.color),Lt(t)}else Lt(t)}function We(t,a){var r,o,i,l,s,c,d,u,h,p,m=a.ctx,f=t.High;Ye(a),null!=(o=(r=a.Indicator).mm)&&0!=o&&(t.Values=n.computeMMonVolume(t.Values,o)),t.Values=qe(t.Values);var g,v=t.Values.length,y=!1;for(a.PxPointY=(a.HeightPx-20)/f,a.V0=Math.round(a.PxPointY*f)+20,i=Dr[0].PxPointX,(l=Math.floor(Rr.innerWidth/v)-2)%2==0&&l++,l>21?l=21:l<0?l=1:l<2&&(l=2),s=Rr.paddingLeft+Rr.padBarCandle-Math.round(l/2),Ne(m,a.HeightPx,s,f+20/a.PxPointY,a.PxPointY),a.Bars={},m.fillStyle=r.v1?"transparent":r.color,m.beginPath(),u=Rr.innerWidth+Rr.paddingLeft,("volume"==r.type||"volumecash"==r.type)&&(p=3),"mf"==r.type&&(p=5),h=1;h<p;h++){for(m.fillStyle=1==h?r.v1?"transparent":r.color:r["v"+h]?"transparent":r["color"+h]||e(r.type)["color"+h],m.beginPath(),g=0;g<v;g++)null!=t.Values[g]&&t.Values[g]["v"+h]&&((y=Math.round(g*i+s))<u&&(d=y+l>u?u-y:l,y<Rr.paddingLeft&&(d=l-(Rr.paddingLeft-y),y=Rr.paddingLeft),m.rect(y,a.HeightPx,d,-t.Values[g]["v"+h]*a.PxPointY)),a.Bars[t.Values[g].d]=t.Values[g]["v"+h],g>c&&(c=g));m.fill()}null!=c&&(a.Bars[0]=a.Bars[t.Values[c].d]),Pt(m,a,t.Values,s,i),Rr.set.nosticky||Xe(m,a.HeightPx,a.Bars[0]||"",a.PxPointY,r.color),Lt(a)}function Je(t,a){var r,o,i,l,s,d,h,p,m,f,g,v,y,b=a.ctx;if(Ye(a),Lt(a),null!=t){var x=a.Indicator,w=x.type,T=x.mm;null!=T&&0!=T&&(t.Values=n.computeMM(t.Values,T)),r=17,o=5,("rsi"==w||"ultimate"==w)&&(r=0,o=0),t.Values=qe(t.Values);var C=t.High,S=t.Low,P=t.Values.length;if(a.PxPointY=(a.HeightPx-r-o)/(C-S),i=Dr[0].PxPointX,l=Rr.paddingLeft+Rr.padBarCandle,Ne(b,a.HeightPx,l,C+r/a.PxPointY,a.PxPointY),h=l-1,a.V0=Math.round(a.PxPointY*C)+r,a.Bars={},"roc"==w||"rsi"==w||"di"==w){switch(b.beginPath(),b.strokeStyle="#99ccff",w){case"roc":m=100;break;case"rsi":m=50;break;case"di":m=0}b.moveTo(Rr.paddingLeft,a.V0-Math.round(m*a.PxPointY)+.5),b.lineTo(Rr.widthGraph-Rr.paddingRight,a.V0-Math.round(m*a.PxPointY)+.5),b.stroke()}for("wto"==w&&(b.beginPath(),b.strokeStyle="rgba(255,0,0,0.7)",b.moveTo(Rr.paddingLeft,a.V0-Math.round(53*a.PxPointY)+.5),b.lineTo(Rr.widthGraph-Rr.paddingRight,a.V0-Math.round(53*a.PxPointY)+.5),b.stroke(),b.beginPath(),b.strokeStyle="rgba(0,128,0,0.7)",b.moveTo(Rr.paddingLeft,a.V0-Math.round(-53*a.PxPointY)+.5),b.lineTo(Rr.widthGraph-Rr.paddingRight,a.V0-Math.round(-53*a.PxPointY)+.5),b.stroke()),b.strokeStyle=x.v1?"transparent":x.color,b.beginPath(),f=0,b.moveTo(l,a.V0-Math.round(t.Values[0].v1*a.PxPointY)),s=1;s<P;s++)null!=t.Values[s]&&null!=t.Values[s].v1&&((d=Math.round(s*i+l))-h>=1&&(b.lineTo(d,a.V0-Math.round(t.Values[s].v1*a.PxPointY)),h=d),a.Bars[t.Values[s].d]="aroon"==w?[t.Values[s].v1,t.Values[s].v2]:t.Values[s].v1,p=s);if(null!=p&&(a.Bars[0]=t.Values[p].v1),b.save(),yr(b,x,1),br(b,1,x),b.stroke(),b.restore(),null!=t.Values[0].v2){for(h=l-1,b.strokeStyle=x.v2?"transparent":x.color2,b.beginPath(),b.moveTo(l,a.V0-Math.round(t.Values[0].v2*a.PxPointY)),s=1;s<P;s++)null!=t.Values[s]&&((d=Math.round(s*i+l))-h>=1&&(b.lineTo(d,a.V0-Math.round(t.Values[s].v2*a.PxPointY)),h=d),f=t.Values[s].v2);b.save(),yr(b,x,2),br(b,2,x),b.stroke(),b.restore()}if("dmi"==w){for(b.strokeStyle=x.v3?"transparent":x.color3,b.beginPath(),b.moveTo(l,a.V0-Math.round(t.Values[0].v3*a.PxPointY)),s=0;s<P;s++)null!=t.Values[s]&&(d=Math.round(s*i+l),b.lineTo(d,a.V0-Math.round(t.Values[s].v3*a.PxPointY)));for(b.save(),yr(b,x,3),br(b,3,x),b.stroke(),b.restore(),a.Bars={},s=0;s<P;s++)null!=t.Values[s]&&(a.Bars[t.Values[s].d]=[t.Values[s].v1,t.Values[s].v2,t.Values[s].v3],p=s);null!=p&&(a.Bars[0]=t.Values[p].v1)}if("macd"==w||"macdzl"==w||"wto"==w){for(h=l-1,b.beginPath(),b.moveTo(l,a.V0),g=x.v3?"transparent":null!=x.color3?x.color3:g=u(c(x.color2),.5),b.strokeStyle=g,a.Bars={},s=0;s<P;s++)null!=t.Values[s]&&((d=Math.round(s*i+l))-h>=1&&(b.lineTo(d,a.V0-Math.round((t.Values[s].v1-t.Values[s].v2)*a.PxPointY)),h=d),p=s,a.Bars[t.Values[s].d]=t.Values[s].v1-t.Values[s].v2);null!=p&&(a.Bars[0]=t.Values[p].v1),b.stroke(),b.lineTo(d,a.V0),b.lineTo(l,a.V0),b.fillStyle=g,b.fill()}Pt(b,a,t.Values,l,i),null!=e(x.type).sb&&(v=null!=x.sh?x.sh:e(x.type).sh,y=null!=x.sb?x.sb:e(x.type).sb,9999!=x.sh&&(b.beginPath(),3==x.shs&&(b.lineWidth=3),b.strokeStyle="rgba(255,0,0,0.5)",b.moveTo(Rr.paddingLeft,Math.round(a.V0-v*a.PxPointY)+.5),b.lineTo(Rr.widthGraph-Rr.paddingRight,Math.round(a.V0-v*a.PxPointY)+.5),b.stroke(),(null==x.shs||1==x.shs)&&(b.fillStyle="rgba(255,0,0,0.15)",b.fillRect(Rr.paddingLeft,1,Rr.innerWidth,a.V0-Math.round(v*a.PxPointY)))),9999!=x.sb&&(b.beginPath(),b.lineWidth=3==x.sbs?3:1,b.strokeStyle="rgba(0,128,0,0.5)",b.moveTo(Rr.paddingLeft,Math.round(a.V0-y*a.PxPointY)+.5),b.lineTo(Rr.widthGraph-Rr.paddingRight,Math.round(a.V0-y*a.PxPointY)+.5),b.stroke(),(null==x.sbs||1==x.sbs)&&(b.fillStyle="rgba(0,128,0,0.15)",b.fillRect(Rr.paddingLeft,a.V0-Math.round(y*a.PxPointY),Rr.innerWidth,a.V0-Math.round(y*a.PxPointY)))),b.lineWidth=1),Rr.set.nosticky||(0!=f?(Xe(b,a.V0,f,a.PxPointY,x.color2),Xe(b,a.V0,a.Bars[0]||"",a.PxPointY,x.color)):Xe(b,a.V0,a.Bars[0]||"",a.PxPointY,x.color))}}function je(){var e,t=Rr.histoLength;switch(t<=20?t=t+" JOUR"+(1!=t?"S":""):t<365?(t=Math.round(t/30),t+=" MOIS"):t=(t=Math.round(t/365))+" AN"+(1!=t?"S":""),e=Rr.chartPeriod){case 0:e="JOUR";break;case 7:e="HEBDO";break;case 30:e="MENSUEL";break;case 91:e="TRIMESTRIEL";break;case 365:e="ANNUEL";break;default:e=e>=-60?Math.abs(e)+" MINUTE"+(-1!=e?"S":""):Math.round(e/-60)+" HEURES"}b.qstxt(Ke("#eod_topinfo-")+" span:last-child",t+" - "+e)}function Ze(e){Gr={},Dr=[],Nt(),e||"function"==typeof stopTimers&&stopTimers()}function Ke(e){return e+Lr.callID}function et(a,r){var n,i,l,s,c;if(n=r?a.type:a,Nr.flagSave=!0,It(),Rr.mainChart.typedef.nolinearX){if(Hr.maxX=0,Hr.minX=0,null==Ir.Low&&y(Ir),Hr.minY=Ir.Low,Hr.maxY=Ir.High,Rr.isCompare&&Be(Ir.High,Ir.Low,Ir.QuoteTab[0].c),Rr.mainChart.type=n,Rr.mainChart.typedef=e(n),r&&(Rr.mainChart=t(Rr.mainChart,a)),Dr.length>1&&Dr.splice(0,1),Rr.mainChart.typedef.nolinearX)return void Mt();for(1!=Rr.histoLength||Rr.set.noVeilleIntra||((i=Ir.qv.c)>Hr.maxY&&(Hr.maxY=i),i<Hr.minY&&(Hr.minY=i)),s=Dr.length,l=0;l<s;l++)Dr[l].Bars=0==l?[]:{},delete Dr[l].canvas,delete Dr[l].ctx;return c=o(Dr),Ze(!0),Re(c),je(),X(),void k()}Rr.mainChart.type=n,Rr.mainChart.typedef=e(n),r&&(Rr.mainChart=t(Rr.mainChart,a)),Rr.mainChart.typedef.nolinearX?Mt():X()}function tt(){b.qsarem("#"+Lr.callID+" .shorderzn"),b.qsarem("#"+Lr.callID+" .shorderln")}function at(){for(var e,t,a,r,n,o,i,l,s,c,d=Nr.orders,u=Nr.orders.length,h=Dr[0].RealY+10,p=Dr[0].RealY+Dr[0].HeightPx-15,m=0;m<u;m++)(e=$e(d[m].Cours,Rr.logData)+Rr.paddingTop)>h&&e<p&&(t="A"==d[m].Sens?"buy":"sell",(a=document.createElement("div")).setAttribute("class","shorderzn"),(r=document.createElement("div")).setAttribute("class","ord1 "+t+"1"),a.appendChild(r),(n=document.createElement("div")).setAttribute("class","ord3 "+t+"3"),(o=document.createElement("div")).setAttribute("class","ord2 "+t+"2"),i="",l="closeshsimple",d[m].Nb>1&&(i="x"+d[m].Nb,l="closesh"+t),s="<span>"+d[m].Type+" "+d[m].Reg+": </span><span>"+d[m].Qte+" @ "+d[m].Cours+'</span><span class="closeShOrder '+l+'" data-name="'+d[m].Id+'">'+i+"</span>",n.innerHTML=s,a.appendChild(n),a.appendChild(o),a.style.top=e+"px",Lr.doc.appendChild(a),(c=document.createElement("div")).setAttribute("class",t+"3 shorderln"),c.style.top=e+"px",c.style.left=Rr.paddingLeft+"px",c.style.width=Rr.innerWidth+"px",Lr.doc.appendChild(c))}function rt(e){var t,a,r;Nt(),tt(),qr.sens=e,qr.last=Dr[0].Bars[0][0].c,t="buy"==e?.98*qr.last:1.02*qr.last,qr.popup=b.gi("orderzn"),null==Lr.doc.querySelector("orderzn")&&Lr.doc.appendChild(qr.popup),qr.cvs=b.gi(Ke("overlay-")),qr.ctx=qr.cvs.getContext("2d"),qr.oft=l(b.gi(Ke("rodgraph-"))),a=qr.popup.querySelector("div:nth-of-type(2)"),r=window.getComputedStyle(a).backgroundColor,qr.ctx.strokeStyle=r,qr.ctx.lineWidth=2,qr.ctx.setLineDash&&qr.ctx.setLineDash([]);var n=window.getComputedStyle(qr.popup).width.replace("px",""),o=parseInt((Rr.widthGraph-n)/2);qr.popup.style.left=o+"px",qr.popup.style.display="block",dt(t),qr.isMove=!1,["touchstart","mousedown"].forEach((function(e){b.gi("ordertype").addEventListener(e,it)})),Lr.clickHandler.forEach((function(e){b.qs(".closeorder").addEventListener(e,nt)})),b.gi("orderlevel").addEventListener("keydown",ot)}function nt(e){e.preventDefault(),ct(),qr.ctx.clearRect(0,0,qr.cvs.width,qr.cvs.height)}function ot(e){var t;13==(e.which?e.which:e.keyCode)&&(t=this.value,dt(parseFloat(t.replace(/,/g,"."))))}function it(e){e.preventDefault(),qr.isMove=!0,["touchmove","mousemove"].forEach((function(e){document.addEventListener(e,lt)})),["touchend","mouseup"].forEach((function(e){b.gi("ordertype").addEventListener(e,st),document.addEventListener(e,st)}))}function lt(e){e.preventDefault(),qr.isMove&&function(e){var t=s(e),a=parseInt(t.y-qr.oft.top),r=parseInt(t.x-qr.oft.left);a<Rr.paddingTop||a>Dr[0].HeightPx+Rr.paddingTop||dt(new la(r,a-Rr.paddingTop).y)}(e)}function st(e){e.preventDefault(),qr.isMove=!1,["touchmove","mousemove"].forEach((function(e){document.removeEventListener(e,lt)})),["touchend","mouseup"].forEach((function(e){b.gi("ordertype").removeEventListener(e,st),document.removeEventListener(e,st)}))}function ct(){var e=b.gi("orderzn");null!=e&&null!=e.offsetParent&&(qr.ctx.clearRect(0,0,qr.cvs.width,qr.cvs.height),["touchstart","mousedown"].forEach((function(e){b.gi("ordertype").removeEventListener(e,it)})),["touchend","mouseup"].forEach((function(e){document.removeEventListener(e,st)})),b.gi("orderlevel").removeEventListener("keydown",ot),Lr.clickHandler.forEach((function(e){b.qs(".closeorder").removeEventListener(e,nt)})),qr.popup.style.display="none",Lr.doc.parentNode.insertBefore(qr.popup,Lr.doc.nextSibling),k())}function dt(e){var t,a,r,n,o;qr.ctx.clearRect(0,0,qr.cvs.width,qr.cvs.height),t=e,e>Hr.maxY&&(e=Hr.maxY),e<Hr.minY&&(e=Hr.minY),r=(a=$e(e,Rr.logData)+Rr.paddingTop)+1,qr.ctx.beginPath(),qr.ctx.moveTo(Rr.paddingLeft,a),qr.ctx.lineTo(qr.cvs.width-Rr.paddingRight,a),qr.ctx.stroke(),qr.popup.style.top=r+"px",b.gi("orderlevel").value=p(t),n=function(e,t,a){var r={t:"limité",c:"limit"},n={t:"seuil de déclenchement",c:"stop"};return"buy"==a?e>=t?r:n:e<=t?r:n}(qr.last,e,qr.sens),null!=(o=b.gi("ordertype"))&&(o.textContent=n.t,o.setAttribute("order",n.c))}function ut(){var e=new XMLHttpRequest;e.open("POST",VGP.urlWS+"TraceDeleteSymbol",!0),e.setRequestHeader("Content-Type","application/json;charset=UTF-8"),e.send(JSON.stringify({userid:VGP.userID,symbol:Rr.symbol}))}function ht(e,t){var a,r=VGP.urlWS+"GetEvtList";"GET"==VGP.callType&&(r=r+"?symbol="+Rr.symbol+"&length="+Rr.histoLength+"&isIntraday="+(Rr.chartPeriod<0)),Nt(),(a=new XMLHttpRequest).open(VGP.callType,r,!0),a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),a.onload=function(){if(a.status>=200&&a.status<400){var r=JSON.parse(a.responseText);null!=r&&null!=r.d?(Nr.fiEvt=r.d,wt(e,0,t)):Nr.fiEvt="no",k()}},a.send(JSON.stringify({symbol:Rr.symbol,isIntraday:Rr.chartPeriod<0,length:Rr.histoLength}))}function pt(e,t,a,r,n){var o,i,l;if(Dr[0].Bars[a+1]=null,!(Rr.chartPeriod>=0)&&null!=Hr.qv&&null!=Hr.qd){var s,c,d=new Date,u=60*d.getHours()+d.getMinutes(),p=d.getFullYear().toString().substring(2,4)+h(d.getMonth()+1,"00")+h(d.getDate(),"00")+h(u,"0000")-Ir.QuoteTab[Ir.QuoteTab.length-1].d;if(c=p<30?Hr.qv:p>240||u>1080?Hr.qd:Hr.qv,(i=Ir.QuoteTab.length)<3)l=Ir.QuoteTab[0].d;else for(o=i-1;o>0;o--)if(Ir.QuoteTab[o].d-Ir.QuoteTab[o-1].d>480){l=Ir.QuoteTab[o].d;break}null==l&&(l=Ir.QuoteTab[0].d),s=new Se(l,0,0);var m=Dr[0].ctx,f=(c.h+c.l+c.c)/3,g=2*f-c.l,v=f+(c.h-c.l),y=2*f-c.h,b=f-(c.h-c.l),x=s.mx+Rr.paddingLeft;m.save(),e.v1||mt(m,e.color,x,f,1,n),e.v2||(mt(m,e.color2,x,y,1,n),mt(m,e.color2,x,b,2,n)),e.v3||(mt(m,e.color3,x,g,1,n),mt(m,e.color3,x,v,2,n)),m.restore()}}function mt(e,t,a,r,n,o){var i=$e(r,o)+.5*n,l=Rr;e.lineWidth=n,e.beginPath(),e.strokeStyle=t,e.moveTo(a,i),e.lineTo(l.widthGraph-l.paddingRight,i),e.fillStyle=c(t),e.fillText(r.toFixed(2),l.widthGraph-l.paddingRight-47,i-3),e.stroke()}function ft(e,t,a,r,o,i){var l,s,d,h,p,m,f,g,v,y,b,x={},w=Dr[0];if(w.Bars[r+1]={},null!=(l=n.computeIchimoku(Ir.QuoteTab,e.param1,e.param2,Rr.chartPeriod))){for(l.Values=qe(l.Values),s=l.Values.length,d=w.ctx,f=1;f<6;f++)if(!e[g="v"+f]){for(d.save(),d.strokeStyle=1==f?e.color:e["color"+f],5==f?null!=e.s5?br(d,5,e):br(d,3):br(d,f,e),d.beginPath(),yr(d,e,f),m=$e(l.Values[0][g],i),d.moveTo(t,m+.5),p=1;p<s;p++)null!=(y=l.Values[p])&&null!=y[g]&&(h=Math.round(p*w.PxPointX+t),m=$e(y[g],i),d.lineTo(h+.5,m+.5),1==f&&(x[y.d]=[y.v1,y.v2],v=p));d.stroke(),d.restore()}if(null!=v&&(y=l.Values[v],x[0]=[y.v1,y.v2]),w.Bars[r+1]=x,!e.v6){for(d.save(),null!=e.color6?(d.strokeStyle=e.color6,d.fillStyle=e.color6):(d.strokeStyle=u(c(e.color4),.3),d.fillStyle=u(c(e.color4),.3)),d.beginPath(),b=!1,p=s-1;p>=0;p--)null!=l.Values[p]&&null!=l.Values[p].v6&&(m=$e(l.Values[p].v6,i),b?(h=Math.round(p*w.PxPointX+t),d.lineTo(h+.5,m+.5)):(d.moveTo(Math.round(p*w.PxPointX+t)+.5,m+.5),b=!0));for(p=0;p<s;p++)null!=l.Values[p]&&(h=Math.round(p*w.PxPointX+t),m=$e(l.Values[p].v7,i),d.lineTo(h+.5,m+.5));d.closePath(),d.stroke(),d.fill(),d.restore()}}}function gt(e,t,a,r){var n,o,i,l,s,c,d,u,h,p,m,f,g={},v=Dr[0];if(v.Bars[r+1]={},e.datas2&&(n=e.datas2.QuoteTab,!e.v1)){for(o=n.length,(i=v.ctx).strokeStyle=e.color,i.save(),i.beginPath(),c=v.PxPointY*Ir.QuoteTab[Hr.minX].c,d=Math.round((v.V0-Ir.QuoteTab[Hr.minX].c)*v.PxPointY),i.moveTo(t,d),yr(i,e,1),br(i,1,e),u=0,s=0;s<o;s++)null!=n[s]&&null!=v.Bars[0][n[s].d]&&(p=v.Bars[0][n[s].d].i,l=Math.round(p*v.PxPointX+t),0==u?u=n[s].c:(h=(n[s].c-u)/u,i.lineTo(l+.5,d-h*c),g[n[s].d]=n[s].c,m=s));null!=m&&(g[0]=n[m].c),v.Bars[r+1]=g,i.stroke(),i.restore(),Rr.set.nosticky||0==o||(f=v.V0-(d-h*c)/v.PxPointY,Xe(i,v.V0,f,v.PxPointY,e.color,!0,null))}}function vt(e,t,a,r,o,i){var l,s={},c=Dr[0];if(c.Bars[r+1]={},(l=n.computeSupertrend(Ir.QuoteTab,e.param1,e.param2)).Values=qe(l.Values),null!=l.Values){for(var d,u,h,p,m,f,g,v=l.Values.length,y=c.ctx,b=0,x=1;x<3;x++)if(m="v"+x,p=!0,!e["v"+x]){for(y.save(),y.beginPath(),h=$e(l.Values[0][m],i),y.moveTo(t,h+.5),yr(y,e,x),y.strokeStyle=1==x?e.color:e.color2,u=1;u<v;u++)null!=(f=l.Values[u])&&(0==f[m]?(p&&y.stroke(),p=!1):(s[f.d]=f[m],d=Math.round(u*c.PxPointX+t),h=$e(f[m],i),p?y.lineTo(d+.5,h+.5):(y.beginPath(),y.moveTo(d+.5,h+.5),p=!0),u>b&&(b=u,g=m)));p&&y.stroke(),y.restore()}b>0&&(s[0]=l.Values[b][g]),c.Bars[r+1]=s}}function yt(e,t,a,r,o,i){var l,s,c,d,u,h,p,m,f,g=n.computeHighLow(Ir.QuoteTab,e.param1),v={},y=Dr[0];if(y.Bars[r+1]={},null==g)return null;for(l=y.ctx,g.Values=qe(g.Values),f=g.Values.length,u=1;u<3;u++)if(!e[h="v"+u])for(l.fillStyle=1==u?e.color:e.color2,c=0;c<f;c++)null!=g.Values[c]&&(s=Math.round(c*y.PxPointX+t),0!=g.Values[c][h]&&(l.beginPath(),d=$e(g.Values[c][h],i),l.arc(s,d,3,0,2*Math.PI),l.fill(),v[g.Values[c].d]=g.Values[c][h],p=c,m=h));null!=p&&(v[0]=g.Values[p][m]),y.Bars[r+1]=v}function bt(e,t,a,r,o,i){var l,s,c,d,u,h,p,m,f,g=n.computeSAR(Ir.QuoteTab,e.param1,e.param2),v={},y=Dr[0];if(y.Bars[r+1]={},g.Values=qe(g.Values),!((l=g.Values.length)<5)){for(s=y.ctx,m=0,h=1;h<3;h++)if(!e[p="v"+h])for(s.fillStyle=1==h?e.color:e.color2,d=5;d<l;d++)null!=g.Values[d]&&(c=Math.round(d*y.PxPointX+t),0!=g.Values[d][p]&&(s.beginPath(),u=$e(g.Values[d][p],i),s.arc(c,u,2,0,2*Math.PI),s.fill(),v[g.Values[d].d]=g.Values[d][p],d>m&&(m=d,f=p)));m>0&&(v[0]=g.Values[m][f]),y.Bars[r+1]=v}}function xt(e,t,a,r,n,o){var i,l,s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("class","svginfofi"),s.setAttribute("width","22"),s.setAttribute("height","22"),s.setAttribute("data-id",n),s.setAttribute("data-seq",o),(i=document.createElementNS("http://www.w3.org/2000/svg","circle")).setAttributeNS(null,"cx",11),i.setAttributeNS(null,"cy",11),i.setAttributeNS(null,"r",11),i.setAttributeNS(null,"fill",a),s.appendChild(i),(l=document.createElementNS("http://www.w3.org/2000/svg","text")).setAttributeNS(null,"x",7),l.setAttributeNS(null,"y",15),l.textContent=r,s.appendChild(l),s.style.top=t+"px",s.style.left=e-10+"px",Lr.doc.appendChild(s)}function wt(e,t,a){var r,n,o,i,l,s,c,d,u,h,p,m,f,g;if(b.clrem(["svginfofi"]),"no"!=Nr.fiEvt){if(0==Nr.fiEvt.length)return void(Nr.fiEvt="no");r=[],(i=Dr[0]).Bars[a+1]=[];var v,y=Ir.QuoteTab[Hr.minX].d,x=Ir.QuoteTab[Ir.QuoteTab.length-1].d,w=Nr.fiEvt.length;for(n=0;n<w;n++){if(v=Ir.QuoteTab[o],Nr.fiEvt[n].d>y&&Nr.fiEvt[n].d<=x)if(null!=i.Bars[0][Nr.fiEvt[n].d])r[i.Bars[0][Nr.fiEvt[n].d].i]={i:n,data:Nr.fiEvt[n]};else for(o=Hr.minX;o<=Hr.maxX;o++)if(null!=v&&v.d>=Nr.fiEvt[n].d&&null!=i.Bars[0][v.d]){r[i.Bars[0][v.d].i]={i:n,data:Nr.fiEvt[n]};break}Nr.fiEvt[n].d>y&&Nr.fiEvt[n].d>x&&null!=i.Bars[0][x]&&(l=Nr.fiEvt[n].d-Ir.QuoteTab[Ir.QuoteTab.length-1].d,l=0!=Rr.chartPeriod?Math.round(l/Rr.chartPeriod):Math.round(5*l/7),(s=i.Bars[0][x].i+l)<=Hr.maxX-l+2&&(r[s]={i:n,data:Nr.fiEvt[n]}))}for(u=r.length,p={},n=0;n<Rr.newsConfig.length;n++)p[Rr.newsConfig[n]]=!0;if(null!=u)for(n=1;n<u;n++)if(null!=r[n])for(c=Math.round(n*i.PxPointX+e),d=i.HeightPx-10,m=r[n].data.tabEvents.length,h=0;h<m&&!(p[r[n].data.tabEvents[h].evt]&&(f=r[n].i,g=h,c<Rr.widthGraph-Rr.paddingRight&&c>Rr.paddingLeft&&xt(c,d,r[n].data.tabEvents[h].c,r[n].data.tabEvents[h].evt,f,g),d-=22,h>=5));h++);[].forEach.call(b.qsa(".svginfofi"),(function(e){e.addEventListener("mouseenter",Tt)}))}}function Tt(){var e,t,a,r,n=this.getAttribute("data-id"),o=this.getAttribute("data-seq"),i=Nr.fiEvt[n].tabEvents[o],l=parseInt(this.style.left.replace("px","")),s=parseInt(this.style.top.replace("px","")),c=b.gi(Ke("eod_infofi-"));null==c&&((c=document.createElement("div")).id=Ke("eod_infofi-"),Lr.doc.appendChild(c)),c.setAttribute("class","eod_infofi"),e=Rr.chartPeriod<0?m(Nr.fiEvt[n].d):g(Nr.fiEvt[n].d,1),t=null!=i.u&&""!=i.u?'<a href="'+i.u+'" target = "_blank" > '+i.s+"</a>":i.s,t+="</br>"+e,c.innerHTML=t,c.style.display="block",a=c.clientWidth,r=c.clientHeight,l=l>a+20?l-(a+2):l+22,c.style.top=s-Math.round(r/2)+"px",c.style.left=l+"px",c.addEventListener("mouseleave",Ct)}function Ct(){b.clhide("eod_infofi")}function St(e,t){var a,r=e.length-t;for(r<0&&(r=0),a=r;a>=0;a--)if(null!=e[a])return e[a]}function Pt(e,t,a,r,n){if(null!=a[0].vm){var o,i,l=r-1,s=a.length,c=t.V0;for("volume"==t.Indicator.type&&(c=t.HeightPx),e.strokeStyle=t.Indicator.mmColor,e.beginPath(),e.moveTo(r,c-Math.round(a[0].vm*t.PxPointY)),i=1;i<s;i++)null!=a[i]&&(o=Math.round(i*n+r))-l>=2&&(e.lineTo(o,c-Math.round(a[i].vm*t.PxPointY)),l=o);e.stroke()}}function kt(e){var t,a;return-1!=e.indexOf("#")?3==(t=e.substring(1)).length&&(t+=t):t=c(e).substring(1),.2126*((a=parseInt(t,16))>>16&255)+.7152*(a>>8&255)+.0722*(a>>0&255)>130?"#000":"#fff"}function Mt(){var e,t,a,r;for(b.idempty(Ke("")),t=Dr.length,Gr={},e=0;e<t;e++)Dr[e].Bars=0==e?[]:{},delete Dr[e].canvas,delete Dr[e].ctx;for(Nt(),Hr.maxY=Ir.High,Hr.minY=Ir.Low,_e("rodgraph",Lr.doc),Lr.ctxback=b.gi(Ke("rodgraph-")).getContext("2d"),Ee(),VGP.chartSimple||(_e("topinfo",Lr.doc),_e("mainci",Lr.doc)),a=o(Dr),Dr=[],new Yt(0,1,Rr.mainChart.type,"main",0).Create(),r=a.length,e=0;e<r;e++)Dr.push(a[e]);Dr[0].DrawEncadre(),VGP.chartSimple||(_e("overlay",Lr.doc),_e("trace",Lr.doc),b.qstxt(Ke("#eod_topinfo-")+" span",Ir.Name)),je(),_t(!0),He(),k()}function _t(e){var t,a,r,n,o,i,l,s,d,h,p,m,f,g,y,x,w,T,C,S,P,k,M,_,E,V=Rr,L=V.mainChart.typedef,R=L.param1,I="",D=Dr[0];switch(Gr={},a="c",null!=L.source&&(a=L.source),V.mainChart.type){case"renko":if(null==R&&(R=+((Ir.High-Ir.Low)/20).toFixed(2)),I=R,!(t=Mr(Ir,R,a)))return;(t.QuoteTab.length>700||t.QuoteTab.length<5)&&(R=+((Ir.High-Ir.Low)/20).toFixed(2),t=Mr(Ir,R,a));break;case"line break":(R>5||R<1||null==R)&&(R=2),I=R,t=function(e,t,a){function r(e,a){var r;if(1==e)for(r=Math.min(p[a-1].l,p[a-2].l),r=p[a-t].l,d=1;d<t;d++)p[a-d].l<r&&(r=p[a-d].l);else for(r=p[a-t].h,d=1;d<t;d++)p[a-d].h>r&&(r=p[a-d].h);return r}var n,o,i,l,s,c,d,u,h={QuoteTab:e.QuoteTab},p=[],m=h.QuoteTab.length;if(t>5&&(t=5),t>m-5)return!1;for(i=v(h.QuoteTab[0],a),l=v(h.QuoteTab[0],a),n=1;n<t;n++)v(h.QuoteTab[n],a)>l&&(l=v(h.QuoteTab[n],a)),v(h.QuoteTab[n],a)<i&&(i=v(h.QuoteTab[n],a));for(v(h.QuoteTab[t-1],a)>v(h.QuoteTab[0],a)?(o=1,s=i):(o=0,s=l),n=0;n<t;n++)p.push({d:h.QuoteTab[n].d,l:i,h:l,s:o,c:h.QuoteTab[n].c});for(n=t;n<m;n++)if(c=p.length,u=h.QuoteTab[n],0==o){if(s=r(0,c),v(u,a)>s){o=1,p.push({d:u.d,l:p[c-1].h,h:v(u,a),s:1,c:u.c});continue}if(u.c<p[c-1].l){o=0,p.push({d:u.d,l:v(u,a),h:p[c-1].l,s:0,c:u.c});continue}}else{if(s=r(1,c),v(u,a)<s){o=0,p.push({d:u.d,l:v(u,a),h:p[c-1].l,s:0,c:u.c});continue}if(v(u,a)>p[c-1].h){o=1,p.push({d:u.d,l:p[c-1].h,h:v(u,a),s:1,c:u.c});continue}}return p.splice(0,t-1),1==p.length&&(p=[]),{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:p}}(Ir,R,a);break;case"kagi":null==R&&(R=+((Ir.High-Ir.Low)/30).toFixed(2)),t=function(e,t,a){var r,n,o,i,l,s,c,d,u,h,p={QuoteTab:e.QuoteTab},m=[],f=p.QuoteTab.length;if(f<5)return!1;for(v(p.QuoteTab[1],a)>v(p.QuoteTab[0],a)?(o=v(p.QuoteTab[0],a),i=v(p.QuoteTab[1],a),m.push({d:p.QuoteTab[0].d,l1:o,h1:i,c:p.QuoteTab[0].c,s:1}),n=1,l=!0,s=v(p.QuoteTab[0],a)):(o=v(p.QuoteTab[1],a),i=v(p.QuoteTab[0],a),m.push({d:p.QuoteTab[0].d,l2:o,h2:i,c:p.QuoteTab[0].c,s:0}),n=0,l=!1,c=v(p.QuoteTab[0],a)),r=2;r<f;r++)u=v(p.QuoteTab[r],a),h=m.length-1,1==n&&l?((d=u-m[h].h1)>0&&(m[h].h1=u,i=u),d<0&&d<-t&&(c=i,m.push({d:p.QuoteTab[r].d,l1:Math.max(u,s),h1:i,c:u,s:0}),u<s&&(m[m.length-1].l2=u,m[m.length-1].h2=s,n=0),l=!1,o=u)):1!=n||l?0!=n||l?0==n&&l&&((d=u-m[h].h2)<-t&&(m.push({d:p.QuoteTab[r].d,l2:u,h2:i,c:u,s:0}),n=0,l=!1,o=u,c=i),d>0&&(m[h].h2=Math.min(u,c),u>c&&(m[h].l1=c,m[h].h1=u,n=1),i=u)):((d=u-m[h].l2)<0&&(m[h].l2=u,o=u),d>0&&d>t&&(s=o,m.push({d:p.QuoteTab[r].d,l2:o,h2:Math.min(u,c),c:u,s:1}),u>c&&(m[m.length-1].l1=c,m[m.length-1].h1=u,n=1),l=!0,i=u)):((d=u-m[h].l1)>t&&(m.push({d:p.QuoteTab[r].d,l1:o,h1:u,c:u,s:1}),n=1,l=!0,s=o,i=u),d<0&&(m[h].l1=Math.max(u,s),u<s&&(m[h].l2=u,m[h].h2=s,n=0),o=u));return{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:m}}(Ir,R,a),I=R;break;case"equivolume":t=Ir;break;case"point figure":null==R&&(R=((Ir.High-Ir.Low)/50).toFixed(2)),null==(r=L.param2)&&(r=3),t=function(e,t,a,r){var n,o,i,l={QuoteTab:e.QuoteTab},s=[],c=l.QuoteTab.length;if(c<3||t<=0||a<=1)return!1;var d,u=v(l.QuoteTab[0],r),h=!0,p=l.QuoteTab[0].d;for(n=1;n<c;n++){if((d=v(l.QuoteTab[n],r)-u)>=t){h=!0;break}if(d<=-t){h=!1;break}}for(o=1,n=1;n<c;n++)i=(v(l.QuoteTab[n],r)-u)/t,h?(i>=1&&(u+=Math.floor(i)*t,o+=Math.floor(i)),i<=-a&&(s.push({d:p,f:!0,n:o,c:u}),p=l.QuoteTab[n].d,u+=Math.ceil(i)*t,h=!1,o=Math.floor(Math.abs(i)))):i>=a?(s.push({d:p,f:!1,n:o,c:u-t}),p=l.QuoteTab[n].d,u+=Math.floor(i)*t,h=!0,o=Math.floor(Math.abs(i))):i<=-1&&(u+=Math.ceil(i)*t,o+=Math.floor(Math.abs(i)));return 1!=o&&s.push({d:p,f:h,n:o,c:u}),{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:s}}(Ir,R,r,a),I=R+", "+r}if(VGP.chartSimple||b.idhtml(Ke("eod_mainchartinfos-"),'<div><span class="eod_param" data-name="'+V.mainChart.type+'"><span class="mci-p"></span> '+V.mainChart.type.toUpperCase()+" ("+I+")</span></div>"),null!=(n={Name:t.Name,High:t.High,Low:t.Low,QuoteTab:t.QuoteTab}).QuoteTab&&0!=n.QuoteTab.length){Hr.maxNL=n.QuoteTab.length,(0==Hr.maxX&&0==Hr.minX||e)&&(Hr.maxX=n.QuoteTab.length-1,Hr.minX=0),n.QuoteTab=qe(t.QuoteTab);var A,H=n.High,B=n.Low,G=n.QuoteTab.length;0==Hr.maxY&&0==Hr.minY?(Hr.maxY=H,Hr.minY=B):(H=Hr.maxY,B=Hr.minY),D.PxPointY=(D.HeightPx-57)/(H-B),D.V0=H+37/D.PxPointY;var q=D.V0,Y=D.PxPointY,N=D.ctx;if(0!=G){switch((o=Math.floor(V.innerWidth/G)-1)%2==0&&o++,V.padBarCandle=o,i=V.paddingLeft+V.padBarCandle,Ne(N,D.HeightPx,i,q,Y),d=(V.innerWidth-2*V.padBarCandle)/(G-1),D.PxPointX=d,"equivolume"==V.mainChart.type?Ye(D,!0,(n=function(e,t){for(var a,r,n,o={QuoteTab:e.QuoteTab},i=[],l=o.QuoteTab.length,s=0,c=0,d=0;d<l;d++)null!=o.QuoteTab[d]&&(c+=o.QuoteTab[d].v);for(c+=1e3*c,d=0;d<l;d++)null!=(r=o.QuoteTab[d])&&(a=Math.round(1e3*r.v/c*t),n=r.c>=r.o,i.push({d:r.d,l:r.l,h:r.h,s:n,w:a,c:r.c,cu:s,o:r.o}),s+=a);return{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:i}}(n,V.innerWidth-5)).QuoteTab,!0):Ye(D,!0,n.QuoteTab),Br=[],D.Bars[0]={},h={},N.save(),V.mainChart.type){case"equivolume":for(l=V.paddingLeft,A=0;A<G;A++)if(null!=(p=n.QuoteTab[A])){for(f=Math.round((q-p.l)*Y),g=Math.round((q-p.h)*Y),y=Math.round((q-p.c)*Y),x=Math.round((q-p.o)*Y),p.s?(N.fillStyle=u(c(L.color),.4),N.strokeStyle=L.color):(N.fillStyle=u(c(L.color2),.4),N.strokeStyle=L.color2),(L.v1||!p.s)&&(L.v2||p.s)||(N.beginPath(),N.rect(l+.5,g+.5,p.w,f-g),N.stroke(),N.fill()),N.fillStyle=p.s?u(c(L.color),.8):u(c(L.color2),.8),(L.v1||!p.s)&&(L.v2||p.s)||(N.beginPath(),N.rect(l+.5,Math.max(y,x),p.w,-Math.abs(y-x)),N.fill()),h[p.d]={c:p.c.toFixed(2),i:A},m=A,Br[Math.floor(l+p.w/2)]={d:p.d,i:A},s=l;s<=l+p.w;s++)Gr[s]=p.d;l+=p.w}p=n.QuoteTab[m],h[0]={c:p.c.toFixed(2),i:m,d:p.d};break;case"point figure":for(w=Math.floor(o/2),C=Math.round(d),S=R*Y,A=0;A<G;A++)if(null!=(p=n.QuoteTab[A])){if(T=Math.round((q-p.c)*Y),l=Math.round(A*d+i)-w,p.f){for(N.strokeStyle=L.color,N.beginPath(),s=0;s<p.n;s++)T+=S,L.v1||(N.moveTo(l,T),N.lineTo(l+C,T-S),N.moveTo(l+C,T),N.lineTo(l,T-S));N.stroke()}else for(N.strokeStyle=L.color2,s=0;s<p.n;s++)T-=S,L.v2||(N.save(),N.beginPath(),N.translate(l,T),N.scale(C/2,S/2),N.arc(1,1,1,0,2*Math.PI,!1),N.restore(),N.stroke());for(h[p.d]={c:p.c.toFixed(2),i:A},m=A,Br[Math.floor(l+w)-V.paddingLeft]={d:p.d,i:A},s=0;s<=C;s++)Gr[l+s]=p.d}null!=m&&(p=n.QuoteTab[m],h[0]={c:p.c.toFixed(2),i:m,d:p.d});break;case"renko":case"line break":if(N.strokeStyle=L.color3,w=Math.floor(o/2),!L.v1){for(N.beginPath(),N.fillStyle=L.color,A=0;A<G;A++)if(null!=(p=n.QuoteTab[A]))for(l=Math.round(A*d+i)-w,1==p.s&&(f=Math.round((q-p.l)*Y),g=Math.round((q-p.h)*Y),N.rect(l+.5,g+.5,Math.round(d),f-g)),h[p.d]={c:p.c.toFixed(2),i:A},m=A,Br[Math.floor(l+w)-V.paddingLeft]={d:p.d,i:A},s=-w;s<=w;s++)Gr[l+s]=p.d;p=n.QuoteTab[m],h[0]={c:p.c.toFixed(2),i:m,d:p.d},L.v3&&(N.strokeStyle=L.color),N.stroke(),N.fill()}if(!L.v2){for(N.beginPath(),N.fillStyle=L.color2,A=0;A<G;A++)null!=(p=n.QuoteTab[A])&&(l=Math.round(A*d+i)-w,0==p.s&&(f=Math.round((q-p.l)*Y),g=Math.round((q-p.h)*Y),N.rect(l+.5,g+.5,Math.round(d),f-g)));L.v3&&(N.strokeStyle=L.color2),N.stroke(),N.fill()}break;case"kagi":for(N.lineWidth=3,A=0;A<G;A++)if(null!=(p=n.QuoteTab[A]))for(E=Math.round(A*d+i)-o+.5,l=Math.round((A+1)*d+i)-o+.5,P=Math.round((q-p.l1)*Y)+.5,k=Math.round((q-p.h1)*Y)+.5,M=Math.round((q-p.l2)*Y)+.5,_=Math.round((q-p.h2)*Y)+.5,null!=p.l1&&null!=p.l2&&(1==p.s?(L.v2||(N.beginPath(),N.strokeStyle=L.color2,N.moveTo(E,M),N.lineTo(l,M),N.lineTo(l,_-1),N.stroke()),L.v1||(N.beginPath(),N.strokeStyle=L.color,N.moveTo(l,P),N.lineTo(l,k-1.5),N.stroke())):(L.v1||(N.beginPath(),N.strokeStyle=L.color,N.moveTo(E,k),N.lineTo(l,k),N.lineTo(l,P+1),N.stroke()),L.v2||(N.beginPath(),N.strokeStyle=L.color2,N.moveTo(l,_),N.lineTo(l,M+1.5),N.stroke()))),null==p.l2&&(L.v1||(N.beginPath(),N.strokeStyle=L.color,1==p.s?(N.moveTo(E,P),N.lineTo(l,P),N.lineTo(l,k-1.5)):(N.moveTo(E,k),N.lineTo(l,k),N.lineTo(l,P+1.5)),N.stroke())),null==p.l1&&(L.v2||(N.beginPath(),N.strokeStyle=L.color2,1==p.s?(N.moveTo(E,M),N.lineTo(l,M),N.lineTo(l,_-1.5)):(N.moveTo(E,_),N.lineTo(l,_),N.lineTo(l,M+1.5)),N.stroke())),h[p.d]={c:p.c.toFixed(2),i:A},m=A,Br[Math.floor(l-.5)-V.paddingLeft]={d:p.d,i:A},s=E-.5;s<=l-.5;s++)Gr[s]=p.d;p=n.QuoteTab[m],h[0]={c:p.c.toFixed(2),i:m,d:p.d}}N.restore(),D.Bars[0]=h,0!=G&&null!=h[0]&&"point figure"!=V.mainChart.type&&(V.set.nohighlow||(Xe(N,q,n.High,Y,"rgba(0, 128, 0, 1)",!0),Xe(N,q,n.Low,Y,"rgba(192, 0, 0, 1)",!0)),V.set.nosticky||Xe(N,q,h[0].c,Y,null,!0))}}}function Et(e,t,a,r,n,o,i){var l,s=$e(a.l,i),c=$e(a.h,i),d=$e(a.o,i),u=$e(a.c,i);e.rect(r+.5,u+.5,t-1,d-u),l=r+.5+n,Rr.mainChart.typedef.v3||(e.moveTo(l,c),e.lineTo(l,u),e.moveTo(l,d),e.lineTo(l,s)),Br[Math.floor(l)-Rr.paddingLeft]={d:a.d,i:o}}function Vt(){for(var e=Ir.QuoteTab.length,t=[],a={d0:Ir.QuoteTab[0].d,c:Hr.qv.c},r=1;r<e;r++)Ir.QuoteTab[r].d-Ir.QuoteTab[r-1].d>480&&(a.d=Ir.QuoteTab[r-1].d,t.push(a),a={d0:Ir.QuoteTab[r].d,c:Ir.QuoteTab[r-1].c});return a.d=Ir.QuoteTab[e-1].d,t.push(a),t}function Lt(e,t,a){var r;if(!(Rr.histoLength>20)){var n,o,i,l,s,h=Vt(),p=h.length,m=e.ctx;for(m.save(),r=Rr.set.splitColor,i=Rr.widthGraph-Rr.paddingRight,n=p-1;n>=0;n--)s=$e(h[n].c,a),null!=Dr[0].Bars[0][h[n].d0]?(o=Dr[0].Bars[0][h[n].d0].i,l=Math.round(o*Dr[0].PxPointX)+.5+Rr.paddingLeft+Rr.padBarCandle):l=0,null!=Dr[0].Bars[0][h[n].d]?(o=Dr[0].Bars[0][h[n].d].i,i=Math.round(o*Dr[0].PxPointX)+.5+Rr.paddingLeft+Rr.padBarCandle):i=0,i<l&&(i=Rr.widthGraph-Rr.paddingRight),0==i&&(i=Rr.paddingLeft),0==l&&(l=Rr.paddingLeft),1==p&&0==i&&0==l&&(i=Rr.widthGraph-Rr.paddingRight,l=Rr.paddingLeft),!Rr.set.noVeilleIntra&&t&&(m.strokeStyle=Rr.set.veilleColor,m.lineWidth=Rr.set.veilleWidth||1,Rr.set.veilleStyle?br(m,0):br(m,3),m.beginPath(),m.moveTo(i,s+.5),m.lineTo(l,s+.5),m.stroke()),"none"!=Rr.set.splitStyle&&p>1&&("band"==Rr.set.splitStyle?n%2==0&&(m.fillStyle=1==d(r)?u(c(r),.2):r,m.fillRect(l,0,i-l,e.HeightPx)):l!=Rr.paddingLeft&&(m.strokeStyle=c(r),br(m,2),m.beginPath(),m.moveTo(l,0),m.lineTo(l,e.HeightPx),m.stroke()));m.restore()}}function Rt(e,t,a,r,n){var o,i,l,s=document.createElement("div");for(s.setAttribute("class","infoindic"),s.style.left=a+"px",s.style.top=r+"px",null!=n&&(s.style.width=n+"px"),s.id="infoindic-"+e,11!=Rr.set.fontSize&&(s.style.fontSize=Rr.set.fontSize+"px"),l=["closelayericon","indicname","eodupdown"],VGP.chartSimple&&(l=["indicname"]),o=0;o<l.length;o++)(i=document.createElement("span")).setAttribute("class",l[o]),"#606060"!=Rr.set.txtColor&&(i.style.color=Rr.set.txtColor),"indicname"==l[o]&&(i.textContent=t),s.appendChild(i);return s}function It(){Wt(),ct();var e=document.querySelector(".linemodif");null!=e&&(document.removeEventListener("keydown",aa),document.removeEventListener("keydown",ta),e.getAttribute("cid")==Lr.callID&&(ca(),b.gi(Ke("trace-")).removeEventListener("touchend",ia),b.gi(Ke("trace-")).removeEventListener("mousedown",ia),b.clrem(["linemodif","resizehandler"]),k(),Rr.chartPeriod>=0&&Nr.flagSave&&!VGP.noAutoSaveTrace&&Dt())),Nr.flagSave=!1}function Dt(e){var t,a;return!!r()&&("[]"==(t=localStorage.getItem(Rr.symbol))||null==t?(ut(),delete VGP.drawings[Rr.symbol],!1):e?t:((a=new XMLHttpRequest).open("POST",VGP.urlWS+"TraceSaveSymbol",!0),a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),void a.send(JSON.stringify({userid:VGP.userID,symbol:Rr.symbol,content:t}))))}function At(){var e,t,a,r,n,o=Rr.heightGraph-Rr.paddingBottom-Rr.paddingTop,i=Dr.length;for(i>1&&(o-=Rr.marginInter*(Dr.length-1)),Rr.usableHeight=o,t=[0,.25,.2,.1666,.15,.13,.12][i-1],e=r=[1,.75,.6,.5002,.4,.35,.28][i-1],Dr[0].Resize(0,r,0),a=1;a<i;a++)n=Math.round(e*Rr.usableHeight)+Rr.paddingTop+Rr.marginInter*a+5,Dr[a].Resize(e,t,a*Rr.marginInter),b.idcss(Ke("infoindic-")+a,"top",n+"px"),e+=t,i>2&&Ht(a,a==i-1);b.gi(Ke("trace-")).height=Dr[0].HeightPx}function Ht(e,t){var a;a=t?'<span class="eodmoveup"/></span>':e>1?'<span class="eodmoveup" /></span><span class="eodmovedown" /></span>':'<span class="eodmovedown" /></span>',b.qshtml(Ke("#infoindic-")+e+" .eodupdown",a)}function Bt(e){var t,a,r,n,o=Dr.length;new Yt(0,0,e,Ke("indic-")+o).Create(),(t=b.gi(Ke("overlay-"))).parentNode.insertBefore(b.gi(Ke("indic-")+o),t),a=Rt(Lr.callID+o,e.type,Rr.paddingLeft+5,Dr[o].RealY+5),o>1&&null!=(r=a.querySelector(".eodupdown"))&&((n=document.createElement("span")).setAttribute("class","eodmoveup"),r.appendChild(n)),Lr.doc.appendChild(a),At(),X()}function Gt(e){var t,a,r,n;for(b.idrem(Ke("indic-")+e),b.idrem(Ke("infoindic-")+e),(t=[])[0]=Dr[0],a=1,n=Dr.length,r=1;r<n;r++)r!=e&&(t[a]=Dr[r],b.gi(Ke("indic-")+r).setAttribute("id",Ke("indic-")+a),b.gi(Ke("infoindic-")+r).setAttribute("id",Ke("infoindic-")+a),b.qsaempty(Ke("#infoindic-")+a+" .eodupdown"),a++);Dr=t,At(),X()}function qt(e,t,a,r,n,o,i,l,s,c,d,u,h){this.x0=e,this.y0=t,this.x1=a,this.y1=r,this.color=n,this.type=c,this.width=null!=l?l:1,this.style=null!=s?s:1,null!=h&&(this.fontSize=h),null!=d&&(this.h=d),null!=u&&(this.color2=u),Rr.set.semilog&&null!=Rr.logData&&0!=t&&2e4!=r?(this.RealY0=$e(t,Rr.logData),this.RealY1=$e(r,Rr.logData)):(this.RealY0=Math.round((Dr[0].V0-t)*Dr[0].PxPointY),this.RealY1=Math.round((Dr[0].V0-r)*Dr[0].PxPointY)),0==e&&0==a?(this.RealX0=0,this.RealX1=Rr.widthGraph-Rr.paddingRight):0==a?(this.RealX1=Rr.widthGraph-Rr.paddingRight,this.RealX0=o):(this.RealX0=o,this.RealX1=i)}function Yt(e,t,a,r,n){this.Y=e,this.RealY=Math.round(e*Rr.usableHeight)+Rr.paddingTop+n,this.Height=t,this.HeightPx=Math.round(t*Rr.usableHeight),this.PxPointY=0,this.PxPointX=0,this.V0=0,this.id=r,this.Indicator=a,this.Bars=[]}function Nt(){var e,t;null!=Lr.doc&&(Lr.doc.removeEventListener("mousewheel",N),Lr.doc.removeEventListener("DOMMouseScroll",N),Lr.doc.removeEventListener("mouseleave",E),Lr.doc.removeEventListener("touchmove",L),Lr.doc.removeEventListener("mousemove",L),Lr.doc.removeEventListener("mouseup",D),Lr.doc.removeEventListener("mousedown",I),Lr.doc.removeEventListener("touchstart",I),Lr.doc.removeEventListener("touchend",D),(e=b.gi("indicList"))&&(e.removeEventListener("mousedown",R),e.removeEventListener("touchstart",R))),ca(),(t=b.gi(Ke("trace-")))&&(t.removeEventListener("touchend",ia),t.removeEventListener("mousedown",ia)),Nr.eventsActive=!1}function Xt(e){b.gi("param1Automatic").addEventListener("change",(function(){this.checked&&(Rr.mainChart.typedef["param"+e]=null,X(!1,!0),b.gi("mperiod"+e).value="")}))}function $t(a,r,n){var o,i,l,s,d,h,p,m,f,g,v,y,x,w,T,C,S,P,k,M;if(0==b.qsa(".params_zone").length){if(Nt(),(i=document.createElement("div")).id=Ke("uParams-"),i.setAttribute("class","uParams"),i.style.height="100%",i.innerHTML='<div style="top:'+Rr.paddingTop+"px;left:"+Rr.paddingLeft+'px" class="params_zone"><div class="params_zone_in clearfix"><img class="closeparams" /></div><div class="params_content"></div></div>',Lr.doc.appendChild(i),null!=n&&(r=Dr[n].Indicator.type),l=e(r),null!=n?Dr[n].Indicator=t(l,Dr[n].Indicator):null!=a?Rr.mainChart.indicators[a]=t(l,Rr.mainChart.indicators[a]):Rr.mainChart.typedef=t(l,Rr.mainChart.typedef),null!=l.params.p)for(d=l.params.p.length,s=0;s<d;s++){if(h=10,null==(h=null!=n?Dr[n].Indicator["param"+(s+1)]:null!=a?Rr.mainChart.indicators[a]["param"+(s+1)]:Rr.mainChart.typedef["param"+(s+1)])&&(h=""),(p=document.createElement("div")).setAttribute("class","clearfix pad5"),o='<div class="eod_pname">'+l.params.p[s]+'</div><input value="'+h+'" class="eod_inp" onkeypress="return isNumberLetterKey(event)" id="mperiod'+(s+1)+'" type="text" />',["renko","line break","kagi","point figure"].indexOf(r)<0){var _=2,E=100,V=1;switch(r){case"zig zag":_=.1,E=20,V=.1;break;case"sar":_=.02,E=.06,V=.01;break;case"evmm":s+1==2&&(_=.1,E=15,V=.1);break;case"boll":s+1==2&&(_=.1,E=10,V=.1);break;case"lineard":s+1==2&&(_=.1,E=10,V=.1)}p.innerHTML=o+'<div class="eod_slider"><div id="slider'+(s+1)+'" class="sliderout" min="'+_+'" max="'+E+'" step="'+V+'" value="'+h+'"></div></div>',b.qs(".params_content").appendChild(p),Ut(s+1,a,n)}else"point figure"==r&&1==s?(p.innerHTML=o+"</div>",b.qs(".params_content").appendChild(p)):(p.innerHTML=o+'<input id="param1Automatic" type="checkbox"><span>'+lang.l_automatic+"</span>",b.qs(".params_content").appendChild(p),""==h&&(b.gi("param1Automatic").checked=!0),Xt(s+1));Ot(s+1,a,r,n)}if(null!=l.params.c){for(m=l.params.c.length,s=0;s<m;s++){if(f="",null!=l.params.w){switch(l.params.w[s]){case"sw":f='<div id="w'+(s+1)+'" class="widthSelect w1"></div><div id="s'+(s+1)+'" class="styleSelect s2"></div>';break;case"s":f='<div id="s'+(s+1)+'" class="styleSelect s2">';break;case"w":f='<div id="w'+(s+1)+'" class="widthSelect w1">';break;case"o":f='<div id="o'+(s+1)+'" class="opSelect">'}f+="</div>"}g="",v=!1,null!=n?Dr[n].Indicator["v"+(s+1)]&&(v=!0):null!=a?Rr.mainChart.indicators[a]["v"+(s+1)]&&(v=!0):Rr.mainChart.typedef["v"+(s+1)]&&(v=!0),v||(g='checked="true"'),o='<input class="eod_cbv" id="v'+(s+1)+'" type="checkbox" '+g+' /><div class="eod_cname">'+l.params.c[s]+'</div><input id="color'+(s+1)+'" type="text" />'+f,(y=document.createElement("div")).setAttribute("class","clearfix pad5"),y.innerHTML=o,b.qs(".params_content").appendChild(y),w=s+1==1?"color":"color"+(s+1),x=c(null!=n?Dr[n].Indicator[w]:null!=a?Rr.mainChart.indicators[a][w]:Rr.mainChart.typedef[w]),zt(s+1,a,n,x,l.type)}!function(e,t,a){function r(t){if(t.preventDefault(),""==this.innerHTML){b.qsarem(".widthSelect ul"),b.qsarem(".styleSelect ul");var r=this.id,n=parseInt(r.slice(-1)),o=document.createElement("div");o.setAttribute("class","opContent"),o.innerHTML='<div class="sliderout" id="sliderO" min="0" max="100" step="1">',this.appendChild(o),function(e,t,a){var r=1==t?"color":"color"+t;new Slider({wrapperEl:"#sliderO",value:50,onSlide:function(t){var n;t/=100,n=null!=e?Dr[e].Indicator[r]:null!=a?Rr.mainChart.indicators[a][r]:Rr.mainChart.typedef[r],Ft(e,r,u(c(n),t),a),$(null==e?0:e)}})}(a,n,e)}else this.innerHTML=""}function n(t){if(t.preventDefault(),"LI"==t.target.nodeName){var r=parseInt(t.target.className.slice(-1));return Ft(a,this.id,r,e),this.innerHTML="",void $(null==a?0:a)}""==this.innerHTML?(b.qsarem(".styleSelect ul"),b.qsarem(".widthSelect ul"),this.innerHTML=Qt("w")):this.innerHTML=""}function o(t){if(t.preventDefault(),"LI"==t.target.nodeName){var r=parseInt(t.target.className.slice(-1));return Ft(a,this.id,r,e),this.innerHTML="",void $(null==a?0:a)}""==this.innerHTML?(b.qsarem(".styleSelect ul"),b.qsarem(".widthSelect ul"),this.innerHTML=Qt("s")):this.innerHTML=""}[].forEach.call(b.qsa(".opSelect"),(function(e){Lr.clickHandler.forEach((function(t){e.addEventListener(t,r)}))})),[].forEach.call(b.qsa(".widthSelect"),(function(e){Lr.clickHandler.forEach((function(t){e.addEventListener(t,n)}))})),[].forEach.call(b.qsa(".styleSelect"),(function(e){Lr.clickHandler.forEach((function(t){e.addEventListener(t,o)}))})),[].forEach.call(b.qsa(".eod_cbv"),(function(t){t.addEventListener("change",(function(){var t=this.id,r=this.checked;null==a?(null==e?r?delete Rr.mainChart.typedef[t]:Rr.mainChart.typedef[t]=!0:r?delete Rr.mainChart.indicators[e][t]:Rr.mainChart.indicators[e][t]=!0,$(0)):(r?delete Dr[a].Indicator[t]:Dr[a].Indicator[t]=!0,$(a))}))}))}(a,0,n)}if(null!=n){if(null!=e(Dr[n].Indicator.type).sb){var L='<option value="1">'+lang.l_zone+'</option><option value="2">'+lang.l_traitfi+'</option><option value="3">'+lang.l_traitep+"</option>",R='<input id="cbSeuilH" checked="checked" type="checkbox" /><div class="eod_cname">'+lang.l_upperb+'</div><input id="valSeuilH" type="text" onkeypress="return isNumberLetterKey(event)" /><select id="stylSeuilH">'+L+"</select>",I='<input id="cbSeuilB" checked="checked" type="checkbox" /><div class="eod_cname">'+lang.l_lowerb+'</div><input id="valSeuilB" type="text" onkeypress="return isNumberLetterKey(event)" /><select id="stylSeuilB">'+L+"</select>",D=document.createElement("div");D.setAttribute("class","clearfix pad5"),D.innerHTML=R,(T=document.createElement("div")).setAttribute("class","clearfix pad5"),T.innerHTML=I,(C=b.qs(".params_content")).appendChild(D),C.appendChild(T),null==Dr[n].Indicator.sh?b.gi("valSeuilH").value=e(Dr[n].Indicator.type).sh:9999==Dr[n].Indicator.sh?(b.gi("cbSeuilH").checked=!1,b.gi("valSeuilH").disabled=!0,b.gi("stylSeuilH").disabled=!0):(b.gi("valSeuilH").value=Dr[n].Indicator.sh,null!=Dr[n].Indicator.shs&&(b.gi("stylSeuilH").value=Dr[n].Indicator.shs)),null==Dr[n].Indicator.sb?b.gi("valSeuilB").value=e(Dr[n].Indicator.type).sb:9999==Dr[n].Indicator.sb?(b.gi("cbSeuilB").checked=!1,b.gi("valSeuilB").disabled=!0,b.gi("stylSeuilB").disabled=!0):(b.gi("valSeuilB").value=Dr[n].Indicator.sb,null!=Dr[n].Indicator.sbs&&(b.gi("stylSeuilB").value=Dr[n].Indicator.sbs)),b.gi("cbSeuilH").addEventListener("change",(function(){var t,a=b.gi("valSeuilH"),r=b.gi("stylSeuilH");this.checked?(9999==(t=e(Dr[n].Indicator.type).sh)&&(t=90),Dr[n].Indicator.sh=t,a.disabled=!1,a.value=t,r.disabled=!1):(Dr[n].Indicator.sh=9999,a.disabled=!0,r.disabled=!0),$(n)})),b.gi("cbSeuilB").addEventListener("change",(function(){var t,a=b.gi("valSeuilB"),r=b.gi("stylSeuilB");this.checked?(9999==(t=e(Dr[n].Indicator.type).sb)&&(t=10),Dr[n].Indicator.sb=t,a.disabled=!1,a.value=t,r.disabled=!1):(Dr[n].Indicator.sb=9999,a.disabled=!0,r.disabled=!0),$(n)})),b.gi("stylSeuilH").addEventListener("change",(function(){Dr[n].Indicator.shs=this.value,$(n)})),b.gi("stylSeuilB").addEventListener("change",(function(){Dr[n].Indicator.sbs=this.value,$(n)})),b.gi("valSeuilH").addEventListener("keyup",(function(){Dr[n].Indicator.sh=parseInt(this.value.replace(",",".")),$(n)})),b.gi("valSeuilB").addEventListener("keyup",(function(){Dr[n].Indicator.sb=parseInt(this.value.replace(",",".")),$(n)}))}["macd","macdzl","wto","dmi","adx","macdh","sto","aroon","qstick","ewo","ppo","moonphase","awesome","vortex","kst","kvo","bop","tsi","smi","sto rsi","equity","forceindex","tvi","rvi","mf"].indexOf(Dr[n].Indicator.type)<0&&((S=document.createElement("div")).setAttribute("class","clearfix pad5"),S.innerHTML='<input id="cbMM" type="checkbox" /><div class="eod_cname">'+lang.l_moymob+'</div><input id="colorMM" type="text" name="colorMM" value="#fe0000" /><input id="valMM" value="5" type="text" onkeypress="return isIntNumberKey(event)" />',b.qs(".params_content").appendChild(S),P=new ColorPicker({wrapperEl:"#colorMM",value:"#fe0000",onChange:function(e){Dr[n].Indicator.mmColor=e,$(n)}}),null!=Dr[n].Indicator.mm&&(b.gi("cbMM").checked=!0,b.gi("valMM").value=Dr[n].Indicator.mm,P.change(Dr[n].Indicator.mmColor)),b.gi("cbMM").addEventListener("change",(function(){var e,t=b.gi("valMM");if(this.checked){if(t.disabled=!1,e=parseInt(t.value),isNaN(e))return;Dr[n].Indicator.mm=e,Dr[n].Indicator.mmColor=b.gi("colorMM").value}else delete Dr[n].Indicator.mm,delete Dr[n].Indicator.mmColor,t.disabled=!0;$(n)})),b.gi("valMM").addEventListener("keyup",(function(){var e=parseInt(this.value);isNaN(e)||(Dr[n].Indicator.mm=e,$(n))})))}["phpb","line","line2","renko","kagi","line break","mm","mme","mmp","mmh","cmoy","cmedian","double EMA","triple EMA","trix","bollw","bollb","boll","lineard","linearc","linearo","roc","kst","coppock","zig zag","mmt","evmm","rsi","mom","pvi","nvi","macd","macdh","std","sto rsi","point figure","ulcer"].indexOf(l.type)>=0&&((k=document.createElement("div")).innerHTML=lang.l_datasource,b.qs(".params_content").appendChild(k),null!=l.source&&b.qs("#datasource option[value='"+l.source+"']").setAttribute("selected","selected"),b.gi("datasource").addEventListener("change",(function(){Ft(n,"source",this.value,a),$(null==n?0:n)}))),(null!=n||null!=a)&&((M=document.createElement("div")).setAttribute("class","mtb10"),M.innerHTML='<span class="lnkmsg suppressMainIndic">'+lang.l_suppindic+"</span>",b.qs(".params_content").appendChild(M)),b.qs(".params_zone").style.display="block",Jt(a,n)}}function Ot(e,t,a,r){b.qs(".params_zone #mperiod"+e).addEventListener("keyup",(function(){var n=this.value.trim().replace(",",".");if(n=parseFloat(n),!isNaN(n)&&0!=n){switch(e){case 1:"sar"!=a&&"zig zag"!=a&&"renko"!=a&&"kagi"!=a&&"point figure"!=a&&(n=parseInt(n));break;case 2:"boll"!=a&&"evmm"!=a&&"lineard"!=a&&(n=parseInt(n));break;default:n=parseInt(n)}Ft(r,"param"+e,n,t),null==r?$(0,!0):$(r)}}))}function Qt(e){for(var t="<ul>",a=1;a<5;a++)t=t+'<li class="'+e+a+'"></li>';return t+"</ul>"}function Ft(e,t,a,r){null==e?null==r?Rr.mainChart.typedef[t]=a:Rr.mainChart.indicators[r][t]=a:Dr[e].Indicator[t]=a}function zt(t,a,r,n,o){var i=e(o);b.gi("color"+t)&&new ColorPicker({wrapperEl:"#color"+t,value:n,onChange:function(e){var n=1==t?"color":"color"+t,o=d(i[n]);null==o&&(o=1),e=u(e,o),Ft(r,n,e,a),$(null==r?0:r)}})}function Ut(e,t,a){var r=b.gi("mperiod"+e);new Slider({wrapperEl:"#slider"+e,onSlide:function(n){Math.round(n)-n!=0&&(n=n.toFixed(2)),r.value=n,Ft(a,"param"+e,+n,t),null==a?$(0,!0):$(a)}})}function Wt(){null!=b.gi(Ke("uParams-"))&&(b.idrem(Ke("uParams-")),k())}function Jt(e,t){function a(e){e.preventDefault(),e.stopPropagation(),Wt()}function r(e){"uParams"==e.target.className&&Wt()}function n(a){var r,n,o,i;if(a.preventDefault(),null==t){if(r=Rr.mainChart.indicators[e].type,Rr.mainChart.indicators.splice(e,1),Dr[0].Bars.splice(parseInt(e)+1,1),"compare"==r){for(o=Rr.mainChart.indicators.length,i=0,n=0;n<o;n++)"compare"==Rr.mainChart.indicators[n].type&&i++;if(0==i)for(Rr.isCompare=!1,n=1;n<Dr.length;n++)"fr"==Dr[n].Indicator.type&&Gt(n)}Rr.newsConfig&&(Nr.fiEvt=[],b.clrem(["svginfofi"])),$(0)}else Gt(t);Wt()}Lr.clickHandler.forEach((function(e){var t=b.qs(".closeparams");t&&t.addEventListener(e,a)})),Lr.clickHandler.forEach((function(e){b.gi(Ke("uParams-")).addEventListener(e,r)})),Lr.clickHandler.forEach((function(e){var t=b.qs(".suppressMainIndic");t&&t.addEventListener(e,n)}))}function jt(e,t){var a,r,n,i,l=parseInt(t.parentNode.parentNode.id.slice(-1)),s=Dr[l];for("up"==e?(a=Dr[l-1].Y,Dr[l]=Dr[l-1],Dr[l-1]=s,Dr[l-1].Y=a,Dr[l].Y=a+Dr[l-1].Height):(a=Dr[l].Y,Dr[l]=Dr[l+1],Dr[l+1]=s,Dr[l].Y=a,Dr[l+1].Y=a+Dr[l].Height),n=Dr.length,r=0;r<n;r++)Dr[r].Bars=0==r?[]:{},delete Dr[r].canvas,delete Dr[r].ctx;i=o(Dr),Ze(!0),Re(i),X(),k()}function Zt(e,t){return e>=0&&e<=Rr.innerWidth&&t>=0&&t<Dr[0].HeightPx+Rr.paddingTop-7}function Kt(e,t,a,r){for(var n=document.createElement("div"),o=a.length,i=0;i<o;i++)n.setAttribute(a[i].n,a[i].v);r&&(n.id=r),n.setAttribute("class","resizehandler"),n.style.left=e+"px",n.style.top=t+"px",Lr.doc.appendChild(n)}function ea(e){var t,a,r,n,o,i,l,s,c,d,u,h,p,m,f,g,v,y,b,x,T,C,S,P;if(It(),y=Rr,w(),b=Ar[e],(x=document.createElement("div")).setAttribute("cid",Lr.callID),x.setAttribute("onmousedown","mydragg.startMoving(this,'trace-"+Lr.callID+"',event);"),x.setAttribute("onmouseup","mydragg.stopMoving('trace-"+Lr.callID+"');"),x.setAttribute("class","linemodif"),x.setAttribute("name",e),x.style.left=y.paddingLeft+4+"px",x.style.top=y.paddingTop+4+"px",T='<div class="spg delLine" title="'+lang.l_supprimer+'"></div><input id="color1" type="text" name="color1" value="#000000" />',["t","rf","r","m","fa","ef","c","arrdw","arrup","arrrt","arrlt","p","wf"].indexOf(b.type)>=0&&(T=T+'<span class="eod_sp10">&nbsp;</span><input id="color2" type="text" name="color2" value="'+(null!=b.color2?b.color2:"#ffffff")+'" />'),"a"!=b.type&&(T=T+'<div title="Epaisseur du tracé" class="widthSelect w'+b.width+'"></div>',["rf","m","t","fa","arrup","arrdw","arrrt","arrlt","sm1","sm2","sm3"].indexOf(b.type)<0&&(T=T+'<div title="Style du tracé" class="styleSelect s'+b.style+'"></div>')),("v"==b.type||"sr"==b.type||"h"==b.type)&&(T=(T=T+'<div title="Taille du texte" class="fontSelect">'+(b.fontSize&&0!=b.fontSize?b.fontSize:12)+"</div>")+'<div class="fontSizeZone"><input type="checkbox" class="showtext" '+(0!=b.fontSize?"checked":"")+"> Légende</div>"),["mv","mh","rf","ef","af","cf","wf","ff","an","m","ewi","ewc","ga"].indexOf(b.type)>=0&&(T=T+'<div title="Taille du texte" class="fontSelect">'+(0!=b.fontSize&&null!=b.fontSize?b.fontSize:12)+"</div>"),"sr"==b.type&&(VGP.isSms&&(T=T+'<div class="spg eod_alert" title="'+lang.l_createalert+'"></div>'),T=T+'<input class="textSR" onkeypress="return isNumberKey(event)" id="srTxt" type="text" value="'+b.y0.toFixed(2)+'" /><input class="btnSR" id="srBtn" type="button" value="ok" />'),"a"==b.type&&(T=T+'<div class="fontSelect">'+(null!=b.fontSize?b.fontSize:12)+'</div><input autocomplete="off" id="annotationTxt" type="text"/>'),["fa","cf","mv","ewi","ewc","wf"].indexOf(b.type)<0&&(T=T+'<div class="spg eod_copy" title="'+lang.l_dupliquer+'"></div>'),x.innerHTML=T,Lr.doc.appendChild(x),"fa"==b.type)return g=y.paddingTop-9,v=y.paddingLeft-9,t=b.RealX0+v,a=b.RealY0+g,r=b.h.B.mx+v,n=b.h.B.my+g,i=b.h.C.mx+v,o=b.h.C.my+g,Zt(t,a)&&Kt(t,a,[{n:"name",v:e},{n:"pt",v:"A"}],"handlerfaA"),Zt(r,n)&&Kt(r,n,[{n:"name",v:e},{n:"pt",v:"B"}],"handlerfaB"),Zt(i,o)&&Kt(i,o,[{n:"name",v:e},{n:"pt",v:"C"}],"handlerfaC"),void oa();if("ewi"!=b.type&&"ewc"!=b.type){if("t"==b.type||"wf"==b.type)return g=y.paddingTop-8,v=y.paddingLeft-8,t=b.RealX0+v,a=b.RealY0+g,r=b.RealX1+v,n=b.RealY1+g,i=b.h.C.mx+v,o=b.h.C.my+g,"wf"==b.type?(Zt(t,a)&&Kt(t,a,[{n:"name",v:e}],"handler2oblic"),Zt(r,n)&&Kt(r,n,[{n:"name",v:e},{n:"pt",v:"B"}],"handlerWFB"),Zt(i,o)&&Kt(i,o,[{n:"name",v:e},{n:"pt",v:"C"}],"handlerWFC")):(Zt(t,a)&&Kt(t,a,[{n:"name",v:e},{n:"pt",v:"A"}],"handlerTA"),Zt(r,n)&&Kt(r,n,[{n:"name",v:e},{n:"pt",v:"B"}],"handlerTB"),Zt(i,o)&&Kt(i,o,[{n:"name",v:e},{n:"pt",v:"C"}],"handlerTC"),Zt(S=(t+r+i)/3,P=(a+n+o)/3)&&Kt(S,P,[{n:"name",v:e}],"handler2oblic")),void oa();if("ef"==b.type&&Kt(b.RealX1+b.h+y.paddingLeft-6,b.RealY1+y.paddingTop-8,[{n:"name",v:e}],"handlerEF"),"v"==b.type)return Kt(b.RealX0+y.paddingLeft-10,Math.round(Dr[0].HeightPx/2),[{n:"name",v:e}],"handlerV"),void oa();if("sr"==b.type)return Kt(b.RealX0+y.paddingLeft-15,b.RealY0+y.paddingTop-9,[{n:"name",v:e}],"handlerSR"),void oa();if("c"==b.type)return p=b.RealX0+y.paddingLeft-6,m=b.RealY0+y.paddingTop-10,f=b.RealX1+y.paddingLeft-9,Zt(p,m)&&Kt(p,m,[{n:"name",v:e}],"handler2oblic"),Zt(f,m)&&Kt(f,m,[{n:"name",v:e}],"handlerEllipse"),void oa();0==b.x0&&0==b.x1?Kt(Math.round(y.innerWidth/2),b.RealY0+y.paddingTop-9,[{n:"name",v:e}],"handlerH"):(g=y.paddingTop-9,v=y.paddingLeft-9,l=b.RealX0+v,d=b.RealY0+g,s=b.RealX1+v,u=b.RealY1+g,["a","arrup","arrdw","arrrt","arrlt","sm1","sm2"].indexOf(b.type)<0&&("an"!=b.type&&Zt(l,d)&&Kt(l,d,[{n:"name",v:e}],"handler0oblic"),Zt(s,u)&&Kt(s,u,[{n:"name",v:e}],"handler1oblic")),"p"==b.type?Zt(c=Math.round(b.RealX0+(b.RealX1-b.RealX0)/2)+v,h=Math.round(b.RealY1+(b.RealY0-b.RealY1)/2)+g+Math.round(b.h*Dr[0].PxPointY))&&Kt(c,h,[{n:"name",v:e}],"handlerPara"):Zt(c=Math.round(b.RealX0+(b.RealX1-b.RealX0)/2)+v,h=Math.round(b.RealY1+(b.RealY0-b.RealY1)/2)+g)&&Kt(c,h,[{n:"name",v:e}],"handler2oblic")),oa()}else{for(C=0;C<b.h.length;C++)Zt(t=b.h[C].mx+y.paddingLeft-8,a=b.h[C].my+y.paddingTop-8)&&Kt(t,a,[{n:"name",v:e},{n:"pt",v:C}],"handlerEW"+C);oa()}}function ta(e){"srTxt"!=e.target.id&&"annotationTxt"!=e.target.id&&(46==e.keyCode||8==e.keyCode)&&(e.preventDefault(),ra())}function aa(e){if("srTxt"!=e.target.id&&"annotationTxt"!=e.target.id)switch(e.keyCode){case 38:e.preventDefault(),na(0,-1);break;case 40:e.preventDefault(),na(0,1);break;case 37:e.preventDefault(),na(-(Math.floor(Dr[0].PxPointX)+1),0);break;case 39:e.preventDefault(),na(1,0);break;case 46:case 8:e.preventDefault(),ra()}}function ra(){var e=b.qsga(".linemodif","name");Ar.splice(e,1),O(),ke(Rr.symbol,Ar),Nr.flagSave=!0,It()}function na(e,t){var a,r=b.qsga(".linemodif","name"),n=o(Ar[r]);(0!=t||"h"!=n.type)&&(0!=e||"v"!=n.type)&&(a=vr(),Ar.splice(r,1),O(),fr(n,ur(a.ctx,n,e,t)))}function oa(){function e(e,t){1==t?x.color=e:x.color2=e,O(),ke(Rr.symbol,Ar)}function t(e){var t,a;e.preventDefault(),0==(t=parseFloat(b.gi("srTxt").value.replace(",",".")))||isNaN(t)||(x.y0=t,x.y1=t,a=Rr.set.semilog&&null!=Rr.logData?$e(t,Rr.logData):Dr[0].V0*Dr[0].PxPointY-t*Dr[0].PxPointY,x.RealY0=a,x.RealY1=a,b.gi("handlerSR").style.top=a+Rr.paddingTop-6+"px",O(),ke(Rr.symbol,Ar))}function r(e){e.preventDefault();var t=Ir.Name+";"+Rr.symbol+";"+x.y0.toFixed(3);sessionStorage.setItem("vartemp",t),Nr.flagSave=!0,It(),loadPopupHelp("graph_setalert6")}function n(e){var t,a;e.preventDefault(),t=o(x),"v"==x.type?(a=new la(t.RealX0+20,0),t.x0=a.x,t.x1=a.x):(t.y0=t.y0+20/Dr[0].PxPointY,t.y1=t.y1+20/Dr[0].PxPointY),Ar.push(t),It(),O(),ke(Rr.symbol,Ar),ea(Ar.length-1)}function i(){var e=b.gi("annotationTxt").value.trim();if(""==e)return!1;e=e.replace(/,/g,"."),x=a(e),O(),ke(Rr.symbol,Ar),Nr.flagSave=!0,It()}function l(e){if(e.preventDefault(),"LI"==e.target.nodeName){var t=parseInt(e.target.className.slice(-1));return x.width=t,O(),ke(Rr.symbol,Ar),this.setAttribute("class","widthSelect w"+t),void(this.innerHTML="")}""==this.innerHTML?(b.qsarem(".styleSelect ul"),b.qsarem(".widthSelect ul"),this.innerHTML=Qt("w")):this.innerHTML=""}function c(e){if(e.preventDefault(),"LI"==e.target.nodeName){var t=parseInt(e.target.className.slice(-1));return x.style=t,O(),ke(Rr.symbol,Ar),this.setAttribute("class","styleSelect s"+t),void(this.innerHTML="")}""==this.innerHTML?(b.qsarem(".styleSelect ul"),b.qsarem(".widthSelect ul"),this.innerHTML=Qt("s")):this.innerHTML=""}function d(e){var t,a,r,n,o,i;if(e.preventDefault(),t=this.innerHTML,"LI"==e.target.nodeName)return a=parseInt(e.target.getAttribute("data-name")),x.fontSize=a,O(),ke(Rr.symbol,Ar),this.innerHTML=a,void((r=b.qs(".showtext"))&&(r.checked=!0));if(this.innerHTML.length>2)this.innerHTML=t;else{for(b.qsarem(".styleSelect ul"),b.qsarem(".fontSelect ul"),n=[0,11,12,14,16,20,24,28,32,48],o="<ul>",i=1;i<10;i++)o=o+'<li data-name="'+n[i]+'">'+n[i]+"</li>";o+="</ul>",this.innerHTML=o}}function u(e){e.preventDefault(),ra()}function h(e){var t=e.target.id,a=o(Ar[y]);switch(t){case"handlerfaA":case"handlerfaB":case"handlerfaC":da(a,e.target.getAttribute("pt"));break;case"handlerEW0":case"handlerEW1":case"handlerEW2":case"handlerEW3":case"handlerEW4":case"handlerEW5":ga(a,e.target.getAttribute("pt"));break;case"handlerTA":case"handlerTB":case"handlerTC":case"handlerWFB":case"handlerWFC":pa(a,e.target.getAttribute("pt"));break;case"handlerEF":$a(a);break;case"handlerV":case"handlerSR":case"handlerH":Ra(a);break;case"handlerEllipse":rr(a);break;case"handlerPara":Wa(a);break;case"handler0oblic":case"handler1oblic":var r=x.RealX1,n=x.RealY1,i=x.x1;"handler1oblic"==t&&(r=x.RealX0,n=x.RealY0,i=x.x0),"p"==x.type?Za(x.color,r,n,i,x.width,x.style,x.h,x.color2):"rf"==x.type||"r"==x.type||"m"==x.type?Ga(x,x.type,e.target.id):Fa(a,r,n,i);break;case"handler2oblic":var l=s(e),c=vr(),d=parseInt(l.y-c.offset.top);Aa(a,parseInt(l.x-c.offset.left),d)}b.clhide("resizehandler"),Ar.splice(y,1)}var p,m,f,g,v,y=b.qsga(".linemodif","name"),x=Ar[y];for(new ColorPicker({wrapperEl:"#color1",value:x.color,onChange:function(t){e(t,1)}}),null!=b.gi("color2")&&(p=new ColorPicker({wrapperEl:"#color2",onChange:function(t){e(t,2)}}),null!=x.color2&&p.change(x.color2)),Nt(),(m=b.gi(Ke("overlay-"))).getContext("2d").clearRect(0,0,m.width,m.height),"sr"==x.type&&Lr.clickHandler.forEach((function(e){b.gi("srBtn").addEventListener(e,t)})),Lr.clickHandler.forEach((function(e){var t=b.qs(".eod_alert");t&&t.addEventListener(e,r)})),Lr.clickHandler.forEach((function(e){var t=b.qs(".eod_copy");t&&t.addEventListener(e,n)})),"a"==x.type&&(b.gi("annotationTxt").value=unescape(x.h),b.gi("annotationTxt").addEventListener("keyup",(function(e){if(13==e.keyCode)return i(),!1;x.h=a(this.value),O()}))),[].forEach.call(b.qsa(".widthSelect"),(function(e){Lr.clickHandler.forEach((function(t){e.addEventListener(t,l)}))})),[].forEach.call(b.qsa(".styleSelect"),(function(e){Lr.clickHandler.forEach((function(t){e.addEventListener(t,c)}))})),[].forEach.call(b.qsa(".fontSelect"),(function(e){Lr.clickHandler.forEach((function(t){e.addEventListener(t,d)}))})),[].forEach.call(b.qsa(".delLine"),(function(e){Lr.clickHandler.forEach((function(t){e.addEventListener(t,u)}))})),(g=b.qs(".showtext"))&&g.addEventListener("change",(function(e){e.preventDefault(),x.fontSize=this.checked?b.qs(".fontSelect").textContent:0,O(),ke(Rr.symbol,Ar)})),v=b.qsa(".resizehandler"),f=0;f<v.length;f++)["touchstart","mousedown"].forEach((function(e){v[f].addEventListener(e,h)}));null!=b.gi("handler2oblic")||"sr"==Ar[y].type||"v"==Ar[y].type||"h"==Ar[y].type?document.addEventListener("keydown",aa):document.addEventListener("keydown",ta),b.gi(Ke("trace-")).addEventListener("touchend",ia),b.gi(Ke("trace-")).addEventListener("mousedown",ia)}function ia(e){Nr.flagSave=!0,e.preventDefault(),It()}function la(e,t){var a,r;for(this.mx=e,this.my=t,this.y=Rr.set.semilog&&null!=Rr.logData?Math.round(1e4*Oe(t,Rr.logData))/1e4:Math.round(1e4*(Dr[0].V0*Dr[0].PxPointY-t)/Dr[0].PxPointY)/1e4,r=Br.length,a=e;a<r;a++)if(e<=a&&null!=Br[a]){this.x=Br[a].d,this.mx=a;break}if(e>r-1){var n=r-1,o=e-n,i=Math.round(o/Dr[0].PxPointX),l=Math.round(i*Dr[0].PxPointX)+n;if(Ir.Xperiod<0)i=-i*Ir.Xperiod;else switch(Ir.Xperiod){case 7:i*=7;break;case 30:i*=30;break;case 91:i*=91;break;case 365:i*=365;break;default:i*=1.4}this.mx=l,this.x=Br[r-1].d+Math.round(i)}}function sa(e,t){Nr.evtList.push({ev:e,f:t})}function ca(){for(var e=Nr.evtList.length,t=0;t<e;t++)Lr.doc.removeEventListener(Nr.evtList[t].ev,Nr.evtList[t].f);Nr.evtList=[]}function da(e,t){w("c"),Yr={c:vr(),A:{mx:e.RealX0,my:e.RealY0,x:e.x0,y:e.y0},B:e.h.B,C:e.h.C,D:null,line:e,pt:t},["touchend","mouseup"].forEach((function(e){Lr.doc.addEventListener(e,ua)})),["touchmove","mousemove"].forEach((function(e){Lr.doc.addEventListener(e,ha)})),sa("mouseup",ua),sa("mousemove",ha),sa("touchend",ua),sa("touchmove",ha)}function ua(e){e.preventDefault(),Ar.push(new qt(Yr.A.x,Yr.A.y,Yr.D.x,Yr.D.y,Yr.line.color,Yr.A.mx,Yr.D.mx,Yr.line.width,null,"fa",{B:Yr.B,C:Yr.C},Yr.line.color2)),ke(Rr.symbol,Ar),ca(),ea(Ar.length-1)}function ha(e){var t;e.preventDefault();var a,r=s(e),n=parseInt(r.x-Yr.c.offset.left),o=parseInt(r.y-Yr.c.offset.top),i=Yr.line;if(!(o<0||o>Dr[0].HeightPx)){switch(t=new la(n,o),O(),Yr.pt){case"A":a=ne(Yr.c.ctx,t,Yr.B,Yr.C,i.color,i.color2,i.width),Yr.A=t;break;case"B":a=ne(Yr.c.ctx,Yr.A,t,Yr.C,i.color,i.color2,i.width),Yr.B=t;break;case"C":a=ne(Yr.c.ctx,Yr.A,Yr.B,t,i.color,i.color2,i.width),Yr.C=t}Yr.D=new la(a.Dx,a.Dy)}}function pa(e,t){w("c"),"t"==e.type||"wf"==e.type&&"B"==t?Yr={line:e,pt:t,c:vr(),A:{mx:e.RealX0,my:e.RealY0,x:e.x0,y:e.y0},B:{mx:e.RealX1,my:e.RealY1,x:e.x1,y:e.y1},C:e.h.C}:"wf"==e.type&&"C"==t&&(Yr={line:e,pt:t,c:vr(),A:{mx:e.RealX0,my:e.RealY0,x:e.x0,y:e.y0},C:{mx:e.RealX1,my:e.RealY1,x:e.x1,y:e.y1},B:e.h.C}),["touchend","mouseup"].forEach((function(e){Lr.doc.addEventListener(e,ma)})),["touchmove","mousemove"].forEach((function(e){Lr.doc.addEventListener(e,fa)})),sa("mouseup",ma),sa("mousemove",fa),sa("touchend",ma),sa("touchmove",fa)}function ma(e){e.preventDefault(),Ar.push(new qt(Yr.A.x,Yr.A.y,Yr.B.x,Yr.B.y,Yr.line.color,Yr.A.mx,Yr.B.mx,Yr.line.width,null,Yr.line.type,{C:Yr.C},Yr.line.color2,Yr.line.fontSize)),ke(Rr.symbol,Ar),ca(),ea(Ar.length-1)}function fa(e){var t,a;e.preventDefault();var r=s(e),n=parseInt(r.x-Yr.c.offset.left),o=parseInt(r.y-Yr.c.offset.top);if(!(o<0||o>Dr[0].HeightPx)){if(t=new la(n,o),O(),"wf"==Yr.line.type)Yr.B=t;else switch(Yr.pt){case"A":Yr.A=t;break;case"B":Yr.B=t;break;case"C":Yr.C=t}"t"==Yr.line.type?se(Yr.c.ctx,Yr.A,Yr.B,Yr.C,Yr.line.color,Yr.line.color2,Yr.line.width):"wf"==Yr.line.type&&(a=Ta(Yr.c.ctx,Yr.A,Yr.B,Yr.C,Yr.line.color,Yr.line.color2,Yr.line.width,Yr.line.fontSize),Yr.C=new la(a.mx,a.my))}}function ga(e,t){w("c"),Yr={line:e,pt:t,c:vr()},["touchend","mouseup"].forEach((function(e){Lr.doc.addEventListener(e,va)})),["touchmove","mousemove"].forEach((function(e){Lr.doc.addEventListener(e,ya)})),sa("mouseup",va),sa("mousemove",ya),sa("touchend",va),sa("touchmove",ya)}function va(e){e.preventDefault();var t=Yr.line;Ar.push(new qt(null,null,null,null,t.color,null,null,t.width,t.style,t.type,t.h,null,t.fontSize)),ke(Rr.symbol,Ar),ca(),ea(Ar.length-1)}function ya(e){var t;e.preventDefault();var a=s(e),r=parseInt(a.x-Yr.c.offset.left),n=parseInt(a.y-Yr.c.offset.top);n<0||n>Dr[0].HeightPx||(t=new la(r,n),O(),Yr.pt=parseInt(Yr.pt),Yr.line.h[Yr.pt]=t,le(Yr.c.ctx,Yr.line.h,Yr.line.color,Yr.line.width,Yr.line.style,Yr.line.fontSize))}function ba(e,t){w("c"),Yr={c:vr(),tabPoints:[],color:La(),nbPoints:t,type:e},["touchstart","click"].forEach((function(e){Lr.doc.addEventListener(e,xa)})),["touchmove","mousemove"].forEach((function(e){Lr.doc.addEventListener(e,wa)})),sa("click",xa),sa("mousemove",wa),sa("touchstart",xa),sa("touchmove",wa)}function xa(e){var t;e.preventDefault();var a=s(e),r=parseInt(a.x-Yr.c.offset.left),n=parseInt(a.y-Yr.c.offset.top);if(!(n<0||n>Dr[0].HeightPx)){if(Yr.tabPoints.length<Yr.nbPoints-1)return void Yr.tabPoints.push(new la(r,n));switch(Yr.tabPoints.push(new la(r,n)),O(),Yr.type){case"t":se(Yr.c.ctx,Yr.tabPoints[0],Yr.tabPoints[1],Yr.tabPoints[2],Yr.color),Ar.push(new qt(Yr.tabPoints[0].x,Yr.tabPoints[0].y,Yr.tabPoints[1].x,Yr.tabPoints[1].y,Yr.color,Yr.tabPoints[0].mx,Yr.tabPoints[1].mx,null,null,Yr.type,{C:Yr.tabPoints[2]}));break;case"ewi":case"ewc":le(Yr.c.ctx,Yr.tabPoints,Yr.color),Ar.push(new qt(null,null,null,null,Yr.color,null,null,null,null,Yr.type,Yr.tabPoints));break;case"wf":t=Ta(Yr.c.ctx,Yr.tabPoints[0],Yr.tabPoints[1],Yr.tabPoints[2],Yr.color,null,1),Yr.tabPoints[2]=new la(t.mx,t.my),Ar.push(new qt(Yr.tabPoints[0].x,Yr.tabPoints[0].y,Yr.tabPoints[1].x,Yr.tabPoints[1].y,Yr.color,Yr.tabPoints[0].mx,Yr.tabPoints[1].mx,null,null,Yr.type,{C:Yr.tabPoints[2]}))}ke(Rr.symbol,Ar),ca(),ea(Ar.length-1)}}function wa(e){var t,a,r,n;if(e.preventDefault(),0!=(t=Yr.tabPoints).length){var o=Yr.c.ctx,i=s(e),l=parseInt(i.x-Yr.c.offset.left),c=parseInt(i.y-Yr.c.offset.top);if(!(c<0||c>Dr[0].HeightPx)){switch(O(),a=[],Yr.type){case"ewi":a=["1","2","3","4","5"];break;case"ewc":a=["a","b","c"]}if("wf"!=Yr.type){for(o.lineWidth=1,o.strokeStyle=Yr.color,o.beginPath(),o.moveTo(t[0].mx,t[0].my),n=1;n<t.length;n++)o.lineTo(t[n].mx,t[n].my),"t"!=Yr.type&&(r=t[n].my<t[n-1].my?-7:16,o.fillText(a[n-1],t[n].mx-4,t[n].my+r));o.lineTo(l,c),o.stroke()}else null==t[1]?(o.beginPath(),o.moveTo(t[0].mx,t[0].my),o.lineTo(l,c),o.strokeStyle=Yr.color,o.stroke()):null==t[2]&&Ta(o,t[0],t[1],{mx:l,my:c},Yr.color,null,1);return}}}function Ta(e,t,a,r,n,o,i,l){var s,c;e.lineWidth=i,e.strokeStyle=n,e.beginPath(),e.moveTo(t.mx,t.my),e.lineTo(a.mx,a.my);var d=Math.atan2(t.my-a.my,a.mx-t.mx),h=Math.atan2(t.my-r.my,r.mx-t.mx),p=!1,m=!1,f=!1;Math.abs(d-h)>Math.PI&&(p=!0,m=!0),d<h&&(p=!0,f=!0),m&&f&&(p=!1),s=Math.sqrt(Math.pow(Math.abs(t.my-a.my),2)+Math.pow(Math.abs(t.mx-a.mx),2)),e.arc(t.mx,t.my,1.618*s,-d,-h,p),e.closePath(),null!=o&&(e.fillStyle=u(o,.15),e.fill()),e.stroke(),e.beginPath(),e.arc(t.mx,t.my,s,-d,-h,p),e.moveTo(t.mx,t.my),e.arc(t.mx,t.my,.786*s,-d,-h,p),e.moveTo(t.mx,t.my),e.arc(t.mx,t.my,.618*s,-d,-h,p),e.moveTo(t.mx,t.my),e.arc(t.mx,t.my,.5*s,-d,-h,p),e.moveTo(t.mx,t.my),e.arc(t.mx,t.my,.236*s,-d,-h,p),e.stroke(),c=(d+h)/2,e.fillStyle=n,e.font=(null!=l?l:12)+"px Arial",e.save(),e.translate(t.mx,t.my);var g=Math.PI/2-c,v=-3;return g>93*Math.PI/180?(g=-c-Math.PI/2,v=11):s=-s,(m&&!f||m&&f)&&(s=-s),e.rotate(g),e.fillText("1.618",-12,1.618*s+v),e.fillText("1",-3,s+v),e.fillText("0.786",-12,.786*s+v),e.fillText("0.618",-12,.618*s+v),e.fillText("0.5",-7,.5*s+v),e.fillText("0.236",-12,.236*s+v),e.restore(),{mx:Math.round(t.mx+Math.cos(h)*Math.abs(s)),my:Math.round(t.my-Math.sin(h)*Math.abs(s))}}function Ca(e){e.preventDefault();var t=s(e),a=parseInt(t.x-Yr.c.offset.left),r=parseInt(t.y-Yr.c.offset.top);if(!(r<0||r>Dr[0].HeightPx)){if(null==Yr.A)return void(Yr.A=new la(a,r));if(null==Yr.B)return void(Yr.B=new la(a,r));null==Yr.C&&(Yr.C=new la(a,r),Yr.D=new la(Yr.D.Dx,Yr.D.Dy),Ar.push(new qt(Yr.A.x,Yr.A.y,Yr.D.x,Yr.D.y,Yr.color,Yr.A.mx,Yr.D.mx,null,null,"fa",{B:Yr.B,C:Yr.C},Yr.color2)),ke(Rr.symbol,Ar),ca(),ea(Ar.length-1))}}function Sa(e){if(e.preventDefault(),null!=Yr.A){var t=Yr.c.ctx,a=s(e),r=parseInt(a.x-Yr.c.offset.left),n=parseInt(a.y-Yr.c.offset.top);if(!(n<0||n>Dr[0].HeightPx)){if(null==Yr.B)return O(),t.lineWidth=1,t.strokeStyle=La(),t.beginPath(),t.moveTo(Yr.A.mx,Yr.A.my),t.lineTo(r,n),void t.stroke();null==Yr.C&&(O(),Yr.D=ne(t,Yr.A,Yr.B,{mx:r,my:n},Yr.color,Yr.color2))}}}function Pa(e){var t=s(e),a=parseInt(t.x-Yr.c.offset.left+Rr.paddingLeft),r=parseInt(t.y-Yr.c.offset.top+Rr.paddingTop);Yr.idLine=H(a,r,Le(a,r))}function ka(e){e.preventDefault(),999!=Yr.idLine?(Ar.splice(Yr.idLine,1),O(),ke(Rr.symbol,Ar),0==Ar.length&&Ma()):Ma()}function Ma(){ca(),k()}function _a(e){var t,a;if(e.preventDefault(),null==b.qs(".linemodif")){var r=Yr.c.ctx,n=Yr.t,o=s(e),i=parseInt(o.x-Yr.c.offset.left),l=parseInt(o.y-Yr.c.offset.top);if(!(l<0||l>Dr[0].HeightPx)){switch(t=new la(i,l),n){case"arrup":ie(r,t,a="#008000",n,a,1);break;case"arrdw":ie(r,t,a="#c00000",n,a,1);break;case"arrrt":case"arrlt":ie(r,t,a="#3366ff",n,a,1);break;case"sm1":oe(r,t,a="#008000",n,1);break;case"sm2":oe(r,t,a="#c00000",n,1)}Ar.push(new qt(t.x,t.y,t.x,t.y,a,t.mx,t.mx,1,null,n,null,a)),ke(Rr.symbol,Ar),ca(),ea(Ar.length-1)}}}function Ea(e){function t(e){e.preventDefault(),Va(Yr.c.ctx,o,i,Yr.color)}var a,r;if(e.preventDefault(),null==b.qs(".linemodif")){var n=s(e),o=parseInt(n.x-Yr.c.offset.left),i=parseInt(n.y-Yr.c.offset.top);i<0||i>Dr[0].HeightPx||(a=Ar.length,(r=document.createElement("div")).setAttribute("cid",Lr.callID),r.setAttribute("onmousedown","mydragg.startMoving(this,'trace-"+Lr.callID+"',event);"),r.setAttribute("onmouseup","mydragg.stopMoving('trace-"+Lr.callID+"');"),r.setAttribute("class","linemodif"),r.setAttribute("name",a),r.style.left=Rr.paddingLeft+4+"px",r.style.top=Rr.paddingTop+4+"px",r.innerHTML='<input id="annotationTxt" type="text"/><input id="annotationBtn" class="btnSR" type="button" value="ok" />',Lr.doc.appendChild(r),b.gi("annotationTxt").focus(),Nt(),b.gi("annotationTxt").addEventListener("keyup",(function(e){e.preventDefault(),13==(e.which?e.which:e.keyCode)?(O(),Va(Yr.c.ctx,o,i,Yr.color)):(O(),ye(Yr.c.ctx,new la(o,i),"12",Yr.color,this.value))})),Lr.clickHandler.forEach((function(e){b.gi("annotationBtn").addEventListener(e,t)})))}}function Va(e,t,r,n){var o,i,l;if(null!=t||null!=r){if(""==(o=(o=b.gi("annotationTxt").value.trim()).replace(/,/g,".")))return b.clrem(["linemodif"]),k(),!1;l=ye(e,i=new la(t,r),"12",n,o),Ar.push(new qt(i.x,i.y,i.x,i.y,n,i.mx,l,null,"12","a",a(o))),ke(Rr.symbol,Ar),b.clrem(["linemodif"]),ea(Ar.length-1)}}function La(){return null==Rr.set.traceColor?kt(Rr.set.bkcolor):Rr.set.traceColor}function Ra(e){Yr={c:vr(),pt:null,line:e},["touchend","mouseup"].forEach((function(e){Lr.doc.addEventListener(e,Ia)})),["touchmove","mousemove"].forEach((function(e){Lr.doc.addEventListener(e,Da)})),sa("touchend",Ia),sa("mouseup",Ia),sa("mousemove",Da),sa("touchmove",Da)}function Ia(e){e.preventDefault();var t=Yr.line;null==Yr.pt&&(Yr.pt=dr(t.type,e,Yr.c.offset,Yr.c.ctx,t.color,t.style,t.width,t.fontSize)),function(e,t,a,r,n,o){switch(e){case"sr":Ar.push(new qt(a.x,a.y,0,a.y,t,a.mx,null,n,r,e,null,null,o));break;case"v":Ar.push(new qt(a.x,0,a.x,2e4,t,a.mx,a.mx,n,r,e,null,null,o));break;default:Ar.push(new qt(0,a.y,0,a.y,t,null,null,n,r,"h",null,null,o))}ke(Rr.symbol,Ar),ca(),ea(Ar.length-1)}(t.type,t.color,Yr.pt,t.style,t.width,t.fontSize)}function Da(e){e.preventDefault();var t=Yr.line;Yr.pt=dr(t.type,e,Yr.c.offset,Yr.c.ctx,t.color,t.style,t.width,t.fontSize)}function Aa(e,t,a){Yr={c:vr(),pt:null,line:e,x0:t,y0:a},["touchend","mouseup"].forEach((function(e){Lr.doc.addEventListener(e,Ba)})),["touchmove","mousemove"].forEach((function(e){Lr.doc.addEventListener(e,Ha)})),sa("touchend",Ba),sa("mouseup",Ba),sa("mousemove",Ha),sa("touchmove",Ha)}function Ha(e){e.preventDefault(),O();var t=s(e),a=parseInt(t.x-Yr.c.offset.left)-Yr.x0,r=parseInt(t.y-Yr.c.offset.top)-Yr.y0;Yr.pt=ur(Yr.c.ctx,Yr.line,a,r)}function Ba(e){e.preventDefault(),null!=Yr.pt&&fr(Yr.line,Yr.pt)}function Ga(e,t,a){var r="handler0oblic"==a?{x:e.x1,y:e.y1,mx:e.RealX1,my:e.RealY1}:{x:e.x0,y:e.y0,mx:e.RealX0,my:e.RealY0};Yr={c:vr(),line:e,type:t,ptb:r,target:a},["touchend","mouseup"].forEach((function(e){Lr.doc.addEventListener(e,qa)})),["touchmove","mousemove"].forEach((function(e){Lr.doc.addEventListener(e,Ya)})),sa("touchend",qa),sa("mouseup",qa),sa("mousemove",Ya),sa("touchmove",Ya)}function qa(e){e.preventDefault(),null!=Yr.pte&&gr(Yr.line.color,Yr.line.color2,Yr.type,Yr.pte,Yr.target,Yr.ptb,Yr.line.width,Yr.line.style,Yr.line.fontSize)}function Ya(e){e.preventDefault(),Yr.pte=pr(e,Yr.c.offset,Yr.c.ctx,Yr.line.color,Yr.line.color2,Yr.type,Yr.target,Yr.ptb,Yr.line.width,Yr.line.style,Yr.line.fontSize)}function Na(e){e.preventDefault(),null==Yr.ptb&&(Yr.ptb=cr(e,Yr.c.offset)),null!=Yr.pte&&gr(Yr.color,null,Yr.type,Yr.pte,null,Yr.ptb)}function Xa(e){e.preventDefault(),null!=Yr.ptb&&(Yr.pte=pr(e,Yr.c.offset,Yr.c.ctx,Yr.color,null,Yr.type,null,Yr.ptb))}function $a(e){w("c"),Yr={c:vr(),line:e,ptb:{mx:e.RealX0,my:e.RealY0,x:e.x0,y:e.y0},pte:{mx:e.RealX1,my:e.RealY1,x:e.x1,y:e.y1},x1:Math.max(e.RealX1,e.RealX0)},["touchend","mouseup"].forEach((function(e){Lr.doc.addEventListener(e,Oa)})),["touchmove","mousemove"].forEach((function(e){Lr.doc.addEventListener(e,Qa)})),sa("touchend",Oa),sa("mouseup",Oa),sa("mousemove",Qa),sa("touchmove",Qa)}function Oa(e){e.preventDefault();var t=Yr.line;mr(t.color,Yr.pte,t.width,t.style,t.type,t.color2,Yr.move,Yr.ptb,null,t.fontSize)}function Qa(e){var t,a,r;e.preventDefault(),t=s(e),a=parseInt(t.x-Yr.c.offset.left),Yr.move=a-Yr.x1,Yr.move<100||(O(),r=Yr.line,be(Yr.c.ctx,r.type,r.color,r.style,r.width,Yr.move,Yr.ptb,Yr.pte,r.color2))}function Fa(e,t,a,r){var n;n=Rr.set.semilog&&null!=Rr.logData?Oe(a,Rr.logData):(Dr[0].V0*Dr[0].PxPointY-a)/Dr[0].PxPointY,Yr={ptb:{x:r,mx:t,my:a,y:n},pte:null,line:e,c:vr()},["touchend","mouseup"].forEach((function(e){Lr.doc.addEventListener(e,za)})),["touchmove","mousemove"].forEach((function(e){Lr.doc.addEventListener(e,Ua)})),sa("touchend",za),sa("mouseup",za),sa("mousemove",Ua),sa("touchmove",Ua)}function za(e){e.preventDefault();var t=Yr.line;null!=Yr.pte&&mr(t.color,Yr.pte,t.width,t.style,t.type,t.color2,t.h,Yr.ptb,t.fontSize)}function Ua(e){e.preventDefault();var t=Yr.line;"f"==t.type&&t.x1<t.x0?t.h=-1:"f"==t.type&&t.x1>=t.x0&&(t.h=1),Yr.pte=hr(e,Yr.c.offset,Yr.c.ctx,t.color,t.width,t.style,t.h,t.type,t.color2,Yr.ptb,t.fontSize)}function Wa(e){ca(),Yr={c:vr(),line:e},["touchend","mouseup"].forEach((function(e){Lr.doc.addEventListener(e,ja)})),["touchmove","mousemove"].forEach((function(e){Lr.doc.addEventListener(e,Ja)})),sa("touchend",ja),sa("mouseup",ja),sa("mousemove",Ja),sa("touchmove",Ja)}function Ja(e){e.preventDefault();var t=Yr.line,a=s(e),r=parseInt(a.y-Yr.c.offset.top+(t.RealY1-t.RealY0)/2);Yr.rh=t.RealY1-r,O(),be(Yr.c.ctx,"p",t.color,t.style,t.width,-Yr.rh,{mx:t.RealX0,my:t.RealY0},{mx:t.RealX1,my:t.RealY1},t.color2)}function ja(e){e.preventDefault();var t=Yr.line,a=Yr.rh/Dr[0].PxPointY,r=t.y0,n=t.y1;a>0&&(r+=a,n+=a),Ar.push(new qt(t.x0,r,t.x1,n,t.color,t.RealX0,t.RealX1,t.width,t.style,"p",Math.abs(a),t.color2)),ke(Rr.symbol,Ar),ca(),ea(Ar.length-1)}function Za(e,t,a,r,n,o,i,l){Yr={c:vr(),ptb:{mx:t,my:a,x:r},style:o,height:i*Dr[0].PxPointY,color2:l,width:n,color:e},["touchend","mouseup"].forEach((function(e){Lr.doc.addEventListener(e,Ka)})),["touchmove","mousemove"].forEach((function(e){Lr.doc.addEventListener(e,er)})),sa("touchend",Ka),sa("mouseup",Ka),sa("mousemove",er),sa("touchmove",er)}function Ka(e){var t,a,r,n;e.preventDefault(),t=Yr.pte,a=Yr.ptb,null!=t&&(r=Rr.set.semilog&&null!=Rr.logData?Oe(a.my,Rr.logData):(Dr[0].V0*Dr[0].PxPointY-a.my)/Dr[0].PxPointY,n=Yr.height/Dr[0].PxPointY,t.mx<a.mx?Ar.push(new qt(t.x,t.y,a.x,r,Yr.color,t.mx,a.mx,Yr.width,Yr.style,"p",n,Yr.color2)):Ar.push(new qt(a.x,r,t.x,t.y,Yr.color,a.mx,t.mx,Yr.width,Yr.style,"p",n,Yr.color2)),ke(Rr.symbol,Ar),ca(),ea(Ar.length-1))}function er(e){e.preventDefault(),Yr.pte=hr(e,Yr.c.offset,Yr.c.ctx,Yr.color,Yr.width,Yr.style,Yr.height,"p",Yr.color2,Yr.ptb)}function tr(e){if(e.preventDefault(),null!=Yr.ptb)if(null==Yr.pte||null!=Yr.rh){var t=Yr.ptb.y,a=Yr.rh/Dr[0].PxPointY;a>0&&(t+=a,Yr.pte.y=Yr.pte.y+a),a=Math.abs(a),Yr.pte.mx<Yr.ptb.mx?Ar.push(new qt(Yr.pte.x,Yr.pte.y,Yr.ptb.x,t,Yr.color,Yr.pte.mx,Yr.ptb.mx,1,null,"p",a)):Ar.push(new qt(Yr.ptb.x,t,Yr.pte.x,Yr.pte.y,Yr.color,Yr.ptb.mx,Yr.pte.mx,1,null,"p",a)),ke(Rr.symbol,Ar),ca(),ea(Ar.length-1)}else Yr.step1=!0;else Yr.ptb=cr(e,Yr.c.offset)}function ar(e){if(e.preventDefault(),null!=Yr.ptb){if(null!=Yr.ptb&&!Yr.step1)return void(Yr.pte=hr(e,Yr.c.offset,Yr.c.ctx,null,null,null,null,"p",null,Yr.ptb));var t=Yr.c.ctx,a=s(e),r=parseInt(a.y-Yr.c.offset.top);Yr.rh=Yr.pte.my-r,O(),t.strokeStyle=Yr.color,t.lineWidth=1,t.beginPath(),t.moveTo(Yr.ptb.mx,Yr.ptb.my),t.lineTo(Yr.pte.mx,Yr.pte.my),t.moveTo(Yr.ptb.mx,Yr.ptb.my-Yr.rh),t.lineTo(Yr.pte.mx,Yr.pte.my-Yr.rh),t.stroke()}}function rr(e){Yr={line:e,ptb:{mx:e.RealX0,my:e.RealY0,x:e.x0,y:e.y0},pte:null,c:vr()},["touchend","mouseup"].forEach((function(e){Lr.doc.addEventListener(e,or)})),["touchmove","mousemove"].forEach((function(e){Lr.doc.addEventListener(e,nr)})),sa("touchend",or),sa("mouseup",or),sa("mousemove",nr),sa("touchmove",nr)}function nr(e){e.preventDefault(),O();var t=Yr.line,a=s(e),r=parseInt(a.y-Yr.c.offset.top),n=parseInt(a.x-Yr.c.offset.left);r=sr(r),Yr.pte=new la(n,r),me(Yr.c.ctx,t.color,t.style,t.width,Yr.ptb,Yr.pte,t.color2)}function or(e){e.preventDefault();var t=Yr.line;null!=Yr.pte&&(Ar.push(new qt(Yr.ptb.x,Yr.ptb.y,Yr.pte.x,Yr.pte.y,t.color,Yr.ptb.mx,Yr.pte.mx,t.width,t.style,"c",null,t.color2)),ke(Rr.symbol,Ar),ca(),ea(Ar.length-1))}function ir(e){var t;e.preventDefault();var a=Yr.ptb,r=Yr.type,n=Yr.color,o=Yr.c.ctx;if(null!=a){O();var i=s(e),l=parseInt(i.y-Yr.c.offset.top),c=parseInt(i.x-Yr.c.offset.left);switch(l=sr(l),Yr.pte=new la(c,l),"mv"==r&&(Yr.pte.mx=a.mx,Yr.pte.x=a.x),"mh"==r&&(Yr.pte.my=a.my,Yr.pte.y=a.y),r){case"an":t=Math.atan2(a.my-Yr.pte.my,Yr.pte.mx-a.mx),he(o,n,null,null,a,Yr.pte,t);break;case"af":pe(o,n,null,null,a,Yr.pte);break;case"c":me(o,n,null,null,a,Yr.pte);break;case"gg":ue(o,n,null,null,a,Yr.pte);break;case"ga":de(o,n,null,null,a,Yr.pte);break;case"cf":re(o,n,null,null,a,Yr.pte,0);break;case"ff":ce(o,n,null,null,a,Yr.pte);break;case"o":case"f":case"ef":case"mv":case"mh":be(o,r,n,null,null,null,a,Yr.pte);break;case"v":ge(o,Yr.pte,null,null,n);break;case"h":ve(o,Yr.pte,null,null,n,null,"h");break;case"sr":fe(o,Yr.pte,null,null,n);break;case"mg":ve(o,Yr.pte,null,null,n,null,"mg")}}}function lr(e){var t,a=Yr.pte,r=Yr.ptb,n=Yr.type;if(null!=r){if(null==a)return ca(),void k();switch(t=null,"ef"==n&&(t=250),"an"==n&&(t=Math.atan2(r.my-a.my,a.mx-r.mx)),n){case"o":case"f":case"ef":a.mx<r.mx?Ar.push(new qt(a.x,a.y,r.x,r.y,Yr.color,a.mx,r.mx,null,null,n,"f"==n?-1:t)):Ar.push(new qt(r.x,r.y,a.x,a.y,Yr.color,r.mx,a.mx,null,null,n,"f"==n?1:t));break;case"v":Ar.push(new qt(a.x,0,a.x,2e4,Yr.color,a.mx,a.mx,null,null,n));break;case"sr":Ar.push(new qt(a.x,a.y,0,a.y,Yr.color,a.mx,null,null,null,n));break;case"h":case"mg":Ar.push(new qt(0,a.y,0,a.y,Yr.color,null,null,null,null,n));break;default:Ar.push(new qt(r.x,r.y,a.x,a.y,Yr.color,r.mx,a.mx,null,null,n,t))}ke(Rr.symbol,Ar),ca(),ea(Ar.length-1)}else Yr.ptb=cr(e,Yr.c.offset)}function sr(e){return e<0&&(e=0),e>Dr[0].HeightPx&&(e=Dr[0].HeightPx),e}function cr(e,t){var a=s(e);return new la(parseInt(a.x-t.left),parseInt(a.y-t.top))}function dr(e,t,a,r,n,o,i,l){var c;O();var d=s(t),u=parseInt(d.y-a.top),h=parseInt(d.x-a.left);switch(u<0&&(u=1),u>Dr[0].HeightPx&&(u=Dr[0].HeightPx-1),c=new la(h,u),e){case"sr":fe(r,c,o,i,n,l);break;case"v":ge(r,c,o,i,n,l);break;default:ve(r,c,o,i,n,l,e)}return c}function ur(e,t,a,r){var n=new la(t.RealX0+a,t.RealY0+r),o=new la(t.RealX1+a,t.RealY1+r),i=null;switch(t.type){case"t":se(e,n,o,i=new la(t.h.C.mx+a,t.h.C.my+r),t.color,t.color2,t.width);break;case"wf":Ta(e,n,o,i=new la(t.h.C.mx+a,t.h.C.my+r),t.color,t.color2,t.width,t.fontSize);break;case"a":ye(e,n,t.style,t.color,unescape(t.h));break;case"r":Te(e,t.color,t.color2,n,o,t.type,null,t.width,t.style);break;case"m":Te(e,t.color,t.color2,n,o,t.type,t.h,t.width,t.style,t.fontSize);break;case"rf":Ce(e,t.color,t.color2,n,o,t.width,t.fontSize);break;case"c":me(e,t.color,t.style,t.width,n,o,t.color2);break;case"an":he(e,t.color,t.style,t.width,n,o,t.h,t.fontSize);break;case"af":pe(e,t.color,t.style,t.width,n,o,t.fontSize);break;case"cf":re(e,t.color,t.style,t.width,n,o,0,t.fontSize);break;case"gg":ue(e,t.color,t.style,t.width,n,o);break;case"ga":de(e,t.color,t.style,t.width,n,o,t.fontSize);break;case"ff":ce(e,t.color,t.style,t.width,n,o,t.fontSize);break;case"sr":fe(e,n,t.style,t.width,t.color,t.fontSize);break;case"v":ge(e,n,t.style,t.width,t.color,t.fontSize);break;case"h":case"mg":ve(e,n,t.style,t.width,t.color,12,t.type);break;case"arrup":case"arrdw":case"arrrt":case"arrlt":ie(e,n,t.color,t.type,t.color2,t.width);break;case"sm1":case"sm2":oe(e,n,t.color,t.type,t.width);break;default:be(e,t.type,t.color,t.style,t.width,t.h,n,o,t.color2,t.fontSize)}return{ptb:n,pte:o,C:i}}function hr(e,t,a,r,n,o,i,l,c,d,u){var h,p;O();var m=s(e),f=parseInt(m.x-t.left),g=parseInt(m.y-t.top);switch(h=new la(f,g=sr(g)),"mv"==l&&(h.mx=d.mx,h.x=d.x),"mh"==l&&(h.my=d.my,h.y=d.y),l){case"an":p=Math.atan2(d.my-h.my,h.mx-d.mx),h.mx=he(a,r,o,n,d,h,p,u);break;case"af":pe(a,r,o,n,d,h,u);break;case"gg":ue(a,r,o,n,d,h);break;case"ga":de(a,r,o,n,d,h,u);break;case"ff":ce(a,r,o,n,d,h,u);break;case"cf":re(a,r,o,n,d,h,0,u);break;default:be(a,l,r,o,n,i,d,h,c,u)}return h}function pr(e,t,a,r,n,o,i,l,c,d,u){var h;O();var p=s(e),m=parseInt(p.x-t.left),f=parseInt(p.y-t.top);return h=new la(m,f=sr(f)),"rf"==o&&Ce(a,r,n,l,h,c,u,"handler0oblic"==i),("r"==o||"m"==o)&&Te(a,r,n,l,h,o,l.my>h.my?1:0,c,d,u),h}function mr(e,t,a,r,n,o,i,l,s){switch(null==e&&(e=La()),"ef"==n&&null==i&&(i=250),n){case"an":i=Math.atan2(l.my-t.my,t.mx-l.mx),Ar.push(new qt(l.x,l.y,t.x,t.y,e,l.mx,t.mx,a,r,n,i,null,s));break;case"af":case"cf":Ar.push(new qt(l.x,l.y,t.x,t.y,e,l.mx,t.mx,a,r,n,null,null,s));break;default:t.mx<l.mx?Ar.push(new qt(t.x,t.y,l.x,l.y,e,t.mx,l.mx,a,r,n,"f"==n?-1:i,o,s)):Ar.push(new qt(l.x,l.y,t.x,t.y,e,l.mx,t.mx,a,r,n,"f"==n?1:i,o,s))}ke(Rr.symbol,Ar),ca(),ea(Ar.length-1)}function fr(e,t){null==e.color&&(e.color=La());var a=t.ptb,r=t.pte,n=t.C,o=a.y,i=a.x,l=r.y,s=r.x;switch(e.type){case"t":case"wf":Ar.push(new qt(i,o,s,l,e.color,a.mx,r.mx,e.width,null,e.type,{C:n},e.color2,e.fontSize));break;case"a":Ar.push(new qt(i,o,i,o,e.color,a.mx,r.mx,e.width,e.style,e.type,e.h,null,e.fontSize));break;case"r":case"rf":Ar.push(new qt(i,o,s,l,e.color,a.mx,r.mx,e.width,null,e.type,null,e.color2,e.fontSize));break;case"ef":case"m":Ar.push(new qt(i,o,s,l,e.color,a.mx,r.mx,e.width,e.style,e.type,e.h,e.color2,e.fontSize));break;case"c":Ar.push(new qt(i,o,s,l,e.color,a.mx,r.mx,e.width,e.style,e.type,null,e.color2));break;case"an":case"f":Ar.push(new qt(i,o,s,l,e.color,a.mx,r.mx,e.width,e.style,e.type,e.h,null,e.fontSize));break;case"mv":case"mh":case"af":case"gg":case"ga":case"ff":case"cf":Ar.push(new qt(i,o,s,l,e.color,a.mx,r.mx,e.width,e.style,e.type,null,null,e.fontSize));break;case"sr":Ar.push(new qt(i,a.y,0,a.y,e.color,a.mx,null,e.width,e.style,e.type,null,null,e.fontSize));break;case"v":Ar.push(new qt(i,0,t.x,2e4,e.color,a.mx,a.mx,e.width,e.style,e.type,null,null,e.fontSize));break;case"h":Ar.push(new qt(0,a.y,0,a.y,e.color,null,null,e.width,e.style,"h",null,null,e.fontSize));break;case"arrup":case"arrdw":case"arrrt":case"arrlt":Ar.push(new qt(i,a.y,i,a.y,e.color,a.mx,a.mx,e.width,null,e.type,null,e.color2));break;case"sm1":case"sm2":Ar.push(new qt(i,a.y,i,a.y,e.color,a.mx,a.mx,e.width,null,e.type,null,null));break;default:Ar.push(new qt(i,o,s,l,e.color,a.mx,r.mx,e.width,e.style))}ke(Rr.symbol,Ar),ca(),ea(Ar.length-1)}function gr(e,t,a,r,n,o,i,l,s){var c=o.y,d=r.y,u=Math.min(o.x,r.x),h=Math.max(o.x,r.x),p=Math.min(o.mx,r.mx),m=Math.max(o.mx,r.mx),f=0;switch(o.my>r.my&&(f=1),a){case"r":case"m":Ar.push(new qt(u,Math.max(c,d),h,Math.min(c,d),e,p,m,i,null,a,"r"==a?null:f,t,s));break;case"rf":"handler0oblic"==n?Ar.push(new qt(u,d,h,c,e,p,m,i,null,a,null,t,s)):Ar.push(new qt(u,c,h,d,e,p,m,i,null,a,null,t,s))}ke(Rr.symbol,Ar),ca(),ea(Ar.length-1)}function vr(){var e=b.gi(Ke("trace-"));return{offset:l(e),ctx:e.getContext("2d")}}function yr(e,t,a){var r="w"+a;null!=t[r]&&(e.lineWidth=t[r])}function br(e,t,a){var r,n;if(e.setLineDash)switch(null!=a?null!=a[n="s"+t]&&(r=a[n]):r=t,r){case 2:e.setLineDash([2,2]);break;case 3:e.setLineDash([4]);break;case 4:e.setLineDash([7,2,2,2])}}function xr(e,t,a){var r=function(e,t,a){return e+a*(t-e)},n=e.RealX1-e.RealX0,o=e.RealY1-e.RealY0,i=((t-e.RealX0)*n+(a-e.RealY0)*o)/(n*n+o*o);return{x:r(e.RealX0,e.RealX1,i),y:r(e.RealY0,e.RealY1,i)}}function wr(e,t,a){if(("arrrt"==a.type||"arrlt"==a.type)&&t>=a.RealY0-5&&t<=a.RealY0+5)switch(a.type){case"arrrt":if(e>=a.RealX0-16&&e<=a.RealX0)return!0;break;case"arrlt":if(e<=a.RealX0+16&&e>=a.RealX0)return!0}if(e>=a.RealX0-5&&e<=a.RealX0+5)switch(a.type){case"arrup":if(t>=a.RealY0&&t<=a.RealY0+16)return!0;break;case"arrdw":if(t<=a.RealY0&&t>=a.RealY0-16)return!0;break;case"sm1":case"sm2":if(t>=a.RealY0-10&&t<=a.RealY0+10)return!0}return!1}function Tr(e,t,a){var r=Math.abs(a.RealX1-a.RealX0),n=Math.abs(a.RealY0-a.RealY1),o=!1;return Math.pow(e-a.RealX0,2)/Math.pow(r+5,2)+Math.pow(t-a.RealY0,2)/Math.pow(n+5,2)<=1&&(o=!0),Math.pow(e-a.RealX0,2)/Math.pow(r-5,2)+Math.pow(t-a.RealY0,2)/Math.pow(n-5,2)<=1&&(o=!1),o}function Cr(e,t,a){for(var r,n,o,i,l,s=a.h.length,c=1;c<s;c++)if(i=a.h[c-1],l=a.h[c],e>Math.min(i.mx,l.mx)&&e<Math.max(i.mx,l.mx)&&(n=e-(r=xr({RealX0:i.mx,RealY0:i.my,RealX1:l.mx,RealY1:l.my},e,t)).x,o=t-r.y,Math.abs(Math.sqrt(n*n+o*o))<4))return!0;return!1}function Sr(e,t,a){var r,n,o,i,l,s=[{RealX0:a.RealX0,RealY0:a.RealY0,RealX1:a.RealX1,RealY1:a.RealY1},{RealX0:a.RealX0,RealY0:a.RealY0,RealX1:a.h.C.mx,RealY1:a.h.C.my}];for("t"==a.type&&s.push({RealX0:a.RealX1,RealY0:a.RealY1,RealX1:a.h.C.mx,RealY1:a.h.C.my}),l=s.length,r=0;r<l;r++)if(e>Math.min(s[r].RealX0,s[r].RealX1)-3&&e<Math.max(s[r].RealX0,s[r].RealX1)+3&&(o=e-(n=xr(s[r],e,t)).x,i=t-n.y,Math.abs(Math.sqrt(o*o+i*i))<5))return!0;return!1}function Pr(e,t,a){for(var r,n,i,l,s,c,d,u,h,p=o(e.QuoteTab),m=(p=qe(p)).length,f=0,g=999999,v=0;v<m;v++)null!=p[v]&&(p[v].h>f&&(f=p[v].h),p[v].l<g&&(g=p[v].l));for(r=(f-g)*t/100,(i=[])[0]={h:p[0].v,b:0},v=1;v<m;v++)null!=p[v]&&(n=Math.floor((p[v].c-g)/r),l=p[v].c>=p[v-1].c,null!=i[n]?l?i[n].h=i[n].h+p[v].v:i[n].b=i[n].b+p[v].v:i[n]=l?{h:p[v].v,b:0}:{h:0,b:p[v].v});for(s=0,c=i.length,v=0;v<c;v++)null!=i[v]&&i[v].h+i[v].b>s&&(s=i[v].h+i[v].b);(u=(d=Dr[0]).ctx).strokeStyle=Rr.set.gridColor,u.save();var y=Rr.paddingLeft,b=s/(Rr.innerWidth/2),x=Math.floor((f-g)*d.PxPointY/c);for(x=x<2?2:x-2,h=0,v=0;v<c;v++)null!=i[v]&&(a.v1||(u.fillStyle=a.color,h=i[v].h/b,u.fillRect(y,Math.round((d.V0-(g+v*r))*d.PxPointY),h,-x)),a.v2||(u.fillStyle=a.color2,u.fillRect(h+y,Math.round((d.V0-(g+v*r))*d.PxPointY),i[v].b/b,-x)));u.restore()}function kr(e,t,a,r,n){var i,l,s,c,d=o(e),u=(d=qe(d)).length,h=0,m=0;if(0!=u){for(i=Dr[0],c=0;c<u;c++)null!=d[c]&&(h+=v(d[c],r),m++);l=$e(h/=m,n)+.5,(s=i.ctx).save(),s.strokeStyle=a.v1?"transparent":a.color,s.fillStyle=s.strokeStyle,s.beginPath(),s.moveTo(t.paddingLeft,l),s.lineTo(t.innerWidth+t.paddingLeft,l),yr(s,a,1),br(s,1,a),s.stroke(),s.font="14px Arial",s.fillStyle=s.strokeStyle,s.fillText(p(h),t.paddingLeft+5,l-4),s.restore()}}function Mr(e,t,a){var r,n,o,i,l,s,c={QuoteTab:e.QuoteTab},d=[],u=c.QuoteTab.length,h=v(c.QuoteTab[0],a),p=v(c.QuoteTab[0],a);if(u<3)return!1;for(v(c.QuoteTab[1],a)>=v(c.QuoteTab[0],a)?p+=t:h-=t,r=2;r<u;r++){if(i=v(s=c.QuoteTab[r],a)-p-t,l=v(s,a)-h+t,i>0){for(o=(i+t)/t>>0,n=0;n<o;n++)d.push({d:s.d,l:h+t*(n+1),h:p+t*(n+1),s:1,c:s.c});p+=t*o,h+=t*o}if(l<0){for(o=Math.abs((l-t)/t>>0),n=0;n<o;n++)d.push({d:s.d,l:h-t*(n+1),h:p-t*(n+1),s:0,c:s.c});p-=t*o,h-=t*o}}return 1==d.length&&(d=[]),{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:d}}var _r;this.clickHandler=["click"],this.callID=x.callID,this.doc=b.gi(this.callID),("ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0)&&(this.clickHandler=["touchend","click"]),null==VGP.callType&&(VGP.callType="POST"),null==x.symbol&&(x.symbol="PX1p");var Er=window.getComputedStyle(this.doc),Vr={widthGraph:parseInt(Er.width),heightGraph:parseInt(Er.height),paddingTop:17,paddingLeft:10,paddingBottom:20,paddingRight:45,histoLength:365,chartPeriod:0,padBarCandle:0,searchConfig:"",mainChart:{type:"line",indicators:[]},indicators:[],set:{bkcolor:"#fff",txtColor:"#606060",gridV:!0,gridH:!0,gridLine:!0,gridColor:"#e0e0e0",isEncadre:!0,yaxis:!1,nosticky:!1,reticColor:"#114257",semilog:!1,cadreColor:"#e0e0e0",traceColor:null,noVeilleIntra:!1,veilleStyle:!1,veilleColor:"#fe0000",fontSize:11,splitStyle:"band",splitColor:"rgba(153,153,153,1)"},cursor:"r"},Lr=this,Rr=t(Vr,x);VGP.isMobile&&(Rr.cursor="b"),_r=Rr.set.fontSize-11,Rr.paddingBottom+=_r,Rr.paddingTop+=_r,Rr.paddingRight+=4*_r,Rr.paddingLeft+=4*_r;var Ir,Dr=[],Ar=[],Hr={maxY:0,minY:0,maxX:null,minX:0},Br=[],Gr={},qr={},Yr={},Nr={initViewBegin:0,initViewEnd:0,initMaxY:0,initMinY:0,lineNumber:999,evtList:[],cursorState:!1,moveZoomX:0,moveZoomY:0,moveLayer:!1,activeLayer:null,flagSave:!1,fiEvt:[],tmp1:null,tmp2:null};this.hideShowTrace=function(){Rr.hideTrace=!Rr.hideTrace,function(){if(Rr.hideTrace){var e=document.createElement("div");e.id=Ke("hst-"),e.setAttribute("class","spg hst_icon"),e.setAttribute("style","top:"+(Rr.paddingTop+3)+"px;right:"+(Rr.paddingRight+5)+"px"),Lr.doc.appendChild(e),Lr.clickHandler.forEach((function(e){b.gi(Ke("hst-")).addEventListener(e,Lr.hideShowTrace)}))}else b.idrem(Ke("hst-"))}(),X()},this.duree_menu=function(e,t){if(""!=e&&(e=parseInt(e),t=null!=t?parseInt(t):Rr.chartPeriod,e!=Rr.histoLength||t!=Rr.chartPeriod)){Nr.fiEvt=[],b.clrem(["svginfofi"]),Nr.flagSave=!0,It();var a={chartPeriod:Rr.chartPeriod,histoLength:Rr.histoLength};t<0&&e>20&&(t=0),t>=0&&e<=20&&(t=-1),Rr.chartPeriod=t,Rr.histoLength=e,De(!0,a)}},this.period_menu=function(e,t){(e=parseInt(e))!=Rr.chartPeriod&&((t=null!=t?parseInt(t):Rr.histoLength)!=Rr.histoLength||e!=Rr.chartPeriod)&&(Nr.flagSave=!0,It(),e<0&&t>20&&(t=1,Nr.fiEvt=[],b.clrem(["svginfofi"])),e>=0&&t<=20&&(t=365,Nr.fiEvt=[],b.clrem(["svginfofi"])),Rr.chartPeriod=e,Rr.histoLength=t,De(!0))},this.settings_changeFont=function(e){var t=e-Rr.set.fontSize;0!=t&&(Rr.paddingBottom+=t,Rr.paddingTop+=t,Rr.paddingRight+=4*t,Rr.paddingLeft+=4*t,Rr.set.fontSize=e,this.set_screenSize())},this.style_menu_template=function(e){null!=Ir&&et(e,!0)},this.style_menu=function(e){null!=Ir&&e!=Rr.mainChart.type&&et(e)},this.indic1_menu=function(t){if(null!=Ir&&"perf"!=Rr.mainChart.type&&!Rr.mainChart.typedef.nolinearX&&null!=t){var a,r=Rr.mainChart.indicators.length;if("sar"==t||"ichimoku"==t||"pivots"==t)for(a=0;a<r;a++)if(Rr.mainChart.indicators[a].type==t)return;if(("pivots"==t||"VWAP"==t)&&Rr.chartPeriod>=0)return void DisplayAlert("Cet indicateur n'est disponible qu'en vision intraday");Rr.mainChart.indicators.push(e(t)),$(0)}},this.indics_menu=function(t){if(null!=Ir&&!Rr.mainChart.typedef.nolinearX&&null!=t){if(!Rr.isCompare&&"fr"==t)return void("function"==typeof DisplayAlert&&DisplayAlert("La Force Relative ne peut être appliquée que quand 2 valeurs sont comparées"));if(5==Dr.length&&"function"==typeof DisplayAlert)return void DisplayAlert(lang.l_msg1,1);Bt(e(t))}},this.loadDefautChart=function(a){b.idempty(Lr.callID),Ze(),Nr.fiEvt=[],b.clrem(["svginfofi"]),delete Rr.newsConfig,a.indicators||(a.indicators=[]);for(var r=a.indicators.length,n=[],o=0;o<r;o++)"object"==i(a.indicators[o])?n.push(t(e(a.indicators[o].type),a.indicators[o])):n.push(e(a.indicators[o]));a.indicators=n,M(a),Ie(!1)},this.loadTemplateJSON=function(e,t){var a,r;b.idempty(Lr.callID),Ze(),Nr.fiEvt=[],b.clrem(["svginfofi"]),delete(a=JSON.parse(e)).logData,_(a);var n,o=[],i=JSON.parse(t),l=i.length;if(l>1){for(n=1;n<l;n++)o.push(i[n].Indicator);a.indicators=o}else a.indicators=[];for(null!=Rr&&null!=Rr.symbol&&(a.symbol=Rr.symbol),M(a,i),r=b.qsa(".indicname"),n=0;n<r.length;n++)r[n].removeAttribute("style");Ie(!1)},this.loadTemplate=function(e){var a;Nr.flagSave=!0,It(),b.idempty(Lr.callID),Ze(),Nr.fiEvt=[],b.clrem(["svginfofi"]),delete(a=JSON.parse(e.Parametres)).logData,_(a),a.set=t({bkcolor:"#fff",txtColor:"#606060",gridV:!0,gridH:!0,gridLine:!0,gridColor:"#e0e0e0",isEncadre:!0,yaxis:!1,nosticky:!1,reticColor:"#114257",semilog:!1,cadreColor:"#e0e0e0",traceColor:null,noVeilleIntra:!1,veilleStyle:!1,veilleColor:"#fe0000",fontSize:11,splitStyle:"band",splitColor:"rgba(153,153,153,1)"},a.set);var r,n,o=[],i=JSON.parse(e.Layers),l=i.length;if(l>1){for(n=1;n<l;n++)o.push(i[n].Indicator);a.indicators=o}else a.indicators=[];switch(null!=Rr&&null!=Rr.symbol&&(a.symbol=Rr.symbol),delete Rr.indicators,delete Rr.mainChart,delete Rr.newsConfig,M(a,i),Rr.mainChart.type){case"heikin ashi":r="heikin";break;case"line break":r="linebreak";break;case"point figure":r="pnf";break;default:r=Rr.mainChart.type}return Ie(!1),r},this.change_symbol=function(e){Nr.fiEvt=[],b.clrem(["svginfofi"]),Rr.symbol=e,Ie(!0)},this.set_screenSize=function(){var e,t,a,r;if(Nr.flagSave=!0,It(),Lr.doc=b.gi(Lr.callID),e=window.getComputedStyle(Lr.doc),Rr.widthGraph=parseInt(e.width),Rr.heightGraph=parseInt(e.height),Rr.innerWidth=Rr.widthGraph-Rr.paddingLeft-Rr.paddingRight,Rr.usableHeight=Rr.heightGraph-Rr.paddingTop-Rr.paddingBottom-Rr.indicators.length*Rr.marginInter,t=Dr.length,Rr.mainChart.typedef.nolinearX)return t>1&&Dr.splice(0,1),void Mt();for(a=0;a<t;a++)Dr[a].Bars=0==a?[]:{},delete Dr[a].canvas,delete Dr[a].ctx;r=o(Dr),Ze(!0),Re(r),null!=Ir&&(X(),VGP.chartSimple||(k(),je()))},this.saveTemplate=function(e){var t,a,r,n,i,l,s;if(null!=Ir){for(a=o(Rr),r=["widthGraph","heightGraph","paddingTop","paddingLeft","paddingBottom","paddingRight","indicators","usableHeight","marginInter","innerWidth","symbol","padBarCandle","cursor","logData","hideTrace","compare","isIntraday","callID"],t=0;t<r.length;t++)delete a[r[t]];for(delete a.mainChart.typedef.params,a=function(e){for(var t={bkcolor:"#fff",txtColor:"#606060",gridV:!0,gridH:!0,gridLine:!0,gridColor:"#e0e0e0",isEncadre:!0,yaxis:!1,nosticky:!1,reticColor:"#114257",semilog:!1,cadreColor:"#e0e0e0",traceColor:null,noVeilleIntra:!1,veilleStyle:!1,veilleColor:"#fe0000",fontSize:11,splitStyle:"band",splitColor:"rgba(153,153,153,1)"},a=Object.keys(t),r=a.length,n=0;n<r;n++)e.set[a[n]]==t[a[n]]&&delete e.set[a[n]];return e}(a),t=0;t<a.mainChart.indicators.length;t++)delete a.mainChart.indicators[t].params,delete a.mainChart.indicators[t].datas2;for(t=0;t<a.mainChart.indicators.length;t++)delete a.mainChart.indicators[t].params;for(n=Dr.length,t=0;t<n;t++)Dr[t].Bars=0==t?[]:{};for(t=0;t<n;t++)delete Dr[t].canvas,delete Dr[t].ctx;for(i=o(Dr),t=0;t<i.length;t++)delete i[t].Bars,delete i[t].RealY,delete i[t].PxPointX,delete i[t].PxPointY,delete i[t].V0,delete i[t].id,delete i[t].HeightPx,delete i[t].Indicator.params;if(l=o(Dr),Rr.mainChart.typedef.nolinearX&&(i.splice(1),a.mainChart.indicators=[],l.splice(1)),Ze(!0),Re(l),X(),je(),k(),null==e)return{l:JSON.stringify(i),p:JSON.stringify(a)};(s=new XMLHttpRequest).open("POST",VGP.urlWS+"UpdateConfigEOD",!0),s.setRequestHeader("Content-Type","application/json;charset=UTF-8"),s.send(JSON.stringify({configname:escape(e),parametres:JSON.stringify(a),layers:JSON.stringify(i)}))}},this.SynchronizeLines=function(){Ar=Me(Rr.symbol),O()},this.get_symbol=function(){return Rr.symbol},this.delete_chart=function(){b.idempty(Lr.callID),Ze()},this.get_id=function(){return Lr.callID},this.get_name=function(){return null==Ir?"":Ir.Name},this.get_chartType=function(){return Rr.mainChart.type},this.get_parametres=function(){return Rr},this.settings_setdefaut=function(){null!=Ir&&(Rr.set={bkcolor:"#fff",txtColor:"#606060",gridV:!0,gridH:!0,gridLine:!0,gridColor:"#e0e0e0",isEncadre:!0,yaxis:!1,nosticky:!1,reticColor:"#114257",semilog:!1,cadreColor:"#e0e0e0",traceColor:null,noVeilleIntra:!1,veilleStyle:!1,veilleColor:"#fe0000",fontSize:11,splitStyle:"band",splitColor:"rgba(153,153,153,1)"},Rr.paddingLeft=10,Rr.paddingRight=45,Rr.paddingTop=17,Rr.paddingBottom=20,this.set_screenSize())},this.settings_setAxis=function(e){var t=4*(Rr.set.fontSize-11);"left"==e?(Rr.set.yaxis=!0,Rr.paddingLeft=45+t,Rr.paddingRight=10+t):(Rr.set.yaxis=!1,Rr.paddingLeft=10+t,Rr.paddingRight=45+t),b.idcss(Ke("eod_mainchartinfos-"),"left",Rr.paddingLeft+2+"px"),b.clcss("infoindic","left",Rr.paddingLeft+5+"px"),b.idcss(Ke("trace-"),"left",Rr.paddingLeft+"px"),X()},this.settings_setAxisLog=function(e){e?Rr.set.semilog=!0:(Rr.set.semilog=!1,delete Rr.logData),X()},this.settings_setSticky=function(e){Rr.set.nosticky=e,X()},this.settings_setHLSticky=function(e){Rr.set.nohighlow=e,X()},this.stop_events=function(){Nt()},this.set_events=function(){k()},this.settings_setNoVeilleIntra=function(e){if(Rr.set.noVeilleIntra=e,Rr.histoLength<=20){if(Hr.minX=0,Hr.maxX=Ir.QuoteTab.length-1,Hr.maxY=Ir.High,Hr.minY=Ir.Low,!Rr.set.noVeilleIntra){var t=Ir.qv.c;t>Hr.maxY&&(Hr.maxY=t),t<Hr.minY&&(Hr.minY=t)}X()}},this.settings_setTraceColor=function(e){null!=Ir&&(Rr.set.traceColor=e)},this.settings_setVeilleStyle=function(e){Rr.set.veilleStyle=e,X()},this.settings_setVeilleColor=function(e){Rr.set.veilleColor=e,X()},this.settings_getTraceColor=function(){return La()},this.settings_setGridlineShow=function(e){Rr.set.gridLine=e,X()},this.settings_setGridlineH=function(e){Rr.set.gridH=e,X()},this.settings_setGridlineV=function(e){Rr.set.gridV=e,X()},this.settings_setSplitdayStyle=function(e){Rr.set.splitStyle=e,X()},this.settings_setSplitdayColor=function(e){Rr.set.splitColor=u(e,1),X()},this.settings_setGridColor=function(e){null!=Ir&&(Rr.set.gridColor=e,X())},this.settings_setCadreColor=function(e){null!=Ir&&(Rr.set.cadreColor=e,X())},this.settings_setReticuleColor=function(e){null!=Ir&&(Rr.set.reticColor=e,b.gi(Ke("overlay-")).getContext("2d").strokeStyle=Rr.set.reticColor)},this.settings_setEncadreShow=function(e){Rr.set.isEncadre=e,X()},this.settings_setBackColor=function(e){null!=Ir&&(Rr.set.bkcolor=e,b.idcss(Ke("rodgraph-"),"background-color",e))},this.settings_setTextColor=function(e){null!=Ir&&(b.clcss("indicname","color",e),b.idcss(Ke("eod_mainchartinfos-"),"color",e),b.idcss(Ke("eod_topinfo-"),"color",e),Rr.set.txtColor=e,X())},this.updateQuoteEODrefresh=function(e){var t=Ir.QuoteTab[Ir.QuoteTab.length-1],a=t.d;0==Rr.chartPeriod?((t=e).d=a,Ir.QuoteTab[Ir.QuoteTab.length-1]=t):(e.h>t.h&&(t.h=e.h),e.l<t.l&&(t.l=e.l),t.c=e.c,t.v=e.v),X()},this.updateQuoteIntraRefresh=function(e){var t=Ir.QuoteTab.length-1,a=Ir.QuoteTab[t].d,r=0,n=e.qt;if(null==n)return!1;for(var o=Hr.maxY,i=Hr.minY,l=n.length-1;l>=0;l--)n[l].d>=a&&(n[l].d==a?Ir.QuoteTab[t]=n[l]:(Ir.QuoteTab.push(n[l]),r++),n[l].h>o&&(o=n[l].h),n[l].l<i&&(i=n[l].l),n[l].h>Ir.High&&(Ir.High=n[l].h),n[l].l<Ir.Low&&(Ir.Low=n[l].l));Ir.qd&&(Ir.qd.h=e.h,Ir.qd.l=e.l,Ir.qd.c=e.c,Ir.qd.v=e.v),Hr.maxY=o,Hr.minY=i,Hr.maxX=Hr.maxX+r,X()},this.stopGomme=function(){Ma()},this.stopMZoom=function(){T()},this.zoom=function(e){Nr.flagSave=!0,It(),e?B(3):G(3)},this.order_show=function(e){It(),b.qsa("#"+Lr.callID+" .shorderzn").length>0?(tt(),Nr.orders=null):function(e){var t,a=VGP.urlWS+"GetOrders";"GET"==VGP.callType&&(a=a+"?symbol="+Rr.symbol+"&id="+e),(t=new XMLHttpRequest).open(VGP.callType,a,!0),t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),t.onload=function(){if(t.status>=200&&t.status<400){var e=JSON.parse(t.responseText);null!=e&&null!=e.d?(Nr.orders=e.d,at()):Nr.orders=null}},t.send(JSON.stringify({symbol:Rr.symbol,id:e}))}(e)},this.order_level=function(e,t){"perf"!=Rr.mainChart.type?(It(),rt(e)):DisplayAlert("Le passage d'ordre n'est pas disponible en mode 'performance'")},this.tools_menu=function(e){if(null!=Ir)switch(e){case"g":if(0==Ar.length)return;Nt(),Yr={c:vr(),idLine:999},["touchstart","mousedown"].forEach((function(e){Lr.doc.addEventListener(e,ka)})),Lr.doc.addEventListener("mousemove",Pa),sa("mousemove",Pa),sa("mousedown",ka),sa("touchstart",ka);break;case"r":ca(),k(),Rr.cursor="r";break;case"m":ca(),k(),Rr.cursor="m";break;case"z":Nt(),w("zi"),Lr.doc.addEventListener("mousedown",C),Lr.doc.addEventListener("touchstart",C),sa("mousedown",C),sa("touchstart",C),Lr.doc.addEventListener("touchmove",S),Lr.doc.addEventListener("mousemove",S),sa("touchmove",S),sa("mousemove",S);break;case"b":Nt(),Rr.cursor="b",k();break;case"t":Nt(),Rr.cursor="t",k()}},this.setNews=function(e){null==Ir||Rr.mainChart.typedef.nolinearX||(null==e||0==e.length?(Nr.fiEvt=[],b.clrem(["svginfofi"]),delete Rr.newsConfig):Rr.newsConfig=e,It(),X())},this.addSearch=function(e){null==Ir||Rr.mainChart.typedef.nolinearX||null==e||(Rr.searchConfig=e,Nr.flagSave=!0,It(),X())},this.removeSearch=function(){null!=Ir&&(Rr.searchConfig="",X())},this.closeToolsParams=function(){Nr.flagSave=!0,It()},this.CloseTools=function(e){e||(Nr.flagSave=!0),It()},this.saveTrace=function(){Dt()},this.saveTraceFull=function(){var e=Dt(!0),t=this.saveTemplate();return{Traces:e,Parametres:t.p,Layers:t.l,Symbol:Rr.symbol}},this.readTraceFull=function(e){if(null!=e){if(null!=e.Symbol&&(Rr.symbol=e.Symbol),null!=e.Traces){var t=e.Traces;ke(Rr.symbol,JSON.parse(t)),VGP.drawings[Rr.symbol]=1,Ar=JSON.parse(t)}this.loadTemplate(e)}},this.readTrace=function(){q(!1,!0,!1)},this.screenCapture=function(e){var t,a,r,n,o,i,l,s,c,d,u,h,p;if(null!=Ir){if(Nr.flagSave=!0,It(),(t=document.createElement("canvas")).id="canvasflatten",t.width=Rr.widthGraph,t.height=Rr.heightGraph,Lr.doc.parentNode.insertBefore(t,Lr.doc.nextSibling),(a=t.getContext("2d")).fillStyle=Rr.set.bkcolor,a.fillRect(0,0,t.width,t.height),a.font="11px Arial",r=b.gi(Ke("rodgraph-")),a.drawImage(r,0,0),a.drawImage(Dr[0].canvas,0,Rr.paddingTop),null==Ar.length||"perf"==Rr.mainChart.type||Rr.mainChart.typedef.nolinearX||(n=b.gi(Ke("trace-")),a.drawImage(n,Rr.paddingLeft,Rr.paddingTop)),!Rr.mainChart.typedef.nolinearX)for(o=1;o<Dr.length;o++)a.drawImage(Dr[o].canvas,0,Dr[o].RealY),a.fillStyle=Dr[o].Indicator.color,i=Dr[o].Indicator.type.toUpperCase(),null!=Dr[o].Indicator.param1&&(i+=" ("+Dr[o].Indicator.param1,null!=Dr[o].Indicator.param2&&(i+=", "+Dr[o].Indicator.param2,null!=Dr[o].Indicator.param3&&(i+=", "+Dr[o].Indicator.param3)),i+=")"),a.fillText(i,Rr.paddingLeft+5,Dr[o].RealY+13);if(a.fillStyle="#808080",e=null!=e?" - "+e:"",a.fillText(Ir.Name.toUpperCase()+e,Rr.paddingLeft,13),null!=(s=document.querySelector(".eod_topinfo span:last-child"))&&(l=s.textContent),c=a.measureText(l).width,a.fillText(l,Rr.widthGraph-Rr.paddingRight-c,13),!Rr.mainChart.typedef.nolinearX)for(d=Rr.paddingLeft+5,o=0;o<Rr.mainChart.indicators.length;o++)u=Rr.mainChart.indicators[o],a.fillStyle=u.color,h="",null!=u.param1&&(h+=" ("+u.param1,null!=u.param2&&(h+=", "+u.param2),h+=")"),h="compare"==u.type?u.datas2?u.datas2.Name:"NC":u.type.toUpperCase()+h,a.fillText(h,d,Rr.paddingTop+12),d+=a.measureText(h).width+15;return p=(p=t.toDataURL("image/png")).replace("data:image/png;base64,",""),b.idrem("canvasflatten"),p}},this.daysToDate=function(e,t){return Rr.histoLength<=20?m(e):g(e,t)},this.trace_menu=function(e){if(null!=Ir&&!Rr.mainChart.typedef.nolinearX)switch(Nt(),e){case"ewi":ba(e,6);break;case"ewc":ba(e,4);break;case"t":case"wf":ba(e,3);break;case"a":Yr={c:vr(),color:La()},w("c"),["touchstart","mousedown"].forEach((function(e){Lr.doc.addEventListener(e,Ea)})),sa("touchstart",Ea),sa("mousedown",Ea);break;case"fa":w("c"),Yr={c:vr(),color:La(),color2:"#4040ff"},["touchstart","click"].forEach((function(e){Lr.doc.addEventListener(e,Ca)})),["touchmove","mousemove"].forEach((function(e){Lr.doc.addEventListener(e,Sa)})),sa("click",Ca),sa("mousemove",Sa),sa("touchstart",Ca),sa("touchmove",Sa);break;case"arrup":case"arrdw":case"arrrt":case"arrlt":case"sm1":case"sm2":case"sm3":!function(e){w("c"),Yr={c:vr(),t:e},["touchstart","mousedown"].forEach((function(e){Lr.doc.addEventListener(e,_a)})),sa("mousedown",_a),sa("touchstart",_a)}(e);break;case"p":w("c"),Yr={c:vr(),color:La(),step1:!1},["touchstart","touchend","mousedown"].forEach((function(e){Lr.doc.addEventListener(e,tr)})),["touchmove","mousemove"].forEach((function(e){Lr.doc.addEventListener(e,ar)})),sa("touchend",tr),sa("touchstart",tr),sa("mousedown",tr),sa("mousemove",ar),sa("touchmove",ar);break;case"rf":case"r":case"m":!function(e){w("c"),Yr={c:vr(),type:e,color:La()},["touchstart","mousedown"].forEach((function(e){Lr.doc.addEventListener(e,Na)})),["touchmove","mousemove"].forEach((function(e){Lr.doc.addEventListener(e,Xa)})),sa("touchstart",Na),sa("mousedown",Na),sa("mousemove",Xa),sa("touchmove",Xa)}(e);break;case"e":Ar=[],r()&&(Rr.chartPeriod<0?sessionStorage.removeItem(Rr.symbol):(localStorage.removeItem(Rr.symbol),VGP.noAutoSaveTrace||(ut(),delete VGP.drawings[Rr.symbol]))),O(),k();break;default:!function(e){w("c"),Yr={type:e,c:vr(),color:La()},["touchstart","touchend","mousedown"].forEach((function(e){Lr.doc.addEventListener(e,lr)})),["touchmove","mousemove"].forEach((function(e){Lr.doc.addEventListener(e,ir)})),sa("touchend",lr),sa("touchstart",lr),sa("mousedown",lr),sa("mousemove",ir),sa("touchmove",ir)}(e)}},this.compare=function(t){var a,r,n,o,i;if(null!=Ir&&!Rr.mainChart.typedef.nolinearX&&"perf"!=Rr.mainChart.type){for(r=Rr.mainChart.indicators.length,n=0,a=0;a<r;a++)"compare"==Rr.mainChart.indicators[a].type&&n++;if(n>=4)return void DisplayAlert("Vous avez atteint le maximum de valeurs en comparaison");o=VGP.urlWS+"GetTicksEOD","GET"==VGP.callType&&(o=o+"?symbol="+t+"&length="+Rr.histoLength+"&period="+Rr.chartPeriod+"&guid="+b.gigt("guid")),(i=new XMLHttpRequest).open(VGP.callType,o,!0),i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.onload=function(){var a,r;if(i.status>=200&&i.status<400){if(null==(a=JSON.parse(i.responseText))||null==a.d)return;switch(r=e("compare"),n){case 1:r.color="rgba(0,128,0,1)";break;case 2:r.color="rgba(0,95,192,1)";break;case 3:r.color="rgba(127,0,255,1)"}r.datas2=a.d,r.symbol=t,Rr.mainChart.indicators.push(r),Rr.isCompare=!0,Be(Ir.High,Ir.Low,Ir.QuoteTab[0].c),$(0)}},i.send(JSON.stringify({symbol:t,length:Rr.histoLength,period:Rr.chartPeriod,guid:b.gigt("guid")}))}},Yt.prototype.Create=function(){this.canvas=document.createElement("canvas"),this.canvas.width=Rr.widthGraph,this.canvas.height=this.HeightPx,this.canvas.style.top=this.RealY+"px",this.canvas.id=this.id,Lr.doc.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),Dr.push(this)},Yt.prototype.Resize=function(e,t,a){this.Y=e,this.RealY=Math.round(e*Rr.usableHeight)+Rr.paddingTop+a,this.Height=t,this.HeightPx=Math.round(t*Rr.usableHeight),this.canvas.style.top=this.RealY+"px",this.canvas.height=this.HeightPx},Yt.prototype.Move=function(e,t,a){this.RealY=e,this.HeightPx=this.HeightPx+t,this.Y=(this.RealY-Rr.paddingTop-Rr.marginInter*a)/Rr.usableHeight,this.Height=this.HeightPx/Rr.usableHeight,this.canvas.style.top=this.RealY+"px",this.canvas.height=this.HeightPx},Yt.prototype.DrawEncadre=function(){this.ctx.clearRect(0,0,Rr.widthGraph,this.HeightPx),Rr.set.isEncadre&&(this.ctx.strokeStyle=Rr.set.cadreColor,this.ctx.strokeRect(Rr.paddingLeft+.5,.5,Rr.innerWidth,this.HeightPx-1))}},window.RODGraph=x}(),r={move:function(e,t,a){e.style.left=t+"px",e.style.top=a+"px"},startMoving:function(e,t,a){var n,o;if("linemodif"!=a.target.className)return!1;var i=(a=a||window.event).clientX,l=a.clientY,s=e.style.top,c=e.style.left,d=e.clientWidth,u=e.clientHeight,h=document.getElementById(t).clientWidth,p=document.getElementById(t).clientHeight;s=s.replace("px",""),c=c.replace("px",""),n=i-c,o=l-s,document.onmousemove=function(t){var a=(t=t||window.event).clientX,i=t.clientY,l=a-n,s=i-o;l<10&&(l=10),s<18&&(s=18),l+d>h-6&&(l=h-d-6),s+u>p+12&&(s=p-u+12),r.move(e,l,s)}},stopMoving:function(){document.onmousemove=function(){}}},n=new function(){function e(e){var t,a,r,n,o,i,l,s,c,d,u,h,p=function(e){return e-Math.floor(e)},m=e.getJulian(),f=e.getFullYear(),g=3.14159265/180;for(o=2415020+29*(t=Math.floor(12.3685*(f-1900))),i=1178e-7*(r=(a=(f-1899.5)/100)*a)-155e-9*(n=a*a*a)+(.75933+.53058868*t)-(837e-6*a+335e-6*r),l=360*p(.08084821133*t)+359.2242-333e-7*r-347e-8*n,s=360*p(.07171366128*t)+306.0253+.0107306*r+1236e-8*n,c=360*p(.08519585128*t)+21.2964-.0016528*r-239e-8*n,u=0,h=0;h<m;){var v=i+1.530588*u,y=(l+29.10535608*u)*g,b=(s+385.81691806*u)*g,x=(c+390.67050646*u)*g;v-=.4068*Math.sin(b)+(.1734-393e-6*a)*Math.sin(y),v+=.0161*Math.sin(2*b)+.0104*Math.sin(2*x),v-=.0074*Math.sin(y-b)-.0051*Math.sin(y+b),v+=.0021*Math.sin(2*y)+.001*Math.sin(2*x-b),v+=.5/1440,d=h,h=o+28*u+Math.floor(v),u++}return(m-d)/29.53059}this.computeMovingAverage=function(e,t,a){for(var r=[],n=e.length,o=0,i=0;i<n;i++)i<t?(o+=v(e[i],a),r[i]={d:e[i].d,v1:o/(i+1)}):(o=o+v(e[i],a)-v(e[i-t],a),r[i]={d:e[i].d,v1:o/t});return{Values:r}},this.computeFR=function(e,t){for(var a,r=[],n=e.length,o=t.length,i=0,l=-100,s=0,c=999999,d=[],u=0;u<o;u++)d[t[u].d]=t[u];for(u=0;u<n;u++)null!=d[e[u].d]&&(-100==l?(l=e[u].c,a=d[e[u].d].c):((i=100*((e[u].c-l)/l-(d[e[u].d].c-a)/a))>s&&(s=i),i<c&&(c=i))),r[u]={d:e[u].d,v1:i};return{High:s,Low:c,Values:r}},this.computeCMO=function(e,t){var a,r,n=[],o=e.length,i=0,l=0,s=[];for(s[0]=0,a=1;a<o;a++)s[a]=100*(e[a].c-e[a-1].c)/e[a-1].c;for(n[0]={d:e[0].d,v1:0},a=1;a<o;a++)a<t?s[a]>=0?i+=s[a]:l-=s[a]:s[a]>=0?(i+=s[a],s[a-t]>=0?i-=s[a-t]:l+=s[a-t]):(l-=s[a],s[a-t]>=0?i-=s[a-t]:l+=s[a-t]),r=100*(i-l)/(i+l),r=isNaN(r)?0:r,n[a]={d:e[a].d,v1:r};return{High:100,Low:-100,Values:n}},this.computeHighLow=function(e,t){var a,r,n,o,i,l=e.length;if(l<t)return null;for(i=[],a=0;a<t;a++)i[a]={d:e[a].d,v1:0,v2:0};for(a=t;a<l;a++){for(n=0,o=9999999,r=1;r<t&&!(a-r<0);r++)e[a-r].h>n&&(n=e[a-r].h),e[a-r].l<o&&(o=e[a-r].l);i[a]=n<e[a].h?{d:e[a].d,v1:e[a].h,v2:0}:o>e[a].l?{d:e[a].d,v1:0,v2:e[a].l}:{d:e[a].d,v1:0,v2:0}}return{Values:i}},this.computeSupertrend=function(e,t,a){var r,n,o,i,l,s,c=[],d=e.length,u=this.computeATR(e,t,"pma");if(null==u)return!1;for(r=(o=(e[0].h+e[0].l)/2)+a*u.Values[0].v1,n=o-a*u.Values[0].v1,c[0]={d:e[0].d,v1:r,v2:n},(s=[])[0]={u:r,d:n},l=1;l<d;l++)r=(o=(e[l].h+e[l].l)/2)+a*u.Values[l].v1,n=o-a*u.Values[l].v1,s[l]={u:r,d:n};for(l=1;l<d;l++)e[l].c>s[l-1].u?i=1:e[l].c<s[l-1].d&&(i=-1),-1==i?(s[l].u>s[l-1].u&&(s[l].u=s[l-1].u),c[l]={d:e[l].d,v1:s[l].u,v2:0}):(s[l].d<s[l-1].d&&(s[l].d=s[l-1].d),c[l]={d:e[l].d,v1:0,v2:s[l].d});return{Values:c}},this.computeVolume=function(e,t,a){var r,n,o=[],i=0,l=9999999999999,s=e.length;for(n=a?e[0].v*e[0].c:e[0].v,o[0]={d:e[0].d,v1:n},t.minX<=0&&(n>i&&(i=n),n<l&&(l=n)),r=1;r<s;r++)n=a?e[r].v*e[r].c:e[r].v,o[r]=e[r].c-e[r-1].c>=0?{d:e[r].d,v1:n}:{d:e[r].d,v2:n},r>=t.minX&&r<=t.maxX&&(n>i&&(i=n),n<l&&(l=n));return{High:i,Low:l,Values:o}},this.computeBollingerBandwith=function(e,t,a,r){for(var n=e.length,o=0,i=999999,l=[],s=this.computeBollinger(e,t,a,r),c=this.computeMovingAverage(e,t,r),d=0,u=0;u<n;u++)d=100*(s.Values[u].v1-s.Values[u].v2)/c.Values[u].v1,l[u]={d:e[u].d,v1:d},d>o&&(o=d),d<i&&(i=d);return{High:o,Low:i,Values:l}},this.computeVortex=function(e,t){var a,r=e.length;if(r<t+2)return null;var n=[],o=[],i=0,l=999999,s=[];for(n[0]={p:Math.abs(e[0].h-e[0].l),m:Math.abs(e[0].l-e[0].h)},o[0]=e[0].h-e[0].l,a=1;a<r;a++)n[a]={p:Math.abs(e[a].h-e[a-1].l),m:Math.abs(e[a].l-e[a-1].h)},o[a]=Math.max(e[a].h-e[a].l,Math.abs(e[a].h-e[a-1].c),Math.abs(e[a].l-e[a-1].c));var c,d,u=0,h=0,p=0;for(a=0;a<r;a++)a<t?(h+=n[a].p,c=(u+=n[a].m)/(a+1)/(p+=o[a]),d=h/(a+1)/p):(h=h+n[a].p-n[a-t].p,u=u+n[a].m-n[a-t].m,(d=h/t/(p=p+o[a]-o[a-t]))>i&&(i=d),d<l&&(l=d),(c=u/t/p)>i&&(i=c),c<l&&(l=c)),s[a]={d:e[a].d,v1:d,v2:c};for(a=0;a<t;a++)s[a]={d:e[a].d,v1:s[t].v1,v2:s[t].v2};return{High:i,Low:l,Values:s}},this.computeMFI=function(e,t){var a,r=e.length,n=[],o=[],i=[];for(i[0]={p:0,n:0},o[0]=(e[0].h+e[0].l+e[0].c)/3,a=1;a<r;a++)o[a]=(e[a].h+e[a].l+e[a].c)/3,i[a]=o[a]>=o[a-1]?{p:o[a]*e[0].v,n:0}:{p:0,n:o[a]*e[0].v};var l=0,s=0,c=[];for(a=0;a<r;a++)a<t?(l+=i[a].p,s+=i[a].n,c[a]={p:l/(a+1),n:s/(a+1)}):(l=l+i[a].p-i[a-t].p,s=s+i[a].n-i[a-t].n,c[a]={p:l/t,n:s/t}),n[a]=0==c[a].n?{d:e[a].d,v1:0}:{d:e[a].d,v1:100-100/(1+c[a].p/c[a].n)};return{High:100,Low:0,Values:n}},this.computeOBV=function(e){var t,a,r=-1e5,n=9999999999,o=e.length,i=[],l=0;for(i[0]={d:e[0].d,v1:0},t=1;t<o;t++)e[t].c>e[t-1].c&&(l+=e[t].v),e[t].c<e[t-1].c&&(l-=e[t].v),a=l/1e3,i[t]={d:e[t].d,v1:a},a>r&&(r=a),a<n&&(n=a);return{High:r,Low:n,Values:i}},this.computeAccDist=function(e){var t,a,r=[],n=-1e6,o=9999999999,i=e.length,l=0;for(r[0]={d:e[0].d,v1:0},t=1;t<i;t++)0!=(a=e[t].h-e[t].l)&&(l+=(e[t].c-e[t].l-(e[t].h-e[t].c))*(e[t].v/1e3)/a),r[t]={d:e[t].d,v1:l},l>n&&(n=l),l<o&&(o=l);return{High:n,Low:o,Values:r}},this.computeBollinger=function(e,t,a,r){for(var n,o,i,l,s,c,d,u,h=[],p=e.length,m=this.computeMovingAverage(e,t,r),f=[],g=0,y=0;y<p;y++)n=v(e[y],r),y<t?(g+=n*n,f[y]=g*t/(y+1)):(g=g+n*n-(o=v(e[y-t],r))*o,f[y]=g);for(i=[],l=0,y=0;y<p;y++)n=v(e[y],r),y<t?(s=(l+=n)*t/(y+1),i[y]=s*s):(l=l+n-(o=v(e[y-t],r)),i[y]=l*l);for(d=t*(t-1),y=0;y<p;y++)c=(u=t*f[y]-i[y])<0?0:Math.pow(u/d,.5)*a,h[y]={d:e[y].d,v1:m.Values[y].v1+c,v2:m.Values[y].v1-c};return{Values:h}},this.computeBollingerB=function(e,t,a,r){for(var n,o,i=this.computeBollinger(e,t,a,r),l=[],s=i.Values.length,c=0,d=100,u=0;u<s;u++)0==(o=i.Values[u].v1-i.Values[u].v2)&&(o=1),n=100*(v(e[u],r)-i.Values[u].v2)/o,l[u]={d:e[u].d,v1:n},n>c&&(c=n),n<d&&(d=n);return{High:c,Low:d,Values:l}},this.computeDMI=function(e,t,a){var r,n,o,i,l=[],s=e.length,c=0;if(s<2*t)return null;var d=[],u=[],h=[],p=[],m=0,f=0,g=0,v=[],y=[],b=[];for(d[0]={p:0,m:0},u[0]=1,r=1;r<s;r++)n=e[r].h-e[r-1].h,o=e[r-1].l-e[r].l,u[r]=Math.max(Math.abs(e[r].h-e[r].l),Math.abs(e[r].h-e[r-1].c),Math.abs(e[r].l-e[r-1].c)),d[r]=n>o?{p:Math.max(0,n),m:0}:{p:0,m:0},o>n&&(d[r].m=Math.max(0,o));for(r=1;r<=t;r++)g+=u[r],m+=d[r].p,f+=d[r].m;for(h[t]=g,p[t]={p:m,m:f},v[t]={p:100*p[t].p/h[t],m:100*p[t].m/h[t]},y[t]=Math.abs(p[t].p-p[t].m)/(p[t].p+p[t].m)*100,b[t]=y[t],l[t]="dmi"==a?{d:e[t].d,v1:v[t].p,v2:v[t].m,v3:b[t]}:{d:e[t].d,v1:b[t],v2:b[t]},r=t+1;r<s;r++)h[r]=h[r-1]-h[r-1]/t+u[r],m=p[r-1].p-p[r-1].p/t+d[r].p,f=p[r-1].m-p[r-1].m/t+d[r].m,p[r]={p:m,m:f},v[r]={p:100*p[r].p/h[r],m:100*p[r].m/h[r]},y[r]=Math.abs(p[r].p-p[r].m)/(p[r].p+p[r].m)*100,b[r]=(b[r-1]*(t-1)+y[r])/t,"dmi"==a&&(v[r].p>c&&(c=v[r].p),v[r].m>c&&(c=v[r].m),l[r]={d:e[r].d,v1:v[r].p,v2:v[r].m,v3:b[r]}),b[r]>c&&(c=b[r]);if(c>100&&(c=90),"dmi"==a)for(i=(l[t+1].v1+l[t+1].v2+l[t+1].v3)/3,r=0;r<=t;r++)l[r]={d:e[r].d,v1:i,v2:i,v3:i};if("adx"==a&&s>2*t){for(r=t+1;r<2*t;r++)l[r]={d:e[r].d,v1:b[r],v2:(b[t]+b[r])/2};for(r=2*t;r<s;r++)l[r]={d:e[r].d,v1:b[r],v2:(b[r-t]+b[r])/2};for(r=0;r<=t;r++)l[r]={d:e[r].d,v1:l[t].v1,v2:l[t].v2}}return{High:c,Low:0,Values:l}},this.computeLinearCurve=function(e,t,a,r){var n,o,i,l,s,c,d,u,h=[],p=e.length;if(p<=t)return null;if(1==a)for(n=0;n<=t;n++)h[n]={d:e[n].d,v1:v(e[n],r)};else for(n=0;n<=t;n++)h[n]={d:e[n].d,v1:0};for(i=-100,l=100,n=p-1;n>t;n--){var m=0,f=0,g=0,y=0;for(o=t;o>=1;o--)m+=o*(c=v(e[n-(t-o)],r)),f+=o,g+=c,y+=o*o;d=(g-(u=(m*t-f*g)/(t*y-f*f))*f)/t,1==a?h[n]={d:e[n].d,v1:d+u*t}:((s=v(e[n],r)-(d+u*t))>i&&(i=s),s<l&&(l=s),h[n]={d:e[n].d,v1:s})}return 1==a?{Values:h}:{High:i,Low:l,Values:h}},this.computeUlcerIndex=function(e,t,a){for(var r,n,o,i,l=[],s=0,c=e.length,d=0,u=[],h=0;h<c;h++){for(r=0;r<t&&!(h-r<0);r++)v(e[h-r],a)>d&&(d=v(e[h-r],a));n=(v(e[h],a)-d)/d*100,u[h]={d:e[h].d,c:n*n},d=0}for(i=this.computeMovingAverage(u,t,"c"),h=0;h<c;h++)o=Math.pow(i.Values[h].v1,.5),l[h]={d:e[h].d,v1:o},o>s&&(s=o);return{High:s,Low:0,Values:l}},this.computeCCI=function(e,t){for(var a,r,n,o,i,l,s,c,d=[],u=e.length,h=0,p=0,m=[],f=0,g=0;g<u;g++)m[g]=(e[g].h+e[g].l+e[g].c)/3;for(a=[],g=0;g<u;g++)g<t?(f+=m[g],a[g]=f/(g+1)):(f=f+m[g]-m[g-t],a[g]=f/t);for(r=[],n=0,g=0;g<u;g++)o=m[g],g<t?(n+=o*o,r[g]=n*t/(g+1)):(n=n+o*o-(i=m[g-t])*i,r[g]=n);for(l=[],s=0,g=0;g<u;g++)o=m[g],g<t?(c=(s+=o)*t/(g+1),l[g]=c*c):(s=s+o-(i=m[g-t]),l[g]=s*s);d[0]={d:e[0].d,v1:0};var v=[],y=0,b=t*(t-1);for(g=1;g<u;g++)o=t*r[g]-l[g],v[g]=o<0?0:Math.pow(o/b,.5),y=(m[g]-a[g])/(.015*v[g]),d[g]={d:e[g].d,v1:y},y>h&&(h=y),y<p&&(p=y);return{High:h,Low:p,Values:d}},this.computeMM=function(e,t){for(var a=e.length,r=0,n=0;n<a;n++)n<t?(r+=e[n].v1,e[n].vm=r/(n+1)):(r=r+e[n].v1-e[n-t].v1,e[n].vm=r/t);return e},this.computeMMonVolume=function(e,t){for(var a=e.length,r=0,n=0;n<a;n++)n<t?(r+=e[n].v1||e[n].v2,e[n].vm=r/(n+1)):(r=r+(null!=e[n].v1?e[n].v1:e[n].v2)-(null!=e[n-t].v1?e[n-t].v1:e[n-t].v2),e[n].vm=r/t);return e},this.computeUltimateOsc=function(e,t,a,r){var n,o,i,l=[],s=e.length,c=[],d=[];for(c[0]=e[0].c-e[0].l,d[0]=e[0].h-e[0].l,n=1;n<s;n++)i=Math.min(e[n].l,e[n-1].c),c[n]=e[n].c-i,d[n]=Math.max(e[n].h,e[n-1].c)-i;var u,h,p=[],m=[],f=[];for(n=0;n<s;n++){for(u=0,h=0,o=0;o<t&&!(n-o<0);o++)u+=c[n-o],h+=d[n-o];p[n]=u/h}for(n=0;n<s;n++){for(u=0,h=0,o=0;o<a&&!(n-o<0);o++)u+=c[n-o],h+=d[n-o];m[n]=u/h}for(n=0;n<s;n++){for(u=0,h=0,o=0;o<r&&!(n-o<0);o++)u+=c[n-o],h+=d[n-o];f[n]=u/h}for(n=0;n<s;n++)l[n]={d:e[n].d,v1:100*(4*p[n]+2*m[n]+f[n])/7};return{High:95,Low:5,Values:l}},this.computeDI=function(e,t){var a,r,n,o,i;if(e.length<2*t+2)return null;for(var l,s=[],c=[],d=e.length,u=[],h=[],p=[],m=[],f=[],g=[],v=[],y=[],b=[],x=[],w=[],T=80,C=-80,S=0;S<d;S++)c[S]=(e[S].h+e[S].l+2*e[S].c)/4;for(u[0]={d:e[0].d,c:0},S=1;S<d;S++)u[S]={d:e[S].d,c:Math.max(e[S-1].c,e[S].h)-Math.min(e[S-1].c,e[S].l)},h[S]=(c[S]-c[S-1])/Math.min(c[S-1],c[S]);for(l=this.computeMovingAverage(u,t),a=0,S=0;S<t;S++)a+=e[S].v;for(p[t-1]=a/t,S=t;S<d;S++)p[S]=(p[S-1]*(t-1)+e[S].v)/t;for(S=t-1;S<d;S++)m[S]=e[S].v/p[S];for(S=t;S<d;S++)r=3*c[S]/l.Values[S].v1*Math.abs(h[S]),f[S]=r>88?88:r,g[S]=m[S]/Math.exp(f[S]),v[S]=h[S]>0?m[S]:g[S],y[S]=h[S]<0?m[S]:g[S];for(n=0,o=0,S=t;S<2*t;S++)n+=v[S],o+=y[S];for(b[2*t-1]=o/t,x[2*t-1]=n/t,S=2*t;S<d;S++)b[S]=(b[S-1]*(t-1)+y[S])/t,x[S]=(x[S-1]*(t-1)+v[S])/t,w[S]=b[S]>x[S]?-x[S]/b[S]:b[S]/x[S],(i=w[S]<0?100*(-1-w[S]):100*(1-w[S]))>T&&(T=i),i<C&&(C=i),s[S]={d:e[S].d,v1:i};for(S=0;S<2*t;S++)s[S]={d:e[S].d,v1:0};return{High:T,Low:C,Values:s}},this.computeKST=function(e,t,a,r,n,o){for(var i,l=[],s=e.length,c=0,d=999999,u=this.computeROC(e,t,null,o),h=this.computeROC(e,a,null,o),p=this.computeROC(e,r,null,o),m=this.computeROC(e,n,null,o),f=this.computeMM(u.Values,10),g=this.computeMM(h.Values,10),v=this.computeMM(p.Values,10),y=this.computeMM(m.Values,15),b=[],x=0;x<s;x++)b[x]={v1:f[x].vm+2*g[x].vm+3*v[x].vm+4*y[x].vm},b[x].v1>c&&(c=b[x].v1),b[x].v1<d&&(d=b[x].v1);for(i=this.computeMM(b,9),x=0;x<s;x++)l[x]={d:e[x].d,v1:b[x].v1,v2:i[x].vm};return{High:c,Low:d,Values:l}},this.computeZigZag=function(e,t,a){var r,n,o,i,l=[],s=e.length,c=0,d=v(e[0],a),u=e[0].d;for(l[0]={d:e[0].d,v1:d},o="h",r=0;r<s;r++)n=((i=v(e[r],a))-d)/d,"h"==o?n>0?(d=i,u=e[r].d,c=r):Math.abs(n)>=t&&(l[c]={d:u,v1:d},d=i,u=e[r].d,o="b",c=r):n<0?(d=i,u=e[r].d,c=r):Math.abs(n)>=t&&(l[c]={d:u,v1:d},d=i,u=e[r].d,o="h",c=r);return l[s-1]={d:e[s-1].d,v1:e[s-1].c},{Values:l}},this.computeMovingAverageT=function(e,t,a){t=Math.round((t+1)/2);for(var r=this.computeMovingAverage(e,t,a),n=[],o=r.Values.length,i=0,l=0;l<o;l++)l<t?(i+=r.Values[l].v1,n[l]={d:r.Values[l].d,v1:i/(l+1)}):(i=i+r.Values[l].v1-r.Values[l-t].v1,n[l]={d:r.Values[l].d,v1:i/t});return{Values:n}},this.computeEVMM=function(e,t,a,r){var n,o=[],i=e.length,l=0;for(a/=100,n=0;n<i;n++)n<t?(l+=v(e[n],r),o[n]={d:e[n].d,v1:l/(n+1)*(1+a),v2:l/(n+1)*(1-a)}):(l=l+v(e[n],r)-v(e[n-t],r),o[n]={d:e[n].d,v1:l/t*(1+a),v2:l/t*(1-a)});return{Values:o}},this.computeDPO=function(e,t){var a,r,n,o,i=[],l=0,s=9999,c=e.length;if(t+1>c)return null;for(r=this.computeMovingAverage(e,t),(o=Math.round(t/2-1))<1&&(o=1),a=0;a<o;a++)i[a]={d:e[a].d,v1:0};for(a=o;a<c;a++)(n=e[a].c-r.Values[a-o].v1)>l&&(l=n),n<s&&(s=n),i[a]={d:e[a].d,v1:n};return{High:l,Low:s,Values:i}},this.computeCMF=function(e,t){var a,r,n,o,i,l=[],s=e.length,c=0,d=0,u=9999;for(l[0]={d:e[0].d,v1:0},a=1;a<s;a++){for(c=0,n=0,r=0;r<t&&!(a-r<0);r++)0!=(i=e[a-r].h-e[a-r].l)&&(n+=e[a-r].v*(e[a-r].c-e[a-r].l-(e[a-r].h-e[a-r].c))/i),c+=e[a-r].v;(o=n/c)>d&&(d=o),o<u&&(u=o),l[a]={d:e[a].d,v1:o}}return{High:d,Low:u,Values:l}},this.computeBOP=function(e){var t,a,r,n,o=[],i=e.length;for(n=0!=(r=e[0].h-e[0].l)?(e[0].c-e[0].o)/r:0,o[0]=n<0?{d:e[0].d,v2:n}:{d:e[0].d,v1:n},t=1;t<i;t++)a=0!=(r=e[t].h-e[t].l)?(e[t].c-e[t].o)/r:0,o[t]=a>=0&&n>=0?a>=n?{d:e[t].d,v1:a}:{d:e[t].d,v3:a}:a<0&&n<0?a<=n?{d:e[t].d,v2:a}:{d:e[t].d,v3:a}:a<0?{d:e[t].d,v2:a}:{d:e[t].d,v1:a},n=a;return{High:1.2,Low:-1.05,Values:o}},this.computeAwesomeIndicator=function(e,t,a){for(var r,n,o=[],i=e.length,l=[],s=0;s<i;s++)r=(e[s].h+e[s].l)/2,l[s]={d:e[s].d,c:r};var c,d=this.computeMovingAverage(l,t,"c"),u=this.computeMovingAverage(l,a,"c"),h=0,p=99999;for(c=d.Values[0].v1-u.Values[0].v1,o[0]={d:e[0].d,v1:c},n=c,s=1;s<i;s++)(c=d.Values[s].v1-u.Values[s].v1)>h&&(h=c),c<p&&(p=c),o[s]=c>=n?{d:e[s].d,v1:c}:{d:e[s].d,v2:c},n=c;return{High:h,Low:p,Values:o}},this.computeGMMA=function(e){for(var t,a=[],r=[],n=e.length,o=[3,5,8,10,12,15,30,35,40,45,50,60],i=o.length,l=0;l<i;l++)r[l]=this.computeMovingAverageE(e,o[l]);for(l=0;l<n;l++)for(a[l]={d:e[l].d},t=0;t<12;t++)a[l]["v"+(t+1)]=r[t].Values[l].v1;return{Values:a}},this.computeAlligator=function(e,t,a,r){var n,o=[],i=e.length,l=0,s=[],c=[],d=[],u=0,h=Math.max(t,a,r);if(i<h+1||h<13)return null;for(n=0;n<t;n++)l+=v(e[n],"m"),s[n]=l/(n+1);for(u=l,n=t;n<i;n++)u=u+v(e[n],"m")-s[n-1],s[n]=u/t;for(l=0,n=0;n<a;n++)l+=v(e[n],"m"),c[n]=l/(n+1);for(u=l,n=a;n<i;n++)u=u+v(e[n],"m")-c[n-1],c[n]=u/a;for(l=0,n=0;n<r;n++)l+=v(e[n],"m"),d[n]=l/(n+1);for(u=l,n=r;n<i;n++)u=u+v(e[n],"m")-d[n-1],d[n]=u/r;for(n=h;n<i;n++)o[n]={d:e[n].d,v1:s[n-8],v2:c[n-5],v3:d[n-3]};return{Values:o}},this.computeMovingAverageHull=function(e,t,a){var r,n,o=e.length,i=Math.floor(t/2);i<1&&(i=1),(n=Math.floor(Math.sqrt(t)))<1&&(n=1);var l=this.computeMovingAverageP(e,i,a),s=this.computeMovingAverageP(e,t,a),c=[];for(r=0;r<o;r++)c[r]={d:l.Values[r].d,c:2*l.Values[r].v1-s.Values[r].v1};return{Values:this.computeMovingAverageP(c,n).Values}},this.computeMovingAverageP=function(e,t,a){var r,n,o,i,l,s=[],c=e.length;for(s[0]={d:e[0].d,v1:v(e[0],a)},r=1;r<c;r++){for(o=0,n=0;n<t&&!(r-n<0);n++)l=v(e[r-n],a),o=r<t?o+(r-n+1)*l:o+(t-n)*l;i=(n+1)*n*.5,s[r]={d:e[r].d,v1:o/i}}return{Values:s}},this.computeMovingAverageE=function(e,t,a){var r,n=[],o=e.length;n[0]={d:e[0].d,v1:v(e[0],a)};var i=v(e[0],a),l=2/(t+1),s=1-l;for(r=1;r<o;r++)i=v(e[r],a)*l+i*s,n[r]={d:e[r].d,v1:i};return{Values:n}},this.computeDoubleEMA=function(e,t,a){var r,n,o,i=this.computeMovingAverageE(e,t,a),l=[],s=i.Values.length;for(l[0]={d:i.Values[0].d,v1:i.Values[0].v1},n=i.Values[0].v1,o=2/(t+1),r=1;r<s;r++)n=i.Values[r].v1*o+n*(1-o),l[r]={d:i.Values[r].d,v1:2*i.Values[r].v1-n};return{Values:l}},this.computeTripleEMA=function(e,t,a){var r,n=this.computeMovingAverageE(e,t,a),o=[],i=n.Values.length;o[0]={d:n.Values[0].d,v1:n.Values[0].v1};var l=n.Values[0].v1,s=n.Values[0].v1,c=2/(t+1);for(r=1;r<i;r++)s=(l=n.Values[r].v1*c+l*(1-c))*c+s*(1-c),o[r]={d:n.Values[r].d,v1:3*n.Values[r].v1-3*l+s};return{Values:o}},this.computeTSI=function(e,t,a,r){var n,o,i,l,s,c,d,u,h,p,m,f,g=[],v=e.length,y=-100,b=100;if(v<a)return null;for((o=[])[0]=0,n=1;n<v;n++)o[n]=e[n].c-e[n-1].c;for(i=o[0],(l=[])[0]=i,s=2/(a+1),n=1;n<v;n++)i=o[n]*s+i*(1-s),l[n]=i;for(i=l[0],(c=[])[0]=i,d=2/(t+1),n=1;n<v;n++)i=l[n]*d+i*(1-d),c[n]=i;for(i=Math.abs(o[0]),(u=[])[0]=i,n=1;n<v;n++)i=Math.abs(o[n])*s+i*(1-s),u[n]=i;for(i=u[0],h=[],u[0]=i,n=1;n<v;n++)i=u[n]*d+i*(1-d),h[n]=i;for((p=[])[0]=0,n=1;n<v;n++)p[n]=100*c[n]/h[n];for(n=15;n<v;n++)p[n]>y&&(y=p[n]),p[n]<b&&(b=p[n]);for(m=[],i=p[0],m[0]=i,f=2/(r+1),n=1;n<v;n++)i=p[n]*f+i*(1-f),m[n]=i;for(n=0;n<15;n++)g[n]={d:e[n].d,v1:0,v2:0};for(n=15;n<v;n++)g[n]={d:e[n].d,v1:p[n],v2:m[n]};return{High:y,Low:b,Values:g}},this.computeMassIndex=function(e,t){var a,r,n,o,i,l,s,c=[],d=e.length,u=[],h=0,p=9999;if(d<9||d<t)return null;for(a=0;a<d;a++)u[a]=e[a].h-e[a].l;for(n=u[0],(o=[])[0]=n,a=1;a<d;a++)n=.2*u[a]+.8*n,o[a]=n;for(n=o[0],(i=[])[0]=n,a=1;a<d;a++)n=.2*o[a]+.8*n,i[a]=n;for(l=[],a=0;a<d;a++)l[a]=o[a]/i[a];for(s=0,a=0;a<d;a++){for(s=0,r=0;r<t;r++){if(a-r<0){s=s*t/r;break}s+=l[a-r]}s>h&&(h=s),s<p&&(p=s),c[a]={d:e[a].d,v1:s}}return{High:h,Low:p,Values:c}},this.computeRSI=function(e,t,a){var r;if(t<2)return null;var n,o,i,l,s=[],c=e.length,d=[],u=[];for(d[0]={h:0,b:0},u[0]={mmh:0,mmb:0},s[0]={d:e[0].d,v1:50},r=t-1,o=1;o<c;o++)n=v(e[o],a)-v(e[o-1],a),d[o]=0==n?{h:0,b:0}:n>0?{h:n,b:0}:{h:0,b:-1*n},i=(u[o-1].mmh*r+d[o].h)/t,l=(u[o-1].mmb*r+d[o].b)/t,u[o]={mmh:i,mmb:l},s[o]=0==l?{d:e[o].d,v1:100}:{d:e[o].d,v1:100-100/(1+i/l)};return{High:100,Low:0,Values:s}},this.computeForceIndex=function(e,t,a){var r,n,o,i=e.length,l=[],s=-9999,c=9999;for(l[0]={d:e[0].d,c:0},r=1;r<i;r++)l[r]={d:e[r].d,c:e[r].v*(v(e[r],a)-v(e[r-1],a))};for(o=(n=this.computeMovingAverageE(l,t,"c")).Values.length,r=0;r<o;r++)n.Values[r].v1>s&&(s=n.Values[r].v1),n.Values[r].v1<c&&(c=n.Values[r].v1);return{High:s,Low:c,Values:n.Values}},this.computeElderRay=function(e,t,a){var r,n,o=this.computeMovingAverageE(e,t,"c"),i=[],l=o.Values.length,s=-1e3,c=1e3;if("bear"==a)for(r=0;r<l;r++)(n=e[r].l-o.Values[r].v1)>s&&(s=n),n<c&&(c=n),i[r]={d:e[r].d,v1:n};else for(r=0;r<l;r++)(n=e[r].h-o.Values[r].v1)>s&&(s=n),n<c&&(c=n),i[r]={d:e[r].d,v1:n};return{High:s,Low:c,Values:i}},this.computeQStick=function(e,t){for(var a,r,n=[],o=-1e3,i=1e3,l=e.length,s=[],c=0;c<l;c++)s[c]=e[c].c-e[c].o;for(c=0;c<l;c++){for(a=0,r=0;r<t&&!(c-r<0);r++)a+=s[c-r];(a/=r)>o&&(o=a),a<i&&(i=a),n[c]={d:e[c].d,v1:a}}return{High:o,Low:i,Values:n}},this.computeATR=function(e,t,a){var r,n,o,i,l=[],s=0,c=9999,d=e.length,u=0,h=0,p=0,m=[];if(d<t+1)return null;for(m[0]=e[0].h-e[0].l,l[0]={d:e[0].d,v1:m[0]},r=1;r<d;r++)u=e[r].h-e[r].l,h=Math.abs(e[r-1].c-e[r].h),p=Math.abs(e[r-1].c-e[r].l),m[r]=Math.max(u,h,p);if(o=0,"ema"==a)for(o=m[0],i=2/(t+1),r=1;r<d;r++)(o=m[r]*i+o*(1-i))>s&&(s=o),o<c&&(c=o),l[r]={d:e[r].d,v1:o};if("pma"==a)for(o=m[0],r=1;r<d;r++)(o=(o*(t-1)+m[r])/t)>s&&(s=o),o<c&&(c=o),l[r]={d:e[r].d,v1:o};if("sma"==a){for(r=1;r<t;r++){for(n=0;n<=r;n++)o+=m[n];(o/=n)>s&&(s=o),o<c&&(c=o),l[r]={d:e[r].d,v1:o},o=0}for(r=t;r<d;r++){for(n=0;n<t;n++)o+=m[r-n];o/=t,l[r]={d:e[r].d,v1:o},o>s&&(s=o),o<c&&(c=o),o=0}}return{High:s,Low:c,Values:l}},this.computeEaseOfMovement=function(e,t){var a,r,n,o=[],i=0,l=999999,s=e.length,c=0,d=[];for(d[0]=0,a=1;a<s;a++)c=0!=e[a].v?((e[a].h+e[a].l)/2-(e[a-1].h+e[a-1].l)/2)/(e[a].v/(e[a].h-e[a].l)):0,d[a]=1e6*c,c=0;for(o[0]={d:e[0].d,v1:0},r=0,n=2/(t+1),a=1;a<s;a++)r=d[a]*n+r*(1-n),o[a]={d:e[a].d,v1:r},r>i&&(i=r),r<l&&(l=r);return{High:i,Low:l,Values:o}},this.computeIchimoku=function(e,t,a,r){var n,o,i,l=[],s=e.length,c=0,d=999999;if(s<2*t+1)return null;for(n=0;n<t;n++){for(o=n;o>=0;o--)e[o].h>c&&(c=e[o].h),e[o].l<d&&(d=e[o].l);l[n]={d:e[n].d,v1:(c+d)/2},c=0,d=999999}for(n=t;n<s;n++){for(o=0;o<t;o++)e[n-o].h>c&&(c=e[n-o].h),e[n-o].l<d&&(d=e[n-o].l);l[n]={d:e[n].d,v1:(c+d)/2},c=0,d=999999}for(c=0,d=999999,n=0;n<a;n++){for(o=n;o>=0;o--)e[o].h>c&&(c=e[o].h),e[o].l<d&&(d=e[o].l);l[n].v2=(c+d)/2,c=0,d=999999}for(n=a;n<s;n++){for(o=0;o<a;o++)e[n-o].h>c&&(c=e[n-o].h),e[n-o].l<d&&(d=e[n-o].l);l[n].v2=(c+d)/2,c=0,d=999999}for(n=0;n<s-t;n++)l[n].v3=e[n+t].c;for(n=t;n<s;n++)l[n].v4=(l[n-t].v1+l[n-t].v2)/2;for(i=e[s-1].d,n=0;n<t;n++)l[s+n]={d:i+(n+1)*r,v4:(l[s+n-t].v1+l[s+n-t].v2)/2};for(c=0,d=999999,n=0;n<2*t;n++){for(o=n;o>=0;o--)e[o].h>c&&(c=e[o].h),e[o].l<d&&(d=e[o].l);l[n+t].v5=(c+d)/2,c=0,d=999999}for(n=2*t;n<s;n++){for(o=0;o<2*t;o++)e[n-o].h>c&&(c=e[n-o].h),e[n-o].l<d&&(d=e[n-o].l);l[n+t].v5=(c+d)/2,c=0,d=999999}for(n=t;n<s+t;n++)l[n].v4>l[n].v5?(l[n].v6=l[n].v4,l[n].v7=l[n].v5):(l[n].v6=l[n].v5,l[n].v7=l[n].v4);return{Values:l}},this.computeKVO=function(e){var t,a,r=[],n=0,o=999999,i=e.length,l=[],s=[];for(s[0]={d:e[0].d,c:e[0].v},l[0]=(e[0].c+e[0].l+e[0].h)/3,t=1;t<i;t++)l[t]=(e[t].c+e[t].l+e[t].h)/3,s[t]=l[t]>=l[t-1]?{d:e[t].d,c:e[t].v}:{d:e[t].d,c:-1*e[t].v};var c=this.computeMovingAverageE(s,34,"c"),d=this.computeMovingAverageE(s,55,"c"),u=[];for(t=0;t<i;t++)u[t]={d:e[t].d,c:c.Values[t].v1-d.Values[t].v1},u[t].c>n&&(n=u[t].c),u[t].c<o&&(o=u[t].c);for(a=this.computeMovingAverageE(u,13,"c"),t=0;t<i;t++)r[t]={d:e[t].d,v1:u[t].c,v2:a.Values[t].v1};return{High:n,Low:o,Values:r}},this.computeMomentum=function(e,t,a){var r,n,o,i=[],l=0,s=999999,c=e.length;if(c<t+1)return null;for(o=v(e[0],a),r=0;r<t;r++)n=v(e[r],a)-o,i[r]={d:e[r].d,v1:n},n>l&&(l=n),n<s&&(s=n);for(r=t;r<c;r++)n=v(e[r],a)-v(e[r-t],a),i[r]={d:e[r].d,v1:n},n>l&&(l=n),n<s&&(s=n);return{High:l,Low:s,Values:i}},this.computeNVIPVI=function(e,t,a){var r,n,o,i=[],l=0,s=999999,c=e.length,d=1;for(i[0]={d:e[0].d,v1:d},r=1;r<c;r++)0==e[r].v?i[r]={d:e[r].d,v1:d}:(o=v(e[r-1],t),n=v(e[r],t),"nvi"==a?e[r].v<e[r-1].v?(d+=(n-o)*d/o,i[r]={d:e[r].d,v1:d}):i[r]={d:e[r].d,v1:d}:e[r].v>e[r-1].v?(d+=(n-o)*d/o,i[r]={d:e[r].d,v1:d}):i[r]={d:e[r].d,v1:d}),d>l&&(l=d),d<s&&(s=d);return{High:l,Low:s,Values:i}},this.computeWaveTrendOsc=function(e,t,a){var r,n,o,i,l,s,c,d=[],u=e.length;if(t>=u||a>u)return null;for(n=this.computeMovingAverageE(e,t,"m2"),o=[],r=0;r<u;r++)o[r]={d:e[r].d,c:Math.abs(v(e[r],"m2")-n.Values[r].v1)};for(i=this.computeMovingAverageE(o,t),l=[],r=0;r<u;r++)l[r]=0!=i.Values[r].v1?{d:e[r].d,c:(v(e[r],"m2")-n.Values[r].v1)/(.015*i.Values[r].v1)}:{d:e[r].d,c:0};for(s=this.computeMovingAverageE(l,a),c=this.computeMM(s.Values,4),r=0;r<u;r++)d[r]={d:e[r].d,v1:s.Values[r].v1,v2:c[r].vm};return{High:85,Low:-90,Values:d}},this.computeMACDZL=function(e,t,a,r){var n,o,i=[],l=0,s=999999,c=e.length;if(t>=c||a>c||r>c)return null;var d,u=this.computeDoubleEMA(e,t),h=this.computeDoubleEMA(e,a),p=[];for(n=0;n<c;n++)d=u.Values[n].v1-h.Values[n].v1,p[n]={c:d,d:u.Values[n].d},d>l&&(l=d),d<s&&(s=d);for(o=this.computeDoubleEMA(p,r),n=0;n<c;n++)i[n]={d:e[n].d,v1:p[n].c,v2:o.Values[n].v1};return{High:l,Low:s,Values:i}},this.computeMACD=function(e,t,a,r,n,o){var i,l,s,c=[],d=0,u=999999,h=e.length,p=[],m=[];if(t>=h||a>h||r>h)return null;p[0]=v(e[0],o),m[0]=v(e[0],o),s=[],(l=[])[0]=0,s[0]=0;var f,g,y=2/(t+1),b=2/(a+1),x=2/(r+1);for(i=1;i<h;i++)f=v(e[i],o),p[i]=f*y+p[i-1]*(1-y),m[i]=f*b+m[i-1]*(1-b),l[i]=p[i]-m[i],s[i]=l[i]*x+s[i-1]*(1-x);if("macd"==n)for(i=0;i<h;i++)c[i]={d:e[i].d,v1:l[i],v2:s[i]},l[i]>d&&(d=l[i]),l[i]<u&&(u=l[i]);else for(i=0;i<h;i++)g=l[i]-s[i],c[i]={d:e[i].d,v1:g},g>d&&(d=g),g<u&&(u=g);return{High:d,Low:u,Values:c}},this.computeCoppock=function(e,t,a,r,n){var o,i=0,l=999999;if(e.length<r+5)return null;var s,c=this.computeROC(e,t,null,n),d=this.computeROC(e,a,null,n),u=c.Values.length,h=[];for(o=1;o<u;o++)(s=c.Values[o].v1+d.Values[o].v1)>i&&(i=s),s<l&&(l=s),h[o]={d:c.Values[o].d,c:s};return h[0]={d:c.Values[0].d,c:h[1].c},{High:i,Low:l,Values:this.computeMovingAverageP(h,r,"c").Values}},this.computeROC=function(e,t,a,r){var n,o,i=[],l=0,s=999999,c=0,d=e.length,u=v(e[0],a);if(r)for(i[0]={d:e[0].d,v1:100},n=1;n<d;n++)(c=n-t<0?100*v(e[n],a)/u:100*v(e[n],a)/v(e[n-t],a))>l&&(l=c),c<s&&(s=c),i[n]={d:e[n].d,v1:c};else for(i[0]={d:e[0].d,v1:0},n=1;n<d;n++)n-t<0?c=100*(v(e[n],a)-u)/u:(o=v(e[n-t],a),c=100*(v(e[n],a)-o)/o),c>l&&(l=c),c<s&&(s=c),i[n]={d:e[n].d,v1:c};return{High:l,Low:s,Values:i}},this.computeSTD=function(e,t,a){for(var r,n,o=[],i=0,l=e.length,s=0,c=this.computeMovingAverage(e,t,a),d=0;d<l;d++){for(r=0;r<t&&!(d-r<0);r++)s+=(n=v(e[d-r],a)-c.Values[d].v1)*n;s=Math.sqrt(s/r),o[d]={d:e[d].d,v1:s},s>i&&(i=s),s=0}return{High:i,Low:0,Values:o}},this.computeSMI=function(e,t,a,r,n){var o,i=[],l=e.length;if(l<t+1)return null;for(var s,c=[],d=[],u=e[0].l,h=e[0].h,p=0;p<l;p++){for(s=0;s<t&&!(p-s<0);s++)e[p-s].h>h&&(h=e[p-s].h),e[p-s].l<u&&(u=e[p-s].l);d[p]={h:h,l:u},c[p]={d:e[p].d,c:e[p].c-(h+u)/2},h=0,u=999999}var m=this.computeMovingAverageE(c,a,"c"),f=this.computeMovingAverageE(m.Values,r,"v1"),g=[];for(p=0;p<l;p++)g[p]={d:e[p].d,c:d[p].h-d[p].l};var v=this.computeMovingAverageE(g,a,"c"),y=this.computeMovingAverageE(v.Values,r,"v1"),b=[];for(p=0;p<l;p++)b[p]=100*f.Values[p].v1/(y.Values[p].v1/2);for(o=0,p=0;p<l;p++){for(o=0,s=0;s<n&&!(p-s<0);s++)o+=b[p-s];i[p]={d:e[p].d,v1:b[p],v2:o/s}}return{High:110,Low:-100,Values:i}},this.computeASI=function(e){var t,a=[],r=e.length;if(r<3)return null;var n,o,i,l,s,c,d=0,u=0,h=999999;for(a[0]={d:e[0].d,v1:0},t=1;t<r;t++)i=Math.abs(e[t].h-e[t-1].c),l=Math.abs(e[t].l-e[t-1].c),s=e[t].h-e[t].l,c=Math.abs(e[t-1].c-e[t-1].o),i>l&&i>s&&(n=i-.5*l+.25*c),l>i&&l>s&&(n=l-.5*i+.25*c),s>i&&s>l&&(n=s+.25*c),null==n&&(n=s+.25*c),o=Math.max(i,l),0!=n&&(d+=(e[t].c-e[t-1].c+.5*(e[t].c-e[t].o)+.25*(e[t-1].c-e[t-1].o))/n*50*(o/300)),d>u&&(u=d),d<h&&(h=d),a[t]={d:e[t].d,v1:d};return{High:u,Low:h,Values:a}},this.computeStochRSI=function(e,t,a,r,n,o){var i,l,s,c;if(e.length<n+1||null==(l=this.computeRSI(e,n,o)))return null;for(s=[],c=l.Values.length,i=0;i<c;i++)s[i]={d:l.Values[i].d,h:l.Values[i].v1,l:l.Values[i].v1,c:l.Values[i].v1};return this.computeSTOCH(s,t,a,r)},this.computeSTOCH=function(e,t,a,r){var n,o,i=[],l=e.length,s=0,c=9999;if(l<t+1)return null;var d,u,h=[],p=e[0].l,m=e[0].h,f=m-p;for(h[0]=0!=f?100*(e[0].c-p)/f:0,d=1;d<t;d++){for(u=0;u<=d;u++)e[u].h>m&&(m=e[u].h),e[u].l<p&&(p=e[u].l);f=m-p,h[d]=0==f?0:100*(e[d].c-p)/f,m=0,p=999999}for(d=t;d<l;d++){for(u=0;u<t;u++)e[d-u].h>m&&(m=e[d-u].h),e[d-u].l<p&&(p=e[d-u].l);f=m-p,h[d]=0==f?0:100*(e[d].c-p)/f,m=0,p=999999}for(n=[],d=0;d<l;d++){for(o=0,u=0;u<a&&!(d-u<0);u++)o+=h[d-u];n[d]=o/u,n[d]>s&&(s=n[d]),n[d]<c&&(c=n[d])}for(null==r&&(r=3),d=0;d<l;d++){for(o=0,u=0;u<r&&!(d-u<0);u++)o+=n[d-u];i[d]={d:e[d].d,v1:n[d],v2:o/u}}return{High:s,Low:c,Values:i}},this.computeTRIX=function(e,t,a){var r,n,o,i,l,s=this.computeMovingAverageE(e,t,a),c=[],d=s.Values.length,u=0,h=999999;for(c[0]={d:s.Values[0].d,v1:0},n=s.Values[0].v1,(o=[])[0]=s.Values[0].v1,i=0,l=2/(t+1),r=1;r<d;r++)n=s.Values[r].v1*l+n*(1-l),o[r]=n*l+o[r-1]*(1-l),i=100*(o[r]-o[r-1])/o[r-1],c[r]={d:s.Values[r].d,v1:i},i>u&&(u=i),i<h&&(h=i);return{High:u,Low:h,Values:c}},this.computeVROC=function(e,t){var a,r,n=[],o=0,i=999999,l=e.length;if(l<=t)return null;for(a=0;a<t;a++)n[a]={d:e[a].d,v1:0};for(r=0,a=t;a<l;a++)0!=e[a].v&&0!=e[a-1].v?((r=100*e[a].v/e[a-1].v)<100&&(r*=-1),n[a]={d:e[a].d,v1:r},r>o&&(o=r),r<i&&(i=r)):n[a]={d:e[a].d,v1:0},r=0;return{High:o,Low:i,Values:n}},this.computeWILAC=function(e){var t=[],a=0,r=999999,n=e.length;t[0]={d:e[0].d,v1:0};for(var o=0,i=99999,l=0,s=1;s<n;s++)o=Math.max(e[s-1].c,e[s].h),i=Math.min(e[s-1].c,e[s].l),e[s].c==e[s-1].c?t[s]={d:e[s].d,v1:l}:e[s].c>e[s-1].c?(l=l+e[s].c-i,t[s]={d:e[s].d,v1:l}):(l=l+e[s].c-o,t[s]={d:e[s].d,v1:l}),l>a&&(a=l),l<r&&(r=l),o=0,i=99999;return{High:a,Low:r,Values:t}},this.computeKeltner=function(e,t,a,r){var n,o,i=this.computeMovingAverageE(e,t,"c"),l=[],s=i.Values.length,c=this.computeATR(e,r,"sma");if(null==c)return null;for(n=0;n<s;n++)o=a*c.Values[n].v1,l[n]={d:i.Values[n].d,v1:i.Values[n].v1+o,v2:i.Values[n].v1-o};return{Values:l}},this.computeDonchian=function(e,t){var a,r,n,o,i,l=e.length;if(l<t)return null;for(i=[],a=0;a<l;a++){for(n=0,o=999999,r=0;r<t&&!(a-r<0);r++)e[a-r].h>n&&(n=e[a-r].h),e[a-r].l<o&&(o=e[a-r].l);i[a]={d:e[a].d,v1:n,v2:o}}return{Values:i}},this.ComputeAroon=function(e,t){var a,r,n=e.length;if(n<t)return null;var o=[],i=0,l=999999,s=0,c=0;for(a=0;a<t;a++){for(r=0;r<=a;r++)e[a-r].h>i&&(i=e[a-r].h,s=r),e[a-r].l<l&&(l=e[a-r].l,c=r);o[a]={d:e[a].d,v1:(t-s)/t*100,v2:(t-c)/t*100},i=0,l=999999}for(a=t;a<n;a++){for(r=0;r<=t;r++)e[a-r].h>i&&(i=e[a-r].h,s=r),e[a-r].l<l&&(l=e[a-r].l,c=r);o[a]={d:e[a].d,v1:(t-s)/t*100,v2:(t-c)/t*100},i=0,l=999999}return{High:110,Low:-5,Values:o}},this.computeWILR=function(e,t){var a=e.length;if(a<t)return null;for(var r,n=9999999,o=0,i=[],l=0;l<t+1;l++)i[l]={d:e[l].d,v1:0};for(l=t+1;l<a;l++){for(r=0;r<t;r++)e[l-r].h>o&&(o=e[l-r].h),e[l-r].l<n&&(n=e[l-r].l);i[l]=o-n==0?{d:e[l].d,v1:0}:{d:e[l].d,v1:-100*(o-e[l].c)/(o-n)},o=0,n=999999}return{High:0,Low:-100,Values:i}},this.computeMarteau=function(e){for(var t,a,r,n=[],o=e.length,i=2;i<o;i++)null!=e[i-2]&&null!=e[i-1]&&null!=e[i]&&e[i-2].l>e[i-1].l&&e[i-1].l>e[i].l&&(t=Math.min(e[i].o,e[i].c),a=Math.max(e[i].o,e[i].c),r=t-e[i].l,(e[i].h-a)/(e[i].h-e[i].l)<.04&&r>=a-t&&n.push({i:i,d:e[i].d,v1:e[i].l,v2:0}));return{Values:n}},this.computePinces=function(e){for(var t=[],a=e.length,r=3;r<a;r++)null!=e[r-3]&&null!=e[r-2]&&null!=e[r-1]&&null!=e[r]&&(e[r-3].h<e[r-2].h&&e[r-2].h<e[r-1].h&&100*Math.abs(1-e[r-1].h/e[r].h)<.05&&t.push({i:r,d:e[r-1].d,v1:0,v2:e[r].h}),e[r-3].l>e[r-2].l&&e[r-2].l>e[r-1].l&&100*Math.abs(1-e[r-1].l/e[r].l)<.05&&t.push({i:r,d:e[r-1].d,v1:e[r].l,v2:0}));return{Values:t}},this.computeMarubozu=function(e){for(var t,a,r=[],n=e.length,o=1;o<n;o++)null!=e[o]&&Math.abs(100*(e[o].c-e[o].o)/e[o].c)>1.2&&(t=Math.abs(100*(e[o].l-e[o].o)/e[o].c),a=Math.abs(100*(e[o].h-e[o].c)/e[o].c),t<.05&&a<.05&&r.push({i:o,d:e[o-1].d,v1:0,v2:e[o].h}),t=Math.abs(100*(e[o].l-e[o].c)/e[o].c),a=Math.abs(100*(e[o].h-e[o].o)/e[o].c),t<.05&&a<.05&&r.push({i:o,d:e[o-1].d,v1:e[o].l,v2:0}));return{Values:r}},this.computeSoldiers=function(e,t){var a,r=[],n=e.length,o=0;if("s"==t){for(a=3;a<n;a++)if(null!=e[a-2]&&null!=e[a-1]&&null!=e[a]&&e[a-2].c<e[a-1].c&&e[a-1].c<e[a].c&&e[a-2].o<e[a-1].o&&e[a-1].o<e[a].o&&e[a-2].h<e[a-1].h&&e[a-1].h<e[a].h){if(e[a-2].c-e[a-2].o<=0||e[a-1].c-e[a-1].o<=0||e[a].c-e[a].o<=0)continue;a-o>2&&(r.push({i:a,d:e[a-1].d,v1:0,v2:e[a].h}),o=a)}}else for(a=3;a<n;a++)if(null!=e[a-2]&&null!=e[a-1]&&null!=e[a]&&e[a-2].c>e[a-1].c&&e[a-1].c>e[a].c&&e[a-2].o>e[a-1].o&&e[a-1].o>e[a].o&&e[a-2].l>e[a-1].l&&e[a-1].l>e[a].l){if(e[a-2].c-e[a-2].o>=0||e[a-1].c-e[a-1].o>=0||e[a].c-e[a].o>=0)continue;a-o>2&&(r.push({i:a,d:e[a-1].d,v1:e[a].l,v2:0}),o=a)}return{Values:r}},this.computePendu=function(e){for(var t,a,r,n=[],o=e.length,i=2;i<o;i++)null!=e[i-2]&&null!=e[i-1]&&null!=e[i]&&e[i-2].h<e[i-1].h&&e[i-1].h<e[i].h&&(t=Math.min(e[i].o,e[i].c),a=Math.max(e[i].o,e[i].c),r=t-e[i].l,(e[i].h-a)/(e[i].h-e[i].l)<.04&&r>=a-t&&n.push({i:i,d:e[i-1].d,v1:0,v2:e[i].h}));return{Values:n}},this.computeDragonFly=function(e){for(var t,a,r,n=[],o=e.length,i=3;i<o;i++)null!=e[i]&&(t=Math.abs(100*(e[i].o-e[i].c)/e[i].c),a=Math.abs(100*(e[i].o-e[i].h)/e[i].c),r=Math.abs(100*(e[i].l-e[i].c)/e[i].c),t<.05&&a<.05&r>.5&&n.push({i:i,d:e[i].d,v1:e[i].l,v2:0}));return{Values:n}},this.computeShootingStar=function(e){for(var t,a,r,n=[],o=e.length,i=3;i<o;i++)null!=e[i-3]&&null!=e[i-2]&&null!=e[i-1]&&null!=e[i]&&(t=Math.min(e[i].o,e[i].c),a=Math.max(e[i].o,e[i].c),r=e[i].h-a,(t-e[i].l)/(e[i].h-e[i].l)<.04&&r>=a-t&&n.push({i:i,d:e[i].d,v1:e[i].l,v2:0}));return{Values:n}},this.computeHarami=function(e){for(var t=[],a=e.length,r=1;r<a;r++)null!=e[r-1]&&null!=e[r]&&(e[r].l>e[r-1].c&&e[r].h<e[r-1].o&&e[r-1].o>e[r-1].c?t.push({i:r,d:e[r-1].d,v1:e[r].l,v2:0}):e[r].l>e[r-1].o&&e[r].h<e[r-1].c&&e[r-1].o<e[r-1].c&&t.push({i:r,d:e[r-1].d,v1:0,v2:e[r].h}));return{Values:t}},this.computeEnglobante=function(e){for(var t=[],a=e.length,r=1;r<a;r++)null!=e[r-1]&&null!=e[r]&&(e[r].c>e[r-1].o&&e[r].o<e[r-1].c&&e[r-1].o>e[r-1].c?t.push({i:r,d:e[r].d,v1:e[r].l,v2:0}):e[r].c<e[r-1].o&&e[r].o>e[r-1].c&&e[r-1].o<e[r-1].c&&t.push({i:r,d:e[r].d,v1:0,v2:e[r].h}));return{Values:t}},this.computeGAP=function(e){for(var t=[],a=e.length,r=1;r<a;r++)null!=e[r-1]&&null!=e[r]&&(e[r-1].h<e[r].l?t.push({i:r,d:e[r].d,v1:e[r-1].l,v2:0}):e[r-1].l>e[r].h&&t.push({i:r,d:e[r].d,v1:0,v2:e[r-1].h}));return{Values:t}},this.computeDOJI=function(e,t){var a,r=[],n=e.length,o=.05;for(t<0&&(o=.002),a=0;a<n;a++)null!=e[a]&&Math.abs(100*(e[a].o-e[a].c)/e[a].o)<o&&e[a].h>e[a].c&&e[a].l<e[a].c&&r.push({i:a,d:e[a].d,v1:e[a].l,v2:0});return{Values:r}},this.computeKEYR=function(e){for(var t=[],a=e.length,r=2;r<a;r++)if(null!=e[r-2]&&null!=e[r-1]&&null!=e[r]){if(e[r-2].h<e[r-1].h&&e[r-1].h<e[r].h){e[r].o>e[r-1].c&&e[r].c<e[r-1].l&&t.push({i:r,d:e[r].d,v1:0,v2:e[r-1].h});continue}e[r-2].l>e[r-1].l&&e[r-1].l>e[r].l&&e[r].o<e[r-1].c&&e[r].c>e[r-1].h&&t.push({i:r,d:e[r].d,v1:e[r-1].l,v2:0})}return{Values:t}},this.computePERFORMANCE=function(e,t){var a={QuoteTab:e.QuoteTab},r=[],n=0,o=9999999;r[0]=t?{d:a.QuoteTab[0].d,v1:0}:{d:a.QuoteTab[0].d,c:0};for(var i,l=0,s=a.QuoteTab.length,c=a.QuoteTab[0].c,d=1;d<s;d++)null!=(i=a.QuoteTab[d])&&(l=100*(i.c-c)/c,r[d]=t?{d:i.d,v1:l}:{d:i.d,c:l},l>n&&(n=l),l<o&&(o=l));return t?{High:n,Low:o,Values:r}:{Name:e.Name,High:n,Low:o,QuoteTab:r}},this.computeSAR=function(e,t,a){var r,n=[],o=[],i=[],l=[],s=[],c=e.length,d=0,u=0;for(i[0]=e[0].c>e[0].l,o[0]=e[0].c,l[0]=t,s[0]=e[0].c,s[1]=i[0]?e[1].l:e[0].h,l[1]=t,o[1]=l[1]*(s[1]-s[0])+s[0],i[1]=i[0]?o[1]>e[0].h:o[1]>e[0].c,r=2;r<c;r++)s[r]=i[r-1]==i[r-2]?i[r-1]?e[r].l<s[r-1]?e[r].l:s[r-1]:e[r].h>s[r-1]?e[r].h:s[r-1]:i[r-1]?e[r].l:e[r].h,l[r]=i[r-1]==i[r-2]?s[r-1]==s[r]?l[r-1]:l[r-1]<a?l[r-1]+t:a:t,o[r]=i[r-1]==i[r-2]?l[r]*(s[r]-o[r-1])+o[r-1]:l[r]*(s[r]-s[r-1])+s[r-1],i[r]=i[r-1]?o[r]>e[r].h:o[r]>e[r].l,i[r]?(d=0,u=i[r]==i[r-1]?o[r]:s[r]):(u=0,d=i[r]==i[r-1]?o[r]:s[r]),n[r]={d:e[r].d,v1:u,v2:d};return{Values:n}},this.computeMoonPhase=function(t){for(var a,r,n=[],o=t.length,i=0;i<o;i++)a=new Date(864e5*t[i].d),(r=e(new Date(a.getFullYear(),a.getMonth(),a.getDate())))>.5&&(r=1-r),n[i]={d:t[i].d,v1:2*r};return a=new Date(864e5*t[o-1].d),new Date(a.getFullYear(),a.getMonth()+1,a.getDate()),{High:1,Low:0,Values:n}},Date.prototype.getJulian=function(){return this/864e5-this.getTimezoneOffset()/1440+2440587.5}},(o=function(e){if(this.wrapperEl="#color1",this.value="#ffffff",this.onChange=function(){},this.colors=["ffaaaa","ff5656","ff0000","bf0000","7f0000","ffffff","ffd4aa","ffaa56","ff7f00","bf5f00","7f3f00","e5e5e5","ffffaa","ffff56","ffff00","bfbf00","7f7f00","cccccc","aaffaa","56ff56","00ff00","00bf00","008000","999999","aaffff","56ffff","00ffff","00bfbf","007f7f","666666","aad4ff","56aaff","007fff","005fbf","003f7f","4c4c4c","aaaaff","5656ff","0000ff","0000bf","00007f","333333","d4aaff","aa56ff","7f00ff","5f00bf","3f007f","191919","ffaaff","ff56ff","ff00ff","bf00bf","7f007f","000000"],e)for(var t in e)this[t]=e[t];this.init()}).prototype={init:function(){function e(){var t=document.querySelector(".palette");null!=t&&(t.parentNode.removeChild(t),document.removeEventListener("mousedown",e))}var t=this;this.input=document.querySelector(this.wrapperEl),this.input.style.display="none",this.wrapper=document.createElement("div"),this.wrapper.setAttribute("class","colorPicker-picker"),this.wrapper.style.backgroundColor=t.value,this.input.parentNode.insertBefore(this.wrapper,this.input.nextSibling),this.wrapper.addEventListener("mousedown",(function(a){var r,n,o,i,l;if(a.stopPropagation(),null!=(r=document.querySelector(".palette")))return"palettein"==a.target.className&&(n=window.getComputedStyle(a.target).backgroundColor,t.wrapper.style.backgroundColor=n,t.input.setAttribute("value",n),t.onChange(c(n))),r.parentNode.removeChild(r),void document.removeEventListener("mousedown",e);for((r=document.createElement("div")).setAttribute("class","palette"),i=t.colors.length,l="",o=0;o<i;o++)l=l+'<div class="palettein" style="background-color:#'+t.colors[o]+'" ></div>';r.innerHTML=l,t.wrapper.appendChild(r),document.addEventListener("mousedown",e)}))},change:function(e){this.wrapper.style.backgroundColor=e,this.input.setAttribute("value",e)}},window.ColorPicker=o,function(){var e=function(e){if(this.wrapperEl="#slidercontainer",this.value=0,this.onSlide=function(){},this.isMove=!1,e)for(var t in e)this[t]=e[t];this.init()};e.prototype={init:function(){function e(e){e.preventDefault(),u.isMove=!0,["touchmove","mousemove"].forEach((function(e){document.addEventListener(e,t)})),["touchend","mouseup"].forEach((function(e){document.addEventListener(e,a)}))}function t(e){var t,a,r;if(e.preventDefault(),u.isMove){var i=l(u.wrapper),c=s(e),d=parseInt(c.x-i.left)-20;d<0&&(d=0),d>u.width-20&&(d=u.width-20),o.style.left=d+"px",n.style.width=d+5+"px",(t=d/(u.width-20))<0&&(t=0),a=u.max-u.min,r=u.min+a*t,r=1==u.increment?Math.round(r):Math.round(r/u.increment)*u.increment,u.onSlide(r)}}function a(e){e.preventDefault(),["touchmove","mousemove"].forEach((function(e){document.removeEventListener(e,t)})),["touchend","mouseup"].forEach((function(e){document.removeEventListener(e,a)})),u.isMove=!1}var r,n,o,i,c,d,u=this;this.wrapper=document.querySelector(this.wrapperEl),(r=document.createElement("div")).setAttribute("class","sliderbar"),(n=document.createElement("div")).setAttribute("class","sliderin"),this.divIn=n,r.appendChild(n),(o=document.createElement("div")).setAttribute("class","sliderpointer"),this.divCursor=o,this.wrapper.appendChild(r),this.wrapper.appendChild(o),i=window.getComputedStyle(this.wrapper.parentNode).width,this.width=i.replace("px",""),this.min=parseFloat(this.wrapper.getAttribute("min")),this.max=parseFloat(this.wrapper.getAttribute("max")),this.increment=parseFloat(this.wrapper.getAttribute("step")),(c=this.wrapper.getAttribute("value"))&&(this.value=parseFloat(c)),(d=(u.value-this.min)/(this.max-this.min)*(this.width-20))<0&&(d=0),this.divCursor.style.left=d+"px",this.divIn.style.width=d+5+"px",["touchstart","mousedown"].forEach((function(t){u.divCursor.addEventListener(t,e)}))},set:function(e){var t=this,a=(e-t.min)/(t.max-t.min)*(t.width-20);a<0&&(a=0),t.divCursor.style.left=a+"px",t.divIn.style.width=a+5+"px"}},window.Slider=e}(),a(3972),a(6658),a(2758),a(4431),a(1642),a(4942),a(9826),function(e,t,a){var r="currenciesParity";function n(t,a){this.$element=e(t),this.options=e.extend({},e.fn[r].defaults,this.$element.data(),a),this._name=r,this.method="GET",this.init()}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={refreshableLoader:!1},n.prototype.instance=function(){return this},n.prototype.init=function(){var t=this;t.$selectedCurrency="EUR",t.$selectedLetter="",t.$element.find("[data-currency-change]").change((function(){var a=e(this).val().split("#");t.$selectedCurrency=a[0],t.$selectedLetter=t.$element.find("[data-brs-custom-select-letter].is-selected").data("brsCustomSelectLetter"),t.refresh()})),t.$element.find("[data-brs-custom-select-letter]").click((function(){t.$selectedLetter=e(this).data("brsCustomSelectLetter"),t.$selectedCurrency=t.$element.find("[data-currency-change]").val().split("#")[0],t.refresh()}))},n.prototype.refresh=function(){var t=this,r=t.$element.find("[data-currency-change]").data("urlCurrenciesParity");r+="/"+t.$selectedCurrency,r+=t.$selectedLetter?"/"+t.$selectedLetter:"",t.$element.find("[data-loader]").brsLoader().data("plugin_brsLoader").showLoader(),t.$element.load(r,(function(r,n,o){"error"==n&&(t.$element.find("[data-parity-table]").empty(),t.$element.find("[data-alert-parity]").find("[data-alert-text]").text("Aucune information disponible pour ces valeurs"),t.$element.find("[data-alert-parity]").data("plugin_brsAlertEffect").showAlertBox()),e(a).trigger("load",t.$element)}))}}(a(9755),window,document),a(6699),a(2023),a(7327),function(e,t,a){var r="updateUnderlying";function n(t,a){this.element=e(t),this.options=e.extend(!0,{},e.fn[r].defaults,this.element.data(),a),this._name=r,this.lastSelected=[],this.options.brsDerivUnderlyingRadio&&(this.element=this.element.find("input[type=radio]")),this.init()}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={underlyingId:void 0,underlyingElem:void 0,ajaxUrl:"",defaultOptions:[],brsDerivUnderlyingRadio:!1},n.prototype.instance=function(){return this},n.prototype.saveDefaultOptions=function(){this.options.defaultOptions=this.options.underlyingElem.contents().clone()},n.prototype.restoreDefaultOptions=function(){var t=this;this.clearSelect(),this.options.defaultOptions.each((function(){t.lastSelected.includes(this.value)?e(this).prop("selected",!0):e(this).prop("selected",!1)})),this.options.underlyingElem.html(this.options.defaultOptions),this.options.brsDerivUnderlyingRadio||this.options.underlyingElem.siblings(".c-select").children(".c-select__listbox-container").children(".c-select__textbox").children("input").val("Tous les sous-jacents")},n.prototype.setOptions=function(t){var a=[];for(var r in this.clearSelect(),t.underlyingName)""===r&&!this.options.brsDerivUnderlyingRadio||this.lastSelected.includes(r)?a.push(e('<option value="'+r+'">'+t.underlyingName[r]+"</option>").prop("selected",!0)):""!==r&&a.push(e('<option value="'+r+'">'+t.underlyingName[r]+"</option>"));var n=this.options.underlyingElem.siblings(".c-select").hasClass("is-expanded");n&&this.options.underlyingElem.selectability("closeCombobox"),this.options.underlyingElem.html(a),this.options.underlyingElem.siblings(".c-select").children(".c-select__listbox-container").children(".c-select__textbox").children("input").val(t.underlyingName[""]),n&&this.options.underlyingElem.selectability("openCombobox")},n.prototype.clearSelect=function(){var t=this.options.underlyingElem.siblings(".c-select").children(".c-select__listbox-container"),a=this;this.lastSelected=[],this.options.underlyingElem.find("option").each((function(){e(this).is(":selected")&&a.lastSelected.push(this.value)})),t.children(".c-select__textbox").children("input").val(""),t.children(".c-select__listbox").empty()},n.prototype.updateUnderlyingElem=function(){this.options.underlyingElem=e("[data-brs-deriv-underlying-target="+this.options.underlyingId+"]")},n.prototype.init=function(){this.element.trigger(r+":"),this.updateUnderlyingElem(),this.saveDefaultOptions(),this.handleTypeChange(!1);var e=this;this.element.on("change",(function(){e.handleTypeChange(!0)}))},n.prototype.handleTypeChange=function(t){var a,r,n,o=this;n=o.options.brsDerivUnderlyingRadio?(a=o.element.filter(":checked"))&&""!==a.val()&&a.is(":checked"):(a=e(o.element).children("option:selected"))&&""!==a.val(),a&&(o.options.underlyingElem.prop("disabled","disabled"),n?(r=o.options.brsDerivUnderlyingRadio?a.siblings("label").text().trim():a.text(),e.ajax({url:o.options.ajaxUrl,method:"GET",data:{underlyingType:r}}).done((function(e){o.setOptions(JSON.parse(e)),o.options.underlyingElem.prop("disabled",!1),t&&o.options.underlyingElem.trigger("change")})).catch((function(e){o.restoreDefaultOptions(),o.options.underlyingElem.prop("disabled",!1),t&&o.options.underlyingElem.trigger("change")}))):(o.restoreDefaultOptions(),o.options.underlyingElem.prop("disabled",!1),t&&o.options.underlyingElem.trigger("change")))}}(a(9755),window,document),function(e,t,a){var r="brsOrderframeBroker";function n(a,n){this.$element=e(a),this.options=e.extend({},e.fn[r].defaults,this.$element.data(),n),this._name=r,e(t).on("brsOrderframeBroker:launch",this.init)}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={},n.prototype.instance=function(){return this},n.prototype.init=function(t,a){var r=null,n=e("[data-brs-order-frame-app-id]"),o=n.parents("[data-off-canvas]").data("plugin_brsOffCanvas");o.open(),void 0===n.data("plugin_brsOrderFrame")&&((r=o.$element.find("[data-off-canvas-content]").brsLoader().data("plugin_brsLoader")).showLoader(),n.on("brsOrderFrame:loaded",(function(e,t){r.hideLoader(),t.getApp().on("exit:app",(function(){o.close()}))})),n.brsOrderFrame()),n.data("plugin_brsOrderFrame").appCommand("goToOrder",a)}}(a(9755),window,document),a(8309),a(2472),a(2990),a(8927),a(3105),a(5035),a(4345),a(7174),a(2846),a(4731),a(7209),a(6319),a(8867),a(7789),a(3739),a(9368),a(4483),a(2056),a(3462),a(678),a(7462),a(1994),a(5021),a(2974),a(5016),function(e,t,a){var r="brsQuoteChart";function n(t,a){this.element=e(t),this.options=e.extend({},e.fn[r].defaults,a),this._name=r,this.init(a)}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={elements:{pointerMenu:"[data-brs-quote-chart-pointer-menu]",periodMenu:"[data-brs-quote-chart-period-menu]",indicatorMenu:"[data-brs-quote-chart-indicator-menu]",styleMenu:"[data-brs-quote-chart-style-menu]",newsMenu:"[data-brs-quote-chart-news-menu]",saveMenu:"[data-brs-quote-chart-save-menu]",drawMenu:"[data-brs-quote-chart-draw-menu]",indicatorBtn:"[data-brs-quote-chart-indicator-btn]",periodBtn:"[data-brs-quote-chart-period-btn]",pointerBtn:"[data-brs-quote-chart-pointer-btn]",saveBtn:"[data-brs-quote-chart-save-btn]",shareBtn:"[data-brs-quote-chart-share-btn]",styleBtn:"[data-brs-quote-chart-style-btn]",newsBtn:"[data-brs-quote-chart-news-btn]",drawBtn:"[data-brs-quote-chart-draw-btn]",drawListBtn:"[data-brs-quote-chart-draw-list-btn]",fullscreenBtn:"[data-brs-quote-chart-fullscreen-btn]",bigFullscreenBtnContainer:"[data-brs-quote-chart-fullscreen-big-btn-container]",fullFeatures:"[data-brs-quote-chart-full-feature]",quickCommands:"[data-brs-quote-chart-quick-commands]",bigFullscreenBtn:"[data-brs-quote-chart-fullscreen-big-btn]",eodContainer:"[data-brs-quote-chart-eod-container]",durations:"[data-brs-quote-chart-durations]",commands:"[data-brs-quote-chart-commands]",compareTrigger:"[data-brs-quote-chart-compare-trigger]",settingsTrigger:"[data-brs-quote-chart-settings-trigger]",saveDrawingTrigger:"[data-brs-quote-chart-save-drawing-trigger]",indexCompareBtn:"[data-brs-quote-chart-index-compare]",symbolCompareBtn:"[data-brs-quote-chart-symbol-compare]",twoSymbolsCompareBtn:"[data-brs-quote-chart-two-symbols-compare]",compareFirstSymbol:"[data-brs-quote-chart-compare-first-symbol]",compareSecondSymbol:"[data-brs-quote-chart-compare-second-symbol]",sectorCompareBtn:"[data-brs-quote-chart-sector-compare]",orderBtn:"[data-brs-quote-chart-order-btn]",compareBtn:"[data-brs-quote-chart-compare-btn]",settingsBtn:"[data-brs-quote-chart-settings-btn]",saveImageAsBtn:"[data-brs-quote-chart-save-image-as-btn]",downloadBtn:"[data-brs-quote-chart-download-btn]",orderBtnGroup:"[data-brs-quote-chart-order-btn-group]",orderSendBtn:"[data-brs-quote-chart-order-send-btn]",orderQuantity:"[data-brs-quote-chart-order-quantity]",orderLevel:"[data-brs-quote-chart-order-level]",orderType:"[data-brs-quote-chart-order-type]",infoArea:"[data-brs-quote-chart-info-area]",showFiveDaysLink:"[data-brs-show-five-days]",hideFiveDaysLink:"[data-brs-hide-five-days]",fiveDaysHistory:"[data-brs-five-days-history]",fiveDaysBlock:"[data-brs-five-days-block]",templateSelect:"[data-brs-quote-chart-template]",templateForm:"[data-brs-quote-chart-template-form]",templateInputName:"[data-brs-quote-chart-template-input-name]",templateSaveBtn:"[data-brs-quote-chart-template-save]",templateSaveSuccess:"[data-brs-quote-chart-template-save-success]",templateSaveFailure:"[data-brs-quote-chart-template-save-failure]",templateDeleteBtn:"[data-brs-quote-chart-template-delete]",templateDeleteSuccess:"[data-brs-quote-chart-template-delete-success]",templateSaveListBtn:"[data-brs-quote-chart-template-list-save]",templateTable:"[data-brs-quote-chart-template-table]",defaultTemplateRadio:"[data-brs-quote-chart-default-template-radio]",noTemplateAlert:"[data-brs-quote-chart-no-template-alert]",drawingSelect:"[data-brs-quote-chart-drawing]",drawingForm:"[data-brs-quote-chart-drawing-form]",drawingInputName:"[data-brs-quote-chart-drawing-input-name]",openDrawingSaveBtn:"[data-brs-quote-chart-open-drawing-save]",drawingSaveBtn:"[data-brs-quote-chart-drawing-save]",drawingSaveSuccess:"[data-brs-quote-chart-drawing-save-success]",drawingSaveWarning:"[data-brs-quote-chart-drawing-save-warning]",drawingSaveFailure:"[data-brs-quote-chart-drawing-save-failure]",drawingDeleteBtn:"[data-brs-quote-chart-drawing-delete]",drawingDeleteSuccess:"[data-brs-quote-chart-drawing-delete-success]",drawingSaveListBtn:"[data-brs-quote-chart-drawing-list-save]",drawingTable:"[data-brs-quote-chart-drawing-table]",drawingExistsAlert:"[data-brs-quote-chart-drawing-exists-alert]"},stickyMarketValue:"[data-sticky-market-value]",stickyMarketValueBreakPoint:1e3,fullscreenBackground:"[data-fullscreen-background]",rchartMobileMaxWidth:767},n.prototype.instance=function(){return this},n.prototype.init=function(r){var n=this;this.VGP=r.VGP,Object.keys(this.options.elements).forEach((function(t){n["$"+t]=e(n.element).find(n.options.elements[t])})),this.$pointerMenuItem=this.$pointerMenu.find("[data-pointer]"),this.$periodMenuItem=this.$periodMenu.find("[data-period]"),this.$styleMenuItem=this.$styleMenu.find("[data-style]"),this.$newsMenuItem=this.$newsMenu.find("[data-news-type]"),this.$mainIndicatorItem=this.$indicatorMenu.find("[data-main-indicator]"),this.$secondaryIndicatorItem=this.$indicatorMenu.find("[data-secondary-indicator]"),this.$detectIndicatorItem=this.$indicatorMenu.find("[data-detect-indicator]"),this.$stickyMarketValue=e(this.options.stickyMarketValue),this.stickyMarketValueBreakPoint=this.options.stickyMarketValueBreakPoint,this.$fullscreenBackground=e(this.options.fullscreenBackground),this.rchartMobileMaxWidth=this.options.rchartMobileMaxWidth,this.isFullscreen=!1,this.resizeChart=r.resizeChart||!0,this.defaultTemplate=r.defaultTemplate,this.candleTemplate=r.candleTemplate,this.lineTemplate=r.lineTemplate,this.barcolorTemplate=r.barcolorTemplate,this.userTemplates=[],this.userTemplatesToDelete=[],this.selectedDefaultTemplate=void 0,this.userDrawings=[],this.userDrawingsToDelete=[],this.currentUserTemplate="",this.currentUserDrawing=void 0,this.showDrawing=r.showDrawing,this.quoteDownloadUrl="",this.isCanvasSupported()&&(this.VGP.graph=new RODGraph({callID:this.$eodContainer.attr("id"),symbol:this.VGP.symbol}),this.VGP.userID="42",r.enableRemoteSave?e.when(e.ajax(n.VGP.urlWS+"template"),e.ajax(n.VGP.urlWS+"drawing")).done((function(e,t){for(var a=e[0],r=0;r<a.length;r++){var o={Layers:a[r].Layers,Parametres:a[r].Parametres,isDefault:parseInt(a[r].isDefault)};n.userTemplates[a[r].configname]=o,a[r].isDefault&&(n.currentUserTemplate=o)}var i=t[0];for(r=0;r<i.length;r++){var l={name:i[r].name,symbol:i[r].symbol,instrumentName:i[r].instrumentName};VGP.drawings[i[r].symbol]=0,n.userDrawings.push(l),i[r].symbol===VGP.symbol&&(n.toggleDrawingExistsAlert(),n.currentUserDrawing={Symbol:VGP.symbol,Traces:i[r].content,Parametres:i[r].parameters,Layers:i[r].layers})}n.loadChart()})).fail((function(){n.loadChart()})):this.loadChart()),e("body").on("touchmove",(function(){n.VGP.dragging=!0})),e("body").on("touchstart",(function(){n.VGP.dragging=!1})),this.resizeChart&&e(t).on("resize",(function(){n.isFullscreen?n.enterFullscreen():n.resize()})),this.$fullscreenBtn.bind(this.VGP.clickHandler,(function(e){e.preventDefault(),n.isFullscreen?n.leaveFullscreen():n.enterFullscreen()})),this.$bigFullscreenBtn.bind(this.VGP.clickHandler,(function(e){n.leaveFullscreen()})),e(".navig_trace li").bind(this.VGP.clickHandler,(function(t){t.preventDefault(),t.stopPropagation();var a=e(this),r=a.data("drawingTool");if(!r)return!1;try{n.selectDrawingTool(r)}catch(t){console.error(t)}if("e"!==r&&"hst"!==r){var o=a.data("icon");n.$drawBtn.removeClass().addClass("spg eod_b3 eodi_oblic tipt "+o+" c-quote-chart__menu-button")}n.closeMenus()})),this.$periodBtn.bind(this.VGP.clickHandler,(function(e){n.openMenu(e,n.$periodMenu)})),this.$styleBtn.bind(this.VGP.clickHandler,(function(e){n.openMenu(e,n.$styleMenu)})),this.$newsBtn.bind(this.VGP.clickHandler,(function(e){n.openMenu(e,n.$newsMenu)})),this.$pointerBtn.bind(this.VGP.clickHandler,(function(e){n.openMenu(e,n.$pointerMenu)})),this.$indicatorBtn.bind(this.VGP.clickHandler,(function(e){n.openMenu(e,n.$indicatorMenu)})),this.$saveBtn.bind(this.VGP.clickHandler,(function(e){n.openMenu(e,n.$saveMenu)})),this.$drawBtn.bind(this.VGP.clickHandler,(function(t){if(n.endEraser(),t.preventDefault(),n.stopFunctions())return!1;n.closeToolsParams();try{n.selectDrawingTool(e(this).attr("name"))}catch(t){console.error(t)}})),this.$pointerMenuItem.bind(this.VGP.clickHandler,(function(t){t.preventDefault(),t.stopPropagation();var a=e(this).data("pointer");if(a){var r=e(this).data("pointerIcon");try{0!=n.VGP.graph.tools_menu(a)&&e(this).parent().parent().removeClass().addClass("spg eod_b2 tipt "+r+" c-quote-chart__menu-button")}catch(t){console.error(t)}n.closeMenus()}})),this.$periodMenuItem.bind(this.VGP.clickHandler,(function(t){t.preventDefault(),t.stopPropagation();var a=e(this).data("period");if(void 0!==a){try{n.VGP.graph.period_menu(a)}catch(t){console.error(t)}n.updateDownloadLink(a),n.closeMenus()}})),this.$styleMenuItem.bind(this.VGP.clickHandler,(function(t){t.preventDefault(),t.stopPropagation();var a=e(this).data("style");if(a){"candle"===a?n.applyTemplate(n.candleTemplate):"line"===a?n.applyTemplate(n.lineTemplate):"barcolor"===a&&n.applyTemplate(n.barcolorTemplate),n.applyStyle(a);var r=e(this).data("styleIcon");n.$styleBtn.filter(".c-quote-chart__menu-button").removeClass().addClass("spg eod_b2 tipt "+r+" c-quote-chart__menu-button"),n.$styleBtn.filter(".c-quote-chart__quick-command").removeClass().addClass("spg eod_b2 tipt "+r+" c-quote-chart__quick-command c-quote-chart__quick-command--style"),n.closeMenus()}})),this.$newsMenuItem.bind(this.VGP.clickHandler,(function(t){t.preventDefault(),t.stopPropagation();var a=e(this).data("newsType");if(a){var r=n.VGP.graph.get_parametres().newsConfig;if(e(this).hasClass("is-selected")){e(this).removeClass("is-selected"),null!=r&&-1!==r.indexOf(a)&&r.splice(r.indexOf(a),1);try{n.VGP.graph.setNews(r)}catch(t){console.error(t)}}else{e(this).addClass("is-selected"),null==r?(r=[]).push(a):-1===r.indexOf(a)&&r.push(a);try{n.VGP.graph.setNews(r)}catch(t){console.error(t)}}n.closeMenus()}})),this.$compareBtn.bind(this.VGP.clickHandler,(function(e){if(n.endEraser(),e.preventDefault(),n.closeMenus(),n.getChartParameters(),n.closeToolsParams(),n.stopFunctions())return!1;n.$compareTrigger.click()})),this.$settingsBtn.bind(this.VGP.clickHandler,(function(e){if(n.endEraser(),e.preventDefault(),n.closeMenus(),n.closeToolsParams(),n.stopFunctions())return!1;n.initSettingsPopin(),n.$settingsTrigger.click()})),this.$drawListBtn.bind(this.VGP.clickHandler,(function(e){n.openMenu(e,n.$drawMenu)})),e(".eodi_zoom").bind(this.VGP.clickHandler,(function(e){e.preventDefault();try{n.VGP.graph.tools_menu("z")}catch(e){console.error(e)}})),e(".eodi_zp").bind(this.VGP.clickHandler,(function(e){e.preventDefault();try{n.VGP.graph.zoom(!0)}catch(e){console.error(e)}})),e(".eodi_zm").bind(this.VGP.clickHandler,(function(e){e.preventDefault();try{n.VGP.graph.zoom(!1)}catch(e){console.error(e)}})),e("[data-brs-quote-chart-duration-length]").on("click",(function(){n.selectDuration(e(this)),n.changeDuration(e(this).data("brs-quote-chart-duration-length"))})),this.$showFiveDaysLink.on("click",(function(){n.$fiveDaysHistory.removeClass("u-hidden"),n.$showFiveDaysLink.addClass("u-hidden"),n.$hideFiveDaysLink.removeClass("u-hidden")})),this.$hideFiveDaysLink.on("click",(function(){n.$fiveDaysHistory.addClass("u-hidden"),n.$showFiveDaysLink.removeClass("u-hidden"),n.$hideFiveDaysLink.addClass("u-hidden")})),this.$templateSaveBtn.on("click",(function(){if(n.$templateInputName.get(0).checkValidity()){var e=n.$templateInputName.val().toUpperCase(),t=Object.keys(n.userTemplates).length;if(!n.userTemplates[e]&&t>=5)return n.$templateSaveFailure.removeClass("u-hidden"),void setTimeout((function(){n.$templateSaveFailure.addClass("u-hidden")}),3e3);n.$templateSaveBtn.prop("disabled",!0);try{VGP.graph.saveTemplate(e)}catch(e){console.error(e)}n.$noTemplateAlert.hide(),setTimeout((function(){n.$templateSaveBtn.prop("disabled",!1)}),1e3),n.$templateSaveSuccess.removeClass("u-hidden"),setTimeout((function(){n.$templateSaveSuccess.addClass("u-hidden"),n.refreshTemplate(e)}),3e3)}})),this.$templateDeleteBtn.on("click",(function(){var t=String(e(this).data("templateName"));t&&n.prepareDeleteTemplate(t)})),this.$templateSaveListBtn.on("click",(function(){n.$templateSaveListBtn.prop("disabled",!0);for(var e=0;e<n.userTemplatesToDelete.length;e++)n.deleteTemplate(n.userTemplatesToDelete[e]);n.userTemplatesToDelete=[],setTimeout((function(){n.$templateSaveListBtn.prop("disabled",!1),n.$templateDeleteSuccess.removeClass("u-hidden"),setTimeout((function(){n.$templateDeleteSuccess.addClass("u-hidden")}),3e3),null!=n.selectedDefaultTemplate&&(n.changeDefaultTemplate(n.selectedDefaultTemplate,(function(){location.reload()})),n.selectedDefaultTemplate=void 0)}),1e3)})),this.$templateSelect.on("click",(function(){n.selectTemplate(e(this).data("templateName"))})),this.$defaultTemplateRadio.on("change",(function(){n.selectedDefaultTemplate=e(this).data("templateName")})),this.$openDrawingSaveBtn.on("click",(function(){var e=n.getChartParameters();e&&!e.isIntraday?n.$saveDrawingTrigger.click():t.DisplayAlert("Les sauvegardes d'analyses techniques ne sont pas possibles en mode intraday (1 et 5 jours)")})),this.$drawingSelect.on("click",(function(){n.selectDrawing(e(this).data("drawingName"))})),this.$drawingSaveBtn.on("click",(function(){if(n.$drawingInputName.get(0).checkValidity()){for(var t=n.$drawingInputName.val().toUpperCase(),a=n.userDrawings.length,r=!1,o=0;o<a;o++)if(n.userDrawings[o].symbol===n.VGP.symbol){r=!0,n.userDrawings[o].name=t;break}if(!r&&a>=10)return n.$drawingSaveWarning.removeClass("u-hidden"),void setTimeout((function(){n.$drawingSaveWarning.addClass("u-hidden")}),3e3);n.$drawingSaveBtn.prop("disabled",!0);try{var i=n.VGP.graph.saveTraceFull()}catch(e){return console.error(e),n.$drawingSaveFailure.removeClass("u-hidden"),setTimeout((function(){n.$drawingSaveFailure.addClass("u-hidden")}),3e3),void setTimeout((function(){n.$drawingSaveBtn.prop("disabled",!1)}),1e3)}i.name=t,n.currentUserDrawing=i,e.ajax({type:"POST",url:n.VGP.urlWS+"drawing/"+escape(n.VGP.symbol),data:JSON.stringify(i),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){n.$drawingSaveSuccess.removeClass("u-hidden"),setTimeout((function(){if(n.closePopin(),n.$drawingSaveSuccess.addClass("u-hidden"),r){var e=n.$drawingTable.find("[data-drawing-symbol='"+n.VGP.symbol+"']").parent().parent().children();e.get(0).textContent=t,e.get(2).textContent=n.formatDate(new Date),n.$drawingSelect.data("drawingName",t),n.$drawingSelect.text(t)}else n.userDrawings.push({symbol:n.VGP.symbol,name:t}),n.refreshDrawing(t,n.VGP.symbol);n.$drawingSaveBtn.prop("disabled",!1)}),3e3),setTimeout((function(){n.toggleDrawingExistsAlert()}),4e3)},error:function(){n.$drawingSaveFailure.removeClass("u-hidden"),setTimeout((function(){n.$drawingSaveFailure.addClass("u-hidden")}),3e3),setTimeout((function(){n.$drawingSaveBtn.prop("disabled",!1)}),1e3)}})}})),this.$drawingDeleteBtn.on("click",(function(){n.prepareDeleteDrawing(e(this).data("drawingSymbol"))})),this.$drawingSaveListBtn.on("click",(function(){n.$drawingSaveListBtn.prop("disabled",!0);for(var e=0;e<n.userDrawingsToDelete.length;e++)n.deleteDrawing(n.userDrawingsToDelete[e]);n.userDrawingsToDelete=[],setTimeout((function(){n.$drawingSaveListBtn.prop("disabled",!1),n.$drawingDeleteSuccess.removeClass("u-hidden"),setTimeout((function(){n.$drawingDeleteSuccess.addClass("u-hidden")}),3e3)}),1e3)})),this.$mainIndicatorItem.bind(this.VGP.clickHandler,(function(a){if(a.stopPropagation(),a.preventDefault(),!n.VGP.dragging){var r=e(this).data("mainIndicator");if(n.$indicatorMenu.hide(),"actu"===r){var o=n.getChartParameters();if(n.resizeFullScreen(),o&&o.isIntraday)return void t.DisplayAlert("Les actualités ne sont pas disponibles en intraday.")}try{n.VGP.graph.indic1_menu(r)}catch(a){console.error(a)}n.resizeFullScreen()}})),this.$secondaryIndicatorItem.bind(this.VGP.clickHandler,(function(t){if(t.stopPropagation(),t.preventDefault(),!n.VGP.dragging){var a=e(this).data("secondaryIndicator");n.$indicatorMenu.hide();try{n.VGP.graph.indics_menu(a)}catch(t){console.error(t)}}})),this.$detectIndicatorItem.bind(this.VGP.clickHandler,(function(t){if(t.stopPropagation(),t.preventDefault(),!n.VGP.dragging){var a=e(this);if(n.$indicatorMenu.hide(),a.hasClass("is-selected")){a.removeClass("is-selected");try{n.VGP.graph.removeSearch()}catch(t){console.error(t)}}else{n.$detectIndicatorItem.removeClass("is-selected"),a.addClass("is-selected");try{n.VGP.graph.addSearch(a.data("detectIndicator"))}catch(t){console.error(t)}}}})),this.$indexCompareBtn.on("click",(function(){var t=e("[data-select-comparable-index]").val();n.compare(t)})),this.$sectorCompareBtn.on("click",(function(){var t=e("[data-select-sector]").val();n.compare(t)})),this.$symbolCompareBtn.on("click",(function(){var t=e("[data-autocomplete]").data("autocompleteValue");n.compare(t)})),this.$twoSymbolsCompareBtn.on("click",(function(){var e=n.$compareFirstSymbol.val(),t=n.$compareSecondSymbol.val();n.VGP.symbol!=e?(n.VGP.symbol=e,n.VGP.graph=new RODGraph({callID:n.$eodContainer.attr("id"),symbol:n.VGP.symbol}),n.defaultTemplate.isCompare=t,n.loadChart()):n.compare(t)})),this.$orderBtn.bind(this.VGP.clickHandler,(function(t){n.endEraser(),t.preventDefault(),n.closeMenus(),n.currentOrderSide="sell",e(this).data("brsQuoteChartBuyBtn")&&(n.currentOrderSide="buy"),e(".eod_order_left").removeClass().addClass("eod_order_left "+n.currentOrderSide+"_order_left"),e(".eod_order_right").removeClass().addClass("eod_order_right "+n.currentOrderSide+"_order_right"),e(".eod_order_middle").removeClass().addClass("eod_order_middle "+n.currentOrderSide+"_order_middle");try{n.VGP.graph.order_level(n.currentOrderSide)}catch(t){console.error(t)}})),this.$orderSendBtn.bind(this.VGP.clickHandler,(function(t){if(t.preventDefault(),n.$orderQuantity.val()){var a=e("#ordertype").attr("order"),r="";"limit"===a?r="LIM":"stop"===a&&(r="STP");var o=n.$orderLevel.val()?parseFloat(n.$orderLevel.val()):void 0;n.element.trigger("order",{order:{symbol:n.VGP.symbol,side:n.currentOrderSide,quantity:parseFloat(n.$orderQuantity.val()),limPx:"LIM"===r?o:void 0,stopPx:"STP"===r?o:void 0,orderType:r}})}})),this.$shareBtn.bind(this.VGP.clickHandler,(function(a){n.endEraser(),a.preventDefault(),n.closeMenus(),n.closeToolsParams();var r=n.screenCapture();if(r){var o=n.VGP.tabCache.symbol;o||(o=n.VGP.symbol),e.ajax({type:"POST",url:n.VGP.urlWS+"SendCapture",data:'{"symbol": "'+o+'", "image": "'+r+'"}',contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){e.url&&(t.location=e.url,t.DisplayAlert("Vous allez être redirigés vers la création de votre analyse technique."))},error:function(e){e&&e.responseJSON&&e.responseJSON.errorMessage?t.DisplayAlert(e.responseJSON.errorMessage):t.DisplayAlert("Service temporairement indisponible.")}})}})),this.$saveImageAsBtn.bind(this.VGP.clickHandler,(function(r){n.endEraser(),r.preventDefault(),n.closeMenus(),n.closeToolsParams();var o=n.screenCapture();if(o){var i="analyse.png";if("function"==typeof t.navigator.msSaveBlob){for(var l=atob(o),s=new Array(l.length),c=0;c<l.length;c++)s[c]=l.charCodeAt(c);var d=new Uint8Array(s),u=new Blob([d]);t.navigator.msSaveBlob(u,i)}else{if(e("html").hasClass("lt-ie10"))return;var h=a.createElement("a"),p="data:image/png;base64,"+o;h.setAttribute("href",p),h.setAttribute("download",i),h.style.display="none",a.body.appendChild(h),h.click(),a.body.removeChild(h)}}})),this.$downloadBtn.bind(this.VGP.clickHandler,(function(e){n.endEraser(),e.preventDefault(),n.closeMenus(),n.closeToolsParams(),n.quoteDownloadUrl&&t.open(n.quoteDownloadUrl)})),e("[data-brs-quote-chart-defaultSet]").bind(VGP.clickHandler,(function(e){return e.preventDefault(),e.stopPropagation(),n.settingsReset(),n.closePopin(),!1})),e("[data-brs-quote-chart-rbaxisyleft]").change((function(){n.settingsSetAxis("left")})),e("[data-brs-quote-chart-rbaxisyright]").change((function(){n.settingsSetAxis("right")})),e("[data-brs-quote-chart-rbaxisylinear]").change((function(){n.settingsSetAxisLog(!1)})),e("[data-brs-quote-chart-rbaxisylog]").change((function(){n.settingsSetAxisLog(!0)})),e("[data-brs-quote-chart-chkSticky]").change((function(){n.settingsSetSticky(!e(this).prop("checked"))})),e("[data-brs-quote-chart-rbgridContinu]").change((function(){n.settingsSetGrid(e(this).prop("checked"))})),e("[data-brs-quote-chart-rbgridPoint]").change((function(){n.settingsSetGrid(!e(this).prop("checked"))})),e("[data-brs-quote-chart-chkGridH]").change((function(){n.settingsSetGridH(e(this).prop("checked"))})),e("[data-brs-quote-chart-chkGridV]").change((function(){n.settingsSetGridV(e(this).prop("checked"))})),e("[data-brs-quote-chart-chkEncadre]").change((function(){n.settingsSetEncadre(e(this).prop("checked"))})),e("[data-brs-quote-chart-chkIndicValues]").change((function(){n.settingsSetIndicsValues(e(this).prop("checked"))})),this.updateDownloadLink(-2)},n.prototype.loadChart=function(){this.currentUserDrawing&&this.showDrawing?(this.loadTemplate(this.currentUserDrawing,!0),this.showDrawing=!1):this.currentUserTemplate?this.loadTemplate(this.currentUserTemplate):(this.VGP.graph.loadDefautChart(this.defaultTemplate),this.refreshPeriodState(this.defaultTemplate.histoLength)),this.refreshParametersModal()},n.prototype.selectTemplate=function(e){var t=this.userTemplates[e];if(t&&t.Parametres&&t.Layers){var a=JSON.parse(t.Parametres);a.indicators||(a.indicators=[],t.Parametres=JSON.stringify(a)),this.currentUserTemplate=t,this.loadTemplate(t)}},n.prototype.reloadWith=function(e){var t=this;t.VGP.symbol=e,t.VGP.graph=new RODGraph({callID:t.$eodContainer.attr("id"),symbol:t.VGP.symbol}),t.loadChart()},n.prototype.selectDrawing=function(){if(this.currentUserDrawing)if(this.currentUserDrawing.Parametres&&this.currentUserDrawing.Layers){var t=JSON.parse(this.currentUserDrawing.Parametres),a=e("[data-brs-quote-chart-duration-length="+t.histoLength+"]");a.length>0&&this.selectDuration(a);try{this.VGP.graph.loadTemplate(this.currentUserDrawing),this.VGP.graph.readTraceFull(this.currentUserDrawing)}catch(e){console.error(e)}}else try{this.VGP.graph.readTrace(this.currentUserDrawing)}catch(e){console.error(e)}},n.prototype.loadTemplate=function(t,a){var r=JSON.parse(t.Parametres),n=e("[data-brs-quote-chart-duration-length="+r.histoLength+"]");if(n.length>0)this.selectDuration(n);else{var o=e("[data-brs-quote-chart-duration-length].is-selected").data("brsQuoteChartDurationLength");r.histoLength=o,t.Parametres=JSON.stringify(r),this.refreshPeriodState(o)}try{this.VGP.graph.loadTemplate(t)}catch(e){console.error(e)}if(!0===a)try{this.VGP.graph.readTraceFull(t)}catch(e){console.error(e)}},n.prototype.openMenu=function(e,t){this.endEraser(),e.stopPropagation(),e.preventDefault(),t.is(":visible")?t.hide():(this.closeToolsParams(),this.closeMenus(),t.show())},n.prototype.refreshTemplate=function(t){var r=this;e.ajax({type:"GET",url:this.VGP.urlWS+"template/"+escape(t),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){if(t){var n=!!r.userTemplates[t.configname],o=String(t.configname);if(r.userTemplates[o]={Layers:t.Layers,Parametres:t.Parametres},!n){var i=a.createElement("div");i.setAttribute("class","c-quote-chart__submenu-item"),i.setAttribute("data-brs-quote-chart-template",""),i.setAttribute("data-template-name",o),i.textContent=o,r.$saveMenu.find(".c-quote-chart__menu-title")[0].after(i),i.onclick=function(){r.selectTemplate(o)};var l=a.createElement("tr");l.setAttribute("class","c-table__row");var s=a.createElement("td");s.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-left"),s.textContent=o;var c=r.$defaultTemplateRadio.parent().closest("td").get(0).cloneNode(!0),d=Math.floor(1e6*Math.random());c.childNodes[1].removeAttribute("checked"),c.childNodes[1].setAttribute("data-template-name",o),c.childNodes[1].setAttribute("id",d),c.childNodes[2].setAttribute("for",d),c.childNodes[2].setAttribute("title",o),c.onchange=function(){r.selectedDefaultTemplate=o};var u=a.createElement("td");u.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-right");var h=a.createElement("i");h.setAttribute("class","c-table__icon c-table__icon--right u-cursor-pointer u-color-cerulean c-icon c-icon--cross"),h.setAttribute("data-brs-quote-chart-template-delete",""),h.setAttribute("data-template-name",o),h.onclick=function(){r.prepareDeleteTemplate(o)},u.appendChild(h),l.appendChild(s),l.appendChild(c),l.appendChild(u);var p=r.$templateTable.find("tr");e(p).get(p.length-1).after(l)}}}})},n.prototype.refreshDrawing=function(t,r){var n=this,o=a.createElement("tr");o.setAttribute("class","c-table__row");var i=a.createElement("td");i.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-left"),i.textContent=t;var l=a.createElement("td");l.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-left"),l.textContent=e(".c-faceplate__company-link").text();var s=a.createElement("td");s.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-left"),s.textContent=n.formatDate(new Date);var c=a.createElement("td");c.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-right");var d=a.createElement("i");d.setAttribute("class","c-table__icon c-table__icon--right u-cursor-pointer u-color-cerulean c-icon c-icon--cross"),d.setAttribute("data-brs-quote-chart-drawing-delete",""),d.setAttribute("data-drawing-name",t),d.setAttribute("data-drawing-symbol",r),d.onclick=function(){n.prepareDeleteDrawing(r)},c.appendChild(d),o.appendChild(i),o.appendChild(l),o.appendChild(s),o.appendChild(c);var u=this.$drawingTable.find("tr");e(u).get(u.length-1).after(o);var h=a.createElement("div");h.setAttribute("class","c-quote-chart__submenu-item"),h.setAttribute("data-brs-quote-chart-drawing",""),h.setAttribute("data-drawing-name",t),h.textContent=t,n.$saveMenu.find(".c-quote-chart__menu-title")[1].after(h),h.onclick=function(){n.selectDrawing(t)}},n.prototype.formatDate=function(e){var t=function(e){return e<10?"0"+e:e},a=t(e.getHours()),r=t(e.getMinutes());return"le "+t(e.getDate())+"/"+t(e.getMonth())+"/"+e.getFullYear()+" à "+a+"h"+r},n.prototype.prepareDeleteTemplate=function(e){delete this.userTemplates[e],this.userTemplatesToDelete.push(e),this.$templateTable.find("[data-template-name='"+e.replace("'","\\'")+"']").closest("tr").fadeOut()},n.prototype.deleteTemplate=function(t){var a=this;e.ajax({type:"DELETE",url:this.VGP.urlWS+"template/"+escape(t),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){a.$templateSelect.each((function(){e(this).data("templateName")===t&&e(this).remove()}))}})},n.prototype.changeDefaultTemplate=function(t,a){var r="",n="";t?(r="template/"+escape(t),n="PUT"):(r="template/reset-default/",n="POST"),e.ajax({type:n,url:this.VGP.urlWS+r,contentType:"application/json; charset=utf-8",dataType:"json",success:a})},n.prototype.prepareDeleteDrawing=function(e){this.userDrawingsToDelete.push(e),this.$drawingTable.find("[data-drawing-symbol="+e+"]").closest("tr").fadeOut()},n.prototype.deleteDrawing=function(t){var a=this;e.ajax({type:"DELETE",url:this.VGP.urlWS+"drawing/"+escape(t),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){for(var r=0;r<a.userDrawings.length;r++)if(a.userDrawings[r].symbol===t){a.userDrawings.splice(r,1);break}a.toggleDrawingExistsAlert(),a.$drawingSelect.each((function(){e(this).remove()}))}})},n.prototype.toggleDrawingExistsAlert=function(){for(var e=0;e<this.userDrawings.length;e++)if(this.userDrawings[e].symbol===this.VGP.symbol)return void this.$drawingExistsAlert.removeClass("u-hidden");this.$drawingExistsAlert.addClass("u-hidden")},n.prototype.isCanvasSupported=function(){var e=a.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},n.prototype.stopFunctions=function(e){try{var t=this.VGP.graph.get_chartType()}catch(e){return console.error(e),!1}return!(2==e&&"perf"==t||"perf"!=t&&"renko"!=t&&"line break"!=t&&"kagi"!=t)},n.prototype.closeMenus=function(){this.$pointerMenu.hide(),this.closeToolsParams(),this.$periodMenu.hide(),this.$styleMenu.hide(),this.$newsMenu.hide(),this.$indicatorMenu.hide(),this.$saveMenu.hide(),this.$drawMenu.hide()},n.prototype.selectDuration=function(t){t.hasClass("is-selected")||(e(".c-quote-chart__length.is-selected").removeClass("is-selected"),t.addClass("is-selected"),this.isFullscreen||(5==t.data("brsQuoteChartDurationLength")?(this.$fiveDaysHistory.removeClass("u-hidden"),this.$showFiveDaysLink.addClass("u-hidden"),this.$hideFiveDaysLink.removeClass("u-hidden")):(this.$fiveDaysHistory.addClass("u-hidden"),this.$showFiveDaysLink.removeClass("u-hidden"),this.$hideFiveDaysLink.addClass("u-hidden"))),this.refreshPeriodState(t.data("brsQuoteChartDurationLength")))},n.prototype.endEraser=function(){if(this.$pointerBtn.hasClass("eodi_gomme")){this.$pointerBtn.removeClass().addClass("spg eod_b2 tipt eodi_cross");try{this.VGP.graph.stopGomme()}catch(e){console.error(e)}}},n.prototype.initSettingsPopin=function(){var t=this;e(".colorPicker-palette").remove(),e(".colorPicker-picker").remove(),[{selector:"[data-brs-quote-chart-colorBK]",setColor:function(e){t.settingsSetBackColor(e)}},{selector:"[data-brs-quote-chart-colorTXT]",setColor:function(e){t.settingsSetTextColor(e)}},{selector:"[data-brs-quote-chart-colorGRID]",setColor:function(e){t.settingsSetGridColor(e)}},{selector:"[data-brs-quote-chart-colorRETIC]",setColor:function(e){t.settingsSetReticuleColor(e)}},{selector:"[data-brs-quote-chart-colorCADRE]",setColor:function(e){t.settingsSetCadreColor(e)}},{selector:"[data-brs-quote-chart-colorTRACE]",setColor:function(e){t.settingsChangeTraceColor(e)}}].forEach((function(t){var a=e(t.selector);new ColorPicker({wrapperEl:t.selector,value:a.val(),onChange:function(e){t.setColor(e),a.val(e)}})}))},n.prototype.closePopin=function(){e("[data-modal-back]").click()},n.prototype.getChartRefresh=function(){var a=this;e.ajax({type:"GET",url:this.VGP.urlWS+"UpdateCharts",data:{symbol:this.VGP.tabCache.symbol,period:this.VGP.tabCache.period},contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){if(null==e.d)return t.stopTimers(),!1;if(null!=e.d[0])if(a.VGP.tabCache.period<0)try{a.VGP.graph.updateQuoteIntraRefresh(e.d[0])}catch(e){console.error(e)}else try{a.VGP.graph.updateQuoteEODrefresh(e.d[0])}catch(e){console.error(e)}},error:function(){t.stopTimers()}})},n.prototype.enterFullscreen=function(){this.isFullscreen=!0,this.$fullscreenBackground.addClass("eod_fullscreen_background"),this.$bigFullscreenBtn.removeClass("u-hidden"),this.$fullscreenBtn.removeClass("eodi_fullscreen").addClass("eodi_fullscreenout"),this.$fullscreenBtn.attr("data-original-title","Quitter"),this.$fiveDaysBlock.hide(),this.$fullFeatures.removeClass("u-hidden"),this.$quickCommands.addClass("u-hidden"),this.resizeFullScreen(),e("[data-brs-quote-chart]").addClass("eod_fullscreen_mode");var t=this;e(a).on("click","[data-authentication-required]",(function(){t.leaveFullscreen()})),this.resize()},n.prototype.resizeFullScreen=function(){if(this.isFullscreen){var a=this.$durations.outerHeight()+this.$commands.outerHeight()+this.$infoArea.outerHeight();t.innerWidth>992&&(a+=this.$bigFullscreenBtnContainer.outerHeight()),t.innerWidth<this.stickyMarketValueBreakPoint&&(a+=this.$stickyMarketValue.outerHeight());var r=t.innerHeight-a-60;this.$eodContainer.height(r+"px"),t.innerWidth<this.stickyMarketValueBreakPoint&&e("[data-brs-quote-chart]").css({bottom:this.$stickyMarketValue.outerHeight()}),this.resize()}},n.prototype.leaveFullscreen=function(){this.isFullscreen=!1,this.$fullscreenBackground.removeClass(),this.$bigFullscreenBtn.addClass("u-hidden"),this.$fullscreenBtn.removeClass("eodi_fullscreenout").addClass("eodi_fullscreen"),this.$fullscreenBtn.attr("data-original-title","Graphique dynamique"),t.innerWidth<this.stickyMarketValueBreakPoint&&e("[data-brs-quote-chart]").css({bottom:"auto"}),this.$fiveDaysBlock.show(),this.$eodContainer.height(""),e("[data-brs-quote-chart]").removeClass("eod_fullscreen_mode"),this.$fullFeatures.addClass("u-hidden"),this.$quickCommands.removeClass("u-hidden"),this.resize()},n.prototype.resize=function(){try{this.VGP.graph.set_screenSize()}catch(e){console.error(e)}},n.prototype.closeToolsParams=function(){try{this.VGP.graph.closeToolsParams()}catch(e){console.error(e)}},n.prototype.selectDrawingTool=function(e){try{"hst"===e?(this.VGP.graph.hideShowTrace(),this.VGP.graph.tools_menu("r")):this.VGP.graph.trace_menu(e)}catch(e){console.error(e)}},n.prototype.applyStyle=function(e){try{this.VGP.graph.style_menu(e)}catch(e){console.error(e)}},n.prototype.applyTemplate=function(e){this.VGP.graph.style_menu_template(e)},n.prototype.getChartParameters=function(){try{return this.VGP.graph.get_parametres()}catch(e){console.error(e)}return null},n.prototype.screenCapture=function(){try{return this.VGP.graph.screenCapture("brs")}catch(e){console.error(e)}return null},n.prototype.updateDownloadLink=function(t){var a=e(".c-quote-chart__length.is-selected").data("brs-quote-chart-duration-length"),r=-1;t?r=t:this.VGP.CCparam.chartPeriod?r=this.VGP.CCparam.chartPeriod:this.VGP.CCparam.histoLength&&this.VGP.CCparam.histoLength>5&&(r=0),this.quoteDownloadUrl=this.VGP.urlWS+"download?length="+a+"&period="+r+"&symbol="+this.VGP.symbol},n.prototype.changeDuration=function(a){this.VGP.graph.duree_menu(a),this.updateDownloadLink(!1),e(".c-quote-chart__error").hide(),e(".eod_chart").show(),t.launchTimers()},n.prototype.compare=function(e){try{this.VGP.graph.compare(e)}catch(e){console.error(e)}this.closePopin()},n.prototype.settingsReset=function(){try{this.VGP.graph.settings_setdefaut()}catch(e){console.error(e)}this.refreshParametersModal()},n.prototype.refreshParametersModal=function(){this.VGP.CCparam=this.getChartParameters(),e("[data-brs-quote-chart-colorBK]").val(this.VGP.CCparam.set.bkcolor).change(),e("[data-brs-quote-chart-colorTXT]").val(this.VGP.CCparam.set.txtColor).change(),e("[data-brs-quote-chart-colorGRID]").val(this.VGP.CCparam.set.gridColor).change(),e("[data-brs-quote-chart-colorRETIC]").val(this.VGP.CCparam.set.reticColor).change(),e("[data-brs-quote-chart-colorCADRE]").val(this.VGP.CCparam.set.cadreColor).change(),e("[data-brs-quote-chart-colorTRACE]").val(this.settingsGetTraceColor()).change(),e("[data-brs-quote-chart-chkGridH]").prop("checked",this.VGP.CCparam.set.gridH),e("[data-brs-quote-chart-chkGridV]").prop("checked",this.VGP.CCparam.set.gridV),e("[data-brs-quote-chart-chkEncadre]").prop("checked",this.VGP.CCparam.set.isEncadre),e("[data-brs-quote-chart-chkIndicValues]").prop("checked",this.VGP.CCparam.set.indicValues),e("[data-brs-quote-chart-rbgridContinu]").prop("checked",this.VGP.CCparam.set.gridLine),e("[data-brs-quote-chart-rbgridPoint]").prop("checked",!this.VGP.CCparam.set.gridLine),e("[data-brs-quote-chart-rbaxisyright]").prop("checked",!this.VGP.CCparam.set.yaxis),e("[data-brs-quote-chart-rbaxisyleft]").prop("checked",this.VGP.CCparam.set.yaxis),e("[data-brs-quote-chart-rbaxisylinear]").prop("checked",!this.VGP.CCparam.set.semilog),e("[data-brs-quote-chart-rbaxisylog]").prop("checked",this.VGP.CCparam.set.semilog),e("[data-brs-quote-chart-chkSticky]").prop("checked",!this.VGP.CCparam.set.nosticky)},n.prototype.refreshPeriodState=function(t){t>5?this.$periodMenuItem.each((function(){e(this).data("period")<0?e(this).addClass("is-disabled"):e(this).removeClass("is-disabled")})):this.$periodMenuItem.each((function(){e(this).data("period")<0?e(this).removeClass("is-disabled"):e(this).addClass("is-disabled")}))},n.prototype.settingsSetAxis=function(e){try{this.VGP.graph.settings_setAxis(e)}catch(e){console.error(e)}},n.prototype.settingsSetAxisLog=function(e){try{this.VGP.graph.settings_setAxisLog(e)}catch(e){console.error(e)}},n.prototype.settingsSetSticky=function(e){try{this.VGP.graph.settings_setSticky(e)}catch(e){console.error(e)}},n.prototype.settingsSetGrid=function(e){try{this.VGP.graph.settings_setGridlineShow(e)}catch(e){console.error(e)}},n.prototype.settingsSetBackColor=function(e){try{this.VGP.graph.settings_setBackColor(e)}catch(e){console.error(e)}},n.prototype.settingsSetGridColor=function(e){try{this.VGP.graph.settings_setGridColor(e)}catch(e){console.error(e)}},n.prototype.settingsSetCadreColor=function(e){try{this.VGP.graph.settings_setCadreColor(e)}catch(e){console.error(e)}},n.prototype.settingsSetTextColor=function(e){try{this.VGP.graph.settings_setTextColor(e)}catch(e){console.error(e)}},n.prototype.settingsSetReticuleColor=function(e){try{this.VGP.graph.settings_setReticuleColor(e)}catch(e){console.error(e)}},n.prototype.settingsChangeTraceColor=function(e){try{this.VGP.graph.settings_setTraceColor(e)}catch(e){console.error(e)}},n.prototype.settingsGetTraceColor=function(){try{return this.VGP.graph.settings_getTraceColor()}catch(e){console.error(e)}return""},n.prototype.settingsSetGridH=function(e){try{this.VGP.graph.settings_setGridlineH(e)}catch(e){console.error(e)}},n.prototype.settingsSetGridV=function(e){try{this.VGP.graph.settings_setGridlineV(e)}catch(e){console.error(e)}},n.prototype.settingsSetIndicsValues=function(e){try{this.VGP.graph.settings_setIndicValues(e)}catch(e){console.error(e)}},n.prototype.settingsSetEncadre=function(e){try{this.VGP.graph.settings_setEncadreShow(e)}catch(e){console.error(e)}}}(a(9755),window,document),function(e,t,a){var r="brsTabsChart";function n(t,a){this.element=e(t),this.tabs=this.element.find("[data-tabs]"),this.options=e.extend({},e.fn[r].defaults,a),this._name=r,this.init()}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={},n.prototype.instance=function(){return this},n.prototype.init=function(){this.tabs.find("[data-tabs-link]").on("click",function(a){a.preventDefault(),e(e(a.currentTarget).attr("href")).css("min-height","20rem"),e(a.currentTarget).addClass("is-active"),e(e(a.currentTarget).attr("href")).addClass("is-active");var r=e(e(a.currentTarget)).attr("href"),n=e(r).find("div[id^=eod_container]")[0],o={symbol:e(n).data("brsQuoteChartSymbol"),$graph:[],urlWS:"/bourse/action/graph/ws/",saveTrace:!1,drawings:[],noCommand:!0,callType:"GET",chartSimple:!1};t.VGP=o;var i={resizeChart:!1,VGP:o,defaultTemplate:{histoLength:365,paddingTop:0,paddingLeft:0,paddingBottom:20,paddingRight:45,mainChart:{type:"line",typedef:{color2:"rgba(53,170,227,1)",color3:"rgba(51,99,160,1)",v1:!0}},indicators:[],set:{nohighlow:!0,veilleColor:"#f94aa6",veilleWidth:2,bkcolor:"rgba(0,0,0,0)",txtColor:"#000000",gridV:!1,gridH:!1,gridLine:!0,gridColor:"#263c53",cadreColor:"transparent",nosticky:!0}}};e(n).brsQuoteChart(i)}.bind(this))}}(a(9755),window,document),function(e,t,a){var r="brsHomeTabsChart";function n(t,a){this.element=e(t),this.tabFocus=0,this.$items=this.element.find("[data-brs-home-chart-tabs]"),this.options=e.extend({},e.fn[r].defaults,a),this._name=r,this.init()}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={},n.prototype.instance=function(){return this},n.prototype.init=function(){this.$items.on("click",function(e){this.selectChart(e)}.bind(this)),this.element.on("keydown",function(e){this.setKeyboardFocus(e)}.bind(this))},n.prototype.keys={enter:13,space:32,end:35,home:36,left:37,right:39},n.prototype.selectChart=function(t){var a=e(t.currentTarget),r=e("[data-homepage-chart]"),n=a.data("brsHomeChartTabs"),o=e('[data-homepage-chart="'+n+'"]');r.css("opacity",0),o.css("opacity",1),this.$items.removeClass("is-active"),this.$items.attr("aria-selected","false"),this.$items.attr("tabindex","-1"),a.addClass("is-active"),a.attr("aria-selected","true"),a.attr("tabindex","0")},n.prototype.setKeyboardFocus=function(t){if(t.keyCode===this.keys.right||t.keyCode===this.keys.left||t.keyCode===this.keys.home||t.keyCode===this.keys.end){switch(t.preventDefault(),e(this.$items[this.tabFocus]).removeClass("is-active"),e(this.$items[this.tabFocus]).attr("tabindex",-1),t.keyCode){case this.keys.right:this.tabFocus++,this.tabFocus>=this.$items.length&&(this.tabFocus=0);break;case this.keys.left:this.tabFocus--,this.tabFocus<0&&(this.tabFocus=this.$items.length-1);break;case this.keys.home:this.tabFocus=0;break;case this.keys.end:this.tabFocus=this.$items.length-1}e(this.$items[this.tabFocus]).attr("tabindex",0),e(this.$items[this.tabFocus]).addClass("is-active"),e(this.$items[this.tabFocus]).focus()}else t.keyCode!==this.keys.space&&t.keyCode!==this.keys.enter||(t.preventDefault(),this.$items.attr("aria-selected","false"),e(this.$items[this.tabFocus]).attr("aria-selected","true"),this.$items[this.tabFocus].click())}}(a(9755),window,document),a(4796),a(9600),function(e,t,a){var r="brsNewsletterSubscription";function n(t,a){this.element=e(t),this.actionUrl=this.element.attr("action"),this.$alert=e("[data-alert-newsletter]"),this.$icon=this.$alert.find("i"),this.successMessage="Votre demande a bien été prise en compte.",this.fromType=this.toType="",this.options=e.extend({},e.fn[r].defaults,e(t).data(),a),this._name=r,this.init()}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={},n.prototype.instance=function(){return this},n.prototype.init=function(){var t=this;e.fn.replaceClass=function(e,t){return this.removeClass(e).addClass(t)},this.element.on("submit",(function(a){a.preventDefault();var r=e(this);e.ajax({method:"POST",url:t.actionUrl,data:r.serialize()}).done((function(e){e.response.error?(t.fromType="success",t.toType="warning",t.$alert.find("[data-alert-text]").html(e.response.error.join("<br />"))):(t.fromType="warning",t.toType="success",t.$alert.find("[data-alert-text]").text(t.successMessage))})).fail((function(){t.fromType="success",t.toType="warning",t.$alert.find("[data-alert-text]").text("Une erreur est survenue")})).always((function(){r.addClass("o-vertical-interval-bottom"),t.$icon.replaceClass("c-icon--alert-"+t.fromType,"c-icon--alert-"+t.toType),t.$alert.replaceClass("c-alert--"+t.fromType,"c-alert--"+t.toType),t.$alert.data("plugin_brsAlertEffect").showAlertBox()}))}))}}(a(9755),window,document),a(2222),a(1249),function(e,t){function a(t,a){this.$element=e(t),this.options=e.extend({},e.fn.brsMyList.defaults,this.$element.data(),a),this._name="brsMyList",this.listDropDownListElement=e(this.$element.find(this.options.listDropDownListSelector)),this.listBodyElement=e(this.$element.find(this.options.listBodySelector)),this.listTableElement=e(this.$element.find(this.options.listTableSelector)),this.listErrorElement=e(this.$element.find(this.options.listErrorSelector)),this.listDropDownListElement&&this.listBodyElement&&this.listTableElement&&this.listErrorElement&&(this.listErrorDefaultHtml=this.listErrorElement.html(),this.init())}e.fn.brsMyList=function(t){var r=arguments;return this.each((function(){e.data(this,"plugin_brsMyList")?"string"===e.type(t)&&e.data(this,"plugin_brsMyList")[t].apply(e.data(this,"plugin_brsMyList"),Array.prototype.slice.call(r,1)):e.data(this,"plugin_brsMyList",new a(this,t))}))},e.fn.brsMyList.defaults={lastSymbolsToAdd:[],historySize:10,localStorageKey:"web_fr_portal_20.last_viwed_symbols",lastViewedSymbolsListId:"lastViewed",listRoute:"/listes/listes",listDropDownListSelector:"select",listBodySelector:".c-block__body",listTableSelector:".c-my-list__table",listErrorSelector:".c-my-list__error"},a.prototype.instance=function(){return this},a.prototype.init=function(){this.symbols=this.getFullHistory(),t.BRS_USER_CONFIG&&t.BRS_USER_CONFIG.USER_HASH&&(this.options.listRoute+="/"+t.BRS_USER_CONFIG.USER_HASH),this.options.lastSymbolsToAdd.length>0&&(this.symbols=this.symbols.concat(this.options.lastSymbolsToAdd),this.symbols.length>this.options.historySize&&(this.symbols=this.symbols.slice(-this.options.historySize)),this.saveFullHistory(this.symbols)),this.listDropDownListElement&&this.listDropDownListElement.val()===this.options.lastViewedSymbolsListId&&this.symbols.length>0&&this.loadList(this.options.lastViewedSymbolsListId,!0);var e=this;this.listDropDownListElement.change((function(){e.loadList(e.listDropDownListElement.val())}))},a.prototype.loadList=function(t,a){var r=this.options.listRoute+"?listId="+t;"lastViewed"===t&&this.symbols.length>0&&(r+="&"+this.symbols.map((function(e){return"symbols[]="+encodeURIComponent(e)})).join("&"),a&&(r+="&pageLoading=1")),this.listBodyElement.addClass("is-loading");var n=this;e.ajax({url:r}).done((function(t){var a=e(e.parseHTML(t));n.listTableElement.html(a.find(n.options.listTableSelector).html()),n.listErrorElement.html(a.find(n.options.listErrorSelector).html()),e(document).trigger("load",n.$element);var r=!a.find(n.options.listTableSelector)||!a.find(n.options.listErrorSelector).hasClass("u-hidden");n.listTableElement[r?"addClass":"removeClass"]("u-hidden"),n.listErrorElement[r?"removeClass":"addClass"]("u-hidden")})).fail((function(){n.listErrorElement.html(n.listErrorDefaultHtml),n.listErrorElement.removeClass("u-hidden"),n.listTableElement.addClass("u-hidden")})).always((function(){n.listBodyElement.removeClass("is-loading"),e("body").trigger("brsListLoaded")}))},a.prototype.saveFullHistory=function(e){t.localStorage&&t.localStorage.setItem(this.options.localStorageKey,JSON.stringify(e))},a.prototype.getFullHistory=function(){if(t.localStorage){try{var e=JSON.parse(t.localStorage.getItem(this.options.localStorageKey))}catch(e){return[]}return(e=Array.isArray(e)?e:[]).filter((function(e){return"string"==typeof e&&e.length>0}))}return[]}}(a(9755),window,document),function(e,t,a){var r="brsSelectChipsAutocomplete";function n(t,a){this.$element=e(t),this.options=e.extend({},e.fn[r].defaults,this.$element.data(),a),this.init()}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={brsChipsAutocompletePlaceholder:""},n.prototype.init=function(){this.$element.select2({formatSelection:function(e){return e.id?'<span class="c-filter is-selected">'+e.text+"</span>":e.text},containerCssClass:"c-select-chips-autocomplete",dropdownCssClass:"c-select-chips-autocomplete-dropdown",placeholder:this.options.brsChipsAutocompletePlaceholder,minimumInputLength:1,formatInputTooShort:"Saisissez un premier caractère pour commencer la recherche"})}}(a(9755),window,document);var y=a(9755);window.lang={l_cross:"RETICULE",l_pointer:"POINTEUR",l_eraser:"GOMME",l_1d:"1 JOUR",l_2d:"2 JOURS",l_5d:"5 JOURS",l_10d:"10 JOURS",l_15d:"15 JOURS",l_3m:"3 MOIS",l_6m:"6 MOIS",l_1y:"1 AN",l_2y:"2 ANS",l_5y:"5 ANS",l_10y:"10 ANS",l_15y:"15 ANS",l_20y:"20 ANS",l_25y:"25 ANS",l_1min:"1 MINUTE",l_2min:"2 MINUTES",l_5min:"5 MINUTES",l_10min:"10 MINUTES",l_15min:"15 MINUTES",l_30min:"30 MINUTES",l_1h:"1 HEURE",l_2h:"2 HEURES",l_4h:"4 HEURES",l_day:"JOUR",l_week:"HEBDO",l_month:"MENSUEL",l_area:"AIRE",l_bcc:"BAR CHART COLORÉS",l_candle:"BOUGIES",l_line:"LIGNE",l_season:"SAISONNALITÉ",l_mainind:"INDICATEURS PRINCIPAUX",l_boll:"BANDES DE BOLLINGER",l_keltner:"BANDES DE KELTNER",l_donchian:"CANAL DE DONCHIAN",l_regcurve:"COURBE REGRESSION LINEAIRE",l_regline:"DROITE REGRESSION LINEAIRE",l_envmm:"ENVELOPPE MOYENNE MOBILE",l_fievt:"EVENEMENTS FINANCIERS",l_actus:"ACTUALITES",l_mm:"MOYENNE MOBILE",l_mme:"MOYENNE MOBILE EXPO.",l_mmp:"MOYENNE MOBILE PONDEREE",l_mmt:"MOYENNE TRIANGULAIRE",l_sar:"PARABOLIQUE SAR",l_pivots:"POINTS PIVOTS",l_secind:"INDICATEURS SECONDAIRES",l_coppock:"COURBE DE COPPOCK",l_macdh:"MACD HISTOGRAMME",l_linearo:"OSCILL. REGRESSION LINEAIRE",l_moonphase:"PHASES DE LUNE",l_stoch:"STOCHASTIQUE",l_stochm:"STOCHASTIQUE MOMENTUM",l_stochr:"STOCHASTIQUE RSI",t_volume:"VOLUMES",l_fiboa:"ARCS DE FIBONACCI",l_fiboc:"CYCLES DE FIBONACCI",l_fibof:"FANIONS DE FIBONACCI",l_fiboe:"EXTENSIONS FIBONACCI",l_fibor:"RETRACEMENTS FIBONACCI",l_figures:"FIGURES",l_circle:"ELLIPSE - CERCLE",l_arrup:"FLECHE ACHAT",l_arrdw:"FLECHE VENTE",l_arrrt:"FLECHE DROITE",l_arrlt:"FLECHE GAUCHE",l_icones:"ICONES",l_arrow:"FLECHE",l_pitchf:"FOURCHETTE D'ANDREWS",l_ganng:"GRILLE DE GANN",l_ganna:"ANGLES DE GANN",l_horiz:"HORIZONTALE",l_verti:"VERTICALE",l_mesure:"MESURE",l_mesurev:"MESURE VERTICALE",l_mesureh:"MESURE HORIZONTALE",l_oblic:"OBLIQUE",l_para:"PARALLELES",l_eraseall:"TOUT EFFACER",l_detect:"DETECTIONS",l_marteau:"MARTEAUX",l_pendu:"PENDUS",l_pinces:"PINCES",l_maru:"MARUBOZU",l_soldiers:"3 SOLDATS",l_englob:"ENGLOBANTES",l_compare:"COMPARER",l_thclair:"THEME CLAIR",l_thfonce:"THEME FONCE",l_1g:"1 GRAPHIQUE",l_2g:"2 GRAPHIQUES",l_3g:"3 GRAPHIQUES",l_4g:"4 GRAPHIQUES",l_save:"Enregistrer",l_savenew:"Nouveau...",l_gerer:"Gérer",l_modeles:"Vos modèles de graphiques",l_interface:"Vos interfaces",l_modify:"Modifier",l_infos:"INFOS",l_btnlog:"Connectez-vous pour sauver vos personnalisations",l_mode:"Mode",l_duree:"Durée",l_period:"Période",l_style:"Style des cours",l_indics:"Indicateurs",l_tracet:"Outils de tracés",l_patterns:"Recherche de figures techniques",l_comparer:"Comparer avec une autre valeur",l_capture:"Capturer l'écran et partager",l_reglages:"Réglages",l_dispo:"Disposition de l'écran",l_help:"Aide en ligne",l_backt:"Stratégies",l_alert:"Alertes SMS",l_fullscreen:"Plein écran",l_save2:"Mise à jour du modèle en cours",l_savenew2:"Enregistre un nouveau modèle",l_gerer2:"Gérer vos modèles",l_save3:"Mise à jour de l'interface en cours",l_savenew3:"Enregistre une nouvelle interface",l_gerer3:"Gérer vos interfaces",l_searchsym:"Recherche valeur",l_msg1:"Vous pouvez placer 4 indicateurs au maximum sous le graphique",l_msg2:"Vous pouvez placer 6 indicateurs au maximum sous le graphique",l_msg3:"Graphique indisponible",l_msg4:"Graphique indisponible",l_ptpivot:"Points Pivots",l_fievents:"EVENEMENTS",l_mm2:"MM",l_mmt2:"MM Triang.",l_mmp2:"MM Pondérée",l_regcurve2:"LINEAR REG",l_regline2:"DROITE Reg. Lin.",l_mme2:"MM Expo",l_envmm2:"ENVELOPPE MM",l_seasonleg:"Pourcentage et performance des mois haussiers et baissiers des 10 dernières années",l_months:["Janv.","Févr.","Mars","Avril","Mai","Juin","Juill.","Août","Sept.","Oct.","Nov.","Déc."],l_up:"Hausse",l_down:"Baisse",l_moy:"Moy.",l_cours:"COURS",l_b:"B",l_m:"M",l_p:"P",l_s:"S",l_varperiod:"VAR.",l_automatic:"Automatique",l_upperb:"Seuil haut",l_lowerb:"Seuil bas",l_zone:"Zone",l_traitfi:"Trait fin",l_traitep:"Trait épais",l_moymob:"Moyenne mobile",l_datasource:'<div class="clearfix pad5">Source de données <select id="datasource"><option value="c">Clôture</option><option value="o">Ouverture</option><option value="h">Plus haut</option><option value="l">Plus bas</option><option value="m">(Haut + Bas)/2</option><option value="m2">(Haut + Bas + Clôt)/3</option><option value="m3">(Ouv + Haut + Bas + Clôt)/4</option></select></div>',l_suppindic:"Supprimer cet indicateur",l_resultat:"Résultat ",l_chifaff:"Chiffre d'affaires ",l_dividend:"Détachement dividende</b></br>Montant: ",l_split:"Division du nominal</b></br>Division par: ",l_supprimer:"Supprimer",l_dupliquer:"Dupliquer",l_createalert:"Créer une alerte",l_barres:" barres",l_jours:" jours",l_prd:"Période",l_ec:"Ecart-type",l_trace:"Tracé",l_remplis:"Remplissage",l_droitereg:"Droite régression",l_barrep:"Barre (%)",l_hausses:"Hausses",l_baisses:"Baisses",l_moyenne:"Moyenne",l_moymobile:"Moyenne mobile",l_variation:"Variation (%)",l_moymobp:"Moyenne mob. P",l_moymobe:"Moyenne mob. E",l_moymobt:"Moyenne mob. T",l_ecart:"Ecart(%)",l_coeff:"Coefficient",l_ecart2:"Ecart",l_atrperiod:"Période ATR",l_ombres:"Ombres",l_tboite:"Taille boite",l_border:"Encadrés",l_lines:"Lignes",l_histogram:"Histogramme",l_ascend:"Ascendant",l_descend:"Descendant",l_acheteur:"Acheteur",l_vendeur:"Vendeur",l_neutre:"Neutre",l_stok:"Lissage %K",l_stod:"Lissage %D",l_lissage:"Lissage",l_stochastic:"Stochastique",l_accel:"Accélération",l_lineareg:"Regression linéaire",l_nomvaleur:"Nom de valeur",l_comparewith:"Comparer cette valeur",l_indice:"Avec un indice ",l_aucun:"Aucun",l_titresect:"Avec un titre du secteur ",l_autrevaleur:"Avec une autre valeur "},window.VGP={$graph:[],clickHandler:"click",urlWS:"/bourse/action/graph/ws/",drawings:[],tabCache:[],callType:"GET",noCommand:!1},window.launchTimers=function(e,t,a){window.stopTimers(),VGP.CCparam&&VGP.CCparam.histoLength>5||(VGP.tabCache={symbol:a,period:t},VGP.timer1=setInterval((function(){y("[data-brs-quote-chart]").brsQuoteChart("getChartRefresh",{})}),3e4))},window.stopTimers=function(){clearInterval(VGP.timer1)},window.DisplayAlert=function(e,t){if(y("[data-brs-quote-chart-error] .c-alert__text").text(e),3===t||4===t){var a=function(e){var t=y(e);t&&t[0]&&t[0].getContext("2d").clearRect(0,0,t.width(),t.height())};a("#main-eod_container1"),a("#overlay-eod_container1"),a("#trace-eod_container1"),a("#rodgraph-eod_container1"),y(".eod_mainchartinfos").empty(),y(".c-quote-chart__error").show(),y(".eod_chart").hide(),window.stopTimers()}else y(".c-quote-chart__error").fadeIn(500).delay(3e3).fadeOut(500)},window.setVariationColor=function(e,t){var a="#f11c3a",r="#2cc357",n=(100*(t.l-t.o)).toFixed(1);window.VGP.shouldVariationBeInPercent?t.var<0?r=a:o="+":n<0?r=a:o="+",r="#2cc357";var o="";t.var<0?r="#f11c3a":o="+",e.each((function(e,a){y(a).css("color",r),!1===window.VGP.shouldVariationBeInPercent?y(a).children().length?y(a).children().text(o+n+" BP"):y(a).text(o+n+" BP"):y(a).children().length?y(a).children().text(o+t.var+"%"):y(a).text(o+t.var+"%")}))},window.extGetQuotesHover=function(e){if(e){var t="";if(!0===window.VGP.showPercentChartInfo&&(t+="%"),y("[data-brs-quote-chart-info-last]").length){if(y("[data-brs-quote-chart-info-last]").text(e.c+t),y("[data-brs-quote-chart-info-open]").length&&y("[data-brs-quote-chart-info-open]").text(e.o+t),y("[data-brs-quote-chart-info-high]").length&&y("[data-brs-quote-chart-info-high]").text(e.h+t),y("[data-brs-quote-chart-info-low]").length&&y("[data-brs-quote-chart-info-low]").text(e.l+t),y("[data-brs-quote-chart-info-vol]").length){var a=e.v,r=!1;a>1e5&&(a=Math.round(a/1e3),r=!0),"function"==typeof toLocaleString&&(a=a.toLocaleString(),r&&(a+=" K")),y("[data-brs-quote-chart-info-vol]").text(a)}if(y("[data-brs-quote-chart-info-var]").length){var n=y("[data-brs-quote-chart-info-var]");window.setVariationColor(n,e)}}}},window.extIndicatorsList=function(e){var t,a,r,n,o,i=document.getElementById("indicList");if(i){if(i.innerHTML="",e.ind1)for(t=0;t<e.ind1.length;t++)null!=e.ind1[t]&&((a=document.createElement("div")).setAttribute("class","c-quote-chart-info-area__indicator indicItem"),a.id="mainIndic_"+e.ind1[t].id,"compare"!==e.ind1[t].name?a.textContent=e.ind1[t].name.toUpperCase()+e.ind1[t].param:a.textContent=e.ind1[t].param,a.style.color=e.ind1[t].color,(n=document.createElement("span")).setAttribute("class","manageind1"),n.setAttribute("aria-label",e.ind1[t].name+"_"+e.ind1[t].id),a.appendChild(n),(o=document.createElement("span")).setAttribute("class","closeind1"),o.setAttribute("aria-label",e.ind1[t].name+"_"+e.ind1[t].id),a.appendChild(o),(r=document.createElement("span")).setAttribute("class","value1"),a.appendChild(r),i.appendChild(a));if(e.ind2)for(t=0;t<e.ind2.length;t++)null!=e.ind2[t]&&((a=document.createElement("div")).setAttribute("class","c-quote-chart-info-area__indicator indicItem"),a.id="secondIndic_"+e.ind2[t].id,a.textContent=e.ind2[t].name.toUpperCase()+e.ind2[t].param,a.style.color=e.ind2[t].color,(n=document.createElement("span")).setAttribute("class","manageind2"),a.appendChild(n),(o=document.createElement("span")).setAttribute("class","closeind2"),a.appendChild(o),(r=document.createElement("span")).setAttribute("class","value2"),a.appendChild(r),i.appendChild(a))}},y((function(){if(window.quoteChartTemplates){window.VGP.symbol=quoteChartTemplates.symbol,window.VGP.shouldVariationBeInPercent=!!quoteChartTemplates.shouldVariationBeInPercent,window.VGP.showPercentChartInfo=!!quoteChartTemplates.showPercentChartInfo,window.VGP.noAutoSaveTrace=!0,window.VGP.noAutoReadTrace=!0;var e={VGP:VGP,showDrawing:!!quoteChartTemplates.showDrawing,defaultTemplate:quoteChartTemplates.default,enableRemoteSave:quoteChartTemplates.enableRemoteSave,lineTemplate:quoteChartTemplates.line,candleTemplate:quoteChartTemplates.candle,barcolorTemplate:quoteChartTemplates.barcolor};y("[data-brs-quote-chart]").brsQuoteChart(e)}})),a(4386);var b=a(9755);b(document).on("load",(function(e,t){b(t).find("[data-brs-deriv-underlying]").updateUnderlying(),b(t).find("[data-parity]").currenciesParity(),b(t).find("[data-brs-letter]").click((function(){var e=b(t).find(b(this).data("brsLetterInputSelector"));e.val(b(this).data("brsLetter")),e.closest("form").submit()})),b(t).find("[data-brs-tabs-chart]").brsTabsChart(),b(t).find("[data-brs-home-chart-tabpanel]").brsHomeTabsChart(),b(t).find("[data-partners-newsletter-form]").brsNewsletterSubscription(),b(t).find("[data-brs-chips-autocomplete]").brsSelectChipsAutocomplete(),b.fn.brsOrderFrame.defaults=b.extend(!0,{},b.fn.brsOrderFrame.defaults,{config:{apiEnv:window.BRS_CONFIG.API_ENV,apiHost:window.BRS_CONFIG.API_HOST,apiPath:window.BRS_CONFIG.API_PATH,enableProfiler:window.BRS_CONFIG.ENABLE_PROFILER,portalHost:window.location.host,env:window.BRS_CONFIG.DEBUG?"development":"production",customerWebsiteHost:window.BRS_CONFIG.app_customer_website_host,logLvl:window.BRS_CONFIG.DEBUG?"trace":"error",crashReport:window.BRS_CONFIG.CRASH_REPORT_AGENT},orderframeJSPath:window.BRS_CONFIG.orderframeJSPath,orderframeCSSPath:window.BRS_CONFIG.orderframeCSSPath}),b(t).find("[data-brs-order-frame-app-id]").brsOrderframeBroker(),b(t).find("[data-order-frame-trigger]").click((function(){b(window).trigger("brsOrderframeBroker:launch",[{side:b(this).data("orderFrameTriggerOrderWay"),symbol:b(this).data("orderFrameTriggerOrderSymbol")}])})),b(t).find("[data-brs-quote-chart]").on("order",(function(e,t){b(window).trigger("brsOrderframeBroker:launch",[t.order])}))})),b((function(){var e=[];b(document).find("[data-faceplate-symbol]").each((function(t,a){e.push(b(a).data("faceplateSymbol"))})),b(document).find(".c-my-list").brsMyList({lastSymbolsToAdd:e}),b(document).find("[data-tabs-link]").on("tab:click",(function(e){e.preventDefault();var t=b(b(e.currentTarget).attr("href")).find("[data-table-flip]");if(t.length>0){var a=t.data("plugin_tableFlip");void 0!==a&&(a.unshapeTable(),a.init())}}))}))},4796:function(e,t,a){"use strict";a(7042),a(9826),a(1539),function(e,t,a){var r="brsDerivativeForm";function n(t,a){this.$element=e(t),this.$turboRowType=this.$element.find("[data-turbos-form-row-type]"),this.$turboRowMaturity=this.$element.find("[data-turbos-form-row-maturity]"),this.$turboRowMaturitySeparateFilterPlugin=this.$turboRowMaturity.find("[data-separate-filter]").data("plugin_brsSeparateFilter"),this.$leverageShortRowUnderlyingType=this.$element.find("[data-leverage-shorts-form-row-underlying-type]"),this.$leverageShortRowUnderlyingTypeSeparateFiltePlugin=this.$leverageShortRowUnderlyingType.find("[data-separate-filter]").data("plugin_brsSeparateFilter"),this.$leverageShortRowUnderlyingName=this.$element.find("[data-leverage-shorts-form-row-underlying-name]"),this.$leverageShortRowMostUsedUnderlying=this.$element.find("[data-leverage-shorts-form-row-most-used-underlying]"),this.init()}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={},n.prototype.init=function(){var e=this;this.$turboRowType.find("input").change((function(){e.checkTurboTypeConsistency()})),this.$leverageShortRowMostUsedUnderlying.find("input").change((function(){e.checkLeverageShortFieldsConsistency()}))},n.prototype.checkLeverageShortFieldsConsistency=function(){var t=!1;this.$leverageShortRowMostUsedUnderlying.find("input").each((function(){e(this).is(":checked")&&(t=!0)})),t?(this.$leverageShortRowUnderlyingType.addClass("u-hidden"),this.$leverageShortRowUnderlyingName.addClass("u-hidden"),this.$leverageShortRowUnderlyingType.find("input").prop("checked",!1).trigger("change"),this.$leverageShortRowUnderlyingTypeSeparateFiltePlugin.sortFilters(),this.$leverageShortRowUnderlyingTypeSeparateFiltePlugin.showHideSeparator(),this.$leverageShortRowUnderlyingName.find("select").val([]).trigger("change")):(this.$leverageShortRowUnderlyingType.removeClass("u-hidden"),this.$leverageShortRowUnderlyingName.removeClass("u-hidden"))},n.prototype.checkTurboTypeConsistency=function(){var t="all";switch(this.$turboRowType.find("input").each((function(){!e(this).is(":checked")||"2210"!==this.value&&"2205"!==this.value?e(this).is(":checked")&&"2200"===this.value&&(t="finite"):t="infinite"})),t){case"all":this.$turboRowMaturity.removeClass("u-hidden"),this.$turboRowMaturity.find("[data-filter-id=5]").removeClass("u-hidden"),void 0!==this.$turboRowMaturitySeparateFilterPlugin&&(this.$turboRowMaturitySeparateFilterPlugin.sortFilters(),this.$turboRowMaturitySeparateFilterPlugin.showHideSeparator());break;case"infinite":this.$turboRowMaturity.addClass("u-hidden"),this.$turboRowMaturity.find("input").prop("checked",!1),this.$turboRowMaturitySeparateFilterPlugin.sortFilters(),this.$turboRowMaturitySeparateFilterPlugin.showHideSeparator();break;case"finite":this.$turboRowMaturity.find("[data-filter-id=5]").addClass("u-hidden").find("input").prop("checked",!1),this.$turboRowMaturity.removeClass("u-hidden"),this.$turboRowMaturitySeparateFilterPlugin.sortFilters(),this.$turboRowMaturitySeparateFilterPlugin.showHideSeparator()}}}(a(9755),window,document)}},0,[[7019,3666,9755,7098,439,9754,3960,768,8727,8941]]]);