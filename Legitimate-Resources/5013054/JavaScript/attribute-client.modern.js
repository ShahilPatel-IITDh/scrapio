function t(){return t=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},t.apply(this,arguments)}console.log("attribute-client v0.3"),(()=>{const e="aff\nafftrack\naff_model\nreferrer\nclickid\nfbclid\ngclid\nretrack\nfingerprint\nutm_source\nutm_medium\nutm_campaign\nutm_network\nutm_placement\nutm_ad_position\nutm_creative\nutm_match_type\nutm_keyword\nutm_device\nutm_device_model\nutm_adwords_product_target_id\nutm_content\nutm_term".split("\n"),n="https://iqoption.com/lp/attribute,https://iqbroker.co/lp/attribute".split(",");let i=document.currentScript.getAttribute("data-domain")||"/lp/attribute";function o(t){return fetch(t+"/api/check-leadId/1.0",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}).then(t=>t.json())}function a({touchId:t,leadId:e}){return fetch(i+"/api/update-leadId/1.0",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({touch_id:t,lead_id:e})})}var c;(c=function(){let t=new URLSearchParams(location.search),n={};return t.forEach((t,i)=>{e.includes(i)&&(n[i]=t)}),n}(),fetch(i+"/api/create-touch/1.0",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}).then(t=>t.json()).catch(t=>{console.error("Error:",t)})).then(e=>async function(e){window.attribute=t({},window.attribute,{touch_id:e});let i="";for(const t of n){if(t.includes(window.location.hostname))continue;let n=await o(t);if(!n.lead_id)continue;const c=n.lead_id;i!==c&&(await a({touchId:e,leadId:c}),i=c)}}(e.touch_id)).catch(t=>console.error("Error: ",t)),window.affiliateCounter=function({trackerApi:t,brandId:e}){if(!t||!e||!t.includes("int."))return console.error("affiliateCounter invalid config"),void console.log({trackerApi:t,brandId:e});window.location.host.includes("int.")||(t=t.replace("int.",""));const n=new URLSearchParams(window.location.search),i=n.get("aff");let o=n.get("afftrack");const a=n.get("aff_model"),c=n.get("clickid"),r=n.get("gclid");if(!i)return;c?o+="__clickid-"+c:r&&(o+="__CONVTRANSFR__clickid-"+r);const d={aff_id:i,aff_track:o||"",aff_model:a||"",brand_id:e,rand:Math.random()},l=new URLSearchParams(d).toString();fetch(`${t}?${l}`,{method:"GET",mode:"cors",credentials:"include"})}})();
