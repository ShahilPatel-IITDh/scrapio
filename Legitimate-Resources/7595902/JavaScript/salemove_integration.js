!function(){function n(n,t,e){sm.getApi({version:"v1"}).then(function(){sm.logger[n](t,e)})}function t(){return sm._sessionContext&&sm._sessionContext.access_token}function e(){var t=I.match(/__sm[\._]accessToken=([^&#]+)/);if(t)return n("info","Found access token in the page query string"),t[1]}function r(){var t=localStorage.getItem("sm.access_token");if(t)return n("info","Found access token from the local storage"),t}function o(){var n=t()||e()||r();return n?"access_token="+n:""}function i(){var t=I.match(/__sm[\._]consolidation=([^&#]+)/);if(t)return n("info","Found consolidation token in the page query string"),t[1]}function s(){var n=i();return n?"consolidation_token="+n:""}function a(n){return n&&"string"==typeof n}function c(n){return"external_session_id="+n}function u(n){return"id_token="+n}function f(n){return"external_access_token="+n}function l(n){var t=a(n.sessionId)?c(n.sessionId):"",e=a(n.idToken)?u(n.idToken):"",r=a(n.accessToken)?f(n.accessToken):"";return[t,e,r]}function d(t){return new Promise(function(e){t.then(function(n){e(l(n))})["catch"](function(t){n("warn","Failed to resolve getGliaContext promise",{error:t}),e([])})})}function p(n){var t="function"==typeof n.then;return t?d(n):l(n)}function _(){var t=window.getGliaContext;if(t&&"function"==typeof t)try{var e=t();if(e)return p(e)}catch(t){n("warn","Unexpected error in getGliaContext()",{error:t})}return[]}function m(){return sm._sessionContext&&sm._sessionContext.visitor_priority}function v(){var n=I.match(/__sm[\._]visitor_priority=(low|high)/i);if(n)return n[1]}function g(){return localStorage.getItem("sm.visitor_priority")}function h(){var n=m()||v()||g();return n&&"low"!==n?"priority="+encodeURIComponent(n):""}function w(){var n=R.site_id;return n?"site_id="+n:""}function y(){var t=I.match(/__sm[\._]tabId=([^&#]+)/);if(t){n("info","Found tab ID from the page query string");var e=t[1];return sm.tabId=e,"tab_id="+e}}function x(n){if(delete window.sm.loadDynamic,n.visitor_configuration){sm.conf=n.visitor_configuration,sm.conf.customCodeFile=n.custom_code_file,sm.visitorId=n.visitor_id,sm.accessToken=n.access_token,sm.authenticatedExternally=n.authenticated_externally,sm.visitorConfigUrl=H;var t=function(n){var t=sm.conf.assets.s3_prefix;return sm.conf.assets.server.indexOf("libs.")!==-1&&(t="/"),(t||"/")+(sm.conf.assets.hashes&&sm.conf.assets.hashes[n]||n)},e=document.createElement("script");if(e.setAttribute("src",sm.conf.assets.server+t("visitor/bootstrapper.js")),e.setAttribute("type","text/javascript"),sm.conf.integrities_enabled){var r=function(){for(var n=0;n<sm.conf.integrities.length;n++)if("bootstrapper"===sm.conf.integrities[n].name)return sm.conf.integrities[n].integrity};e.setAttribute("integrity",r()),e.setAttribute("crossorigin","*")}var o=!1,i=function(){o||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(o=!0,sm.Bootstrapper.boot(),e.onload=e.onreadystatechange=null)};e.onload=e.onreadystatechange=i,e.onerror=function(){for(var n=0;n<sm._apiHandlers.length;n++)sm._apiHandlers[n].reject({cause:"network timeout",message:"Failed to load Glia JS API"});e.onerror=null},n.boot_delay_ms>0?setTimeout(function(){document.head.appendChild(e)},n.boot_delay_ms):document.head.appendChild(e)}}if(!window.sm){var k=document.currentScript||document.querySelector('script[src*="salemove_integration.js"]');if(!k)return void console.error("Unable to find the salemove_integration.js script on the page.");window.sm={loadDynamic:!0},sm._apiHandlers=[],sm.getApi=function(n){return"function"==typeof sm._getApi?sm._getApi(n):new Promise(function(t,e){sm._apiHandlers.push({options:n,resolve:t,reject:e})})};var b=function(n){if(!n)return!1;var t="sm.test";try{return n.setItem(t,"1"),n.removeItem(t),!0}catch(n){return!1}},C=function(){return null!=window.location},j=b(window.localStorage)&&b(window.sessionStorage)&&C()&&window.MutationObserver;if(!j)return;var T=function(){var n=navigator.userAgent;return!n||/(.*https?:\/\/|bot|googlebot|crawler|spider|robot|crawling|dejaclick)/i.test(n)};if(T())return;var S=function(n){var t=n.indexOf("?");return t!==-1?n.substring(t+1):""},I=S(window.location.href);!function(){if(!window||!window.Promise){var n=function(){"use strict";function n(n){var t,e;e=this,b&&(e[i]=g()),n!==r&&(t=h(n)(m(e,a),m(e,s),e),t===f&&R(e,s,t.e))}var t,e,r,o,i,s,a,c,u,f,l,d,p,_,m,v,g,h,w,y,x,k,b,C,j,T,S,I,R,A,F,U;return e=void 0,T="object"==typeof global?global:window,n.prototype.then=function(n,t){return l(this,j(),n,t)},n.prototype["catch"]=function(n){return this.then(e,n)},n.resolve=function(t){return t instanceof n?t:A(j(),t)},n.reject=function(n){return R(j(),s,n)},n.race=function(t){var e,r,i;if(d(t),r=t.length,0===r)return n.resolve([]);for(i=j(),e=0;r>e&&(A(i,t[e++]),i._state===o););return i},n.all=function(t){var e,r,o,i,c,u,f,l;if(d(t),e=n.resolve,c=r=t.length,0===c)return e([]);for(f=j(),l=[],o=0,u=function(n){R(f,s,n)},i=function(n){e(t[n]).then(function(t){l[n]=t,--r||R(f,a,l)},u)};c>o;)i(o++);return f},n.onUnhandledRejection=function(n,t){var e;T.console&&(e=v(n,t),console.error("Unhandled Rejection:",e[0],e[1]))},b=!1,n.enableLongStackTrace=function(){b=!0},n.nextTick=T.process?T.process.nextTick:function(n){return setTimeout(n)},u=null,f={e:null},r={},C=function(n){return"object"==typeof n},k=function(n){return"function"==typeof n},U=function(){var n;try{return u.apply(this,arguments)}catch(t){return n=t,f.e=n,f}},h=function(n){return u=n,U},_=function(t,r){var o,i,s;return i=Array(t),s=0,o=function(){var n;for(n=0;s>n;)r(i[n]),i[n++]=e;s=0,i.length>t&&(i.length=t)},function(t){i[s++]=t,1===s&&n.nextTick(o)}},d=function(n){if(!(n instanceof Array))throw w("invalid_argument")},w=function(n){return new TypeError(n)},g=function(n){return(new Error).stack.replace("Error",n?"":t)},s=0,a=1,o=2,i="_pt",c="_st",t="From previous event:",n.prototype._state=o,n.prototype._pCount=0,n.prototype._pre=null,j=function(){return new n(r)},m=function(n,t){return function(e){b&&(n[c]=g(!0)),t===a?A(n,e):R(n,t,e)}},l=function(n,t,e,r){return k(e)&&(t._onFulfilled=e),k(r)&&(t._onRejected=r),b&&(t._pre=n),n[n._pCount++]=t,n._state!==o&&n._pCount>0&&S(n),t},S=_(999,function(n){var t,r,i,a,c;for(r=0,i=n._pCount;i>r;)a=n[r++],a._state===o&&(t=n._state?a._onFulfilled:a._onRejected,t!==e?(c=h(p)(t,n._value),c!==f?A(a,c):R(a,s,c.e)):R(a,n._state,n._value))}),x=function(n){var t,e,r;if(n._umark)return!0;for(n._umark=!0,e=0,r=n._pCount;r>e;){if(t=n[e++],t._onRejected)return!0;if(x(t))return!0}},I=_(9,_(9,function(t){x(t)||n.onUnhandledRejection(t._value,t)})),v=function(n,e){var r,o,s,a,u,f;return a=[],f=function(n){return n.replace(/^\s+|\s+$/g,"")},b&&e[i]&&(s=function(n){return a.push(f(n))},e[c]&&s(e[c]),(o=function(n){return n?(o(n._next),s(n[i]),o(n._pre)):void 0})(e)),u="\n"+a.join("\n"),r=function(n,e){var r;return e&&(r=n.indexOf("\n"+t))>0&&(n=n.slice(0,r)),"string"==typeof __filename?n.replace(RegExp(".+"+__filename+".+\\n?","g"),""):void 0},[n&&n.stack?r(f(n.stack),!0):n,r(u)]},p=function(n,t){return n(t)},R=function(n,t,e){var r;if(n._state===o)return n._state=t,n._value=e,t===s&&(b&&e&&e.stack&&(r=v(e,n),e.stack=r[0]+r[1]),I(n)),n._pCount>0&&S(n),n},A=function(t,e){var r;if(e===t&&e)return void R(t,s,w("promise_circular_chain"));if(null!==e&&(k(e)||C(e))){if(r=h(y)(e),r===f)return void R(t,s,r.e);k(r)?(b&&e instanceof n&&(t._next=e),F(t,e,r)):R(t,a,e)}else R(t,a,e);return t},y=function(n){return n.then},F=function(n,t,e){var r;r=h(e).call(t,function(e){t&&(t=null,A(n,e))},function(e){t&&(t=null,R(n,s,e))}),r===f&&t&&(R(n,s,r.e),t=null)},n}();window.Promise=n}}();var R=function(){var n=S(k.src);return""===n?{}:n.split("&").reduce(function(n,t){var e=t.split("=");return n[e[0]]=e[1],n},{})}();if(R.session_context){n("info","Found session context in integration script query string");var A=R.session_context;try{var F=atob(decodeURIComponent(A));sm._sessionContext=JSON.parse(F)}catch(t){n("warn","Could not parse session context",{session_context:A})}}var U=["referrer="+encodeURIComponent(location.origin+location.pathname),h(),w(),y()].filter(function(n){return""!==n}).join("&"),H=k.src.replace(new RegExp("//(assets|cdn|app)\\.([^/]+)/assets/salemove_integration\\.js"),"//api.$2/salemove_integration.js").replace(/salemove_integration\.js.*/,"visitor_config?"+U);Promise.all([o(),s(),_()]).then(function(n){var t=n.reduce(function(n,t){return n.concat(t)},[]).filter(function(n){return""!==n}).join("&"),e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==this.readyState)if(200==this.status){var n=JSON.parse(e.responseText);x(n)}else for(var t=0;t<sm._apiHandlers.length;t++)sm._apiHandlers[t].reject({cause:"network timeout",message:"Failed to fetch site and visitor configuration",response_code:this.status})},e.open("POST",H,!0),e.withCredentials=!0,e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(t)})}}();