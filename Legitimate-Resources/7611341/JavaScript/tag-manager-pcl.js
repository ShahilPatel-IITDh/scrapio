function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}window.digitalData=window.digitalData||{},window.adobeTargetHelper={headEl:function(){return document.getElementsByTagName("head")[0]},addStyle:function(){var t=this.headEl();if(t){var e=document.createElement("style");e.id=this.styleId,e.innerHTML="body {opacity: 0 !important}",t.appendChild(e)}},init:function(){void 0===window.digitalData.activity.ready&&(this.addStyle(),this.timer(),window.digitalData.tracking.debug&&console.log(this.emoji,"activity:","prehiding"))},removeStyle:function(t){var e=this.headEl(),a=this.styleEl();e&&a&&e.removeChild(a)},styleEl:function(){return document.getElementById(this.styleId)},styleId:"at-body-style",status:function(t,e){this.removeStyle(),window.digitalData.activity.ready=t,this.timeout&&clearTimeout(this.timeout),window.digitalData.tracking.debug&&console.log(this.emoji,"activity:",e,t)},emoji:String.fromCodePoint(127919),timer:function(){this.timeout=setTimeout((function(){adobeTargetHelper.status(!1,"prehiding timeout")}),3e3)}},window.digitalDataHelper={addData:function(t,e,a){"object"===_typeof(e)&&(a=e,e=void 0);var i,o=["countryName","countryPhone","lastUpdated"];function n(t){var e=["true","Y","1","false","N","0"],a=e.indexOf(t);return a>-1?"true"===e[a]||"Y"===e[a]||"1"===e[a]:t}switch(_typeof(a)){case"object":for(var d in i={},a)a.hasOwnProperty(d)&&-1===o.indexOf(d)&&(i[d]=n(a[d]));break;case"array":i=[],a.forEach((function(t,e,a){i[e]=n(t)}));break;default:i=n(a)}if(e)if("object"===_typeof(i))for(var d in window.digitalData[t][e]=window.digitalData[t][e]||{},i)window.digitalData[t][e][d]=i[d];else window.digitalData[t][e]=i;else for(var d in window.digitalData[t]=window.digitalData[t]||{},i)window.digitalData[t][d]=i[d]},env:hostDomain[sub_domain_substring].envir.charAt(0).toUpperCase()+hostDomain[sub_domain_substring].envir.slice(1),library:{launch:hostDomain[sub_domain_substring].pclLaunchLibrary,onetrust:{src:hostDomain[sub_domain_substring].pclOnetrustLibrary,attributes:{"data-document-language":!0,"data-domain-script":hostDomain[sub_domain_substring].pclOnetrustDomain,charset:"UTF-8"}}},guestLocale:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t="object"===("undefined"==typeof localeData?"undefined":_typeof(localeData))?localeData:"object"===("undefined"==typeof docCookies?"undefined":_typeof(docCookies))&&JSON.parse(docCookies.getItem("getLocale"));t?(digitalDataHelper.addData("user","locale",t),digitalDataHelper.trackingConsent(window.digitalData.user.locale.isEU,window.digitalData.user.locale.country)):document.addEventListener("DOMContentLoaded",(function(t){"object"===("undefined"==typeof guestLocale?"undefined":_typeof(guestLocale))&&guestLocale.isReady(digitalDataHelper.guestLocale)}))})),guestFutureBooking:function(t){var e="Prod"===this.env?"pcl_futureBooking":"pcl_futureBooking"+this.env,a="object"===("undefined"==typeof docCookies?"undefined":_typeof(docCookies))&&docCookies.hasItem(e)?JSON.parse(docCookies.getItem(e)):t;a?digitalDataHelper.addData("user","itinerary",a.futureBookings[0]):document.addEventListener("DOMContentLoaded",(function(t){"object"===("undefined"==typeof guestProfile?"undefined":_typeof(guestProfile))&&guestProfile.isReady("pcl_futureBooking",digitalDataHelper.guestFutureBooking)}))},guestProfile:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){var e="Prod"===this.env?"pcl_guestInfo":"pcl_guestInfo"+this.env,a="object"===("undefined"==typeof docCookies?"undefined":_typeof(docCookies))&&docCookies.hasItem(e)?JSON.parse(docCookies.getItem(e)):t;if(a)digitalDataHelper.addData("user","profile",a);else{document.addEventListener("DOMContentLoaded",(function(t){"object"===("undefined"==typeof guestProfile?"undefined":_typeof(guestProfile))&&guestProfile.isReady("pcl_guestInfo",digitalDataHelper.guestProfile)}));var i=window.location.search;if(i&&i.indexOf("&eccn")>0)(i=i.substring(1)).split("&").forEach((function(t){if(0===t.indexOf("eccn")){var e={ccn:t.split("=")[1]};digitalDataHelper.addData("user","profile",e)}}))}window.digitalData.user.profile&&window.digitalData.user.profile.futureBooked&&digitalDataHelper.guestFutureBooking()})),guestSession:function(){var t;if(window.digitalData.user.session)t=window.digitalData.user.session;else{var e="Prod"===this.env?"pcl_guestInfoStatus":"pcl_guestInfoStatus"+this.env,a="object"===("undefined"==typeof docCookies?"undefined":_typeof(docCookies))&&docCookies.hasItem(e)?JSON.parse(docCookies.getItem(e)):null;t=a?"object"===_typeof(a)?a.timeStamp:a:null}if(t)return digitalDataHelper.addData("user","session",t),t},init:function(){["activity","content","errors","events","itinerary","page","product","search","tracking","user"].forEach((function(t){window.digitalData[t]=window.digitalData[t]||{}}));var t={debug:localStorage.getItem("com.adobe.reactor.debug"),ready:window.digitalData.tracking.ready||!1,satelliteReady:window.digitalData.tracking.satelliteReady||!1};this.addData("tracking",t),window.adobeTargetHelper.init(),this.pageLoad()},pageLoad:function(){this.page(),this.addData("user","auth",{status:"object"===("undefined"==typeof docCookies?"undefined":_typeof(docCookies))&&docCookies.hasItem("sccn")}),this.guestLocale(),this.guestProfile(),this.guestSession()},routeLoad:function(t){this.pageLoad();var e=!1!==t?"global-route-view":"global-error-view";window.digitalData.tracking.satelliteReady?_satellite.track(e):window.digitalData.tracking.routeLoad=e},directCall:function(t,e){window.digitalData.tracking.satelliteReady&&(e=e||{},_satellite.track(t,e))},loadConsent:function(t,e){window.OneTrust={geolocationResponse:{stateCode:"",countryCode:e,regionCode:t?"EU":""}},window.OptanonWrapper||(window.OptanonWrapper=function(){digitalDataHelper.consent(t)},this.loadJS(digitalDataHelper.library.onetrust.src,!0,"head",digitalDataHelper.library.onetrust.attributes))},consent:function(t){var e=window.OptanonActiveGroups?window.OptanonActiveGroups.split(","):[],a={};if(["C0001","C0002","C0003","C0004","C0005"].forEach((function(t){a[t]=e.indexOf(t)>-1})),digitalDataHelper.addData("user","consent",a),t&&!a.C0002&&(window.adobeTargetHelper.status(!1,"Consent not given"),this.status("ready",!1,"Consent not given")),t&&docCookies.getItem("OptanonAlertBoxClosed")){var i,o,n,d,r,s;if(a.C0002)null===(i=window.adobe)||void 0===i||null===(o=i.optIn)||void 0===o||o.approve([null===(n=window.adobe)||void 0===n||null===(d=n.OptInCategories)||void 0===d?void 0:d.ECID,null===(r=window.adobe)||void 0===r||null===(s=r.OptInCategories)||void 0===s?void 0:s.ANALYTICS]);this.directCall("user-consent-levels-submitted")}},loadJS:function(t,e,a,i,o){var n="head"===a?window.document.getElementById("digital-data-tracking"):window.document.getElementsByTagName("body")[0],d=window.document.createElement("script");if(i&&"object"===_typeof(i))for(var r in i)d.setAttribute(r,i[r]);if(d.src=t,d.type="text/javascript",d.async=!e,"head"===a)n.parentNode.insertBefore(d,n);else{var s="top"===a?n.firstElementChild:null;n.parentNode.insertBefore(d,s)}if(o)switch(_typeof(o)){case"function":d.onload=o;break;case"object":d.onload=function(){window.digitalDataHelper.status(o.property,!0,o.message)},d.onerror=function(){window.digitalDataHelper.status(o.property,!1,o.message)}}return d},loadTMS:function(){window.digitalData.tracking.ready?this.status("ready",!0,"Launch already loaded"):this.loadJS(digitalDataHelper.library.launch,!1,"head",null,{property:"ready",message:"Launch library loaded"})},page:function(){var t={env:window.digitalData.page.env||this.env,pathname:window.location.pathname.split(".")[0],subdomain:window.location.host.split(".")[0],timestamp:Date.now(),type:window.digitalData.page.type||window.self===window.top?"self":"popup"};this.addData("page",t)},emoji:String.fromCodePoint(128640),status:function(t,e,a){window.digitalData.tracking[t]=e,window.digitalData.tracking.debug&&console.log(this.emoji,"digitalData:",a,JSON.parse(JSON.stringify(window.digitalData)))},trackingConsent:function(t,e){var a="#notrack"===window.location.hash||"true"===sessionStorage.getItem("pcl-notrack");this.addData("user","consent",{required:t}),a?(this.status("ready",!1,"notrack set"),window.adobeTargetHelper.status(!1,"notrack set"),sessionStorage.setItem("pcl-notrack",!0)):(this.loadTMS(),this.loadConsent(t,e))},traffic:function(t){if(window.fetch){var e={status:"page traffic metrics"},a=[window.digitalData.page.level1,window.digitalData.page.level2,window.digitalData.page.level3,window.digitalData.page.level4];e.title=a.filter((function(t){return!!t})).join(":"),e.detail="page tracking status: "+t,e.source="auth:"+window.digitalData.user.auth.status,e.source+=", country:"+window.digitalData.user.locale.country,e.source+=", pagename:"+window.digitalData.page.subdomain+":"+window.digitalData.page.pathname,e.source+=", session:"+this.guestSession();var i,o=$gwapiURL+"/guest/p1.0/ui-logs";switch(window.digitalData.user.locale.country){case"GB":case"UK":i="PO";break;case"AU":case"NZ":i="PA";break;default:i="PC"}var n={Accept:"*/*",BookingCompany:i,"Content-Type":"application/json","pcl-client-id":$pclClientId,ProductCompany:"PC"};fetch(o,{method:"post",headers:n,body:JSON.stringify([e])}).then((function(t){return t.json()})).then((function(t){window.digitalData.tracking.debug&&console.log(window.digitalDataHelper.emoji,"digitalData:","pageLoad Traffic data",t)})).catch((function(t){window.digitalData.tracking.debug&&console.log(window.digitalDataHelper.emoji,"digitalData:","pageLoad Traffic data error",t)}))}}},digitalDataHelper.init();
//# sourceMappingURL=./tag-manager-pcl.js.map
