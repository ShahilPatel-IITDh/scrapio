!function(i){function t(){}function n(t,e){this.init(t,e)}t.prototype={constructor:t,count:0,interval:1e3,initTime:Math.round((new Date).getTime()/1e3),weekString:["星期天","星期一","星期二","星期三","星期四","星期五","星期六"],periodString:["上午","下午"],start:function(t){var e=this;e.cid=setTimeout(function(){e.start(t)},e.interval),e.callback(t),e.count++},stop:function(t){clearTimeout(this.cid),this.callback(t)},countTimeFormat:function(t,e){var i={d:Math.floor(t/3600/24),h:Math.floor(t/3600%24),m:Math.floor(t/60%60),s:Math.floor(t%60)};for(var n in i)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,i[n]<10?"0"+i[n]:i[n]));for(;0==e.indexOf("00");)e=e.substr(3);return e},timeFormat:function(t,e){var i=new Date(t),n={"M+":i.getMonth()+1,"D+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),S:i.getMilliseconds()};for(var o in new RegExp("(Y+)").test(e)&&(e=e.replace(RegExp.$1,(""+i.getFullYear()).substr(4-RegExp.$1.length))),new RegExp("(W+)").test(e)&&(e=e.replace(RegExp.$1,this.weekString[i.getDay()])),new RegExp("(p+)").test(e)&&(e=e.replace(RegExp.$1,this.periodString[i.getHours()<12?0:1])),n)new RegExp("("+o+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[o]:("00"+n[o]).substr((""+n[o]).length)));return e},callback:function(t){if("function"==typeof t){for(var e=[],i=0;i<=arguments.length;i++)e.push(arguments[i]);t.apply(this,e)}}},(n.prototype=new t).init=function(t,e){this.element=i(t),this.initTime=e.initTime,this.endTime=e.endTime,this.startTime=e.startTime,this.run=function(){this.now=this.count+this.initTime,this.now>=this.endTime?this.stop(e.over):this.now>=this.startTime?this.callback(e.going):this.callback(e.before)},this.start(this.run)},n.prototype.constructor=n,i.fn.countdown=function(t){var e=i.extend({},i.fn.countdown.defaults,t);return this.each(function(){e.endTime=i(this).attr("data-over")||e.initTime-1,e.startTime=i(this).attr("data-start")||e.initTime-1;new n(this,e)})},i.fn.countdown.defaults={initTime:Math.round((new Date).getTime()/1e3),before:function(){i(this.element).html(this.countTimeFormat(this.startTime-this.now,"d天h时m分s秒"))},going:function(){i(this.element).html(this.countTimeFormat(this.endTime-this.now,"d天h时m分s秒"))},over:function(){i(this.element).parent().html("结束")}}}(jQuery);