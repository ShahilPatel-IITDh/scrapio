'use strict';

var $ = window.jQuery;

//ON DOCUMENT READY
$(document).ready(function () {


    /*-------------------------------------------------*/
    /* =  SVG4Everybody
    /*-------------------------------------------------*/
    svg4everybody();


    /*-------------------------------------------------*/
    /* =  Burger bar
    /*-------------------------------------------------*/

    var html = $("html");
    var burgerIcon = $(".bars");
    var headerNav = $(".c-header__nav");
    var menuOverlay = $(".menu-overlay");

    function headerToggleClasses() {
        burgerIcon.toggleClass('is-open');
        headerNav.toggleClass('is-active');
        html.toggleClass("is-open");
    }

    burgerIcon.on("click", function () {
        headerToggleClasses()
    });

    menuOverlay.on("click", function () {
        headerToggleClasses()
    });


    /*-------------------------------------------------*/
    /* =  Sticky footer
    /*-------------------------------------------------*/

    var numb = 80;
    $(window).scroll(function () {

        var top_of_element = $(".c-footer").offset().top + 60;
        var bottom_of_element = $(".c-footer").offset().top + $(".c-footer").outerHeight();
        var bottom_of_screen = $(window).scrollTop() + $(window).innerHeight();
        var top_of_screen = $(window).scrollTop();

        if ((bottom_of_screen > top_of_element) && (top_of_screen < bottom_of_element)) {
            $(".c-footer__prefooter").addClass("is-active");

        } else {
            $(".c-footer__prefooter").removeClass("is-active");
        }
    });

    var previousScroll = 0;

    $(window).scroll(function () {
        var currentScroll = $(this).scrollTop();
        if (currentScroll > previousScroll) {
            $(".c-footer__prefooter").addClass("is-hide");

        } else {

            $(".c-footer__prefooter").removeClass("is-hide");
        }
        previousScroll = currentScroll;
    });


    /*-------------------------------------------------*/
    /* =  Tabs
    /*-------------------------------------------------*/


    var tabLink = $(".tab-link");
    var tabBox = $(".tab-content__box");

    tabLink.on("click", function () {
        tabLink.removeClass('is-active')
        $(this).addClass('is-active')
        var tabLinkData = $(this).data("tab");
        tabBox.removeClass('is-active')
        $(".tab-content__box" + tabLinkData).addClass('is-active')
    });

    var swiper1 = new Swiper('#blog-slider', {
        slidesPerView: 1,
        spaceBetween: 0,
        loop: true,
        effect: 'fade',
        autoplay: {
            delay: 2500,
            disableOnInteraction: false,
        },
        pagination: {
            el: '.swiper-pagination',
            dynamicBullets: true
        },
    });


    $("select:not(.no-wrapper)").wrap("<div class='select-option'></div>");

    var swiper4 = new Swiper('#connectSlider', {
        slidesPerView: 3,
        spaceBetween: 20,
        loop: true,
        // navigation: {
        //   nextEl: '.swiper-button-next',
        //   prevEl: '.swiper-button-prev',
        // },
        pagination: {
            el: '.swiper-pagination1',
            dynamicBullets: true
        },
        breakpoints: {
            1100: {
                slidesPerView: 2,
                spaceBetween: 20,
            },
            790: {
                slidesPerView: 1,
                spaceBetween: 10,
            }
        }
    });

    /**
     * accordions
     */

    $('.accordions-block .single__accordion h3').click(function () {
        $(this).toggleClass('active');
        $(this).siblings('.accordion__content').slideToggle();
    });

    $(document).keyup(function (e) {

        if (e.key === "Escape") {
            $('.accordions-block .single__accordion h3.active').removeClass('active').siblings('.accordion__content').slideToggle();
        }

    });

    /**
     * Wrap Youtube Embeds
     */

    $('iframe').filter(function () {
        return this.src.match(/(youtube\.com|youtu\.be)/i);
    }).wrap('<div class="responsive-video"></div>');

    /**
     * Wrap tables
     */

    $('.entry-content table').wrap('<div class="table-responsive"></div>');

    /**
     * Submenu options
     */

    function showSubmenu(element) {
        $('.submenu').removeClass('active');
        $('.submenu.' + element).addClass('active');
    }

    function hideSubmenu(element) {
        $('.submenu.' + element).removeClass('active');
    }

    function submenuFunction(element) {
        $('div.submenu.' + element).appendTo('li.has-submenu.' + element);

        $('.has-submenu.' + element + ' a').mouseover(function () {
            showSubmenu(element);
        }).focusin(function () {
            showSubmenu(element);
        });
        $('.c-header').mouseleave(function () {
            hideSubmenu(element);
        });
        $('.c-header a.custom-logo-link, .c-header__list ul:not(.menu) li:not(.has-submenu) a').mouseover(function () {
            hideSubmenu(element);
        }).focusin(function () {
            hideSubmenu(element);
        });
        if (element === 'doctors') {
            $('.widget_hmenudoctorsletters a:last-child').focusout(function () {
                hideSubmenu(element);
            });
        }
    }

    // doctors submenu
    submenuFunction('doctors');
    // services submenu
    submenuFunction('services');

    /**
     * Datepicker
     */

    $('.wpcf7 input[type=date]').prop('readonly', true);

    $('.wpcf7 input[type=date]').on('click', function (event) {
        event.preventDefault();
    });
    if (!navigator.userAgent.match(/(iPod|iPhone|iPad)/)) {
        $('.wpcf7 input[type=date]').datepicker({
            dateFormat: 'yy-mm-dd',
            onSelect: function (selected, evnt) {
            }
        });
    }

    /**
     * Checkbox cf7
     */
    $('.wpcf7-list-item-label').each(function (index) {
        $(this).siblings('input').attr('id', 'wpcf7-custom-label' + index)
        $(this).replaceWith(function () {
            return $('<label/>', {
                html: $(this).html(),
                'class': 'wpcf7-list-item-label',
                'for': 'wpcf7-custom-label' + index
            });
        });
    });

    /**
     * Focus Out Hide main menu on mobile
     */

    $('a.bars, .c-header__nav a').focusout(function (e) {
        if ($('html').hasClass('is-open')) {
            setTimeout(function () {
                if (!$(document.activeElement).closest('.c-header__nav').length) {
                    if (document.activeElement.className !== 'bars is-open') {
                        headerToggleClasses();
                    }
                }
            }, 1);
        }
    });

    /**
     * Hide submenu on desktop when left focus
     */
    $('.c-header__nav .submenu a').focusout(function (e) {
        var subMenuType = $($(this).closest('.submenu')[0]).data('type');

        if (!$('html').hasClass('is-open')) {
            setTimeout(function () {
                if (!$(document.activeElement).closest('.submenu').length) {
                    hideSubmenu(subMenuType)
                }
            }, 1);
        }
    });

});


