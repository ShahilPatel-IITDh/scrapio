/*
     D Loja Virtual
 @link          http://www.dlojavirtual.com
 @package       app.FrontEnd.Js
 @since         v 1.0
 @author        Bruno Lehnen Simï¿½es
*/
var ProductModel={__imgCache:{},__imgDefaults:{},__cacheImg:function(a,e,d){var g=this;"undefined"==typeof this.__imgCache[a]?e?g.__imgCache[a]=$.clone(e):(g.__imgCache[a]=document.createElement("img"),App.isValidCallback(d)&&$(g.__imgCache[a]).load(function(){d(g.__imgCache[a])}),g.__imgCache[a].src=base_url_image+"/sku/thumb_"+a):App.isValidCallback(d)&&d(this.__imgCache[a])},__getCombination:function(a){return a.name.split("[")[4].slice(0,-1)},__getProductId:function(a){return a.name.split("[")[3].slice(0,
-1)},__setDefaultImg:function(a,e){this.__imgDefaults[a]=e},init:function(){var a=this;$(".product-image").each(function(e,d){var g=$(d.parentNode.parentNode).data("id"),b=0<$(this).children("a").children("picture").children("img").length?"undefined"!==typeof $(this).children("a").children("picture").first().children("img").attr("src")?$(this).children("a").children("picture").first().children("img").attr("src").split("/").pop().split("_").pop():!1:null==$(this).children("a").children("img").attr("src")?
$(this).children("a").children("img").attr("data-src").split("/").pop().split("_").pop():$(this).children("a").children("img").attr("src").split("/").pop().split("_").pop();!1!==b&&(a.__cacheImg(b,d),a.__setDefaultImg(g,b))})},getCacheImg:function(a){return this.__imgCache[a]},getDefaultImg:function(a,e){return"undefined"!=typeof e&&e?this.getCacheImg(this.__imgDefaults[a]):this.__imgDefaults[a]},getQuestions:function(a){var e=[],d=[];0<a.length&&a.each(function(g,b){var f=$(b).prop("alt"),c=$(b).attr("data-minlength"),
h=$(b).attr("data-length"),l=$(b).val();"float-two"==f?(f="number",l=parseFloat(l.replace(",",".")),c=parseFloat(c),h=parseFloat(h)):("number"==f&&(l=parseInt(l)),c=parseInt(c),h=parseInt(h));"number"==f&&0!=c&&(l<c||0>l)?(f=$(b).closest(".row").children(".product-question-item-title").html(),"undefined"==typeof f&&(f=$(b).closest(".product-question-action").children(".product-question-item-title").html()),d[0]={error:!0,msg:"O valor m\u00ednimo para "+f+" \u00e9 "+c}):"number"==f&&0!=h&&(l>h||0>
l)?(f=$(b).closest(".row").children(".product-question-item-title").html(),"undefined"==typeof f&&(f=$(b).closest(".product-question-action").children(".product-question-item-title").html()),d[0]={error:!0,msg:"O valor m\u00e1ximo para "+f+" \u00e9 "+h}):0!=h&&l.length>h?(f=$(b).closest(".row").children(".product-question-item-title").html(),d[0]={error:!0,msg:"O tamanho m\u00e1ximo para "+f+" \u00e9 "+h}):""!==$(b).val()&&(e[e.length]={id:$(b).data("question-id"),pergunta:$(b).data("question"),valor:$(b).val()})});
return 0<d.length?d:e},getChecked:function(a){var e=this,d=[];$(a).children("li").children("input:checked").each(function(g,b){d[d.length]={produto_id:e.__getProductId(b),order:$(b).data("order"),atributo_id:b.value,combinacao_id:e.__getCombination(b),muda_vitrine:$(b).hasClass("active-combination")}});return d},getKitChecked:function(a,e){var d=[];$.each(a,function(g,b){d[d.length]={id:$(b).attr("data-id"),produto_id:$(b).attr("data-product"),produto_estoque_id:$(b).attr("data-stock"),clicado:e==
$(b).attr("data-id")?!0:!1}});return d},find:function(a,e,d){var g=this;a=JSON.stringify(a);var b=WsRouter.generateRoute(null,"produto","readVitrine",g.id);WsDispatcher.postRequest(b,{CombinacaoAtributo:a},e,function(f){App.isValidCallback(d)&&(f.img||(f.img=g.getDefaultImg(g.id)),g.__cacheImg(f.img,null,function(c){$(c).hasClass("product-image")?(elementImg=document.createElement("img"),elementImg.src=base_url_image+"/sku/thumb_"+f.img,f.img=elementImg):f.img=c;d.call(g,f)}))})},find_det:function(a,
e,d){a=JSON.stringify(a);var g=WsRouter.generateRoute("produto","combinacao","readDetalhamento",this.id);WsDispatcher.postRequest(g,{CombinacaoAtributo:a},e,d)},findKit:function(a,e,d,g,b){a=JSON.stringify(a);e=JSON.stringify(e);d=JSON.stringify(d);reqId=this.id;route=WsRouter.generateRoute("produto","combinacao","readKit",[reqId,this.amount]);WsDispatcher.postRequest(route,{CombinacaoAtributo:a,Itens:e,ProdutoKit:d},g,b)},find_detUnidade:function(a,e,d,g){a=WsRouter.generateRoute(null,"produto",
"readDetalhamentoUnidade",a);WsDispatcher.postRequest(a,{quantidade:e},d,g)},hint:function(a,e,d){a=JSON.stringify({key:a});var g=WsRouter.generateRoute(null,"produto","hint");WsDispatcher.postRequest(g,{CatalogoProduto:a},e,function(b){CurrencyBehavior.formatProduct(b);App.initCallback(d,b,this);if(b.pixelData&&"undefined"!==typeof b.pixelData.evento_id&&b.pixelData.evento_id){var f=[];$.each(b.pixelData.produtos,function(c,h){f[f.length]=h.Estoque&&"undefined"!==typeof h.Estoque.id?parseInt(h.Estoque.id):
parseInt(h.CatalogoProduto.id)});"undefined"!==typeof fbq&&fbq("track","Search",{search_string:b.pixelData.busca,content_ids:f},{eventID:b.pixelData.evento_id})}})},cartCreateProductKit:function(a,e,d,g){var b="undefined"!==typeof fbq,f=this;a=JSON.stringify(a);e=JSON.stringify(e);route=WsRouter.generateRoute(null,"carrinhos","createProductKit",[f.id,f.kitId,f.amount]);WsDispatcher.postRequest(route,{CombinacaoAtributo:a,Pergunta:e},d,function(c){if(App.isValidCallback(g)&&c&&(c={CatalogoCarrinho:c},
CurrencyBehavior.formatCart(c),g.call(f,c.CatalogoCarrinho),b&&c.CatalogoCarrinho.seo_facebook_dpa)){var h=[];h[h.length]=c.CatalogoCarrinho.estoque_id;"undefined"!=typeof c.CatalogoCarrinho.facebook_event_id&&c.CatalogoCarrinho.facebook_event_id&&fbq("track","AddToCart",{content_ids:h,content_type:"product",value:c.CatalogoCarrinho.total_produto.replace("R$ ","").replace(".","").replace(",","."),currency:"BRL"},{eventID:c.CatalogoCarrinho.facebook_event_id})}})},cartCreateProductKitUnique:function(a,
e,d){var g="undefined"!==typeof gtag,b="undefined"!==typeof fbq,f=this;route=WsRouter.generateRoute(null,"carrinhos","createProductKitUnique",[f.kitId,f.amount]);WsDispatcher.postRequest(route,{Estoque:a},e,function(c){if(App.isValidCallback(d)&&c&&(c={CatalogoCarrinho:c},CurrencyBehavior.formatCart(c),d.call(f,c.CatalogoCarrinho),g&&(c.CatalogoCarrinho.quantidade_produto=parseInt(c.CatalogoCarrinho.quantidade_produto),gtag("event","add_to_cart",{currency:"BRL",value:c.CatalogoCarrinho.valor_unitario,
items:[{item_id:c.CatalogoCarrinho.estoque_id,item_name:c.CatalogoCarrinho.nome_produto,currency:"BRL",price:c.CatalogoCarrinho.valor_unitario,quantity:c.CatalogoCarrinho.quantidade_produto}]})),b&&c.CatalogoCarrinho.seo_facebook_dpa)){var h=[];h[h.length]=c.CatalogoCarrinho.estoque_id;fbq("track","AddToCart",{content_ids:h,content_type:"product",value:c.CatalogoCarrinho.total_produto.replace("R$ ","").replace(".","").replace(",","."),currency:"BRL"},{eventID:c.CatalogoCarrinho.facebook_event_id})}})},
cartCreateProduct:function(a,e,d,g){var b="undefined"!==typeof gtag,f="undefined"!==typeof fbq,c=this;a=JSON.stringify(a);e=JSON.stringify(e);var h=c.gift,l=c.payLater,n=WsRouter.generateRoute(null,"carrinhos","createProduct",[c.id,c.amount]);WsDispatcher.postRequest(n,{CombinacaoAtributo:a,Pergunta:e,Lista:h,Depois:l},d,function(k){if(App.isValidCallback(g)&&k){k={CatalogoCarrinho:k};CurrencyBehavior.formatCart(k);g.call(c,k.CatalogoCarrinho);b&&(k.CatalogoCarrinho.quantidade_produto=parseInt(k.CatalogoCarrinho.quantidade_produto),
gtag("event","add_to_cart",{currency:"BRL",value:k.CatalogoCarrinho.valor_unitario,items:[{item_id:k.CatalogoCarrinho.estoque_id,item_name:k.CatalogoCarrinho.nome_produto,currency:"BRL",price:k.CatalogoCarrinho.valor_unitario,quantity:k.CatalogoCarrinho.quantidade_produto}]}));if(f&&k.CatalogoCarrinho.seo_facebook_dpa){var m=[];m[m.length]=k.CatalogoCarrinho.estoque_id;fbq("track","AddToCart",{content_ids:m,content_type:"product",value:k.CatalogoCarrinho.total_produto.replace("R$ ","").replace(".",
"").replace(",","."),currency:"BRL"},{eventID:k.CatalogoCarrinho.facebook_event_id})}k.CatalogoCarrinho.script_pinterest_ativo&&pintrk("track","addtocart",{currency:"BRL",value:k.CatalogoCarrinho.total_produto.replace("R$ ","").replace(".","").replace(",","."),line_items:[{product_id:k.CatalogoCarrinho.produto_id,product_variant_id:k.CatalogoCarrinho.estoque_id}]})}})},favoriteProduct:function(a,e,d){a=JSON.stringify({produto_id:this.id,produto_estoque_id:a});var g=WsRouter.generateRoute(null,"clientes",
"favoriteProduct",[]);WsDispatcher.postRequest(g,{Produto:a},e,d)}};