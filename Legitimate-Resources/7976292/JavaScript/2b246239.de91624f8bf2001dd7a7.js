(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[8],{BoS1:function(e,n,t){"use strict";function i(e,n){if(!(this instanceof i))return new i(e,n);TreeTransformer.call(this,this.before,this.after),this.options=defaults(e,{annotations:!n,arguments:!n,arrows:!n,assignments:!n,awaits:!n,booleans:!n,collapse_vars:!n,comparisons:!n,conditionals:!n,dead_code:!n,default_values:!n,directives:!n,drop_console:!1,drop_debugger:!n,evaluate:!n,expression:!1,functions:!n,global_defs:!1,hoist_exports:!n,hoist_funs:!1,hoist_props:!n,hoist_vars:!1,ie:!1,if_return:!n,imports:!n,inline:!n,join_vars:!n,keep_fargs:n,keep_fnames:!1,keep_infinity:!1,loops:!n,merge_vars:!n,module:!1,negate_iife:!n,objects:!n,optional_chains:!n,passes:1,properties:!n,pure_funcs:null,pure_getters:!n&&"strict",reduce_funcs:!n,reduce_vars:!n,rests:!n,sequences:!n,side_effects:!n,spreads:!n,strings:!n,switches:!n,templates:!n,top_retain:null,toplevel:!(!e||!e.module&&!e.top_retain),typeofs:!n,unsafe:!1,unsafe_comps:!1,unsafe_Function:!1,unsafe_math:!1,unsafe_proto:!1,unsafe_regexp:!1,unsafe_undefined:!1,unused:!n,varify:!n,webkit:!1,yields:!n},!0);var t=this.options.evaluate;this.eval_threshold=/eager/.test(t)?1/0:+t;var r=this.options.global_defs;if("object"==typeof r)for(var a in r)/^@/.test(a)&&HOP(r,a)&&(r[a.slice(1)]=parse(r[a],{expression:!0}));!0===this.options.inline&&(this.options.inline=4),this.drop_fargs=this.options.keep_fargs?return_false:function(e,n){if(e.length_read)return!1;var t=e.name;if(!t)return n&&"Call"==n.TYPE&&n.expression===e;if(t.fixed_value()!==e)return!1;var i=t.definition();if(i.direct_access)return!1;var r=i.escaped;return r&&1!=r.depth},this.options.module&&(this.directives["use strict"]=!0);var o=this.options.pure_funcs;"function"==typeof o?this.pure_funcs=o:"string"==typeof o?this.pure_funcs=function(e){var n;return e instanceof AST_Call?n=e.expression:e instanceof AST_Template&&(n=e.tag),!(n&&o===n.print_to_string())}:Array.isArray(o)?this.pure_funcs=function(e){var n;return e instanceof AST_Call?n=e.expression:e instanceof AST_Template&&(n=e.tag),!(n&&member(n.print_to_string(),o))}:this.pure_funcs=return_true;var s=this.options.sequences;this.sequences_limit=1==s?800:0|s;var f=this.options.top_retain;f instanceof RegExp?this.top_retain=function(e){return f.test(e.name)}:"function"==typeof f?this.top_retain=f:f&&("string"==typeof f&&(f=f.split(/,/)),this.top_retain=function(e){return member(e.name,f)});var c=this.options.toplevel;this.toplevel="string"==typeof c?{funcs:/funcs/.test(c),vars:/vars/.test(c)}:{funcs:c,vars:c}}i.prototype=new TreeTransformer((function(e,n,t){if(e._squeezed)return e;var i=e instanceof AST_Scope;i&&(this.option("arrows")&&is_arrow(e)&&e.value&&(e.body=[e.first_statement()],e.value=null),e.hoist_properties(this),e.hoist_declarations(this),e.process_returns(this)),n(e,this),n(e,this);var r=e.optimize(this);return!i||r!==e||this.has_directive("use asm")||r.pinned()||(r.drop_unused(this),r.merge_variables(this)&&r.drop_unused(this),n(r,this)),r===e&&(r._squeezed=!0),r})),i.prototype.option=function(e){return this.options[e]},i.prototype.exposed=function(e){if(e.exported)return!0;if(e.undeclared)return!0;if(!(e.global||e.scope.resolve()instanceof AST_Toplevel))return!1;var n=this.toplevel;return!all(e.orig,(function(e){return n[e instanceof AST_SymbolDefun?"funcs":"vars"]}))},i.prototype.compress=function(e){(e=e.resolve_defines(this)).hoist_exports(this),this.option("expression")&&e.process_expression(!0);for(var n=this.options.merge_vars,t=+this.options.passes||1,i=1/0,r=!1,a={ie:this.option("ie")},o=0;o<t;o++)if(e.figure_out_scope(a),(o>0||this.option("reduce_vars"))&&e.reset_opt_flags(this),this.options.merge_vars=n&&(r||o==t-1),e=e.transform(this),t>1){var s=0;if(e.walk(new TreeWalker((function(){s++}))),AST_Node.info("pass {pass}: last_count: {min_count}, count: {count}",{pass:o,min_count:i,count:s}),s<i)i=s,r=!1;else{if(r)break;r=!0}}return this.option("expression")&&e.process_expression(!1),e},function(e){function n(e,n){var t=n.get_property();if(!(t instanceof AST_Node)){var i;if(e instanceof AST_Array){var r=e.elements;if("length"==t)return D(r.length,e);"number"==typeof t&&t in r&&(i=r[t])}else if(e instanceof AST_Lambda){if("length"==t)return e.length_read=!0,D(e.argnames.length,e)}else if(e instanceof AST_Object){t=""+t;for(var a=e.properties,o=a.length;--o>=0;){if(!un(a[o]))return;i||a[o].key!==t||(i=a[o].value)}}return i instanceof AST_SymbolRef&&i.fixed_value()||i}}function t(e,i,r,a,o,s,f){var c=i.parent(o);if(!(e.option("unsafe")&&c instanceof AST_Dot&&function(e,n){return e instanceof AST_Boolean?oe.Boolean[n]:e instanceof AST_Number?oe.Number[n]:e instanceof AST_String?oe.String[n]:"valueOf"!=n&&(e instanceof AST_Array?oe.Array[n]:e instanceof AST_Lambda?oe.Function[n]:e instanceof AST_Object?oe.Object[n]:e instanceof AST_RegExp?oe.RegExp[n]&&!e.value.global:void 0)}(a,c.property))){var u=is_lhs(r,c);if(u)return u;if(0!=o||!a||!a.is_constant()){if(c instanceof AST_Array)return t(e,i,c,c,o+1);if(c instanceof AST_Assign)switch(c.operator){case"=":return t(e,i,c,a,o+1,s,f);case"&&=":case"||=":case"??=":return t(e,i,c,c,o+1);default:return}if(c instanceof AST_Binary){if(!X[c.operator])return;return t(e,i,c,c,o+1)}if(c instanceof AST_Call)return!s&&c.expression===r&&!c.is_expr_pure(e)&&(!(a instanceof AST_LambdaExpression)||!(c instanceof AST_New)&&a.contains_this());if(c instanceof AST_Conditional){if(c.condition===r)return;return t(e,i,c,c,o+1)}if(c instanceof AST_ForEnumeration)return c.init===r;if(c instanceof AST_ObjectKeyVal){if(c.value!==r)return;var l=i.parent(o+1);return t(e,i,l,l,o+2)}if(c instanceof AST_PropAccess){if(c.expression!==r)return;var _=n(a,c);return(!s||f)&&t(e,i,c,_,o+1)}if(c instanceof AST_Sequence){if(c.tail_node()!==r)return;return t(e,i,c,a,o+1,s,f)}}}}function r(e){return e instanceof AST_Class||e instanceof AST_Lambda}function a(e){return e instanceof AST_Class||e instanceof AST_Defun||e instanceof AST_Function}function o(e){return"arguments"==e.name&&e.scope.uses_arguments}function s(e,n){do{if(e===n)return!1;if(n instanceof AST_Scope)return!0}while(n=n.parent_scope)}function f(e,n,t){var i=e.redef||e.definition();return(!e.in_arg||!is_funarg(i))&&all(i.orig,(function(e){return e instanceof AST_SymbolConst||e instanceof AST_SymbolLet?e instanceof AST_SymbolImport||n&&Fe(n,e):!(t&&e instanceof AST_SymbolLambda)}))}function c(e,n,t,i){return i instanceof AST_Assign?"="==i.operator&&i.right===t:i instanceof AST_Call?i.expression!==t||i instanceof AST_New:i instanceof AST_ClassField?i.value===t&&!i.static:i instanceof AST_Exit?i.value===t&&n.resolve()!==e.scope.resolve():i instanceof AST_VarDef?i.value===t:void 0}function u(e,n){var t=k(AST_SymbolRef,e);return t.fixed=n||k(AST_Undefined,e),t}function l(e,n){return function(t){var i=e(t),r=(t=u(i,n),i.definition());return r.references.push(t),r.replaced++,t}}e(AST_Node,(function(e,n){return e})),AST_Toplevel.DEFMETHOD("hoist_exports",(function(e){if(e.option("hoist_exports")){for(var n=this.body,t=[],i=0;i<n.length;i++){var r=n[i];r instanceof AST_ExportDeclaration?(n[i]=r=r.body,r instanceof AST_Definitions?r.definitions.forEach((function(e){e.name.match_symbol(a,!0)})):a(r.name)):r instanceof AST_ExportReferences&&(n.splice(i--,1),[].push.apply(t,r.properties))}t.length&&n.push(k(AST_ExportReferences,this,{properties:t}))}function a(e){if(e instanceof AST_SymbolDeclaration){var n=k(AST_SymbolExport,e);n.alias=k(AST_String,n,{value:n.name}),t.push(n)}}})),AST_Scope.DEFMETHOD("process_expression",(function(e,n){var t=this,i=new TreeTransformer((function(r){if(e){if(r instanceof AST_Directive&&(r=k(AST_SimpleStatement,r,{body:k(AST_String,r)})),r instanceof AST_SimpleStatement)return n?n(r):k(AST_Return,r,{value:r.body})}else if(r instanceof AST_Return){if(n)return n(r);var a=r.value;return a instanceof AST_String?k(AST_Directive,a):k(AST_SimpleStatement,r,{body:a||k(AST_UnaryPrefix,r,{operator:"void",expression:k(AST_Number,r,{value:0})})})}if(r instanceof AST_Block){if(r instanceof AST_Lambda){if(r!==t)return r}else if("awaits"===e&&r instanceof AST_Try&&r.bfinally)return r;for(var o=r.body.length;--o>=0;){var s=r.body[o];if(!W(s,!0)){r.body[o]=s.transform(i);break}}}else r instanceof AST_If?(r.body=r.body.transform(i),r.alternative&&(r.alternative=r.alternative.transform(i))):r instanceof AST_With&&(r.body=r.body.transform(i));return r}));t.transform(i)})),AST_Toplevel.DEFMETHOD("unwrap_expression",(function(){var e=this;switch(e.body.length){case 0:return k(AST_UnaryPrefix,e,{operator:"void",expression:k(AST_Number,e,{value:0})});case 1:var n=e.body[0];if(n instanceof AST_Directive)return k(AST_String,n);if(n instanceof AST_SimpleStatement)return n.body;default:return k(AST_Call,e,{expression:k(AST_Function,e,{argnames:[],body:e.body}).init_vars(e),args:[]})}})),AST_Node.DEFMETHOD("wrap_expression",(function(){var e=this;return is_statement(e)||(e=k(AST_SimpleStatement,e,{body:e})),e instanceof AST_Toplevel||(e=k(AST_Toplevel,e,{body:[e]})),e}));var _=/^(0|[1-9][0-9]*)$/;function S(e){e._squeezed=!1,e._optimized=!1,e instanceof AST_BlockScope&&(e._var_names=void 0),e instanceof AST_SymbolRef&&(e.fixed=void 0)}function p(e,n){return this.transform(new TreeTransformer((function(t,i){return t instanceof AST_DefaultValue?((t=t.clone()).name=t.name.transform(this),t):t instanceof AST_Destructured?(i(t=t.clone(),this),t):t instanceof AST_DestructuredKeyVal?((t=t.clone()).value=t.value.transform(this),t):t.convert_symbol(e,n)})))}function d(e,n){var t=k(e,this);return n(t,this)||t}function T(e){var n=e.definition();n.assignments++,n.references.push(e)}function A(e,n){var t=new TreeWalker((function(i){return i instanceof AST_DefaultValue?(i.value.walk(n),i.name.walk(t),!0):i instanceof AST_DestructuredKeyVal?(i.key instanceof AST_Node&&i.key.walk(n),i.value.walk(t),!0):e(i)}));this.walk(t)}function h(e){return e(this)}function v(e,n){var t=!1,i=new TreeWalker((function(r){return!!t||(r instanceof AST_DefaultValue?n?(r.name.walk(i),!0):t=!0:r instanceof AST_DestructuredKeyVal?!n&&r.key instanceof AST_Node?t=!0:(r.value.walk(i),!0):e(r)?t=!0:void 0)}));return this.walk(i),t}function m(e){return e instanceof AST_AsyncGeneratorDefun||e instanceof AST_AsyncGeneratorFunction}function y(e){var n=0,t=e.self();do{if(t.variables)return t}while(t=e.parent(n++))}function g(e,n,t,i,r,a){for(var o;o=e.parent(n++);t=o){if(o===i)return!1;if(a&&o instanceof AST_Lambda){if(o.name||is_async(o)||is_generator(o))return!0}else if(o instanceof AST_Try){if(o.bfinally&&o.bfinally!==t)return!0;if(r&&o.bcatch&&o.bcatch!==t)return!0}}return!1}!function(e){function i(e,n,t){t.assignments=0,t.bool_return=0,t.drop_return=0,t.cross_loop=!1,t.direct_access=!1,t.escaped=[],t.fixed=!t.const_redefs&&!t.scope.pinned()&&!n.exposed(t)&&!(t.init instanceof AST_LambdaExpression&&t.init!==t.scope)&&t.init,t.reassigned=0,t.recursive_refs=0,t.references=[],t.single_use=void 0}function a(e,n,t){t.variables.each((function(e){i(0,n,e)}))}function p(e,n,t){t.fn_defs=[],t.variables.each((function(r){i(0,n,r);var a=r.init;a instanceof AST_LambdaDefinition&&(t.fn_defs.push(a),a.safe_ids=null),null===r.fixed?(r.safe_ids=e.safe_ids,g(e,r)):r.fixed&&(e.loop_ids[r.id]=e.in_loop,g(e,r))})),t.may_call_this=function(){t.may_call_this=t.contains_this()?return_true:return_false},t.uses_arguments&&t.each_argname((function(e){e.definition().last_ref=!1})),n.option("ie")&&t.variables.each((function(e){var n=e.orig[0].definition();n!==e&&(n.fixed=!1)}))}function d(e,n){var t=n.safe_ids;return void 0===t||t===e.safe_ids}function T(e,n){var t=e.fn_scanning;e.fn_scanning=n,n.walk(e),e.fn_scanning=t}function A(e,n){n.enclosed.forEach((function(t){if(n.variables.get(t.name)!==t&&!x(e,t)){t.single_use=!1;var i=t.fixed;"function"==typeof i&&(i=i()),i instanceof AST_Lambda&&void 0!==i.safe_ids||(t.fixed=!1)}}))}function h(e,n,t){var i=t.safe_ids;if(void 0!==i&&!1!==i)if(t.parent_scope.resolve().may_call_this===return_true)member(t,e.fn_visited)&&A(e,t);else if(i){var r=member(t,e.fn_visited);i===e.safe_ids?r||T(e,t):r?A(e,t):t.safe_ids=!1}else e.fn_scanning&&e.fn_scanning!==n.scope.resolve()?t.safe_ids=!1:(t.safe_ids=e.safe_ids,T(e,t))}function v(e,n){var t=n.fn_defs,i=n.may_call_this===return_true?t:t.filter((function(n){return!1===n.safe_ids||(n.safe_ids=e.safe_ids,T(e,n),!1)}));y(e),i.forEach((function(n){n.safe_ids=e.safe_ids,T(e,n)})),t.forEach((function(e){e.safe_ids=void 0})),n.fn_defs=void 0,n.may_call_this=void 0}function m(e,n){var t=Object.create(e.safe_ids);n||(t.seq={}),e.safe_ids=t}function y(e){e.safe_ids=Object.getPrototypeOf(e.safe_ids)}function g(e,n){e.safe_ids[n.id]={}}function b(e,n){e.references.push(n),!1!==e.last_ref&&(e.last_ref=n)}function x(e,n){if("m"==n.single_use)return!1;var t=e.safe_ids[n.id];if(t){var i=HOP(e.safe_ids,n.id);if(!i){var r=e.safe_ids.seq;t.read?t.read!==r&&(t.read=!0):t.read=r}return null==n.fixed?!o(n)&&((!n.global||"arguments"!=n.name)&&(e.loop_ids[n.id]=null,n.fixed=k(AST_Undefined,n.orig[0]),i&&(n.safe_ids=void 0),!0)):!t.assign||t.assign===e.safe_ids}return n.fixed instanceof AST_LambdaDefinition}function E(e,n,t){if(!t){if(is_funarg(n)&&n.scope.uses_arguments&&!e.has_directive("use strict"))return!1;if(!all(n.orig,(function(e){return!(e instanceof AST_SymbolConst)})))return!1}if(void 0===n.fixed)return t||all(n.orig,(function(e){return!(e instanceof AST_SymbolLet)}));if(!1===n.fixed||0===n.fixed)return!1;var i=e.safe_ids[n.id];if(n.safe_ids)return n.safe_ids[n.id]=!1,n.safe_ids=void 0,null===n.fixed||HOP(e.safe_ids,n.id)&&!i.read;if(!HOP(e.safe_ids,n.id)){if(!i)return!1;if(i.read||e.in_loop){var r=e.find_parent(AST_BlockScope);if(r instanceof AST_Class)return!1;if(n.scope.resolve()!==r.resolve())return!1}i.assign=!(!i.assign||i.assign===e.safe_ids)||e.safe_ids}if(null!=n.fixed&&i.read){if(i.read!==e.safe_ids.seq)return!1;if(e.loop_ids[n.id]!==e.in_loop)return!1}return x(e,n)&&all(n.orig,(function(e){return!(e instanceof AST_SymbolLambda)}))}function C(e){if(!e)return!1;if(e instanceof AST_Assign){var n=e.operator;return"="==n?C(e.right):!X[n.slice(0,-1)]}return e instanceof AST_Sequence?C(e.tail_node()):e.is_constant()||r(e)||e instanceof AST_ObjectIdentity}function N(e,t,i,r,a,o,s){var f=e.parent(o);if(!a||!a.is_constant()){if(c(t,i,r,f))return t.escaped.push(f),!(s>1)||a&&a.is_constant_expression(i)||(s=1),(!t.escaped.depth||t.escaped.depth>s)&&(t.escaped.depth=s),t.scope.resolve()!==i.resolve()&&(t.escaped.cross_scope=!0),void(t.fixed&&(t.fixed.escaped=t.escaped));if(function(e,n){return n instanceof AST_Array||(n instanceof AST_Binary?X[n.operator]:n instanceof AST_Conditional?n.condition!==e:n instanceof AST_Sequence?n.tail_node()===e:n instanceof AST_Spread||void 0)}(r,f))N(e,t,i,f,f,o+1,s);else if(f instanceof AST_ObjectKeyVal&&f.value===r){var u=e.parent(o+1);N(e,t,i,u,u,o+2,s)}else if(f instanceof AST_PropAccess&&f.expression===r&&(N(e,t,i,f,a=n(a,f),o+1,s+1),a))return;o>0||f instanceof AST_Call&&f.expression===r||f instanceof AST_Sequence&&f.tail_node()!==r||f instanceof AST_SimpleStatement||f instanceof AST_Unary&&!unary_side_effects[f.operator]||(t.direct_access=!0,t.fixed&&(t.fixed.direct_access=!0))}}function R(e){if(e instanceof AST_Sub){var n=e.expression;if(n instanceof AST_SymbolRef){var t=n.definition();if(o(t)){var i=e.property;i.is_constant()&&(i=i.value),(i instanceof AST_Node||_.test(i))&&(t.reassigned++,(i instanceof AST_Node?t.scope.argnames:[t.scope.argnames[i]]).forEach((function(e){e instanceof AST_SymbolFunarg&&(e.definition().fixed=!1)})))}}}}function B(e,n){var t,i;return function(){var r=e();return t!==r&&(t=r,i=n(r)),i}}function O(e,n,t,i,r){var a=new TreeWalker((function(t){if(t instanceof AST_DefaultValue)return S(t),m(e,!0),t.value.walk(e),y(e),(s=i)&&(i=function(e,n,t){var i,r;return function(){if(r===n)return n;var a=t(),o=Ce(e,a,!0);return o instanceof AST_Node?r=n:i!==a&&(i=a,r=void 0===o?w(n,[a,n.value]):a),r}}(n,t,s)),t.name.walk(a),i=s,!0;if(t instanceof AST_DestructuredArray){S(t);var o,s=i;if(t.elements.forEach((function(e,n){if(e instanceof AST_Hole)return S(e);s&&(i=B(s,(function(t){return k(AST_Sub,e,{expression:t,property:k(AST_Number,e,{value:n})})}))),e.walk(a)})),t.rest)s&&(i=n.option("rests")&&B(s,(function(e){if(!(e instanceof AST_Array))return t;for(var n=0,i=t.elements.length;n<i;n++)if(e.elements[n]instanceof AST_Spread)return t;return o||(o=k(AST_Array,t,{})),o.elements=e.elements.slice(i),o}))),t.rest.walk(a);return i=s,!0}if(t instanceof AST_DestructuredObject){S(t);s=i;return t.properties.forEach((function(n){S(n),n.key instanceof AST_Node&&(m(e),n.key.walk(e),y(e)),s&&(i=B(s,(function(e){var t=n.key,i=AST_Sub;return"string"==typeof t&&(is_identifier_string(t)?i=AST_Dot:t=D(t,n)),k(i,n,{expression:e,property:t})}))),n.value.walk(a)})),t.rest&&(i=!1,t.rest.walk(a)),i=s,!0}return r(t,i,(function(){for(var n=e.stack.length,i=0,r=a.stack.length-1;i<r;i++)e.stack.push(a.stack[i]);t.walk(e),e.stack.length=n})),!0}));t.walk(a)}function P(e,n,t){var i=this;i.inlined=!1;var r=e.parent(),a=!is_async(i)&&!is_generator(i),o=!a,s=!1;i.walk(new TreeWalker((function(e){return o?s=!0:e instanceof AST_Return?o=!0:e instanceof AST_Scope&&e!==i||void 0}))),s&&m(e,a),p(e,t,i);var f=!i.uses_arguments||e.has_directive("use strict");i.argnames.forEach((function(n,a){var o=r.args[a];O(e,t,n,(function(){var e=i.argnames.indexOf(n),t=e<0?o:r.args[e];return t instanceof AST_Sequence&&t.expressions.length<2&&(t=t.expressions[0]),t||k(AST_Undefined,r)}),_)}));var c,u=i.rest;u&&O(e,t,u,t.option("rests")&&function(){return i.rest!==u?u:(c||(c=k(AST_Array,i,{})),c.elements=r.args.slice(i.argnames.length),c)},_),walk_lambda(i,e);var l=e.safe_ids;return v(e,i),s||(e.safe_ids=l),!0;function _(n,t){var i=n.definition();t&&f&&void 0===i.fixed?(g(e,i),e.loop_ids[i.id]=e.in_loop,i.fixed=t,i.fixed.assigns=[n]):i.fixed=!1}}e(AST_Node,noop),e(AST_Assign,(function(e,n,i){var r=this,a=r.left,o=r.right,s=a instanceof AST_SymbolRef&&a.definition(),f=s||a instanceof AST_Destructured;switch(r.operator){case"=":return a.equals(o)&&!a.has_side_effects(i)?(o.walk(e),function n(t){if(S(t),t instanceof AST_Dot)n(t.expression);else if(t instanceof AST_Sub)n(t.expression),t.property.walk(e);else if(t instanceof AST_SymbolRef){var i=t.definition();b(i,t),i.fixed&&(t.fixed=i.fixed,t.fixed.assigns?t.fixed.assigns.push(r):t.fixed.assigns=[r])}else t.walk(e)}(a),r.redundant=!0,!0):s&&o instanceof AST_LambdaExpression?(d(),o.parent_scope.resolve().fn_defs.push(o),o.safe_ids=null,s.fixed&&r.write_only||h(e,s,o),!0):f?(o.walk(e),d(),!0):void R(a);case"&&=":case"||=":case"??=":var c=!0;default:if(!f)return R(a),T();s.assignments++;var _=s.fixed;if(t(i,e,r,r,0))return s.fixed=!1,T();var p=x(e,s);return c&&m(e,!0),o.walk(e),c&&y(e),p&&!a.in_arg&&E(e,s)?(b(s,a),g(e,s),s.single_use&&(s.single_use=!1),a.fixed=s.fixed=function(){return k(AST_Binary,r,{operator:r.operator.slice(0,-1),left:u(a,_),right:r.right})},a.fixed.assigns=_&&_.assigns?_.assigns.slice():[s.orig[0]],a.fixed.assigns.push(r),a.fixed.to_binary=l((function(e){return e.left}),_)):(a.walk(e),s.fixed=!1),!0}function d(){var n=s&&en(e,s),f=t(i,e,r,o,0,C(o),n);O(e,i,a,(function(){return r.right}),(function(n,t,i){if(!(n instanceof AST_SymbolRef))return R(n),void i();var s=n.definition();s.assignments++,t&&!n.in_arg&&E(e,s)?(b(s,n),g(e,s),(a instanceof AST_Destructured||1==s.orig.length&&s.orig[0]instanceof AST_SymbolDefun)&&(s.single_use=!1),e.loop_ids[s.id]=e.in_loop,s.fixed=f?0:t,n.fixed=t,n.fixed.assigns=[r],N(e,s,n.scope,r,o,0,1)):(i(),s.fixed=!1)}))}function T(){if(c)return a.walk(e),m(e,!0),o.walk(e),y(e),!0}})),e(AST_Binary,(function(e){if(X[this.operator])return this.left.walk(e),m(e,!0),this.right.walk(e),y(e),!0})),e(AST_BlockScope,(function(e,n,t){a(0,t,this)})),e(AST_Call,(function(e,n){var t=this,i=t.expression;if(i instanceof AST_LambdaExpression){var r=j(t);return t.args.forEach((function(n){n.walk(e),n instanceof AST_Spread&&(r=!1)})),r&&(i.reduce_vars=P),i.walk(e),r&&delete i.reduce_vars,!0}if("Call"==t.TYPE)switch(e.in_boolean_context()){case"d":var a=!0;case!0:!function e(n,t){if(n instanceof AST_Assign){if("="!=n.operator)return;e(n.left,t),e(n.right,t)}else if(n instanceof AST_Binary){if(!X[n.operator])return;e(n.left,t),e(n.right,t)}else if(n instanceof AST_Conditional)e(n.consequent,t),e(n.alternative,t);else if(n instanceof AST_SymbolRef){var i=n.definition();i.bool_return++,t&&i.drop_return++}}(i,a)}i.walk(e);var o=t.optional;o&&m(e,!0),t.args.forEach((function(n){n.walk(e)})),o&&y(e);var s=i instanceof AST_SymbolRef&&i.fixed_value();return s instanceof AST_Lambda?h(e,i.definition(),s):e.find_parent(AST_Scope).may_call_this(),!0})),e(AST_Class,(function(e,n,t){var i=this;a(0,t,i),i.extends&&i.extends.walk(e);var r=i.properties.filter((function(n){return S(n),n.key instanceof AST_Node&&(e.push(n),n.key.walk(e),e.pop()),n.value}));if(i.name){var o=i.name.definition(),s=e.parent();(s instanceof AST_ExportDeclaration||s instanceof AST_ExportDefault)&&(o.single_use=!1),E(e,o,!0)?(g(e,o),e.loop_ids[o.id]=e.in_loop,o.fixed=function(){return i},o.fixed.assigns=[i],Be(o)||(o.single_use=!1)):o.fixed=!1}return r.forEach((function(n){e.push(n),!n.static||M(n)&&n.value.contains_this()?(m(e),n.value.walk(e),y(e)):n.value.walk(e),e.pop()})),!0})),e(AST_ClassInitBlock,(function(e,n,t){return m(e,!0),p(e,t,this),n(),v(e,this),!0})),e(AST_Conditional,(function(e){return this.condition.walk(e),m(e,!0),this.consequent.walk(e),y(e),m(e,!0),this.alternative.walk(e),y(e),!0})),e(AST_DefaultValue,(function(e){return m(e,!0),this.value.walk(e),y(e),this.name.walk(e),!0})),e(AST_Do,(function(e){var n=e.in_loop;return e.in_loop=this,m(e),this.body.walk(e),we(this,e.parent())&&(y(e),m(e)),this.condition.walk(e),y(e),e.in_loop=n,!0})),e(AST_For,(function(e,n,t){var i=this;a(0,t,i),i.init&&i.init.walk(e);var r=e.in_loop;return e.in_loop=i,m(e),i.condition&&i.condition.walk(e),i.body.walk(e),i.step&&(we(i,e.parent())&&(y(e),m(e)),i.step.walk(e)),y(e),e.in_loop=r,!0})),e(AST_ForEnumeration,(function(e,n,t){var i=this;a(0,t,i),i.object.walk(e);var r=e.in_loop;e.in_loop=i,m(e);var o=i.init;return o instanceof AST_Definitions?o.definitions[0].name.mark_symbol((function(e){if(e instanceof AST_SymbolDeclaration){var n=e.definition();n.assignments++,n.fixed=!1}}),e):o instanceof AST_Destructured||o instanceof AST_SymbolRef?o.mark_symbol((function(e){if(e instanceof AST_SymbolRef){var n=e.definition();b(n,e),n.assignments++,e.is_immutable()||(n.fixed=!1)}}),e):o.walk(e),i.body.walk(e),y(e),e.in_loop=r,!0})),e(AST_If,(function(e){return this.condition.walk(e),m(e,!0),this.body.walk(e),y(e),this.alternative&&(m(e,!0),this.alternative.walk(e),y(e)),!0})),e(AST_LabeledStatement,(function(e){return m(e,!0),this.body.walk(e),y(e),!0})),e(AST_Lambda,(function(e,n,t){var i=this;return!d(e,i)||(!push_uniq(e.fn_visited,i)||(i.inlined=!1,m(e),p(e,t,i),n(),v(e,i),i.name&&N(e,i.name.definition(),i,i.name,i,0,1),!0))})),e(AST_LambdaDefinition,(function(e,n,t){var i=this,r=i.name.definition(),a=e.parent();return(a instanceof AST_ExportDeclaration||a instanceof AST_ExportDefault)&&(r.single_use=!1),!d(e,i)||(!push_uniq(e.fn_visited,i)||(i.inlined=!1,m(e),p(e,t,i),n(),v(e,i),!0))})),e(AST_Sub,(function(e){if(this.optional)return this.expression.walk(e),m(e,!0),this.property.walk(e),y(e),!0})),e(AST_Switch,(function(e,n,t){var i=this;a(0,t,i),i.expression.walk(e);var r=!0;return i.body.forEach((function(n){n instanceof AST_Default||(n.expression.walk(e),r&&(r=!1,m(e,!0)))})),r||y(e),walk_body(i,e),!0})),e(AST_SwitchBranch,(function(e){return m(e,!0),walk_body(this,e),y(e),!0})),e(AST_SymbolCatch,(function(){this.definition().fixed=!1})),e(AST_SymbolImport,(function(){this.definition().fixed=!1})),e(AST_SymbolRef,(function(e,n,i){var a=this,o=a.definition(),f=o.fixed||o.last_ref&&o.last_ref.fixed;b(o,a),1==o.references.length&&!o.fixed&&o.orig[0]instanceof AST_SymbolDefun&&(e.loop_ids[o.id]=e.in_loop);var c,u=en(e,o);switch(u&&u.enclosed.forEach((function(n){if(o!==n&&n.scope.resolve()!==u){var t=n.fixed&&n.fixed.assigns;if(t&&!(t[t.length-1]instanceof AST_VarDef)){var i=e.safe_ids[n.id];i&&(i.assign=!0)}}})),"m"==o.single_use&&o.fixed&&(o.fixed=0,o.single_use=!1),o.fixed){case 0:x(e,o)||(o.fixed=!1);case!1:var l=o.redefined();l&&s(o.scope,a.scope)&&(l.single_use=!1);break;case void 0:o.fixed=!1;break;default:if(!x(e,o)){o.fixed=!1;break}a.in_arg&&o.orig[0]instanceof AST_SymbolLambda&&(a.fixed=o.scope);var _=a.fixed_value();u?o.recursive_refs++:_&&function(e,n){return e.option("unused")&&!n.scope.pinned()&&!1!==n.single_use&&n.references.length-n.recursive_refs==1&&!(is_funarg(n)&&n.scope.uses_arguments)}(i,o)?(o.in_loop=e.loop_ids[o.id]!==e.in_loop,o.single_use=r(_)&&!_.pinned()&&(!o.in_loop||e.parent()instanceof AST_Call)||!o.in_loop&&o.scope===a.scope.resolve()&&_.is_constant_expression()):o.single_use=!1,t(i,e,a,_,0,C(_),u)&&(o.single_use?o.single_use="m":o.fixed=0),o.fixed&&e.loop_ids[o.id]!==e.in_loop&&(o.cross_loop=!0),N(e,o,a.scope,a,_,0,1)}a.fixed||(a.fixed=0===o.fixed?f:o.fixed),_ instanceof AST_Lambda&&!((c=e.parent())instanceof AST_Call&&c.expression===a)&&h(e,o,_)})),e(AST_Template,(function(e,n){var t=this,i=t.tag;if(i){if(i instanceof AST_LambdaExpression)return t.expressions.forEach((function(n){n.walk(e)})),i.walk(e),!0;i.walk(e),t.expressions.forEach((function(n){n.walk(e)}));var r=i instanceof AST_SymbolRef&&i.fixed_value();return r instanceof AST_Lambda?h(e,i.definition(),r):e.find_parent(AST_Scope).may_call_this(),!0}})),e(AST_Toplevel,(function(e,n,t){var r=this;return r.globals.each((function(e){i(0,t,e)})),m(e,!0),p(e,t,r),n(),v(e,r),!0})),e(AST_Try,(function(e,n,t){var i=this;return a(0,t,i),m(e,!0),walk_body(i,e),y(e),i.bcatch&&(m(e,!0),i.bcatch.walk(e),y(e)),i.bfinally&&i.bfinally.walk(e),!0})),e(AST_Unary,(function(e,n){var t=this;if(UNARY_POSTFIX[t.operator]){var i=t.expression;if(i instanceof AST_SymbolRef){var r=i.definition();r.assignments++;var a=r.fixed;return x(e,r)&&!i.in_arg&&E(e,r)?(b(r,i),g(e,r),r.single_use&&(r.single_use=!1),r.fixed=function(){return k(AST_Binary,t,{operator:t.operator.slice(0,-1),left:k(AST_UnaryPrefix,t,{operator:"+",expression:u(i,a)}),right:k(AST_Number,t,{value:1})})},r.fixed.assigns=a&&a.assigns?a.assigns.slice():[],r.fixed.assigns.push(t),t instanceof AST_UnaryPrefix?i.fixed=r.fixed:(i.fixed=function(){return k(AST_UnaryPrefix,t,{operator:"+",expression:u(i,a)})},i.fixed.assigns=a&&a.assigns,i.fixed.to_prefix=l((function(e){return e.expression}),r.fixed))):(i.walk(e),r.fixed=!1),!0}R(i)}})),e(AST_VarDef,(function(e,n,t){var i=this,r=i.value;if(r instanceof AST_LambdaExpression&&i.name instanceof AST_SymbolDeclaration){o(),r.parent_scope.resolve().fn_defs.push(r),r.safe_ids=null;var a=i.name.definition();a.fixed||h(e,a,r)}else r?(r.walk(e),o()):e.parent()instanceof AST_Let&&o();return!0;function o(){O(e,t,i.name,(function(){return i.value||k(AST_Undefined,i)}),(function(n,t){var r=n.definition();t&&E(e,r,!0)?(g(e,r),e.loop_ids[r.id]=e.in_loop,r.fixed=t,r.fixed.assigns=[i],(n instanceof AST_SymbolConst&&r.redefined()||!f(n)&&!Be(r))&&(r.single_use=!1)):r.fixed=!1}))}})),e(AST_While,(function(e,n){var t=e.in_loop;return e.in_loop=this,m(e),n(),y(e),e.in_loop=t,!0}))}((function(e,n){e.DEFMETHOD("reduce_vars",n)})),AST_Toplevel.DEFMETHOD("reset_opt_flags",(function(e){var n=new TreeWalker(e.option("reduce_vars")?function(t,i){return S(t),t.reduce_vars(n,i,e)}:S);n.fn_scanning=null,n.fn_visited=[],n.in_loop=null,n.loop_ids=Object.create(null),n.safe_ids=Object.create(null),n.safe_ids.seq={},this.walk(n)})),AST_Symbol.DEFMETHOD("fixed_value",(function(e){var n=this.definition(),t=n.fixed;if(t)return this.fixed&&(t=this.fixed),(t instanceof AST_Node?t:t()).tail_node();if(!(t=0===t&&this.fixed))return t;var i=(t instanceof AST_Node?t:t()).tail_node();return e&&1!=n.escaped.depth&&Ge(i,!0)||i.is_constant()?i:void 0})),AST_SymbolRef.DEFMETHOD("is_immutable",(function(){var e=this.redef||this.definition();return e.orig[0]instanceof AST_SymbolLambda&&(1==e.orig.length||!!this.in_arg&&!(e.orig[1]instanceof AST_SymbolFunarg))})),AST_Node.DEFMETHOD("convert_symbol",noop),AST_DefaultValue.DEFMETHOD("convert_symbol",p),AST_Destructured.DEFMETHOD("convert_symbol",p),AST_SymbolDeclaration.DEFMETHOD("convert_symbol",d),AST_SymbolRef.DEFMETHOD("convert_symbol",d),AST_DefaultValue.DEFMETHOD("mark_symbol",A),AST_Destructured.DEFMETHOD("mark_symbol",A),AST_SymbolDeclaration.DEFMETHOD("mark_symbol",h),AST_SymbolRef.DEFMETHOD("mark_symbol",h),AST_Node.DEFMETHOD("match_symbol",(function(e){return e(this)})),AST_DefaultValue.DEFMETHOD("match_symbol",v),AST_Destructured.DEFMETHOD("match_symbol",v);var b=makePredicate("Infinity NaN undefined");function x(e,n){if(e instanceof AST_Atom)return!0;if(e instanceof AST_ObjectIdentity)return!0;if(e instanceof AST_PropAccess){if("__proto__"===e.property)return!0;if((e=e.expression)instanceof AST_SymbolRef){if(e.is_immutable())return!1;e=e.fixed_value()}return!e||(!!e.tail_node().is_constant()||x(e,n))}if(e instanceof AST_SymbolRef){if(e.is_immutable())return!0;var t=e.definition();return n.exposed(t)&&b[t.name]}return!1}function k(e,n,t){return t?(t.start=n.start,t.end=n.end):t=n,new e(t)}function w(e,n){return 1==n.length?n[0]:k(AST_Sequence,e,{expressions:n.reduce(R,[])})}function D(e,n){switch(typeof e){case"string":return k(AST_String,n,{value:e});case"number":return isNaN(e)?k(AST_NaN,n):isFinite(e)?1/e<0?k(AST_UnaryPrefix,n,{operator:"-",expression:k(AST_Number,n,{value:-e})}):k(AST_Number,n,{value:e}):e<0?k(AST_UnaryPrefix,n,{operator:"-",expression:k(AST_Infinity,n)}):k(AST_Infinity,n);case"boolean":return k(e?AST_True:AST_False,n);case"undefined":return k(AST_Undefined,n);default:if(null===e)return k(AST_Null,n);if(e instanceof RegExp)return k(AST_RegExp,n,{value:e});throw new Error(string_template("Can't handle constant of type: {type}",{type:typeof e}))}}function E(e){return e instanceof AST_PropAccess||L(e)&&"eval"==e.name}function C(e,n,t){var i=!1;return"Call"==e.TYPE?i=e.expression===n&&E(t):e instanceof AST_Template?i=e.tag===n&&E(t):e instanceof AST_UnaryPrefix&&(i="delete"==e.operator||"typeof"==e.operator&&L(t)),i?w(n,[k(AST_Number,n,{value:0}),t]):t}function N(e,n){var t=new Dictionary;return e.walk(new TreeWalker((function(e){if(e instanceof AST_SymbolRef){var n=e.definition(),i=e.fixed;i&&t.has(n.id)?t.get(n.id)!==i&&t.set(n.id,!1):t.set(n.id,i)}}))),t.size()>0&&n.walk(new TreeWalker((function(e){if(e instanceof AST_SymbolRef){var n=e.definition(),i=e.fixed;i&&t.has(n.id)&&t.get(n.id)!==i&&(e.fixed=!1)}}))),n}function R(e,n){return n instanceof AST_Sequence?[].push.apply(e,n.expressions):e.push(n),e}function B(e){return e instanceof AST_Const||e instanceof AST_DefClass||e instanceof AST_Let}function O(e){if(e instanceof AST_LambdaDefinition){var n=e.name.definition(),t=e.name.scope;return n.scope===t||all(n.references,(function(e){var n=e.scope;do{if(n===t)return!0}while(n=n.parent_scope)}))}return!B(e)}function P(e){if(null===e)return[];if(e instanceof AST_BlockStatement)return all(e.body,O)?e.body:[e];if(e instanceof AST_EmptyStatement)return[];if(is_statement(e))return[e];throw new Error("Can't convert thing to statement array")}function F(e){return null===e||(e instanceof AST_EmptyStatement||e instanceof AST_BlockStatement&&0==e.body.length)}function q(e){return all(e.body,(function(e){return F(e)||e instanceof AST_Defun||e instanceof AST_Var&&H(e)}))}function U(e){return e instanceof AST_IterationStatement&&e.body instanceof AST_BlockStatement?e.body:e}function z(e){if("Call"!=e.TYPE)return!1;do{e=e.expression}while(e instanceof AST_PropAccess);return e instanceof AST_LambdaExpression?!is_arrow(e):z(e)}function j(e){var n=e.expression;if(n.name)return!1;if(!(e instanceof AST_New))return!0;var t=!1;return n.walk(new TreeWalker((function(e){return!!t||(e instanceof AST_NewTarget?t=!0:e instanceof AST_Scope&&e!==n||void 0)}))),!t}function L(e){return e instanceof AST_SymbolRef&&e.definition().undeclared}var V,I=makePredicate("Array Boolean clearInterval clearTimeout console Date decodeURI decodeURIComponent encodeURI encodeURIComponent Error escape eval EvalError Function isFinite isNaN JSON Map Math Number parseFloat parseInt RangeError ReferenceError RegExp Object Set setInterval setTimeout String SyntaxError TypeError unescape URIError WeakMap WeakSet");function M(e){return e.static&&e.value&&(e instanceof AST_ClassField||e instanceof AST_ClassInit)}function H(e){return all(e.definitions,(function(e){return!e.value}))}function W(e,n){return e instanceof AST_DefClass?n&&!e.extends&&all(e.properties,(function(e){return!(e.key instanceof AST_Node)&&!M(e)})):e instanceof AST_Definitions?(n||e instanceof AST_Var)&&H(e):e instanceof AST_ExportDeclaration||e instanceof AST_ExportDefault?W(e.body,n):e instanceof AST_LambdaDefinition}function Y(e,n){var t=e.lastIndexOf(n);if(t<0)return!1;for(;++t<e.length;)if(!W(e[t],!0))return!1;return!0}function K(e,n){var t;if(e.init instanceof AST_BlockStatement&&(t=e.init,e.init=t.body.pop(),t.body.push(e)),e.init instanceof AST_Defun?(t||(t=k(AST_BlockStatement,e,{body:[e]})),t.body.splice(-1,0,e.init),e.init=null):e.init instanceof AST_SimpleStatement?e.init=e.init.body:F(e.init)&&(e.init=null),t)return n?List.splice(t.body):t}function G(e,n){var i,r,s,u,l,_,S=A(n,(function(e){return e instanceof AST_Lambda}));!function(){var e=n.self(),t=0;do{if(!i&&e.variables&&(i=e),e instanceof AST_Catch)n.parent(t).bfinally&&(l||(l={}),l.bfinally=!0),t++;else if(e instanceof AST_Finally)t++;else if(e instanceof AST_IterationStatement)u=!0;else{if(e instanceof AST_Scope){_=e;break}e instanceof AST_Try&&(l||(l={}),e.bcatch&&(l.bcatch=!0),e.bfinally&&(l.bfinally=!0))}}while(e=n.parent(t++))}();var p,d,T=10;do{if(d=p,p=0,v(e)&&(p=1),!p&&1==d)break;if(n.option("dead_code")&&(D(e,n)&&(p=2),!p&&2==d))break;if(n.option("if_return")&&(b(e,n)&&(p=3),!p&&3==d))break;if(n.option("awaits")&&n.option("side_effects")&&(E(e,n)&&(p=4),!p&&4==d))break;if(n.option("inline")>=4&&(F(e,n)&&(p=5),!p&&5==d))break;if(n.sequences_limit>0){if(q(e,n)&&(p=6),!p&&6==d)break;if(V(e,n)&&(p=7),!p&&7==d)break}if(n.option("join_vars")&&(ie(e)&&(p=8),!p&&8==d))break;n.option("collapse_vars")&&h(e,n)&&(p=9)}while(p&&T-- >0);return e;function A(e,n){var t,i=e.self(),r=0;do{if(i instanceof AST_Catch)i=e.parent(r++);else if(i instanceof AST_LabeledStatement)i=i.body;else if(i instanceof AST_SwitchBranch){var a=e.parent(r);(a.body[a.body.length-1]===i||o(i.body))&&(r++,i=a)}do{if(n(t=i))return t;i=e.parent(r++)}while(i instanceof AST_If)}while(t&&(i instanceof AST_BlockStatement||i instanceof AST_Catch||i instanceof AST_Scope||i instanceof AST_SwitchBranch||i instanceof AST_Try)&&Y(i.body,t));function o(e){for(var n=e.length;--n>=0;)if(e[n]instanceof AST_Break)return!0;return!1}}function h(e,n){if(!_.pinned()){for(var S,p,d=new Dictionary,T=[],A=!1,h=new Dictionary,v=e.length,m=new TreeTransformer((function(e,t){if(ce)return e;if(!se)return e!==D[N]?e:++N<D.length?Te(e,m):(se=!0,(q=(F?we:be)(e,0))===e&&(ce=!0),e);var i,r,a=m.parent();if(!U&&he(e,a)&&(U=a),W&&M&&le&&!U&&e instanceof AST_Assign&&"="!=e.operator&&e.left.equals(z))return ue++,A=!0,AST_Node.info("Cascading {this} [{start}]",e),le=!1,ne=je(z),e.right.transform(m),qe(R),ce?i=R:(ce=!0,i=k(AST_Binary,R,{operator:W,left:z.fixed&&z.definition().fixed?z.fixed.to_binary(R):z,right:re})),k(AST_Assign,e,{operator:"=",left:e.left,right:k(AST_Binary,e,{operator:e.operator.slice(0,-1),left:i,right:e.right})});if(function(e,t){if(e===re)return!0;if(t instanceof AST_For&&e!==t.init)return!0;if(e instanceof AST_Assign)return"="!=e.operator&&z.equals(e.left);if(e instanceof AST_Call)return z instanceof AST_PropAccess&&(!!z.equals(e.expression)&&!(re instanceof AST_LambdaExpression&&!re.contains_this()));return e instanceof AST_Class?!n.has_directive("use strict"):e instanceof AST_Debugger||(e instanceof AST_Defun?Y&&z.name===e.name.name:e instanceof AST_DestructuredKeyVal?e.key instanceof AST_Node:e instanceof AST_DWLoop||(e instanceof AST_LoopControl||(e instanceof AST_Try||e instanceof AST_With)))}(e,a))return ce=!0,e;if(e.single_use)return e;if(!(e instanceof AST_SymbolDeclaration)&&(M&&z.equals(e)||H&&(r=H(e,this)))){if(!le||U&&(r||!te||!oe))return r||F||(ce=!0),e;if(is_lhs(e,a))return F&&!r&&(O=!0),e;if(!r&&P&&e.fixed!==z.fixed)return ce=!0,e;if(F)return U&&0==B&&(B=E-ue),r||ue++,e;if(ue++,A=ce=!0,AST_Node.info("Collapsing {this} [{start}]",e),"Binary"==R.TYPE)return Ue(R,e),k(AST_Assign,R,{operator:"=",left:R.right.left,right:"&&"==R.operator?k(AST_Conditional,R,{condition:R.left,consequent:R.right.right,alternative:e}):k(AST_Conditional,R,{condition:R.left,consequent:e,alternative:R.right.right})});if(R instanceof AST_UnaryPostfix)return k(AST_UnaryPrefix,R,{operator:R.operator,expression:z.fixed&&z.definition().fixed?z.fixed.to_prefix(R):z});if(R instanceof AST_UnaryPrefix)return qe(R),R;if(Ue(re,e),R instanceof AST_VarDef){var s=R.name.definition();return s.references.length-s.replaced!=1||n.exposed(s)?k(AST_Assign,R,{operator:"=",left:e,right:re}):(s.replaced++,C(a,e,re))}qe(re);var c=R.clone();return c.right=re,c}if(function(e,t){if(!(e instanceof AST_SymbolRef))return!1;if(e.is_declared(n)){if(e.fixed_value())return!1;if(f(e))return!(t instanceof AST_PropAccess&&t.expression===e)&&o(e.definition())}else if(Ae(e,t))return!1;return!oe||(H=!1,!1)}(e,a))return ce=!0,e;if((ve(e,a)||G(e))&&(q=e,e instanceof AST_Scope&&(ce=!0)),e instanceof AST_Accessor){var u=le;return le=!1,t(e,m),le=u,de(e)}if(e instanceof AST_Destructured){u=le;return le=!1,t(e,m),le=u,de(e)}if(e instanceof AST_DefaultValue){e.name=e.name.transform(m);u=le;return le=!1,e.value=e.value.transform(m),le=u,de(e)}if(e instanceof AST_BlockScope&&!(e instanceof AST_Scope)&&(!e.variables||!e.variables.all((function(e){return!Z.has(e.name)&&!ne.has(e.name)})))){u=le;return le=!1,Te(e,m)||t(e,m),le=u,de(e)}return Te(e,m)?de(e):void 0}),de),b=new TreeTransformer((function(e){if(ce)return e;if(!se){if(e!==D[N])return e;switch(N++,D.length-N){case 0:if(se=!0,O)return e;if(e!==R)return e;if(e instanceof AST_VarDef)return e;pe.replaced++;var n=b.parent();return n instanceof AST_Sequence&&n.tail_node()!==e?(F.replaced++,re===ie?List.skip:w(ie,ie.expressions.slice(0,-1))):re;case 1:if(!O&&e.body===R)return se=!0,pe.replaced++,F.replaced++,null;default:return Te(e,b)}}if(e instanceof AST_SymbolRef&&e.definition()===pe){if(is_lhs(e,b.parent()))return e;--ue||(ce=!0),AST_Node.info("Replacing {this} [{start}]",e);var t=re.clone();return t.scope=e.scope,t.reference(),ue==B?(ce=!0,k(AST_Assign,R,{operator:"=",left:e,right:t})):(pe.replaced++,t)}return e instanceof AST_Default||e instanceof AST_Scope?e:void 0}),(function(e){return Ve(e,b)}));--v>=0;){0==v&&n.option("unused")&&ye();var D=[];for(ge(e[v]);T.length>0;){D=T.pop();var E,N=0,R=D[D.length-1],B=-1,O=!1,P=!1,F=null,q=null,U=null,z=Ne(R),V=z&&z.has_side_effects(n),M=z&&(!V||z instanceof AST_SymbolRef)&&!x(z,n),H=Pe(R);if(M||H){var W=R instanceof AST_Assign&&R.operator.slice(0,-1),Y=R.name instanceof AST_SymbolFunarg,G=return_false;if(R.may_throw(n)){if(Y&&is_async(_))continue;G=l?function(e){return e.has_side_effects(n)}:Ke}var $=!1,Q=!1,Z=new Dictionary,ee=!0,ne=je(R),te=Ie(z),ie=Re(R),re=ie;V||(!W&&re instanceof AST_Sequence&&(re=re.tail_node()),V=Me());var ae=l||!te?function(e){return e instanceof AST_Destructured}:return_false,oe=He(R),se=Y,ce=!1,ue=0,le=!S||!se;if(!le){for(var _e=R.arg_index+1;!ce&&_e<S.length;_e++)S[_e]&&S[_e].transform(m);le=!0}for(var Se=v;!ce&&Se<e.length;Se++)e[Se].transform(m);if(F){if(!ue||E>ue+O){T.push(D),p=!0;continue}ue==B&&(O=!0);var pe=z.definition();ce=!1,N=0,se=Y;for(Se=v;!ce&&Se<e.length;Se++)e[Se].transform(b)||e.splice(Se--,1);ue=R instanceof AST_VarDef&&R===D[D.length-1]&&pe.references.length==pe.replaced&&!n.exposed(pe),F.last_ref=!1,F.single_use=!1,A=!0}ue&&Le(R)}}}return A}function de(e){return ce||(q===e&&(ce=!0),U===e&&(U=null)),e}function Te(e,n){if(e instanceof AST_BlockScope){if(e instanceof AST_Scope)return e;if(e instanceof AST_Class){e.name&&(e.name=e.name.transform(n)),!ce&&e.extends&&(e.extends=e.extends.transform(n));for(var t=[],i=[],r=0;!ce&&r<e.properties.length;r++){(a=e.properties[r]).key instanceof AST_Node&&(a.key=a.key.transform(n)),a.static&&(a instanceof AST_ClassField?a.value&&t.push(a):a instanceof AST_ClassInit&&[].push.apply(i,a.value.body))}for(r=0;!ce&&r<i.length;r++)i[r].transform(n);for(r=0;!ce&&r<t.length;r++){var a;(a=t[r]).value=a.value.transform(n)}return e}if(e instanceof AST_ForEnumeration)return e.object=e.object.transform(n),ce=!0,e;if(e instanceof AST_Switch){e.expression=e.expression.transform(n);for(r=0;!ce&&r<e.body.length;r++){var o=e.body[r];if(o instanceof AST_Case){if(!se){if(o!==D[N])continue;N++}if(o.expression=o.expression.transform(n),!oe)break;H=!1}}return ce=!0,e}}}function Ae(e,n){return n instanceof AST_Assign?"="==n.operator&&n.left===e:n instanceof AST_DefaultValue?n.name===e:n instanceof AST_DestructuredArray||(n instanceof AST_DestructuredKeyVal?n.value===e:void 0)}function he(e,n){return n instanceof AST_Assign?n.left!==e&&X[n.operator.slice(0,-1)]:n instanceof AST_Binary?n.left!==e&&X[n.operator]:n instanceof AST_Call?n.optional&&n.expression!==e:n instanceof AST_Case?n.expression!==e:n instanceof AST_Conditional||n instanceof AST_If?n.condition!==e:n instanceof AST_Sub?n.optional&&n.expression!==e:void 0}function ve(e,t){if(e instanceof AST_Await)return!0;if("Binary"==e.TYPE)return!$e(e.operator,e.right,n);if(e instanceof AST_Call){var i=e.expression;if(i instanceof AST_SymbolRef&&(T=i.definition(),i=i.fixed_value()),!(i instanceof AST_Lambda))return!e.is_expr_pure(n);if(T&&en(n,T,i))return!0;if(i.collapse_scanning)return!1;i.collapse_scanning=!0;var r=le;le=!1;for(var s=q,c=U,u=0;!ce&&u<i.argnames.length;u++)me(h,i.argnames[u],e.args[u])&&(ce=!0);if(!ce)if(i.rest&&me(h,i.rest,k(AST_Array,e,{elements:e.args.slice(u)})))ce=!0;else if(is_arrow(i)&&i.value)i.value.transform(m);else for(u=0;!ce&&u<i.body.length;u++){var S=i.body[u];if(S instanceof AST_Return){S.value&&S.value.transform(m);break}S.transform(m)}return U=c,q=s,le=r,i.collapse_scanning=!1,ce?(ce=!1,!0):!1}if(e instanceof AST_Class){if(!l)return!1;var p=e.extends;return!!p&&(p instanceof AST_SymbolRef&&(p=p.fixed_value()),!a(p))}if(e instanceof AST_Exit){if(l){if(l.bfinally)return!0;if(l.bcatch&&e instanceof AST_Throw)return!0}return V||z instanceof AST_PropAccess||Ye(z)}if(e instanceof AST_Function)return n.option("ie")&&e.name&&ne.has(e.name.name);if(e instanceof AST_ObjectIdentity)return We(e,t);if(e instanceof AST_PropAccess){if(V)return!0;var d=e.expression;if(d instanceof AST_SymbolRef&&o(d.definition()))return!0;if(n.option("unsafe")){if(L(d)&&I[d.name])return!1;if(fe(d))return!1}return!ee||!F&&(!(!l&&te)&&(!e.optional&&d.may_throw_on_access(n)))}if(e instanceof AST_Spread)return!0;if(e instanceof AST_SymbolRef){if(We(e,t))return!Ae(e,t);if(V&&Ye(e))return!0;var T=e.definition();return(l||T.scope.resolve()!==_)&&!f(e)}if(e instanceof AST_Template)return!e.is_expr_pure(n);if(e instanceof AST_VarDef)return!!ae(e.name)||(e.value||t instanceof AST_Let)&&e.name.match_symbol((function(e){return e instanceof AST_SymbolDeclaration&&(ne.has(e.name)||V&&Ye(e))}),!0);if(e instanceof AST_Yield)return!0;var A=is_lhs(e.left,e);return!!A&&(A instanceof AST_PropAccess||(!!ae(A)||A.match_symbol((function(e){return e instanceof AST_SymbolRef&&(ne.has(e.name)||$&&n.exposed(e.definition()))}),!0)));function h(e){return e.transform(m),ce}}function me(e,t,i){if(t instanceof AST_DefaultValue)return e(t.value)||me(e,t.name,t.value)||!J(i)&&me(e,t.name,i);if(!i)return!(t instanceof AST_Symbol);if(t instanceof AST_Destructured){if(t.rest&&me(e,t.rest))return!0;if(t instanceof AST_DestructuredArray)return i instanceof AST_Array?!all(t.elements,(function(n,t){return!me(e,n,i[t])})):!i.is_string(n)||!all(t.elements,(function(n){return!me(e,n)}));if(t instanceof AST_DestructuredObject)return!!i.may_throw_on_access(n)||!all(t.properties,(function(n){return!(n.key instanceof AST_Node&&e(n.key))&&!me(e,n.value)}))}}function ye(){if(!1!==s){var e=n.parent(),t=n.self();if(void 0===s){if(!(t instanceof AST_LambdaExpression)||is_generator(t)||t.uses_arguments||t.pinned()||!(e instanceof AST_Call)||e.expression!==t||!all(e.args,(function(e){return!(e instanceof AST_Spread)})))return void(s=!1);if(!j(e))return;s=!0}var i,a=t.in_strict_mode(n)&&!t.parent_scope.resolve(!0).in_strict_mode(n);is_async(t)?(i=function(e){return e instanceof AST_Symbol&&"await"==e.name},r=!0):(i=function(e){return e instanceof AST_Await&&!f.find_parent(AST_Scope)},void 0===r&&(r=g(n,1,e,null,!0,!0)));for(var o=null,f=new TreeWalker((function(e,n){if(!p)return!0;if(i(e)||e instanceof AST_Yield)return p=null,!0;if(e instanceof AST_ObjectIdentity)return!a&&o||(p=null),!0;var r;if(e instanceof AST_SymbolRef)return(e.in_arg&&!Be(e.definition())||(r=t.variables.get(e.name))&&r!==e.definition())&&(p=null),!0;if(e instanceof AST_Scope&&!is_arrow(e)){var s=o;return o=e,n(),o=s,!0}})),c=(S=e.args.slice()).length,u=new Dictionary,l=t.argnames.length;--l>=0;){var _=t.argnames[l],p=S[l],d=null;if(_ instanceof AST_DefaultValue&&(d=_.value,_=_.name,S[c+l]=d),_ instanceof AST_Destructured){if(r&&me((function(e){return e.has_side_effects(n)}),_,p)){T.length=0;break}S[c+l]=t.argnames[l]}else if(!u.has(_.name)&&(u.set(_.name,!0),d&&(p=J(p)?d:null),p||d?p instanceof AST_Lambda&&p.pinned()?p=null:p&&p.walk(f):p=k(AST_Undefined,_).transform(n),p)){var A=k(AST_VarDef,_,{name:_,value:p});A.name_index=l,A.arg_index=d?c+l:l,T.unshift([A])}}t.rest&&S.push(t.rest)}}function ge(e,n){if(D.push(e),e instanceof AST_Array)e.elements.forEach((function(e){ge(e,n)}));else if(e instanceof AST_Assign){var t=e.left;t instanceof AST_Destructured||T.push(D.slice()),ge(t),ge(e.right),t instanceof AST_SymbolRef&&"="==e.operator&&d.set(t.name,(d.get(t.name)||0)+1)}else if(e instanceof AST_Await)ge(e.expression,n);else if(e instanceof AST_Binary){var i=X[e.operator];n&&i&&"??"!=e.operator&&e.right instanceof AST_Assign&&"="==e.right.operator&&!(e.right.left instanceof AST_Destructured)&&T.push(D.slice()),ge(e.left,!i&&n),ge(e.right,n)}else if(e instanceof AST_Call)ge(e.expression),e.args.forEach(ge);else if(e instanceof AST_Case)ge(e.expression);else if(e instanceof AST_Conditional)ge(e.condition),ge(e.consequent,n),ge(e.alternative,n);else if(e instanceof AST_Definitions)e.definitions.forEach(ge);else if(e instanceof AST_Dot)ge(e.expression);else if(e instanceof AST_DWLoop)ge(e.condition),e.body instanceof AST_Block||ge(e.body);else if(e instanceof AST_Exit)e.value&&ge(e.value);else if(e instanceof AST_For)e.init&&ge(e.init,!0),e.condition&&ge(e.condition),e.step&&ge(e.step,!0),e.body instanceof AST_Block||ge(e.body);else if(e instanceof AST_ForEnumeration)ge(e.object),e.body instanceof AST_Block||ge(e.body);else if(e instanceof AST_If)ge(e.condition),e.body instanceof AST_Block||ge(e.body),!e.alternative||e.alternative instanceof AST_Block||ge(e.alternative);else if(e instanceof AST_Object)e.properties.forEach((function(e){D.push(e),e.key instanceof AST_Node&&ge(e.key),e instanceof AST_ObjectKeyVal&&ge(e.value,n),D.pop()}));else if(e instanceof AST_Sequence){var r=e.expressions.length-(n?0:1);e.expressions.forEach((function(e,n){ge(e,n<r)}))}else if(e instanceof AST_SimpleStatement)ge(e.body,!0);else if(e instanceof AST_Spread)ge(e.expression);else if(e instanceof AST_Sub)ge(e.expression),ge(e.property);else if(e instanceof AST_Switch)ge(e.expression),e.body.forEach(ge);else if(e instanceof AST_Unary)UNARY_POSTFIX[e.operator]?T.push(D.slice()):ge(e.expression);else if(e instanceof AST_VarDef){if(e.name instanceof AST_SymbolVar)if(e.value){var a=e.name.definition();a.references.length>a.replaced&&T.push(D.slice())}else h.set(e.name.name,(h.get(e.name.name)||0)+1);e.value&&ge(e.value)}else e instanceof AST_Yield&&e.expression&&ge(e.expression);D.pop()}function be(e,n){var t=m.parent(n);return t instanceof AST_Array||t instanceof AST_Assign||t instanceof AST_Await||t instanceof AST_Binary||t instanceof AST_Call||t instanceof AST_Case||t instanceof AST_Conditional?e:t instanceof AST_Definitions?De(t,n+1):t instanceof AST_Exit||t instanceof AST_If||t instanceof AST_IterationStatement||t instanceof AST_ObjectProperty||t instanceof AST_PropAccess?e:t instanceof AST_Sequence?(t.tail_node()===e?be:De)(t,n+1):t instanceof AST_SimpleStatement?De(t,n+1):t instanceof AST_Spread||t instanceof AST_Switch||t instanceof AST_Unary||t instanceof AST_VarDef||t instanceof AST_Yield?e:null}function xe(e,n,t){var i;do{i=e,e=m.parent(++t)}while(e instanceof AST_Assign&&e.operator.slice(0,-1)==n||e instanceof AST_Binary&&e.operator==n);return i}function ke(e,n,t,i,r){var a=le;le=!1;var o=q,s=U,f=m.stack;return m.stack=[i],e.transform(m),m.stack=f,U=s,q=o,le=a,ce?(ce=!1,t):n(i,r+1)}function we(e,n){var t,i=m.parent(n);if(i instanceof AST_Array)return we(i,n+1);if(i instanceof AST_Assign)return G(i)||i.left.match_symbol((function(e){return e instanceof AST_SymbolRef&&(z.name==e.name||F.name==e.name)}))?e:i.left!==e&&X[t=i.operator.slice(0,-1)]?xe(i,t,n):we(i,n+1);if(i instanceof AST_Await)return we(i,n+1);if(i instanceof AST_Binary)return i.left!==e&&X[t=i.operator]?xe(i,t,n):we(i,n+1);if(i instanceof AST_Call)return i;if(i instanceof AST_Case)return i.expression!==e?e:we(i,n+1);if(i instanceof AST_Conditional)return i.condition!==e?e:we(i,n+1);if(i instanceof AST_Definitions)return De(i,n+1);if(i instanceof AST_Do)return e;if(i instanceof AST_Exit)return De(i,n+1);if(i instanceof AST_For)return i.init!==e&&i.condition!==e?e:we(i,n+1);if(i instanceof AST_ForEnumeration)return i.init!==e?e:we(i,n+1);if(i instanceof AST_If)return i.condition!==e?e:we(i,n+1);if(i instanceof AST_ObjectProperty){var r=m.parent(n+1);return all(r.properties,(function(e){return e instanceof AST_ObjectKeyVal}))?we(r,n+2):r}return i instanceof AST_PropAccess?i.expression===e?we(i,n+1):e:i instanceof AST_Sequence?(i.tail_node()===e?we:De)(i,n+1):i instanceof AST_SimpleStatement?De(i,n+1):i instanceof AST_Spread?we(i,n+1):i instanceof AST_Switch?i.expression!==e?e:we(i,n+1):i instanceof AST_Unary?"delete"==i.operator?e:we(i,n+1):i instanceof AST_VarDef?i.name.match_symbol((function(e){return e instanceof AST_SymbolDeclaration&&(z.name==e.name||F.name==e.name)}))?e:we(i,n+1):i instanceof AST_While?i.condition!==e?e:we(i,n+1):i instanceof AST_Yield?we(i,n+1):null}function De(e,n){var t=m.parent(n);if(ve(e,t))return e;if(he(e,t))return e;if(t instanceof AST_Array)return De(t,n+1);if(t instanceof AST_Assign)return a(t.left);if(t instanceof AST_Await)return e;if(t instanceof AST_Binary)return De(t,n+1);if(t instanceof AST_Call)return De(t,n+1);if(t instanceof AST_Case)return De(t,n+1);if(t instanceof AST_Conditional)return De(t,n+1);if(t instanceof AST_Definitions)return De(t,n+1);if(t instanceof AST_Exit)return De(t,n+1);if(t instanceof AST_If)return De(t,n+1);if(t instanceof AST_IterationStatement)return e;if(t instanceof AST_ObjectProperty){var i=m.parent(n+1);return all(i.properties,(function(e){return e instanceof AST_ObjectKeyVal}))?De(i,n+2):i}if(t instanceof AST_PropAccess){var r=t.expression;return r===e?De(t,n+1):ke(r,De,e,t,n)}return t instanceof AST_Sequence||t instanceof AST_SimpleStatement?De(t,n+1):t instanceof AST_Spread?e:t instanceof AST_Switch||t instanceof AST_Unary?De(t,n+1):t instanceof AST_VarDef?a(t.name):t instanceof AST_Yield?e:null;function a(i){return G(t)?e:i!==e&&i instanceof AST_Destructured?ke(i,De,e,t,n):De(t,n+1)}}function Ee(e){if(p)p=!1;else if(!(E<1)){var t=(e=e.tail_node())instanceof AST_Assign&&"="==e.operator?e.left:e;if(t instanceof AST_SymbolRef){var i=t.definition();if(!i.undeclared&&!o(i)){if(t!==e){if(x(t,n))return;if(i.references.length-i.replaced<2)return;var r=R.clone();r[r instanceof AST_Assign?"right":"value"]=t,R.name_index>=0&&(r.name_index=R.name_index,r.arg_index=R.arg_index),R=r}return F=i}}}}function Ce(e){return e.references.length-e.replaced-(d.get(e.name)||0)}function Ne(e){if(e instanceof AST_Assign){if(!((r=e.left)instanceof AST_SymbolRef))return r;var t=r.definition();if(_.uses_arguments&&is_funarg(t))return r;if(n.exposed(t))return r;if(E=Ce(t),t.fixed&&r.fixed){var i=t.references.filter((function(e){return e.fixed===r.fixed})).length-1;i<E&&(E=i,B=0,P=!0)}return"="==e.operator&&Ee(e.right),r}if(e instanceof AST_Binary)return e.right.left;if(e instanceof AST_Unary)return e.expression;if(e instanceof AST_VarDef){var r;if((t=(r=e.name).definition()).const_redefs)return;if(!member(r,t.orig))return;if(_.uses_arguments&&is_funarg(t))return;var a=t.orig.length-t.eliminated-(h.get(t.name)||0);return E=Ce(t),t.fixed&&(E=Math.min(E,t.references.filter((function(n){if(!n.fixed)return!0;if(!n.fixed.assigns)return!0;var t=n.fixed.assigns[0];return t===r||Re(t)===e.value})).length)),a>1&&!(r instanceof AST_SymbolFunarg)?(Ee(e.value),k(AST_SymbolRef,r)):Ee(e.value)||1==E&&!n.exposed(t)?k(AST_SymbolRef,r):void 0}}function Re(e){if(e instanceof AST_Assign)return e.right;if(e instanceof AST_Binary){var n=e.clone();return n.right=e.right.right,n}return e instanceof AST_VarDef?e.value:void 0}function Oe(e){return!(e instanceof AST_Array)&&(e instanceof AST_Binary&&X[e.operator]?Oe(e.left)&&Oe(e.right):!(e instanceof AST_Call)&&(e instanceof AST_Conditional?Oe(e.consequent)&&Oe(e.alternative):!(e instanceof AST_Object)&&!e.has_side_effects(n)))}function Pe(e){if(!(e instanceof AST_Assign&&e.right.single_use)){for(var t,i=Object.create(null),r=new TreeWalker((function(e){e instanceof AST_SymbolRef&&(i[e.definition().id]=!0)}));e instanceof AST_Assign&&"="==e.operator;)e.left.walk(r),e=e.right;if(e instanceof AST_ObjectIdentity)return s;if(e instanceof AST_SymbolRef){var a=e.evaluate(n);return a===e?s:Fe(a,s)}if(e.is_truthy())return Fe(!0,return_false);if(e.is_constant()){var o=e.evaluate(n);if(!(o instanceof AST_Node))return Fe(o,s)}return z instanceof AST_SymbolRef&&(!!Oe(e)&&(e.walk(new TreeWalker((function(e){if(t)return!0;e instanceof AST_SymbolRef&&i[e.definition().id]&&(t=!0)}))),!t&&s))}function s(n){return e.equals(n)}}function Fe(e,t){return function(i,r){if(r.in_boolean_context()){if(e&&i.is_truthy()&&!i.has_side_effects(n))return!0;if(i.is_constant()){var a=i.evaluate(n);if(!(a instanceof AST_Node))return!a==!e}}return t(i)}}function qe(e){for(;e.write_only&&(e.write_only=!1,e instanceof AST_Assign);)e=e.right}function Ue(e,n){var t=n.scope||y(m)||i;e.walk(new TreeWalker((function(e){if(e instanceof AST_BlockScope)return!0;e instanceof AST_Symbol&&(e.scope=t)})))}function ze(e){return e instanceof AST_SymbolRef&&!(e=e.fixed_value())||(e instanceof AST_Assign?"="==e.operator&&ze(e.right):e instanceof AST_PropAccess||e instanceof AST_ObjectIdentity)}function je(e){var i=new Dictionary;e instanceof AST_VarDef&&(e.name.definition().fixed||(ee=!1),i.add(e.name.name,z));var r=_.uses_arguments&&!n.has_directive("use strict"),a=_ instanceof AST_Toplevel,o=new TreeWalker((function(s){var f;if(s instanceof AST_SymbolRef){if(!(f=s.fixed_value())){f=s;var u=s.definition(),l=s.fixed&&s.fixed.escaped||u.escaped;u.undeclared||!u.assignments&&l&&!l.cross_scope||!c(u,s.scope,s,o.parent())&&nn(u)||(ee=!1)}}else s instanceof AST_ObjectIdentity&&(f=s);if(f)i.add(s.name,t(n,o,s,f,0));else{if(s instanceof AST_Lambda){for(var S,p=0,d=s;S=o.parent(p++);d=S){if(S instanceof AST_Assign){if(S.left===d)break;if("="==S.operator)continue;if(X[S.operator.slice(0,-1)])continue;break}if(S instanceof AST_Binary){if(X[S.operator])continue;break}if(S instanceof AST_Call)return;if(S instanceof AST_Scope)return;if(S instanceof AST_Sequence){if(S.tail_node()===d)continue;break}if(S instanceof AST_Template){if(S.tag)return;break}}return s.enclosed.forEach((function(e){e.scope!==s&&Z.set(e.name,!0)})),!0}r&&s instanceof AST_Sub&&(_.each_argname((function(e){n.option("reduce_vars")&&!e.definition().assignments||(e.definition().fixed||(ee=!1),i.add(e.name,!0))})),r=!1)}if(a)if("Call"==s.TYPE){if(Q)return;var T=s.expression;if(T instanceof AST_PropAccess)return;if(T instanceof AST_LambdaExpression&&!T.contains_this())return;Q=!0}else s instanceof AST_PropAccess&&ze(s.expression)&&(s!==z||e instanceof AST_Unary?$=!0:Q=!0)}));return e.walk(o),i}function Le(t){var i=re===ie?null:w(ie,ie.expressions.slice(0,-1)),r=t.name_index;if(r>=0){var a,o=_.argnames[r];o instanceof AST_DefaultValue?(_.argnames[r]=o=o.clone(),o.value=i||k(AST_Number,o,{value:0})):(a=n.parent().args)[r]&&(_.argnames[r]=o.clone(),a[r]=i||k(AST_Number,a[r],{value:0}))}else{var s=D.length-1,f=D[s];(f instanceof AST_VarDef||D[s-1].body===f)&&s--;var c=new TreeTransformer((function(e,n,t){if(se)return e;if(e!==D[N])return e;if(++N<=s)return Te(e,c);if(se=!0,e instanceof AST_Definitions){h.set(f.name.name,(h.get(f.name.name)||0)+1),F&&F.replaced++;var r=e.definitions,a=r.indexOf(f),o=f.clone();if(o.value=null,!i)return e.definitions[a]=o,e;var u=[k(AST_SimpleStatement,i,{body:i})];if(a>0){var l=e.clone();l.definitions=r.slice(0,a),u.unshift(l),(e=e.clone()).definitions=r.slice(a)}return u.push(e),e.definitions[0]=o,t?List.splice(u):k(AST_BlockStatement,e,{body:u})}return i?is_statement(e)?k(AST_SimpleStatement,i,{body:i}):i:t?List.skip:null}),(function(e,n){return e instanceof AST_For?K(e,n):Ve(e,c)}));ce=!1,se=!1,N=0,(e[v]=e[v].transform(c))||e.splice(v,1)}}function Ve(e,n){if(e instanceof AST_Sequence)switch(e.expressions.length){case 0:return null;case 1:return C(n.parent(),e,e.expressions[0])}}function Ie(e){var n=root_expr(e);if(!(n instanceof AST_SymbolRef))return!1;if(n.definition().scope.resolve()!==_)return!1;if(!u)return!0;if(W)return!1;if(R instanceof AST_Unary)return!1;var t=ne.get(n.name);return!t||t[0]===e}function Me(){return!(R instanceof AST_Unary)&&re.has_side_effects(n)}function He(e){if(e instanceof AST_Unary)return!1;if(V)return!1;if(F)return!0;if(!(z instanceof AST_SymbolRef))return!1;var n;if(e instanceof AST_VarDef)n=1;else{if("="!=e.operator)return!1;n=2}var t=z.definition();if(t.references.length-t.replaced==n)return!0;if(!t.fixed)return!1;if(!z.fixed)return!1;var i=z.fixed.assigns,r=0;return!!all(t.references,(function(e,n){var t=e.fixed;return!!t&&(!t.to_binary&&!t.to_prefix&&(t===z.fixed?(r++,!0):i&&t.assigns&&i[0]!==t.assigns[0]))}))&&(r==n&&(P=!0,!0))}function We(e,n){var t=ne.get(e.name);if(t&&!all(t,(function(e){return!e})))return t[0]!==z||void(H=!1)}function Ye(e){var t=e.definition();return!(1==t.orig.length&&t.orig[0]instanceof AST_SymbolDefun)&&(t.scope.resolve()!==_||(!(!Q||!n.exposed(t))||!all(t.references,(function(e){return e.scope.resolve(!0)===_}))))}function Ke(e,n){if(e instanceof AST_Assign)return Ke(e.left,!0);if(e instanceof AST_Unary)return Ke(e.expression,!0);if(e instanceof AST_VarDef)return e.value&&Ke(e.value);if(n){if(e instanceof AST_Dot)return Ke(e.expression,!0);if(e instanceof AST_Sub)return Ke(e.expression,!0);if(e instanceof AST_SymbolRef)return e.definition().scope.resolve()!==_}return!1}}function v(e){for(var n=!1,t=[],i=0;i<e.length;){var r=e[i];if(r instanceof AST_BlockStatement&&all(r.body,O))n=!0,v(r.body),[].splice.apply(e,[i,1].concat(r.body)),i+=r.body.length;else{if(r instanceof AST_Directive){if(member(r.value,t)){n=!0,e.splice(i,1);continue}t.push(r.value)}r instanceof AST_EmptyStatement?(n=!0,e.splice(i,1)):i++}}return n}function b(e,n){for(var t,i,r,a=!1,o=n.parent(),s=n.self(),f=S&&o&&"Call"==o.TYPE&&o.expression===s,c=S&&n.option("conditionals")&&n.option("sequences"),u=!(l&&l.bfinally&&m(_)),p=function(e){for(var n=0,t=e.length;--t>=0;){var i=e[t];if(i instanceof AST_If&&i.body instanceof AST_Return&&++n>1)return!0}return!1}(e),d=e.length;--d>=0;){var T=e[d],h=K(d),v=e[h];if(S&&t&&!v&&T instanceof AST_Return&&u&&!(s instanceof AST_SwitchBranch)){if(!(D=T.value)){a=!0,e.splice(d,1);continue}var y=D.tail_node();if(J(y)){a=!0,D instanceof AST_UnaryPrefix?D=D.expression:y instanceof AST_UnaryPrefix&&((D=D.clone()).expressions[D.expressions.length-1]=y.expression),e[d]=k(AST_SimpleStatement,T,{body:D});continue}}if(T instanceof AST_If){var g=le(T.body);if(V(g)){g.label&&remove(g.label.thedef.references,g),a=!0,(T=T.clone()).body=k(AST_BlockStatement,T,{body:H(T.body,g)}),T.alternative=k(AST_BlockStatement,T,{body:P(T.alternative).concat(I(r,i))}),Y(g.value,r),e[d]=T,e[d]=T.transform(n);continue}if(g&&!T.alternative&&v instanceof AST_Jump){var b=T.condition,x=d+1==h&&T.body instanceof AST_BlockStatement;if((b=Q(b,b.negate(n),x))!==T.condition){a=!0,(T=T.clone()).condition=b;var D=T.body;T.body=k(AST_BlockStatement,v,{body:I(!0,null,h+1)}),e.splice(d,1,T,D),(!S||s instanceof AST_Block&&s.body===e)&&(e[d]=T.transform(n));continue}}var E=le(T.alternative);if(V(E)){E.label&&remove(E.label.thedef.references,E),a=!0,(T=T.clone()).body=k(AST_BlockStatement,T.body,{body:P(T.body).concat(I(r,i))}),T.alternative=k(AST_BlockStatement,T.alternative,{body:H(T.alternative,E)}),Y(E.value,r),e[d]=T,e[d]=T.transform(n);continue}if(n.option("typeofs")){if(g&&!E){var C=k(AST_BlockStatement,s,{body:e.slice(d+1)});Ee(T.condition,null,C)}if(!g&&E){C=k(AST_BlockStatement,s,{body:e.slice(d+1)});Ee(T.condition,C)}}}if(T instanceof AST_If&&T.body instanceof AST_Return){var R,O,F=T.body.value,q=T.body.in_bool||v instanceof AST_Return&&v.in_bool;if(!T.alternative&&v instanceof AST_Return&&(u||!F==!v.value)){a=!0,(T=T.clone()).alternative=k(AST_BlockStatement,v,{body:I(!0,null,h+1)}),e[d]=T,e[d]=T.transform(n);continue}if(S&&t&&!v&&!T.alternative&&(q||F&&p||F instanceof AST_Conditional&&(J(F.consequent,n)||J(F.alternative,n)))){a=!0,(T=T.clone()).alternative=k(AST_Return,T,{value:null}),e[d]=T,e[d]=T.transform(n);continue}if(c&&!T.alternative&&(!(O=e[R=G(d)])&&f||O instanceof AST_If&&O.body instanceof AST_Return)&&(v?v instanceof AST_SimpleStatement&&K(h)==e.length:!t)){a=!0;var z=[];T=T.clone(),z.push(T.condition),T.condition=w(T,z),T.alternative=k(AST_BlockStatement,s,{body:I().concat(k(AST_Return,s,{value:null}))}),e[d]=T.transform(n),d=R+1;continue}}T instanceof AST_Break||T instanceof AST_Exit?i=T:t&&i&&i===v&&$(T)}return a;function j(e){return A(n,(function(n){return n===e}))}function L(e,n){if(!i)return!1;if(i.TYPE!=e.TYPE)return!1;var t=e.value;if(!t)return!1;var r=i.equals(e);return!r&&t instanceof AST_Sequence&&(t=t.tail_node(),i.value&&i.value.equals(t)&&(r=2)),!r&&!n&&i.value instanceof AST_Sequence&&i.value.tail_node().equals(t)&&(r=3),r}function V(t){if(r=!1,!function(e){if(e instanceof AST_Exit){if(r=L(e))return!0;if(!S)return!1;if(!(e instanceof AST_Return))return!1;var t=e.value;return!(t&&!J(t.tail_node()))&&(!(s instanceof AST_SwitchBranch)||!!i&&!(i instanceof AST_Exit&&i.value)&&(r=4,!0))}if(!(e instanceof AST_LoopControl))return!1;if(s instanceof AST_SwitchBranch)if(i instanceof AST_Exit){if(!S)return!1;if(i.value)return!1;r=!0}else if(i){if(n.loopcontrol_target(i)!==o)return!1;r=!0}else if(!1===i)return!1;var a=n.loopcontrol_target(e);return e instanceof AST_Continue?j(U(a)):!(a instanceof AST_IterationStatement)&&j(a)}(t))return!1;for(var a=e.length;--a>d;){var f=e[a];if(f instanceof AST_DefClass){if(f.name.definition().preinit)return!1}else if((f instanceof AST_Const||f instanceof AST_Let)&&!all(f.definitions,(function(e){return!e.name.match_symbol((function(e){return e instanceof AST_SymbolDeclaration&&e.definition().preinit}))})))return!1}return!0}function I(n,t,r){var a=[],o=!1,s=d+1;n?t?r=e.lastIndexOf(t):(t=e[r])!==i&&(i=!1):(r=e.length,i=null);var f=e.splice(s,r-s).filter((function(e){return e instanceof AST_LambdaDefinition?(a.push(e),!1):(B(e)&&(o=!0),!0)}));return 3===n&&(f.push(k(AST_SimpleStatement,t.value,{body:w(t.value,t.value.expressions.slice(0,-1))})),t.value=t.value.tail_node()),[].push.apply(o?f:e,a),f}function M(e,n){if(e)switch(n){case 4:return e;case 3:if(!(e instanceof AST_Sequence))break;case 2:return w(e,e.expressions.slice(0,-1))}}function H(e,n){for(var t,i=P(e),a=i;(t=a[a.length-1])!==n;)a=t.body;a.pop();var o=n.value;return r&&(o=M(o,r)),o&&a.push(k(AST_SimpleStatement,o,{body:o})),i}function Y(e,n){if(n&&e){switch(n){case 4:return;case 3:case 2:e=e.tail_node()}N(e,i.value)}}function K(n){t=!0;for(var i=n;++i<e.length;){var r=e[i];if(!W(r)){if(!(r instanceof AST_Var))break;t=!1}}return i}function G(n){for(var t=n;--t>=0;){var i=e[t];if(!(i instanceof AST_Var)&&!W(i))break}return t}function $(e,n,t){if(e instanceof AST_Exit){var r=!(n&&e instanceof AST_Throw)&&L(e,!0);if(r){a=!0;var o=M(e.value,r);return o?k(AST_SimpleStatement,o,{body:o}):t?null:k(AST_EmptyStatement,e)}}else if(e instanceof AST_If)e.body=$(e.body,n),e.alternative&&(e.alternative=$(e.alternative,n));else if(e instanceof AST_LabeledStatement)e.body=$(e.body,n);else if(e instanceof AST_Try){if(!e.bfinally||!i.value||i.value.is_constant())e.bcatch&&$(e.bcatch,n),(s=$(e.body.pop(),!0,!0))&&e.body.push(s)}else if(e instanceof AST_Block&&!(e instanceof AST_Scope||e instanceof AST_Switch)){var s;(s=$(e.body.pop(),n,!0))&&e.body.push(s)}return e}}function D(e,n){var t,i=n.self();i instanceof AST_Catch?i=n.parent():i instanceof AST_LabeledStatement&&(i=i.body);for(var r=0,a=0,o=e.length;r<o;r++){var s=e[r];if(s instanceof AST_LoopControl){var f=n.loopcontrol_target(s);U(f)!==i||s instanceof AST_Break&&f instanceof AST_IterationStatement?e[a++]=s:s.label&&remove(s.label.thedef.references,s)}else e[a++]=s;if(le(s)){t=e.slice(r+1);break}}return e.length=a,t&&t.forEach((function(t){$(n,t,e)})),e.length!=o}function E(e,n){if(!(!S||l&&l.bfinally)){for(var t=!1,i=e.length;--i>=0;){var r=e[i];if(!(r instanceof AST_SimpleStatement))break;var a=r.body;if(!(a instanceof AST_Await))break;var o=a.expression;if(!Je(n,o))break;if(t=!0,o=o.drop_side_effect_free(n,!0)){r.body=o;break}}return e.length=i+1,t}}function F(e,n){var t=!1,r=e.length-1;if(S&&r>=0){var a=l&&l.bfinally&&m(_);(s=e[r].try_inline(n,i,a))&&(e[r--]=s,t=!0)}for(var o=u&&l&&l.bfinally?"try":u;r>=0;r--){var s;(s=e[r].try_inline(n,i,!0,o))&&(e[r]=s,t=!0)}return t}function q(e,n){if(!(e.length<2)){for(var t=[],i=0,r=0,a=e.length;r<a;r++){var o=e[r];o instanceof AST_SimpleStatement?(t.length>=n.sequences_limit&&s(),R(t,o.body)):(W(o)||s(),e[i++]=o)}return s(),e.length=i,i!=a}function s(){if(t.length){var n=w(t[0],t);e[i++]=k(AST_SimpleStatement,n,{body:n}),t=[]}}}function z(e,n){if(!(e instanceof AST_BlockStatement))return e;for(var t=null,i=0;i<e.body.length;i++){var r=e.body[i];if(r instanceof AST_Var&&H(r))n.push(r);else{if(t||B(r))return!1;t=r}}return t}function V(e,n){for(var t,i=!1,r=0,a=0;a<e.length;a++){var o=e[a];if(t)if(o instanceof AST_Exit)!o.value&&m(_)||(o.value=S(o.value||k(AST_Undefined,o)).optimize(n));else if(o instanceof AST_For){if(!(o.init instanceof AST_Definitions)){var s=!1;t.body.walk(new TreeWalker((function(e){return!!(s||e instanceof AST_Scope)||(e instanceof AST_Binary&&"in"==e.operator?(s=!0,!0):void 0)}))),s||(o.init?o.init=S(o.init):(o.init=t.body,r--,i=!0))}}else o instanceof AST_ForIn?B(o.init)||(o.object=S(o.object)):o instanceof AST_If?o.condition=S(o.condition):(o instanceof AST_Switch||o instanceof AST_With)&&(o.expression=S(o.expression));if(n.option("conditionals")&&o instanceof AST_If){var f=[],c=z(o.body,f),u=z(o.alternative,f);if(!1!==c&&!1!==u&&f.length>0){var l=f.length;f.push(k(AST_If,o,{condition:o.condition,body:c||k(AST_EmptyStatement,o.body),alternative:u})),f.unshift(r,1),[].splice.apply(e,f),a+=l,r+=l+1,t=null,i=!0;continue}}e[r++]=o,t=o instanceof AST_SimpleStatement?o:null}return e.length=r,i;function S(e){r--,i=!0;var n=t.body;return w(n,[n,e])}}function M(e){return e instanceof AST_Assign?[e]:e instanceof AST_Sequence?e.expressions.slice():void 0}function G(e,n,t){var i=M(n);if(i){t=t||0;for(var r=!1,a=i.length-t;--a>=0;){var o=i[a];if(u(o)){var s;if(o.left instanceof AST_SymbolRef)s=i.slice(a+1);else{if(!(o.left instanceof AST_PropAccess&&u(o.left.expression)))continue;s=i.slice(a+1);var f=o.clone();o=o.left.expression,f.left=f.left.clone(),f.left.expression=o.left.clone(),s.unshift(f)}0!=s.length&&te(o.left,o.right,s)&&(r=!0,i=i.slice(0,a).concat(o,s))}}if(e instanceof AST_Definitions){for(a=e.definitions.length;--a>=0;){var c=e.definitions[a];if(c.value){te(c.name,c.value,i)&&(r=!0),ee(c,i,t)&&(r=!0);break}}e instanceof AST_Var&&ne(e.definitions,i,t)&&(r=!0)}return r&&i}function u(e){return e instanceof AST_Assign&&"="==e.operator}}function Z(e,n){if(e instanceof AST_SimpleStatement&&!H(n)){var t=M(e.body);if(t){var i=[];if(ne(i,t.reverse(),0))return n.definitions=i.reverse().concat(n.definitions),t.reverse()}}}function ee(e,t,i){if(n.option("conditionals")&&!(e.name instanceof AST_Destructured)){for(var r=!1,a=e.name.definition();t.length>i;){var o=Me(n,a,e.value,t[0]);if(!o)break;e.value=o,t.shift(),r=!0}return r}}function ne(e,n,t){for(var i=!1;n.length>t;){var r=n[0];if(!(r instanceof AST_Assign))break;if("="!=r.operator)break;var a=r.left;if(!(a instanceof AST_SymbolRef))break;if(L(a))break;if(a.scope.resolve()!==_)break;var o=a.definition();if(o.scope!==_)break;if(o.orig.length>o.eliminated+1)break;if("SymbolVar"!=o.orig[0].TYPE)break;var s=k(AST_SymbolVar,a);e.push(k(AST_VarDef,r,{name:s,value:r.right})),o.orig.push(s),o.replaced++,n.shift(),i=!0}return i}function te(e,t,i){var r=new Dictionary;for(r.set(e.name,!0);t instanceof AST_Assign&&"="==t.operator;)t.left instanceof AST_SymbolRef&&r.set(t.left.name,!0),t=t.right;if(t instanceof AST_Object){var a=!1;do{if(!o(i[0]))break;i.shift(),a=!0}while(i.length);return a}function o(e){if(e instanceof AST_Assign&&"="==e.operator&&e.left instanceof AST_PropAccess){var i=e.left.expression;if(i instanceof AST_SymbolRef&&r.has(i.name)&&e.right.is_constant_expression(_)){var a=e.left.property;if(a instanceof AST_Node&&(o(a)&&(a=e.left.property=a.right.clone()),a=a.evaluate(n)),!(a instanceof AST_Node)){var s="__proto__"==(a=""+a)||n.has_directive("use strict")?function(e){var n=e.key;return"string"==typeof n&&n!=a&&"__proto__"!=n}:function(e){var n=e.key;return e instanceof AST_ObjectGetter||e instanceof AST_ObjectSetter?"string"==typeof n&&n!=a:"__proto__"!==n};if(all(t.properties,s))return t.properties.push(k(AST_ObjectKeyVal,e,{key:a,value:e.right})),!0}}}}}function ie(e){for(var n,t=!1,i=0,r=-1;i<e.length;i++){var a=e[i],o=e[r];if(a instanceof AST_Definitions)if(o&&o.TYPE==a.TYPE)o.definitions=o.definitions.concat(a.definitions),t=!0;else if(n&&n.TYPE==a.TYPE&&H(a))n.definitions=n.definitions.concat(a.definitions),t=!0;else if(a instanceof AST_Var){(f=Z(o,a))?(f.length&&(o.body=w(o,f),r++),t=!0):r++,e[r]=n=a}else e[++r]=a;else{if(a instanceof AST_Exit)a.value=u(a.value);else if(a instanceof AST_For){if(f=G(o,a.init))t=!0,a.init=f.length?w(a.init,f):null;else{if(o instanceof AST_Var&&(!a.init||a.init.TYPE==o.TYPE)){a.init&&(o.definitions=o.definitions.concat(a.init.definitions)),a=a.clone(),n=a.init=o,e[r]=l(a),t=!0;continue}if(n&&a.init&&n.TYPE==a.init.TYPE&&H(a.init))n.definitions=n.definitions.concat(a.init.definitions),a.init=null,t=!0;else if(a.init instanceof AST_Var&&(n=a.init,f=Z(o,a.init))){if(t=!0,0==f.length){e[r]=l(a);continue}o.body=w(o,f)}}}else if(a instanceof AST_ForEnumeration){if(n&&n.TYPE==a.init.TYPE){var s=n.definitions.slice();a.init=a.init.definitions[0].name.convert_symbol(AST_SymbolRef,(function(e,n){s.push(k(AST_VarDef,n,{name:n,value:null})),n.definition().references.push(e)})),n.definitions=s,t=!0}a.object=u(a.object)}else if(a instanceof AST_If)a.condition=u(a.condition);else if(a instanceof AST_SimpleStatement){var f,c;if(f=G(o,a.body)){if(t=!0,!f.length)continue;a.body=w(a.body,f)}else if(o instanceof AST_Definitions&&(c=e[i+1])&&o.TYPE==c.TYPE&&(c=c.definitions[0]).value){t=!0,c.value=w(a,[a.body,c.value]);continue}}else(a instanceof AST_Switch||a instanceof AST_With)&&(a.expression=u(a.expression));e[++r]=n?l(a):a}}return e.length=r+1,t;function u(e){var n=G(o,e,1);if(!n)return e;t=!0;var i=e.tail_node();return n[n.length-1]!==i&&n.push(i.left),w(e,n)}function l(e){return e.transform(new TreeTransformer((function(e,i,r){if(e instanceof AST_Definitions){if(n===e)return e;if(n.TYPE!=e.TYPE)return e;var a=this.parent();return a instanceof AST_ForEnumeration&&a.init===e?e:H(e)?(n.definitions=n.definitions.concat(e.definitions),t=!0,a instanceof AST_For&&a.init===e?null:r?List.skip:k(AST_EmptyStatement,e)):e}return e instanceof AST_ExportDeclaration||e instanceof AST_Scope?e:is_statement(e)?void 0:e})))}}}function $(e,n,t){var i,r=!1;function a(e){i?(i.push(e),O(e)||(i.required=!0)):t.push(e)}n.walk(new TreeWalker((function(o,s){if(o instanceof AST_DefClass)return o.extends=null,o.properties=[],a(o),!0;if(o instanceof AST_Definitions){var f=[];return o.remove_initializers(e,f)&&AST_Node.warn("Dropping initialization in unreachable code [{start}]",o),f.length>0&&(o.definitions=f,a(o)),!0}if(o instanceof AST_LambdaDefinition)return a(o),!0;if(o instanceof AST_Scope)return!0;if(o instanceof AST_BlockScope){var c=i;return i=[],s(),i.required?t.push(k(AST_BlockStatement,n,{body:i})):i.length&&[].push.apply(t,i),i=c,!0}o instanceof AST_LoopControl||(r=!0)}))),r&&AST_Node.warn("Dropping unreachable code [{start}]",n)}function J(e,n){return null==e||e.is_undefined||e instanceof AST_Undefined||e instanceof AST_UnaryPrefix&&"void"==e.operator&&!(n&&e.expression.has_side_effects(n))}AST_SymbolRef.DEFMETHOD("is_declared",(function(e){return this.defined||!this.definition().undeclared||e.option("unsafe")&&I[this.name]})),(V=function(e,n){e.DEFMETHOD("in_strict_mode",n)})(AST_Class,return_true),V(AST_Scope,(function(e){for(var n=this.body,t=0;t<n.length;t++){var i=n[t];if(!(i instanceof AST_Directive))break;if("use strict"==i.value)return!0}var r=this.parent_scope;return r?r.resolve(!0).in_strict_mode(e):e.option("module")})),function(e){e(AST_Node,return_false),e(AST_Array,return_true),e(AST_Assign,(function(){return"="==this.operator&&this.right.is_truthy()})),e(AST_Lambda,return_true),e(AST_Object,return_true),e(AST_RegExp,return_true),e(AST_Sequence,(function(){return this.tail_node().is_truthy()})),e(AST_SymbolRef,(function(){var e=this.fixed_value();if(!e)return!1;this.is_truthy=return_false;var n=e.is_truthy();return delete this.is_truthy,n}))}((function(e,n){e.DEFMETHOD("is_truthy",n)})),function(e){function n(e,n,t){switch(e){case"-":return n.is_negative_zero()&&(!(t instanceof AST_Constant)||0==t.value);case"&&":case"||":return n.is_negative_zero()||t.is_negative_zero();case"*":case"/":case"%":case"**":return!0;default:return!1}}e(AST_Node,return_true),e(AST_Array,return_false),e(AST_Assign,(function(){var e=this.operator;return"="==e?this.right.is_negative_zero():n(e.slice(0,-1),this.left,this.right)})),e(AST_Binary,(function(){return n(this.operator,this.left,this.right)})),e(AST_Constant,(function(){return 0==this.value&&1/this.value<0})),e(AST_Lambda,return_false),e(AST_Object,return_false),e(AST_RegExp,return_false),e(AST_Sequence,(function(){return this.tail_node().is_negative_zero()})),e(AST_SymbolRef,(function(){var e=this.fixed_value();if(!e)return!0;this.is_negative_zero=return_true;var n=e.is_negative_zero();return delete this.is_negative_zero,n})),e(AST_UnaryPrefix,(function(){return"+"==this.operator&&this.expression.is_negative_zero()||"-"==this.operator}))}((function(e,n){e.DEFMETHOD("is_negative_zero",n)})),function(e){function n(e,n){return n||/strict/.test(e.option("pure_getters"))}AST_Node.DEFMETHOD("may_throw_on_access",(function(e,n){return!e.option("pure_getters")||this._dot_throw(e,n)})),e(AST_Node,n),e(AST_Array,return_false),e(AST_Assign,(function(e){var n=this.operator,t=this.left,i=this.right;return"="!=n?X[n.slice(0,-1)]&&(t._dot_throw(e)||i._dot_throw(e)):!!i._dot_throw(e)&&(!(t instanceof AST_SymbolRef)||(!(i instanceof AST_Binary&&"||"==i.operator&&t.name==i.left.name)||i.right._dot_throw(e)))})),e(AST_Binary,(function(e){return X[this.operator]&&(this.left._dot_throw(e)||this.right._dot_throw(e))})),e(AST_Class,(function(e,t){return n(e,t)&&!all(this.properties,(function(e){return!!e.private||(!e.static||!(e instanceof AST_ClassGetter||e instanceof AST_ClassSetter))}))})),e(AST_Conditional,(function(e){return this.consequent._dot_throw(e)||this.alternative._dot_throw(e)})),e(AST_Constant,return_false),e(AST_Dot,(function(e,t){if(!n(e,t))return!1;var i=this.expression;return i instanceof AST_SymbolRef&&(i=i.fixed_value()),!("prototype"==this.property&&r(i))})),e(AST_Lambda,return_false),e(AST_Null,return_true),e(AST_Object,(function(e,t){return n(e,t)&&!all(this.properties,(function(n){return!(n instanceof AST_ObjectGetter||n instanceof AST_ObjectSetter)&&!("__proto__"===n.key&&n.value._dot_throw(e,t))}))})),e(AST_ObjectIdentity,(function(e,t){return n(e,t)&&!this.scope.resolve().new})),e(AST_Sequence,(function(e){return this.tail_node()._dot_throw(e)})),e(AST_SymbolRef,(function(e,t){if(this.is_undefined)return!0;if(!n(e,t))return!1;if(L(this)&&this.is_declared(e))return!1;if(this.is_immutable())return!1;var i=this.definition();if(o(i)&&!i.scope.rest&&all(i.scope.argnames,(function(e){return e instanceof AST_SymbolFunarg})))return i.scope.uses_arguments>2;var r=this.fixed_value(!0);return!r||(this._dot_throw=return_true,r._dot_throw(e)?(delete this._dot_throw,!0):(this._dot_throw=return_false,!1))})),e(AST_UnaryPrefix,(function(){return"void"==this.operator})),e(AST_UnaryPostfix,return_false),e(AST_Undefined,return_true)}((function(e,n){e.DEFMETHOD("_dot_throw",n)})),function(e){function n(e,n,t){switch(n){case"&&":return t.left.is_defined(e)&&t.right.is_defined(e);case"||":return t.left.is_truthy()||t.right.is_defined(e);case"??":return t.left.is_defined(e)||t.right.is_defined(e);default:return!0}}e(AST_Node,return_false),e(AST_Array,return_true),e(AST_Assign,(function(e){var t=this.operator;return"="==t?this.right.is_defined(e):n(e,t.slice(0,-1),this)})),e(AST_Binary,(function(e){return n(e,this.operator,this)})),e(AST_Conditional,(function(e){return this.consequent.is_defined(e)&&this.alternative.is_defined(e)})),e(AST_Constant,return_true),e(AST_Hole,return_false),e(AST_Lambda,return_true),e(AST_Object,return_true),e(AST_Sequence,(function(e){return this.tail_node().is_defined(e)})),e(AST_SymbolRef,(function(e){if(this.is_undefined)return!1;if(L(this)&&this.is_declared(e))return!0;if(this.is_immutable())return!0;var n=this.fixed_value();if(!n)return!1;this.is_defined=return_false;var t=n.is_defined(e);return delete this.is_defined,t})),e(AST_UnaryPrefix,(function(){return"void"!=this.operator})),e(AST_UnaryPostfix,return_true),e(AST_Undefined,return_false)}((function(e,n){e.DEFMETHOD("is_defined",n)})),function(e){e(AST_Node,return_false),e(AST_Assign,(function(e){return"="==this.operator&&this.right.is_boolean(e)}));var n=makePredicate("in instanceof == != === !== < <= >= >");e(AST_Binary,(function(e){return n[this.operator]||X[this.operator]&&this.left.is_boolean(e)&&this.right.is_boolean(e)})),e(AST_Boolean,return_true);var t=makePredicate("every hasOwnProperty isPrototypeOf propertyIsEnumerable some");e(AST_Call,(function(e){if(!e.option("unsafe"))return!1;var n=this.expression;return n instanceof AST_Dot&&(t[n.property]||"test"==n.property&&n.expression instanceof AST_RegExp)})),e(AST_Conditional,(function(e){return this.consequent.is_boolean(e)&&this.alternative.is_boolean(e)})),e(AST_New,return_false),e(AST_Sequence,(function(e){return this.tail_node().is_boolean(e)})),e(AST_SymbolRef,(function(e){var n=this.fixed_value();if(!n)return!1;this.is_boolean=return_false;var t=n.is_boolean(e);return delete this.is_boolean,t}));var i=makePredicate("! delete");e(AST_UnaryPrefix,(function(){return i[this.operator]}))}((function(e,n){e.DEFMETHOD("is_boolean",n)})),function(e){e(AST_Node,return_false);var n=makePredicate("- * / % ** & | ^ << >> >>>");e(AST_Assign,(function(e){return n[this.operator.slice(0,-1)]||"="==this.operator&&this.right.is_number(e)})),e(AST_Binary,(function(e){return!!n[this.operator]||"+"==this.operator&&((this.left.is_boolean(e)||this.left.is_number(e))&&(this.right.is_boolean(e)||this.right.is_number(e)))}));var t=makePredicate(["charCodeAt","getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTimezoneOffset","getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear","indexOf","lastIndexOf","localeCompare","push","search","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"]);e(AST_Call,(function(e){if(!e.option("unsafe"))return!1;var n=this.expression;return n instanceof AST_Dot&&(t[n.property]||L(n.expression)&&"Math"==n.expression.name)})),e(AST_Conditional,(function(e){return this.consequent.is_number(e)&&this.alternative.is_number(e)})),e(AST_New,return_false),e(AST_Number,return_true),e(AST_Sequence,(function(e){return this.tail_node().is_number(e)})),e(AST_SymbolRef,(function(e,n){var t=this.fixed_value();if(!t)return!1;if(n&&t instanceof AST_UnaryPrefix&&"+"==t.operator&&t.expression.equals(this))return!1;this.is_number=return_false;var i=t.is_number(e);return delete this.is_number,i}));var i=makePredicate("+ - ~ ++ --");e(AST_Unary,(function(){return i[this.operator]}))}((function(e,n){e.DEFMETHOD("is_number",n)})),function(e){e(AST_Node,return_false),e(AST_Assign,(function(e){switch(this.operator){case"+=":if(this.left.is_string(e))return!0;case"=":return this.right.is_string(e)}})),e(AST_Binary,(function(e){return"+"==this.operator&&(this.left.is_string(e)||this.right.is_string(e))}));var n=makePredicate(["charAt","substr","substring","toExponential","toFixed","toLowerCase","toPrecision","toString","toUpperCase","trim"]);e(AST_Call,(function(e){if(!e.option("unsafe"))return!1;var t=this.expression;return t instanceof AST_Dot&&n[t.property]})),e(AST_Conditional,(function(e){return this.consequent.is_string(e)&&this.alternative.is_string(e)})),e(AST_Sequence,(function(e){return this.tail_node().is_string(e)})),e(AST_String,return_true),e(AST_SymbolRef,(function(e){var n=this.fixed_value();if(!n)return!1;this.is_string=return_false;var t=n.is_string(e);return delete this.is_string,t})),e(AST_Template,(function(e){return!this.tag||tn(e,this.tag)})),e(AST_UnaryPrefix,(function(){return"typeof"==this.operator}))}((function(e,n){e.DEFMETHOD("is_string",n)}));var X=makePredicate("&& || ??");function Q(e,n,t){return n.print_to_string().length-e.print_to_string().length<(t||0)?n:e}function Z(e,n,t){return Q(k(AST_SimpleStatement,e,{body:e}),k(AST_SimpleStatement,n,{body:n}),t).body}function ee(e,n,t,i){return(first_in_statement(e)?Z:Q)(n,t,i)}function ne(e){var n=Object.create(null);return Object.keys(e).forEach((function(t){n[t]=makePredicate(e[t])})),n}function te(e){for(var n=0;n<e.length;n++){var t=e[n];if(!(t instanceof AST_Directive))return t}}function ie(){return this.value?k(AST_Return,this.value,{value:this.value}):te(this.body)}function re(e,n){var t=n.evaluate(e);return t===n?n:ee(e,n,t=D(t,n).optimize(e),e.eval_threshold)}!function(e){function n(e,t){if(e instanceof AST_Node)return e.clone(!0);if(Array.isArray(e))return k(AST_Array,t,{elements:e.map((function(e){return n(e,t)}))});if(e&&"object"==typeof e){var i=[];for(var r in e)HOP(e,r)&&i.push(k(AST_ObjectKeyVal,t,{key:r,value:n(e[r],t)}));return k(AST_Object,t,{properties:i})}return D(e,t)}function t(e){AST_Node.warn("global_defs {this} redefined [{start}]",e)}AST_Toplevel.DEFMETHOD("resolve_defines",(function(e){return e.option("global_defs")?(this.figure_out_scope({ie:e.option("ie")}),this.transform(new TreeTransformer((function(n){var i=n._find_defs(e,"");if(i){for(var r,a=0,o=n;(r=this.parent(a++))&&r instanceof AST_PropAccess&&r.expression===o;)o=r;if(!is_lhs(o,r))return i;t(n)}})))):this})),e(AST_Node,noop),e(AST_Dot,(function(e,n){return this.expression._find_defs(e,"."+this.property+n)})),e(AST_SymbolDeclaration,(function(e){this.definition().global&&HOP(e.option("global_defs"),this.name)&&t(this)})),e(AST_SymbolRef,(function(e,t){if(this.definition().global){var i=e.option("global_defs"),r=this.name+t;return HOP(i,r)?n(i[r],this):void 0}}))}((function(e,n){e.DEFMETHOD("_find_defs",n)})),AST_Arrow.DEFMETHOD("first_statement",ie),AST_AsyncArrow.DEFMETHOD("first_statement",ie),AST_Lambda.DEFMETHOD("first_statement",(function(){return te(this.body)})),AST_Lambda.DEFMETHOD("length",(function(){for(var e=this.argnames,n=0;n<e.length&&!(e[n]instanceof AST_DefaultValue);n++);return n}));var ae=["constructor","toString","valueOf"],oe=ne({Array:["indexOf","join","lastIndexOf","slice"].concat(ae),Boolean:ae,Function:ae,Number:["toExponential","toFixed","toPrecision"].concat(ae),Object:ae,RegExp:["exec","test"].concat(ae),String:["charAt","charCodeAt","concat","indexOf","italics","lastIndexOf","match","replace","search","slice","split","substr","substring","toLowerCase","toUpperCase","trim"].concat(ae)}),se=ne({Array:["isArray"],Math:["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","atan2","pow","max","min"],Number:["isFinite","isNaN"],Object:["create","getOwnPropertyDescriptor","getOwnPropertyNames","getPrototypeOf","isExtensible","isFrozen","isSealed","keys"],String:["fromCharCode","raw"]});function fe(e){if(!(e instanceof AST_Dot))return!1;var n=e.expression;if(!L(n))return!1;var t=se[n.name];return t&&(t[e.property]||"Math"==n.name&&"random"==e.property)}!function(e){e(AST_Node,return_false),e(AST_Constant,return_true),e(AST_RegExp,return_false);var n=makePredicate("! ~ - + void");e(AST_UnaryPrefix,(function(){return n[this.operator]&&this.expression instanceof AST_Constant}))}((function(e,n){e.DEFMETHOD("is_constant",n)})),function(e){AST_Node.DEFMETHOD("evaluate",(function(e,n){if(!e.option("evaluate"))return this;var t=[],i=this._eval(e,n,t,1);return t.forEach((function(e){delete e._eval})),n||!i||i instanceof RegExp?i:"function"==typeof i||"object"==typeof i?this:i}));var n=new TreeWalker((function(e){e instanceof AST_Assign&&t(e.left),e instanceof AST_ForEnumeration&&t(e.init),e instanceof AST_Unary&&UNARY_POSTFIX[e.operator]&&t(e.expression)}));function t(e){e instanceof AST_DestructuredArray?e.elements.forEach(t):e instanceof AST_DestructuredObject?e.properties.forEach((function(e){t(e.value)})):e instanceof AST_PropAccess?t(e.expression):e instanceof AST_SymbolRef&&e.definition().references.forEach((function(e){delete e._eval}))}e(AST_Statement,(function(){throw new Error(string_template("Cannot evaluate a statement [{start}]",this))})),e(AST_Accessor,return_this),e(AST_BigInt,return_this),e(AST_Class,return_this),e(AST_Node,return_this),e(AST_Constant,(function(){return this.value})),e(AST_Assign,(function(e,i,r,a){var o=this.left;if(!i){if(!(o instanceof AST_SymbolRef))return this;if(!HOP(o,"_eval")){if(!o.fixed)return this;var s=o.definition();if(!s.fixed)return this;if(s.undeclared)return this;if(s.last_ref!==o)return this;if("m"==s.single_use)return this;if(this.right.has_side_effects(e))return this}}var f,c=this.operator;f=!HOP(o,"_eval")&&o instanceof AST_SymbolRef&&o.fixed&&o.definition().fixed?o:"="==c?this.right:k(AST_Binary,this,{operator:c.slice(0,-1),left:o,right:this.right}),o.walk(n);var u=f._eval(e,i,r,a);return"object"==typeof u?this:(t(o),u)})),e(AST_Sequence,(function(e,t,i,r){if(!t)return this;for(var a=this.expressions,o=0,s=a.length-1;o<s;o++)a[o].walk(n);var f=a[s],c=f._eval(e,t,i,r);return c===f?this:c})),e(AST_Lambda,(function(e){if(e.option("unsafe")){var n=function(){};return n.node=this,n.toString=function(){return"function(){}"},n}return this})),e(AST_Array,(function(e,n,t,i){if(e.option("unsafe")){for(var r=[],a=0;a<this.elements.length;a++){var o=this.elements[a];if(o instanceof AST_Hole)return this;var s=o._eval(e,n,t,i);if(o===s)return this;r.push(s)}return r}return this})),e(AST_Object,(function(e,n,t,i){if(e.option("unsafe")){for(var r={},a=0;a<this.properties.length;a++){var o=this.properties[a];if(!(o instanceof AST_ObjectKeyVal))return this;var s=o.key;if(s instanceof AST_Node&&(s=s._eval(e,n,t,i))===o.key)return this;switch(s){case"__proto__":case"toString":case"valueOf":return this}if(r[s]=o.value._eval(e,n,t,i),r[s]===o.value)return this}return r}return this}));var i=makePredicate("! typeof void");e(AST_UnaryPrefix,(function(e,r,a,o){var s=this.expression,f=this.operator;if(e.option("typeofs")&&"typeof"==f&&(s instanceof AST_Lambda||s instanceof AST_SymbolRef&&s.fixed_value()instanceof AST_Lambda))return"function";var c=s instanceof AST_SymbolRef&&s.definition();i[f]||c&&c.fixed||o++,s.walk(n);var u=s._eval(e,r,a,o);if(u===s){if(r&&"void"==f)return;return this}switch(f){case"!":return!u;case"typeof":return u instanceof RegExp?this:typeof u;case"void":return;case"~":return~u;case"-":return-u;case"+":return+u;case"++":case"--":if(!c)return this;if(!r){if(c.undeclared)return this;if(c.last_ref!==s)return this}return HOP(s,"_eval")&&(u=+(f[0]+1)+ +u),t(s),u}return this})),e(AST_UnaryPostfix,(function(e,i,r,a){var o=this.expression;if(o instanceof AST_SymbolRef){if(!HOP(o,"_eval")){if(!o.fixed)return this;if(!i){var s=o.definition();if(!s.fixed)return this;if(s.undeclared)return this;if(s.last_ref!==o)return this}}}else if(!i)return this;o instanceof AST_SymbolRef&&o.definition().fixed||a++,o.walk(n);var f=o._eval(e,i,r,a);return f===o?this:(t(o),+f)}));var r=makePredicate("&& || === !==");e(AST_Binary,(function(e,n,t,i){r[this.operator]||i++;var a=this.left._eval(e,n,t,i);if(a===this.left)return this;if(this.operator==(a?"||":"&&"))return a;var o,s=n&&!(a&&"object"==typeof a),f=this.right._eval(e,s,t,i);if(f===this.right)return this;switch(this.operator){case"&&":o=a&&f;break;case"||":o=a||f;break;case"??":o=null==a?f:a;break;case"|":o=a|f;break;case"&":o=a&f;break;case"^":o=a^f;break;case"+":o=a+f;break;case"-":o=a-f;break;case"*":o=a*f;break;case"/":o=a/f;break;case"%":o=a%f;break;case"<<":o=a<<f;break;case">>":o=a>>f;break;case">>>":o=a>>>f;break;case"==":o=a==f;break;case"===":o=a===f;break;case"!=":o=a!=f;break;case"!==":o=a!==f;break;case"<":o=a<f;break;case"<=":o=a<=f;break;case">":o=a>f;break;case">=":o=a>=f;break;case"**":o=Math.pow(a,f);break;case"in":if(f&&"object"==typeof f&&HOP(f,a)){o=!0;break}default:return this}if(isNaN(o))return e.find_parent(AST_With)?this:o;if(e.option("unsafe_math")&&!n&&o&&"number"==typeof o&&("+"==this.operator||"-"==this.operator)){var c=Math.max(0,u(a),u(f));if(c<16)return+o.toFixed(c)}return o;function u(e){var n=/(\.[0-9]*)?(e[^e]+)?$/.exec(+e);return(n[1]||".").length-1-(n[2]||"").slice(1)}})),e(AST_Conditional,(function(e,n,t,i){var r=this.condition._eval(e,n,t,i);if(r===this.condition)return this;var a=r?this.consequent:this.alternative,o=a._eval(e,n,t,i);return o===a?this:o})),e(AST_SymbolRef,(function(e,n,t,i){var r,a=this.fixed_value();if(!a)return this;if(HOP(a,"_eval"))r=a._eval();else{if(this._eval=return_this,r=a._eval(e,n,t,i),delete this._eval,r===a)return this;a._eval=function(){return r},t.push(a)}return r&&"object"==typeof r&&!function(e,n){var t=e.definition().escaped;switch(t.length){case 0:return!0;case 1:var i=!1;return t[0].walk(new TreeWalker((function(n){return!!i||(n===e?i=!0:n instanceof AST_Scope||void 0)}))),i;default:return n<=t.depth}}(this,i)?this:r}));var a={Array:Array,Math:Math,Number:Number,Object:Object,String:String},o=ne({Math:["E","LN10","LN2","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"],Number:["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"]}),s=makePredicate("global ignoreCase multiline source");function f(e,n,t,i,r){for(var a=[],o=0;o<e.length;o++){var s=e[o],f=s._eval(n,t,i,r);if(s===f)return;a.push(f)}return a}e(AST_PropAccess,(function(e,n,t,i){if(e.option("unsafe")){var r,f=this.expression;if(!L(f)&&(null==(r=f._eval(e,n,t,i+1))||r===f))return this;var c=this.property;if(c instanceof AST_Node&&(c=c._eval(e,n,t,i))===this.property)return this;if(void 0===r){var u=o[f.name];if(!u||!u[c])return this;r=a[f.name]}else if(r instanceof RegExp){if(!s[c])return this}else if("object"==typeof r){if(!HOP(r,c))return this}else if("function"==typeof r)switch(c){case"name":return r.node.name?r.node.name.name:"";case"length":return r.node.length();default:return this}return r[c]}return this})),e(AST_Call,(function(e,t,i,r){var o=this.expression,s=o instanceof AST_SymbolRef?o.fixed_value():o;if(s instanceof AST_Arrow||s instanceof AST_Defun||s instanceof AST_Function){if(s.evaluating)return this;if(s.name&&s.name.definition().recursive_refs>0)return this;if(this.is_expr_pure(e))return this;var c=f(this.args,e,t,i,r);if(!all(s.argnames,(function(n,a){if(n instanceof AST_DefaultValue){if(!c)return!1;if(void 0===c[a]){var o=n.value._eval(e,t,i,r);if(o===n.value)return!1;c[a]=o}n=n.name}return!(n instanceof AST_Destructured)})))return this;if(s.rest instanceof AST_Destructured)return this;if(!c&&!t)return this;var u=s.first_statement();if(!(u instanceof AST_Return)){if(t){s.walk(n);var l=!1;if(s.evaluating=!0,walk_body(s,new TreeWalker((function(n){return!!l||(n instanceof AST_Return?(n.value&&void 0!==n.value._eval(e,!0,i,r)&&(l=!0),!0):n instanceof AST_Scope&&n!==s||void 0)}))),s.evaluating=!1,!l)return}return this}if(!(S=u.value))return;var _=[];return(!c||all(s.argnames,(function(e,n){return h(e,c[n])}))&&(!s.rest||h(s.rest,c.slice(s.argnames.length)))||t)&&(t&&s.argnames.forEach((function(e){e instanceof AST_DefaultValue&&e.value.walk(n)})),s.evaluating=!0,S=S._eval(e,t,i,r),s.evaluating=!1),_.forEach((function(e){delete e._eval})),S===u.value?this:S}if(e.option("unsafe")&&o instanceof AST_PropAccess){var S,p=o.property;if(p instanceof AST_Node&&(p=p._eval(e,t,i,r))===o.property)return this;var d=o.expression;if(L(d)){var T=se[d.name];if(!T||!T[p])return this;S=a[d.name]}else{if(null==(S=d._eval(e,t,i,r+1))||S===d)return this;var A=oe[S.constructor.name];if(!A||!A[p])return this;if(S instanceof RegExp&&S.global&&!(d instanceof AST_RegExp))return this}if(!(c=f(this.args,e,t,i,r)))return this;if("replace"==p&&"function"==typeof c[1])return this;try{return S[p].apply(S,c)}catch(v){AST_Node.warn("Error evaluating {this} [{start}]",this)}finally{S instanceof RegExp&&(S.lastIndex=0)}}return this;function h(e,n){e instanceof AST_DefaultValue&&(e=e.name);var t=e.definition();if(t.orig[t.orig.length-1]!==e)return!1;var i=n;return t.references.forEach((function(e){e._eval=function(){return i},_.push(e)})),!0}})),e(AST_New,return_this),e(AST_Template,(function(e,n,t,i){if(!e.option("templates"))return this;if(this.tag){if(!tn(e,this.tag))return this;c=function(e){return e}}var r=f(this.expressions,e,n,t,i);if(!r)return this;for(var a=!1,o=c(this.strings[0]),s=0;s<r.length;s++)o+=r[s]+c(this.strings[s+1]);return a?(this._eval=return_this,this):o;function c(e){return"string"!=typeof(e=rn(e))&&(a=!0),e}}))}((function(e,n){e.DEFMETHOD("_eval",n)})),function(e){function n(e){return k(AST_UnaryPrefix,e,{operator:"!",expression:e})}function t(e,t,i){var r=n(e);return i?Q(r,k(AST_SimpleStatement,t,{body:t}))===r?r:t:Q(r,t)}e(AST_Node,(function(){return n(this)})),e(AST_Statement,(function(){throw new Error("Cannot negate a statement")})),e(AST_Binary,(function(e,i){var r=this.clone(),a=this.operator;if(e.option("unsafe_comps"))switch(a){case"<=":return r.operator=">",r;case"<":return r.operator=">=",r;case">=":return r.operator="<",r;case">":return r.operator="<=",r}switch(a){case"==":return r.operator="!=",r;case"!=":return r.operator="==",r;case"===":return r.operator="!==",r;case"!==":return r.operator="===",r;case"&&":return r.operator="||",r.left=r.left.negate(e,i),r.right=r.right.negate(e),t(this,r,i);case"||":return r.operator="&&",r.left=r.left.negate(e,i),r.right=r.right.negate(e),t(this,r,i)}return n(this)})),e(AST_ClassExpression,(function(){return n(this)})),e(AST_Conditional,(function(e,n){var i=this.clone();return i.consequent=i.consequent.negate(e),i.alternative=i.alternative.negate(e),t(this,i,n)})),e(AST_LambdaExpression,(function(){return n(this)})),e(AST_Sequence,(function(e){var n=this.expressions.slice();return n.push(n.pop().negate(e)),w(this,n)})),e(AST_UnaryPrefix,(function(){return"!"==this.operator?this.expression:n(this)}))}((function(e,n){e.DEFMETHOD("negate",(function(e,t){return n.call(this,e,t)}))}));var ce=makePredicate("Boolean decodeURI decodeURIComponent Date encodeURI encodeURIComponent Error escape EvalError isFinite isNaN Number Object parseFloat parseInt RangeError ReferenceError String SyntaxError TypeError unescape URIError"),ue=makePredicate("Map Set WeakMap WeakSet");function le(e){return e&&e.aborts()}AST_Call.DEFMETHOD("is_expr_pure",(function(e){if(e.option("unsafe")){var n=this.expression;if(L(n)){if(ce[n.name])return!0;if(this instanceof AST_New&&ue[n.name])return!0}if(fe(n))return!0}return e.option("annotations")&&this.pure||!e.pure_funcs(this)})),AST_Template.DEFMETHOD("is_expr_pure",(function(e){var n=this.tag;if(!n)return!0;if(e.option("unsafe")){if(L(n)&&ce[n.name])return!0;if(n instanceof AST_Dot&&L(n.expression)){var t=se[n.expression.name];return t&&(t[n.property]||"Math"==n.expression.name&&"random"==n.property)}}return!e.pure_funcs(this)})),AST_Node.DEFMETHOD("is_call_pure",return_false),AST_Call.DEFMETHOD("is_call_pure",(function(e){if(!e.option("unsafe"))return!1;var n=this.expression;if(!(n instanceof AST_Dot))return!1;var t,i=n.expression,r=n.property;if(i instanceof AST_Array)t=oe.Array;else if(i.is_boolean(e))t=oe.Boolean;else if(i.is_number(e))t=oe.Number;else if(i instanceof AST_RegExp)t=oe.RegExp;else if(i.is_string(e)){if(t=oe.String,"replace"==r){var a=this.args[1];if(a&&!a.is_string(e))return!1}}else n.may_throw_on_access(e)||(t=oe.Object);return t&&t[r]})),function(e){e(AST_Node,return_false),e(AST_Array,return_true),e(AST_Assign,(function(){switch(this.operator){case"=":return this.right.safe_to_spread();case"&&=":case"||=":case"??=":return this.left.safe_to_spread()&&this.right.safe_to_spread()}return!0})),e(AST_Binary,(function(){return!X[this.operator]||this.left.safe_to_spread()&&this.right.safe_to_spread()})),e(AST_Constant,return_true),e(AST_Lambda,return_true),e(AST_Object,(function(){return all(this.properties,(function(e){return!(e instanceof AST_ObjectGetter||e instanceof AST_Spread)}))})),e(AST_Sequence,(function(){return this.tail_node().safe_to_spread()})),e(AST_SymbolRef,(function(){var e=this.fixed_value();return e&&e.safe_to_spread()})),e(AST_Unary,return_true)}((function(e,n){e.DEFMETHOD("safe_to_spread",n)})),function(e){function n(e,n,t){return!all(e,t?function(e){return e instanceof AST_Spread?!t(e,n):!e.has_side_effects(n)}:function(e){return!e.has_side_effects(n)})}function t(e,n){var t=e.expression;return!t.is_string(n)||t.has_side_effects(n)}e(AST_Node,return_true),e(AST_Array,(function(e){return n(this.elements,e,t)})),e(AST_Assign,(function(e){var n=this.left;if(!(n instanceof AST_PropAccess))return!0;var t=n.expression;return!(t instanceof AST_ObjectIdentity)||!t.scope.resolve().new||n instanceof AST_Sub&&n.property.has_side_effects(e)||this.right.has_side_effects(e)})),e(AST_Binary,(function(e){return this.left.has_side_effects(e)||this.right.has_side_effects(e)||!$e(this.operator,this.right,e)})),e(AST_Block,(function(e){return n(this.body,e)})),e(AST_Call,(function(e){return!(this.is_expr_pure(e)||this.is_call_pure(e)&&!this.expression.has_side_effects(e))||n(this.args,e,t)})),e(AST_Case,(function(e){return this.expression.has_side_effects(e)||n(this.body,e)})),e(AST_Class,(function(e){var t=this.extends;return!(!t||(t instanceof AST_SymbolRef&&(t=t.fixed_value()),a(t)))||n(this.properties,e)})),e(AST_ClassProperty,(function(e){return this.key instanceof AST_Node&&this.key.has_side_effects(e)||this.static&&this.value&&this.value.has_side_effects(e)})),e(AST_Conditional,(function(e){return this.condition.has_side_effects(e)||this.consequent.has_side_effects(e)||this.alternative.has_side_effects(e)})),e(AST_Constant,return_false),e(AST_Definitions,(function(e){return n(this.definitions,e)})),e(AST_DestructuredArray,(function(e){return n(this.elements,e)})),e(AST_DestructuredKeyVal,(function(e){return this.key instanceof AST_Node&&this.key.has_side_effects(e)||this.value.has_side_effects(e)})),e(AST_DestructuredObject,(function(e){return n(this.properties,e)})),e(AST_Dot,(function(e){return this.expression.may_throw_on_access(e)||this.expression.has_side_effects(e)})),e(AST_EmptyStatement,return_false),e(AST_If,(function(e){return this.condition.has_side_effects(e)||this.body&&this.body.has_side_effects(e)||this.alternative&&this.alternative.has_side_effects(e)})),e(AST_LabeledStatement,(function(e){return this.body.has_side_effects(e)})),e(AST_Lambda,return_false),e(AST_Object,(function(e){return n(this.properties,e,(function(e,n){var t=e.expression;return!t.safe_to_spread()||t.has_side_effects(n)}))})),e(AST_ObjectIdentity,return_false),e(AST_ObjectProperty,(function(e){return this.key instanceof AST_Node&&this.key.has_side_effects(e)||this.value.has_side_effects(e)})),e(AST_Sequence,(function(e){return n(this.expressions,e)})),e(AST_SimpleStatement,(function(e){return this.body.has_side_effects(e)})),e(AST_Sub,(function(e){return this.expression.may_throw_on_access(e)||this.expression.has_side_effects(e)||this.property.has_side_effects(e)})),e(AST_Switch,(function(e){return this.expression.has_side_effects(e)||n(this.body,e)})),e(AST_SymbolDeclaration,return_false),e(AST_SymbolRef,(function(e){return!this.is_declared(e)||!f(this,e)})),e(AST_Template,(function(e){return!this.is_expr_pure(e)||n(this.expressions,e)})),e(AST_Try,(function(e){return n(this.body,e)||this.bcatch&&this.bcatch.has_side_effects(e)||this.bfinally&&this.bfinally.has_side_effects(e)})),e(AST_Unary,(function(e){return unary_side_effects[this.operator]||this.expression.has_side_effects(e)})),e(AST_VarDef,(function(){return this.value}))}((function(e,n){e.DEFMETHOD("has_side_effects",n)})),function(e){function n(e,n){for(var t=e.length;--t>=0;)if(e[t].may_throw(n))return!0;return!1}function t(e,t){return!!e.may_throw(t)||(e instanceof AST_SymbolRef&&(e=e.fixed_value()),!(e instanceof AST_Lambda)||(!!n(e.argnames,t)||(!!n(e.body,t)||is_arrow(e)&&e.value&&e.value.may_throw(t))))}e(AST_Node,return_true),e(AST_Constant,return_false),e(AST_EmptyStatement,return_false),e(AST_Lambda,return_false),e(AST_ObjectIdentity,return_false),e(AST_SymbolDeclaration,return_false),e(AST_Array,(function(e){return n(this.elements,e)})),e(AST_Assign,(function(e){return!!this.right.may_throw(e)||!(!e.has_directive("use strict")&&"="==this.operator&&this.left instanceof AST_SymbolRef)&&this.left.may_throw(e)})),e(AST_Await,(function(e){return this.expression.may_throw(e)})),e(AST_Binary,(function(e){return this.left.may_throw(e)||this.right.may_throw(e)||!$e(this.operator,this.right,e)})),e(AST_Block,(function(e){return n(this.body,e)})),e(AST_Call,(function(e){if(n(this.args,e))return!0;if(this.is_expr_pure(e))return!1;this.may_throw=return_true;var i=t(this.expression,e);return delete this.may_throw,i})),e(AST_Case,(function(e){return this.expression.may_throw(e)||n(this.body,e)})),e(AST_Conditional,(function(e){return this.condition.may_throw(e)||this.consequent.may_throw(e)||this.alternative.may_throw(e)})),e(AST_DefaultValue,(function(e){return this.name.may_throw(e)||this.value&&this.value.may_throw(e)})),e(AST_Definitions,(function(e){return n(this.definitions,e)})),e(AST_Dot,(function(e){return!this.optional&&this.expression.may_throw_on_access(e)||this.expression.may_throw(e)})),e(AST_ForEnumeration,(function(e){if(this.init.may_throw(e))return!0;var n=this.object;return!!n.may_throw(e)||(!((n=n.tail_node())instanceof AST_Array||n.is_string(e))||this.body.may_throw(e))})),e(AST_If,(function(e){return this.condition.may_throw(e)||this.body&&this.body.may_throw(e)||this.alternative&&this.alternative.may_throw(e)})),e(AST_LabeledStatement,(function(e){return this.body.may_throw(e)})),e(AST_Object,(function(e){return n(this.properties,e)})),e(AST_ObjectProperty,(function(e){return this.value.may_throw(e)||this.key instanceof AST_Node&&this.key.may_throw(e)})),e(AST_Return,(function(e){return this.value&&this.value.may_throw(e)})),e(AST_Sequence,(function(e){return n(this.expressions,e)})),e(AST_SimpleStatement,(function(e){return this.body.may_throw(e)})),e(AST_Sub,(function(e){return!this.optional&&this.expression.may_throw_on_access(e)||this.expression.may_throw(e)||this.property.may_throw(e)})),e(AST_Switch,(function(e){return this.expression.may_throw(e)||n(this.body,e)})),e(AST_SymbolRef,(function(e){return!this.is_declared(e)||!f(this,e)})),e(AST_Template,(function(e){if(n(this.expressions,e))return!0;if(this.is_expr_pure(e))return!1;if(!this.tag)return!1;this.may_throw=return_true;var i=t(this.tag,e);return delete this.may_throw,i})),e(AST_Try,(function(e){return(this.bcatch?this.bcatch.may_throw(e):n(this.body,e))||this.bfinally&&this.bfinally.may_throw(e)})),e(AST_Unary,(function(e){return this.expression.may_throw(e)&&!("typeof"==this.operator&&this.expression instanceof AST_SymbolRef)})),e(AST_VarDef,(function(e){return this.name.may_throw(e)||this.value&&this.value.may_throw(e)}))}((function(e,n){e.DEFMETHOD("may_throw",n)})),function(e){function n(e,n){for(var t=e.length;--t>=0;)if(!e[t].is_constant_expression(n))return!1;return!0}e(AST_Node,return_false),e(AST_Array,(function(e){return n(this.elements,e)})),e(AST_Binary,(function(e){return this.left.is_constant_expression(e)&&this.right.is_constant_expression(e)&&$e(this.operator,this.right)})),e(AST_Class,(function(e){var t=this.extends;return!(t&&!a(t))&&n(this.properties,e)})),e(AST_ClassProperty,(function(e){return"string"==typeof this.key&&(!this.value||this.value.is_constant_expression(e))})),e(AST_Constant,return_true),e(AST_Lambda,(function(e){var n=this,t=!0,i=[];return n.walk(new TreeWalker((function(r,a){if(!t)return!0;if(r instanceof AST_BlockScope){if(r===n)return;return i.push(r),a(),i.pop(),!0}if(r instanceof AST_SymbolRef){if(n.inlined||r.redef||r.in_arg)return t=!1,!0;if(n.variables.has(r.name))return!0;var o=r.definition();if(member(o.scope,i))return!0;if(e&&!o.redefined()){var s=e.find_variable(r.name);if(s?s===o:o.undeclared)return t="f",!0}return t=!1,!0}return r instanceof AST_ObjectIdentity?(is_arrow(n)&&all(i,(function(e){return!(e instanceof AST_Scope)||is_arrow(e)}))&&(t=!1),!0):void 0}))),t})),e(AST_Object,(function(e){return n(this.properties,e)})),e(AST_ObjectProperty,(function(e){return"string"==typeof this.key&&this.value.is_constant_expression(e)})),e(AST_Unary,(function(e){return this.expression.is_constant_expression(e)}))}((function(e,n){e.DEFMETHOD("is_constant_expression",n)})),function(e){function n(){var e=this.body.length;return e>0&&le(this.body[e-1])}e(AST_Statement,return_null),e(AST_Jump,return_this),e(AST_BlockStatement,n),e(AST_SwitchBranch,n),e(AST_If,(function(){return this.alternative&&le(this.body)&&le(this.alternative)&&this}))}((function(e,n){e.DEFMETHOD("aborts",n)}));var _e=makePredicate(["use asm","use strict"]);function Se(e,n,t){switch(e.body.length){case 0:return t?List.skip:k(AST_EmptyStatement,e);case 1:var i=e.body[0];return O(i)?n instanceof AST_IterationStatement&&i instanceof AST_LambdaDefinition?e:i:e}return e}function pe(e,n){n.option("rests")&&(e.uses_arguments||e.rest instanceof AST_DestructuredArray&&n.drop_fargs(e,n.parent())&&(e.argnames=e.argnames.concat(e.rest.elements),e.rest=e.rest.rest))}function de(e,n){if(!n.option("arrows"))return e;pe(e,n),e.value&&(e.body=[e.first_statement()]);var t=G(e.body,n);switch(t.length){case 1:var i=t[0];if(i instanceof AST_Return){e.body.length=0,e.value=i.value;break}default:e.body=t,e.value=null}return e}e(AST_Directive,(function(e,n){return!n.option("directives")||_e[e.value]&&n.has_directive(e.value)===e?e:k(AST_EmptyStatement,e)})),e(AST_Debugger,(function(e,n){return n.option("drop_debugger")?k(AST_EmptyStatement,e):e})),e(AST_LabeledStatement,(function(e,n){if(e.body instanceof AST_If||e.body instanceof AST_Break){var t=G([e.body],n);switch(t.length){case 0:e.body=k(AST_EmptyStatement,e);break;case 1:e.body=t[0];break;default:e.body=k(AST_BlockStatement,e,{body:t})}}return n.option("unused")&&0==e.label.references.length?e.body:e})),e(AST_LoopControl,(function(e,n){if(!n.option("dead_code"))return e;var t=e.label;if(t){var i=n.loopcontrol_target(e);e.label=null,n.loopcontrol_target(e)===i?remove(t.thedef.references,e):e.label=t}return e})),e(AST_Block,(function(e,n){return e.body=G(e.body,n),e})),e(AST_BlockStatement,(function(e,n){return e.body=G(e.body,n),Se(e,n.parent())})),e(AST_Lambda,(function(e,n){return pe(e,n),e.body=G(e.body,n),e})),e(AST_Arrow,de),e(AST_AsyncArrow,de),e(AST_Function,(function(e,n){pe(e,n),e.body=G(e.body,n);var t=n.parent();if(n.option("inline"))for(var i=0;i<e.body.length;i++){var r=e.body[i];if(!(r instanceof AST_Directive)){if(r instanceof AST_Return){if(i!=e.body.length-1)break;var a=r.value;if(!a||"Call"!=a.TYPE)break;if(a.is_expr_pure(n))break;var o,s=a.expression;if(s instanceof AST_SymbolRef){if(e.name&&e.name.definition()===s.definition())break;o=s.fixed_value()}else o=s;if(!(o instanceof AST_Defun||o instanceof AST_Function))break;if(o.rest)break;if(o.uses_arguments)break;if(o===s){if(o.parent_scope!==e)break;if(!all(o.enclosed,(function(n){return n.scope!==e})))break}if((o!==s||o.name)&&(t instanceof AST_ClassMethod||t instanceof AST_ObjectMethod)&&t.value===n.self())break;if(o.contains_this())break;var f=o.argnames.length;if(f>0&&n.option("inline")<2)break;if(f>e.argnames.length)break;if(!all(e.argnames,(function(e){return e instanceof AST_SymbolFunarg})))break;if(!all(a.args,(function(e){return!(e instanceof AST_Spread)})))break;for(var c=0;c<f;c++){var u=a.args[c];if(!(u instanceof AST_SymbolRef))break;if(u.definition()!==e.argnames[c].definition())break}if(c<f)break;for(;c<a.args.length&&!a.args[c].has_side_effects(n);c++);if(c<a.args.length)break;if(f<e.argnames.length&&!n.drop_fargs(e,t)){if(!n.drop_fargs(o,a))break;do{o.argnames.push(o.make_var(AST_SymbolFunarg,o,"argument_"+f))}while(++f<e.argnames.length)}return s}break}}return e}));var Te=makePredicate("arguments await yield");function Ae(e,n){for(var t=n.length;--t>=0;)n[t]||(n[t]=k(AST_Hole,e))}function he(e,n){var t=k(AST_ClassExpression,e);return t.name&&(t.name=n?null:k(AST_SymbolClass,t.name)),t}function ve(e,n){var t;switch(e.CTOR){case AST_AsyncDefun:t=AST_AsyncFunction;break;case AST_AsyncGeneratorDefun:t=AST_AsyncGeneratorFunction;break;case AST_Defun:t=AST_Function;break;case AST_GeneratorDefun:t=AST_GeneratorFunction}var i=k(t,e);return i.name=n?null:k(AST_SymbolLambda,e.name),i}function me(e,n){e.walk(new TreeWalker((function(t){return t instanceof AST_Return?(n(t),!0):t instanceof AST_Scope&&t!==e||void 0})))}function ye(e){var n=Object.create(null);return me(e,(function(e){var t=e.value;if(t&&(t=t.tail_node()),t instanceof AST_SymbolRef){var i=t.definition().id;n[i]=(n[i]||0)+1}})),n}function ge(e,n,t){if(t.exposed(e))return!1;switch(e.references.length-e.replaced-(n[e.id]||0)){case e.drop_return:return"d";case e.bool_return:return!0}}function be(e,n){me(e,(function(e){e.in_bool=!0;var t=e.value;if(t){var i=Ce(n,t);i?i instanceof AST_Node||(t=t.drop_side_effect_free(n),e.value=t?w(e.value,[t,k(AST_Number,e.value,{value:1})]):k(AST_Number,e.value,{value:1})):(t=t.drop_side_effect_free(n),e.value=t?w(e.value,[t,k(AST_Number,e.value,{value:0})]):null)}}))}function xe(e,n){if(!e.name||!n.option("ie"))return!0;var t=e.name.definition();return!n.exposed(t)&&all(t.references,(function(e){return!(e instanceof AST_SymbolRef)}))}function ke(e,n,t){if(n instanceof AST_Lambda){var i=is_arrow(n),r=is_async(n),a=!1,o=!1;if(i&&e.option("arrows"))if(n.value){if(!r||Je(e,n.value)){var s=n.value.drop_side_effect_free(e);s!==n.value&&(a=!0,n.value=s)}}else o=!0;else if(!is_generator(n))if(!t&&n.name){var f=n.name.definition();o=f.references.length==f.replaced}else o=!0;if(o&&(n.process_expression(!1,(function(n){var t=n.value;if(t){if(r&&!Je(e,t))return n;t=t.drop_side_effect_free(e,!0)}return a=!0,t?k(AST_SimpleStatement,n,{body:t}):k(AST_EmptyStatement,n)})),me(n,(function(n){var t=n.value;if(t){if(r&&!Je(e,t))return;var i=t.drop_side_effect_free(e);i!==t&&(a=!0,i&&r&&!Je(e,i)&&(i=i.negate(e)),n.value=i)}}))),r&&e.option("awaits")){o&&n.process_expression("awaits",(function(n){var t=n.body;if(t instanceof AST_Await){if(Je(e,t.expression)){if(a=!0,!(t=t.expression.drop_side_effect_free(e,!0)))return k(AST_EmptyStatement,n);n.body=t}}else if(t instanceof AST_Sequence){for(var i=t.expressions,r=i.length;--r>=0;){var o=i[r];if(!(o instanceof AST_Await))break;var s=o.expression;if(!Je(e,s))break;if(a=!0,i[r]=s.drop_side_effect_free(e))break}switch(r){case-1:return k(AST_EmptyStatement,n);case 0:n.body=i[0];break;default:i.length=r+1}}return n}));var c=!o&&n.name||i&&n.value&&!Je(e,n.value),u=new TreeWalker((function(t){return!!c||(u.parent()===n&&t.may_throw(e)||t instanceof AST_Await||t instanceof AST_ForAwaitOf?c=!0:t instanceof AST_Return?t.value&&!Je(e,t.value)?c=!0:void 0:t instanceof AST_Scope&&t!==n||void 0)}));if(n.walk(u),!c){var l;switch(n.CTOR){case AST_AsyncArrow:l=AST_Arrow;break;case AST_AsyncFunction:l=AST_Function;break;case AST_AsyncGeneratorFunction:l=AST_GeneratorFunction}return k(l,n)}}return a&&n.clone()}}function we(e,n,t){t||(t=AST_LoopControl);var i=!1,r=new TreeWalker((function(n){return!!(i||n instanceof AST_Scope)||(n instanceof t&&r.loopcontrol_target(n)===e?i=!0:void 0)}));return n instanceof AST_LabeledStatement&&r.push(n),r.push(e),e.body.walk(r),i}function De(e,n){var t=o(e.body);if(n.option("dead_code")&&(t instanceof AST_Break||t instanceof AST_Continue&&s(t)||t instanceof AST_Exit)){var i=[];is_statement(e.init)?i.push(e.init):e.init&&i.push(k(AST_SimpleStatement,e.init,{body:e.init}));var r=s(t)||t instanceof AST_Exit;return e.condition&&r?i.push(k(AST_If,e,{condition:e.condition,body:t,alternative:null})):e.condition?i.push(k(AST_SimpleStatement,e.condition,{body:e.condition})):r&&i.push(t),$(n,e.body,i),k(AST_BlockStatement,e,{body:i})}if(t instanceof AST_If){var a=o(t.body);if(a instanceof AST_Break&&!s(a)){e.condition?e.condition=k(AST_Binary,e.condition,{left:e.condition,operator:"&&",right:t.condition.negate(n)}):e.condition=t.condition.negate(n);i=P(t.alternative);return $(n,t.body,i),f(i)}if((a=o(t.alternative))instanceof AST_Break&&!s(a)){e.condition?e.condition=k(AST_Binary,e.condition,{left:e.condition,operator:"&&",right:t.condition}):e.condition=t.condition;i=P(t.body);return $(n,t.alternative,i),f(i)}}return e;function o(e){return e instanceof AST_BlockStatement?e.body[0]:e}function s(e){return n.loopcontrol_target(e)!==n.self()}function f(t){return e.body instanceof AST_BlockStatement?(e.body=e.body.clone(),e.body.body=t.concat(e.body.body.slice(1)),e.body=e.body.transform(n)):e.body=k(AST_BlockStatement,e.body,{body:t}).transform(n),De(e,n)}}function Ee(e,n,t){if(e instanceof AST_Sequence&&(e=e.tail_node()),e instanceof AST_Binary)if(e.left instanceof AST_String){if(e.right instanceof AST_UnaryPrefix&&"typeof"==e.right.operator){var i=e.right.expression;if(L(i)){var r,a="undefined"==e.left.value;switch(e.operator){case"==":r=a?t:n;break;case"!=":r=a?n:t;break;default:return}if(r){var o,s=!1,f=i.definition(),c=[],u=[],l=new TreeWalker((function(e,n){if(s)return!0;if(e instanceof AST_Assign){var t=e.left;if(!(t instanceof AST_SymbolRef&&t.definition()===f))return;switch(e.right.walk(l),e.operator){case"=":case"&&=":s=!0}return!0}if(e instanceof AST_Call)return n(),(o=e.expression.tail_node())instanceof AST_SymbolRef&&(o=o.fixed_value(),i=c.length),o instanceof AST_Lambda?push_uniq(u,o)&&o.walk(l):s=!0,i>=0&&(c.length=i),!0;if(e instanceof AST_DWLoop){var i=c.length;return n(),s&&(c.length=i),!0}if(e instanceof AST_For){e.init&&e.init.walk(l);i=c.length;return e.condition&&e.condition.walk(l),e.body.walk(l),e.step&&e.step.walk(l),s&&(c.length=i),!0}if(e instanceof AST_ForEnumeration){e.object.walk(l);i=c.length;return e.init.walk(l),e.body.walk(l),s&&(c.length=i),!0}if(e instanceof AST_Scope){if(e===o)return;return!0}return e instanceof AST_SymbolRef?(e.definition()===f&&c.push(e),!0):void 0}));r.walk(l),c.forEach((function(e){e.defined=!0}))}}}}else switch(e.operator){case"&&":Ee(e.left,n),Ee(e.right,n);break;case"||":Ee(_(e.left),t),Ee(_(e.right),t)}function _(e){if(e instanceof AST_Binary)switch(e.operator){case"==":return(e=e.clone()).operator="!=",e;case"!=":return(e=e.clone()).operator="==",e}}}function Ce(e,n,t){return!!n.truthy||(J(n)?void 0:!(n.falsy&&!t)&&(!!n.is_truthy()||n.evaluate(e,!0)))}function Ne(e,n){var t,i=0,r=!1,a=e.self();if(!is_statement(a))for(;;){if(t=a,(a=e.parent(i++))instanceof AST_Binary)switch(t){case a.left:if(X[a.operator])continue;break;case a.right:if(s(a.left))switch(a.operator){case"&&":n[r?"falsy":"truthy"]=!0;break;case"||":case"??":n[r?"truthy":"falsy"]=!0}}else if(a instanceof AST_Conditional){var o=a.condition;if(o===t)continue;if(s(o))switch(t){case a.consequent:n[r?"falsy":"truthy"]=!0;break;case a.alternative:n[r?"truthy":"falsy"]=!0}}else{if(a instanceof AST_Exit)break;if(a instanceof AST_If)break;if(a instanceof AST_Sequence){if(a.expressions[0]===t)continue}else if(a instanceof AST_SimpleStatement)break}return}for(;;){if(t=a,(a=e.parent(i++))instanceof AST_BlockStatement){if(a.body[0]===t)continue}else if(a instanceof AST_If&&s(a.condition))switch(t){case a.body:n[r?"falsy":"truthy"]=!0;break;case a.alternative:n[r?"truthy":"falsy"]=!0}return}function s(e){return!!n.equals(e)||e instanceof AST_UnaryPrefix&&("!"==e.operator&&(!!n.equals(e.expression)&&(r=!0,!0)))}}function Re(e){return function(n,t){var i=!1;return this.definitions.forEach((function(r){r.value&&(i=!0),r.name.match_symbol((function(i){i instanceof AST_SymbolDeclaration&&t.push(k(AST_VarDef,i,{name:i,value:e(n,i)}))}),!0)})),i}}function Be(e){return"arguments"!=e.name&&e.orig.length<(e.orig[0]instanceof AST_SymbolLambda?3:2)}function Oe(e,n){if(e.exposed(n))return!0;for(var t=n.scope.resolve(),i=n.scope;i!==t;)if((i=i.parent_scope).var_names().has(n.name))return!0}function Pe(e,n){return k(AST_Var,e,{definitions:e.definitions.map((function(e){return k(AST_VarDef,e,{name:e.name.convert_symbol(AST_SymbolVar,(function(e,t){var i=e.definition();i.orig[i.orig.indexOf(t)]=e,i.scope!==n&&(i.scope=n,n.variables.set(i.name,i),n.enclosed.push(i),n.var_names().set(i.name,!0))})),value:e.value})}))})}function Fe(e,n){var t=n.definition();return(t.fixed||0===t.fixed)&&Be(t)&&nn(t)&&!Oe(e,t)}function qe(e,n){return n.option("varify")&&all(e.definitions,(function(e){return!e.name.match_symbol((function(e){if(e instanceof AST_SymbolDeclaration)return!Fe(n,e)}),!0)}))?Pe(e,n.find_parent(AST_Scope)):e}function Ue(e,n){if(n.option("optional_chains")&&e.terminal)do{var t=e.expression;if(e.optional){var i=Ce(n,t,!0);if(null==i)return k(AST_UnaryPrefix,e,{operator:"void",expression:t}).optimize(n);i instanceof AST_Node||(e.optional=!1)}e=t}while(("Call"==e.TYPE||e instanceof AST_PropAccess)&&!e.terminal)}function ze(e,n){var t=e.expression;if(!(t instanceof AST_Sequence))return e;var i=t.expressions.slice(),r=e.clone();return r.expression=i.pop(),i.push(r),w(e,i)}function je(e,n,t){var i=e.expression,r=i instanceof AST_SymbolRef?i.fixed_value():i;if(r instanceof AST_Lambda&&!r.uses_arguments&&!r.pinned()&&!(t&&t.indexOf(r)<0)){var a=e.args;if(all(a,(function(e){return!(e instanceof AST_Spread)}))){var o=r.argnames,s=r===i&&!r.name;if(r.rest){if(!s||!n.option("rests"))return;var f=o.length;for(a=a.slice(0,f);a.length<f;)a.push(k(AST_Undefined,e).optimize(n));a.push(k(AST_Array,e,{elements:e.args.slice(f)})),o=o.concat(r.rest),r.rest=null}else a=a.slice(),o=o.slice();for(var c=0,u=0,l=s&&n.option("default_values"),_=s&&n.drop_fargs(r,e)?function(e,t){return!e||(e instanceof AST_DestructuredArray?0==e.elements.length&&!e.rest&&t instanceof AST_Array:e instanceof AST_DestructuredObject?0==e.properties.length&&!e.rest&&t&&!t.may_throw_on_access(n):e.unused)}:return_false,S=[],p=0;p<a.length;p++){var d=o[p];if(l&&d instanceof AST_DefaultValue&&a[p].is_defined(n)&&(o[p]=d=d.name),d&&void 0===d.unused){if(_(d,a[p])){T=a[p].drop_side_effect_free(n);o.splice(p,1),a.splice(p,1),T&&S.push(T),p--;continue}S.push(a[p]),a[c++]=w(e,S),S=[]}else{var T=a[p].drop_side_effect_free(n);if(_(d)){d&&o.splice(p,1),a.splice(p,1),T&&S.push(T),p--;continue}if(T)S.push(T),a[c++]=w(e,S),S=[];else if(d){if(!S.length){a[c++]=k(AST_Number,a[p],{value:0});continue}a[c++]=w(e,S),S=[]}}u=c}for(;p<o.length;p++)_(o[p])&&o.splice(p--,1);if(r.argnames=o,a.length=u,e.args=a,S.length){var A=w(e,S);a.push(a.length<o.length?k(AST_UnaryPrefix,e,{operator:"void",expression:A}):A)}}}}function Le(e,n){n||(n=e.find_parent(AST_Scope));var t=[];return(is_async(n)||n instanceof AST_Toplevel&&e.option("module"))&&t.push("await"),is_generator(n)&&t.push("yield"),t.length&&makePredicate(t)}function Ve(e,n){if(!n)return!0;var t=!0,i=new TreeWalker((function(r){if(!t)return!0;if(r instanceof AST_Scope){if(r===e)return;if(is_arrow(r))for(var a=0;t&&a<r.argnames.length;a++)r.argnames[a].walk(i);else r instanceof AST_LambdaDefinition&&n[r.name.name]&&(t=!1);return!0}r instanceof AST_Symbol&&n[r.name]&&r!==e.name&&(t=!1)}));return e.walk(i),t}function Ie(e,n){return e.in_strict_mode(n)||!n.has_directive("use strict")}function Me(e,n,t,i){if(i instanceof AST_Binary&&("&&"==i.operator||"||"==i.operator)&&i.right instanceof AST_Assign&&"="==i.right.operator&&i.right.left instanceof AST_SymbolRef&&i.right.left.definition()===n&&!t.has_side_effects(e)&&r(i.left)&&r(i.right.right))return n.replaced++,"&&"==i.operator?k(AST_Conditional,i,{condition:i.left,consequent:i.right.right,alternative:t}):k(AST_Conditional,i,{condition:i.left,consequent:t,alternative:i.right.right});function r(t){if(!t.has_side_effects(e)){var i=!1;return t.walk(new TreeWalker((function(e){return!!i||(e instanceof AST_SymbolRef&&e.definition()===n?i=!0:void 0)}))),!i}}}AST_Scope.DEFMETHOD("merge_variables",(function(e){if(e.option("merge_vars")){var n,t,i=[],r={},a=this,o=[],s=[],f=0,c=new Dictionary,u=Object.create(null),l=Object.create(null),_=new TreeWalker((function(o,s){if(o instanceof AST_Assign){var f=o.left,l=o.right;return f instanceof AST_Destructured?(l.walk(_),k(AST_SymbolRef,w,f),!0):X[o.operator.slice(0,-1)]?(f.walk(_),b(),l.walk(_),f instanceof AST_SymbolRef&&w(f),x(),!0):f instanceof AST_SymbolRef?("="!=o.operator&&w(f,!0),l.walk(_),w(f),!0):void 0}if(o instanceof AST_Binary){if(!X[o.operator])return;return y(o),!0}var S;if(o instanceof AST_Break)return(S=_.loopcontrol_target(o))instanceof AST_IterationStatement||D(S),!0;if(o instanceof AST_Call)return(T=o.expression)instanceof AST_LambdaExpression?(o.args.forEach((function(e){e.walk(_)})),T.walk(_)):(s(),m(T)),!0;if(o instanceof AST_Class)return o.name&&o.name.walk(_),o.extends&&o.extends.walk(_),o.properties.filter((function(e){return e.key instanceof AST_Node&&e.key.walk(_),e.value})).forEach((function(e){e.static?e.value.walk(_):(b(),r.block=o,e.value.walk(_),x())})),!0;if(o instanceof AST_Conditional)return y(o.condition,o.consequent,o.alternative),!0;if(o instanceof AST_Continue)return(S=_.loopcontrol_target(o))instanceof AST_Do&&D(S),!0;if(o instanceof AST_Do){b(),r.block=o,r.loop=!0;var p=r;return o.body.walk(_),r.inserted===o&&(r=p),o.condition.walk(_),x(),!0}if(o instanceof AST_For)return o.init&&o.init.walk(_),b(),r.block=o,r.loop=!0,o.condition&&o.condition.walk(_),o.body.walk(_),o.step&&o.step.walk(_),x(),!0;if(o instanceof AST_ForEnumeration)return o.object.walk(_),b(),r.block=o,r.loop=!0,o.init.walk(_),o.body.walk(_),x(),!0;if(o instanceof AST_If)return y(o.condition,o.body,o.alternative),!0;if(o instanceof AST_LabeledStatement){b(),r.block=o;p=r;return o.body.walk(_),r.inserted===o&&(r=p),x(),!0}if(o instanceof AST_Scope){if(b(),r.block=o,o===a&&(t=r),o instanceof AST_Lambda){o.name&&(u[o.name.definition().id]=!1);var d=o.uses_arguments&&!_.has_directive("use strict")?function(e){u[e.definition().id]=!1}:function(e){w(e)};i.push(o),o.argnames.forEach((function(e){k(AST_SymbolFunarg,d,e)})),o.rest&&k(AST_SymbolFunarg,d,o.rest),i.pop()}return walk_lambda(o,_),x(),!0}if(o instanceof AST_Sub){var T=o.expression;return o.optional?(T.walk(_),b(),o.property.walk(_),x()):s(),m(T),!0}if(o instanceof AST_Switch){o.expression.walk(_);p=r;return o.body.forEach((function(e){e instanceof AST_Default||(e.expression.walk(_),p===r&&b())})),r=p,o.body.forEach((function(e){b(),r.block=o;var n=r;walk_body(e,_),r.inserted===o&&(r=n),x()})),!0}if(o instanceof AST_SymbolConst||o instanceof AST_SymbolLet)return u[o.definition().id]=!1,!0;if(o instanceof AST_SymbolRef)return w(o,!0),!0;if(o instanceof AST_Try){var A=n;return n=o,walk_body(o,_),o.bcatch&&(o.bcatch.argname&&o.bcatch.argname.mark_symbol((function(e){if(e instanceof AST_SymbolCatch){var n=e.definition();u[n.id]=!1,(n=n.redefined())&&(u[n.id]=!1)}}),_),o.bfinally||(n=A)?walk_body(o.bcatch,_):(b(),walk_body(o.bcatch,_),x())),n=A,o.bfinally&&o.bfinally.walk(_),!0}if(o instanceof AST_Unary){if(!UNARY_POSTFIX[o.operator])return;var h=o.expression;if(!(h instanceof AST_SymbolRef))return;return w(h,!0),!0}if(o instanceof AST_VarDef){var v=o.value;return v?v.walk(_):v=r.block instanceof AST_ForEnumeration&&r.block.init===_.parent(),k(AST_SymbolDeclaration,v?function(e){e instanceof AST_SymbolVar?w(e):e.walk(_)}:function(e){if(e instanceof AST_SymbolVar){var n=e.definition().id,t=u[n];t?t.push(e):n in u||c.add(n,e)}else e.walk(_)},o.name),!0}if(o instanceof AST_While)return b(),r.block=o,r.loop=!0,s(),x(),!0;function m(n){if(e.option("ie")){var t=root_expr(n);t instanceof AST_SymbolRef&&t.walk(_)}}function y(e,n,t){var i=r,a=[i,i];if(e instanceof AST_Binary)switch(e.operator){case"&&":a[0]=y(e.left,e.right)[0];break;case"||":case"??":a[1]=y(e.left,null,e.right)[1];break;default:e.walk(_)}else e instanceof AST_Conditional?y(e.condition,e.consequent,e.alternative):e.walk(_);return r=a[0],n&&(b(),n.walk(_)),a[0]=r,r=a[1],t&&(b(),t.walk(_)),a[1]=r,r=i,a}}));_.directives=Object.create(e.directives),a.walk(_);for(var S=!1,p=Object.create(null);o.length&&s.length;){var d=s.shift();if(d){var T=d.definition,A=u[T.id];if(A){for(A={end:A.end};T.id in p;)T=p[T.id];A.start=u[T.id].start;var h=[];do{var v=o.shift();if(!(d.index>v.index)){var m=v.definition;if(m.id in l){var g=u[m.id];if(g){if(g.start.block===A.start.block&&C(g,A)&&(!g.start.loop&&nn(T)||C(A,g))&&(!e.option("webkit")||is_funarg(T)===is_funarg(m))&&!m.const_redefs&&all(g.scopes,(function(e){return e.find_variable(T.name)===T}))){g.forEach((function(e){e.thedef=T,e.name=T.name,e instanceof AST_SymbolRef?(T.references.push(e),m.replaced++):(T.orig.push(e),m.eliminated++)})),m.fixed||(T.fixed=!1),p[m.id]=T,S=!0;break}h.push(v)}}}}while(o.length);h.length&&(o=h.concat(o))}}}return S}function b(){r=Object.create(r)}function x(){r=Object.getPrototypeOf(r)}function k(e,n,t){var i=new TreeWalker((function(t){if(!(t instanceof AST_Destructured))return t instanceof AST_DefaultValue?(b(),t.value.walk(_),x(),t.name.walk(i)):t instanceof AST_DestructuredKeyVal?t.key instanceof AST_Node?t.value instanceof AST_PropAccess?(b(),r.block=t,t.key.walk(_),t.value.walk(i),x()):(t.key.walk(_),t.value.walk(i)):t.value.walk(i):t instanceof e?n(t):t.walk(_),!0}));t.walk(i)}function w(S,p){var d,T=S.definition();if(p&&!all(i,(function(e){return!(d=e.variables.get(S.name))||(!is_funarg(d)||d!==T&&!T.undeclared&&e.parent_scope.find_variable(S.name)!==T)})))return u[T.id]=u[d.id]=!1;var A=r;if(n&&(b(),A=r,x()),T.id in u){if(!(h=u[T.id]))return;if(h.start.block!==A.block)return u[T.id]=!1;if(v(S),h.end=A,T.id in l)s[l[T.id]]=null;else if(!p)return}else{if((d=a.variables.get(T.name))!==T)return d&&t===A&&(u[d.id]=!1),u[T.id]=!1;if(e.exposed(T)||Te[S.name])return u[T.id]=!1;var h;if((h=c.get(T.id)||[]).scopes=[],v(S),u[T.id]=h,!p)return h.start=A,o.push({index:f++,definition:T});if(A.block!==a)return u[T.id]=!1;h.start=t}function v(e){h.push(e),push_uniq(h.scopes,e.scope);var n=y(_);n!==e.scope&&push_uniq(h.scopes,n)}l[T.id]=s.length,s.push({index:f++,definition:T})}function D(e){for(var n=[];;){if(HOP(r,"block")){var t=r.block;if(t instanceof AST_LabeledStatement&&(t=t.body),t===e)break}n.push(r),x()}for(r.inserted=r.block,b();n.length;){var i=n.pop();b(),HOP(i,"block")&&(r.block=i.block),HOP(i,"loop")&&(r.loop=i.loop)}}function E(e,n){return e===n||e.isPrototypeOf(n)}function C(e,n){return E(e.start,e.end)||E(e.start,n.start)}})),AST_Scope.DEFMETHOD("drop_unused",(function(e){if(e.option("unused")){var n=this,t=!(n instanceof AST_Toplevel)||e.toplevel.funcs,i=!(n instanceof AST_Toplevel)||e.toplevel.vars,r=/keep_assign/.test(e.option("unused"))?return_false:function(n,t){var i,r=!1;if(n instanceof AST_Assign?(n.write_only||"="==n.operator)&&(i=o(n.left,t)):n instanceof AST_Unary&&n.write_only&&(i=o(n.expression,t)),i instanceof AST_SymbolRef){var a=i.definition();if(!c[a.id]&&!e.exposed(a)&&f(i,e,r))return i}function o(n,t){if(n instanceof AST_PropAccess){var i=n.expression;if(!i.may_throw_on_access(e,!0))return r=!0,t&&n instanceof AST_Sub&&t.unshift(n.property),o(i,t)}else if(n instanceof AST_Assign&&"="==n.operator){n.write_only="p";var a=o(n.right);return t?(t.assign=n,a instanceof AST_SymbolRef?a:n.left):a}return n}},a=Object.create(null),c=Object.create(null),u=function(t){return(u=function n(t,i,r){var a=e.parent(i);if(!a)return r;var o=a instanceof AST_Lambda&&member(t,a.argnames);return n(a,i+1,o?function(e){var n=r(e);if(n)return n;if(n=a.variables.get(e)){var t=n.orig[0];if(t instanceof AST_SymbolFunarg||t instanceof AST_SymbolLambda)return n}}:a.variables?function(e){return r(e)||a.variables.get(e)}:r)}(n,0,noop))(t)},l=Object.create(null),_=[],S=Object.create(null),p=Object.create(null),d=Object.create(null),T=Object.create(null),A=Object.create(null);n instanceof AST_Toplevel&&e.top_retain&&n.variables.each((function(n){e.top_retain(n)&&!(n.id in S)&&(AST_Node.info("Retaining variable {name}",n),S[n.id]=!0,_.push(n))}));var h=new Dictionary,v=new Dictionary,m=this,y=new TreeWalker((function(r,a){if(r instanceof AST_Lambda&&r.uses_arguments&&!y.has_directive("use strict")&&r.each_argname((function(e){var n=e.definition();n.id in S||(S[n.id]=!0,_.push(n))})),r!==n){if(m===n){if(r instanceof AST_DefClass){var o=r.name.definition();(u=t&&!o.exported)||o.id in S||(S[o.id]=!0,_.push(o));var s=y.parent()instanceof AST_ExportDefault;s?c[o.id]=!0:u&&!(o.id in p)&&(p[o.id]=1),r.extends&&r.extends.walk(y);var f=[];return r.properties.forEach((function(e){e.key instanceof AST_Node&&e.key.walk(y);var n=e.value;n&&(M(e)?(!s&&n.contains_this()&&(s=!0),l(n)):f.push(n))})),f.forEach(u&&s?l:function(e){v.add(o.id,e)}),!0}if(r instanceof AST_LambdaDefinition){var u;o=r.name.definition();return(u=t&&!o.exported)||o.id in S||(S[o.id]=!0,_.push(o)),v.add(o.id,r),y.parent()instanceof AST_ExportDefault?(c[o.id]=!0,Y(r,a,!0)):(u&&!(o.id in p)&&(p[o.id]=1),!0)}if(r instanceof AST_Definitions)return r.definitions.forEach((function(n){var t=n.value,a=t&&(n.name instanceof AST_Destructured||t.has_side_effects(e)),o=a&&"="==t.tail_node().operator;n.name.mark_symbol((function(e){if(e instanceof AST_SymbolDeclaration){var s=e.definition();if(A[s.id]=(A[s.id]||0)+1,r instanceof AST_Var&&s.orig[0]instanceof AST_SymbolCatch){var f=s.redefined();f&&(A[f.id]=(A[f.id]||0)+1)}return s.id in S||i&&!s.exported&&!(r instanceof AST_Const?s.redefined():s.const_redefs)&&(r instanceof AST_Var||Be(s))||(S[s.id]=!0,_.push(s)),t&&(a?o&&I(s,e,T[s.id]):v.add(s.id,t),h.add(s.id,n)),V(s),!0}}),y),a&&t.walk(y)})),!0;if(r instanceof AST_SymbolFunarg){o=r.definition();return A[o.id]=(A[o.id]||0)+1,h.add(o.id,r),!0}if(r instanceof AST_SymbolImport)return(o=r.definition()).id in S||i&&Be(o)||(S[o.id]=!0,_.push(o)),!0}return Y(r,a,!0)}function l(e){var n=m;m=r,e.walk(y),m=n}}));y.directives=Object.create(e.directives),n.walk(y);var g=e.option("keep_fnames")?return_false:e.option("ie")?function(n){return!e.exposed(n)&&n.references.length==n.replaced}:function(e){return!(e.id in S)||!(e.orig.length-e.eliminated<2)&&(e.orig[1]instanceof AST_SymbolFunarg||all(e.references,(function(e){return!e.in_arg})))};e.option("ie")&&v.each((function(e,n){n in S||e.forEach((function(e){e.walk(new TreeWalker((function(e){return e instanceof AST_Function&&e.name&&!g(e.name.definition())?(e.walk(y),!0):e instanceof AST_Scope||void 0})))}))})),y=new TreeWalker(Y);for(var b=0;b<_.length;b++){var x=v.get(_[b].id);x&&x.forEach((function(e){e.walk(y)}))}Object.keys(a).forEach((function(e){var n=a[e];if(n){n=n.reduce((function(e,n){return n.forEach((function(n){push_uniq(e,n)})),e}),[]);var t=(h.get(e)||[]).filter((function(e){return find_if(e instanceof AST_Unary?function(n){return n===e}:function(n){return n===e||!(n instanceof AST_Unary)&&q(n)===q(e)},n)}));n.length==t.length?a[e]=t:delete a[e]}else delete a[e]}));var E=[],N=[],R=new TreeTransformer((function(n){if(n instanceof AST_DefaultValue)return $(R,n);if(n instanceof AST_Destructured&&n.rest&&(n.rest=n.rest.transform(R)),n instanceof AST_DestructuredArray){for(var t=!n.rest,i=n.elements.length;--i>=0;){var r=n.elements[i].transform(R);r?(n.elements[i]=r,t=!1):t?n.elements.pop():n.elements[i]=k(AST_Hole,n.elements[i])}return n}if(n instanceof AST_DestructuredObject){var a=[];return n.properties.forEach((function(t){var i=!1;if(t.key instanceof AST_Node&&(t.key=t.key.transform(B),i=t.key.has_side_effects(e)),(i||n.rest)&&function(e){return(e instanceof AST_DefaultValue?e.name:e)instanceof AST_SymbolDeclaration}(t.value))t.value=t.value.transform(B),a.push(t);else{var r=t.value.transform(R);!r&&n.rest&&(r=t.value instanceof AST_DestructuredArray?k(AST_DestructuredArray,t.value,{elements:[]}):k(AST_DestructuredObject,t.value,{properties:[]})),r&&(t.value=r,a.push(t))}})),n.properties=a,n}return n instanceof AST_SymbolDeclaration?G(n):void 0})),B=new TreeTransformer((function(s,c,u){var _=B.parent();if(i){var p=[];if(M=r(s,p)){if(function(e,n){var t=e.definition(),i=S[t.id];return!i||n[n instanceof AST_Assign?"left":"expression"]===e&&(i===e&&t.references.length-t.replaced==1||L(t,n)<0)}(M,s)&&(s instanceof AST_Assign&&(h=H(s),!0===s.write_only&&(h=h.drop_side_effect_free(e))),h||(h=k(AST_Number,s,{value:0}))),h){if(p.assign){var d=p.assign.drop_side_effect_free(e);d&&(d.write_only=!0,p.unshift(d))}switch(_ instanceof AST_Sequence&&_.tail_node()!==s&&!h.has_side_effects(e)||p.push(h),p.length){case 0:return List.skip;case 1:return C(_,s,p[0].transform(B));default:return w(s,p.map((function(e){return e.transform(B)})))}}}else if(s instanceof AST_UnaryPostfix&&s.expression instanceof AST_SymbolRef&&L(s.expression.definition(),s)<0)return k(AST_UnaryPrefix,s,{operator:"+",expression:s.expression})}if(s instanceof AST_Binary&&"instanceof"==s.operator){if(!((M=s.right)instanceof AST_SymbolRef))return;if(M.definition().id in S)return;var T=s.left.drop_side_effect_free(e),h=k(AST_False,s).optimize(e);return T?w(s,[T,h]):h}if(s instanceof AST_Call)return E.push(s),s.args=s.args.map((function(e){return e.transform(B)})),s.expression=s.expression.transform(B),s;if(m===n){if(t&&s!==n&&s instanceof AST_DefClass)if(!((W=s.name.definition()).id in S)){O(s.name,"Dropping unused class {name}"),W.eliminated++,c(s,B);var v=he(s,!0);return _ instanceof AST_ExportDefault?v:(v=v.drop_side_effect_free(e,!0))?k(AST_SimpleStatement,s,{body:v}):u?List.skip:k(AST_EmptyStatement,s)}if(s instanceof AST_ClassExpression&&s.name&&g(s.name.definition())&&(s.name=null),s instanceof AST_Lambda){if(t&&s!==n&&s instanceof AST_LambdaDefinition)if(!((W=s.name.definition()).id in S))return O(s.name,"Dropping unused function {name}"),W.eliminated++,_ instanceof AST_ExportDefault?(re(),ve(s,!0)):u?List.skip:k(AST_EmptyStatement,s);if(re(),s instanceof AST_LambdaExpression&&s.name&&g(s.name.definition())&&(s.name=null),!(s instanceof AST_Accessor)){var y,b,x=e.drop_fargs(s,_);if(x&&_ instanceof AST_Call&&_.expression===s)for(y=_.args,b=0;b<y.length&&!(y[b]instanceof AST_Spread);b++);var D=s.argnames,F=s.rest,q=!1,z=!1;if(F){if(z=!0,!y||b<D.length||F instanceof AST_SymbolFunarg)F=F.transform(R);else F=(v=J(F,k(AST_Array,_,{elements:y.slice(D.length)}),G,!s.uses_arguments,F)).name,y.length=D.length,v.value.elements.length&&[].push.apply(y,v.value.elements);F instanceof AST_Destructured&&!F.rest&&(F instanceof AST_DestructuredArray?0==F.elements.length&&(F=null):0==F.properties.length&&(F=null)),s.rest=F,F&&(x=!1,q=!0)}for(var j=x?-1:s.length(),V=y&&!s.uses_arguments&&_!==e.parent(),I=D.length;--I>=0;){var M;if((M=D[I])instanceof AST_SymbolFunarg){var W;(W=M.definition()).id in S?(x=!1,L(W,M)<0&&(M.unused=null)):x?(O(M,"Dropping unused function argument {name}"),D.pop(),W.eliminated++,M.unused=!0):M.unused=!0}else{var Y;if(z=!0,!y||b<I)Y=M.transform(R);else Y=(v=J(M,y[I],G,V,M)).name,v.value&&(y[I]=v.value);Y?(x=!1,D[I]=Y,q||(q=!(Y instanceof AST_SymbolFunarg))):x?(P(M,"Dropping unused default argument {name}"),D.pop()):I>j?(P(M,"Dropping unused default argument assignment {name}"),M.name instanceof AST_SymbolFunarg?M.name.unused=!0:q=!0,D[I]=M.name):(P(M,"Dropping unused default argument value {name}"),D[I]=M=M.clone(),M.value=k(AST_Number,M,{value:0}),q=!0)}}z&&!q&&s.uses_arguments&&!B.has_directive("use strict")&&(s.rest=k(AST_DestructuredArray,s,{elements:[]})),N.push(s)}return s}if(s instanceof AST_Catch&&s.argname instanceof AST_Destructured&&s.argname.transform(R),s instanceof AST_Definitions&&!(_ instanceof AST_ForEnumeration&&_.init===s)){var K=[],$=[],X=[],Q=[],Z=0,ee=s instanceof AST_Var;switch(s.definitions.forEach((function(n){n.value&&(n.value=n.value.transform(B));var t=n.value;if(n.name instanceof AST_Destructured){var r=J(n.name,t,(function(e){return i?e.definition().id in S||y(e)||ee&&!f(e)?e:null:e}),!0);r.name?(n=k(AST_VarDef,n,{name:r.name,value:t=r.value}),g()):r.value&&Q.push(r.value)}else{var c,u,l,p,d=n.name.definition(),T=ee?f(n.name):Be(d);if(T&&i&&!(d.id in S))y(n.name)?((t=t&&t.drop_side_effect_free(e))&&Q.push(t),A[d.id]>1?(AST_Node.warn("Dropping duplicated declaration of variable {name} [{start}]",n.name),A[d.id]--,d.eliminated++):(n.value=null,$.push(n))):((t=t&&t.drop_side_effect_free(e))?(AST_Node.warn("Side effects in initialization of unused variable {name} [{start}]",n.name),Q.push(t)):O(n.name,"Dropping unused variable {name}"),d.eliminated++);else if(t&&((c=L(d,n))<0||(p=t.tail_node())instanceof AST_SymbolRef&&p.definition()===d)&&(n=n.clone(),(t=t.drop_side_effect_free(e))&&AST_Node.warn("Side effects in definition of variable {name} [{start}]",n.name),s instanceof AST_Const?n.value=t||k(AST_Number,n,{value:0}):(n.value=null,t&&Q.push(t)),t=null,c>=0&&(a[d.id][c]=n)),t||s instanceof AST_Let)if(e.option("functions")&&!e.option("ie")&&T&&t&&1==A[d.id]&&0==d.assignments&&(l=t.tail_node())instanceof AST_LambdaExpression&&!o(d)&&!is_arrow(l)&&function(e,t){return 0==t.length?e===n.name.fixed_value():all(t,(function(n){return e===n.fixed_value()}))}(l,d.references)&&function(n){if(!ee||e.has_directive("use strict")||!(n instanceof AST_Function))return _ instanceof AST_Scope;return _ instanceof AST_Block||_ instanceof AST_For&&_.init===s||_ instanceof AST_If}(l)&&!1!==(u=function(n,t){if(!n.name)return null;var i,r=n.name.definition();if(r.orig.length>1)return null;if(r.assignments>0)return!1;if(r.name==t)return r;if(e.option("keep_fnames"))return!1;switch(t){case"await":i=is_async;break;case"yield":i=is_generator}return all(r.references,(function(e){var r=e.scope;if(r.find_variable(t)!==d)return!1;if(i)do{if(r=r.resolve(),i(r))return!1}while(r!==n&&(r=r.parent_scope));return!0}))&&r}(l,n.name.name))){var h;switch(AST_Node.warn("Declaring {name} as function [{start}]",n.name),l.CTOR){case AST_AsyncFunction:h=AST_AsyncDefun;break;case AST_AsyncGeneratorFunction:h=AST_AsyncGeneratorDefun;break;case AST_Function:h=AST_Defun;break;case AST_GeneratorFunction:h=AST_GeneratorDefun}var v=k(h,l);v.name=k(AST_SymbolDefun,n.name);var m=n.name.scope.resolve().def_function(v.name);u&&u.forEach((function(e){e.name=m.name,e.thedef=m,e.reference()})),K.push(v),t!==l&&[].push.apply(Q,t.expressions.slice(0,-1))}else T&&A[d.id]>1&&!(_ instanceof AST_ExportDeclaration)&&d.orig.indexOf(n.name)>d.eliminated&&(A[d.id]--,Z++),g();else _ instanceof AST_ExportDeclaration?g():T&&A[d.id]>1?(AST_Node.info("Dropping declaration of variable {name} [{start}]",n.name),A[d.id]--,d.eliminated++):$.push(n)}function y(e){var n=e.definition();return n.orig[0]instanceof AST_SymbolCatch&&n.scope.resolve()===e.scope.resolve()}function g(){Q.length>0&&(0==X.length?K.push(k(AST_SimpleStatement,s,{body:w(s,Q)})):t?(Q.push(t),n.value=w(t,Q)):n.value=k(AST_UnaryPrefix,n,{operator:"void",expression:w(n,Q)}),Q=[]),X.push(n)}})),$.length){case 0:if(0==X.length)break;if(X.length==Z){[].unshift.apply(Q,X.map((function(e){AST_Node.info("Dropping duplicated definition of variable {name} [{start}]",e.name);var n=e.name.definition(),t=k(AST_SymbolRef,e.name);n.references.push(t);var i=k(AST_Assign,e,{operator:"=",left:t,right:e.value}),r=L(n,e);return r>=0&&(a[n.id][r]=i),n.assignments++,n.eliminated++,i})));break}case 1:if(0==X.length){var ne=$[0].name.definition().id;if(ne in l){s.definitions=$,l[ne].init=s;break}}default:var te;X.length>0&&(te=X[0].value)instanceof AST_Sequence&&(X[0].value=te.tail_node(),K.push(k(AST_SimpleStatement,s,{body:w(te,te.expressions.slice(0,-1))}))),s.definitions=$.concat(X),K.push(s)}return Q.length>0&&K.push(k(AST_SimpleStatement,s,{body:w(s,Q)})),U(K,s,u)}if(s instanceof AST_Assign)return c(s,B),s.left instanceof AST_Destructured?(v=J(s.left,s.right,(function(e){return e}),!0===s.write_only)).name?k(AST_Assign,s,{operator:s.operator,left:v.name,right:v.value}):v.value?v.value:_ instanceof AST_Sequence&&_.tail_node()!==s?List.skip:k(AST_Number,s,{value:0}):s;if(s instanceof AST_LabeledStatement&&s.body instanceof AST_For){if(c(s,B),s.body instanceof AST_BlockStatement){var ie=s.body;return s.body=ie.body.pop(),ie.body.push(s),u?List.splice(ie.body):ie}return s}if(s instanceof AST_Scope)return re(),s;if(s instanceof AST_SymbolImport)return!e.option("imports")||s.definition().id in S?s:u?List.skip:null}function re(){var e=m;m=s,c(s,B),m=e}}),(function(n,t){if(n instanceof AST_BlockStatement)return Se(n,B.parent(),t);if(n instanceof AST_ExportDeclaration){var r=n.body;if(!(r instanceof AST_BlockStatement))return;return n.body=r.body.pop(),r.body.push(n),t?List.splice(r.body):r}if(n instanceof AST_For)return K(n,t);if(n instanceof AST_ForIn){if(!i||!e.option("loops"))return;if(!F(n.body))return;var a=W(n);if(!a)return;var o=a.definition();if(o.id in S)return;O(a,"Dropping unused loop variable {name}"),l[o.id]===n&&delete l[o.id];var s=[],f=n.object.drop_side_effect_free(e);return f&&(AST_Node.warn("Side effects in object of for-in loop [{start}]",f),s.push(k(AST_SimpleStatement,n,{body:f}))),n.init instanceof AST_Definitions&&o.orig[0]instanceof AST_SymbolCatch&&s.push(n.init),U(s,n,t)}if(n instanceof AST_Import)return n.properties&&0==n.properties.length&&(n.properties=null),n;if(n instanceof AST_Sequence){if(n.expressions.length>1)return;return C(B.parent(),n,n.expressions[0])}}));B.push(e.parent()),B.directives=Object.create(e.directives),n.transform(B),n instanceof AST_Lambda&&1==n.body.length&&n.body[0]instanceof AST_Directive&&"use strict"==n.body[0].value&&(n.body.length=0),E.forEach((function(n){je(n,e,N)}))}function O(e,n){AST_Node[e.definition().references.length>0?"info":"warn"](n+" [{start}]",e)}function P(e,n){e.name instanceof AST_SymbolFunarg?O(e.name,n):AST_Node.info(n+" [{start}]",e)}function q(e){return e[e instanceof AST_Assign?"right":"value"]}function U(e,n,t){switch(e.length){case 0:return t?List.skip:k(AST_EmptyStatement,n);case 1:return e[0];default:return t?List.splice(e):k(AST_BlockStatement,n,{body:e})}}function z(e,t){return e.scope.resolve()===n&&(e.fixed&&t.fixed||(a[e.id]=!1),!1!==a[e.id])}function j(e,n){a[e.id]||(a[e.id]=[]),n.fixed.assigns&&push_uniq(a[e.id],n.fixed.assigns)}function L(e,n){var t=a[e.id];return t&&t.indexOf(n)}function V(e){p[e.id]>1&&!(e.id in S)&&(S[e.id]=!0,_.push(e)),p[e.id]=0}function I(e,n,t){e.id in S||(n&&t?(S[e.id]=n,_.push(e)):(d[e.id]=n,T[e.id]=t))}function H(n){var t=n.right;if(!n.write_only)return t;if(!(t instanceof AST_Binary&&X[t.operator]))return t;if(!(t.left instanceof AST_SymbolRef))return t;if(!(n.left instanceof AST_SymbolRef))return t;var i=n.left.definition();return t.left.definition()!==i||t.right.has_side_effects(e)?t:(z(i,t.left)&&j(i,t.left),t.right)}function W(e){var n=e.init;if(n instanceof AST_Definitions)return(n=n.definitions[0].name)instanceof AST_SymbolDeclaration&&n;for(;n instanceof AST_PropAccess;)n=n.expression.tail_node();return n instanceof AST_SymbolRef?n:void 0}function Y(t,a,f){t instanceof AST_Assign&&t.left instanceof AST_SymbolRef&&((E=t.left.definition()).scope.resolve()===n&&h.add(E.id,t));(t instanceof AST_SymbolRef&&t.in_arg&&(A[t.definition().id]=0),t instanceof AST_Unary&&t.expression instanceof AST_SymbolRef)&&((E=t.expression.definition()).scope.resolve()===n&&h.add(E.id,t));var c=[];if(D=r(t,c)){if((N=D.definition()).scope.resolve()!==n&&n.variables.get(D.name)!==N)return;if(o(N)&&!all(n.argnames,(function(e){return!e.match_symbol((function(e){if(e instanceof AST_SymbolFunarg){var n=e.definition();return n.references.length>n.replaced}}),!0)})))return;if("p"===t.write_only&&t.right.may_throw_on_access(e,!0))return;var g=c.assign;if(g&&(g.write_only=!0,g.walk(y)),c.forEach((function(e){e.walk(y)})),t instanceof AST_Assign){var b=H(t),x=!1;if(f&&!0===t.write_only&&!b.has_side_effects(e)?v.add(N.id,b):(b.walk(y),x="="==b.tail_node().operator),t.left===D)t.write_only&&!x||I(N,D,T[N.id]);else{var k=D.fixed_value();k&&k.is_constant()||I(N,d[N.id],!0)}}return z(N,D)&&is_lhs(D,t)!==D&&j(N,D),V(N),!0}if(t instanceof AST_Binary){if("instanceof"!=t.operator)return;if(!((D=t.right)instanceof AST_SymbolRef))return;var w=D.definition().id;if(!p[w])return;return t.left.walk(y),p[w]++,!0}if(t instanceof AST_ForIn){var D,E;if(t.init instanceof AST_SymbolRef&&m===n)(w=t.init.definition().id)in l||(l[w]=t);if(!i||!e.option("loops"))return;if(!F(t.body))return;if(t.init.has_side_effects(e))return;if(!(D=W(t)))return;if((E=D.definition()).scope.resolve()!==n){var C=u(D.name);if(C===E||C&&C.redefined()===E)return}return t.object.walk(y),!0}if(t instanceof AST_SymbolRef){var N;if((N=t.definition()).id in S||(S[N.id]=!0,_.push(N)),s(N.scope,t.scope)){var R=N.redefined();R&&!(R.id in S)&&(S[R.id]=!0,_.push(R))}return z(N,t)&&j(N,t),!0}if(t instanceof AST_Scope){var B=m;return m=t,a(),m=B,!0}}function G(e){return e.definition().id in S?e:(e instanceof AST_SymbolFunarg&&(e.unused=!0),null)}function $(n,t){if(t.value=t.value.transform(B),!t.name.transform(n)){if(t.name instanceof AST_Destructured)return null;var i=t.value.drop_side_effect_free(e);if(!i)return null;O(t.name,"Side effects in default value of unused variable {name}"),(t=t.clone()).name.unused=null,t.value=i}return t}function J(n,t,i,r,a){var o=new TreeTransformer((function(n){if(n instanceof AST_DefaultValue){if(!(e.option("default_values")&&t&&t.is_defined(e))){var f=r;r=!1;var u=$(o,n);return r=f,!u&&r&&t&&(t=t.drop_side_effect_free(e)),u}n===a?a=n=n.name:n=n.name}if(n instanceof AST_DestructuredArray){f=r;var l,_=t;t instanceof AST_SymbolRef&&(r=!1,t=t.fixed_value()),t instanceof AST_Array?(l=!0,m=t.elements):(l=t&&t.is_string(e),m=!1);var S=[],p=r&&[],d=0;if(n.elements.forEach((function(e,n){(t=m&&m[n])instanceof AST_Hole?t=null:t instanceof AST_Spread&&(r&&(p.length=d,Ae(_,p),[].push.apply(p,m.slice(n)),_.elements=p),t=m=!1),(e=e.transform(o))&&(S[d]=e),r&&t&&(p[d]=t),!e&&!t&&r&&m||d++})),t=m&&k(AST_Array,_,{elements:m.slice(n.elements.length)}),n.rest){var T=r;r=!1,n.rest=n.rest.transform(e.option("rests")?o:B),r=T,n.rest&&(S.length=d)}if(r&&(t&&!n.rest&&(t=t.drop_side_effect_free(e)),t instanceof AST_Array?t=t.elements:t instanceof AST_Sequence?t=t.expressions:t&&(t=[t]),t&&t.length&&(p.length=d,[].push.apply(p,t))),t=_,r=f,m&&p&&(Ae(t,p),(t=t.clone()).elements=p),l){if(!n.rest)switch(S.length){case 0:if(n===a)break;return r&&(t=t.drop_side_effect_free(e)),null;case 1:if(!r)break;if(n===a)break;var A=S[0];if(A.has_side_effects(e))break;if(t.has_side_effects(e)&&A.match_symbol((function(e){return e instanceof AST_PropAccess})))break;return t=k(AST_Sub,n,{expression:t,property:k(AST_Number,n,{value:0})}),A}}else S.length=n.elements.length;return Ae(n,S),n.elements=S,n}if(n instanceof AST_DestructuredObject){var h,v,m;f=r,_=t;t instanceof AST_SymbolRef&&(r=!1,t=t.fixed_value()),t instanceof AST_Object&&(h=[],v=new Dictionary,m=t.properties.map((function(n,t){if((n=n.clone())instanceof AST_Spread)v=!1;else{var i=n.key;i instanceof AST_Node&&(i=i.evaluate(e,!0)),i instanceof AST_Node?v=!1:!v||n instanceof AST_ObjectSetter||v.set(i,n),h[t]=i}return n}))),n.rest&&(t=!1,n.rest=n.rest.transform(e.option("rests")?o:B));var y=new Dictionary,g=r&&new Dictionary,b=[];if(n.properties.map((function(n){var t=n.key;return t instanceof AST_Node&&(n.key=t=t.transform(B),t=t.evaluate(e,!0)),t instanceof AST_Node?g=!1:y.set(t,!y.has(t)),t})).forEach((function(e,i){var a,f=n.properties[i];if(e instanceof AST_Node)r=!1,t=!1,a=f.value.transform(o)||c(f.value);else{r=g&&y.get(e);var u=v&&v.get(e);u?(t=u.value)instanceof AST_Accessor&&(t=!1):t=!1,(a=f.value.transform(o))?g&&g.set(e,!1):((n.rest||s(f))&&(a=c(f.value)),g&&!g.has(e)&&(u?(g.set(e,u),null===t&&v.set(e,s(u)&&k(AST_ObjectKeyVal,u,{key:u.key,value:k(AST_Number,u,{value:0})}))):g.set(e,!0))),t&&(u.value=t)}a&&(f.value=a,b.push(f))})),t=_,r=f,g&&h&&((t=t.clone()).properties=List(m,(function(t,i){if(t instanceof AST_Spread)return t;var r=h[i];if(r instanceof AST_Node)return t;if(g.has(r)){var a=g.get(r);if(!a)return t;if(a===t)return v.get(r)||List.skip}else if(n.rest)return t;var o=t.value.drop_side_effect_free(e);return o?(t.value=o,t):s(t)?k(AST_ObjectKeyVal,t,{key:t.key,value:k(AST_Number,t,{value:0})}):List.skip}))),t&&!n.rest)switch(b.length){case 0:if(n===a)break;if(t.may_throw_on_access(e,!0))break;return r&&(t=t.drop_side_effect_free(e)),null;case 1:if(!r)break;if(n===a)break;var x=b[0];if(x.key instanceof AST_Node)break;if(x.value.has_side_effects(e))break;if(t.has_side_effects(e)&&x.value.match_symbol((function(e){return e instanceof AST_PropAccess})))break;return t=k(AST_Sub,n,{expression:t,property:D(x.key,x)}),x.value}return n.properties=b,n}return!(n=n instanceof AST_Hole?null:i(n))&&r&&t&&(t=t.drop_side_effect_free(e)),n}));return{name:n.transform(o),value:t};function s(n){return n.key instanceof AST_Node&&n.key.has_side_effects(e)}function f(e){if(e instanceof AST_Assign)e.write_only=!1,f(e.right);else if(e instanceof AST_Binary){if(!X[e.operator])return;f(e.left),f(e.right)}else e instanceof AST_Conditional?(f(e.consequent),f(e.alternative)):e instanceof AST_Sequence?f(e.tail_node()):e instanceof AST_Unary&&(e.write_only=!1)}function c(n){return n instanceof AST_DefaultValue?c(n.name):n instanceof AST_Destructured?(null===t?t=k(AST_Number,n,{value:0}):t&&(t.may_throw_on_access(e,!0)?t=k(AST_Array,n,{elements:t instanceof AST_Sequence?t.expressions:[t]}):f(t)),k(AST_DestructuredObject,n,{properties:[]})):(n.unused=null,n)}}})),AST_Scope.DEFMETHOD("hoist_declarations",(function(e){if(!e.has_directive("use asm")){var n=e.option("hoist_funs"),t=e.option("hoist_vars"),i=this;if(t){var r=0;i.walk(new TreeWalker((function(e){return r>1||(e instanceof AST_ExportDeclaration||(e instanceof AST_Scope&&e!==i||(e instanceof AST_Var?(r++,!0):void 0)))}))),r<=1&&(t=!1)}if(n||t){var a=new Dictionary,o=[],s=[],f=new Dictionary,c=new TreeTransformer((function(r,u,l){if(r!==i){if(r instanceof AST_Directive)return o.push(r),l?List.skip:k(AST_EmptyStatement,r);if(r instanceof AST_LambdaDefinition)return n?(_=c.parent())instanceof AST_ExportDeclaration||_ instanceof AST_ExportDefault||_!==i&&e.has_directive("use strict")?r:(s.push(r),l?List.skip:k(AST_EmptyStatement,r)):r;if(r instanceof AST_Var){if(!t)return r;var _;if((_=c.parent())instanceof AST_ExportDeclaration)return r;if(!all(r.definitions,(function(e){var n=e.name;return n instanceof AST_SymbolVar&&!a.has(n.name)&&i.find_variable(n.name)===n.definition()})))return r;r.definitions.forEach((function(e){f.set(e.name.name,e)}));var S=r.to_assignments();if(_ instanceof AST_ForEnumeration&&_.init===r){if(S)return S;var p=r.definitions[0].name;return k(AST_SymbolRef,p)}return _ instanceof AST_For&&_.init===r?S:S?k(AST_SimpleStatement,r,{body:S}):l?List.skip:k(AST_EmptyStatement,r)}return r instanceof AST_Scope?r:r instanceof AST_SymbolConst?(a.set(r.name,!0),r):void 0}}));if(i.transform(c),f.size()>0){var u=[];i instanceof AST_Lambda&&i.each_argname((function(e){all(e.definition().references,(function(e){return!e.in_arg}))&&f.del(e.name)})),f.each((function(e,n){(e=e.clone()).name=e.name.clone(),e.value=null,u.push(e),f.set(n,e),e.name.definition().orig.unshift(e.name)})),u.length>0&&s.push(k(AST_Var,i,{definitions:u}))}i.body=o.concat(s,i.body)}}})),AST_Scope.DEFMETHOD("process_returns",noop),AST_Defun.DEFMETHOD("process_returns",(function(e){if(e.option("booleans")&&!(e.parent()instanceof AST_ExportDefault))switch(ge(this.name.definition(),ye(this),e)){case"d":ke(e,this,!0);break;case!0:be(this,e)}})),AST_Function.DEFMETHOD("process_returns",(function(e){if(e.option("booleans")){var n=!0,t=ye(this);if(!this.name||u(this.name.definition())){var i=e.parent();if(i instanceof AST_Assign){if("="!=i.operator)return;if(!((a=i.left)instanceof AST_SymbolRef))return;if(!u(a.definition()))return}else if(i instanceof AST_Call&&i.expression!==this){var r=i.expression;if(r instanceof AST_SymbolRef&&(r=r.fixed_value()),!(r instanceof AST_Lambda))return;if(r.uses_arguments||r.pinned())return;for(var a,o=i.args,s=0;s<o.length;s++){var f=o[s];if(f===this){if(!(a=r.argnames[s])&&r.rest)return;break}if(f instanceof AST_Spread)return}if(a instanceof AST_DefaultValue&&(a=a.name),a instanceof AST_SymbolFunarg&&!u(a.definition()))return}else{if("Call"!=i.TYPE)return;e.pop();var c=e.in_boolean_context();switch(e.push(this),c){case!0:n=!1;case"d":break;default:return}}n?ke(e,this,!0):be(this,e)}}function u(i){switch(ge(i,t,e)){case!0:n=!1;case"d":return!0}}})),AST_BlockScope.DEFMETHOD("var_names",(function(){var e=this._var_names;return e||(this._var_names=e=new Dictionary,this.enclosed.forEach((function(n){e.set(n.name,!0)})),this.variables.each((function(n,t){e.set(t,!0)}))),e})),AST_Scope.DEFMETHOD("make_var",(function(e,n,t){var i=[this];n instanceof AST_SymbolDeclaration&&n.definition().references.forEach((function(e){var n=e.scope;do{if(!push_uniq(i,n))return;n=n.parent_scope}while(n&&n!==this)}));for(var r=t=t.replace(/^[^a-z_$]|[^a-z0-9_$]/gi,"_"),a=0;!all(i,(function(e){return!e.var_names().has(r)}));a++)r=t+"$"+a;var o=k(e,n,{name:r,scope:this}),s=this.def_variable(o);return i.forEach((function(e){e.enclosed.push(s),e.var_names().set(r,!0)})),o})),AST_Scope.DEFMETHOD("hoist_properties",(function(e){if(e.option("hoist_props")&&!e.has_directive("use asm")){var n=this;if(!is_arrow(n)||!n.value){var t=n instanceof AST_Toplevel&&e.top_retain||return_false,i=Object.create(null),r=new TreeTransformer((function(e,t){if(e instanceof AST_Assign){if("="!=e.operator)return;if(!e.write_only)return;if(!a(e.left,e.right,1))return;t(e,r);var o=new Dictionary,s=[],f=[];return e.right.properties.forEach((function(t){var i=_(AST_SymbolVar,e.left,t.key);f.push(k(AST_VarDef,e,{name:i,value:null}));var r=k(AST_SymbolRef,e,{name:i.name,scope:n,thedef:i.definition()});r.reference(),s.push(k(AST_Assign,e,{operator:"=",left:r,right:t.value}))})),o.value=e.right,i[e.left.definition().id]=o,n.body.splice(n.body.indexOf(r.stack[1])+1,0,k(AST_Var,e,{definitions:f})),w(e,s)}if(e instanceof AST_Scope){if(e===n)return;var c=r.parent();if("Call"==c.TYPE&&c.expression===e)return;return e}if(e instanceof AST_VarDef){if(!a(e.name,e.value,0))return;t(e,r);o=new Dictionary;var u=[],l=e.clone();return l.value=e.name instanceof AST_SymbolConst?k(AST_Number,e,{value:0}):null,u.push(l),e.value.properties.forEach((function(n){u.push(k(AST_VarDef,e,{name:_(e.name.CTOR,e.name,n.key),value:n.value}))})),o.value=e.value,i[e.name.definition().id]=o,List.splice(u)}function _(e,t,i){var r=n.make_var(e,t,t.name+"_"+i);return o.set(i,r.definition()),r}}));n.transform(r),n.transform(new TreeTransformer((function(e,n){if(e instanceof AST_PropAccess){if(!(e.expression instanceof AST_SymbolRef))return;if(!(a=i[e.expression.definition().id]))return;if(e.expression.fixed_value()!==a.value)return;var t=a.get(e.get_property()),r=k(AST_SymbolRef,e,{name:t.name,scope:e.expression.scope,thedef:t});return r.reference(),r}if(e instanceof AST_SymbolRef){var a;if(!(a=i[e.definition().id]))return;if(e.fixed_value()!==a.value)return;return k(AST_Object,e,{properties:[]})}})))}}function a(i,r,a){if(i instanceof AST_Symbol){var o=i.definition();if(o.assignments==a&&o.references.length-o.replaced!=a&&!o.single_use&&n.find_variable(i.name)===o&&!t(o)&&i.fixed_value()===r){var s=i.fixed||o.fixed;if(!s.direct_access&&(!s.escaped||1!=s.escaped.depth))return r instanceof AST_Object&&r.properties.length>0&&f(i,e)&&all(r.properties,(function(e){return un(e)&&"__proto__"!==e.key}))}}}})),function(e){function n(e,n,t,i){for(var r=e.length,a=[],o=!1,s=0;s<r;s++){var f,c=e[s];(f=i&&c instanceof AST_Spread?i(c,n,t):c.drop_side_effect_free(n,t))!==c&&(o=!0),f&&(a.push(f),t=!1)}return a.length?o?a:e:null}function t(e,n,t){var i=e.expression;return i.is_string(n)?i.drop_side_effect_free(n,t):e}function i(e){return e instanceof AST_Spread?k(AST_Array,e,{elements:[e]}):e}e(AST_Node,return_this),e(AST_Accessor,return_null),e(AST_Array,(function(e,r){var a=n(this.elements,e,r,t);return a?a===this.elements&&all(a,(function(e){return e instanceof AST_Spread}))?this:w(this,a.map(i)):null})),e(AST_Assign,(function(e){var n=this.left;if(n instanceof AST_PropAccess){var t=n.expression;if(t.may_throw_on_access(e,!0))return this;if(e.has_directive("use strict")&&t.is_constant())return this}return n.has_side_effects(e)||X[this.operator.slice(0,-1)]?this:(this.write_only=!0,root_expr(n).is_constant_expression(e.find_parent(AST_Scope))?this.right.drop_side_effect_free(e):this)})),e(AST_Await,(function(e){if(!e.option("awaits"))return this;var n=this.expression;if(!Je(e,n))return this;n instanceof AST_UnaryPrefix&&"!"==n.operator&&(n=n.expression);var t=n.drop_side_effect_free(e);if(t===n)return this;t?Je(e,t)||(t=t.negate(e)):t=k(AST_Number,n,{value:0});var i=this.clone();return i.expression=t,i})),e(AST_Binary,(function(e,n){var t=this.left,i=this.right,r=this.operator;if(!$e(r,i,e))return(a=t.drop_side_effect_free(e,n))===t?this:((s=this.clone()).left=a||k(AST_Number,t,{value:0}),s);var a,o=i.drop_side_effect_free(e,n);if(!o)return t.drop_side_effect_free(e,n);if(X[r]&&o.has_side_effects(e)){var s=this;if(o!==i&&((s=s.clone()).right=o.drop_side_effect_free(e)),"??"==r)return s;var f=s.clone();f.operator="&&"==r?"||":"&&",f.left=t.negate(e,n);var c=f.right.tail_node();c instanceof AST_Binary&&f.operator==c.operator&&Ze(f);var u=n?Z:Q;return"&&"==r?u(s,f):u(f,s)}return(a=t.drop_side_effect_free(e,n))?(o=o.drop_side_effect_free(e))?w(this,[a,o]):a:o})),e(AST_Call,(function(e,r){var a=this;if(a.is_expr_pure(e)){a.pure&&AST_Node.warn("Dropping __PURE__ call [{start}]",a);var o=n(a.args,e,r,t);return o&&w(a,o.map(i))}var s=a.expression;if(a.is_call_pure(e))return(_=a.args.slice()).unshift(s.expression),(_=n(_,e,r,t))&&w(a,_.map(i));if(e.option("yields")&&is_generator(s)){var f=a.clone();f.expression=k(AST_Function,s),f.expression.body=[];var c=f.transform(e);if(c!==f)return c.drop_side_effect_free(e,r)}var u=ke(e,s);if(u&&((a=a.clone()).expression=u,s._squeezed&&(a.expression._squeezed=!0)),a instanceof AST_New){var l=s;if(l instanceof AST_SymbolRef&&(l=l.fixed_value()),l instanceof AST_Lambda){var _;if(function(e,n){e.new=!0;var t=all(e.body,(function(e){return!e.has_side_effects(n)}))&&all(e.argnames,(function(e){return!e.match_symbol(return_false)}))&&!(e.rest&&e.rest.match_symbol(return_false));return e.new=!1,t}(l,e))return(_=a.args.slice()).unshift(s),(_=n(_,e,r,t))&&w(a,_.map(i));l.contains_this()||((a=k(AST_Call,a)).expression=a.expression.clone(),a.args=a.args.slice())}}return a.call_only=!0,a})),e(AST_ClassExpression,(function(e,t){for(var i=this,r=[],o=[],s=0,f=i.properties,c=0;c<f.length;c++){var u=f[c];if(u.key instanceof AST_Node&&r.push(u.key),M(u)){var l=u.value;if(l.has_side_effects(e)){if(l.contains_this())return i;u instanceof AST_ClassInit?(s++,o.push(u)):o.push(l)}}}var _=i.extends;if(_&&(_ instanceof AST_SymbolRef&&(_=_.fixed_value()),(_=!a(_))||r.unshift(i.extends)),(r=n(r,e,t))&&(t=!1),o=n(o,e,t),!r){if(!_&&!o&&!i.name)return null;r=[]}if(_||i.name||!e.has_directive("use strict")){var S=he(i);return _||(S.extends=null),S.properties=[],o?o.length==s?(r.length&&o.unshift(k(AST_ClassField,i,{key:w(i,r),value:null})),S.properties=o):S.properties.push(k(AST_ClassField,i,{static:!0,key:r.length?w(i,r):"c",value:p()})):r.length&&S.properties.push(k(AST_ClassMethod,i,{key:w(i,r),value:k(AST_Function,i,{argnames:[],body:[]}).init_vars(S)})),S}return o&&r.push(k(AST_Call,i,{expression:k(AST_Arrow,i,{argnames:[],body:[],value:p()}).init_vars(i.parent_scope),args:[]})),w(i,r);function p(){return w(i,o.map((function(e){if(!(e instanceof AST_ClassInit))return e;var n=k(AST_Arrow,e.value);return n.argnames=[],k(AST_Call,e,{expression:n,args:[]})})))}})),e(AST_Conditional,(function(e){var n,t,i=this.consequent.drop_side_effect_free(e),r=this.alternative.drop_side_effect_free(e);return i===this.consequent&&r===this.alternative?this:(e.option("ie")&&(n=[],i instanceof AST_Function&&(n.push(i),i=null),r instanceof AST_Function&&(n.push(r),r=null)),i?r?((t=this.clone()).consequent=i,t.alternative=r):t=k(AST_Binary,this,{operator:"&&",left:this.condition,right:i}):t=r?k(AST_Binary,this,{operator:"||",left:this.condition,right:r}):this.condition.drop_side_effect_free(e),n?(t&&n.push(t),0==n.length?null:w(this,n)):t)})),e(AST_Constant,return_null),e(AST_Dot,(function(e,n){var t=this.expression;return t.may_throw_on_access(e)?this:t.drop_side_effect_free(e,n)})),e(AST_Function,(function(e){return xe(this,e)?null:this})),e(AST_LambdaExpression,return_null),e(AST_Object,(function(e,t){var i=[];this.properties.forEach((function(e){e instanceof AST_Spread?i.push(e):(e.key instanceof AST_Node&&i.push(e.key),i.push(e.value))}));var r=n(i,e,t,(function(e,n,t){var i=e.expression;return i.safe_to_spread()?i.drop_side_effect_free(n,t):e}));return r?r!==i||all(r,(function(e){return!(e instanceof AST_Spread)}))?w(this,r.map((function(e){return e instanceof AST_Spread?k(AST_Object,e,{properties:[e]}):e}))):this:null})),e(AST_ObjectIdentity,return_null),e(AST_Sequence,(function(e,t){var i=n(this.expressions,e,t);if(!i)return null;var r,a,o,s=i.length-1,f=i[s];if(e.option("awaits")&&s>0&&f instanceof AST_Await&&f.expression.is_constant()){var c=(i=i.slice(0,-1))[--s];f.expression=Je(e,c)?c:c.negate(e),i[s]=f}return e.option("conditionals")&&s>0&&(r=i[s-1])instanceof AST_Assign&&"="==r.operator&&(o=r.left)instanceof AST_SymbolRef&&(a=Me(e,o.definition(),r.right,f))&&((r=r.clone()).right=a,(i=i.slice(0,-2)).push(r.drop_side_effect_free(e,t))),i===this.expressions?this:w(this,i)})),e(AST_Sub,(function(e,n){var t=this.expression;if(t.may_throw_on_access(e))return this;var i=this.property;return(t=t.drop_side_effect_free(e,n))?(i=i.drop_side_effect_free(e))?w(this,[t,i]):t:i.drop_side_effect_free(e,n)})),e(AST_SymbolRef,(function(e){return this.is_declared(e)&&f(this,e)?null:this})),e(AST_Template,(function(e,n){var t=this;if(t.is_expr_pure(e)){var i=t.expressions;return 0==i.length?null:w(t,i).drop_side_effect_free(e,n)}var r=t.tag,a=ke(e,r);return a&&((t=t.clone()).tag=a,r._squeezed&&(t.tag._squeezed=!0)),t})),e(AST_Unary,(function(e,n){var t=this.expression;if(unary_side_effects[this.operator])return this.write_only=!t.has_side_effects(e),this;if("typeof"==this.operator&&t instanceof AST_SymbolRef&&f(t,e))return null;var i=t.drop_side_effect_free(e,n);return n&&i&&z(i)?i===t&&"!"==this.operator?this:i.negate(e,n):i}))}((function(e,n){e.DEFMETHOD("drop_side_effect_free",n)})),e(AST_SimpleStatement,(function(e,n){if(n.option("side_effects")){var t=e.body,i=t.drop_side_effect_free(n,!0);if(!i)return AST_Node.warn("Dropping side-effect-free statement [{start}]",e),k(AST_EmptyStatement,e);if(i!==t)return k(AST_SimpleStatement,e,{body:i})}return e})),e(AST_While,(function(e,n){return n.option("loops")?k(AST_For,e).optimize(n):e})),e(AST_Do,(function(e,n){if(!n.option("loops"))return e;var t=Ce(n,e.condition);if(!(t instanceof AST_Node)){if(t&&!we(e,n.parent(),AST_Continue))return k(AST_For,e,{body:k(AST_BlockStatement,e.body,{body:[e.body,k(AST_SimpleStatement,e.condition,{body:e.condition})]})}).optimize(n);if(!we(e,n.parent()))return k(AST_BlockStatement,e.body,{body:[e.body,k(AST_SimpleStatement,e.condition,{body:e.condition})]}).optimize(n)}if(e.body instanceof AST_BlockStatement&&!we(e,n.parent(),AST_Continue)){for(var i=e.body.body,r=i.length;--r>=0;){var a=i[r];if(a instanceof AST_If&&!a.alternative&&a.body instanceof AST_Break&&n.loopcontrol_target(a.body)===e){if(o(a.condition))break;e.condition=k(AST_Binary,e,{operator:"&&",left:a.condition.negate(n),right:e.condition}),i.splice(r,1)}else if(a instanceof AST_SimpleStatement){if(o(a.body))break;e.condition=w(e,[a.body,e.condition]),i.splice(r,1)}else if(!W(a,!0))break}e.body=Se(e.body,n.parent())}return e.body instanceof AST_EmptyStatement?k(AST_For,e).optimize(n):e.body instanceof AST_SimpleStatement?k(AST_For,e,{condition:w(e.condition,[e.body.body,e.condition]),body:k(AST_EmptyStatement,e)}).optimize(n):e;function o(n){var t=!1;return n.walk(new TreeWalker((function(n){return!!t||(n instanceof AST_SymbolRef?(member(n.definition(),e.enclosed)||(t=!0),!0):void 0)}))),t}})),e(AST_For,(function(e,n){if(!n.option("loops"))return e;if(n.option("side_effects")&&(e.init&&(e.init=e.init.drop_side_effect_free(n)),e.step&&(e.step=e.step.drop_side_effect_free(n))),e.condition){var t=Ce(n,e.condition);if(t)t instanceof AST_Node||(e.body=k(AST_BlockStatement,e.body,{body:[k(AST_SimpleStatement,e.condition,{body:e.condition}),e.body]}),e.condition=null);else if(n.option("dead_code")){var i=[];return is_statement(e.init)?i.push(e.init):e.init&&i.push(k(AST_SimpleStatement,e.init,{body:e.init})),i.push(k(AST_SimpleStatement,e.condition,{body:e.condition})),$(n,e.body,i),k(AST_BlockStatement,e,{body:i}).optimize(n)}}return De(e,n)})),e(AST_ForEnumeration,(function(e,n){if(n.option("varify")&&B(e.init)){var t=e.init.definitions[0].name;(t instanceof AST_Destructured||t instanceof AST_SymbolLet)&&!t.match_symbol((function(e){if(e instanceof AST_SymbolDeclaration){var t=e.definition();return!nn(t)||Oe(n,t)}}),!0)&&(e.init=Pe(e.init,e.resolve()))}return e})),e(AST_If,(function(e,n){if(F(e.alternative)&&(e.alternative=null),!n.option("conditionals"))return e;if(n.option("booleans")&&!e.condition.has_side_effects(n)&&Ne(n,e.condition),n.option("dead_code")){var t=Ce(n,e.condition);if(!t){AST_Node.warn("Condition always false [{start}]",e.condition);var i=[k(AST_SimpleStatement,e.condition,{body:e.condition}).transform(n)];return $(n,e.body,i),e.alternative&&i.push(e.alternative),k(AST_BlockStatement,e,{body:i}).optimize(n)}if(!(t instanceof AST_Node)){AST_Node.warn("Condition always true [{start}]",e.condition);i=[k(AST_SimpleStatement,e.condition,{body:e.condition}).transform(n),e.body];return e.alternative&&$(n,e.alternative,i),k(AST_BlockStatement,e,{body:i}).optimize(n)}}var r=e.condition.negate(n),a=e.condition.print_to_string().length,o=r.print_to_string().length,s=o<a;if(e.alternative&&s){s=!1,e.condition=r;var f=e.body;e.body=e.alternative,e.alternative=F(f)?null:f}var c=[],u=[],l=[],_=L(e.body,c,u,l),S=[],p=[],d=[],A=L(e.alternative,S,p,d);if(_ instanceof AST_BlockStatement||A instanceof AST_BlockStatement){i=[];var h=[];if(_&&([].push.apply(i,c),[].push.apply(h,u),_ instanceof AST_BlockStatement?e.body=_:0==_.length?e.body=k(AST_EmptyStatement,e.body):e.body=k(AST_SimpleStatement,e.body,{body:w(e.body,_)}),l.forEach(T)),A&&([].push.apply(i,S),[].push.apply(h,p),A instanceof AST_BlockStatement?e.alternative=A:0==A.length?e.alternative=null:e.alternative=k(AST_SimpleStatement,e.alternative,{body:w(e.alternative,A)}),d.forEach(T)),h.length>0&&i.push(k(AST_Var,e,{definitions:h})),i.length>0)return i.push(e.transform(n)),k(AST_BlockStatement,e,{body:i}).optimize(n)}else if(_&&A){i=c.concat(S);return(u.length>0||p.length>0)&&i.push(k(AST_Var,e,{definitions:u.concat(p)})),0==_.length?i.push(k(AST_SimpleStatement,e.condition,{body:A.length>0?k(AST_Binary,e,{operator:"||",left:e.condition,right:w(e.alternative,A)}).transform(n):e.condition.clone()}).optimize(n)):0==A.length?(a===o&&!s&&e.condition instanceof AST_Binary&&"||"==e.condition.operator&&(s=!0),i.push(k(AST_SimpleStatement,e,{body:k(AST_Binary,e,{operator:s?"||":"&&",left:s?r:e.condition,right:w(e.body,_)}).transform(n)}).optimize(n))):i.push(k(AST_SimpleStatement,e,{body:k(AST_Conditional,e,{condition:e.condition,consequent:w(e.body,_),alternative:w(e.alternative,A)})}).optimize(n)),l.forEach(T),d.forEach(T),k(AST_BlockStatement,e,{body:i}).optimize(n)}if(F(e.body)&&(e=k(AST_If,e,{condition:r,body:e.alternative,alternative:null})),e.alternative instanceof AST_Exit&&e.body.TYPE==e.alternative.TYPE){var v=e.body.value,y=e.alternative.value;if(!v&&!y)return k(AST_BlockStatement,e,{body:[k(AST_SimpleStatement,e,{body:e.condition}),e.body]}).optimize(n);if(v&&y||!function(){var e=!1,t=0,i=n.self();do{if(i instanceof AST_Catch)n.parent(t).bfinally&&(e=!0),t++;else if(i instanceof AST_Finally)t++;else{if(i instanceof AST_Scope)return e&&m(i);i instanceof AST_Try&&i.bfinally&&(e=!0)}}while(i=n.parent(t++))}()){var g=k(e.body.CTOR,e,{value:k(AST_Conditional,e,{condition:e.condition,consequent:v||k(AST_Undefined,e.body).transform(n),alternative:y||k(AST_Undefined,e.alternative).transform(n)})});return g instanceof AST_Return&&(g.in_bool=e.body.in_bool||e.alternative.in_bool),g}}if(e.body instanceof AST_If&&!e.body.alternative&&!e.alternative&&(e=k(AST_If,e,{condition:k(AST_Binary,e.condition,{operator:"&&",left:e.condition,right:e.body.condition}),body:e.body.body,alternative:null})),le(e.body)&&e.alternative){var b=e.alternative;return e.alternative=null,k(AST_BlockStatement,e,{body:[e,b]}).optimize(n)}if(le(e.alternative)){i=e.body;return e.body=e.alternative,e.condition=s?r:e.condition.negate(n),e.alternative=null,k(AST_BlockStatement,e,{body:[e,i]}).optimize(n)}if(e.alternative){for(var x=U(e.body),D=z(x),E=U(e.alternative),C=z(E),R=[];D>=0&&C>=0;){var B=x[D],O=E[C];if(B.equals(O))x.splice(D--,1),E.splice(C--,1),R.unshift(N(B,O));else{if(!(B instanceof AST_SimpleStatement))break;if(!(O instanceof AST_SimpleStatement))break;var P=B.body.tail_node(),q=O.body.tail_node();if(!P.equals(q))break;D=j(x,B.body,D),C=j(E,O.body,C),R.unshift(k(AST_SimpleStatement,P,{body:N(P,q)}))}}if(R.length>0)return e.body=x.length>0?k(AST_BlockStatement,e,{body:x}):k(AST_EmptyStatement,e),e.alternative=E.length>0?k(AST_BlockStatement,e,{body:E}):null,R.unshift(e),k(AST_BlockStatement,e,{body:R}).optimize(n)}return n.option("typeofs")&&Ee(e.condition,e.body,e.alternative),e;function U(e){return e instanceof AST_BlockStatement?e.body:[e]}function z(e){for(var n=e.length;--n>=0&&W(e[n],!0););return n}function j(e,n,t){return n instanceof AST_Sequence?e[t]=k(AST_SimpleStatement,n,{body:w(n,n.expressions.slice(0,-1))}):e.splice(t--,1),t}function L(e,t,i,r){if(null==e)return[];if(e instanceof AST_BlockStatement){for(var a=[],o=0;o<e.body.length;o++){var s=e.body[o];if(!(s instanceof AST_EmptyStatement)){if(s instanceof AST_Exit){if(0==o)return;a.length>0&&(s=s.clone(),a.push(s.value||k(AST_Undefined,s).transform(n)),s.value=w(e,a));var f=e.clone();return f.body=f.body.slice(o+1),f.body.unshift(s),f}if(s instanceof AST_LambdaDefinition)t.push(s);else if(s instanceof AST_SimpleStatement){if(!n.option("sequences")&&a.length>0)return;a.push(s.body)}else{if(!(s instanceof AST_Var))return;if(!n.option("sequences")&&a.length>0)return;s.remove_initializers(n,i),s.definitions.forEach(c)}}}return a}if(e instanceof AST_LambdaDefinition)return t.push(e),[];if(e instanceof AST_EmptyStatement)return[];if(e instanceof AST_SimpleStatement)return[e.body];if(e instanceof AST_Var){a=[];return e.remove_initializers(n,i),e.definitions.forEach(c),a}function c(e){e.value&&a.push(k(AST_Assign,e,{operator:"=",left:e.name.convert_symbol(AST_SymbolRef,(function(e){r.push(e)})),right:e.value}))}}})),e(AST_Switch,(function(e,n){if(!n.option("switches"))return e;if(!n.option("dead_code"))return e;for(var t,i,r,a=[],o=[],s=[],f=0,c=e.body.length;f<c;f++){if((t=e.body[f])instanceof AST_Default){var u=a[a.length-1];if(i||y(t.body[0],n)&&(!u||le(u))){b(t,u);continue}i=t}else{var l=t.expression,_=k(AST_Binary,e,{operator:"===",left:e.expression,right:l}).evaluate(n,!0);if(!_){l.has_side_effects(n)&&s.push(l),b(t,a[a.length-1]);continue}if(!(_ instanceof AST_Node)){if(i){var S=a.indexOf(i);a.splice(S,1),b(i,a[S-1]),i=null}for(l.has_side_effects(n)?r=t:i=t=k(AST_Default,t);++f<c;)b(e.body[f],t)}}if(f+1>=c||le(t)){u=a[a.length-1];var p=t.body;if(le(u))switch(u.body.length-p.length){case 1:if(!y(A=u.body[u.body.length-1],n))break;p=p.concat(A);case 0:var d=k(AST_BlockStatement,u),T=k(AST_BlockStatement,t,{body:p});d.equals(T)&&(u.body=[])}}s.length&&(t instanceof AST_Default?a.push(k(AST_Case,e,{expression:w(e,s),body:[]})):(s.push(t.expression),t.expression=w(e,s)),s=[]),a.push(t)}for(s.length&&!r&&a.push(k(AST_Case,e,{expression:w(e,s),body:[]}));t=a[a.length-1];){var A;if(y(A=t.body[t.body.length-1],n)&&t.body.pop(),t===i){if(!q(t))break}else{if(t.expression.has_side_effects(n))break;if(i){if(!q(i))break;if(a[a.length-2]!==i)break;i.body=i.body.concat(t.body),t.body=[]}else if(!q(t))break}b(t),a.pop()===i&&(i=null)}if(!t)return o.push(k(AST_SimpleStatement,e.expression,{body:e.expression})),s.length&&o.push(k(AST_SimpleStatement,e,{body:w(e,s)})),k(AST_BlockStatement,e,{body:o}).optimize(n);if(t===i)for(;(t=a[a.length-2])&&!(t instanceof AST_Default)&&q(t);){if((l=t.expression).has_side_effects(n)){if((u=a[a.length-3])&&!le(u))break;i.body.unshift(k(AST_SimpleStatement,e,{body:l}))}b(t),a.splice(-2,1)}if(a[0].body=o.concat(a[0].body),e.body=a,n.option("conditionals"))switch(a.length){case 1:if(!g(a[0]))break;l=a[0].expression,p=a[0].body.slice();return a[0]!==i&&a[0]!==r?k(AST_If,e,{condition:k(AST_Binary,e,{operator:"===",left:e.expression,right:l}),body:k(AST_BlockStatement,e,{body:p}),alternative:null}).optimize(n):(l&&p.unshift(k(AST_SimpleStatement,l,{body:l})),p.unshift(k(AST_SimpleStatement,e.expression,{body:e.expression})),k(AST_BlockStatement,e,{body:p}).optimize(n));case 2:if(!member(i,a)||!g(a[1]))break;var h=(p=a[0].body.slice()).length&&y(p[p.length-1],n);if(h&&p.pop(),!all(p,g))break;var v=a[1].body.length&&k(AST_BlockStatement,a[1]),m=k(AST_If,e,{condition:k(AST_Binary,e,a[0]===i?{operator:"!==",left:e.expression,right:a[1].expression}:{operator:"===",left:e.expression,right:a[0].expression}),body:k(AST_BlockStatement,a[0],{body:p}),alternative:h&&v||null});return!h&&v&&(m=k(AST_BlockStatement,e,{body:[m,v]})),m.optimize(n)}return e;function y(n,t){return n instanceof AST_Break&&t.loopcontrol_target(n)===e}function g(n){var t=!1,i=new TreeWalker((function(e){if(t||e instanceof AST_Lambda||e instanceof AST_SimpleStatement)return!0;y(e,i)&&(t=!0)}));return i.push(e),n.walk(i),!t}function b(e,t){t&&!le(t)?t.body=t.body.concat(e.body):$(n,e,o)}})),e(AST_Try,(function(e,n){if(e.body=G(e.body,n),n.option("dead_code")){if(q(e)&&!(e.bcatch&&e.bcatch.argname&&e.bcatch.argname.match_symbol((function(e){return e instanceof AST_SymbolCatch&&!f(e)}),!0))){var t=[];return e.bcatch&&($(n,e.bcatch,t),t.forEach((function(e){e instanceof AST_Var&&e.definitions.forEach((function(e){var n=e.name.definition().redefined();n&&(e.name=e.name.clone(),e.name.thedef=n)}))}))),t.unshift(k(AST_BlockStatement,e).optimize(n)),e.bfinally&&t.push(k(AST_BlockStatement,e.bfinally).optimize(n)),k(AST_BlockStatement,e,{body:t}).optimize(n)}if(e.bfinally&&q(e.bfinally)){t=k(AST_BlockStatement,e.bfinally).optimize(n);if(t=e.body.concat(t),!e.bcatch)return k(AST_BlockStatement,e,{body:t}).optimize(n);e.body=t,e.bfinally=null}}return e})),AST_Const.DEFMETHOD("remove_initializers",Re((function(e,n){return k(AST_Undefined,n).optimize(e)}))),AST_Let.DEFMETHOD("remove_initializers",Re(return_null)),AST_Var.DEFMETHOD("remove_initializers",Re(return_null)),AST_Definitions.DEFMETHOD("to_assignments",(function(){var e=this.definitions.reduce((function(e,n){var t=n.name.definition(),i=n.value;if(i){i instanceof AST_Sequence&&(i=i.clone());var r=k(AST_SymbolRef,n.name),a=k(AST_Assign,n,{operator:"=",left:r,right:i});e.push(a);var o=function(){return a.right};o.assigns=[a],o.direct_access=t.direct_access,o.escaped=t.escaped,r.fixed=o,t.references.forEach((function(e){if(e.fixed){var i=e.fixed.assigns;i&&i[0]===n&&(i.length>1||e.fixed.to_binary||e.fixed.to_prefix?i[0]=a:(e.fixed=o,t.fixed===e.fixed&&(t.fixed=o)))}})),t.references.push(r)}return t.assignments++,t.eliminated++,t.single_use=!1,e}),[]);return 0==e.length?null:w(this,e)})),e(AST_Const,qe),e(AST_Let,qe),e(AST_Call,(function(e,n){var t=e.expression,r=Ue(e,n);if(r)return r;if(n.option("sequences"))if(t instanceof AST_PropAccess){if((a=ze(t))!==t)return(T=e.clone()).expression=a.expressions.pop(),a.expressions.push(T),a.optimize(n)}else if(!E(t.tail_node())){var a;if((a=ze(e))!==e)return a.optimize(n)}if(n.option("unused")&&je(e,n),n.option("unsafe"))if(L(t))switch(t.name){case"Array":if(1==e.args.length){if((_=e.args[0])instanceof AST_Number)try{var o=_.value;if(o>6)break;for(var s=Array(o),f=0;f<o;f++)s[f]=k(AST_Hole,e);return k(AST_Array,e,{elements:s})}catch(Te){AST_Node.warn("Invalid array length: {length} [{start}]",{length:o,start:e.start});break}if(!_.is_boolean(n)&&!_.is_string(n))break}return k(AST_Array,e,{elements:e.args});case"Object":if(0==e.args.length)return k(AST_Object,e,{properties:[]});break;case"String":if(0==e.args.length)return k(AST_String,e,{value:""});if(1==e.args.length)return k(AST_Binary,e,{operator:"+",left:k(AST_String,e,{value:""}),right:e.args[0]}).optimize(n);break;case"Number":if(0==e.args.length)return k(AST_Number,e,{value:0});if(1==e.args.length)return k(AST_UnaryPrefix,e,{operator:"+",expression:k(AST_Binary,e,{operator:"+",left:k(AST_String,e,{value:""}),right:e.args[0]})}).optimize(n);break;case"Boolean":if(0==e.args.length)return k(AST_False,e).optimize(n);if(1==e.args.length)return k(AST_UnaryPrefix,e,{operator:"!",expression:k(AST_UnaryPrefix,e,{operator:"!",expression:e.args[0]})}).optimize(n);break;case"RegExp":var c=[];if(all(e.args,(function(e){var t=e.evaluate(n);return c.unshift(t),e!==t})))try{return ee(n,e,k(AST_RegExp,e,{value:RegExp.apply(RegExp,c)}))}catch(Te){AST_Node.warn("Error converting {this} [{start}]",e)}}else if(t instanceof AST_Dot)switch(t.property){case"toString":var u=t.expression;if(0==e.args.length&&!(u.may_throw_on_access(n)||u instanceof AST_Super))return k(AST_Binary,e,{operator:"+",left:k(AST_String,e,{value:""}),right:u}).optimize(n);break;case"join":if(t.expression instanceof AST_Array&&e.args.length<2)e:{var l=e.args[0];if(0==t.expression.elements.length&&!(l instanceof AST_Spread))return l?w(e,[l,k(AST_String,e,{value:""})]).optimize(n):k(AST_String,e,{value:""});if(!(l&&(l=l.evaluate(n))instanceof AST_Node)){s=[];var _,S=[];for(f=0;f<t.expression.elements.length;f++){var p=t.expression.elements[f];if((I=p.evaluate(n))!==p)S.push(I);else{if(p instanceof AST_Spread)break e;S.length>0&&(s.push(k(AST_String,e,{value:S.join(l)})),S.length=0),s.push(p)}}return S.length>0&&s.push(k(AST_String,e,{value:S.join(l)})),1==s.length?s[0].is_string(n)?s[0]:k(AST_Binary,s[0],{operator:"+",left:k(AST_String,e,{value:""}),right:s[0]}):""==l?(_=s[0].is_string(n)||s[1].is_string(n)?s.shift():k(AST_String,e,{value:""}),s.reduce((function(e,n){return k(AST_Binary,n,{operator:"+",left:e,right:n})}),_).optimize(n)):((se=e.clone()).expression=se.expression.clone(),se.expression.expression=se.expression.expression.clone(),se.expression.expression.elements=s,ee(n,e,se))}}break;case"charAt":if(e.args.length<2)return(se=k(AST_Binary,e,{operator:"||",left:k(AST_Sub,e,{expression:t.expression,property:e.args.length?k(AST_Binary,e.args[0],{operator:"|",left:k(AST_Number,e,{value:0}),right:e.args[0]}):k(AST_Number,e,{value:0})}).optimize(n),right:k(AST_String,e,{value:""})})).is_string=return_true,se.optimize(n);break;case"apply":if(2==e.args.length&&e.args[1]instanceof AST_Array)return(ne=e.args[1].elements.slice()).unshift(e.args[0]),k(AST_Call,e,{expression:k(AST_Dot,t,{expression:t.expression,property:"call"}),args:ne}).optimize(n);break;case"call":var d=t.expression;if(d instanceof AST_SymbolRef&&(d=d.fixed_value()),d instanceof AST_Lambda&&!d.contains_this())return(e.args.length?w(e,[e.args[0],k(AST_Call,e,{expression:t.expression,args:e.args.slice(1)})]):k(AST_Call,e,{expression:t.expression,args:[]})).optimize(n)}else if(n.option("side_effects")&&t instanceof AST_Call&&1==t.args.length&&L(t.expression)&&"Object"==t.expression.name){var T;return(T=e.clone()).expression=C(e,t,t.args[0]),T.optimize(n)}if(n.option("unsafe_Function")&&L(t)&&"Function"==t.name){if(0==e.args.length)return k(AST_Function,e,{argnames:[],body:[]}).init_vars(t.scope);if(all(e.args,(function(e){return e instanceof AST_String})))try{var A="n(function("+e.args.slice(0,-1).map((function(e){return e.value})).join()+"){"+e.args[e.args.length-1].value+"})",h=parse(A),v={ie:n.option("ie")};h.figure_out_scope(v);var m,g=new i(n.options);(h=h.transform(g)).figure_out_scope(v),h.compute_char_frequency(v),h.mangle_names(v),h.walk(new TreeWalker((function(e){return!!m||(e instanceof AST_Lambda?(m=e,!0):void 0)})));A=OutputStream();return AST_BlockStatement.prototype._codegen.call(m,A),e.args=[k(AST_String,e,{value:m.argnames.map((function(e){return e.print_to_string()})).join()}),k(AST_String,e.args[e.args.length-1],{value:A.get().replace(/^\{|\}$/g,"")})],e}catch(Te){if(!(Te instanceof JS_Parse_Error))throw Te;AST_Node.warn("Error parsing code passed to new Function [{start}]",e.args[e.args.length-1]),AST_Node.warn(Te.toString())}}var x=t instanceof AST_SymbolRef?t.fixed_value():t,N=n.parent(),R=n.self(),B=x instanceof AST_Lambda&&(!is_async(x)||n.option("awaits")&&N instanceof AST_Await)&&(!is_generator(x)||n.option("yields")&&R instanceof AST_Yield&&R.nested),O=B&&x.first_statement(),P=0,q=!1,U=!all(e.args,(function(e){return!(e instanceof AST_Spread)})),j=B&&all(x.argnames,(function(n,t){if(1==P&&e.args[t]instanceof AST_Spread&&(P=2),n instanceof AST_DefaultValue){if(P||(P=1),J(1==P&&e.args[t])||(P=2),_n(x,n.value))return!1;n=n.name}return!(n instanceof AST_Destructured&&(q=!0,_n(x,n)))}))&&!(x.rest instanceof AST_Destructured&&_n(x,x.rest)),V=j&&n.option("inline")&&!e.is_expr_pure(n)&&(t===x||Ie(x,n));if(V&&O instanceof AST_Return){var I=O.value;if(t===x&&!x.name&&(!I||I.is_constant_expression())&&Ve(x,Le(n)))return w(e,ue(I)).optimize(n)}if(B&&!x.contains_this()){var M,W=!1;if(V&&!x.uses_arguments&&!x.pinned()&&!(x.name&&x instanceof AST_LambdaExpression)&&(t===x||!en(n,M=t.definition(),x)&&x.is_constant_expression(y(n)))&&(I=function(e){var t=x.body.length;if(t<2&&(e=_e(e)))return e;if(n.option("inline")<3)return!1;e=null;for(var i=0;i<t;i++){var r=x.body[i];if(r instanceof AST_Var){if(W){if(!e)continue;if(!(e instanceof AST_SimpleStatement))return!1;H(r)||(e=null)}else if(!H(r)){if(e&&!(e instanceof AST_SimpleStatement))return!1;e=null,W=!0}}else{if(r instanceof AST_AsyncDefun||r instanceof AST_Defun||r instanceof AST_EmptyStatement)continue;if(e)return!1;e=r}}return _e(e)}(O))){var Y,K,G,$,Z=t===x||M.single_use&&M.references.length-M.replaced==1;if(function(){if(P||q||U||W||x.rest)return;if(n.option("inline")<2&&x.argnames.length)return;if(!x.variables.all((function(e){return e.references.length-e.replaced<2&&e.orig[0]instanceof AST_SymbolFunarg})))return;var t,i=n.find_parent(AST_Scope),r=!1,a=Le(n,i),o=[],s=!1,f=new TreeWalker((function(e,i){if(r)return!0;if(e instanceof AST_Binary&&X[e.operator]||e instanceof AST_Conditional)o=null;else{if(e instanceof AST_Scope)return r=!0;if(a&&e instanceof AST_Symbol&&a[e.name])return r=!0;if(e instanceof AST_SymbolRef){var c=e.definition();if(x.variables.get(e.name)!==c)return void(o=null);if(c.init instanceof AST_LambdaDefinition)return r=!0;if(is_lhs(e,f.parent()))return r=!0;var u=Se(c);if(t<u||(t=u),!o)return;s?o=null:o.push(x.argnames[u])}else if(!s)return e instanceof AST_Assign&&e.left instanceof AST_PropAccess?(e.left.expression.walk(f),e.left instanceof AST_Sub&&e.left.property.walk(f),e.right.walk(f),s=!0,!0):e.has_side_effects(n)?(i(),s=!0,!0):void 0}}));if(I.walk(f),r)return;var c=e.args.length;if(o&&x.argnames.length>=c){for(c=x.argnames.length;c-- >t&&x.argnames[c]===o.pop(););c++}return c<=t||all(e.args.slice(t,c),s&&!o?function(e){return e.is_constant_expression(i)}:function(e){return!e.has_side_effects(n)})}()){var ne=e.args.slice(),te=[],ie=I.clone(!0).transform(new TreeTransformer((function(n){if(n instanceof AST_SymbolRef){var t=n.definition();if(x.variables.get(n.name)!==t)return te.push(n),n;var i=Se(t),r=ne[i];if(!r)return k(AST_Undefined,e);ne[i]=null;var a=this.parent();return a?C(a,n,r):r}}))),ae=x.inlined;t!==x&&(x.inlined=!0);var oe=[];ne.forEach((function(e){e&&((e=e.clone(!0)).walk(new TreeWalker((function(e){e instanceof AST_SymbolRef&&te.push(e)}))),oe.push(e))}),[]),oe.push(ie);var se=w(e,oe).optimize(n);if(x.inlined=ae,se=C(N,R,se),Z||Q(se,e)===se)return te.forEach((function(e){e.scope=t===x?x.parent_scope:t.scope,e.reference();var n=e.definition();Z&&n.replaced++,n.single_use=!1})),se;se.has_side_effects(n)||(e.drop_side_effect_free=function(e,n){var t=this,i=t.args.slice();return i.unshift(t.expression),w(t,i).drop_side_effect_free(e,n)})}if(Z&&function(){var e,i=new Dictionary,r=0;$=R;do{if($.variables&&$.variables.each((function(e){i.set(e.name,!0)})),e=$,($=n.parent(r++))instanceof AST_ClassField){if(!$.static)return!1}else if($ instanceof AST_DWLoop)G=[];else if($ instanceof AST_For){if($.init===e)continue;G=[]}else if($ instanceof AST_ForEnumeration){if($.init===e)continue;if($.object===e)continue;G=[]}}while(!($ instanceof AST_Scope));if(!(K=$.body.indexOf(e)+1))return!1;if(!Ve(x,Le(n,$)))return!1;var a=(t!==x||x.parent_scope.resolve()===$)&&!$.pinned();$ instanceof AST_Toplevel&&(n.toplevel.vars?i.set("arguments",!0):a=!1);Y=new Dictionary;var o=n.option("inline");return!!function(e,n){var t=!1;return x.each_argname((function(i){if(!t&&!i.unused){if(!n||pe(e,i.name))return t=!0;Y.set(i.name,!0),G&&G.push(i.definition())}})),!t}(i,o>=2&&a)&&(!!function(e,n){for(var t=0;t<x.body.length;t++){var i=x.body[t];if(i instanceof AST_LambdaDefinition){var r=i.name;if(!n)return!1;if(Y.has(r.name))return!1;if(pe(e,r.name))return!1;if(!all(i.enclosed,(function(n){return n.scope===$||n.scope===i||!e.has(n.name)})))return!1;G&&G.push(r.definition())}else if(i instanceof AST_Var){if(!n)return!1;for(var a=i.definitions.length;--a>=0;){r=i.definitions[a].name;if(pe(e,r.name))return!1;G&&G.push(r.definition())}}}return!0}(i,o>=3&&a)&&(!G||0==G.length||!on(x,G)))}()){x._squeezed=!0,t!==x&&(x.parent_scope=t.scope);se=w(e,function(){var t=[],i=[];P>1||q||U||x.rest?function(n,t){function i(e,i){if(i.unused)return ce(i);var r=i.definition();r.assignments++,r.references.push(e);var a=k(AST_SymbolVar,i);r.orig.push(a),r.eliminated++,de(n,t,a)}t.push(k(AST_Assign,e,{operator:"=",left:k(AST_DestructuredArray,e,{elements:x.argnames.map((function(e){return e.unused?k(AST_Hole,e):e.convert_symbol(AST_SymbolRef,i)})),rest:x.rest&&x.rest.convert_symbol(AST_SymbolRef,i)}),right:k(AST_Array,e,{elements:e.args.slice()})}))}(t,i):function(n,t){for(var i=x.argnames.length,r=e.args.length;--r>=i;)t.push(e.args[r]);var a=[];for(r=i;--r>=0;){var o,s=x.argnames[r];s instanceof AST_DefaultValue?(a.push(s),o=s.name):o=s;var f=e.args[r];if(o.unused||$.var_names().has(o.name))f&&t.push(f);else{var c=k(AST_SymbolVar,o),u=o.definition();u.orig.push(c),u.eliminated++,void 0!==o.unused?(de(n,t,c),f&&t.push(f)):(!f&&s===o&&(G||"arguments"==o.name&&!is_arrow(x)&&is_arrow($))&&(f=k(AST_Undefined,e)),de(n,t,c,f))}}for(n.reverse(),t.reverse(),r=a.length;--r>=0;){var l=a[r];if(void 0!==l.name.unused)t.push(l.value);else{var _=k(AST_SymbolRef,l.name);l.name.definition().references.push(_),t.push(k(AST_Assign,l,{operator:"=",left:_,right:l.value}))}}}(t,i);var r=function(e,t){var i=[K,0],r=[],a=[],o=[],s=[],f=[];return x.body.filter(G?function(n){if(!(n instanceof AST_LambdaDefinition))return!0;var t=k(AST_SymbolVar,ln(n.name)),i=t.definition();return i.fixed=!1,i.orig.push(t),i.eliminated++,de(e,a,t,ve(n,!0)),!1}:function(e){if(!(e instanceof AST_LambdaDefinition))return!0;var n=e.name.definition();return $.functions.set(n.name,n),$.variables.set(n.name,n),$.enclosed.push(n),$.var_names().set(n.name,!0),i.push(e),!1}).forEach((function(e){if(e instanceof AST_Var)for(var t=0;t<e.definitions.length;t++){var i=e.definitions[t],a=ln(i.name),c=i.value;c&&f.length>0&&(f.push(c),c=w(i,f),f=[]),de(r,o,a,c),G&&(Y.has(a.name)||1==a.definition().orig.length&&x.functions.has(a.name)||s.push(pn(n,a)))}else e instanceof AST_SimpleStatement&&f.push(e.body)})),[].push.apply(e,r),[].push.apply(t,s),[].push.apply(t,a),[].push.apply(t,o),i}(t,i);i.push(I),t.length&&r.push(k(AST_Var,x,{definitions:t}));return[].splice.apply($.body,r),x.enclosed.forEach((function(e){$.var_names().has(e.name)||($.enclosed.push(e),$.var_names().set(e.name,!0))})),i}()).optimize(n);return C(N,R,se)}}if(n.option("side_effects")&&j&&all(x.body,F)&&(x===t?xe(x,n):!P&&!q&&!x.rest)&&(!is_arrow(x)||!x.value)&&Ve(x,Le(n)))return w(e,ue()).optimize(n)}if(n.option("drop_console")&&t instanceof AST_PropAccess){for(var fe=t.expression;fe.expression;)fe=fe.expression;if(L(fe)&&"console"==fe.name)return k(AST_Undefined,e).optimize(n)}return n.option("negate_iife")&&N instanceof AST_SimpleStatement&&z(R)?e.negate(n,!0):re(n,e);function ce(e){return k(AST_Sub,e,{expression:k(AST_Array,e,{elements:[]}),property:k(AST_Number,e,{value:0})})}function ue(n){var t=e.args.slice(),i=P>1||q||x.rest;if((i||U)&&(t=[k(AST_Array,e,{elements:t})]),i){var r=new TreeTransformer((function(e,n){if(e instanceof AST_DefaultValue)return k(AST_DefaultValue,e,{name:e.name.transform(r)||ce(e),value:e.value});if(e instanceof AST_DestructuredArray){var t=[];return e.elements.forEach((function(e,n){(e=e.transform(r))&&(t[n]=e)})),Ae(e,t),k(AST_DestructuredArray,e,{elements:t})}if(e instanceof AST_DestructuredObject){var i=[],a=[];return e.properties.forEach((function(n){var t=n.key,o=n.value.transform(r);o?(a.length&&(t instanceof AST_Node||(t=D(t,n)),a.push(t),t=w(e,a),a=[]),i.push(k(AST_DestructuredKeyVal,n,{key:t,value:o}))):t instanceof AST_Node&&a.push(t)})),a.length&&i.push(k(AST_DestructuredKeyVal,e,{key:w(e,a),value:ce(e)})),k(AST_DestructuredObject,e,{properties:i})}return e instanceof AST_SymbolFunarg?null:void 0})),a=[];x.argnames.forEach((function(e,n){(e=e.transform(r))&&(a[n]=e)}));var o=x.rest&&x.rest.transform(r);o&&(a.length=x.argnames.length),Ae(x,a),t[0]=k(AST_Assign,e,{operator:"=",left:k(AST_DestructuredArray,x,{elements:a,rest:o}),right:t[0]})}else x.argnames.forEach((function(e){e instanceof AST_DefaultValue&&t.push(e.value)}));return t.push(n||k(AST_Undefined,e)),t}function le(){return e.call_only?k(AST_Number,e,{value:0}):k(AST_Undefined,e)}function _e(n){return n?n instanceof AST_Return?n.value||le():n instanceof AST_SimpleStatement?e.call_only?n.body:k(AST_UnaryPrefix,n,{operator:"void",expression:n.body}):void 0:le()}function Se(e){for(var n=x.argnames.length;--n>=0;)if(x.argnames[n].definition()===e)return n}function pe(e,n){return e.has(n)||b[n]||$.var_names().has(n)}function de(n,t,i,r){var a=i.definition();if($.var_names().has(i.name)||($.var_names().set(i.name,!0),n.push(k(AST_VarDef,i,{name:i,value:null}))),$.variables.set(i.name,a),$.enclosed.push(a),r){var o=k(AST_SymbolRef,i);a.assignments++,a.references.push(o),t.push(k(AST_Assign,e,{operator:"=",left:o,right:r}))}}})),e(AST_New,(function(e,n){if(n.option("unsafe")){var t=e.expression;if(L(t))switch(t.name){case"Array":case"Error":case"Function":case"Object":case"RegExp":return k(AST_Call,e).transform(n)}}if(n.option("sequences")){var i=ze(e);if(i!==e)return i.optimize(n)}return n.option("unused")&&je(e,n),e})),e(AST_Sequence,(function(e,n){var t=function(){if(!n.option("side_effects"))return e.expressions;var t=[],i=first_in_statement(n),r=e.expressions.length-1;return e.expressions.forEach((function(e,a){a<r&&(e=e.drop_side_effect_free(n,i)),e&&(R(t,e),i=!1)})),t}(),i=t.length-1;return function(){for(var e=1;e<i;e++){var a=t[e-1],o=r(a);if(o){var s=t[e];if(n.option("conditionals")){var f=Me(n,o,a.right,s);if(f){a.right=f,t.splice(e--,1),i--;continue}}n.option("dead_code")&&r(s)===o&&s.right.is_constant_expression(o.scope.resolve())&&(t[--e]=a.right)}}}(),function(){if(!n.option("side_effects"))return;for(;i>0&&J(t[i],n);)i--;i<t.length-1&&(t[i]=k(AST_UnaryPrefix,e,{operator:"void",expression:t[i]}),t.length=i+1)}(),0==i?((e=C(n.parent(),n.self(),t[0]))instanceof AST_Sequence||(e=e.optimize(n)),e):(e.expressions=t,e);function r(e){return e instanceof AST_Assign&&"="==e.operator&&e.left instanceof AST_SymbolRef&&e.left.definition()}})),e(AST_UnaryPostfix,(function(e,n){if(n.option("sequences")){var t=ze(e);if(t!==e)return t.optimize(n)}return re(n,e)}));var He=makePredicate("+ -"),We=makePredicate("* / %");e(AST_UnaryPrefix,(function(e,n){var t=e.operator,i=e.expression;if(n.option("sequences")&&function(){switch(t){case"delete":return!c(i.tail_node());case"typeof":return!L(i.tail_node());default:return!0}}()){var r=ze(e);if(r!==e)return r.optimize(n)}switch(t){case"+":if(!n.option("evaluate"))break;if(!i.is_number(n,!0))break;var a=n.parent();if(a instanceof AST_UnaryPrefix&&"delete"==a.operator)break;return i;case"-":if(i instanceof AST_Infinity&&(i=i.transform(n)),i instanceof AST_Number||i instanceof AST_Infinity)return e;break;case"!":if(!n.option("booleans"))break;if(i.is_truthy())return w(e,[i,k(AST_False,e)]).optimize(n);if(n.in_boolean_context()){if(i instanceof AST_UnaryPrefix&&"!"==i.operator)return i.expression;if(i instanceof AST_Binary){var o=first_in_statement(n);e=(o?Z:Q)(e,i.negate(n,o))}}break;case"delete":if(!n.option("evaluate"))break;if(c(i))break;return w(e,[i,k(AST_True,e)]).optimize(n);case"typeof":if(!n.option("booleans"))break;if(!n.in_boolean_context())break;AST_Node.warn("Boolean expression always true [{start}]",e);var s=[k(AST_True,e)];return i instanceof AST_SymbolRef&&f(i,n)||s.unshift(i),w(e,s).optimize(n);case"void":if(!n.option("side_effects"))break;return(i=i.drop_side_effect_free(n))?(e.expression=i,e):k(AST_Undefined,e).optimize(n)}return n.option("evaluate")&&i instanceof AST_Binary&&He[t]&&We[i.operator]&&(i.left.is_constant()||!i.right.has_side_effects(n))?k(AST_Binary,e,{operator:i.operator,left:k(AST_UnaryPrefix,i.left,{operator:t,expression:i.left}),right:i.right}):re(n,e);function c(e){return e instanceof AST_Infinity||e instanceof AST_NaN||e instanceof AST_NewTarget||e instanceof AST_PropAccess||e instanceof AST_SymbolRef||e instanceof AST_Undefined}})),e(AST_Await,(function(e,n){if(!n.option("awaits"))return e;if(n.option("sequences")){var t=ze(e);if(t!==e)return t.optimize(n)}if(n.option("side_effects")){var i=e.expression;if(i instanceof AST_Await)return i.optimize(n);if(i instanceof AST_UnaryPrefix&&i.expression instanceof AST_Await)return i.optimize(n);for(var r,a=0,o=e;r=n.parent(a++);o=r){if(is_arrow(r)){if(r.value===o)return i.optimize(n)}else if(r instanceof AST_Return){var s=!0;do{if(o=r,(r=n.parent(a++))instanceof AST_Try&&(r.bfinally||r.bcatch)!==o){s=!1;break}}while(r&&!(r instanceof AST_Scope));if(s)return i.optimize(n)}else if(r instanceof AST_Sequence&&r.tail_node()===o)continue;break}}return e})),e(AST_Yield,(function(e,n){if(!n.option("yields"))return e;if(n.option("sequences")){var t=ze(e);if(t!==e)return t.optimize(n)}var i=e.expression;if(e.nested&&"Call"==i.TYPE){var r=i.clone().optimize(n);if("Call"!=r.TYPE)return r}return e})),AST_Binary.DEFMETHOD("lift_sequences",(function(e){if(this.left instanceof AST_PropAccess){if(!(this.left.expression instanceof AST_Sequence))return this;var n=this.left.expression.expressions.slice();return(t=this.clone()).left=t.left.clone(),t.left.expression=n.pop(),n.push(t),w(this,n)}if(this.left instanceof AST_Sequence){n=this.left.expressions.slice();return(t=this.clone()).left=n.pop(),n.push(t),w(this,n)}if(this.right instanceof AST_Sequence){if(this.left.has_side_effects(e))return this;for(var t,i="="==this.operator&&this.left instanceof AST_SymbolRef,r=(n=this.right.expressions).length-1,a=0;a<r&&(i||!n[a].has_side_effects(e));a++);if(a==r)return n=n.slice(),(t=this.clone()).right=n.pop(),n.push(t),w(this,n);if(a>0)return(t=this.clone()).right=w(this.right,n.slice(a)),(n=n.slice(0,a)).push(t),w(this,n)}return this}));var Ye=makePredicate("indexOf lastIndexOf"),Ke=makePredicate("== === != !== * & | ^");function Ge(e,n){return e instanceof AST_Assign?!n&&"="==e.operator&&Ge(e.right):e instanceof AST_New?!n:e instanceof AST_Sequence?Ge(e.tail_node(),n):e instanceof AST_SymbolRef?!n&&Ge(e.fixed_value()):e instanceof AST_Array||e instanceof AST_Class||e instanceof AST_Lambda||e instanceof AST_Object}function $e(e,n,t){switch(e){case"in":return Ge(n)||t&&t.option("unsafe_comps");case"instanceof":return n instanceof AST_SymbolRef&&(n=n.fixed_value()),r(n)||t&&t.option("unsafe_comps");default:return!0}}function Je(e,n){if(n.is_constant())return!0;if(n instanceof AST_Assign)return"="!=n.operator||Je(e,n.right);if(n instanceof AST_Binary)return!X[n.operator]||Je(e,n.left)&&Je(e,n.right);if(n instanceof AST_Call)return is_async(n.expression);if(n instanceof AST_Conditional)return Je(e,n.consequent)&&Je(e,n.alternative);if(n instanceof AST_Sequence)return Je(e,n.tail_node());if(n instanceof AST_SymbolRef){var t=n.fixed_value();return t&&Je(e,t)}return n instanceof AST_Template?!n.tag||tn(e,n.tag):n instanceof AST_Unary||void 0}function Xe(e,n){return e instanceof AST_Assign?x(e.left,n)?e:e.left:e instanceof AST_Sequence?Xe(e.tail_node(),n):e instanceof AST_UnaryPrefix&&UNARY_POSTFIX[e.operator]?x(e.expression,n)?e:e.expression:e}function Qe(e,n){return n instanceof AST_Dot?Qe(e,n.expression):n instanceof AST_Sub?Qe(e,n.expression)&&Qe(e,n.property):n instanceof AST_Symbol||!n.has_side_effects(e)}function Ze(e,n){var t=e.right.tail_node();if(t!==e.right){var i=e.right.expressions.slice(0,-1);i.push(t.left),(t=t.clone()).left=w(e.right,i),e.right=t}e.left=k(AST_Binary,e,{operator:e.operator,left:e.left,right:t.left,start:e.left.start,end:t.left.end}),e.right=t.right,n?e.left=e.left.transform(n):e.operator==t.left.operator&&Ze(e.left)}function en(e,n,t){var i=0,a=e.self();do{if(a===t)return a;if(r(a)&&a.name&&a.name.definition()===n)return a}while(a=e.parent(i++))}function nn(e){var n=e.scope.resolve();return all(e.references,(function(e){return n===e.scope.resolve()}))}function tn(e,n){return e.option("unsafe")&&n instanceof AST_Dot&&"raw"==n.property&&L(n.expression)&&"String"==n.expression.name}function rn(e){var n=!1;if(e=e.replace(/\\(u\{[^{}]*\}?|u[\s\S]{0,4}|x[\s\S]{0,2}|[0-9]+|[\s\S])/g,(function(e,t){var i=decode_escape_sequence(t);if("string"==typeof i)return i;n=!0})),!n)return e}function an(e,n){return e instanceof AST_SymbolRef||e.TYPE===n.TYPE}function on(e,n){var t=!1,i=new TreeWalker((function(e){return!!t||(e instanceof AST_SymbolRef&&member(e.definition(),n)?t=!0:void 0)})),r=new TreeWalker((function(n){if(t)return!0;if(n instanceof AST_Lambda&&n!==e){if(!(n.name||is_async(n)||is_generator(n))){var a=r.parent();if(a instanceof AST_Call&&a.expression===n)return}return n.walk(i),!0}}));return e.walk(r),t}e(AST_Binary,(function(e,n){if(!Ke[e.operator]||!e.right.is_constant()||e.left.is_constant()||e.left instanceof AST_Binary&&PRECEDENCE[e.left.operator]>=PRECEDENCE[e.operator]||F(),n.option("sequences")){var t=e.lift_sequences(n);if(t!==e)return t.optimize(n)}if(n.option("assignments")&&X[e.operator]){var i=Xe(e.left,n),a=e.right;if(i instanceof AST_SymbolRef&&a instanceof AST_Assign&&"="==a.operator&&i.equals(a.left)){i=i.clone();var o=k(AST_Assign,e,{operator:"=",left:i,right:k(AST_Binary,e,{operator:e.operator,left:e.left,right:a.right})});i.fixed&&(i.fixed=function(){return o.right},i.fixed.assigns=[o]);var s=i.definition();return s.references.push(i),s.replaced++,o.optimize(n)}}if(n.option("comparisons"))switch(e.operator){case"===":case"!==":if(J(e.left,n)&&e.right.is_defined(n))return AST_Node.warn("Expression always defined [{start}]",e),w(e,[e.right,k("==="==e.operator?AST_False:AST_True,e)]).optimize(n);var f=!0;(e.left.is_string(n)&&e.right.is_string(n)||e.left.is_number(n)&&e.right.is_number(n)||e.left.is_boolean(n)&&e.right.is_boolean(n)||Qe(n,e.left)&&e.left.equals(e.right))&&(e.operator=e.operator.slice(0,2));case"==":case"!=":if(!f&&J(e.left,n))e.left=k(AST_Null,e.left);else if(n.option("typeofs")&&e.left instanceof AST_String&&"undefined"==e.left.value&&e.right instanceof AST_UnaryPrefix&&"typeof"==e.right.operator){((u=e.right.expression)instanceof AST_SymbolRef?!u.is_declared(n):u instanceof AST_PropAccess&&n.option("ie"))||(e.right=u,e.left=k(AST_Undefined,e.left).optimize(n),2==e.operator.length&&(e.operator+="="))}else if(e.left instanceof AST_SymbolRef&&e.right instanceof AST_SymbolRef&&e.left.definition()===e.right.definition()&&Ge(e.left))return k("="==e.operator[0]?AST_True:AST_False,e).optimize(n);break;case"&&":case"||":var c=e.left;if(!(c instanceof AST_Binary))break;if(c.operator!=("&&"==e.operator?"!==":"==="))break;if(!(e.right instanceof AST_Binary))break;if(c.operator!=e.right.operator)break;if(J(c.left,n)&&e.right.left instanceof AST_Null||c.left instanceof AST_Null&&J(e.right.left,n)){var u;if((u=c.right)instanceof AST_Assign&&"="==u.operator&&(u=u.left),u.has_side_effects(n))break;if(!u.equals(e.right.right))break;return c.operator=c.operator.slice(0,-1),c.left=k(AST_Null,e),c}}var l=!1,_=n.parent();if(n.option("booleans")){i=Xe(e.left,n);if(X[e.operator]&&!i.has_side_effects(n)){if(i.equals(e.right))return C(_,n.self(),e.left).optimize(n);Ne(n,i)}l=n.in_boolean_context()}if(l)switch(e.operator){case"+":var S=e.left.evaluate(n,!0);if(S&&"string"==typeof S||(S=e.right.evaluate(n,!0))&&"string"==typeof S){AST_Node.warn("+ in boolean context always true [{start}]",e);var p=[];if(e.left.evaluate(n)instanceof AST_Node&&p.push(e.left),e.right.evaluate(n)instanceof AST_Node&&p.push(e.right),p.length<2)return p.push(k(AST_True,e)),w(e,p).optimize(n);e.truthy=!0}break;case"==":if(e.left instanceof AST_String&&""==e.left.value&&e.right.is_string(n))return k(AST_UnaryPrefix,e,{operator:"!",expression:e.right}).optimize(n);break;case"!=":if(e.left instanceof AST_String&&""==e.left.value&&e.right.is_string(n))return e.right.optimize(n)}if(n.option("comparisons")&&e.is_boolean(n)){if("Binary"!=_.TYPE){var d=k(AST_UnaryPrefix,e,{operator:"!",expression:e.negate(n)});if(ee(n,e,d)===d)return d}switch(e.operator){case">":F("<");break;case">=":F("<=")}}if(n.option("conditionals")&&X[e.operator]){if(e.left instanceof AST_Binary&&e.operator==e.left.operator){var T=k(AST_Binary,e,{operator:e.operator,left:e.left.right,right:e.right}),A=T.transform(n);T!==A&&(e.left=e.left.left,e.right=A)}(b=e.right.tail_node())instanceof AST_Binary&&e.operator==b.operator&&Ze(e,n)}if(n.option("strings")&&"+"==e.operator){if(e.right instanceof AST_String&&""==e.right.value&&e.left.is_string(n))return e.left.optimize(n);if(e.left instanceof AST_String&&""==e.left.value&&e.right.is_string(n))return e.right.optimize(n);if(e.left instanceof AST_Binary&&"+"==e.left.operator&&e.left.left instanceof AST_String&&""==e.left.left.value&&e.right.is_string(n)&&(e.left.right.is_constant()||!e.right.has_side_effects(n)))return e.left=e.left.right,e.optimize(n);(b=e.right.tail_node())instanceof AST_Binary&&e.operator==b.operator&&(e.left.is_string(n)&&b.is_string(n)||b.left.is_string(n)&&(e.left.is_constant()||!b.right.has_side_effects(n)))&&Ze(e,n)}if(n.option("evaluate")){var h=!0;switch(e.operator){case"&&":if(!(g=Ce(n,e.left)))return AST_Node.warn("Condition left of && always false [{start}]",e),C(_,n.self(),e.left).optimize(n);if(!(g instanceof AST_Node))return AST_Node.warn("Condition left of && always true [{start}]",e),w(e,[e.left,e.right]).optimize(n);if(e.right.evaluate(n,!0)){if((l||"&&"==_.operator&&_.left===n.self())&&!(e.right.evaluate(n)instanceof AST_Node))return AST_Node.warn("Dropping side-effect-free && [{start}]",e),e.left.optimize(n)}else{if(l&&!(e.right.evaluate(n)instanceof AST_Node))return AST_Node.warn("Boolean && always false [{start}]",e),w(e,[e.left,k(AST_False,e)]).optimize(n);e.falsy=!0}if("||"==e.left.operator)if(!(y=Ce(n,e.left.right)))return k(AST_Conditional,e,{condition:e.left.left,consequent:e.right,alternative:e.left.right}).optimize(n);break;case"??":var v=!0;case"||":var m,y,g=Ce(n,e.left,v);if(!(v?null!=g:g))return AST_Node.warn("Condition left of {operator} always {value} [{start}]",{operator:e.operator,value:v?"nullish":"false",start:e.start}),w(e,[e.left,e.right]).optimize(n);if(!(g instanceof AST_Node))return AST_Node.warn("Condition left of {operator} always {value} [{start}]",{operator:e.operator,value:v?"defined":"true",start:e.start}),C(_,n.self(),e.left).optimize(n);if(v||!(m=e.right.evaluate(n,!0))||m instanceof AST_Node){if((l||"||"==_.operator&&_.left===n.self())&&!e.right.evaluate(n))return AST_Node.warn("Dropping side-effect-free {operator} [{start}]",e),e.left.optimize(n)}else{if(l&&!(e.right.evaluate(n)instanceof AST_Node))return AST_Node.warn("Boolean || always true [{start}]",e),w(e,[e.left,k(AST_True,e)]).optimize(n);e.truthy=!0}if(!v&&"&&"==e.left.operator)if((y=Ce(n,e.left.right))&&!(y instanceof AST_Node))return k(AST_Conditional,e,{condition:e.left.left,consequent:e.left.right,alternative:e.right}).optimize(n);break;case"+":if(e.left instanceof AST_Constant&&e.right instanceof AST_Binary&&"+"==e.right.operator&&e.right.left instanceof AST_Constant&&e.right.is_string(n)&&(e=k(AST_Binary,e,{operator:"+",left:k(AST_String,e.left,{value:""+e.left.value+e.right.left.value,start:e.left.start,end:e.right.left.end}),right:e.right.right})),e.right instanceof AST_Constant&&e.left instanceof AST_Binary&&"+"==e.left.operator&&e.left.right instanceof AST_Constant&&e.left.is_string(n)&&(e=k(AST_Binary,e,{operator:"+",left:e.left.left,right:k(AST_String,e.right,{value:""+e.left.right.value+e.right.value,start:e.left.right.start,end:e.right.end})})),e.right instanceof AST_UnaryPrefix&&"-"==e.right.operator&&e.left.is_number(n)){e=k(AST_Binary,e,{operator:"-",left:e.left,right:e.right.expression});break}if(e.left instanceof AST_UnaryPrefix&&"-"==e.left.operator&&P()&&e.right.is_number(n)){e=k(AST_Binary,e,{operator:"-",left:e.right,right:e.left.expression});break}if(n.option("unsafe_math")&&e.left instanceof AST_Binary&&PRECEDENCE[e.left.operator]==PRECEDENCE[e.operator]&&e.right.is_constant()&&(e.right.is_boolean(n)||e.right.is_number(n))&&e.left.is_number(n)&&!e.left.right.is_constant()&&(e.left.left.is_boolean(n)||e.left.left.is_number(n))){e=k(AST_Binary,e,{operator:e.left.operator,left:k(AST_Binary,e,{operator:e.operator,left:e.right,right:e.left.left}),right:e.left.right});break}case"-":if(e.right instanceof AST_UnaryPrefix&&"-"==e.right.operator&&e.left.is_number(n)&&e.right.expression.is_number(n)){e=k(AST_Binary,e,{operator:"+",left:e.left,right:e.right.expression});break}case"*":case"/":h=n.option("unsafe_math"),"+"!=e.operator&&["left","right"].forEach((function(t){var i=e[t];if(i instanceof AST_UnaryPrefix&&"+"==i.operator){var r=i.expression;(r.is_boolean(n)||r.is_number(n)||r.is_string(n))&&(e[t]=r)}}));case"&":case"|":case"^":if("-"==e.operator||"/"==e.operator||!e.left.is_boolean(n)&&!e.left.is_number(n)||!e.right.is_boolean(n)&&!e.right.is_number(n)||!P()||e.left instanceof AST_Binary&&e.left.operator!=e.operator&&PRECEDENCE[e.left.operator]>=PRECEDENCE[e.operator]||(e=ee(n,e,k(AST_Binary,e,{operator:e.operator,left:e.right,right:e.left}),e.right instanceof AST_Constant&&!(e.left instanceof AST_Constant))),!h||!e.is_number(n))break;if(!(e.right instanceof AST_Binary&&"%"!=e.right.operator&&PRECEDENCE[e.right.operator]==PRECEDENCE[e.operator]&&e.right.is_number(n)&&("+"!=e.operator||e.right.left.is_boolean(n)||e.right.left.is_number(n)))||"-"==e.operator&&e.left.is_negative_zero()||!e.right.left.is_constant_expression()&&e.right.right.has_side_effects(n)||function(e){var n=!1;return e.walk(new TreeWalker((function(e){if(n)return!0;if(e instanceof AST_Assign){if(e.left instanceof AST_PropAccess)return n=!0}else if(e instanceof AST_Unary&&unary_side_effects[e.operator]&&e.expression instanceof AST_PropAccess)return n=!0}))),n}(e.right.right)||"+"!=(e=k(AST_Binary,e,{operator:R(e.operator,e.right.operator),left:k(AST_Binary,e.left,{operator:e.operator,left:e.left,right:e.right.left,start:e.left.start,end:e.right.left.end}),right:e.right.right})).operator||e.right.is_boolean(n)||e.right.is_number(n)||(e.right=k(AST_UnaryPrefix,e.right,{operator:"+",expression:e.right})),e.right instanceof AST_Constant&&e.left instanceof AST_Binary&&"%"!=e.left.operator&&PRECEDENCE[e.left.operator]==PRECEDENCE[e.operator]&&e.left.is_number(n))if(e.left.left instanceof AST_Constant){i=B(e.operator,e.left.left,e.right,{start:e.left.left.start,end:e.right.end});e=B(e.left.operator,re(n,i),e.left.right,e)}else if(e.left.right instanceof AST_Constant){var b,x=R(e.left.operator,e.operator);!(b=re(n,B(x,e.left.right,e.right,e.left))).is_constant()||"-"==e.left.operator&&0!=e.right.value&&0==+b.value&&e.left.left.is_negative_zero()||(e=B(e.left.operator,e.left.left,b,e))}break;case"instanceof":if(r(e.right))return w(e,[e,k(AST_False,e)]).optimize(n)}if(!(_ instanceof AST_UnaryPrefix&&"delete"==_.operator)){if(e.left instanceof AST_Number&&!e.right.is_constant())switch(e.operator){case"+":if(0==e.left.value){if(e.right.is_boolean(n))return k(AST_UnaryPrefix,e,{operator:"+",expression:e.right}).optimize(n);if(e.right.is_number(n)&&!e.right.is_negative_zero())return e.right}break;case"*":if(1==e.left.value)return k(AST_UnaryPrefix,e,{operator:"+",expression:e.right}).optimize(n)}if(e.right instanceof AST_Number&&!e.left.is_constant())switch(e.operator){case"+":if(0==e.right.value){if(e.left.is_boolean(n))return k(AST_UnaryPrefix,e,{operator:"+",expression:e.left}).optimize(n);if(e.left.is_number(n)&&!e.left.is_negative_zero())return e.left}break;case"-":if(0==e.right.value)return k(AST_UnaryPrefix,e,{operator:"+",expression:e.left}).optimize(n);break;case"/":if(1==e.right.value)return k(AST_UnaryPrefix,e,{operator:"+",expression:e.left}).optimize(n)}}}if(n.option("typeofs"))switch(e.operator){case"&&":Ee(e.left,e.right,null);break;case"||":Ee(e.left,null,e.right)}if(n.option("unsafe")){var D=O(e.right);if(l&&D&&("=="==e.operator||"!="==e.operator)&&e.left instanceof AST_Number&&0==e.left.value)return("=="==e.operator?k(AST_UnaryPrefix,e,{operator:"!",expression:e.right}):e.right).optimize(n);var E=O(e.left);if(n.option("comparisons")&&function(){switch(e.operator){case"<=":return D&&e.left instanceof AST_Number&&0==e.left.value;case"<":if(E&&e.right instanceof AST_Number&&0==e.right.value)return!0;case"==":case"!=":return!!D&&(e.left instanceof AST_Number&&-1==e.left.value||e.left instanceof AST_UnaryPrefix&&"-"==e.left.operator&&e.left.expression instanceof AST_Number&&1==e.left.expression.value)}}()){var N=k(AST_UnaryPrefix,e,{operator:"!",expression:k(AST_UnaryPrefix,e,{operator:"~",expression:E?e.left:e.right})});switch(e.operator){case"<":if(E)break;case"<=":case"!=":N=k(AST_UnaryPrefix,e,{operator:"!",expression:N})}return N.optimize(n)}}return re(n,e);function R(e,n){switch(e){case"-":return"+"==n?"-":"+";case"/":return"*"==n?"/":"*";default:return n}}function B(e,t,i,r){return"+"==e&&(t.is_boolean(n)||t.is_number(n)||(t=k(AST_UnaryPrefix,t,{operator:"+",expression:t})),i.is_boolean(n)||i.is_number(n)||(i=k(AST_UnaryPrefix,i,{operator:"+",expression:i}))),k(AST_Binary,r,{operator:e,left:t,right:i})}function O(e){return"Call"==e.TYPE&&e.expression instanceof AST_Dot&&Ye[e.expression.property]}function P(){return e.left.is_constant()||e.right.is_constant()||!e.left.has_side_effects(n)&&!e.right.has_side_effects(n)}function F(n){if(P()){n&&(e.operator=n);var t=e.left;e.left=e.right,e.right=t}}})),e(AST_SymbolExport,(function(e){return e})),e(AST_SymbolRef,(function(e,n){if(!n.option("ie")&&L(e)&&(!e.scope.resolve().uses_with||!n.find_parent(AST_With)))switch(e.name){case"undefined":return k(AST_Undefined,e).optimize(n);case"NaN":return k(AST_NaN,e).optimize(n);case"Infinity":return k(AST_Infinity,e).optimize(n)}var t=n.parent();if(n.option("reduce_vars")&&is_lhs(n.self(),t)!==n.self()){var i,a,o,s=e.definition(),f=e.fixed_value(),c=s.single_use&&!(t instanceof AST_Call&&t.is_expr_pure(n));if(c)if(r(f)){if(s.scope===e.scope.resolve(!0)&&!s.in_loop||n.option("reduce_funcs")&&1!=s.escaped.depth&&!f.inlined)if(s.redefined())c=!1;else if(en(n,s,f))c=!1;else if(f.name&&f.name.definition()!==s)c=!1;else if(f.parent_scope!==e.scope||is_funarg(s))if(Ie(f,n)){if("f"==(c=f.is_constant_expression(e.scope))){var u=e.scope;do{(u instanceof AST_LambdaDefinition||u instanceof AST_LambdaExpression)&&(u.inlined=!0)}while(u=u.parent_scope)}}else c=!1;else(f.name&&("await"==f.name.name&&is_async(f)||"yield"==f.name.name&&is_generator(f))||f.has_side_effects(n)||n.option("ie")&&f instanceof AST_Class)&&(c=!1);else c=!1;c&&(f.parent_scope=e.scope)}else(!f||s.recursive_refs>0||!f.is_constant_expression()||f.drop_side_effect_free(n))&&(c=!1);if(c){if(s.single_use=!1,f._squeezed=!0,f.single_use=!0,f instanceof AST_DefClass&&(f=he(f)),f instanceof AST_LambdaDefinition&&(f=ve(f)),r(f)){var l=[];u=e.scope;do{if(l.push(u),u===s.scope)break}while(u=u.parent_scope);f.enclosed.forEach((function(e){if(!f.variables.has(e.name))for(var n=0;n<l.length;n++){var t=l[n];if(!push_uniq(t.enclosed,e))return;t.var_names().set(e.name,!0)}}))}if(s.recursive_refs>0){var _,S,p=(m=f.clone(!0)).name.definition(),d=m.variables.get(m.name.name),T=d&&d.orig[0];m instanceof AST_Class?(_="def_function",S=AST_SymbolClass):(_="def_variable",S=AST_SymbolLambda),T instanceof S||((T=k(S,m.name)).scope=m,m.name=T,(d=m[_](T)).recursive_refs=s.recursive_refs),m.walk(new TreeWalker((function(e){if(e instanceof AST_SymbolDeclaration)e!==T&&((n=e.definition()).orig.push(e),n.eliminated++);else if(e instanceof AST_SymbolRef){var n;if((n=e.definition())===p)e.thedef=n=d;else{n.single_use=!1;var t=e.fixed_value();r(t)&&t.name&&t.name.definition()===n&&n.scope===t.name.scope&&f.variables.get(t.name.name)===n&&(t.name=t.name.clone(),e.thedef=n=m.variables.get(t.name.name)||m[_](t.name))}n.references.push(e)}})))}else f instanceof AST_Scope?(n.push(f),m=f.optimize(n),n.pop()):m=f.optimize(n),m=m.transform(new TreeTransformer((function(e,n){return e instanceof AST_Scope||n(e=e.clone(),this),e})));return s.replaced++,m}if(f&&!1!==(i=e.fixed||s.fixed).should_replace)if(f instanceof AST_This?is_funarg(s)||!nn(s)||function(n){var t=e.scope;for(;t!==n.scope;){if(t instanceof AST_Class)return!0;t=t.parent_scope}}(s)||(o=f):(a=f.evaluate(n,!0))!==f&&"function"!=typeof a&&(null===a||"object"!=typeof a||n.option("unsafe_regexp")&&a instanceof RegExp&&!s.cross_loop&&nn(s))&&(o=D(a,f)),o){if(void 0===i.should_replace){var A=o.optimize(n).print_to_string().length;y(f)||(A=Math.min(A,f.print_to_string().length));var h=s.name.length;if(n.option("unused")&&!n.exposed(s)){var v=s.references.length-s.replaced-s.assignments;v=Math.min(v,s.references.filter((function(e){return e.fixed===i})).length),h+=(h+2+A)/Math.max(1,v)}i.should_replace=A-Math.floor(h)<n.eval_threshold}var m;if(i.should_replace)return y(f)?(m=o.optimize(n))===o&&(m=m.clone(!0)):(m=Q(o.optimize(n),f))!==o&&m!==f||(m=m.clone(!0)),s.replaced++,m}}return e;function y(e){var n;return e.walk(new TreeWalker((function(e){if(e instanceof AST_SymbolRef&&(n=!0),n)return!0}))),n}})),e(AST_Template,(function(e,n){if(!n.option("templates"))return e;var t=e.tag;if(!t||tn(n,t)){for(var i,r=[],a=[],o=0;o<e.strings.length;o++){var s=e.strings[o];if(!t){var f=rn(s);f&&(s=p(f))}if(o>0){var c=e.expressions[o-1],u=d(c);if(u){var l,_=a[a.length-1]+u+s;if(t||typeof(l=rn(_))==i){a[a.length-1]=l?p(l):_;continue}}r.push(c)}a.push(s),t||(i=typeof f)}if(!t&&a.length>1){if(""==a[a.length-1])return k(AST_Binary,e,{operator:"+",left:k(AST_Template,e,{expressions:r.slice(0,-1),strings:a.slice(0,-1)}).transform(n),right:r[r.length-1]}).optimize(n);if(""==a[0]){var S=k(AST_Binary,e,{operator:"+",left:k(AST_String,e,{value:""}),right:r[0]});for(o=1;""==a[o]&&o<r.length;o++)S=k(AST_Binary,e,{operator:"+",left:S,right:r[o]});return ee(n,e,k(AST_Binary,e,{operator:"+",left:S.transform(n),right:k(AST_Template,e,{expressions:r.slice(o),strings:a.slice(o)}).transform(n)}).optimize(n))}}e.expressions=r,e.strings=a}return re(n,e);function p(e){return e.replace(/\r|\\|`|\${/g,(function(e){return"\\"+("\r"==e?"r":e)}))}function d(e){var i=e.evaluate(n);if(i!==e&&(!t||!/\r|\\|`/.test(i))&&!((i=p(""+i)).length>e.print_to_string().length+"${}".length))return i}})),e(AST_Undefined,(function(e,n){if(n.option("unsafe_undefined")){var t=y(n).find_variable("undefined");if(t){var i=k(AST_SymbolRef,e,{name:"undefined",scope:t.scope,thedef:t});return i.is_undefined=!0,i}}var r=is_lhs(n.self(),n.parent());return r&&an(r,e)?e:k(AST_UnaryPrefix,e,{operator:"void",expression:k(AST_Number,e,{value:0})})})),e(AST_Infinity,(function(e,n){var t=is_lhs(n.self(),n.parent());return t&&an(t,e)?e:!n.option("keep_infinity")||t||y(n).find_variable("Infinity")?k(AST_Binary,e,{operator:"/",left:k(AST_Number,e,{value:1}),right:k(AST_Number,e,{value:0})}):e})),e(AST_NaN,(function(e,n){var t=is_lhs(n.self(),n.parent());return t&&an(t,e)?e:t||y(n).find_variable("NaN")?k(AST_Binary,e,{operator:"/",left:k(AST_Number,e,{value:0}),right:k(AST_Number,e,{value:0})}):e}));var sn=makePredicate("+ - * / % >> << >>> | ^ &"),fn=makePredicate("* | ^ &");function cn(e,n){if(!e)return!1;var t=n.parent();return"Call"!=t.TYPE||(t.expression!==n.self()||!(e instanceof AST_SymbolRef&&!(e=e.fixed_value()))&&(e instanceof AST_Lambda&&!e.contains_this()))}function un(e){return e instanceof AST_ObjectKeyVal&&"string"==typeof e.key&&!(e instanceof AST_ObjectMethod&&e.value.contains_super())}function ln(e){var n=e.definition().redefined();return n&&((e=e.clone()).thedef=n),e}function _n(e,n){var t=!1;return n.walk(new TreeWalker((function(n){return!!t||(n instanceof AST_SymbolRef&&e.variables.get(n.name)===n.definition()?t=!0:void 0)}))),t}function Sn(e,n){var t=[];e.references.forEach((function(e){var i=e.fixed;i&&push_uniq(t,i)&&(i.assigns?i.assigns.unshift(n):i.assigns=[n])}))}function pn(e,n){var t=k(AST_SymbolRef,n),i=k(AST_Assign,n,{operator:"=",left:t,right:k(AST_Undefined,n).transform(e)}),r=n.definition();return r.fixed&&(t.fixed=function(){return i.right},t.fixed.assigns=[i],Sn(r,i)),r.assignments++,r.references.push(t),i}e(AST_Assign,(function(e,n){if(n.option("dead_code"))if(e.left instanceof AST_PropAccess){if("="==e.operator){if(e.redundant){var t=[e.left.expression];return e.left instanceof AST_Sub&&t.push(e.left.property),t.push(e.right),w(e,t).optimize(n)}if(e.left.equals(e.right)&&!e.left.has_side_effects(n))return e.right;var i=e.left.expression;if(i instanceof AST_Lambda||!n.has_directive("use strict")&&i instanceof AST_Constant&&!i.may_throw_on_access(n))return e.left instanceof AST_Dot?e.right:w(e,[e.left.property,e.right]).optimize(n)}}else if(e.left instanceof AST_SymbolRef&&f(e.left,n)){var r;if("="==e.operator&&e.left.equals(e.right)&&!((r=n.parent())instanceof AST_UnaryPrefix&&"delete"==r.operator))return e.right;if(e.left.is_immutable())return v();var a,o=e.left.definition(),s=o.scope.resolve(),c=s===n.find_parent(AST_Lambda),u=0;if(r=n.self(),!s.uses_arguments||!is_funarg(o)||n.has_directive("use strict"))do{if(a=r,(r=n.parent(u++))instanceof AST_Assign){if(r.left instanceof AST_SymbolRef&&r.left.definition()===o){if(A(u,r,!c))break;return v(o)}if(r.left.match_symbol((function(e){if(e instanceof AST_PropAccess)return!0})))break}else{if(r instanceof AST_Exit){if(!c)break;if(A(u,r))break;if(on(s,[o]))break;return v(o)}if(r instanceof AST_SimpleStatement){if(!c)break;if(on(s,[o]))break;var _;do{if(_=r,(r=n.parent(u++))===s&&Y(r.body,_))return v(o)}while(T(_,r));break}if(r instanceof AST_VarDef){if(!(r.name instanceof AST_SymbolDeclaration))continue;if(r.name.definition()!==o)continue;if(A(u,r))break;return v(o)}}}while(d(a,r))}if(n.option("sequences")){var S=e.lift_sequences(n);if(S!==e)return S.optimize(n)}if(n.option("assignments")){if("="==e.operator&&e.left instanceof AST_SymbolRef&&e.right instanceof AST_Binary){if(e.right.left instanceof AST_SymbolRef&&e.right.left.name==e.left.name&&sn[e.right.operator])return h(e.right.right);if(e.right.right instanceof AST_SymbolRef&&e.right.right.name==e.left.name&&fn[e.right.operator]&&!e.right.left.has_side_effects(n))return h(e.right.left)}if(("-="==e.operator||"+="==e.operator&&(e.left.is_boolean(n)||e.left.is_number(n)))&&e.right instanceof AST_Number&&1==e.right.value){var p=e.operator.slice(0,-1);return k(AST_UnaryPrefix,e,{operator:p+p,expression:e.left})}}return re(n,e);function d(e,n){if(n instanceof AST_Binary)switch(e){case n.left:return n.right.is_constant_expression(s);case n.right:return!0;default:return!1}if(n instanceof AST_Conditional)switch(e){case n.condition:return n.consequent.is_constant_expression(s)&&n.alternative.is_constant_expression(s);case n.consequent:case n.alternative:return!0;default:return!1}if(n instanceof AST_Sequence){var t=n.expressions,i=t.indexOf(e);if(i<0)return!1;for(var r=t.length;--r>i;)if(!t[r].is_constant_expression(s))return!1;return!0}return n instanceof AST_UnaryPrefix}function T(e,n){return n instanceof AST_BlockStatement||n instanceof AST_Catch||n instanceof AST_Finally?Y(n.body,e):n instanceof AST_If?n.body===e||n.alternative===e:n instanceof AST_Try?n.bfinally?n.bfinally===e:n.bcatch===e:void 0}function A(t,i,r){var a=e.right;e.right=k(AST_Null,a);var o=i.may_throw(n);return e.right=a,g(n,t,i,s,o,r)}function h(n){var t=e.left.fixed;return t&&(t.to_binary=l((function(e){return e.left}),t)),k(AST_Assign,e,{operator:e.right.operator+"=",left:e.left,right:n})}function v(t){return t&&(t.fixed=!1),("="!=e.operator?k(AST_Binary,e,{operator:e.operator.slice(0,-1),left:e.left,right:e.right}):C(n.parent(),e,e.right)).optimize(n)}})),e(AST_Conditional,(function(e,n){if(n.option("sequences")&&e.condition instanceof AST_Sequence){var t=e.condition.expressions.slice();return(p=e.clone()).condition=t.pop(),t.push(p),w(e,t).optimize(n)}if(!n.option("conditionals"))return e;var i=e.condition;if(n.option("booleans")&&!i.has_side_effects(n)&&Ne(n,i),!(i=Ce(n,i)))return AST_Node.warn("Condition always false [{start}]",e),w(e,[e.condition,e.alternative]).optimize(n);if(!(i instanceof AST_Node))return AST_Node.warn("Condition always true [{start}]",e),w(e,[e.condition,e.consequent]).optimize(n);var r=first_in_statement(n),a=i.negate(n,r);(r?Z:Q)(i,a)===a&&(e=k(AST_Conditional,e,{condition:a,consequent:e.alternative,alternative:e.consequent}),a=i,i=e.condition);var o=e.consequent,s=e.alternative,f=Xe(i,n);if(Qe(n,f)){if(f.equals(o))return k(AST_Binary,e,{operator:"||",left:i,right:s}).optimize(n);if(f.equals(s))return k(AST_Binary,e,{operator:"&&",left:i,right:o}).optimize(n)}var c=o.tail_node();if(c instanceof AST_Assign){var u="="==c.operator,l=u?s.tail_node():s;if((u||o===c)&&l instanceof AST_Assign&&c.operator==l.operator&&c.left.equals(l.left)&&(u&&c.left instanceof AST_SymbolRef||!i.has_side_effects(n)&&b(o)&&b(s)))return k(AST_Assign,e,{operator:c.operator,left:c.left,right:k(AST_Conditional,e,{condition:i,consequent:x(o),alternative:x(s)})})}l=s.tail_node();if(c.equals(l))return w(e,o.equals(s)?[i,o]:[k(AST_Conditional,e,{condition:i,consequent:D(o),alternative:D(s)}),l]).optimize(n);var _,S=function n(t,r,a){var o=t.tail_node(),s=r.tail_node();if(!g(o,s))return!a&&k(AST_Conditional,e,{condition:i,consequent:t,alternative:r});var f=o.clone(),c=y(t,o,"expression"),u=y(r,s,"expression"),l=n(c,u);o.expression instanceof AST_Sequence&&(l=C(o,o.expression,l));return f.expression=l,f}(o,s,!0);if(S)return S;if(o instanceof AST_Call&&s.TYPE==o.TYPE&&(_=m(o,s))>=0&&o.expression.equals(s.expression)&&!i.has_side_effects(n)&&!o.expression.has_side_effects(n)){var p=o.clone(),d=o.args[_];return p.args[_]=d instanceof AST_Spread?k(AST_Spread,e,{expression:k(AST_Conditional,e,{condition:i,consequent:d.expression,alternative:s.args[_].expression})}):k(AST_Conditional,e,{condition:i,consequent:d,alternative:s.args[_]}),p}if(c instanceof AST_Conditional&&c.alternative.equals(s))return k(AST_Conditional,e,{condition:k(AST_Binary,e,{left:i,operator:"&&",right:y(o,c,"condition")}),consequent:c.consequent,alternative:N(c.alternative,s)});if(c instanceof AST_Conditional&&c.consequent.equals(s))return k(AST_Conditional,e,{condition:k(AST_Binary,e,{left:a,operator:"||",right:y(o,c,"condition")}),consequent:N(c.consequent,s),alternative:c.alternative});if(l instanceof AST_Conditional&&o.equals(l.consequent))return k(AST_Conditional,e,{condition:k(AST_Binary,e,{left:i,operator:"||",right:y(s,l,"condition")}),consequent:N(o,l.consequent),alternative:l.alternative});if(l instanceof AST_Conditional&&o.equals(l.alternative))return k(AST_Conditional,e,{condition:k(AST_Binary,e,{left:a,operator:"&&",right:y(s,l,"condition")}),consequent:l.consequent,alternative:N(o,l.alternative)});if(c instanceof AST_Binary&&"&&"==c.operator&&c.right.equals(s))return k(AST_Binary,e,{operator:"&&",left:k(AST_Binary,e,{operator:"||",left:a,right:y(o,c,"left")}),right:N(c.right,s)}).optimize(n);if(c instanceof AST_Binary&&"||"==c.operator&&c.right.equals(s))return k(AST_Binary,e,{operator:"||",left:k(AST_Binary,e,{operator:"&&",left:i,right:y(o,c,"left")}),right:N(c.right,s)}).optimize(n);if(l instanceof AST_Binary&&"&&"==l.operator&&l.right.equals(o))return k(AST_Binary,e,{operator:"&&",left:k(AST_Binary,e,{operator:"||",left:i,right:y(s,l,"left")}),right:N(o,l.right)}).optimize(n);if(l instanceof AST_Binary&&"||"==l.operator&&l.right.equals(o))return k(AST_Binary,e,{operator:"||",left:k(AST_Binary,e,{operator:"&&",left:a,right:y(s,l,"left")}),right:N(o,l.right)}).optimize(n);var T=n.option("booleans")&&n.in_boolean_context();return h(o)?v(s)?A(i):k(AST_Binary,e,{operator:"||",left:A(i),right:s}).optimize(n):v(o)?h(s)?A(i.negate(n)):k(AST_Binary,e,{operator:"&&",left:A(i.negate(n)),right:s}).optimize(n):h(s)?k(AST_Binary,e,{operator:"||",left:A(i.negate(n)),right:o}).optimize(n):v(s)?k(AST_Binary,e,{operator:"&&",left:A(i),right:o}).optimize(n):(n.option("typeofs")&&Ee(i,o,s),e);function A(e){return e.is_boolean(n)?e:k(AST_UnaryPrefix,e,{operator:"!",expression:e.negate(n)})}function h(e){return e instanceof AST_True||T&&e instanceof AST_Constant&&e.value||e instanceof AST_UnaryPrefix&&"!"==e.operator&&e.expression instanceof AST_Constant&&!e.expression.value}function v(e){return e instanceof AST_False||T&&(e instanceof AST_Constant&&!e.value||e instanceof AST_UnaryPrefix&&"void"==e.operator&&!e.expression.has_side_effects(n))||e instanceof AST_UnaryPrefix&&"!"==e.operator&&e.expression instanceof AST_Constant&&e.expression.value}function m(e,n){var t=e.args,i=n.args,r=t.length;if(r!=i.length)return-2;for(var a=0;a<r;a++)if(!t[a].equals(i[a])){if(t[a]instanceof AST_Spread!==i[a]instanceof AST_Spread)return-3;for(var o=a+1;o<r;o++)if(!t[o].equals(i[o]))return-2;return a}return-1}function y(e,n,t){if(e===n)return n[t];var i=e.expressions.slice(0,-1);return i.push(n[t]),w(e,i)}function g(e,n){if(e.TYPE==n.TYPE&&e.optional==n.optional){if(e instanceof AST_Call){if(-1!=m(e,n))return;return"Call"!=e.TYPE||!(e.expression instanceof AST_PropAccess||n.expression instanceof AST_PropAccess)||g(e.expression,n.expression)}if(e instanceof AST_PropAccess){var t=e.property,i=n.property;return(t instanceof AST_Node?t.equals(i):t==i)&&!(e.expression instanceof AST_Super||n.expression instanceof AST_Super)}}}function b(e){return e===e.tail_node()||all(e.expressions.slice(0,-1),(function(e){return!e.has_side_effects(n)}))}function x(e){if(!(e instanceof AST_Sequence))return e.right;var n=e.expressions.slice();return n.push(n.pop().right),w(e,n)}function D(e){return e instanceof AST_Sequence?w(e,e.expressions.slice(0,-1)):k(AST_Number,e,{value:0})}})),e(AST_Boolean,(function(e,n){if(!n.option("booleans"))return e;if(n.in_boolean_context())return k(AST_Number,e,{value:+e.value});var t=n.parent();return t instanceof AST_Binary&&("=="==t.operator||"!="==t.operator)?(AST_Node.warn("Non-strict equality against boolean: {operator} {value} [{start}]",{operator:t.operator,value:e.value,start:t.start}),k(AST_Number,e,{value:+e.value})):k(AST_UnaryPrefix,e,{operator:"!",expression:k(AST_Number,e,{value:1-e.value})})})),e(AST_Spread,(function(e,n){var t=e.expression;return n.option("spreads")&&t instanceof AST_Array&&!(n.parent()instanceof AST_Object)?List.splice(t.elements.map((function(e){return e instanceof AST_Hole?k(AST_Undefined,e).optimize(n):e}))):e})),e(AST_Sub,(function(e,n){var t=e.expression,i=e.property,r=Ue(e,n);if(r)return r;if(n.option("properties")){var a=i.evaluate(n);if(a!==i){if("string"==typeof a)if("undefined"==a)a=void 0;else(E=parseFloat(a)).toString()==a&&(a=E);i=e.property=Q(i,D(a,i).transform(n));var s=""+a;if(is_identifier_string(s)&&s.length<=i.print_to_string().length+1)return k(AST_Dot,e,{optional:e.optional,expression:t,property:s,quoted:!0}).optimize(n)}}var f,c,u,l,_=n.parent(),S=is_lhs(n.self(),_);if(n.option("arguments")&&t instanceof AST_SymbolRef&&o(f=t.definition())&&!t.in_arg&&i instanceof AST_Number&&Math.floor(v=i.value)==v&&(c=f.scope)===function(){var e,t=0;for(;e=n.parent(t++);)if(e instanceof AST_Lambda){if(e instanceof AST_Accessor)return;if(is_arrow(e))continue;return u=n.parent(t),e}}()&&c.uses_arguments<(S?2:3)){_ instanceof AST_UnaryPrefix&&"delete"==_.operator&&(f.deleted||(f.deleted=[]),f.deleted[v]=!0);var p=c.argnames[v];if(f.deleted&&f.deleted[v])p=null;else if(p){var d;p instanceof AST_SymbolFunarg&&"await"!=p.name&&t.scope.find_variable(p.name)===(d=p.definition())?(n.has_directive("use strict")||c.name||c.rest||!(u instanceof AST_Call&&v<u.args.length&&all(u.args.slice(0,v+1),(function(e){return!(e instanceof AST_Spread)})))||!all(c.argnames,(function(e){return e instanceof AST_SymbolFunarg})))&&(C()||d.assignments||d.orig.length>1)&&(p=null):p=null}else if((S||!C())&&v<c.argnames.length+5&&n.drop_fargs(c,u)&&!c.rest)for(;v>=c.argnames.length;)p=c.make_var(AST_SymbolFunarg,c,"argument_"+c.argnames.length),c.argnames.push(p);if(p&&find_if((function(e){return e.name===p.name}),c.argnames)===p){S&&f.reassigned--;var T=k(AST_SymbolRef,p);return T.reference(),p.unused=void 0,T}}if(S)return e;if(n.option("sequences")&&"Call"!=_.TYPE&&!(_ instanceof AST_ForEnumeration&&_.init===e)){var A=ze(e);if(A!==e)return A.optimize(n)}if(a!==i){var h=e.flatten_object(s,n);h&&(t=e.expression=h.expression,i=e.property=h.property)}if(n.option("properties")&&n.option("side_effects")&&i instanceof AST_Number&&t instanceof AST_Array&&all(l=t.elements,(function(e){return!(e instanceof AST_Spread)}))){var v,m=l[v=i.value];if(cn(m,n)){for(var y=m instanceof AST_Hole,g=!y,b=[],x=l.length;--x>v;){(E=l[x].drop_side_effect_free(n))&&(b.unshift(E),g&&E.has_side_effects(n)&&(g=!1))}for(g||b.unshift(m);--x>=0;){var E;(E=l[x].drop_side_effect_free(n))?b.unshift(E):y?b.unshift(k(AST_Hole,l[x])):v--}return g?(b.push(m),w(e,b).optimize(n)):k(AST_Sub,e,{expression:k(AST_Array,t,{elements:b}),property:k(AST_Number,i,{value:v})})}}return re(n,e);function C(){return!n.option("reduce_vars")||f.reassigned}})),AST_LambdaExpression.DEFMETHOD("contains_super",(function(){var e=!1,n=this;return n.walk(new TreeWalker((function(t){return!!e||(t instanceof AST_Super?e=!0:t!==n&&t instanceof AST_Scope&&!is_arrow(t)||void 0)}))),e})),function(e){e(AST_Arrow,return_false),e(AST_AsyncArrow,return_false),e(AST_Node,(function(){var e=!1,n=this;return n.walk(new TreeWalker((function(t){return!!e||(t instanceof AST_This?e=!0:t!==n&&t instanceof AST_Scope&&!is_arrow(t)||void 0)}))),e}))}((function(e,n){e.DEFMETHOD("contains_this",n)})),AST_PropAccess.DEFMETHOD("flatten_object",(function(e,n){if(n.option("properties")&&"__proto__"!==e){var t=this,i=t.expression;if(i instanceof AST_Object)for(var r=i.properties,a=r.length;--a>=0;){var o=r[a];if(o.key===e){if(!all(r,un))return;if(!cn(o.value,n))return;for(var s,f,c=[],u=0;u<r.length;u++){var l=r[u].value;if(r[u]instanceof AST_ObjectMethod){var _,S=!(l.uses_arguments||is_generator(l)||l.contains_this());if(S){f||(f=n.find_parent(AST_Scope));var p=Le(n,f);l.each_argname((function(e){p[e.name]&&(S=!1)}))}if(S)_=is_async(l)?AST_AsyncArrow:AST_Arrow;else{if(!(a!=u||(s=n.parent())instanceof AST_Call&&s.expression===t))return;_=l.CTOR}l=k(_,l)}c.push(l)}return k(AST_Sub,t,{expression:k(AST_Array,i,{elements:c}),property:k(AST_Number,t,{value:a})})}}}})),e(AST_Dot,(function(e,n){"arguments"!=e.property&&"caller"!=e.property||AST_Node.warn("Function.prototype.{property} not supported [{start}]",e);var t=n.parent();if(is_lhs(n.self(),t))return e;var i=Ue(e,n);if(i)return i;if(n.option("sequences")&&"Call"!=t.TYPE&&!(t instanceof AST_ForEnumeration&&t.init===e)){var r=ze(e);if(r!==e)return r.optimize(n)}if(n.option("unsafe_proto")&&e.expression instanceof AST_Dot&&"prototype"==e.expression.property){var a=e.expression.expression;if(L(a))switch(a.name){case"Array":e.expression=k(AST_Array,e.expression,{elements:[]});break;case"Function":e.expression=k(AST_Function,e.expression,{argnames:[],body:[]}).init_vars(a.scope);break;case"Number":e.expression=k(AST_Number,e.expression,{value:0});break;case"Object":e.expression=k(AST_Object,e.expression,{properties:[]});break;case"RegExp":e.expression=k(AST_RegExp,e.expression,{value:/t/});break;case"String":e.expression=k(AST_String,e.expression,{value:""})}}var o=e.flatten_object(e.property,n);return o?o.optimize(n):re(n,e)})),e(AST_DestructuredArray,(function(e,n){return n.option("rests")&&e.rest instanceof AST_DestructuredArray?k(AST_DestructuredArray,e,{elements:e.elements.concat(e.rest.elements),rest:e.rest.rest}):e})),e(AST_DestructuredKeyVal,(function(e,n){if(n.option("objects")){var t=e.key;t instanceof AST_Node&&(t=t.evaluate(n))!==e.key&&(e.key=""+t)}return e})),e(AST_Object,(function(e,n){if(!n.option("objects"))return e;var t=!1,i=!1,r=!1,a=n.has_directive("use strict"),o=[],s=new Dictionary,f=[];if(e.properties.forEach((function(e){if(!(e instanceof AST_Spread))return l(e);i=!0;var a=e.expression;n.option("spreads")&&a instanceof AST_Object&&all(a.properties,(function(e){return!(e instanceof AST_ObjectGetter)&&(!(e instanceof AST_Spread)&&("__proto__"!==e.key||(e instanceof AST_ObjectSetter||!e.value.has_side_effects(n))))}))?(t=!0,a.properties.forEach((function(e){var t=e.key,i=e instanceof AST_ObjectSetter;if("__proto__"===t){if(!i)return;t=D(t,e)}l(i?k(AST_ObjectKeyVal,e,{key:t,value:k(AST_Undefined,e).optimize(n)}):e)}))):(r=!0,u(),f.push(e))})),u(),!t)return e;if(i&&r&&1==f.length){var c=f[0];c instanceof AST_ObjectProperty&&c.key instanceof AST_Number&&(c.key=""+c.key.value)}return k(AST_Object,e,{properties:f});function u(){o.forEach((function(n){var i=s.get(n);switch(i.length){case 0:return;case 1:return f.push(i[0])}t=!0;var o=a&&!r&&i.pop();f.push(1==i.length?i[0]:k(AST_ObjectKeyVal,e,{key:i[0].key,value:w(e,i.map((function(e){return e.value})))})),o&&f.push(o),i.length=0})),o=[],s=new Dictionary}function l(e){var t=e.key;t instanceof AST_Node&&(i=!0,(t=t.evaluate(n))===e.key||"__proto__"===t?r=!0:t=e.key=""+t),un(e)?(e.value.has_side_effects(n)&&u(),o.push(t),s.add(t,e)):(u(),f.push(e)),i&&!r&&"string"==typeof t&&_.test(t)&&(r=!0,s.has(t)&&(e=s.get(t)[0]),e.key=k(AST_Number,e,{value:+t}))}})),function(e){function n(e,n,t,i,r,a,o){for(var s=[],f=a.expressions,c=t,u=f.length-(o||0),l=u;--u>=0;c=!0,r=!1){var _=f[u].try_inline(e,n,c,i,r);_&&(S(),s.push(_))}if(0!=s.length)return S(),!t&&s[0]instanceof AST_SimpleStatement&&(s[0]=k(AST_Return,a,{value:s[0].body})),k(AST_BlockStatement,a,{body:s.reverse()});function S(){l>u+1&&s.push(k(AST_SimpleStatement,a,{body:w(a,f.slice(u+1,l))})),l=u}}e(AST_Node,noop),e(AST_Assign,noop),e(AST_Await,(function(e,n,t,i){if(e.option("awaits")){var r=this,a=r.expression.try_inline(e,n,t,i,!0);if(a)return t||me(a,(function(n){n.in_bool=!1;var t=n.value;t instanceof AST_Await||(n.value=k(AST_Await,r,{expression:t||k(AST_Undefined,n).transform(e)}))})),le(a)?a:k(AST_BlockStatement,r,{body:[a,k(AST_SimpleStatement,r,{body:k(AST_Await,r,{expression:k(AST_Number,r,{value:0})})})]})}})),e(AST_Binary,(function(e,n,t,i,r){if(void 0!==t){var a=this,o=a.operator;if(X[o]){var s=a.right.try_inline(e,n,t,i,r);if(s)return k(AST_If,a,{condition:function(n){switch(o){case"&&":return n;case"||":return n.negate(e);case"??":return k(AST_Binary,a,{operator:"==",left:k(AST_Null,a),right:n})}}(a.left),body:s,alternative:t?null:k(AST_Return,a,{value:k(AST_Undefined,a).transform(e)})})}}})),e(AST_BlockStatement,(function(e,n,t,i){if(!t&&this.variables){var r=this.body,a=r.length-1;if(!(a<0)){var o=r[a].try_inline(e,this,t,i);if(o)return r[a]=o,this}}})),e(AST_Call,(function(e,n,t,i,r){if(!(e.option("inline")<4)){var a=this;if(!a.is_expr_pure(e)){var o=a.expression;if(o instanceof AST_LambdaExpression&&!o.name&&!o.uses_arguments&&!o.pinned()&&!is_generator(o)){var s=is_arrow(o);if((!s||!o.value)&&!(o.body[0]instanceof AST_Directive)&&!o.contains_this()){n||(n=y(e));var f=new Dictionary;for(f.set("NaN",!0);!(n instanceof AST_Scope);)n.variables.each((function(e){f.set(e.name,!0)})),n=n.parent_scope;if(member(n,e.stack)&&!(n.pinned()&&o.variables.size()>(s?0:1))){if(n instanceof AST_Toplevel){if(o.variables.size()>(s?0:1)){if(!e.toplevel.vars)return;if(o.functions.size()>0&&!e.toplevel.funcs)return}f.set("arguments",!0)}var c=!r&&is_async(o);if(c){if(!e.option("awaits"))return;if(!is_async(n))return;if(a.may_throw(e))return}var u=n.var_names();if(i&&(i=[]),o.variables.all((function(e,n){return i&&i.push(e),!f.has(n)&&!u.has(n)||!s&&"arguments"==n&&1==e.orig.length}))&&!(i&&i.length>0&&on(o,i))){var l=!0;if(all(o.argnames,(function(e){var n=!1,t=new TreeWalker((function(e){return!!n||(e instanceof AST_DefaultValue?_n(o,e.value)?n=!0:(e.name.walk(t),!0):e instanceof AST_DestructuredKeyVal?e.key instanceof AST_Node&&_n(o,e.key)?n=!0:(e.value.walk(t),!0):e instanceof AST_SymbolFunarg&&!all(e.definition().orig,(function(e){return!(e instanceof AST_SymbolDefun)}))?n=!0:void 0)}));return e.walk(t),!n&&(e instanceof AST_SymbolFunarg||(l=!1),!0)}))){if(o.rest){if(_n(o,o.rest))return;l=!1}var _;if(t?_=function(e){var n=!1;return e.walk(new TreeWalker((function(e){return!!n||(c&&(e instanceof AST_Await||e instanceof AST_ForAwaitOf)||e instanceof AST_Return?n=!0:e instanceof AST_Scope||void 0)}))),!n}:(r||is_async(o)||m(n))&&(_=function(e){var n=!1,t=new TreeWalker((function(e){return!!n||(e instanceof AST_Return?n=!0:e instanceof AST_Scope||void 0)}));return e.walk(new TreeWalker((function(e){return!!n||(e instanceof AST_Try?(e.bfinally&&all(e.body,(function(e){return e.walk(t),!n}))&&e.bcatch&&e.bcatch.walk(t),!0):e instanceof AST_Scope||void 0)}))),!n}),(!_||all(o.body,_))&&Ve(o,Le(e,n))){o.functions.each((function(e,t){n.functions.set(t,e)}));var S=[];o.variables.each((function(t,r){if((s||"arguments"!=r||1!=t.orig.length)&&(u.set(r,!0),n.enclosed.push(t),n.variables.set(r,t),t.single_use=!1,i&&t.references.length!=t.replaced&&t.orig.length!=t.eliminated&&(1!=t.orig.length||!o.functions.has(r))&&all(t.orig,(function(e){return!(e instanceof AST_SymbolConst)&&(e instanceof AST_SymbolFunarg?!e.unused&&t.scope.resolve()!==o:!(e instanceof AST_SymbolLet))})))){var a=t.orig[0];a instanceof AST_SymbolCatch||S.push(k(AST_SimpleStatement,a,{body:pn(e,ln(a))}))}}));var p=Object.create(null),d=new Dictionary;if(l&&all(a.args,(function(e){return!(e instanceof AST_Spread)}))){var T=a.args.slice();o.argnames.forEach((function(n){var t=T.shift();if(n.unused)t&&S.push(k(AST_SimpleStatement,a,{body:t}));else{var i=k(AST_VarDef,a,{name:n.convert_symbol(AST_SymbolVar,h),value:t||k(AST_Undefined,a).transform(e)});n instanceof AST_SymbolFunarg&&Sn(n.definition(),i),S.push(k(AST_Var,a,{definitions:[i]}))}})),T.length&&S.push(k(AST_SimpleStatement,a,{body:w(a,T)}))}else S.push(k(AST_Var,a,{definitions:[k(AST_VarDef,a,{name:k(AST_DestructuredArray,a,{elements:o.argnames.map((function(e){return e.unused?k(AST_Hole,e):e.convert_symbol(AST_SymbolVar,h)})),rest:o.rest&&o.rest.convert_symbol(AST_SymbolVar,h)}),value:k(AST_Array,a,{elements:a.args.slice()})})]}));d.each((function(e,n){var t=p[n];[].unshift.apply(t.orig,e),t.eliminated+=e.length})),[].push.apply(S,i?o.body.filter((function(e){if(!(e instanceof AST_LambdaDefinition))return!0;var n=k(AST_SymbolVar,ln(e.name)),t=n.definition();return t.fixed=!1,t.orig.push(n),t.eliminated++,S.push(k(AST_Var,e,{definitions:[k(AST_VarDef,e,{name:n,value:ve(e,!0)})]})),!1})):o.body);var A=k(AST_BlockStatement,a,{body:S});return t||(c&&me(A,(function(e){var n=e.value;J(n)||(e.value=k(AST_Await,a,{expression:n}))})),S.push(k(AST_Return,a,{value:m(n)?k(AST_Undefined,a).transform(e):null}))),A}}}}}}}}function h(e,n){var t=n.definition();p[t.id]=t,d.add(t.id,e)}})),e(AST_Conditional,(function(e,n,t,i,r){var a=this,o=a.consequent.try_inline(e,n,t,i,r),s=a.alternative.try_inline(e,n,t,i,r);if(o||s)return k(AST_If,a,{condition:a.condition,body:o||f(a.consequent),alternative:s||f(a.alternative)});function f(e){return t?k(AST_SimpleStatement,e,{body:e}):k(AST_Return,e,{value:e})}})),e(AST_For,(function(e,n,t,i){var r=this.body.try_inline(e,n,!0,!0);r&&(this.body=r);var a=this.init;return a&&(a=a.try_inline(e,n,!0,i))?(this.init=null,a instanceof AST_BlockStatement?(a.body.push(this),a):k(AST_BlockStatement,a,{body:[a,this]})):r&&this})),e(AST_ForEnumeration,(function(e,t,i,r){var a=this.body.try_inline(e,t,!0,!0);a&&(this.body=a);var o=this.object;if(o instanceof AST_Sequence){var s=n(e,t,!0,r,!1,o,1);if(s)return this.object=o.tail_node(),s.body.push(this),s}return a&&this})),e(AST_If,(function(e,t,i,r){var a=this.body.try_inline(e,t,i,r);a&&(this.body=a);var o=this.alternative;o&&(o=o.try_inline(e,t,i,r))&&(this.alternative=o);var s=this.condition;if(s instanceof AST_Sequence){var f=n(e,t,!0,r,!1,s,1);if(f)return this.condition=s.tail_node(),f.body.push(this),f}return(a||o)&&this})),e(AST_IterationStatement,(function(e,n,t,i){var r=this.body.try_inline(e,n,!0,!0);if(r)return this.body=r,this})),e(AST_LabeledStatement,(function(e,n,t,i){var r=this.body.try_inline(e,n,t,i);if(r){if(this.body instanceof AST_IterationStatement&&r instanceof AST_BlockStatement){var a=r.body.pop();return this.body=a,r.body.push(this),r}return this.body=r,this}})),e(AST_New,noop),e(AST_Return,(function(e,n,t,i){var r=this.value;return r&&r.try_inline(e,n,void 0,"try"===i)})),e(AST_Sequence,(function(e,t,i,r,a){return n(e,t,i,r,a,this)})),e(AST_SimpleStatement,(function(e,n,t,i){for(var r=this.body;r instanceof AST_UnaryPrefix;){var a=r.operator;if(unary_side_effects[a])break;if("void"==a)break;r=r.expression}return t||J(r)||(r=k(AST_UnaryPrefix,this,{operator:"void",expression:r})),r.try_inline(e,n,t||!1,i)})),e(AST_UnaryPrefix,(function(e,n,t,i,r){var a=this,o=a.operator;if(!unary_side_effects[o]){t||"void"!=o||(t=!1);var s=a.expression.try_inline(e,n,t,i,r);if(s)return t||me(s,(function(n){n.in_bool=!1;var t=n.value;"void"==o&&J(t)||(n.value=k(AST_UnaryPrefix,a,{operator:o,expression:t||k(AST_Undefined,n).transform(e)}))})),s}})),e(AST_With,(function(e,t,i,r){var a=this.body.try_inline(e,t,i,r);a&&(this.body=a);var o=this.expression;if(o instanceof AST_Sequence){var s=n(e,t,!0,r,!1,o,1);if(s)return this.expression=o.tail_node(),s.body.push(this),s}return a&&this})),e(AST_Yield,(function(e,n,t,i){if(e.option("yields")&&this.nested){var r=this.expression;if("Call"==r.TYPE){var a=r.expression;switch(a.CTOR){case AST_AsyncGeneratorFunction:a=k(AST_AsyncFunction,a);break;case AST_GeneratorFunction:a=k(AST_Function,a);break;default:return}return(r=r.clone()).expression=a,r.try_inline(e,n,t,i)}}}))}((function(e,n){e.DEFMETHOD("try_inline",n)})),e(AST_Return,(function(e,n){var t=e.value;return t&&n.option("side_effects")&&J(t,n)&&!m(n.find_parent(AST_Scope))&&(e.value=null),e}))}((function(e,n){e.DEFMETHOD("optimize",(function(e){var t=this;if(t._optimized)return t;if(e.has_directive("use asm"))return t;var i=n(t,e);return i._optimized=!0,i}))}))}}]);