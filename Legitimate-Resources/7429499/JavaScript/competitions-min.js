(()=>{var e=new FormData,t=new Vue({el:"#competition-app",data:{settings:{default_textarea_length:300,description_length:null,lifestyle_the_object_has_been_designed_for_length:null,technical_information:null},entry:{first_name:"",last_name:"",surname:"",email:"",occupation:"",company_name:"",address:"",postcode:"",city:"",country:"",phone:"",name:"",name_of_the_city_the_design_is_for:"",description:"",technical_information:"",lifestyle_the_object_has_been_designed_for:"",explanation:"",team_members:"",dob:"",video_url:"",video_password:"",competition_id:0,mailinglist:"",newsletters:[],deletedSupportingImages:[],uploadedFiles:0,supporting_image_ids:[]}},watch:{entry:{handler:function(){var e=this.settings.default_textarea_length;this.entry.description.length&&(null!==this.settings.description_length&&(e=this.settings.description_length),this.entry.description.trim().split(/\s+/).length>e&&(this.entry.description=this.entry.description.substring(0,this.entry.description.length-1))),this.entry.lifestyle_the_object_has_been_designed_for.length&&(null!==this.settings.lifestyle_the_object_has_been_designed_for_length&&(e=this.settings.lifestyle_the_object_has_been_designed_for_length),this.entry.lifestyle_the_object_has_been_designed_for.trim().split(/\s+/).length>e&&(this.entry.lifestyle_the_object_has_been_designed_for=this.entry.lifestyle_the_object_has_been_designed_for.substring(0,this.entry.lifestyle_the_object_has_been_designed_for.length-1))),this.entry.technical_information.length&&(null!==this.settings.technical_information_length&&(e=this.settings.technical_information_length),this.entry.technical_information.trim().split(/\s+/).length>e&&(this.entry.technical_information=this.entry.technical_information.substring(0,this.entry.technical_information.length-1)))},deep:!0}},methods:{submit:function(){if(this.privacyPolicyCheck()){this.addLoadingClass(),this.hideSubmitButton(),this.fillForm(),this.addHeroImage(),this.addPlanImage(),this.addElevationImage(),this.addSectionImage(),this.addSelectedImages(),this.clearErrorMessages();var t=this;axios.post(PLATFORM_URL+"/api/competition/"+t.entry.competition_id,e).then((function(e){e.data.error?t.showErrorMessage(e.data.message):(t.showSuccessMessage(e.data.message),t.resetForm()),t.showSubmitButton(),t.removeLoadingClass()})).catch((function(e){console.log(" error connecting with "+PLATFORM_URL+"/api/competition/"+t.entry.competition_id),console.log(e),void 0!==e.response.data.message&&t.showErrorMessage(e.response.data.message),t.showSubmitButton(),t.removeLoadingClass()}))}else this.privacyPolicyErrorMessages()},addLoadingClass:function(){$("#competition-app").closest("form").addClass("loading")},removeLoadingClass:function(){$("#competition-app").closest("form").removeClass("loading")},privacyPolicyCheck:function(){return $('input[name="policies[]"]').length==$('input[name="policies[]"]:checked').length},privacyPolicyErrorMessages:function(){alert($('input[name="policies[]"]:not(:checked)').first().data("error"))},hideSubmitButton:function(){$("#competition-app form button").attr("disabled","disabled")},showSubmitButton:function(){$("#competition-app form button").attr("disabled",!1)},clearErrorMessages:function(){$(".error-message").each((function(){$(this).empty()}))},showErrorMessage:function(e){Object.entries(e).forEach((function(e){$("#"+e[0]+"-message").html('<span class="den-error">'+e[1]+"</span>")})),$(window).scrollTop($("#competition-app").offset().top-200)},showSuccessMessage:function(e){$("form").hide(),$("#competition-intro").hide(),$("#competition-app-success").show(),$(window).scrollTop(200)},uploadHeroImage:function(e){if(e.length){var t=new FileReader;t.onload=function(e){$("#hero-image-preview").css("background-image","url("+e.target.result+")"),$("#hero-image-preview").removeClass("hidden"),$("#hero-image input, #hero-image p").hide()},t.readAsDataURL(e[0])}},uploadSectionImage:function(e){if(e.length){var t=new FileReader;t.onload=function(e){$("#section-preview").css("background-image","url("+e.target.result+")"),$("#section-preview").removeClass("hidden"),$("#section input, #section p").hide()},t.readAsDataURL(e[0])}},uploadElevationImage:function(e){if(e.length){var t=new FileReader;t.onload=function(e){$("#elevation-preview").css("background-image","url("+e.target.result+")"),$("#elevation-preview").removeClass("hidden"),$("#elevation input, #elevation p").hide()},t.readAsDataURL(e[0])}},uploadPlanImage:function(e){if(e.length){var t=new FileReader;t.onload=function(e){$("#plan-preview").css("background-image","url("+e.target.result+")"),$("#plan-preview").removeClass("hidden"),$("#plan input, #plan p").hide()},t.readAsDataURL(e[0])}},uploadSupportingImages:function(e){var t=this;$("#supporting_images-message").html(""),files=e.files;var n=$("#supporting-images-preview").attr("limit");null==n&&(n=10),t.entry.uploadedFiles+files.length<=n?function(){var n=0,s=function(){var s=PLATFORM_URL+"/api/entries/upload",a=t.getImageData(files[i]),o=t.getFormData(a),r=null;axios.post(s,o,{headers:{"Content-Type":"multipart/form-data"}}).then((function(s){r=s.data.image.id,t.entry.supporting_image_ids.push(r);var a=new FileReader;a.id=$(e).data("id")+"-"+i,a.onload=function(t,i){$("#supporting-images-preview").append('<div class="supporting-image supporting-image-'+r+'" style="background-image: url('+this.result+');"><a href="#" class="delete-supporting-image" data-image-id="'+r+'"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="20" height="20" viewBox="0 0 20 20"><path d="M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"></path></svg></a></div>'),$("#supporting-images-preview").removeClass("hidden"),$(e).hide()},a.readAsDataURL(files[n]),n++,t.entry.uploadedFiles++})).catch((function(e){console.log(e)}))};for(i=0;i<files.length;i++)s()}():(e.remove(),$("#supporting_images-message").html('<span class="den-error">Please upload '+n+" files or less</span>"))},getFormData:function(e){var t=new FormData;return t.append("image_id",e.id.replace("image","")),t.append("image",e.file),t.append("file_url",e.file_url),t.append("size",e.size),t.append("points",e.points),t.append("zoom",1),t.append("orientation",e.orientation),t.append("caption",e.caption),t.append("credit",e.credit),t.append("main_image",e.main_image),t.append("type",e.type),t},getImageData:function(e){return{id:"image"+Math.random().toString(36).substr(2,9),file:e,file_url:URL.createObjectURL(e),size:e.size,main_image:0,caption:"",credit:"",exists:!1,deleted:!1,uploaded:!1,orientation:1,type:"supporting-materials",uploadId:null,temp_image_id:null}},fillForm:function(){""!=this.entry.first_name&&e.append("first_name",this.entry.first_name),""!=this.entry.last_name&&e.append("last_name",this.entry.last_name),""!=this.entry.surname&&e.append("surname",this.entry.surname),""!=this.entry.email&&e.append("email",this.entry.email),""!=this.entry.occupation&&e.append("occupation",this.entry.occupation),""!=this.entry.company_name&&e.append("company_name",this.entry.company_name),""!=this.entry.address&&e.append("address",this.entry.address),""!=this.entry.city&&e.append("city",this.entry.city),""!=this.entry.postcode&&e.append("postcode",this.entry.postcode),""!=this.entry.country&&e.append("country",this.entry.country),""!=this.entry.phone&&e.append("phone",this.entry.phone),""!=this.entry.name&&e.append("name",this.entry.name),""!=this.entry.name_of_the_city_the_design_is_for&&e.append("name_of_the_city_the_design_is_for",this.entry.name_of_the_city_the_design_is_for),""!=this.entry.description&&e.append("description",this.entry.description),""!=this.entry.lifestyle_the_object_has_been_designed_for&&e.append("lifestyle_the_object_has_been_designed_for",this.entry.lifestyle_the_object_has_been_designed_for),""!=this.entry.technical_information&&e.append("technical_information",this.entry.technical_information),""!=this.entry.lifestyle_the_object_has_been_designed_for&&e.append("lifestyle_the_object_has_been_designed_for",this.entry.lifestyle_the_object_has_been_designed_for),""!=this.entry.explanation&&e.append("explanation",this.entry.explanation),""!=this.entry.video_url&&e.append("video_url",this.entry.video_url),""!=this.entry.video_password&&e.append("video_password",this.entry.video_password),""!=this.entry.team_members&&e.append("team_members",this.entry.team_members),""!=this.entry.dob&&e.append("dob",this.entry.dob),this.entry.newsletters&&(void 0!==this.$refs&&void 0!==this.$refs.newsletters&&void 0!==this.$refs.newsletters.value?e.append("newsletters",this.$refs.newsletters.value):e.append("newsletters",this.entry.newsletters)),""!=this.entry.mailinglist&&e.append("mailinglist",this.entry.mailinglist);for(var t=[],i=0;i<this.entry.supporting_image_ids.length;i++)this.entry.deletedSupportingImages.includes(this.entry.supporting_image_ids[i])||t.push(this.entry.supporting_image_ids[i]);e.append("supporting_image_ids",t)},addHeroImage:function(){var t;null!==(t=$('input[name="hero_image"]')[0])&&void 0!==t&&t.files.length&&e.append("hero_image",$('input[name="hero_image"]')[0].files[0])},addPlanImage:function(){var t;null!==(t=$('input[name="plan"]')[0])&&void 0!==t&&t.files.length&&e.append("plan",$('input[name="plan"]')[0].files[0])},addElevationImage:function(){var t;null!==(t=$('input[name="elevation"]')[0])&&void 0!==t&&t.files.length&&e.append("elevation",$('input[name="elevation"]')[0].files[0])},addSectionImage:function(){var t;null!==(t=$('input[name="section"]')[0])&&void 0!==t&&t.files.length&&e.append("section",$('input[name="section"]')[0].files[0])},addSelectedImages:function(){var t=this;$('input[name="supporting_images[]"]').each((function(n){if(this.files.length)for(i=0;i<this.files.length;i++)currentImageId="".concat(n+1,"-").concat(i),t.entry.deletedSupportingImages.includes(currentImageId)||e.append("supporting_images[]",this.files[i])}))},resetForm:function(){this.resetFormFields(),this.resetFormImages()},resetFormFields:function(){this.entry={first_name:"",last_name:"",surname:"",email:"",occupation:"",company_name:"",address:"",city:"",postcode:"",country:"",phone:"",name:"",description:"",explanation:"",video_url:"",video_password:"",team_members:"",technical_information:"",lifestyle_the_object_has_been_designed_for:"",dob:"",mailinglist:"",newsletters:[]}},resetFormImages:function(){this.resetHeroImage(),this.resetSupportingimages()},resetHeroImage:function(){$("#hero-image-preview").css("background-image",""),$("#hero-image-preview").addClass("hidden"),$("#hero-image input, #hero-image p").show()},resetPlanImage:function(){$("#plan-preview").css("background-image",""),$("#plan-preview").addClass("hidden"),$("#plan input, #plan p").show()},resetElevationImage:function(){$("#elevation-preview").css("background-image",""),$("#elevation-preview").addClass("hidden"),$("#elevation input, #elevation p").show()},resetSectionImage:function(){$("#section-preview").css("background-image",""),$("#section-preview").addClass("hidden"),$("#section input, #section p").show()},resetSupportingimages:function(){$("#supporting-images-preview").html(""),$("#supporting-images-preview").addClass("hidden"),$("#supporting-images input, #supporting-images p").show()},deleteSupportingImage:function(e){$(".supporting-image-"+e).hide(),this.entry.deletedSupportingImages.push(e)},setCompetition:function(e){this.entry.competition_id=e},setTextAreaLength:function(e,t){Vue.set(this.settings,t,e)}}});$(document).ready((function(){var e=$("textarea[name=description]").attr("data-max-length");void 0!==e&&t.setTextAreaLength(e,"description_length");var i=$("textarea[name=technical_information]").attr("data-max-length");void 0!==i&&t.setTextAreaLength(i,"technical_information");var n=$("textarea[name=lifestyle_the_object_has_been_designed_for]").attr("data-max-length");void 0!==n&&t.setTextAreaLength(n,"lifestyle_the_object_has_been_designed_for"),$(document).on("click",".competition-submit-button",(function(e){e.preventDefault(),t.setCompetition($(this).data("competition-id")),t.submit()})),$(document).on("click",".delete-supporting-image",(function(e){e.preventDefault(),$("#supporting_images-message").html(""),t.entry.uploadedFiles--,t.deleteSupportingImage($(this).data("image-id"))})),$(document).on("click",".delete-hero-image",(function(e){e.preventDefault(),t.resetHeroImage()})),$(document).on("click",".delete-plan-image",(function(e){e.preventDefault(),t.resetPlanImage()})),$(document).on("click",".delete-elevation-image",(function(e){e.preventDefault(),t.resetElevationImage()})),$(document).on("click",".delete-section-image",(function(e){e.preventDefault(),t.resetSectionImage()}))}))})();
//# sourceMappingURL=competitions-min.js.map