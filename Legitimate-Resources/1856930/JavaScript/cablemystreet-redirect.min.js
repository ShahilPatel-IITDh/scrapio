(function(){function x(){try{var a=JSON.parse(decodeURIComponent(h)),b=t;b+="?postcode\x3d"+a.currentAddress.postcode;b+=a.currentAddress.premiseId?"\x26uprn\x3d"+a.currentAddress.premiseId:"";window.location.href=b}catch(e){}}function C(){try{var a=JSON.parse(decodeURIComponent(u)),b=a.currentAddress||{},e=a.currentAddress.campaign||""}catch(c){return}if(k===t){if(v&&b.premiseId===v&&-1!==w.indexOf(e)){window.location.href=l;return}if(v)return;y&&D(b)}else if(-1!==w.indexOf(e)){window.location.href=
l;return}h&&k===g&&x()}function D(a){var b=new XMLHttpRequest;b.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var b=JSON.parse(this.responseText),c=b.reason;"Success"===b.result&&c?c===a.premiseId&&-1!==w.indexOf(cookieCampaign)?window.location.href=l:document.getElementsByTagName("body")[0].getAttribute("data-uprnfromapi",b.reason):document.getElementsByTagName("body")[0].getAttribute("data-manualaddress",!0)}else 4==this.readyState&&(window.location.href=g)};b.open("GET",
E(y),!0);b.send()}function F(){var a;m&&m.getAttribute("data-cms-thank-you-page")&&(a=m.getAttribute("data-cms-thank-you-page"));return a}function G(){var a;n&&n.getAttribute("data-cms-hub-page")&&(a=n.getAttribute("data-cms-hub-page"));return a}function H(){var a=[];p&&p.getAttribute("data-cms-pages-ignore-redirect")&&(a=p.getAttribute("data-cms-pages-ignore-redirect").split(";"));return a}function I(){var a;q&&q.getAttribute("data-cms-home-page")&&(a=q.getAttribute("data-cms-home-page"));return a}
function J(){var a="/postcode-checker/error.html";f&&f.getAttribute("data-cms-error-page")&&(a=f.getAttribute("data-cms-error-page"));return a}function E(a){return document.getElementById("get-uprn-from-cms-api-url").dataset.cmsGetUprnFromApiUrl+"/"+a}function K(){var a;r&&r.getAttribute("data-cms-returning-journey-campaigns")&&(a=r.getAttribute("data-cms-returning-journey-campaigns"));return a.split(";")}function z(a){a+="\x3d";for(var b=document.cookie.split(";"),e=0;e<b.length;e++){for(var c=b[e];" "==
c.charAt(0);)c=c.substring(1);if(0==c.indexOf(a))return c.substring(a.length,c.length)}return""}var m=document.getElementById("cablemystreet-thankyou-page"),n=document.getElementById("cablemystreet-hub-page"),q=document.getElementById("cablemystreet-home-page"),f=document.getElementById("cablemystreet-error-page"),p=document.getElementById("cablemystreet-ignore-redirect"),r=document.getElementById("cablemystreet-returning-journey-campaigns"),A=function(){var a=[];f&&f.getAttribute("data-cms-pages-with-error")&&
(a=f.getAttribute("data-cms-pages-with-error").split(";"));return a}(),h=z("cms.vm.user"),d=function(){var a=window.location.href.split("?")[1];a=a&&a.split("\x26");var b={};a&&a.forEach(function(a,c){a=a.split("\x3d");b[a[0].toLowerCase()]=a[1]});return b}(),y=d.uid,v=d.uprn;if(q&&n&&m&&p&&r&&-1!==window.location.pathname.indexOf("/postcode-checker")){var l=F(),t=G(),g=I(),w=K(),B=H();if(g&&l&&t){for(i=0;i<B.length;i++)if(-1!==window.location.pathname.indexOf(B[i]))return;var u=z("cms.vm.user.reg.data");
d=d.refresh;var k=window.location.href.split("?")[0].replace(/\/$/,"");if(k!==g||!d)for(h&&!u&&k===g&&x(),u&&!d&&C(),i=0;i<A.length;i++)-1===window.location.pathname.indexOf(A[i])||h||(d=J(),window.location=window.location.origin+d)}}})();