"use strict";(self.webpackChunkAemPortal=self.webpackChunkAemPortal||[]).push([[363],{1302:function(t,e,i){var a=i(8565),s=i(5823),n=i(6301),o=i(5741),r=i(1239),l=i(8725);let c=null;class h extends s.Y{constructor(){super(...arguments),this.loop=!1,this.player=null,this.currentVideo=null,this.isFirst=!0}on(){this.log("init"),this.dummyVideoTag=this.ctx.querySelector(".dummyVideoTag")}after(){this.setupAPI(),this.loop="true"===this.ctx.dataset.loop,this.wrapper=this.ctx.querySelector(".video-player-wrapper"),this.apiCache={pause:!1,play:!1},this.debug&&(window.modBrightcoveVideo=this),this.loadBrightcove().catch((t=>this.log.error("loadBrightcove error: ",t.message))),this.initVideoPlaybutton()}onVisibilityChange(t){t||this.pause()}setupAPI(){this.ctx.ownerDocument.body.addEventListener("onPause",(({target:t})=>{t.contains(this.ctx)&&(this.pause(),this.log("on pause API called"))})),this.ctx.ownerDocument.body.addEventListener("onPlay",(({target:t})=>{t.contains(this.ctx)&&(this.play(),this.log("on play API called"))}))}preparePlayer(){this.initPlayer()}initPlayer(){this.player&&this.log("Player reloaded because of a technical problem"),this.createVideo();try{window.bc(this.videoTag)}catch(t){}const t=window.videojs(this.videoTag);t.ready((()=>{this.setupPlayer(t)}))}createVideo(){this.id=(0,l.DO)();const t={class:this.dummyVideoTag.dataset.class||"",id:this.id,poster:this.dummyVideoTag.dataset.poster||""};for(let e in this.dummyVideoTag.dataset)e=`data-${e.replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase()}`,t[e]=this.dummyVideoTag.getAttribute(e);this.videoTag=document.createElement("video"),t.preload="metadata";for(const e in t)this.videoTag.setAttribute(e,t[e]);this.wrapper.innerHTML="",this.wrapper.append(this.videoTag)}async loadBrightcove(){if(!c){let t=this.ctx.dataset.playerScript;this.debug&&(t=t.replace(/\.min\.js$/,".js")),this.log("loading window.bc from ",t),c=(0,r.ve)(t,{})}await c,this.preparePlayer()}cleanup(){this.player&&(this.player.dispose(),this.player=null)}setupPlayer(t){this.cleanup(),this.player=t,this.log("setupPlayer bc video");const e=this.wrapper.querySelector(".video-js").style;e.left="0px",e.width="100%",e.height="100%",this.player.loop(this.loop),this.log("setting loop: ",this.loop),this.player.controls("true"===this.ctx.dataset.showControls),"true"===this.ctx.dataset.autoplay?(this.player.volume(0),this.player.autoplay(!0)):this.player.volume(.5),this.setupPlayerEvents(),this.videoOnHold&&(this.onBrightcovePlayVideo(this.videoOnHold),delete this.videoOnHold),this.apiCache.play&&this.player.play(),this.apiCache.pause&&this.player.pause(),this.ctx.classList.add("scs-setup-and-ready")}onBrightcovePlayVideo(t){if(this.isPlaying()&&this.pause(),!this.player)return this.log("Player not initialized, storing id: ",t.currentVideoId),void(this.videoOnHold=t);this.player.catalog.getVideo(t.currentVideoId,((e,i)=>{var a,s;if(e)this.log("Loading video mediainfo failed for ",t.currentVideoId);else try{null===(a=this.player)||void 0===a||a.catalog.load(i)}catch(e){this.log("Loading video failed for id_",t.currentVideoId),null===(s=this.player)||void 0===s||s.catalog.load(i)}}))}setupPlayerEvents(){this.player&&(this.player.on("loadstart",(()=>this.triggerLoadStart())),this.player.on("ended",(()=>{this.log("got ended event")})),this.player.on("bc-catalog-error",(()=>{this.log("got bc-catalog-error event"),window.setTimeout((()=>{this.initPlayer()}),2e3)})),this.player.on("pause",(()=>{this.log("got pause event"),this.ctx.classList.add("is-paused"),this.ctx.classList.remove("is-playing")})),this.player.on("play",(()=>{this.log("got play event"),this.ctx.classList.remove("is-paused"),this.ctx.classList.add("is-playing")})),this.player.on("firstplay",(()=>{this.log("got firstplay event"),this.ctx.classList.add("has-started"),this.ctx.classList.remove("is-idle")})),this.player.mediainfo&&this.triggerLoadStart())}triggerLoadStart(){if(this.log("got loadstart event"),!this.player)return;const t=this.player.mediainfo;this.videoChanged(t),this.isFirst&&(this.isFirst=!1)}videoChanged(t){if(this.updateAspectRatio(t),this.log("videoChanged",this.dummyVideoTag.getAttribute("data-video-id"),t.id),this.dummyVideoTag.setAttribute("data-video-id",t.id),!this.isFirst&&this.currentVideo&&t.id!==this.currentVideo.id){const e={currentVideoId:t.id,name:t.name,description:t.description};window.setTimeout((()=>{this.updateToNewVideo(e)}),10),this.log("brightcoveChangedVideo > currentVideoId = ",t.id)}this.currentVideo=t}updateAspectRatio(t){const e=t.sources.filter((t=>t.width&&t.height)).sort(((t,e)=>e.width-t.width))[0];e&&(this.wrapper.style.aspectRatio=String(e.width/e.height))}pause(){this.player?this.player.pause():this.apiCache.pause=!0}play(){this.player?this.player.play():this.apiCache.play=!0}isPlaying(){return!!this.player&&!this.player.paused()}updateToNewVideo(t){const e=t.currentVideoId,i=t.name,a=t.description,s=this.createUrl(e,i);this.log("onBrightcoveChangedVideo > currentVideo = ",t),window.history&&window.history.pushState&&window.history.pushState(null,i,s),document.title=i,this.ctx.querySelector(".modBrightcoveVideo h1.title").innerText=i,this.ctx.querySelector(".lead p").innerText=a||""}createUrl(t,e){let i=this.ctx.dataset.videoPageUrl||document.location.href;0!==i.indexOf("http")&&(i=(0,n.Cr)(i));let a=i.split(".");const s=a.pop();if("html"!==s)return this.log("Not an ordinary page => do nothing",i),i;for(let t=0;t<a.length;t+=1)if(0===a[t].indexOf("id-")){a=a.slice(0,t);break}a.push(`id-${t}`),a.push(!e||2>e.length?"notitle":(0,o.Uu)(e).toLowerCase()),a.push(s);const r=a.join(".")+(document.location.search||"");return this.log("new url",r),r}initVideoPlaybutton(){this.ctx.querySelector(".video-playbutton-container").addEventListener("click",(()=>{this.play()})),navigator.userAgent.toLowerCase().indexOf("android")>-1&&this.ctx.classList.add("is-android")}}var d=i(2521),u=i(7234),m=i(3467),p=i(6691);function g({label:t,asLink:e=!1,disable:i=!1,style:a,onClick:s}){return e?p.createElement("button",{type:"button",className:"link margin-v-1 link--standalone","on-click":s},t):p.createElement("button",{type:"button",className:`button ${a} button--responsive margin-v-2 ${i?"disabled":""}`,"on-click":s},p.createElement("i",{className:"icon icon-105-call-centre"}),t)}function f({linkPath:t,btnPosition:e,target:i,label:a,linkStyle:s,icon:n}){return p.createElement("div",{className:"button--full"!==e?e:""},p.createElement("a",{href:t,className:`button ${s} button--responsive font ${"button--full"===e?e:""} margin-v-2`,target:i},n&&p.createElement("i",{className:`icon ${n}`,"aria-hidden":"true"}),a))}function x({title:t,introductionText:e,additionalText:i,buttonConf:a,onClick:s}){return p.createElement("div",{className:"cfn-open"},t&&p.createElement("h4",{className:"sc-navy margin-bottom-3"},t),e&&p.createElement("div",{className:"introduction-text","props-innerHTML":e}),p.createElement(g,{label:a.label,asLink:a.asLink,disable:a.disable,style:a.style,onClick:s}),i&&p.createElement("div",{className:"additional-text","props-innerHTML":i}))}function b({contactNumber:t,remark:e}){return p.createElement("div",{className:"hotline-info margin-v-2 row no-gutters"},p.createElement("div",{className:"margin-right-1 margin-top-1"},p.createElement(u._,{size:2,iconName:"icon-call-centre"})),p.createElement("div",{className:"text-holder row no-gutters"},p.createElement("div",{className:"hotline-number font--semi-bold col-xs-12"},t),p.createElement("div",{className:"hotline-number font--semi-bold col-xs-12"},e)))}function v({title:t,introductionText:e,additionalText:i,contactNumber:a,remark:s,hideHotlineInfo:n,buttonConf:o,callout:r}){return p.createElement("div",{className:"hotline"},t&&p.createElement("h4",{className:"sc-navy margin-bottom-3"},t),e&&p.createElement("div",{className:"introduction-text","props-innerHTML":e}),o&&p.createElement(g,{label:o.label,disable:!0,style:o.style}),!n&&p.createElement(b,{contactNumber:a,remark:s}),r&&p.createElement("div",{className:"opening-time-info margin-v-3"},p.createElement("p",null,p.createElement("span",null,r.label)," ",p.createElement(m.i,null,p.createElement("div",{"props-innerHTML":r.content})))),i&&p.createElement("div",{className:"additional-text","props-innerHTML":i}))}function y({closed:t}){return p.createElement("p",null," ",t.map((t=>[p.createElement("span",null,t),p.createElement("br",null)])))}function E({title:t,introductionText:e,additionalText:i,buttonConf:a,callout:s,closed:n}){return p.createElement("div",{className:"closed"},t&&p.createElement("h4",{className:"sc-navy margin-bottom-3"},t),e&&p.createElement("div",{className:"introduction-text","props-innerHTML":e}),s&&p.createElement("div",{className:"opening-time-info margin-v-3"},p.createElement("p",null,p.createElement("span",null,s.label)," ",p.createElement(m.i,null,p.createElement(y,{closed:s.content})))),n&&p.createElement(y,{closed:n}),a&&p.createElement(g,{label:a.label,disable:!0,style:a.style}),i&&p.createElement("div",{className:"additional-text","props-innerHTML":i}))}function w({target:t,title:e,introductionText:i,additionalText:a,contactNumber:s,remark:n,hideHotlineInfo:o,buttonConf:r,callout:l}){return(0,d.r)(t,p.createElement(v,{title:e,introductionText:i,additionalText:a,contactNumber:s,remark:n,buttonConf:r,callout:l,hideHotlineInfo:o}))}function C(t){return(0,d.r)(t,p.createElement("div",{className:"loader-holder margin-v-2"},p.createElement("sdx-loading-spinner",{size:"large","sr-hint":""})))}function T(t){const e={exceptionallyClosed:[],exceptionallyOpen:[],openhours:[]};return t.split(";").forEach((t=>{t=t.trim(),(0,l.hj)(t.charAt(0))?0>t.indexOf("closed")?e.exceptionallyOpen.push(t):e.exceptionallyClosed.push(t):e.openhours.push(t)})),e}function k(t,e=new Date){if(function(t,e){const i=D(t);return e.some((t=>t.split(" ")[0]===i))}(e,t.exceptionallyClosed))return!1;const i=function(t,e){const i=D(t);let a="",s=!1,n=!1;return e.some((t=>{const e=t.split(" ");return e[0]===i&&(a=e[1],!0)})),a&&(s=N(t,a),n=!0),{open:s,hasException:n}}(e,t.exceptionallyOpen);return i.hasException?i.open:function(t,e){return!e.length||e.some((e=>{const i=e.split(" ")[0],a=e.split(" ")[1];return!!function(t,e){return function(t){const e=t.split("-");let i=S.indexOf(e[0]),a=S.indexOf(e[1]);const s=[];let n=i;for(;-1!==i||-1!==a;)n===i&&(i=-1),n===a&&(a=-1),s.push(n),n=(n+1)%7;return s}(e).includes(t)}(t.getDay(),i)&&N(t,a)}))}(e,t.openhours)}const S=["Su","Mo","Tu","We","Th","Fr","Sa"],L=/^(\d{2}):(\d{2})-(\d{2}):(\d{2})$/;function N(t,e){const i=L.exec(e).map((t=>parseInt(t,10))),a=new Date(t),s=new Date(t);return a.setHours(i[1]),a.setMinutes(i[2]),s.setHours(i[3]),s.setMinutes(i[4]),t.getTime()>=a.getTime()&&t.getTime()<s.getTime()}function D(t){return`${q(t.getDate())}.${q(t.getMonth()+1)}.${t.getFullYear()}`}function q(t,e=2){return e-=Math.round(Number(t)).toString().length,`${new Array(e>0?e+1:0).join("0")}${t}`}function O(t){const e=t.split(".").map(((t,e)=>parseInt(t,10)-e%2)).reverse();return new Date(...e)}const A={Fr:["Fr","Ve","Ve","Fr"],Mo:["Mo","Lu","Lu","Mo"],Sa:["Sa","Sa","Sa","Sa"],Su:["So","Di","Do","Su"],Th:["Do","Je","Gi","Th"],Tu:["Di","Ma","Ma","Tu"],We:["Mi","Me","Me","We"]},P=["de","fr","it","en"];function $(t){return/^\+41(?!800|840|842|844|848|860|868|869|878|900|901|906|97|98|99)\d{9}$/.test(t)}function I(t){return t?(0!==(t=t.replace(/[\s*\-?\\?/?(?)?]/g,"")).indexOf("+")&&(0===t.indexOf("00")&&(t=t.slice(2)),0===t.indexOf("0")&&(t=`41${t.slice(1)}`),t=`+${t}`),t):""}function H(t){const e=I(t);if($(e))return e}var M,F=i(7392);function U(t){return k(T(t))}function V(t){t.querySelector(".cancel-btn").addEventListener("click",(()=>{t.close()}))}!function(t){t.hotline="hotline",t.none="none",t.button="button"}(M||(M={}));class j extends s.Y{on(){var t,e;this.configuration=JSON.parse(this.ctx.dataset.configuration||"[]"),this.displayCFNCloseOption=this.ctx.dataset.displayOptions,this.ajaxUrlPrefix=this.ctx.dataset.ajaxUrl,this.container=this.ctx.querySelector(".content-holder"),this.configDialog=this.ctx.querySelector(".config-dialog"),this.successDialog=this.ctx.querySelector(".success-dialog"),this.errorDialog=this.ctx.querySelector(".error-dialog"),this.topicSelectorDialog=null!==(t=this.ctx.querySelector(".topic-selector-dialog"))&&void 0!==t?t:void 0,V(this.configDialog),V(this.successDialog),this.configDialog.querySelector(".submit-btn").addEventListener("click",(()=>{this.submitForm()})),this.errorDialog.querySelector("sdx-button").addEventListener("click",(()=>{this.errorDialog.close(),this.topicSelectorDialog?this.topicSelectorDialog.open():this.openConfigDialog(!1)})),this.topicSelectorDialog&&(this.topicSelectorDialog.querySelector("sdx-input-group").changeCallback=t=>{this.onTopicSelected(t)},this.topicSelectorContainer=null!==(e=this.topicSelectorDialog.querySelector(".cfn-content-holder"))&&void 0!==e?e:void 0),this.configForm=this.configDialog.querySelector("form"),this.configuration.length?(this.isSwissVisitor=this.ctx.hasAttribute("data-dont-consider-abroad")||(0,l.p7)(),"true"===this.ctx.dataset.autoInit&&(this.init(),this.initialized=!0)):this.log.warn("Do not initialize component if configuration is missing")}onVisibilityChange(t){t&&!this.initialized&&(this.init(),this.initialized=!0)}init(){var t,e,i,a,s,n,o;this.isSwissVisitor?(this.trackAction=null!==(t=this.ctx.dataset.trackAction)&&void 0!==t?t:"",this.trackLabel=null!==(e=this.ctx.dataset.trackLabel)&&void 0!==e?e:"",this.trackLocation=null!==(i=this.ctx.dataset.trackLocation)&&void 0!==i?i:"",this.trackCategory=null!==(a=this.ctx.dataset.trackCategory)&&void 0!==a?a:"",this.conversionCategory=null!==(s=this.ctx.dataset.conversionCategory)&&void 0!==s?s:"",this.conversionDetail=null!==(n=this.ctx.dataset.conversionDetail)&&void 0!==n?n:"",this.conversionClass=null!==(o=this.ctx.dataset.conversionClass)&&void 0!==o?o:"",this.topicSelectorDialog?this.container=function({target:t,label:e,asLink:i,disable:a,style:s,onClick:n}){return(0,d.r)(t,p.createElement(g,{label:e,asLink:i,disable:a,style:s,onClick:n}))}({asLink:this.ctx.dataset.cfnAsLink?"true"===this.ctx.dataset.cfnAsLink:void 0,label:this.ctx.dataset.cfnLabel,onClick:()=>{this.topicSelectorDialog.open()},style:this.ctx.dataset.cfnBtnStyle,target:this.container}):(this.activeConfig=this.configuration[0],this.render())):this.renderCFNClosedState()}openConfigDialog(t=!0){var e;t&&this.trackOpen(),null===(e=this.topicSelectorDialog)||void 0===e||e.close(),this.configDialog.open()}async checkAvailability(){const t=new URLSearchParams;t.append("segment",this.activeConfig.segment),this.activeConfig.routingTarget?t.append("routingTarget",this.activeConfig.routingTarget):(t.append("subtopic",this.activeConfig.subtopicKey),t.append("topic",this.activeConfig.topicKey));try{const e=await Promise.race([fetch(`${this.ajaxUrlPrefix}.contactavailable${this.activeConfig.routingTarget?".v2":""}.json`,{body:t,headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},method:"POST"}),new Promise(((t,e)=>setTimeout((()=>e(new Error("Response timout expired. No response for 10000ms"))),1e4)))]),i=await e.json();this.openConfig=i}catch(t){throw this.log.error(`Request failed: ${t.message}`),new Error(t.message)}}renderCFNClosedState(t=this.container){this.displayCFNCloseOption!==M.none||this.topicSelectorDialog?this.displayCFNCloseOption!==M.button||this.topicSelectorDialog?this.isSwissVisitor||this.topicSelectorDialog?this.renderHotline():this.renderAbroad():this.container=function({target:t,linkPath:e,btnPosition:i,openTarget:a,label:s,linkStyle:n,icon:o}){return(0,d.r)(t,p.createElement(f,{linkPath:e,btnPosition:i,target:a,label:s,linkStyle:n,icon:o}))}({btnPosition:this.ctx.dataset.btnPosition,icon:this.ctx.dataset.linkIcon,label:this.ctx.dataset.linkLabel,linkPath:this.ctx.dataset.linkPath,linkStyle:this.ctx.dataset.linkStyle,openTarget:this.ctx.dataset.linkTarget,target:t}):this.container=function(t){return(0,d.r)(t,p.createElement("div",{className:"content-holder"}))}(this.container)}renderHotline(){U(this.openConfig.transferhours)?this.renderHotlineOpen():this.renderHotlineClosed()}renderCFNOpen(t=this.container){!function({target:t,title:e,introductionText:i,additionalText:a,buttonConf:s,onClick:n}){(0,d.r)(t,p.createElement(x,{title:e,introductionText:i,additionalText:a,buttonConf:s,onClick:n}))}({additionalText:this.ctx.dataset.cfnAdditionalText,buttonConf:{asLink:this.ctx.dataset.cfnAsLink?"true"===this.ctx.dataset.cfnAsLink:void 0,label:this.ctx.dataset.cfnLabel,style:this.ctx.dataset.cfnBtnStyle},introductionText:this.ctx.dataset.cfnIntroText,onClick:this.openConfigDialog.bind(this),target:t,title:this.ctx.dataset.cfnTitle})}renderHotlineOpen(){let t;"true"===this.ctx.dataset.displayDisabledCfn&&(t={label:this.ctx.dataset.cfnLabel,style:this.ctx.dataset.cfnBtnStyle});const e=w({additionalText:this.ctx.dataset.hotlineOpenAdditionText,buttonConf:t,contactNumber:this.openConfig.publicnumber.replace(/^(\+410?)([\d]{3})([\d]{3})([\d]{3})$/,"0$2 $3 $4"),hideHotlineInfo:"true"===this.ctx.dataset.hideHotline,introductionText:this.ctx.dataset.hotlineOpenIntroText,remark:this.ctx.dataset.hotlineRemark,target:this.topicSelectorDialog?this.topicSelectorContainer:this.container,title:this.ctx.dataset.hotlineOpenTitle});this.topicSelectorDialog?this.topicSelectorContainer=e:this.container=e}renderHotlineClosed(){var t;let e,i,a;if("true"===this.ctx.dataset.displayOh){const a=null!==(t=document.documentElement.lang)&&void 0!==t?t:"de",s=function(t,e,i){const a=T(t),s=P.indexOf(i);a.openhours=a.openhours.map((t=>t.replace(/(Mo|Tu|We|Th|Fr|Sa|Su)/g,(t=>A[t][s])))),a.exceptionallyClosed.map((t=>t.replace("closed",e)));const n=new Date,o=new Date;o.setDate(n.getDate()+10);const r=a.exceptionallyClosed.concat(a.exceptionallyOpen).filter((t=>{const e=O(t);return e.getTime()>=n.getTime()&&e.getTime()<=o.getTime()})).sort(((t,e)=>O(t).getTime()-O(e).getTime()));return a.openhours.concat(r)}(this.openConfig.openhours,this.ctx.dataset.closedLabel,a);"true"===this.ctx.dataset.displayOhAsTooltip?i={content:s,label:this.ctx.dataset.openHoursLabel}:e=s}"true"===this.ctx.dataset.displayDisabledCfn&&(a={label:this.ctx.dataset.cfnLabel,style:this.ctx.dataset.cfnBtnStyle});const s=function({target:t,title:e,introductionText:i,additionalText:a,buttonConf:s,callout:n,closed:o}){return(0,d.r)(t,p.createElement(E,{title:e,introductionText:i,additionalText:a,buttonConf:s,callout:n,closed:o}))}({additionalText:this.ctx.dataset.hotlineClosedAdditionlText,buttonConf:a,callout:i,closed:e,introductionText:this.ctx.dataset.hotlineClosedIntroText,target:this.topicSelectorDialog?this.topicSelectorContainer:this.container,title:this.ctx.dataset.hotlineClosedTitle});this.topicSelectorDialog?this.topicSelectorContainer=s:this.container=s}renderAbroad(){this.container=w({additionalText:this.ctx.dataset.abroadAdditionalText,contactNumber:this.ctx.dataset.internationalContactNumber,hideHotlineInfo:!1,introductionText:this.ctx.dataset.abroadIntroText,remark:this.ctx.dataset.abroadRemark,target:this.container,title:this.ctx.dataset.abroadTitle})}renderError(t=this.container){return w({callout:{content:this.ctx.dataset.calloutOpeningTimeMsg,label:this.ctx.dataset.openHoursLabel},contactNumber:this.ctx.dataset.errorContactNumber,hideHotlineInfo:"true"===this.ctx.dataset.hideHotline,introductionText:this.ctx.dataset.errorIntroText,remark:this.ctx.dataset.hotlineRemark,target:t,title:this.ctx.dataset.errorTitle})}async render(){try{this.container=C(this.container),await this.checkAvailability(),U(this.openConfig.openhours)?this.renderCFNOpen():this.renderCFNClosedState()}catch(t){this.container=this.renderError()}}async onTopicSelected(t){this.activeConfig=this.configuration[t[0]],this.trackSubtopics();try{this.topicSelectorContainer=C(this.topicSelectorContainer),await this.checkAvailability(),U(this.openConfig.openhours)?this.renderCFNOpen(this.topicSelectorContainer):this.renderCFNClosedState(this.topicSelectorContainer)}catch(t){this.topicSelectorContainer=this.renderError(this.topicSelectorContainer)}}async submitForm(){if(this.validateForm()){const t=this.getSubmitData();this.log(t);try{this.track(),await Promise.race([fetch(`${this.ajaxUrlPrefix}.contactrequest${this.activeConfig.routingTarget?".v2":""}.json`,{body:t,headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},method:"POST"}),new Promise(((t,e)=>setTimeout((()=>e(new Error("Response timout expired. No response for 10000ms"))),1e4)))]);const e=this.configForm.querySelector('sdx-input[name="numberToCall"]').value.replace(/\s+/g,"");await this.configDialog.close(),this.successDialog.querySelector("p").textContent=this.ctx.dataset.successMessage.replace("${numberToCall}",e),await this.successDialog.open()}catch(t){this.log.error(`Request failed: ${t.message}`),await this.configDialog.close(),await this.errorDialog.open()}}}validateForm(){let t=!0;return this.configForm.querySelectorAll("sdx-input").forEach((e=>{e.required&&!e.value||e.value&&!$(I(e.value))?(t=!1,e.valid=!1,e.validationMessage=this.ctx.dataset.dialogFieldError):(e.valid=void 0,e.validationMessage="")})),t}getSubmitData(){const t=H(this.configForm.querySelector('sdx-input[name="numberToCall"]').value)||"",e=this.configForm.querySelector('sdx-input[name="customerLine"]'),i=H(null!==e?e.value:"")||"",a=new URLSearchParams;return a.append("conversionclass",this.ctx.dataset.conversionClass),a.append("eventcategory",this.ctx.dataset.trackCategory),a.append("numbertocall",t),a.append("phonenumber",i),a.append("segment",this.activeConfig.segment),a.append("source",window.location.href.slice(0,255)),this.activeConfig.routingTarget?a.append("routingTarget",this.activeConfig.routingTarget):(a.append("subtopic",this.activeConfig.subtopicKey),a.append("topic",this.activeConfig.topicKey)),a}track(){let t=this.trackLocation;this.topicSelectorDialog&&(t+=`_${this.activeConfig.subtopicName||""}`),(0,F.iQ)(this.trackAction,this.trackLabel,t,this.trackCategory,this.conversionCategory,this.conversionDetail,this.conversionClass)}trackOpen(){(0,F.L9)(`${this.trackAction}_open`,this.trackLabel,this.trackLocation,this.trackCategory)}trackSubtopics(){(0,F.L9)(this.trackAction,this.trackLabel,`${this.trackLocation}}_${this.activeConfig.subtopicName||""}`,this.trackCategory)}}var z=i(6691);function R({inputs:t,valid:e,validationMsg:i,name:a,fullwidth:s,label:n,checked:o,onchange:r}){return z.createElement("fieldset",{className:"margin-0"},z.createElement("legend",{className:"sr-only"},n),z.createElement("div",{class:{"bg--dark":!0,fullwidth:s,selector:!0,"container-fluid":!s,"margin-0":!0}},t.filter((t=>!!t.inputs.length)).map((t=>z.createElement("div",{class:{row:!s}},t.title&&z.createElement("h3",{className:"sc-navy text-h5 col-xs-12 margin-bottom-2"},t.title),t.inputs.map((t=>{const e=`call-me-back-selector-${a}-${t.value}`;return z.createElement("div",{className:"radio",class:{"col-sm-4":!s,"col-xs-6":!s,"margin-bottom-2":!0,radio:!0}},z.createElement("input",{"attrs-id":e,"attrs-type":"radio","attrs-name":a,"attrs-value":t.value,"attrs-aria-label":t.ariaLabel,"props-checked":o===t.value,"on-change":()=>r(t.value)}),z.createElement("label",{className:"button font font--light","attrs-for":e},t.label))}))))),!e&&z.createElement("div",{className:"sc-red text-small margin-top-1 error"},z.createElement("sdx-icon",{iconName:"icon-exclamation-mark",size:"2"}),z.createElement("span",null,i))))}var _=i(6691);let Y=!1,B=!1;function J(t){9===t.keyCode&&(Y=!0,document.removeEventListener("keydown",J),document.addEventListener("mousedown",G,{passive:!0}))}function G(){Y=!1,document.addEventListener("keydown",J,{passive:!0}),document.removeEventListener("mousedown",G)}function K(t){const e=new Date(t.localTime),i=new Date(t.localTime);i.setHours(8,0,0,0);const a=new Date(t.localTime);return a.setHours(19,30,0,0),i.getTime()<=e.getTime()&&e.getTime()<=a.getTime()}class W extends s.Y{constructor(){super(...arguments),this.isAvailable=!1,this.showCustomerLineNumber=!1,this.slots=new Map}on(){var t;this.dialog=this.ctx.querySelector(".call-me-back-dialog"),this.dialog.displayChangeCallback=this.onDialogToggle.bind(this),this.container=this.ctx.querySelector(".content-holder"),this.ajaxUrlPrefix=this.ctx.dataset.ajaxUrl,this.showCustomerLineNumber="true"===this.ctx.dataset.showQuestionToAnotherNumber,this.locale=document.documentElement.lang||"de",this.texts=JSON.parse(null!==(t=this.ctx.dataset.texts)&&void 0!==t?t:"{}"),this.modalTitle=this.dialog.label,this.trackLocation=this.ctx.dataset.trackLocation,this.trackCategory=this.ctx.dataset.trackCategory,B||(B=!0,document.addEventListener("keydown",J,{passive:!0}))}onDialogToggle(t){if("opening"===t)return this.modalTitle||(this.modalTitle=this.dialog.label),this.renderLoader(),this.track("open"),void this.checkAvailability();"closed"!==t||this.reset()}async checkAvailability(){const t=new URLSearchParams;t.append("segment",this.ctx.dataset.segment),t.append("routingTarget",this.ctx.dataset.routingTarget);try{const e=await fetch(`${this.ajaxUrlPrefix}.contactavailable.v2.json`,{body:t,headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},method:"POST"});if(!e.ok)throw new Error(e.statusText);{const t=await e.json();this.isAvailable=k(T(t.openhours)),this.renderSelector(!1)}}catch(t){throw this.log.error(`Request failed: ${t.message}`),this.renderError(),t}}reset(){this.isAvailable=!1,this.numberToCall=void 0,this.customerLine=void 0,this.selectedDate=void 0,this.selectedTime=void 0,this.dialog.notificationType=void 0,this.dialog.iconName=void 0,this.dialog.label=this.modalTitle,this.slots.clear(),this.domReset()}domReset(){this.container=(0,d.r)(this.container,_.createElement("div",{className:"content-holder"}))}renderLoader(){this.container=(0,d.r)(this.container,_.createElement("div",{className:"call-me-back-wizard loader"},_.createElement("sdx-loading-spinner",{size:"large"})))}renderSelector(t=!0){this.container=(0,d.r)(this.container,_.createElement("div",{className:"call-me-back-wizard option-selector"},_.createElement("h2",{"hook-insert":e=>{t&&Y&&e.elm.focus()},"hook-update":e=>{t&&Y&&e.elm.focus()},tabindex:"0",className:"sc-navy"},this.texts["selector-title"]),_.createElement("sdx-button-group",{layout:"fullwidth"},_.createElement("sdx-button",{label:this.texts["call-me-now"],disabled:!this.isAvailable,"on-click":()=>this.handleNowRequest()}),_.createElement("sdx-button",{theme:"secondary",label:this.texts["call-me-later"],"on-click":()=>this.handleLaterRequest()}))))}handleNowRequest(){this.track("button","now"),this.renderCallMeNow(),Y&&setTimeout((()=>{var t;null===(t=this.container.elm.querySelector("sdx-input"))||void 0===t||t.doFocus()}),50)}handleLaterRequest(){this.track("button","later"),this.renderCallMeLater()}renderCallMeNow(){this.container=(0,d.r)(this.container,_.createElement("div",{className:"call-me-back-wizard call-me-now"},_.createElement("h2",null,this.texts["call-me-now-intro-title"]),_.createElement("p",null,this.texts["call-me-now-intro"]),_.createElement("p",null,_.createElement("sdx-input",{label:this.texts["call-me-now-number-label"],name:"numberToCall",required:"true",placeholder:this.texts["number-placeholder"],value:this.numberToCall,hitEnterCallback:()=>{this.requestCall()},"on-input":t=>{this.validateInput(t.target),this.numberToCall=t.target.value}})),this.showCustomerLineNumber&&_.createElement("p",null,_.createElement("sdx-input",{name:"customerLine",label:this.texts["additional-number-label"],placeholder:this.texts["number-placeholder"],value:this.customerLine,hitEnterCallback:()=>{this.requestCall()},"on-input":t=>{this.validateInput(t.target),this.customerLine=t.target.value}})),_.createElement("p",{className:"text-small"},"* ",this.texts["mandatory-field"]),_.createElement("sdx-button-group",{layout:"fullwidth"},_.createElement("sdx-button",{label:this.texts["call-me-back-label"],disabled:"false","on-click":()=>{this.requestCall()}}),_.createElement("sdx-button",{theme:"secondary",label:this.texts["back-label"],"on-click":()=>this.renderSelector()}))))}renderCallMeLater(){this.container=(0,d.r)(this.container,_.createElement("div",{className:"call-me-back-wizard call-me-later"},_.createElement("h2",{tabindex:"0","hook-insert":t=>{Y&&t.elm.focus()},"hook-update":t=>{Y&&t.elm.focus()},className:"sc-navy"},this.texts["call-me-now-intro-title"]),_.createElement("p",null,this.texts["call-me-now-intro"]),_.createElement("p",null,_.createElement("sdx-input",{label:this.texts["call-me-now-number-label"],placeholder:this.texts["number-placeholder"],required:"true",value:this.numberToCall,name:"numberToCall",hitEnterCallback:()=>{this.proceedToDateSelector()},"on-input":t=>{this.validateInput(t.target),this.numberToCall=t.target.value}})),this.showCustomerLineNumber&&_.createElement("p",null,_.createElement("sdx-input",{name:"customerLine",label:this.texts["additional-number-label"],placeholder:this.texts["number-placeholder"],value:this.customerLine,hitEnterCallback:()=>{this.proceedToDateSelector()},"on-input":t=>{this.validateInput(t.target),this.customerLine=t.target.value}})),_.createElement("sdx-button-group",{layout:"fullwidth"},_.createElement("sdx-button",{label:this.texts["next-label"],disabled:"false","on-click":()=>this.proceedToDateSelector()}),_.createElement("sdx-button",{theme:"secondary",label:this.texts["back-label"],"on-click":()=>this.renderSelector()}))))}async requestCall(){var t,e,i;if(!this.validateNumbers())return void(Y&&(null===(t=this.container.elm.querySelector("sdx-input"))||void 0===t||t.doFocus()));this.track("button","call",!0);const a=H(null!==(e=this.numberToCall)&&void 0!==e?e:"")||"",s=H(null!==(i=this.customerLine)&&void 0!==i?i:"")||"",n=new URLSearchParams;n.append("numbertocall",a),n.append("phonenumber",s),n.append("segment",this.ctx.dataset.segment),n.append("source",window.location.href.slice(0,255)),n.append("routingTarget",this.ctx.dataset.routingTarget);try{const t=await fetch(`${this.ajaxUrlPrefix}.contactrequest.v2.json`,{body:n,headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},method:"POST"});if(!t.ok)throw new Error(t.statusText);this.renderSuccessRequest()}catch(t){throw this.log.error(`Request failed: ${t.message}`),this.renderError(),t}}renderSuccessRequest(){const t=this.texts["call-request-success"].replace("${numberToCall}",this.numberToCall);this.container=(0,d.r)(this.container,_.createElement("div",{className:"call-me-back-wizard call-request-successfully"},_.createElement("h2",null,this.texts["call-request-success-title"]),_.createElement("p",null,t),_.createElement("p",{className:"text-align-center"},_.createElement("img",{"attrs-src":"/etc/designs/swisscom/success_request.png","attrs-width":"142","attrs-height":"142","attrs-role":"presentation","attrs-aria-hidden":"true"}))))}async proceedToDateSelector(){var t;if(!this.validateNumbers())return void(Y&&(null===(t=this.container.elm.querySelector("sdx-input"))||void 0===t||t.doFocus()));const e=await this.getAvailableSlots();this.createSlotSpaces(e),this.renderDateSelector()}createSlotSpaces(t){const e=(new Date).toISOString().split("T")[0],i=Date.now();t.slots.filter((t=>/(00|15|30|45):0{2}.0{3}$/.test(t.localTime))).filter((t=>!t.localTime.startsWith(e)||new Date(t.localTime).getTime()>i)).filter((t=>t.capacity>0)).filter(K).forEach((t=>{const[e,i]=t.localTime.split("T");this.slots.has(e)||this.slots.set(e,[]),this.slots.get(e).push({label:i.substring(0,5),value:t.localTime})}))}async getAvailableSlots(){try{const t=new URLSearchParams;t.append("segment",this.ctx.dataset.segment),t.append("routingTarget",this.ctx.dataset.routingTarget);const e=await fetch(`${this.ajaxUrlPrefix}.capacity.v2.json`,{body:t,headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},method:"POST"});if(e.ok)return await e.json();throw new Error(e.statusText)}catch(t){throw this.log.error(`Request failed: ${t.message}`),this.renderError(),t}}renderDateSelector(t=!0){var e;const i=Array.from(this.slots.keys()).filter((t=>this.slots.get(t).length)).map((t=>({ariaLabel:new Date(t).toLocaleDateString("de",{day:"2-digit",year:"numeric",month:"long"}),label:new Date(t).toLocaleDateString(this.locale),value:t})));this.domReset(),this.container=(0,d.r)(this.container,_.createElement("div",{className:"call-me-back-wizard call-request-date-selector"},_.createElement("h2",{tabindex:"0","hook-insert":t=>{Y&&t.elm.focus()},"hook-update":t=>{Y&&t.elm.focus()},className:"sc-navy"},this.texts["date-title"]),_.createElement("p",{"on-keydown":t=>{"Enter"===t.key&&this.proceedToTimeSelector()}},_.createElement(R,{name:"date",inputs:[{inputs:i}],valid:t,fullwidth:!0,label:this.texts["date-title"],onchange:t=>this.selectedDate=t,validationMsg:this.texts["date-error"],checked:null!==(e=this.selectedDate)&&void 0!==e?e:""})),_.createElement("sdx-button-group",{layout:"fullwidth"},_.createElement("sdx-button",{label:this.texts["next-label"],disabled:"false","on-click":()=>this.proceedToTimeSelector()}),_.createElement("sdx-button",{theme:"secondary",label:this.texts["back-label"],"on-click":()=>this.renderCallMeLater()}))))}proceedToTimeSelector(){this.selectedDate?this.renderTimeSelector():this.renderDateSelector(!1)}renderTimeSelector(t=!0){const e=this.slots.get(this.selectedDate)||[],i={inputs:[],title:this.texts["morning-time-title"]},a={inputs:[],title:this.texts["afternoon-time-title"]};for(const t of e)12>parseInt(t.label.split(":")[0],10)?i.inputs.push(t):a.inputs.push(t);this.domReset(),this.container=(0,d.r)(this.container,_.createElement("div",{className:"call-me-back-wizard call-request-time-selector"},_.createElement("h2",{tabindex:"0","hook-insert":t=>{Y&&t.elm.focus()},"hook-update":t=>{Y&&t.elm.focus()},className:"sc-navy"},this.texts["time-title"]),_.createElement("p",{"on-keydown":t=>{"Enter"===t.key&&this.renderSummary()}},_.createElement(R,{name:"time",inputs:[i,a],valid:t,fullwidth:!1,label:this.texts["time-title"],onchange:t=>this.selectedTime=t,validationMsg:this.texts["time-error"],checked:this.selectedTime})),_.createElement("sdx-button-group",{layout:"fullwidth"},_.createElement("sdx-button",{label:this.texts["next-label"],disabled:"false","on-click":()=>this.renderSummary()}),_.createElement("sdx-button",{theme:"secondary",label:this.texts["back-label"],"on-click":()=>this.renderDateSelector()}))))}renderSummary(){this.selectedTime?this.container=(0,d.r)(this.container,_.createElement("div",{className:"call-me-back-wizard call-request-time-summary"},_.createElement("h2",{tabindex:"0","hook-insert":t=>{Y&&t.elm.focus()},"hook-update":t=>{Y&&t.elm.focus()},className:"sc-navy"},this.texts["summary-title"]),_.createElement("div",{className:"card-holder"},_.createElement("sdx-card",{className:"margin-bottom-2"},_.createElement("h4",{className:""},this.texts["summary-subtitle"]),_.createElement("div",{className:"summary-report"},_.createElement("p",{className:"margin-bottom-2"},_.createElement("span",null,this.texts["summary-date"]),_.createElement("span",{className:"font--semi-bold"},new Date(this.selectedDate).toLocaleDateString(this.locale))),_.createElement("p",{className:"margin-bottom-2"},_.createElement("span",null,this.texts["summary-time"]),_.createElement("span",{className:"font--semi-bold"},this.selectedTime.split("T")[1].substring(0,5))),_.createElement("p",{className:"margin-bottom-2"},_.createElement("span",null,this.texts["summary-number"]),_.createElement("span",{className:"font--semi-bold"},this.numberToCall))))),_.createElement("sdx-button-group",{layout:"fullwidth"},_.createElement("sdx-button",{label:this.texts["summary-confirm"],disabled:"false","on-click":()=>{this.scheduleCall()}}),_.createElement("sdx-button",{theme:"secondary",label:this.texts["back-label"],"on-click":()=>this.renderTimeSelector()})))):this.renderTimeSelector(!1)}async scheduleCall(){this.track("button","schedule",!0);const t=H(this.numberToCall)||"",e=H(this.customerLine)||"",i=new URLSearchParams;i.append("segment",this.ctx.dataset.segment),i.append("routingTarget",this.ctx.dataset.routingTarget),i.append("callbackTime",this.selectedTime),i.append("numbertocall",t),i.append("phonenumber",e),i.append("source",window.location.href.slice(0,255));try{const t=await fetch(`${this.ajaxUrlPrefix}.schedule.v2.json`,{body:i,headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},method:"POST"});if(!t.ok)throw new Error(t.statusText);this.renderConfirmation()}catch(t){throw this.log.error(`Request failed: ${t.message}`),this.renderError(),t}}renderConfirmation(){this.container=(0,d.r)(this.container,_.createElement("div",{className:"call-me-back-wizard call-request-time-summary-confirmed"},_.createElement("h2",{tabindex:"0","hook-insert":t=>{Y&&t.elm.focus()},"hook-update":t=>{Y&&t.elm.focus()},className:"sc-navy margin-bottom-1"},this.texts["summary-title-confirmed"]),_.createElement("p",null,this.texts["summary-confirmed-text"]),_.createElement("p",{className:"text-align-center"},_.createElement("img",{"attrs-src":"/etc/designs/swisscom/success_request.png","attrs-width":"142","attrs-height":"142","attrs-role":"presentation","attrs-aria-hidden":"true"})),_.createElement("div",{className:"card-holder"},_.createElement("sdx-card",{className:"margin-bottom-2"},_.createElement("h4",{className:""},this.texts["summary-subtitle"]),_.createElement("div",{className:"summary-report"},_.createElement("p",{className:"margin-bottom-2"},_.createElement("span",null,this.texts["summary-date"]),_.createElement("span",{className:"font--semi-bold"},new Date(this.selectedDate).toLocaleDateString(this.locale))),_.createElement("p",{className:"margin-bottom-2"},_.createElement("span",null,this.texts["summary-time"]),_.createElement("span",{className:"font--semi-bold"},this.selectedTime.split("T")[1].substring(0,5))),_.createElement("p",{className:"margin-bottom-2"},_.createElement("span",null,this.texts["summary-number"]),_.createElement("span",{className:"font--semi-bold"},this.numberToCall))))),_.createElement("sdx-button-group",{layout:"fullwidth"},_.createElement("sdx-button",{label:this.texts["summary-end"],disabled:"false","on-click":()=>{this.dialog.close()}}))))}validateNumbers(){return Array.from(this.container.elm.querySelectorAll("sdx-input")).map((t=>this.validateInput(t))).every(Boolean)}renderError(){this.dialog.notificationType="warning",this.dialog.iconName="icon-exclamation-mark-circle",this.dialog.label=this.texts["error-title"],this.container=(0,d.r)(this.container,_.createElement("div",{className:"call-me-back-wizard error"},_.createElement("p",{className:"text-align-center"},this.texts["error-msg"]),_.createElement("sdx-button-group",{layout:"fullwidth"},_.createElement("sdx-button",{label:this.texts.close,theme:"primary","on-click":()=>{this.dialog.close()}}))))}track(t,e="",i=!1){let a=`call_me_back_${this.ctx.dataset.routingTarget}`;e&&(a+=`_${e}`),i?(0,F.iQ)(t,a,this.trackLocation,this.trackCategory,"lead","callback",""):(0,F.L9)(t,a,this.trackLocation,this.trackCategory)}validateInput(t){return t.required&&!t.value||t.value&&!$(I(t.value))?(t.valid=!1,t.validationMessage=this.texts["incorrect-phone"]):(t.valid=!0,t.validationMessage=""),!!t.valid}}class X extends s.Y{constructor(){super(...arguments),this.trackingLocation="",this.trackingCategory=""}on(){this.trackingLocation=this.ctx.dataset.trackingLocation,this.trackingCategory=this.ctx.dataset.trackingCategory,this.trackingLocation&&this.trackingCategory&&this.addListeners()}addListeners(){this.ctx.querySelectorAll(".pagination-bullet").forEach((t=>{t.addEventListener("click",this.bulletClick.bind(this))})),this.ctx.querySelectorAll(".cmp-carousel__action").forEach((t=>{t.addEventListener("click",this.arrowClick.bind(this))}))}bulletClick(t){const e=(0,o.vs)(t.currentTarget.dataset.trackingLabel||"");this.track(e)}arrowClick(){setTimeout((()=>{const t=this.ctx.querySelector(".cmp-carousel__item--active"),e=(0,o.vs)(t.dataset.trackingLabel||"");this.track(e)}),200)}track(t){t&&(0,F.L9)("view",t,this.trackingLocation,this.trackingCategory)}}var Z,Q=i(9003);class tt extends s.Y{constructor(){super(...arguments),this.isOpen=!1}on(){this.el=this.ctx,this.isOpen=this.el.open}after(){this.ctx.addEventListener("click",this.track.bind(this))}track(){this.el.open!==this.isOpen&&(this.isOpen=this.el.open,(0,F.L9)(this.isOpen?"open":"close",this.ctx.dataset.trackingLabel,this.ctx.dataset.trackingLocation,this.ctx.dataset.trackingCategory))}}class et extends s.Y{async on(){this.topic=this.ctx.dataset.topic,this.subTopic=this.ctx.dataset.subTopic,this.lazy=this.ctx.hasAttribute("data-lazy");try{this.webChat=await function(){let t=2500,e=window.SCS;return e&&e.webchat?Promise.resolve(e.webchat):new Promise(((i,a)=>{const s=setInterval((()=>{e=window.SCS,e&&e.webchat?(clearInterval(s),i(e.webchat)):t>0||(clearInterval(s),a(new Error("window.SCS.webchat is not available after 2.5s"))),t-=50}),50)}))}(),this.lazy||this.setTopicAndSubtopic()}catch(t){this.log.error(t.message)}}onVisibilityChange(t){t&&this.lazy&&this.webChat&&this.setTopicAndSubtopic()}setTopicAndSubtopic(){this.topic?this.webChat.set("portal-contact:topic",this.topic):this.webChat.unset("portal-contact:topic"),this.subTopic?this.webChat.set("portal-contact:subtopic",this.subTopic):this.webChat.unset("portal-contact:subtopic")}}!function(t){t.normal="normal",t.hover="hover"}(Z||(Z={}));const it="show",at="dont-show";class st extends s.Y{constructor(){super(...arguments),this.visible=Z.normal}on(){this.normalContainer=this.ctx.querySelector(".normalDisplay"),this.hoverContainer=this.ctx.querySelector(".hoverDisplay");const t=this.ctx.querySelectorAll("img");Promise.all([].slice.call(t).map(r.g9)).then((()=>{this.initHeight(),this.ctx.classList.remove("initializing"),this.ctx.classList.contains("touch")&&matchMedia("(pointer: coarse)").matches&&this.attachListeners()})).catch((t=>this.log.error(t.message)))}initHeight(){const t=this.normalContainer.clientHeight,e=this.hoverContainer.clientHeight,i=Math.max(t,e);this.ctx.style.minHeight=`${i}px`}attachListeners(){this.ctx.addEventListener("click",(()=>this.toggleState()))}toggleState(){this.visible===Z.normal?(this.normalContainer.classList.add(at),this.normalContainer.classList.remove(it),this.hoverContainer.classList.remove(at),this.hoverContainer.classList.add(it),this.visible=Z.hover):(this.normalContainer.classList.remove(at),this.normalContainer.classList.add(it),this.hoverContainer.classList.add(at),this.hoverContainer.classList.remove(it),this.visible=Z.normal)}}var nt=i(655),ot=function(t){function e(e){var i=t.call(this,e)||this;return i._initialize(),i}return(0,nt.ZT)(e,t),e.prototype._initialize=function(){this.progressElement=this.find(".indicator")||this,this.fileNameElement=this.find(".detail > .name"),this.progressLabelElement=this.find(".progress"),this.totalProgressElement=this.find(".progress > .file-size")},Object.defineProperty(e.prototype,"progress",{get:function(){return this.value},set:function(t){var e=(100*t).toFixed(0);this.value=t,this.element.value=String(t),this.progressElement.setAttribute("style","width: ".concat(100*t,"%")),this.progressLabelElement&&(this.progressLabelElement.element.textContent="".concat(e,"%"))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"filename",{get:function(){if(this.fileNameElement)return this.fileNameElement.element.textContent||void 0},set:function(t){if(!this.fileNameElement)throw new Error("Cannot set the filename, missing detail element");this.fileNameElement.setHtml(t||"")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fileSize",{set:function(t){if(!this.totalProgressElement)throw new Error("Cannot set the fileSize, missing detail element");this.totalProgressElement.setHtml(t)},enumerable:!1,configurable:!0}),e}(i(7704).Z),rt=i(2419);class lt extends s.Y{on(){const t=new ot(this.ctx);t.progress=0;const e=parseInt(this.ctx.getAttribute("loader-duration")||"1",10),i=this.ctx.loadingAnimation=(0,rt.ih)({animator(e,i,a){t.progress=a},duration:e,endValue:1,startValue:0,callback(e){e||(t.progress=0)}});this.ctx.hasAttribute("data-autostart")&&i.start()}}let ct=null;class ht extends s.Y{on(){this.animationHolder=this.ctx.querySelector(".animation-holder"),null===ct&&(ct=async function(){return new Promise((t=>{const e=document.createElement("script");e.onload=t,e.src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.7.3/lottie_svg.min.js",e.crossOrigin="anonymous",e.integrity="sha512-E1gYB1OGBGeO9U77qWL/DEeFa0tm3jGFh9KbVBzDqL6oroMzDKS1xPhDffnU9AP88ndosrm0QXXHl7R+beNeRA==",document.head.appendChild(e)}))}()),ct.then(this.startLottieAnimation.bind(this)).catch((t=>this.log(t)))}startLottieAnimation(){if(!window.lottie)return;this.animation=window.lottie.loadAnimation({autoplay:!1,container:this.animationHolder,loop:!1,path:this.ctx.dataset.jsonPath,renderer:"svg"});const t=this.ctx.closest(".mod.modHoverContainer");if(t){const e=t.querySelector(".hoverDisplay"),i=t.querySelector(".normalDisplay");e.contains(this.ctx)?(e.addEventListener("mouseenter",(()=>this.animation.play())),e.addEventListener("mouseleave",(()=>this.animation.stop()))):i.contains(this.ctx)&&(i.addEventListener("mouseenter",(()=>this.animation.play())),i.addEventListener("mouseleave",(()=>this.animation.stop())))}else this.animationHolder.addEventListener("mouseenter",(()=>this.animation.play())),this.animationHolder.addEventListener("mouseleave",(()=>this.animation.stop()))}}var dt,ut=i(6691);function mt(t){const e={};for(const[i,a]of Object.entries(null!=t?t:{}))e[`attrs-${i}`]=a;return e}function pt({topic:t,subtopic:e,lazy:i,attrs:a}){const s=t||e?"mod modGenesysChat":"";return ut.createElement("div",{className:s,id:"mach3ChatLink","attrs-data-topic":t,"attrs-data-sub-topic":e,"attrs-data-lazy":i.toString(),...mt(a.tracking)})}function gt({url:t,label:e,attrs:i}){return ut.createElement("div",{className:"contact-channel"},ut.createElement("a",{"attrs-href":t,className:"icon-chevron-normal-right margin-xs-bottom-1 margin-md-bottom-0","attrs-data-sdx-lightbox-title":i.title,"attrs-data-sdx-lightbox-width":i.width,"attrs-data-sdx-lightbox-height":i.height,"attrs-target":i.lightbox?"sdxlightbox":void 0,...mt(i.tracking)},e))}function ft({title:t,introductionText:e,additionalText:i,channels:a}){return ut.createElement("div",{className:"contact-holder"},t&&ut.createElement("h4",{className:"sc-navy margin-bottom-3"},t),e&&ut.createElement("div",{className:"introduction-text margin-bottom-1",innerHTML:e}),ut.createElement("div",{className:"paragraph show-grid margin-0"},a.map((t=>{var e,i;return t.type===dt.chat?ut.createElement(pt,{topic:null!==(e=t.attrs.topic)&&void 0!==e?e:"",subtopic:null!==(i=t.attrs.subtopic)&&void 0!==i?i:"",lazy:"true"===t.attrs.lazy,attrs:t.attrs}):ut.createElement(gt,{url:t.url,label:t.label,attrs:t.attrs})}))),i&&ut.createElement("div",{className:"additional-text margin-top-1",innerHTML:i}))}function xt(t){return/^\d{2}\.\d{2}\.\d{4}$/.test(t)}function bt(t){const e=[],i=(new Date).getFullYear();for(const a of t){const t=a.split(" "),s=t.pop();t.forEach((t=>e.push(`${t}${xt(t)?"":i} ${s}`)))}return e}function vt(t){const e=[],i=(new Date).getFullYear();for(const a of t)a.split(" ").forEach((t=>e.push(`${t}${xt(t)?"":i} closed`)));return e}!function(t){t.sms="sms",t.abc="abc",t.chat="chat",t.whatsapp="wa"}(dt||(dt={}));class yt extends s.Y{constructor(){super(...arguments),this.isOnlyChat=!1}on(){var t,e,i,a,s,n,o,r,l;this.channels=JSON.parse(null!==(t=this.ctx.dataset.channels)&&void 0!==t?t:"[]");const c=function(){var t,e;const i=window.navigator&&window.navigator.userAgent||"",a=/\((Macintosh|iPhone|iPad|(?:iPod(?:\x20touch)?));.*\x20((?:\d[_.]{0,1})+)[^)]*\)\x20/i.exec(i);if(!a)return!1;const s="MACINTOSH"===(null===(t=a[1])||void 0===t?void 0:t.toUpperCase())?[10,13,4]:[11,3],n=null===(e=a[2])||void 0===e?void 0:e.split("_").map((t=>parseInt(t,10)));if(!s||!n)return!1;for(let t=0;s.length>t;t+=1){const e=n[t]||0;if(e!==s[t])return e>s[t]}return!0}()&&this.channels.some((t=>t.type===dt.abc));if(this.channels=c?this.channels.filter((t=>"true"!==t.attrs.hideIfAbc)):this.channels.filter((t=>t.type!==dt.abc)),this.isOnlyChat=!!this.channels.length&&this.channels.every((t=>t.type===dt.chat)),this.isOnlyChat)this.title=null!==(e=this.ctx.dataset.chatTitle)&&void 0!==e?e:"",this.intro=null!==(i=this.ctx.dataset.chatIntro)&&void 0!==i?i:"";else{const t=k({exceptionallyClosed:vt(JSON.parse(null!==(a=this.ctx.dataset.closed)&&void 0!==a?a:"[]")),exceptionallyOpen:bt(JSON.parse(null!==(s=this.ctx.dataset.exceptions)&&void 0!==s?s:"[]")),openhours:JSON.parse(null!==(n=this.ctx.dataset.open)&&void 0!==n?n:"[]")});this.channels=this.channels.filter((t=>{var e,i,a;return k({exceptionallyClosed:vt(null!==(e=t.attrs.closed)&&void 0!==e?e:[]),exceptionallyOpen:bt(null!==(i=t.attrs.exceptions)&&void 0!==i?i:[]),openhours:null!==(a=t.attrs.open)&&void 0!==a?a:[]})})),this.title=null!==(o=this.ctx.dataset.title)&&void 0!==o?o:"",this.intro=null!==(r=t?this.ctx.dataset.openIntro:this.ctx.dataset.closeIntro)&&void 0!==r?r:"",this.additionalText=null!==(l=t?this.ctx.dataset.openAdditional:this.ctx.dataset.closeAdditional)&&void 0!==l?l:""}this.channels.length&&this.render()}after(){if(this.isOnlyChat){const t=this.ctx.querySelector(".contact-holder");a.t.lazyBootstrap(t)}}render(){var t,e,i,a,s;t=this.ctx.querySelector(".contact-holder"),e=this.title,i=this.intro,a=this.additionalText,s=this.channels,(0,d.r)(t,ut.createElement(ft,{title:e,introductionText:i,additionalText:a,channels:s}))}}var Et=i(6356);function wt(){return"scrollY"in window?window.scrollY:window.pageYOffset}class Ct extends s.Y{on(){const t=screen.height-250;this.ctx.addEventListener("click",(()=>{(0,Et.G)(wt()+t)})),window.addEventListener("scroll",(()=>{this.timeout&&window.clearTimeout(this.timeout),this.timeout=window.setTimeout((()=>{window.innerHeight+wt()+400>document.body.clientHeight?this.ctx.classList.add("hidden"):this.ctx.classList.remove("hidden")}),100)}))}}var Tt=i(1582);class kt extends s.Y{async on(){const t=(await(0,Tt.Ai)()).getUser(),e=this.ctx.getElementsByTagName("scs-search-input")[0];t&&t.getSegment()&&(null==e||e.setAttribute("customer-segment",t.getSegment())),null==e||e.setAttribute("is-user-logged-in",`${!!t}`)}}class St extends s.Y{on(){const t=Array.from(this.ctx.querySelectorAll(".skip-link-search"));for(const e of t)e.style.display="none";let e=0;!function i(){const a=document.querySelector("scs-header-l1.hydrated");a?function(e){var i,a,s;const n=null===(i=null==e?void 0:e.shadowRoot)||void 0===i?void 0:i.querySelector("scs-secondary-navigation"),o=null===(a=null==n?void 0:n.shadowRoot)||void 0===a?void 0:a.querySelector("scs-search-input"),r=null===(s=null==o?void 0:o.shadowRoot)||void 0===s?void 0:s.querySelector("input[type=search]");for(const e of t)r&&(e.style.display="block",e.addEventListener("click",(()=>{r.focus()})))}(a):100>e++&&setTimeout(i,60)}()}}class Lt extends s.Y{on(){this.ctx.querySelectorAll("ul li a").forEach((t=>t.addEventListener("click",this.handleClick.bind(this))))}handleClick(t){const e=t.currentTarget,i=e.dataset.trackLabel;this.log("Service clicked",i),"copy-link"===i?(navigator.clipboard.writeText(e.dataset.url),e.innerHTML=e.dataset.copied):"print"===i&&window.print()}}class Nt extends s.Y{on(){this.ctx.addEventListener("click",(()=>{const t=new CustomEvent("placeholderClicked",{detail:{element:this.ctx,name:this.ctx.id}});document.dispatchEvent(t)})),r.Cd.then((()=>{const t=new CustomEvent("placeholderReady",{detail:{element:this.ctx,name:this.ctx.id}});document.dispatchEvent(t)})).catch((()=>this.log("Error")))}}class Dt extends s.Y{constructor(){super(...arguments),this.shouldEnhanceObject=!1}on(){var t,e;this.params=JSON.parse(null!==(t=this.ctx.dataset.params)&&void 0!==t?t:"{}"),this.extraHeaders=JSON.parse(null!==(e=this.ctx.dataset.headers)&&void 0!==e?e:"{}"),this.shouldEnhanceObject="true"===this.ctx.dataset.enhanceJson}after(){this.ctx.querySelectorAll("[href]").forEach((t=>{const e=t.getAttribute("href");this.params[e]&&t.addEventListener("click",this.convertExchangeId.bind(this))}))}async convertExchangeId(t){var e;t.preventDefault();const i=t.currentTarget.getAttribute("href");if(!i)return;let a=this.params[i];try{const t=null!==(e=a.exchangeUrl)&&void 0!==e?e:"/oce-api/soe/ubc/common/v1/input",i=a.requireLogin,s=a.targetUrl;this.shouldEnhanceObject&&(a=function(t){return t.businessTxId=(0,l.DO)(),t.correlationId=t.businessTxId,t.sessionId=(0,l.DO)(),t.returnUrl||(t.returnUrl=window.location.href),t.cancelUrl||(t.returnUrl=window.location.href),t}(a));const n=await fetch(t,{body:qt(a),headers:At(this.extraHeaders),method:"post"});if(!n.ok)throw new Error(`Request to ${t} returned NOK ${n.status} ${n.statusText}`);{let t=Ot((await n.json()).exchangeId,s);i&&!(await(0,Tt.Ai)()).getUser()&&(t="/scel/online/portal"+t),document.location.href=t}}catch(t){this.log.error("Failed to get exchange ID for",a,t)}}}function qt(t){return delete t.exchangeUrl,delete t.targetUrl,delete t.requireLogin,JSON.stringify(t)}function Ot(t,e){if(void 0===e)return`?exchangeId=${encodeURIComponent(t)}`;let[i,a,s]=(0,n.C$)(e);return void 0===a&&(a=new URLSearchParams),a.append("exchangeId",t),(0,n.pv)(i,a,s)}function At(t){const e={"Content-Type":"application/json","X-OCE-CLIENT":"aem-portal","oce-calling-system":"NG_PORTAL",...t},i=(0,l.ej)("OCE-XSRF-TOKEN");return i&&(e["X-OCE-XSRF-TOKEN"]=i),new Headers(e)}var Pt=i(3360);const $t=Object.create(null);function It(t){t.preventDefault()}const Ht={subscribe(t){t(void 0,this)},unsubscribe(t){}};class Mt extends s.Y{constructor(){super(...arguments),this.stoppers=[]}on(){var t;this.facts=(0,Pt.q_)(this.ctx),this.config=new Map;const e=JSON.parse(null!==(t=this.ctx.dataset.config)&&void 0!==t?t:"{}");for(const t in e)this.config.set(t,this.facts.query(e[t]))}after(){this.ctx.querySelectorAll("[href]").forEach((t=>{const e=t.getAttribute("href"),[i,a,s]=(0,n.C$)(e);(a||s||this.config.has(e))&&(t.addEventListener("click",It),this.config.has(e)?this.stoppers.push((0,Pt.tq)(this.config.get(e),(e=>{t.href=e,t.removeEventListener("click",It)}))):this.stoppers.push((0,Pt.tq)((0,Pt.$e)(this.register(a),this.register(s)),(function(){t.href=(0,n.pv)(i,a,s),t.removeEventListener("click",It)}))))}));const t=this.ctx.querySelector(":scope > .authorInfo > .debug");if(t){const e=Array.from(this.config.keys()),i=(0,Pt.$e)(...e.map((t=>(0,Pt.Wc)(this.config.get(t),$t))));this.stoppers.push((0,Pt.tq)(i,(i=>{t.innerHTML=i.map(((t,i)=>`<dt>${e[i]}</dt><dd>${t===$t?"<i>Not yet known</i>":String(t)}</dd>`)).join("")})))}}stop(){for(const t of this.stoppers)t()}register(t){const e={};null==t||t.forEach(((t,i)=>{this.config.has(t)&&(e[i]=this.config.get(t))}));const i=Object.keys(e);return i.length?(0,Pt.UI)((0,Pt.$e)(...i.map((t=>e[t]))),(e=>{for(let a=0;a<i.length;a++)t.set(i[a],String(e[a]))})):Ht}}a.t.register({Barcode:async()=>(await Promise.all([i.e(961),i.e(499)]).then(i.bind(i,15))).default,BrightcoveVideo:h,CallFromNet:j,CallMeBack:W,Carousel:X,CascadingTabs:async()=>(await i.e(667).then(i.bind(i,2509))).default,Countdown:Q.Z,ExpandAndCollapse:tt,GenesysChat:et,HeroCarousel:async()=>(await i.e(202).then(i.bind(i,3927))).default,HoverContainer:st,LoadingBar:lt,LottieAnimatedSVG:ht,MessagingChannels:yt,NewsletterTrigger:async()=>(await i.e(181).then(i.bind(i,226))).default,PinContainer:async()=>(await i.e(569).then(i.bind(i,6804))).default,ScrollingArrow:Ct,SearchInput:kt,SkipLinks:St,SocialTools:Lt,Teaser:Nt,UbcExchangeGenerator:Dt,UrlPlaceholders:Mt})},9003:function(t,e,i){i.d(e,{Z:function(){return h}});var a=i(5823);const s={s:t=>t.seconds,m:t=>t.minutes,h:t=>t.hours,d:t=>t.days};function n(t){return e=>{const i=String(s[t](e));return 2>i.length?`0${i}`:i}}for(const t in s)s[`${t}${t}`]=n(t);const o=[];function r(){const t=Date.now();for(const e of o)e.update(t);requestAnimationFrame(r)}function l(t){var e;const[i,a]=(null!==(e=t.textContent)&&void 0!==e?e:"").split(/\|/);if(a&&i!==a)return e=>{t.textContent=1===e?a:i}}function c(t){return e=>{t.textContent=String(e)}}class h extends a.Y{constructor(){super(...arguments),this.ended=!1,this.formatters=[]}on(){this.end=parseInt(this.ctx.dataset.end||"0",10);for(const t of this.ctx.querySelectorAll("*")){if(t.children.length)continue;const e=t.dataset.labelFor,i=e||t.textContent||"",a=s[i];if(!a)continue;const n=e?l(t):c(t);if(!n)continue;let o=i;this.formatters.push((t=>{const e=a(t);e!==o&&(n(e),o=e)}))}}after(){o.push(this),1===o.length&&r()}stop(){o.splice(o.indexOf(this),1)}update(t){if(this.ended)return;let e=this.end-t;0>e&&(this.ended=!0,e=0);const i=function(t){const e={days:0,hours:0,minutes:0,seconds:0};return e.seconds=Math.ceil(t/1e3),e.minutes=Math.floor(e.seconds/60),e.seconds%=60,e.hours=Math.floor(e.minutes/60),e.minutes%=60,e.days=Math.floor(e.hours/24),e.hours%=24,e}(e);for(const t of this.formatters)t(i)}}},5741:function(t,e,i){function a(t,...e){return(t||"").replace(/\{(\d+)\}/g,((t,i)=>{const a=e[parseInt(i,10)];return String(null!=a?a:"")}))}function s(t,e,i="",a=3){return t&&t.length>e+a&&(t=t.substr(0,e).replace(/\s+[^\s.]+$/,"").replace(/\s*[(:;,_-]?\s*$/,""),/\.$/.test(t)||(t+=i||"")),t}function n(t){const e=document.createElement("div");return e.innerHTML=t,e.textContent}function o(t){if(!t)return"-";const e=[[//gi,"ss"],[//gi,"a"],[//gi,"a"],[//gi,"ae"],[//gi,"c"],[//gi,"e"],[//gi,"e"],[//gi,"e"],[//gi,"e"],[//gi,"i"],[//gi,"i"],[//gi,"i"],[//gi,"i"],[//gi,"o"],[//gi,"o"],[//gi,"o"],[//gi,"oe"],[//gi,"u"],[//gi,"u"],[//gi,"u"],[//gi,"ue"],[/[^a-z0-9_\\-]/gi,"-"]];for(const[i,a]of e)t=t.replace(i,a);return t}function r(t){return t.normalize("NFD").replace(/\p{Diacritic}|\t|\n/gu,"").replace(/\s/gu,"-").toLowerCase()}i.d(e,{$G:function(){return s},Uu:function(){return o},WU:function(){return a},vO:function(){return n},vs:function(){return r}})},3467:function(t,e,i){i.d(e,{i:function(){return n}});var a=i(7234),s=i(6691);function n({icon:t="information-circle",direction:e="top-left",width:i="300px",iconSize:n=2},o){if(!o||!o.filter(Boolean).length)return;const r="string"==typeof i?i:`${i}px`;return s.createElement("sdx-menu-flyout",{"attrs-direction":e},s.createElement("sdx-menu-flyout-toggle",null,s.createElement(a._,{iconName:t,size:n})),s.createElement("sdx-menu-flyout-content",{"style-width":r},s.createElement("p",null,o)))}},7234:function(t,e,i){i.d(e,{_:function(){return s}});var a=i(6691);function s({render:t,iconName:e,srHint:i,size:s,...n}){if(!1!==t)return/^icon-/.test(e)||(e=`icon-${e}`),a.createElement("sdx-icon",{"attrs-icon-name":e,"attrs-size":s,"attrs-sr-hint":i||"","attrs-title":i,...n})}}},function(t){t.O(0,[565,724,467,455,392,810],(function(){return t(t.s=1302)})),t.O()}]);
//# sourceMappingURL=greenfield.53e73317ae8edbfd14df.js.map