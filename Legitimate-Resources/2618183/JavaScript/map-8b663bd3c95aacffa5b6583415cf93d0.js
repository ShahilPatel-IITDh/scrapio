fourSq.map.markers.PinConstants={DefaultPinSize:new L.Point(44,55),DefaultPinAnchor:new L.Point(22,53),SquarePinSize:new L.Point(44,53),SquarePinAnchor:new L.Point(16,47),CategoryPinSize:new L.Point(32,32),CategoryPinAnchor:new L.Point(16,47)};fourSq.map.markers.defaultPin_={};
(function(){var a={red:"https://ss1.4sqi.net/img/pin-red-transparent-5f47fc00e7bf13dca44f38fdf3545840.png",orange:"https://ss1.4sqi.net/img/pin-orange-transparent-bad20d0bf67b74bbfeb826a1174627bd.png",green:"https://ss1.4sqi.net/img/pin-green-transparent-1f0b88962835594a28fb54b006e24930.png",blue:"https://ss1.4sqi.net/img/pin-blue-transparent-1b136e62c0796ad9247f790a9ef7623b.png","white-round":"https://ss1.4sqi.net/img/pin-white-round-transparent-c7c075f6edfbc45d618cbd587c1cde0e.png"};_(_.keys(a)).each(function(b){var c=
L.Icon.extend({options:{iconUrl:a[b],iconSize:fourSq.map.markers.PinConstants.DefaultPinSize,iconAnchor:fourSq.map.markers.PinConstants.DefaultPinAnchor,shadowUrl:null}});fourSq.map.markers.defaultPin_[b]=c})})();fourSq.map.markers.categoryMarkerImages_=fourSq.map.markers.categoryMarkerImages_||{};fourSq.map.markers.getPinMarkerImage=function(a){return new (fourSq.map.markers.defaultPin_[a]||fourSq.map.markers.defaultPin_.blue)};
fourSq.map.markers.getCategoryMarkerImage=function(a){if(!fourSq.map.markers.categoryMarkerImages_[a]){var b=L.Icon.extend({options:{iconUrl:a,iconSize:fourSq.map.markers.PinConstants.CategoryPinSize,iconAnchor:fourSq.map.markers.PinConstants.CategoryPinAnchor,shadowUrl:null}});fourSq.map.markers.categoryMarkerImages_[a]=b}return new fourSq.map.markers.categoryMarkerImages_[a]};fourSq.map.Pin=function(a,b){};
fourSq.map.Pin=fourSq.ui.View.extend({tooltipPositioning:"belowcenter",initialize:function(a){this.map=a.map;this.mapView=a.mapView;this.mapCanvas=$(this.map._container);this.lat=a.lat;this.lng=a.lng;this.point=new L.LatLng(this.lat,this.lng);this.zIndexOffset=this.zIndex=a.zIndex||1;void 0!==a.shape&&(this.shape=a.shape);a.tooltipContent&&(this.tooltipContent=a.tooltipContent);a.tooltipContainer&&(this.tooltipContainer=a.tooltipContainer);a.tooltipPositioning&&(this.tooltipPositioning=a.tooltipPositioning);
void 0!==a.disableTooltipAutopan&&(this.disableTooltipAutopan=a.disableTooltipAutopan);a.pinSize&&(this.pinSize=a.pinSize);this.tooltipIsShown_=this.tooltipIsSelected_=!1;this.tooltip=null;a.pinMarkerImage&&(this.pinMarkerImage=a.pinMarkerImage);a.mainMarkerImage&&(this.mainMarkerImage=a.mainMarkerImage);this.mainMarker_=this.generateMainMarker();this.pinMarker_=this.generatePinMarker();this.pinMarker_.on("click",this.click,this);fourSq.util.devices.isTouchIncludingIPad()||(this.pinMarker_.on("mouseover",
this.mouseover,this),this.pinMarker_.on("mouseout",this.mouseout,this))},generateMainMarker:function(){var a=new L.Marker(this.point,{icon:this.mainMarkerImage,zIndexOffset:this.zIndexOffset});this.map.addLayer(a);this.zIndex=this.originalZIndex=parseInt(a._icon.style.zIndex,10);return a},generatePinMarker:function(){var a=new L.Marker(this.point,{icon:this.pinMarkerImage,zIndexOffset:this.zIndexOffset});this.map.addLayer(a);return a},generateTooltip:function(){if(this.tooltipContent&&this.tooltipContainer&&
!this.tooltipIsShown_){this.tooltipGenerated_||(this.tooltipContent.detach(),this.tooltipContainer.append(this.tooltipContent),this.boxWidth=this.tooltipContent.outerWidth(),this.boxHeight=this.tooltipContent.outerHeight(),this.tooltipContent.detach());this.tooltipGenerated_=!0;var a;this.tooltipPositioning&&"belowcenter"===this.tooltipPositioning?a=new L.Point(this.boxWidth/2*-1,0):(a=this.tooltipPositioning&&"quadrant"===this.tooltipPositioning?this.calculateQuadrantTooltipPosition_():this.calculateSideInBoundsTooltipPosition_(),
a=new L.Point(a.horizontal,a.vertical));a=new L.Popup({closeButton:!1,offset:a});a.setLatLng(new L.LatLng(this.lat,this.lng));var b=null;this.tooltipContent.get(0)&&this.tooltipContent.get(0).outerHTML?b=this.tooltipContent.get(0).outerHTML:(b=$("\x3cdiv\x3e"),b.append(this.tooltipContent),b=b.html(),this.tooltipContent.detach());a.setContent(b);return this.tooltip=a}},mapMetrics_:function(){Math.pow(2,this.map.getZoom());var a=this.map.getBounds(),a=new L.LatLng(a.getNorthEast().lat,a.getSouthWest().lng),
a=this.map.latLngToLayerPoint(a),b=this.map.latLngToLayerPoint(this.mainMarker_.getLatLng()),a=new L.Point(Math.floor(b.x-a.x),Math.floor(b.y-a.y)),b={width:this.mapCanvas.width(),height:this.mapCanvas.height()};return{markerPos:{x:a.x,y:a.y},mapSize:b,mapCenter:{x:b.width/2,y:b.height/2}}},calculateQuadrant:function(a){var b=!1,c=!1;a=a||this.mapMetrics_();b=a.markerPos.x<a.mapCenter.x;c=a.markerPos.y<a.mapCenter.y;return{left:b,top:c}},calculateQuadrantTooltipPosition_:function(){var a=this.calculateQuadrant(),
b={};b.vertical=a.top?-1-this.pinSize.height:-1-this.boxHeight;b.horizontal=a.left?5+this.pinSize.width/2:-5-this.boxWidth-this.pinSize.width/2;return b},calculateSideInBoundsTooltipPosition_:function(){var a=this.mapMetrics_(),a=this.calculateQuadrant(a),b={};b.vertical=(this.boxHeight-this.pinSize.height)/2-3;b.horizontal=a.left?5+this.boxWidth/2+this.pinSize.width/2:-5-this.boxWidth/2-this.pinSize.width/2;return b},updatePosition:function(a){this.point=a;this.mainMarker_.setLatLng(a);this.pinMarker_.setLatLng(a);
this.lat=a.lat;this.lng=a.lng},setPosition:function(a){this.updatePosition(a)},getPosition:function(){return this.point},showTooltip:function(){this.generateTooltip();this.tooltipIsShown_=!0;this.map.addLayer(this.tooltip)},hideTooltip:function(){this.tooltipIsShown_&&this.map.removeLayer(this.tooltip);this.setPinImage(this.pinMarkerImage);this.setZIndex(this.zIndex);this.tooltipIsSelected_=this.tooltipIsShown_=!1},tooltipIsShown:function(){return this.tooltipIsShown_},setPinImage:function(a){this.pinMarker_.setIcon(a);
this.setZIndex(this.zIndex)},setZIndex:function(a){!fourSq.isUndefinedOrNull(a)&&this.mainMarker_._icon&&this.pinMarker_._icon&&(this.zIndex=a,a+=this.zIndexOffset,this.mainMarker_._icon.style.zIndex=a,this.pinMarker_._icon.style.zIndex=a)},remove:function(){this.hideTooltip();this.map.removeLayer(this.pinMarker_);this.map.removeLayer(this.mainMarker_);$(this.el).remove();return this},bounceOnce:function(){var a=function(a){var c=a._icon,d=parseInt(c.style.marginTop,10);return function(a){c.style.marginTop=
d-a+"px"}};(function(a){var c={property:0},d={property:15},e=function(c){_(a).each(function(a){a(c)})},f=function(a,b,c,d){$(a).animate(b,{duration:250,easing:c,step:e,complete:d})};f(_.extend({},c),_.extend({},d),void 0,function(){f(d,c,"linear",function(){})})})([a(this.mainMarker_),a(this.pinMarker_)])},mouseover:function(){},mouseout:function(){},click:function(){}});fourSq.views.HomepagePin=function(a,b){};
fourSq.views.HomepagePin=fourSq.map.Pin.extend({initialize:function(a){var b=a.square?"https://ss0.4sqi.net/img/pin-white-transparent-212f0e4d45954fd42b85ca619365e0a8.png":"https://ss1.4sqi.net/img/pin-blue-transparent-1b136e62c0796ad9247f790a9ef7623b.png";a.pinImage&&(b=a.pinImage);var c=a.square?{width:40,height:53}:{width:44,height:55},d=a.square?new L.Point(20,51):new L.Point(22,53);a.pinMarkerImage=this.generatePinMarkerImage_(b,d,c);b=a.img;d=new L.Point(16,47);a.mainMarkerImage=this.generateMainMarkerImage_(b,
d,{width:32,height:32});b={coord:[37,2,38,3,39,4,40,5,41,6,41,7,41,8,41,9,41,10,41,11,41,12,41,13,41,14,41,15,41,16,41,17,41,18,41,19,41,20,41,21,41,22,41,23,41,24,41,25,41,26,41,27,41,28,41,29,41,30,41,31,41,32,41,33,41,34,41,35,41,36,41,37,40,38,39,39,38,40,37,41,27,42,26,43,25,44,24,45,23,46,20,46,19,45,18,44,17,43,16,42,6,41,5,40,4,39,3,38,2,37,2,36,2,35,2,34,2,33,2,32,2,31,2,30,2,29,2,28,2,27,2,26,2,25,2,24,2,23,2,22,2,21,2,20,2,19,2,18,2,17,2,16,2,15,2,14,2,13,2,12,2,11,2,10,2,9,2,8,2,7,2,6,
3,5,4,4,5,3,6,2,37,2],type:"poly"};d={coord:[35,2,36,3,37,4,37,5,37,6,37,7,37,8,37,9,37,10,37,11,37,12,37,13,37,14,37,15,37,16,37,17,37,18,37,19,37,20,37,21,37,22,37,23,37,24,37,25,37,26,37,27,37,28,37,29,37,30,37,31,37,32,37,33,37,34,37,35,36,36,35,37,25,38,24,39,23,40,22,41,21,42,18,42,17,41,16,40,15,39,14,38,4,37,3,36,2,35,2,34,2,33,2,32,2,31,2,30,2,29,2,28,2,27,2,26,2,25,2,24,2,23,2,22,2,21,2,20,2,19,2,18,2,17,2,16,2,15,2,14,2,13,2,12,2,11,2,10,2,9,2,8,2,7,2,6,2,5,2,4,3,3,4,2,35,2],type:"poly"};
a.shape=a.square?d:b;a.pinSize={width:c.width,height:c.height};a.tooltipContent=$(a.message);a.tooltipContainer=$("#justificationContainer");a.disableTooltipAutopan=!0;a.tooltipPositioning="sideCentered";this.square=a.square;this.url=a.url;fourSq.map.Pin.prototype.initialize.call(this,a)},generateMainMarkerImage_:function(a,b,c){return new (L.Icon.extend({options:{iconUrl:a,iconSize:new L.Point(c.width,c.height),iconAnchor:b,shadowUrl:null}}))},generatePinMarkerImage_:function(a,b,c){return new (L.Icon.extend({options:{iconUrl:a,
iconSize:new L.Point(c.width,c.height),iconAnchor:b,shadowUrl:null}}))},mouseover:function(){this.setZIndex(2E3);this.showTooltip()},mouseout:function(){this.setZIndex(this.originalZIndex);this.hideTooltip()},click:function(){fourSq.util.redirect(this.url)}});