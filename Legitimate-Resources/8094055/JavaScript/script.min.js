function Autocomplete(){this.o={id:null,el:null,isIE8:$("html").hasClass("ie8"),namespace:"autocomplete",isVisible:!1,isEnabled:!1,inFocus:!1,canSubmitForm:!0,apiUrl:"/api",limit:10,currentValue:"",allSuggestions:[],topSuggestion:"",maxTopSuggestionLength:30},this.init=function(options){_.extend(this.o,options),this.$input=$(this.o.el),this.$form=this.$input.closest("form"),this.createElements(),this.setup(),this.events()}}function setupNavigation(){var timer;$(".resetPage").on("click",function(e){e.preventDefault(),Config.squeezePage?window.location="/":$("body, html").animate({scrollTop:whenMenuSnaps},500,function(e){timer&&clearTimeout(timer),timer=setTimeout(function(){$(".offer-title").addClass("hidden"),resetPage(),getPage(),hideModal("up")},1)})}),$("body").on("click","[data-tag]",function(e){e.preventDefault();var term=$.trim($(this).data("tag"));term&&("malls"===$(this).parents(".open").attr("id")?doSearch(term):doTagSearch(term),hideModal("up"))}).on("click",".showMyBoard",function(e){e.preventDefault(),doBoardSearch()}).on("click",".login",function(e){e.preventDefault(),showLoginModal("Login to HSBC Smart Privileges")})}function setupWindowScrollBehavior(){var $window=$(window),$document=$(document),$mainNav=$("#mainNav"),$navbarBrand=$(".navbar-brand");$window.on("resize",function(){clearTimeout(doit),doit=setTimeout(function(){resizeContent(),setTimeout(function(){sortTilesToFitScreen()},300)},300)}).on("scroll",function(){$window.scrollTop()<whenMenuSnaps?barSnapped===!0&&($mainNav.css({position:"absolute",top:whenMenuSnaps}),$navbarBrand.stop().animate({width:"0px"},300),barSnapped=!1,$("#mainNavTop").stop().animate({top:"-30px"},300)):barSnapped===!1&&($mainNav.css({position:"fixed",top:"0"}),$navbarBrand.stop().animate({width:"266px"},500),barSnapped=!0,$("#mainNavTop").stop().animate({top:"0px"},100))}).smartscroll(function(){$window.scrollTop()>=$document.height()-$window.height()-100&&getPage()})}function setupWidgets(){$("[data-widget]").each(function(){var $this=$(this),options=strgToObj($this.data("widget"));options.el=this,"autocomplete"===options.type&&(Widget.autocomplete[options.id]=new Autocomplete).init(_.omit(options,"type"))})}function enableSearchFunctionality(){$("#for-search").on("click",function(e){e.preventDefault(),sendTrackingCode("Site","Click","Search");var timer;$("body, html").animate({scrollTop:$("#mainContainer").offset().top},400,function(){timer&&clearTimeout(timer),timer=setTimeout(function(){sform.show("fade")},1)})}),sform={o:{isVisible:!1},init:function(){sform.$el=$("#searchForm"),sform.$input=sform.$el.find(".search-input"),sform.events(),"pratheep"===Config.misc.user},events:function(){sform.$el.on("click",".search-close",function(){sform.hide("fade")}),sform.$el.on("submit","form",function(e){e.preventDefault();var val=$.trim(sform.$input.val());sendTrackingCode("Site","Search",val),doSearch(val),sform.hide()}),$(window).on("keyup",function(e){e.keyCode===keyboard.escape&&sform.hide()})},show:function(animation){sform.o.isVisible=!0,"fade"===animation?sform.$el.fadeIn():sform.$el.show(),Widget.autocomplete.searchForm.focusInput()},hide:function(animation){sform.o.isVisible=!1,"fade"===animation?sform.$el.fadeOut():sform.$el.hide(),Widget.autocomplete.searchForm.reset()}},sform.init()}function bindGlobalKeys(){$(document).keydown(function(e){if(!isModalHidden)switch(e.keyCode){case 39:$("#next").trigger("click");break;case 37:$("#back").trigger("click");break;case 27:hideModal("up")}})}function resetPage(){currentPageInViewPrevious=currentPageInView,currentPageInView=0,pageTypePrevious=pageType,pageType="list",mightHaveMoreResults=!0}function doSearch(searchTerm,options){resetPage(),pageType="search","undefined"!=typeof options&&"undefined"!=typeof options.pageType&&(pageType=options.pageType),keywords=searchTerm;var timer=null;$(".offer-title").find(".term").text(searchTerm).end().removeClass("hidden"),$("body, html").animate({scrollTop:whenMenuSnaps},300,function(e){timer&&clearTimeout(timer),timer=setTimeout(function(){getPage(),hideModal("up")},1)})}function doBoardSearch(){doSearch("My Board",{pageType:"myboard"})}function doTagSearch(tagName){doSearch(tagName,{pageType:"tag"})}function getPage(){if(!busy&&mightHaveMoreResults){switch($("#offers-loading-bar").show(),isIE8&&window.scrollBy(0,1),currentPageInView++,pageType){case"list":url="/api/offers/page/"+encodeURIComponent(currentPageInView),sendTrackingCode("Page","Main",currentPageInView);break;case"search":url="/api/offers/search/"+encodeURIComponent(keywords)+"/page/"+encodeURIComponent(currentPageInView),sendTrackingCode("Page","Search",currentPageInView);break;case"myboard":url="/api/offers/myboard/page/"+encodeURIComponent(currentPageInView),sendTrackingCode("Page","MyBoard",currentPageInView);break;case"tag":url="/api/offers/tags/"+encodeURIComponent(keywords)+"/page/"+encodeURIComponent(currentPageInView),sendTrackingCode("Page","Tag",currentPageInView)}var addDisplayed=!0;busy=!0,$.ajax({url:url,type:"GET",datatype:"JSON",context:this,success:function(data){1==currentPageInView&&$("#content .offers").html(""),$("#offers-loading-bar").hide();var html="";0===data.offers.length?(mightHaveMoreResults=!1,busy=!1,currentPageInView--,mightHaveMoreResults===!1&&0===currentPageInView&&(html=noOfferTemplate({keywords:keywords}),$("#content .offers").html(html),$(".offer-title").addClass("hidden"))):(null!==data.campaign&&(addDisplayed=!1),_.each(data.offers,function(item){item.img=item.body.thumbnail.paths[item.size],item.imgOtherSizes={large:item.body.thumbnail.paths.large,mid:item.body.thumbnail.paths.mid,small:item.body.thumbnail.paths.small},item.width=Config.sizes[item.size].width,item.height=Config.sizes[item.size].height,item._class=item.size,item.body.tags.match(/mim/)&&(item._class+=" mim"),item.DaysLeft=new Date(item.end).getTime(),item.tileSize=item.size,item.gotAddress=_.keys(item.body.addresses).length>0,html+=tileTemplate(item),!addDisplayed&&80<100*Math.random(10)&&(html+=addAdsToOffers(data.campaign),addDisplayed=!0)}),$(html).appendTo("#content .offers"),sortTilesToFitScreen(),busy=!1,$("#content .hide").removeClass("hide"),$(".floating-btn").removeClass("hidden"),Waypoint.refreshAll(),_.isEmpty(selectedBox)||(selectedBoxNext=$(selectedBox).next(),isModalHidden||floatingArrows("next","show")))},error:function(jqXHR){currentPageInView=currentPageInViewPrevious,pageType=pageTypePrevious,mightHaveMoreResults=!0,handleGetPageError(jqXHR.responseJSON?jqXHR.responseJSON.error:"networError"),busy=!1}})}}function addAdsToOffers(campaign){return crossOfferTemplate({id:campaign._id,link:campaign.link,campaign:{desktop:campaign.file.paths.desktop,mobile:campaign.file.paths.mobile}})}function showEmptyResults(){$("#content .offers").html('<div class="no-results"><h1>No Results Found.</h1></div>')}function resizeContent(){$("#mainNav").removeClass("hidden");var imageHeight=0,maxDeviceHeight=$("#header").height()-100;maxDeviceHeight<600&&(maxDeviceHeight=600),$(window).height()<maxDeviceHeight?$("#header").css("position","relative"):$("#header").css("position","fixed"),imageHeight=$("#banner .active img").height(),null===imageHeight&&(imageHeight=0),whenMenuSnaps=imageHeight+48,$(".banner").css("height",imageHeight),$(".header").css("height",whenMenuSnaps),$(window).height()<maxDeviceHeight?$("#mainContainer").css("top",0):$("#mainContainer").css("top",whenMenuSnaps),"absolute"===$("#mainNav").css("position")?$("#mainNav").css("top",whenMenuSnaps):$("#mainNav").css("top",0),mainPage=!0,mobile=!1,mainPage&&(mobile?(theMinWidth=1,theMaxWidth=3):(theMinWidth=1,theMaxWidth=7),containerMaxTiles=Math.min(Math.max(Math.floor($(window).width()/tileWidthWithMargin),theMinWidth),theMaxWidth),$("#content").css("width",containerMaxTiles*tileWidthWithMargin+"px"),mobile&&($("#mobileCats").css("width",containerMaxTiles*tileWidthWithMargin+"px"),1==containerMaxTiles?$("#mobileCats a").css({width:"50%"}):$("#mobileCats a").css({width:"25%"})))}function sortTilesToFitScreen(){containerMaxTiles<4?containerMaxTiles<2?(_.each($(".tileHolder.large img, .tileHolder.mid img"),function(img){$(img).attr("src",$(img).data("small"))}),$(".tileHolder.large, .tileHolder.mid").attr("tile-size","small").removeClass("large").removeClass("mid").addClass("small")):(_.each($(".tileHolder.large img"),function(img){$(img).attr("src",$(img).data("mid"))}),$(".tileHolder.large").attr("tile-size","mid").removeClass("large").addClass("wasLarge")):($(".visualHolder").removeClass("hidden"),_.each($(".tileHolder.wasLarge img"),function(img){$(img).attr("src",$(img).data("large"))}),$(".tileHolder.wasLarge").attr("tile-size","large").removeClass("wasLarge").addClass("large")),containerMaxTiles<4?($(".tileHolderX.crossOffer, .tileHolderX.crossForm").attr("tile-size","small").removeClass("large").addClass("small").removeClass("wasLarge").removeClass("mid"),_.each($(".tileHolderX.crossOffer img, .tileHolderX.crossForm img"),function(img){$(img).attr("src",$(img).data("mobile"))})):($(".tileHolderX.crossOffer, .tileHolderX.crossForm").attr("tile-size","large").removeClass("small").addClass("large").removeClass("wasLarge").removeClass("mid"),_.each($(".tileHolderX.crossOffer img, .tileHolderX.crossForm img"),function(img){$(img).attr("src",$(img).data("desktop"))}));for(var sizes={small:1,mid:2,large:4},tiles=$(".tileHolder, .tileHolderX"),loopNumber=0,x=0;x<tiles.length;x++){var tileSize=sizes[$(tiles[x]).attr("tile-size")];if(1!=tileSize&&loopNumber+tileSize>containerMaxTiles)for(y=x+1;y<tiles.length;y++)if(swapTileSize=sizes[$(tiles[y]).attr("tile-size")],loopNumber+swapTileSize<=containerMaxTiles){$(tiles[x]).swapWith($(tiles[y])),tileSize=swapTileSize,tiles=$(".tileHolder, .tileHolderX");break}loopNumber+=tileSize,loopNumber>=containerMaxTiles&&(loopNumber=0)}}function reactToTileClick(e){if($this=$(this).parents(".tileHolder"),!$this.hasClass("crossOffer")&&!$this.hasClass("crossOffer")&&(e.preventDefault(),!$this.hasClass("no-modal"))){var newSelectBox="#"+$this.attr("id");$(".selected").removeClass("selected"),selectedBox=newSelectBox,selectedBoxNext=$this.next(".tileHolder"),selectedBoxPrev=$this.prev(".tileHolder"),0===selectedBoxNext.length&&(selectedBoxNext=$this.next().next()),0===selectedBoxPrev.length&&(selectedBoxPrev=$this.prev().prev()),$this.addClass("selected"),0===selectedBoxNext.length&&getPage(),$(this).hasClass("crossOffer")||$(this).hasClass("crossForm")?(hideAnimationInProgress=!1,"next"==lastDirection?$("#next").trigger("click"):$("#back").trigger("click")):$.ajax({url:"/api/offers/"+$this.attr("id"),context:this,success:function(data){var output=bigBoxTemplate({id:data._id,offer_summary:data.body.name,brand_name:data.body.brand.name,body_content:data.body.body,body_tags:data.body.tags.split(", "),main_image:data.body.thumbnail.paths.slider_main,slider_images:data.body.images,body_terms:data.body.terms,fav:data.fav,gotLocation:data.body.addresses.length>0,start:data.body.start,end:data.body.end});showModal(output)},error:function(jqXHR){hideAnimationInProgress=!1,hideModal("up"),handleGetPageError("networError")}}),sendTrackingCode("Tiles","Open",$this.find(".brand").text()+" > "+$this.find(".summary").text())}}function setupModalAnimation(){$modal.on("scroll",function(){containerMaxTiles>1&&($modal.scrollTop()-.8*$modalWrapper.height()-1e3>=0&&hideModal("up"),$modal.scrollTop()<.3*$modalWrapper.height()&&hideModal("down"))}).on("click",".close",function(e){e.preventDefault(),hideModal("up")}).on("click",".showOffer",function(e){e.preventDefault(),showModalScreen("content"),$(".showTnc","#actions").removeClass("active"),$(this).addClass("active")}).on("click",".showTnc",function(e){e.preventDefault(),showModalScreen("tnc"),$(".showOffer","#actions").removeClass("active"),$(this).addClass("active")}).on("click",".showImage",function(e){e.preventDefault(),showModalScreen("image"),$(".showLocations","#actions").removeClass("active"),$(this).addClass("active")}).on("click",".showLocations",function(e){e.preventDefault(),$("#mapDetailsHolder").html("&nbsp;"),showModalScreen("map"),googleDefined||$.ajax("/api/offers/"+$(selectedBox).attr("id")+"/addresses",{context:this}).done(function(data){addResultsToMap(data)}),$(".showImage","#actions").removeClass("active"),$(this).addClass("active")}),$("#wrapper, .pushers").on("click",function(e){!hideAnimationInProgress&&$(this).is(e.target)&&$("#modal .close").trigger("click")}),$("#next, #back").on("click",function(e){if(e.preventDefault(),!hideAnimationInProgress){var $this=$(this);lastDirection=$this.attr("id");var modifier="next"!=$this.attr("id")?1:-1,$toClick=modifier>0?selectedBoxPrev:selectedBoxNext;sendTrackingCode("Tiles","Slider",$this.attr("id")),0!==$toClick.length&&(hideAnimationInProgress=!0,$modalWrapper.animate({left:modifier*(2*$modalWrapper.width())},400,"swing",function(){$modalWrapper.css({left:-1*modifier*(2*$modalWrapper.width())}),$toClick.find(".brand").trigger("click")}))}})}function sendTrackingCode(category,action,opt_label){var keyTrack=category+" - "+action+" - "+opt_label,currentSearchTerm="";_.isEmpty(keywords)||(currentSearchTerm=keywords+"/"),Config.googleAnalytics.simulate&&("Page"===category?console.log("Page: /"+action+"/"+currentSearchTerm+opt_label):console.log("Event: "+keyTrack)),Config.googleAnalytics.enabled&&lastTrack!=keyTrack&&(lastTrack=category+action+opt_label,"Page"===category?ga("send","pageview","/"+action+"/"+currentSearchTerm+opt_label):ga("send","event",category,action,opt_label))}function capitaliseFirstLetter(string){return string.charAt(0).toUpperCase()+string.slice(1)}function showModalScreen(_screen){$("#modal"+capitaliseFirstLetter(_screen));if(!$(this).hasClass("active")){switch(_screen){case"content":$("#modalTnc").hide(),$("#modalContent").show();break;case"tnc":$("#modalContent").hide(),$("#modalTnc").show();break;case"image":$("#modalMap").hide(),$("#modalImage").show(),$("#imageThumbs").show();break;case"map":$("#modalImage").hide(),$("#imageThumbs").hide(),$("#modalMap").show(),sendTrackingCode("Tiles","Map Open",$("#modalContents h1").text())}return!0}}function showModal(contents){isModalHidden=!1,_.isUndefined(contents)||$modalContent.html(contents),"0px"==$modalWrapper.css("left")&&$modalWrapper.css({top:$(window).height()}),hideAnimationInProgress=!1,resizeModal(),$modal.show().scrollTop(900),containerMaxTiles>1?($(".pushers, .scroll-more").removeClass("hide"),$modalWrapper.animate({top:0,left:0},300,showFloatingArrows)):($(".pushers, .scroll-more").addClass("hide"),$modalWrapper.css({top:0,left:0}),showFloatingArrows()),showModalScreen("image"),showModalScreen("content"),$body.css({overflow:"hidden"})}function hideModal(_direction){if(!hideAnimationInProgress){var modifier=1;isModalHidden=!0,"up"==_direction&&(modifier=-1),containerMaxTiles>1?(hideAnimationInProgress=!0,mouseWheel.disableScroll(),$modalWrapper.animate({top:modifier*(2*$modalWrapper.height())},400,"swing",function(){hideFloatingArrows(),$modal.fadeOut("fast"),$body.css({overflow:"visible"}),setTimeout(function(){mouseWheel.enableScroll()},600)})):$modal.fadeOut("fast",function(){$body.css({overflow:"visible"}),setTimeout(function(){mouseWheel.enableScroll()},600)}),googleDefined=!1}}function addResultsToMap(data){if(!googleDefined&&!defineGoogle())return console.error("Map Not Working"),!1;removeMarkers();var myListenEvent=mobile?"click":"mouseover";latlngbounds=new google.maps.LatLngBounds,_.each(data,function(item){var latLng=new google.maps.LatLng(item.loc.coordinates[0],item.loc.coordinates[1]);latlngbounds.extend(latLng);var marker=new google.maps.Marker({position:latLng,map:modalMap,offerId:item._id,address:item.name,icon:urlBaseCSS+"/images/marker.png"});google.maps.event.addListener(marker,myListenEvent,function(){$("#mapDetailsHolder").text(this.get("address"))}),markersArray.push(marker)}),modalMap.setCenter(latlngbounds.getCenter()),modalMap.fitBounds(latlngbounds),google.maps.event.trigger(modalMap,"resize")}function removeMarkers(){if(markersArray){for(i=0;i<markersArray.length;i++)markersArray[i].setMap(null);markersArray.length=0}}function defineGoogle(){googleDefined=!0;var styles=[];return"undefined"!=typeof google&&(styledMap=new google.maps.StyledMapType(styles),mapOptions={zoom:defaultcoordinates.zoom,center:new google.maps.LatLng(defaultcoordinates.lat,defaultcoordinates.lng),disableDefaultUI:!0,mapTypeIds:google.maps.MapTypeId.ROADMAP},modalMap=new google.maps.Map($("#mapHolder").get(0),mapOptions),modalMap.mapTypes.set("map_style",styledMap),modalMap.setMapTypeId("map_style"),!0)}function showFloatingArrows(){floatingArrows("back",selectedBoxPrev.length?"show":"hide"),floatingArrows("next",selectedBoxNext.length?"show":"hide")}function hideFloatingArrows(){floatingArrows("next","hide"),floatingArrows("back","hide")}function floatingArrows(_which,_action){var position="0";switch("hide"==_action&&(position="-100px"),_which){case"back":$("#back").stop().animate({left:position},200);break;case"next":$("#next").stop().animate({right:position},200)}}function strgToObj(strg){for(var opt={},x=strg.split("|"),y=null,len=x.length,i=0;i<len;i++)y=x[i].split(":"),opt[y[0]]=y[1];return opt}function offerSliders(){$("#modal").on("click","#modalImage .thumb-image",function(){var $this=$(this),target=$this.attr("data-thumb");$this.hasClass("active")||($("#modalImage .thumbs").find(".thumb-image").removeClass("active"),$this.addClass("active"),$("#modalImage .big-images").find("[data-thumb]").each(function(){var $this=$(this);$this.attr("data-thumb")===target?$this.removeClass("hidden"):$this.addClass("hidden")}))})}function misc(){$(".carousel").carousel({interval:6e3}),$("#mainContainer").on("click",".locate",function(){setTimeout(function(){$("#modal").find(".showLocations").click()},400)}),$("#categories").on("click","[data-tag]",function(){sendTrackingCode("Site","Categories",$(this).data("tag"))}),$("#malls").on("click","[data-tag]",function(){sendTrackingCode("Site","Malls",$(this).data("tag"))}),$document.on("click",".offer-tags [data-tag]",function(){sendTrackingCode("Site","Tags",$(this).attr("data-tag"))}).on("click",".crossOffer",function(){sendTrackingCode("Ads","Open",$(this).attr("id"))}),$(".icon-fb-maroon").on("click",function(){sendTrackingCode("Connect","clicked","facebook")}),$(".icon-twitter-maroon").on("click",function(){sendTrackingCode("Connect","clicked","twitter")}),$("#goToFormButton button").on("click",function(e){e.preventDefault(e),$(".visualHolder").addClass("hidden")}),$("img#mainBigImage").ready(function(){resizeContent()}),$("img#mainBigImage").on("load",function(){resizeContent()})}function shareOnFacebook(){$("#modal").on("click",".shareOnFB",function(){var href=location.protocol+"//"+location.host+location.pathname+"offers/"+$("#offer").attr("offerId");FB.ui({method:"share",href:href},function(response){})})}function shareOnTwitter(){var url="http://twitter.com/share?text=",width=575,height=450,left=($(window).width()-width)/2,top=($(window).height()-height)/2,opts="status=0,toolbar=0,location=0,menubar=0,directories=0,width="+width+",height="+height+",top="+top+",left="+left;$("#modal").on("click",".shareOnTwitter",function(){var href=location.protocol+"//"+location.host+location.pathname+"offers/"+$("#offer").attr("offerId"),$header=$("#offer .header-meta"),text=$header.find("h1").text();url+=text,url+=" "+href,window.open(url,"twitter",opts)})}function scrollTo(target,callback){$("html, body").animate({scrollTop:$(target).offset().top-52},300,callback)}function showLoginModal(message){var m=message||"You need to be logged in.";$(".modal-header",$loginModal).html("<h4>"+m+"</h4>"),$loginModal.modal()}function handleGetPageError(error){401===error&&showLoginModal(),"networError"==error&&alert("A network error has occured, could you please try again, or refresh the page.")}Autocomplete.prototype={createElements:function(){this.$wrapper=$("<div>").addClass(this.o.namespace+"-input-wrap"),this.$bgInput=$("<input>",{type:"text"}).addClass(this.o.namespace+"-bg-input"),"autocomplete-bootstrap"===this.o.namespace&&this.$bgInput.addClass("form-control"),this.$suggestions=$("<ul>").addClass(this.o.namespace+"-suggestions"),this.$loading=$("<img>",{src:"/main/images/loading-small.gif"}).addClass(this.o.namespace+"-loading hidden"),this.$input.addClass(this.o.namespace+"-input").wrap(this.$wrapper).before(this.$bgInput).after(this.$suggestions).after(this.$loading)},setup:function(option){var self=this;$("body").ajaxStart(function(){self.$loading.removeClass("hidden")}).ajaxStop(function(){self.$loading.addClass("hidden")})},events:function(){var self=this;self.$form.on("submit",function(e){self.o.canSubmitForm||e.preventDefault()}),self.$suggestions.on("mouseenter","li",function(){var $this=$(this);self.$suggestions.find(".active").removeClass("active"),$this.addClass("active"),self.o.currentValue=$this.text()}).on("click","li",function(){var text=$(this).text();self.o.topSuggestion=text,self.updateValue(text),self.focusInput()}),self.$input.on("focus",function(e){self.o.inFocus=!0}).on("blur",function(){self.o.inFocus=!1}).on("click",function(e){e.stopPropagation()}).on("keypress",function(e){var val=$(this).val(),pressedKey=String.fromCharCode(e.charCode),nextLetterInSuggestion=self.o.topSuggestion[val.length];pressedKey!==nextLetterInSuggestion&&self.updateBgValue("")}).on("keyup",function(e){if(e.keyCode!==keyboard.down&&e.keyCode!==keyboard.up&&e.keyCode!==keyboard.enter){var val=$.trim($(this).val());self.o.currentValue=val,0===val.length?(self.o.topSuggestion="",self.updateBgValue(""),self.removeSuggestions()):val.length>=2&&self.fetchAndSuggest(val)}}),$("body").on("keydown",function(e){self.o.inFocus&&(e.keyCode!==keyboard.tab&&e.keyCode!==keyboard.right||(self.updateValue(self.o.topSuggestion),setTimeout(function(){self.focusInput()},50))),self.suggestionsBeingShown()&&(e.keyCode===keyboard.down?(e.preventDefault(),self.suggestionsList("next")):e.keyCode===keyboard.up&&(e.preventDefault(),self.suggestionsList("prev")))}).on("keyup",function(e){self.suggestionsBeingShown()&&e.keyCode===keyboard.escape&&(e.preventDefault(),self.removeSuggestions(),self.focusInput())}).on("click",function(e){if(self.suggestionsBeingShown())return self.removeSuggestions(),self.focusInput(),self.o.canSubmitForm=!1,void setTimeout(function(){self.o.canSubmitForm=!0},300)})},fetchAndSuggest:_.throttle(function(val){var self=this;_.bindAll(this,"onSuccess","onFail"),this.fetchSuggestions(val).done(self.onSuccess).fail(self.onFail)},500),onSuccess:function(response,textStatus,jqXHR){this.o.currentValue.length>1&&0===this.$suggestions.find(".active").length&&this.buildSuggestions(response)},onFail:function(jqXHR,textStatus,errorThrown){},fetchSuggestions:function(val){return $.ajax({type:"get",dataType:"json",url:this.o.apiUrl+"/"+encodeURIComponent(val)})},fetchDummySuggestions:function(val){var deferred=$.Deferred();return setTimeout(function(){deferred.resolve(["midvalley","MidValley","Shopping","Shoppers","KLCC","gardens","gardening","klcitycenter","qwerty"])},600),deferred.promise()},buildSuggestions:function(suggestions){var html="",suggestions=this.sortSuggestions(suggestions.slice(0,this.o.limit));_.isEmpty(suggestions.match)||(this.o.topSuggestion=this.normalizeCase(this.o.currentValue,suggestions.match[0]),this.updateBgValue(this.o.topSuggestion),this.o.filterSiteContent&&this.o.filterSiteContent(suggestions.match[0],{showTerm:!1})),_.each(suggestions.all,function(el,i){html+="<li>"+el+"</li>"}),this.removeSuggestions(),this.o.allSuggestions=suggestions.all,this.$suggestions.append(html)},sortSuggestions:function(suggestions){var val=this.o.currentValue.toLowerCase(),sorted={all:[],match:[]};return _.each(suggestions,function(el,i){el.substring(0,val.length).toLowerCase()===val?(sorted.all.unshift(el),sorted.match.unshift(el)):sorted.all.push(el)}),sorted},removeSuggestions:function(){this.o.allSuggestions=[],this.$suggestions.empty()},suggestionsList:function(direction){var self=this,$active=this.$suggestions.find(".active"),$next=$active.next();$prev=$active.prev(),$first=this.$suggestions.find("li:first"),$last=this.$suggestions.find("li:last"),$active.removeClass("active"),"next"===direction?$active.length>0&&$next.length>0?($next.addClass("active"),this.o.currentValue=$next.text(),this.o.topSuggestion=$next.text(),this.updateValue($next.text())):($first.addClass("active"),this.o.currentValue=$first.text(),this.o.topSuggestion=$first.text(),this.updateValue($first.text())):"prev"===direction&&($active.length>0&&$prev.length>0?($prev.addClass("active"),this.o.currentValue=$prev.text(),this.o.topSuggestion=$prev.text(),this.updateValue($prev.text())):($last.addClass("active"),this.o.currentValue=$last.text(),this.o.topSuggestion=$last.text(),this.updateValue($last.text()))),setTimeout(function(){self.focusInput()},200)},suggestionsBeingShown:function(){return this.o.allSuggestions.length>0},normalizeCase:function(input,suggestion){var normalized=input+suggestion.substr(input.length);return normalized},updateValue:function(val){this.$input.trigger("blur"),this.$input.val(val),this.updateBgValue(val)},updateBgValue:function(val){val.length>=this.o.maxTopSuggestionLength&&this.o.currentValue.length>=this.o.maxTopSuggestionLength?this.$bgInput.val(""):this.$bgInput.val(val)},focusInput:function(){this.$input.trigger("focus")},reset:function(){this.removeSuggestions(),this.updateValue(""),this.o.topSuggestion=""}},function(){for(var method,noop=function(){},methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],length=methods.length,console=window.console=window.console||{};length--;)method=methods[length],console[method]||(console[method]=noop)}();var counting=0,bigBoxTemplate=null,noOfferTemplate=null,tileTemplate=null,crossOfferTemplate=null,whenMenuSnaps=611,tileWidth=270,tileMargin=20,lastLeftLocation=0,tileWidthWithMargin=tileWidth+tileMargin,doit=null,barSnapped=!1,selectedBox=null,selectedBoxNext=null,selectedBoxPrev=null,lastRowClicked=null,currentPageInView=1,currentPageInViewPrevious=1,pageType="list",pageTypePrevious="list",busy=!1,mightHaveMoreResults=!0,bodyEntrance="bottom",isModalHidden=!0,$modalContent=null,$modal=null,keywords=null,urlBaseCSS=null,lastTrack=null,containerMaxTiles=0,googleDefined=!1,defaultcoordinates={lat:3.157,lng:101.715,zoom:16},mapOptions=null,modalMap=null,markersArray=[],keyboard={tab:9,back:8,escape:27,space:32,enter:13,up:38,down:40,left:37,right:39},sform={},Widget={autocomplete:{}},lastDirection="next",isIE8=$("html").hasClass("ie8"),$window=$(window),$document=$(document),$body=$("body"),$html=$("html"),$html_body=$("html, body"),$loginModal=$("#login-modal"),hostURLWithProtocol=location.protocol+"//"+location.host;$(function(){"undefined"!=typeof Page404&&Page404===!0&&(mightHaveMoreResults=!1),urlBaseCSS=$("#mainCssFile").attr("href").replace(/stylesheets\/style\.css(\?v=[0-9]+)/,"").replace(/build\/style\.min\.css(\?v\=[0-9]+)/,""),bigBoxTemplate=_.template($("#bigBoxTemplate").html()),noOfferTemplate=_.template($("#noOfferTemplate").html()),tileTemplate=_.template($("#tileTemplate").html()),crossOfferTemplate=_.template($("#crossOfferTemplate").html()),$modalContent=$("#modalContents"),$modalWrapper=$("#modalWrapper"),$modal=$("#modal"),$("#mainContainer").on("click",".brand, .summary, .offerImage, .locate",reactToTileClick),$("#mainContainer").on("click",".addToBoard",function(e){e.stopPropagation();var $this=$(this),id=$this.closest(".tileHolder").attr("id"),location=$this.attr("data-location");addToBoard.add(id,location)}),$("#modal").on("click",".addToBoard",function(e){e.stopPropagation();var id=$("#offer").attr("offerId"),location=$(this).attr("data-location");addToBoard.add(id,location)}),$window.on("resize",resizeModal),setupWidgets(),resizeContent(),sortTilesToFitScreen(),setupNavigation(),setupModalAnimation(),setupWindowScrollBehavior(),bindGlobalKeys(),enableSearchFunctionality(),offerSliders(),shareOnTwitter(),misc(),"localhost:3000"===location.host,Config.login_fail===!0&&showLoginModal("Your login to to HSBC Smart Privileges has failed, please try again"),$(document).on("click","a",function(){var url=$(this).attr("href");if("#"!=url&&0===$(this).attr("href").indexOf("http")&&0!==$(this).attr("href").indexOf(hostURLWithProtocol)&&null===$(this).attr("href").match(/\.?hsbc\./gi))return confirm("This link exits HSBC's website. Please refer to our hyperlink policy. HSBC assumes no liability or control for your use of this link.")}),$("#landingOffer").on("click",function(e){e.preventDefault(),$("#"+$(this).data("id")+" .brand").trigger("click")}),"#cny"===location.hash&&doSearch("cny")});var addToBoard={add:function(id,location){$.ajax({url:"/api/offers/"+id+"/toggleFavorite",context:this,success:function(data){"tile"===location?addToBoard.onTile(id,data.result):"modal"===location&&(addToBoard.onTile(id,data.result),addToBoard.onModal(data.result))},error:function(data){showLoginModal(data.responseJSON.message)}})},onTile:function(id,isFav){var $tile=$("#"+id),$count=$tile.find(".loved"),loves=parseInt($count.text());isFav?($tile.find(".addToBoard").removeClass("fa-heart-o").addClass("fa-heart"),loves++):($tile.find(".addToBoard").removeClass("fa-heart").addClass("fa-heart-o"),loves--),$count.text(loves)},onModal:function(isFav){var $board=$("#offer .addToBoard");isFav?$board.addClass("active").find(".not-added-to-board").addClass("hidden").end().find(".added-to-board").removeClass("hidden"):$board.removeClass("active").find(".not-added-to-board").removeClass("hidden").end().find(".added-to-board").addClass("hidden")}};Config.googleAnalytics.load&&(!function(i,s,o,g,r,a,m){i.GoogleAnalyticsObject=r,i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date,a=s.createElement(o),m=s.getElementsByTagName(o)[0],a.async=1,a.src=g,m.parentNode.insertBefore(a,m)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create",Config.googleAnalytics.id,"auto"),ga("require","displayfeatures"),ga("send","pageview")),hideAnimationInProgress=!1;var resizeModal=_.debounce(function(){$modal.css({width:$body.width()-(document.body.clientWidth-window.innerWidth)})},200);!function($,sr){var debounce=function(func){var timeout;return function(){function delayed(){func.apply(obj,args),timeout=null}var obj=this,args=arguments;timeout&&clearTimeout(timeout),timeout=setTimeout(delayed,300)}};jQuery.fn[sr]=function(fn,threshhold){return fn?this.bind("scroll",debounce(fn,threshhold)):this.trigger(sr)}}(jQuery,"smartscroll"),jQuery.fn.swapWith=function(to){this.each(function(){var copy_to=$(to).clone(!0),copy_from=$(this).clone(!0);$(to).replaceWith(copy_from),$(this).replaceWith(copy_to)})};var mw=mouseWheel={keys:[37,38,39,40],preventDefault:function(e){e=e||window.event,e.preventDefault&&e.preventDefault(),e.returnValue=!1},keydown:function(e){for(var i=mw.keys.length;i--;)if(e.keyCode===mw.keys[i])return void mw.preventDefault(e)},wheel:function(e){mw.preventDefault(e)},disableScroll:function(){window.addEventListener&&window.addEventListener("DOMMouseScroll",mw.wheel,!1),window.onmousewheel=document.onmousewheel=mw.wheel,document.onkeydown=mw.keydown},enableScroll:function(){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",mw.wheel,!1),window.onmousewheel=document.onmousewheel=document.onkeydown=null}};!function(){function validateGroup($el){var validFields=[];return $el.each(function(){validFields.push(validateField($(this)))}),_.compact(validFields).length===validFields.length}function validateField($el){var validates=validate($el);return validates?$el.closest(".usage-input").find(".error-message").hide():$el.closest(".usage-input").find(".error-message").show(),validates}function validate($el){var validates=!0;return $el.each(function(){
var $this=$(this);$($this.attr("class").split(" ")).each(function(i,val){switch(val){case"phone09":/^[0-9]{6,15}$/i.test($this.val())||(validates=!1);break;case"inputCard":/^[0-9]{4}[\-\ ]?[0-9]{4}[\-\ ]?[0-9]{4}[\-\ ]?[0-9]{4}$/i.test($this.val())||(validates=!1);break;case"inputCheck":$this.prop("checked")||(validates=!1)}})}),validates}var popupForm={templates:"",data:"",init:function(){usageForm=$("#usage-form"),this.templates=_.template($('[data-template="usage-form"]').html()),this.prepareData(),this.event()},prepareData:function(){var self=this;$(".popup-form").on("click",function(){self.data=$(this).data(),self.renderModal()})},renderModal:function(){var self=this,html=this.templates(self.data);usageForm.empty(),usageForm.html(html),usageForm.modal()},event:function(){usageForm.on("click",".modal-close",function(){usageForm.modal("hide")}),usageForm.on("keyup, blur",'input[type="text"]',function(){validateField($(this))}).on("change",'input[type="checkbox"]',function(){validateField($(this))}),usageForm.on("submit","form",function(e){e.preventDefault();var valid=validateGroup($(this).find("input.validate"));if(valid){var data=$(this).serialize();$(this).find("button").prop("disabled",!0).text("Submitting ..."),$.ajax({type:"POST",url:$(this).attr("action"),data:data,dataType:"JSON",cache:!1,success:function(data){console.log(data),$(".modal-form").hide(),$(".modal-thank-you").show()}})}})}},popupForm2={templates:"",data:"",init:function(){usageForm2=$("#usage-form2"),this.templates=_.template($('[data-template="usage-form2"]').html()),this.prepareData(),this.event()},prepareData:function(){var self=this;$(".popup-form2").on("click",function(){self.data=$(this).data(),self.renderModal()})},renderModal:function(){var self=this,html=this.templates(self.data);usageForm2.empty(),usageForm2.html(html),usageForm2.modal()},event:function(){usageForm2.on("click",".modal-close",function(){usageForm2.modal("hide")}),usageForm2.on("keyup, blur",'input[type="text"]',function(){validateField($(this))}).on("change",'input[type="checkbox"]',function(){validateField($(this))}),usageForm2.on("submit","form",function(e){var valid=validateGroup($(this).find("input.validate"));if(e.preventDefault(),valid){var data=$(this).serialize();$(this).find("button").prop("disabled",!0).text("Submitting ..."),$.ajax({type:"POST",url:$(this).attr("action"),data:data,dataType:"JSON",cache:!1,success:function(data){$(".modal-form").hide(),$(".modal-thank-you").show()}})}})}};popupForm.init(),popupForm2.init()}(),!function(){"use strict";function t(n){if(!n)throw new Error("No options passed to Waypoint constructor");if(!n.element)throw new Error("No element option passed to Waypoint constructor");if(!n.handler)throw new Error("No handler option passed to Waypoint constructor");this.key="waypoint-"+e,this.options=t.Adapter.extend({},t.defaults,n),this.element=this.options.element,this.adapter=new t.Adapter(this.element),this.callback=n.handler,this.axis=this.options.horizontal?"horizontal":"vertical",this.enabled=this.options.enabled,this.triggerPoint=null,this.group=t.Group.findOrCreate({name:this.options.group,axis:this.axis}),this.context=t.Context.findOrCreateByElement(this.options.context),t.offsetAliases[this.options.offset]&&(this.options.offset=t.offsetAliases[this.options.offset]),this.group.add(this),this.context.add(this),i[this.key]=this,e+=1}var e=0,i={};t.prototype.queueTrigger=function(t){this.group.queueTrigger(this,t)},t.prototype.trigger=function(t){this.enabled&&this.callback&&this.callback.apply(this,t)},t.prototype.destroy=function(){this.context.remove(this),this.group.remove(this),delete i[this.key]},t.prototype.disable=function(){return this.enabled=!1,this},t.prototype.enable=function(){return this.context.refresh(),this.enabled=!0,this},t.prototype.next=function(){return this.group.next(this)},t.prototype.previous=function(){return this.group.previous(this)},t.invokeAll=function(t){var e=[];for(var n in i)e.push(i[n]);for(var o=0,r=e.length;r>o;o++)e[o][t]()},t.destroyAll=function(){t.invokeAll("destroy")},t.disableAll=function(){t.invokeAll("disable")},t.enableAll=function(){t.Context.refreshAll();for(var e in i)i[e].enabled=!0;return this},t.refreshAll=function(){t.Context.refreshAll()},t.viewportHeight=function(){return window.innerHeight||document.documentElement.clientHeight},t.viewportWidth=function(){return document.documentElement.clientWidth},t.adapters=[],t.defaults={context:window,continuous:!0,enabled:!0,group:"default",horizontal:!1,offset:0},t.offsetAliases={"bottom-in-view":function(){return this.context.innerHeight()-this.adapter.outerHeight()},"right-in-view":function(){return this.context.innerWidth()-this.adapter.outerWidth()}},window.Waypoint=t}(),function(){"use strict";function t(t){window.setTimeout(t,1e3/60)}function e(t){this.element=t,this.Adapter=o.Adapter,this.adapter=new this.Adapter(t),this.key="waypoint-context-"+i,this.didScroll=!1,this.didResize=!1,this.oldScroll={x:this.adapter.scrollLeft(),y:this.adapter.scrollTop()},this.waypoints={vertical:{},horizontal:{}},t.waypointContextKey=this.key,n[t.waypointContextKey]=this,i+=1,o.windowContext||(o.windowContext=!0,o.windowContext=new e(window)),this.createThrottledScrollHandler(),this.createThrottledResizeHandler()}var i=0,n={},o=window.Waypoint,r=window.onload;e.prototype.add=function(t){var e=t.options.horizontal?"horizontal":"vertical";this.waypoints[e][t.key]=t,this.refresh()},e.prototype.checkEmpty=function(){var t=this.Adapter.isEmptyObject(this.waypoints.horizontal),e=this.Adapter.isEmptyObject(this.waypoints.vertical),i=this.element==this.element.window;t&&e&&!i&&(this.adapter.off(".waypoints"),delete n[this.key])},e.prototype.createThrottledResizeHandler=function(){function t(){e.handleResize(),e.didResize=!1}var e=this;this.adapter.on("resize.waypoints",function(){e.didResize||(e.didResize=!0,o.requestAnimationFrame(t))})},e.prototype.createThrottledScrollHandler=function(){function t(){e.handleScroll(),e.didScroll=!1}var e=this;this.adapter.on("scroll.waypoints",function(){(!e.didScroll||o.isTouch)&&(e.didScroll=!0,o.requestAnimationFrame(t))})},e.prototype.handleResize=function(){o.Context.refreshAll()},e.prototype.handleScroll=function(){var t={},e={horizontal:{newScroll:this.adapter.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.adapter.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}};for(var i in e){var n=e[i],o=n.newScroll>n.oldScroll,r=o?n.forward:n.backward;for(var s in this.waypoints[i]){var l=this.waypoints[i][s];if(null!==l.triggerPoint){var a=n.oldScroll<l.triggerPoint,h=n.newScroll>=l.triggerPoint,p=a&&h,u=!a&&!h;(p||u)&&(l.queueTrigger(r),t[l.group.id]=l.group)}}}for(var d in t)t[d].flushTriggers();this.oldScroll={x:e.horizontal.newScroll,y:e.vertical.newScroll}},e.prototype.innerHeight=function(){return this.element==this.element.window?o.viewportHeight():this.adapter.innerHeight()},e.prototype.remove=function(t){delete this.waypoints[t.axis][t.key],this.checkEmpty()},e.prototype.innerWidth=function(){return this.element==this.element.window?o.viewportWidth():this.adapter.innerWidth()},e.prototype.destroy=function(){var t=[];for(var e in this.waypoints)for(var i in this.waypoints[e])t.push(this.waypoints[e][i]);for(var n=0,o=t.length;o>n;n++)t[n].destroy()},e.prototype.refresh=function(){var t,e=this.element==this.element.window,i=e?void 0:this.adapter.offset(),n={};this.handleScroll(),t={horizontal:{contextOffset:e?0:i.left,contextScroll:e?0:this.oldScroll.x,contextDimension:this.innerWidth(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:e?0:i.top,contextScroll:e?0:this.oldScroll.y,contextDimension:this.innerHeight(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}};for(var r in t){var s=t[r];for(var l in this.waypoints[r]){var a,h,p,u,d,f=this.waypoints[r][l],c=f.options.offset,w=f.triggerPoint,y=0,g=null==w;f.element!==f.element.window&&(y=f.adapter.offset()[s.offsetProp]),"function"==typeof c?c=c.apply(f):"string"==typeof c&&(c=parseFloat(c),f.options.offset.indexOf("%")>-1&&(c=Math.ceil(s.contextDimension*c/100))),a=s.contextScroll-s.contextOffset,f.triggerPoint=Math.floor(y+a-c),h=w<s.oldScroll,p=f.triggerPoint>=s.oldScroll,u=h&&p,d=!h&&!p,!g&&u?(f.queueTrigger(s.backward),n[f.group.id]=f.group):!g&&d?(f.queueTrigger(s.forward),n[f.group.id]=f.group):g&&s.oldScroll>=f.triggerPoint&&(f.queueTrigger(s.forward),n[f.group.id]=f.group)}}return o.requestAnimationFrame(function(){for(var t in n)n[t].flushTriggers()}),this},e.findOrCreateByElement=function(t){return e.findByElement(t)||new e(t)},e.refreshAll=function(){for(var t in n)n[t].refresh()},e.findByElement=function(t){return n[t.waypointContextKey]},window.onload=function(){r&&r(),e.refreshAll()},o.requestAnimationFrame=function(e){var i=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||t;i.call(window,e)},o.Context=e}(),function(){"use strict";function t(t,e){return t.triggerPoint-e.triggerPoint}function e(t,e){return e.triggerPoint-t.triggerPoint}function i(t){this.name=t.name,this.axis=t.axis,this.id=this.name+"-"+this.axis,this.waypoints=[],this.clearTriggerQueues(),n[this.axis][this.name]=this}var n={vertical:{},horizontal:{}},o=window.Waypoint;i.prototype.add=function(t){this.waypoints.push(t)},i.prototype.clearTriggerQueues=function(){this.triggerQueues={up:[],down:[],left:[],right:[]}},i.prototype.flushTriggers=function(){for(var i in this.triggerQueues){var n=this.triggerQueues[i],o="up"===i||"left"===i;n.sort(o?e:t);for(var r=0,s=n.length;s>r;r+=1){var l=n[r];(l.options.continuous||r===n.length-1)&&l.trigger([i])}}this.clearTriggerQueues()},i.prototype.next=function(e){this.waypoints.sort(t);var i=o.Adapter.inArray(e,this.waypoints),n=i===this.waypoints.length-1;return n?null:this.waypoints[i+1]},i.prototype.previous=function(e){this.waypoints.sort(t);var i=o.Adapter.inArray(e,this.waypoints);return i?this.waypoints[i-1]:null},i.prototype.queueTrigger=function(t,e){this.triggerQueues[e].push(t)},i.prototype.remove=function(t){var e=o.Adapter.inArray(t,this.waypoints);e>-1&&this.waypoints.splice(e,1)},i.prototype.first=function(){return this.waypoints[0]},i.prototype.last=function(){return this.waypoints[this.waypoints.length-1]},i.findOrCreate=function(t){return n[t.axis][t.name]||new i(t)},o.Group=i}(),function(){"use strict";function t(t){return t===t.window}function e(e){return t(e)?e:e.defaultView}function i(t){this.element=t,this.handlers={}}var n=window.Waypoint;i.prototype.innerHeight=function(){var e=t(this.element);return e?this.element.innerHeight:this.element.clientHeight},i.prototype.innerWidth=function(){var e=t(this.element);return e?this.element.innerWidth:this.element.clientWidth},i.prototype.off=function(t,e){function i(t,e,i){for(var n=0,o=e.length-1;o>n;n++){var r=e[n];i&&i!==r||t.removeEventListener(r)}}var n=t.split("."),o=n[0],r=n[1],s=this.element;if(r&&this.handlers[r]&&o)i(s,this.handlers[r][o],e),this.handlers[r][o]=[];else if(o)for(var l in this.handlers)i(s,this.handlers[l][o]||[],e),this.handlers[l][o]=[];else if(r&&this.handlers[r]){for(var a in this.handlers[r])i(s,this.handlers[r][a],e);this.handlers[r]={}}},i.prototype.offset=function(){if(!this.element.ownerDocument)return null;var t=this.element.ownerDocument.documentElement,i=e(this.element.ownerDocument),n={top:0,left:0};return this.element.getBoundingClientRect&&(n=this.element.getBoundingClientRect()),{top:n.top+i.pageYOffset-t.clientTop,left:n.left+i.pageXOffset-t.clientLeft}},i.prototype.on=function(t,e){var i=t.split("."),n=i[0],o=i[1]||"__default",r=this.handlers[o]=this.handlers[o]||{},s=r[n]=r[n]||[];s.push(e),this.element.addEventListener(n,e)},i.prototype.outerHeight=function(e){var i,n=this.innerHeight();return e&&!t(this.element)&&(i=window.getComputedStyle(this.element),n+=parseInt(i.marginTop,10),n+=parseInt(i.marginBottom,10)),n},i.prototype.outerWidth=function(e){var i,n=this.innerWidth();return e&&!t(this.element)&&(i=window.getComputedStyle(this.element),n+=parseInt(i.marginLeft,10),n+=parseInt(i.marginRight,10)),n},i.prototype.scrollLeft=function(){var t=e(this.element);return t?t.pageXOffset:this.element.scrollLeft},i.prototype.scrollTop=function(){var t=e(this.element);return t?t.pageYOffset:this.element.scrollTop},i.extend=function(){function t(t,e){if("object"==typeof t&&"object"==typeof e)for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}for(var e=Array.prototype.slice.call(arguments),i=1,n=e.length;n>i;i++)t(e[0],e[i]);return e[0]},i.inArray=function(t,e,i){return null==e?-1:e.indexOf(t,i)},i.isEmptyObject=function(t){for(var e in t)return!1;return!0},n.adapters.push({name:"noframework",Adapter:i}),n.Adapter=i}(),function(){new Waypoint({element:document.getElementById("footerLinks"),handler:function(direction){"down"===direction?$(".floating-btn").addClass("hidden"):$(".floating-btn").removeClass("hidden")},offset:"90%"});$("li.close").click(function(){$("ul.special-btn").toggleClass("active")}),$("li.close").find("a").on("click",function(e){e.preventDefault()})}();