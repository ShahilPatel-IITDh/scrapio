(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[330,477,447],{21e3:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[...slug]",function(){return n(5823)}])},6778:function(e,t,n){"use strict";n.d(t,{C:function(){return i}});var r=n(57213);let i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Object.entries(r.PAGE_TYPES.PAGE_TYPE_ALIAS_TO_CONTENT_PLATFORM_TYPES_MAP),i="!UNDEFINED! CP types: [".concat(e.join(", "),"]");if(e.includes("CollectionPage")){let[e]=t;return r.PAGE_TYPES.REPORTS_PAGE_SLUGS[e]||i}let[o]=n.find(t=>{let[,n]=t;return e.includes(n)})||[];return o||i}},5823:function(e,t,n){"use strict";n.r(t),n.d(t,{DynamicPage:function(){return L},default:function(){return U}});var r=n(35944);n(67294);var i=n(45697),o=n.n(i),l=n(76489),a=n(42316),s=n(60901),d=n.n(s),u=n(41609),c=n.n(u),g=n(57213),p=n(31365),h=n(44861),m=n(29051),f=n(55570),P=n(19282),v=n(43572),T=n(2281),_=n(84598),C=n(54804);class E{isSupported(){return[g.PAGE_TYPES.SECTION,g.PAGE_TYPES.BLOG].includes(this.pageType)}hasValidPageNumber(e){var t;if(!e)return this.currentPage>0;let n=(null==e?void 0:null===(t=e.hasPart)||void 0===t?void 0:t.total)||0,r=Math.ceil(n/this.itemsPerPage);return 0===n||this.currentPage>0&&r>=0&&this.currentPage<=r}redirectToFirstPage(){return(0,P.l)({url:this.urlPath,res:this.res,querystring:{page:1,...this.queryParams}})}getQueryOptions(){return this.isSupported()?{itemsPerPage:this.itemsPerPage,offset:this.offset}:{}}constructor(e,t,{itemsPerPage:n=12}={}){if(c()(null==e?void 0:e.res)||!(null==e?void 0:e.asPath)||!t)throw Error("Failed to initialise pagination. Missing required arguments.");let{pathname:r}=new URL(e.asPath,"file://relative");this.pageType=t,this.itemsPerPage=n;let{page:i="1",pageTypes:o,slug:l,...a}=e.query;this.urlPath=r,this.currentPage=parseInt(i,10),this.queryParams=a,this.offset=(this.currentPage-1)*this.itemsPerPage,this.res=e.res}}var y=n(8203),A=n(65690),S=n(69066),w=n(12632),O=n(82749),I=n(88477),R=n(50907);let N=e=>{let t;try{t=new URL(e)}catch(e){return!0}return[".woff",".woff2",".xml",".png",".ico",".js",".json",".php",".jpeg",".jpg",".css",".webp",".cfm",".gif",".xm"].some(e=>t.pathname.endsWith(e))||["/rss","/.well-known/apple-app-site-association"].some(e=>t.pathname.startsWith(e))};var G=n(6778);let B=(e,t,n)=>{var r,i,o,l,a,s,d,u,c,g,p,h;(null==e?void 0:null===(r=e.detail)||void 0===r?void 0:null===(i=r.message)||void 0===i?void 0:i.includes("timeout"))&&(null==e?void 0:null===(o=e.detail)||void 0===o?void 0:null===(l=o.message)||void 0===l?void 0:l.includes("exceeded"))?m.logger.warn({error:e,function:"client.getArticleByTegId",message:"Timed out fetching content from CPv2",teg_id:t,page_url:n,status_code:408}):m.logger.warn({error:e,function:"client.getArticleByTegId",message:(null==e?void 0:null===(a=e.detail)||void 0===a?void 0:null===(s=a.response)||void 0===s?void 0:null===(d=s.data)||void 0===d?void 0:d.message)?"".concat(null==e?void 0:null===(u=e.detail)||void 0===u?void 0:null===(c=u.response)||void 0===c?void 0:null===(g=c.data)||void 0===g?void 0:g.message," in CPv2"):"Unknown error fetching content from CPv2",teg_id:t,page_url:n,status_code:(null==e?void 0:null===(p=e.detail)||void 0===p?void 0:null===(h=p.response)||void 0===h?void 0:h.status)||500})},Y=(e,t,n)=>{let{...i}=t;switch(e){case g.PAGE_TYPES.ARTICLE:return(0,r.tZ)(n.NewArticle,{...i});case g.PAGE_TYPES.BLOG:return(0,r.tZ)(n.Blog,{...i});case g.PAGE_TYPES.HUB:return(0,r.tZ)(n.Hub,{...i});case g.PAGE_TYPES.SECTION:return(0,r.tZ)(n.Section,{...i});case g.PAGE_TYPES.ALL_REPORTS:case g.PAGE_TYPES.SPECIAL_REPORTS:case g.PAGE_TYPES.TECHNOLOGY_QUARTERLY:return(0,r.tZ)(n.Reports,{...i});case g.PAGE_TYPES.REPORT:return(0,r.tZ)(n.Report,{...i});default:throw Error("[#renderComponent] No component defined for '".concat(e,"'"))}},L=e=>{var t;let{content:n,pageType:i,pageUrl:o,statusCode:l,region:a,isSubscriber:s,deps:d,paywallCheck:u,cp2Content:p}=e,h=(null==n?void 0:n[0])||n||{},m=l===g.HTTP_STATUS_OKAY&&!c()(h)&&i,f=i!==g.PAGE_TYPES.ARTICLE?(0,v.$U)(null,{pageUrl:o,isSubscriber:s,pageType:i,headline:null==h?void 0:h.headline,image:null==h?void 0:null===(t=h.image)||void 0===t?void 0:t.promo},h._metadata):h._metadata;if(d.usePianoModal({disabled:!m}),!m)return(0,r.tZ)(d.ErrorPage,{statusCode:g.HTTP_STATUS_NOT_FOUND});try{return Y(i,{content:n,metadata:f,region:a,isSubscriber:s,paywallCheck:u,cp2Content:p},d)}catch(e){return d.logger.error(e.message),(0,r.tZ)(d.ErrorPage,{statusCode:g.HTTP_STATUS_NOT_FOUND})}};L.getInitialProps=async e=>{var t,n,r;let i,o,s,u,c,v;let{req:A,res:S,query:w,appProps:O}=e,{featureFlags:I=[],hasTypeQueryRunInMiddleware:Y,pageTypeFromMiddleware:L,tegIdFromMiddleware:U,pageUrlFromMiddleware:Z}=O,b=I.includes("PROD_CMS")?h.prodConfig.getConfigOption("cpRefUrl"):h.envConfig.getConfigOption("cpRefUrl"),q=(0,y.getContentUrlFromContext)(b,e),{slug:M=[],...H}=w;if(q&&N(q))return(0,_.Gp)(S,"Bypass CP type check as file is excluded (".concat(A.url,")"));if(!Y){(0,T.setNewRelicTransactionName)("/type");try{let e=await (0,_.F6)(q);i=e.types,o=e.canonicalUrl,u=e.tegId}catch(e){return(0,_.Gp)(S,"Could not find any page types for ".concat(q),"fetchCpPageTypes")}}Y&&L&&(i=L,o=Z,u=U,m.logger.info({message:'Middleware has run type query and page type has been set to "'.concat(L,'"'),teg_id:u,page_url:o,function:"DynamicPage.getInitialProps"}));let k=(0,G.C)(i,M),D=Math.floor(100*Math.random())+1<=p.x,F=new E(e,k),X=q&&new URL(q).pathname,x=o&&new URL(o).pathname;if(o&&(0,f.u)(X)!==(0,f.u)(x))return(0,P.l)({res:S,url:x,permanent:!0,querystring:H});if(!(0,_.m5)(k))return(0,_.Gp)(S,"Invalid page type '".concat(k,"' (").concat(A.url,")"));let j=l.parse(e.req.headers.cookie||""),W=(0,a.s)(A.headers["cf-ipcountry"]),$="true"===j[g.COOKIE_NAMES.IS_SUBSCRIBER],K={pageUrl:q,pageType:k,isSubscriber:$,region:W,content:[],cp2Content:{}};if(F.isSupported()&&!F.hasValidPageNumber())return F.redirectToFirstPage();(0,_.B1)(k);try{let t;let n=F.getQueryOptions(),r=[];if(I.includes("CP2_TESTING")||I.includes("CP2")&&k===g.PAGE_TYPES.ARTICLE&&D){m.logger.log({level:"info",function:"client.getArticleByTegId",message:"Fetching Article from CPv2",teg_id:u,page_url:q,featureFlags:I});let e=new(d())(h.envConfig.getConfigOption("cp2"));I.includes("CP2_MIXING")?r.push(e.getArticleByTegId(u).then(e=>(s=e,m.logger.log({level:"info",function:"client.getArticleByTegId",message:"Article fetched from CPv2",featureFlags:I,id:s.id,teg_id:s.tegId,page_url:q}),(null==s?void 0:s.leadComponent)&&(null==s?void 0:s.leadComponent.url)&&(null==s?void 0:s.leadComponent.width)&&(null==s?void 0:s.leadComponent.height)&&m.logger.log({level:"info",function:"client.getArticleByTegId",message:"Lead image present in response from CPv2",featureFlags:I,id:s.id,teg_id:s.tegId,page_url:q,lead_component:null==s?void 0:s.leadComponent}),e)).catch(e=>{B(e,u,q)})):e.getArticleByTegId(u).then(e=>(m.logger.log({level:"info",function:"client.getArticleByTegId",message:"Article fetched from CPv2",featureFlags:I,id:e.id,teg_id:e.tegId,page_url:q}),(null==e?void 0:e.leadComponent)&&(null==e?void 0:e.leadComponent.url)&&(null==e?void 0:e.leadComponent.width)&&(null==e?void 0:e.leadComponent.height)&&m.logger.log({level:"info",function:"client.getArticleByTegId",message:"Lead image present in response from CPv2",featureFlags:I,id:e.id,teg_id:e.tegId,page_url:q,lead_component:null==e?void 0:e.leadComponent}),e)).catch(e=>{B(e,u,q)})}if(r.push((0,C.Z)(e,k,n).then(e=>(c=e,e)).catch(e=>(t=e,e))),await Promise.allSettled(r),t)throw t;s&&(K.cp2Content=s),K.content=c,K.statusCode=g.HTTP_STATUS_OKAY}catch(e){throw e.message="DynamicPage CP request: ".concat(e.message),e}if(k===g.PAGE_TYPES.ARTICLE)try{v=await (0,R.Z)(A,S,null==K?void 0:null===(n=K.content)||void 0===n?void 0:null===(r=n.url)||void 0===r?void 0:r.canonical),K.paywallCheck=v}catch(e){m.logger.log({level:"error",message:"Something went wrong with the paywall check",error:e,function:"shouldDropPaywall"})}return F.isSupported()&&!F.hasValidPageNumber(null==K?void 0:null===(t=K.content)||void 0===t?void 0:t[0])?F.redirectToFirstPage():K},L.propTypes={statusCode:o().number.isRequired,pageType:o().oneOf(_.rc).isRequired,pageUrl:o().string.isRequired,content:o().oneOfType([o().arrayOf(o().oneOfType([O.M$,O.hr,O.A2,O.S$,O.MM,O.gg,O.hC])),o().shape({})]).isRequired,isSubscriber:o().bool.isRequired,region:o().string,deps:o().shape({ErrorPage:o().elementType,NewArticle:o().elementType,Blog:o().elementType,Hub:o().elementType,Section:o().elementType,Reports:o().elementType,Report:o().elementType,usePianoModal:o().func,logger:o().shape({debug:o().func,error:o().func,info:o().func,level:o().string,warn:o().func})}),cp2Content:o().shape({})},L.defaultProps={deps:{ErrorPage:I.default,NewArticle:w.Td,Blog:w.l3,Hub:w.Xb,Section:w.$0,Reports:w.Aq,Report:w.yG,logger:m.logger,usePianoModal:A.cd}};var U=(0,S.Z)(L)},88477:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return E}});var r=n(35944);n(67294);var i=n(45697),o=n.n(i),l=n(9008),a=n.n(l),s=n(70640),d=n(47436),u=n(48373),c=n(29051),g=n(91511),p=n(26601),h=n(7276);let m=(0,p.Z)("div",{target:"e12sup9z0"})("margin:0 0 3rem 0;.ds-missed-target{margin-left:auto;margin-right:auto;}",h.mq.media.min("md"),"{.ds-missed-target{max-width:75%;}}");var f=n(6778),P=n(57213);let v=(0,r.BX)(r.HY,{children:["We’ve logged this error."," ",(0,r.tZ)("a",{href:"https://myaccount.economist.com/s/contact-us",children:"Contact us"})," if this issue persists."]}),T=(0,r.BX)(r.HY,{children:["Go to the ",(0,r.tZ)("a",{href:"https://www.economist.com",children:"homepage"}),"."]}),_=(0,r.BX)(r.HY,{children:["We’ve logged this error. Try refreshing this page or"," ",(0,r.tZ)("a",{href:"https://myaccount.economist.com/s/contact-us",children:"contact us"})," if the issue persists."]});function C(e){let{statusCode:t}=e;(0,g.q)({platform:{id:"economist_error_site",purpose:"error"},screen:{type:t}});let n="Our apologies. An error seems to have occurred.",i=v,o="Something went wrong";return 404===t?(o="Page not found",n="Our apologies. It looks like we couldn’t find this page.",i=T):t>=500&&(n="Our apologies. It looks like something went wrong.",i=_),(0,r.BX)(r.HY,{children:[(0,r.BX)(a(),{children:[(0,r.tZ)(s.Os,{}),(0,r.tZ)("title",{children:"".concat(o," | The Economist")})]}),(0,r.tZ)(d.MastheadSecondary,{}),(0,r.tZ)(m,{children:(0,r.tZ)(u.Z,{children:(0,r.tZ)(d.MissedTarget,{headline:n,summary:i})})})]})}C.getInitialProps=e=>{let{appProps:t,res:n,err:r,req:i}=e;if(n&&r){var o,l,a;return c.logger.error({message:"Built-in _error page triggered",url:null==i?void 0:i.url,user_agent:null==i?void 0:null===(o=i.headers)||void 0===o?void 0:o["user-agent"],request_id:t.requestId,status_code:r.statusCode,error:r,features_enabled:null==i?void 0:null===(l=i.headers)||void 0===l?void 0:l["x-economist-features"],referer:null==i?void 0:null===(a=i.headers)||void 0===a?void 0:a.referer,dynamic_page_type:(0,f.C)(t.pageTypeFromMiddleware,[((null==i?void 0:i.url)||"").replace("/","").trim()])}),n.setHeader("Cache-Control",P.CACHE_CONTROL_HEADER_CACHING_DISABLED),{statusCode:r.statusCode}}return{}},C.propTypes={statusCode:o().number},C.defaultProps={statusCode:null};var E=C}},function(e){e.O(0,[474,841,144,82,696,750,306,357,514,581,334,60,953,729,774,888,179],function(){return e(e.s=21e3)}),_N_E=e.O()}]);