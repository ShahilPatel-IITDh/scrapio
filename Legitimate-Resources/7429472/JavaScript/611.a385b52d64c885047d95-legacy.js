"use strict";(self.webpackChunkAemPortal=self.webpackChunkAemPortal||[]).push([[611],{5611:function(e,t,n){n.d(t,{t:function(){return y}});var r=n(5480),o=n(8433),i=n(5661),s=n(5941),l=n(9748),a="mod";function u(e,t){return void 0===t&&(t=a),(0,s.xH)((e||[]).filter(Boolean).map((function(e){var n=[].slice.call(e.getElementsByClassName(t));return e&&e.classList.contains(t)&&n.push(e),n})))}function c(e,t){return void 0===t&&(t=a),e.length>t.length&&e.startsWith(t)?e.substr(3):null}var h=function(){function e(e,t){void 0===e&&(e=!1),void 0===t&&(t=a),this.debug=e,this.moduleClass=t,this.registry={},this.resolved=[],this.modules=new WeakMap,this.application=new d(this.modules,e,this.moduleClass)}return e.prototype.register=function(e,t){var n;if(null!==this.elementsByType){if("string"==typeof e){if(!t)return void(this.debug&&console.error("Error registering module ".concat(e,", no class given")));(n={})[e]=t,e=n}if(this.debug){var r=new Set(Object.keys(this.registry)),i=Object.keys(e).filter((function(e){return r.has(e)}));i.length>0&&console.error("The modules ".concat(i.join(", ")," were registered multiple times. The behaviour of this is undefined."))}this.elementsByType&&this.init(e),this.registry=(0,o.pi)((0,o.pi)({},this.registry),e)}else this.debug&&console.error("Can’t register new modules, application initialization is already finished",e,t)},e.prototype.lazyBootstrap=function(e){return(0,o.mG)(this,void 0,Promise,(function(){return(0,o.Jh)(this,(function(t){switch(t.label){case 0:return null!==this.elementsByType?(this.debug&&console.error("Can’t do lazyBootstrap during initialization phase. Call it asynchronously."),[2]):e?(this.elementsByType=void 0,this.bootstrap(e),[4,this.finalize()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},e.prototype.bootstrap=function(){for(var e,t,n=this,r=[],i=0;arguments.length>i;i++)r[i]=arguments[i];if(void 0===this.elementsByType){var s=u(r,this.moduleClass),l={},a=function(e){e.classList.forEach((function(t){var r=c(t,n.moduleClass);r&&(r in l||(l[r]=[]),l[r].push(e))}))};try{for(var h=(0,o.XA)(s),d=h.next();!d.done;d=h.next()){var f=d.value;a(f)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(t=h.return)&&t.call(h)}finally{if(e)throw e.error}}this.elementsByType=l,this.init(this.registry)}else this.debug&&console.error("Can’t initialize trafical application twice",this,r)},e.prototype.finalize=function(){return(0,o.mG)(this,void 0,Promise,(function(){var e,t,n,r,i,a,u,c,h,d,f,p,y=this;return(0,o.Jh)(this,(function(m){switch(m.label){case 0:if(!this.elementsByType)return this.debug&&console.warn("Called finalize ".concat(null===this.elementsByType?"twice":"before bootstrap")),[2,this.application];this.debug&&(e=Object.keys(this.elementsByType).filter((function(e){return!(e in y.registry)}))).length>0&&console.warn("Module type(s) ".concat(e.join(", ")," found in DOM element(s)"),(0,s.xH)(e.map((function(e){return y.elementsByType[e]}))),"but not registered"),this.elementsByType=null,t=this.resolved,this.resolved=[],m.label=1;case 1:return m.trys.push([1,11,,12]),[4,Promise.all(t)];case 2:n=m.sent(),r=function(e){var t,n,r;return(0,o.Jh)(this,(function(o){switch(o.label){case 0:if(!e)return[2,"continue"];o.label=1;case 1:return o.trys.push([1,4,,5]),t={},e.moduleStateChanged&&(t=(0,l.VB)(e.hashKey,!0),window.addEventListener("hashchange",(function(){var t;return e.moduleStateChanged(null!==(t=(0,l.VB)(e.hashKey))&&void 0!==t?t:{})}))),(n=e.after(t))?[4,n]:[3,3];case 2:o.sent(),o.label=3;case 3:return[3,5];case 4:return r=o.sent(),i.debug&&console.error("Error calling `after` of module",e.modName,r),[3,5];case 5:return[2]}}))},i=this,m.label=3;case 3:m.trys.push([3,8,9,10]),a=(0,o.XA)(n),u=a.next(),m.label=4;case 4:return u.done?[3,7]:(c=u.value,[5,r(c)]);case 5:m.sent(),m.label=6;case 6:return u=a.next(),[3,4];case 7:return[3,10];case 8:return h=m.sent(),f={error:h},[3,10];case 9:try{u&&!u.done&&(p=a.return)&&p.call(a)}finally{if(f)throw f.error}return[7];case 10:return[3,12];case 11:return d=m.sent(),this.debug&&console.error("Exception during module init",d),[3,12];case 12:return[2,this.application]}}))}))},e.prototype.init=function(e){var t,n;for(var r in this.debug&&console.info("Bootstrapping trafical with modules",e,"and elements",this.elementsByType),e)if(r in this.elementsByType){var i=this.elementsByType[r];try{for(var s=(t=void 0,(0,o.XA)(i)),l=s.next();!l.done;l=s.next()){var a=l.value,u=this.modules.get(a)||{};this.modules.set(a,u),this.resolved.push(this.createModule(a,r,u,e))}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}}},e.prototype.createModule=function(e,t,n,r){return(0,o.mG)(this,void 0,Promise,(function(){var s,l,a,u;return(0,o.Jh)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),function(e){for(var t=e;t;){var n=Object.getPrototypeOf(t);if(n===i.Y)return!0;t=n}return!1}(s=r[t])?[3,2]:[4,s()];case 1:s=o.sent(),o.label=2;case 2:return l=new s(e,t,this.application),n[t]=l,(a=l.on())?[4,a]:[3,4];case 3:o.sent(),o.label=4;case 4:return[2,l];case 5:return u=o.sent(),this.debug&&console.error("Error initializing module",t,u),[3,6];case 6:return[2,null]}}))}))},e}(),d=function(){function e(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=a),this.modules=e,this.debug=t,this.moduleClass=n}return e.prototype.getModuleInstances=function(e){return this.modules.has(e)?(0,o.pi)({},this.modules.get(e)):{}},e.prototype.getAllModuleInstancesInElement=function(e){var t=this,n=e.querySelectorAll(".".concat(this.moduleClass)),r=[];return n.forEach((function(e){var n=t.getModuleInstances(e);for(var o in n)r.push(n[o])})),r},e.prototype.notifyVisibilityChange=function(e,t){var n,r,i=this.getAllModuleInstancesInElement(e);try{for(var s=(0,o.XA)(i),l=s.next();!l.done;l=s.next())l.value.onVisibilityChange(t)}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},e.prototype.removeModulesFrom=function(){for(var e=[],t=0;arguments.length>t;t++)e[t]=arguments[t];var n=u(e,this.moduleClass);this.stopModules(n)},e.prototype.stopModules=function(e){var t,n;try{for(var r=(0,o.XA)(e),i=r.next();!i.done;i=r.next()){var s=i.value;if(this.modules.has(s)){var l=this.modules.get(s);for(var a in this.modules.delete(s),l)l[a].stop()}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e}(),f=n(7073),p=n(4955),y=new h(r.mH);f.Cd.then((function(){return y.bootstrap(document.documentElement),f.CL})).then((function(){return y.finalize()})).then((function(e){(0,p.wh)()&&(window.application_onlyExposedInEditMode=e),r.mH&&(window.application_onlyExposedInDevMode=e)})).catch(console.error.bind(console)),window.addEventListener("content-updated",(function(e){(null==e?void 0:e.target)&&y.lazyBootstrap(e.target).catch(console.error.bind(console))}))},5661:function(e,t,n){n.d(t,{Y:function(){return i}});var r=n(5480),o=n(9748),i=function(){function e(e,t,n){this.ctx=e,this.modName=t,this.app=n,this.debug=!1,this.hashKey=t,this.debug=n.debug,this.log=(0,r.O6)("Tc.Module.".concat(t))}return e.prototype.on=function(){},e.prototype.after=function(){},e.prototype.stop=function(){},e.prototype.onVisibilityChange=function(){},e.prototype.setModuleState=function(e){this.moduleStateChanged?(0,o.rk)(this.hashKey,e):this.log.error("Module is not hash-capable")},e}()}}]);
//# sourceMappingURL=611.a385b52d64c885047d95-legacy.js.map