!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("hivemind",[],e):"object"==typeof exports?exports.hivemind=e():t.hivemind=e()}(window,function(){return n=[function(D,t,e){"use strict";e.d(t,"h",function(){return n}),e.d(t,"i",function(){return r}),e.d(t,"j",function(){return o}),e.d(t,"g",function(){return i}),e.d(t,"k",function(){return a}),e.d(t,"l",function(){return s}),e.d(t,"m",function(){return u}),e.d(t,"n",function(){return c}),e.d(t,"o",function(){return l}),e.d(t,"p",function(){return f}),e.d(t,"q",function(){return p}),e.d(t,"r",function(){return h}),e.d(t,"t",function(){return d}),e.d(t,"u",function(){return y}),e.d(t,"s",function(){return m}),e.d(t,"v",function(){return g}),e.d(t,"w",function(){return v}),e.d(t,"x",function(){return b}),e.d(t,"y",function(){return S}),e.d(t,"A",function(){return O}),e.d(t,"B",function(){return w}),e.d(t,"z",function(){return _}),e.d(t,"C",function(){return j}),e.d(t,"E",function(){return T}),e.d(t,"D",function(){return E}),e.d(t,"b",function(){return k}),e.d(t,"a",function(){return A}),e.d(t,"Jb",function(){return C}),e.d(t,"Kb",function(){return x}),e.d(t,"Lb",function(){return I}),e.d(t,"dc",function(){return R}),e.d(t,"ec",function(){return P}),e.d(t,"hc",function(){return M}),e.d(t,"ic",function(){return F}),e.d(t,"jc",function(){return K}),e.d(t,"Rb",function(){return U}),e.d(t,"nc",function(){return B}),e.d(t,"mc",function(){return q}),e.d(t,"oc",function(){return z}),e.d(t,"Mb",function(){return W}),e.d(t,"f",function(){return V}),e.d(t,"e",function(){return H}),e.d(t,"jb",function(){return G}),e.d(t,"lb",function(){return Q}),e.d(t,"Fb",function(){return Y}),e.d(t,"Eb",function(){return J}),e.d(t,"Gb",function(){return $}),e.d(t,"Hb",function(){return X}),e.d(t,"Ib",function(){return Z}),e.d(t,"gc",function(){return tt}),e.d(t,"Wb",function(){return et}),e.d(t,"Vb",function(){return nt}),e.d(t,"Nb",function(){return rt}),e.d(t,"Ob",function(){return ot}),e.d(t,"Pb",function(){return it}),e.d(t,"Zb",function(){return at}),e.d(t,"Xb",function(){return st}),e.d(t,"kc",function(){return ut}),e.d(t,"bc",function(){return ct}),e.d(t,"lc",function(){return lt}),e.d(t,"ib",function(){return ft}),e.d(t,"kb",function(){return pt}),e.d(t,"rc",function(){return ht}),e.d(t,"qc",function(){return dt}),e.d(t,"pc",function(){return yt}),e.d(t,"F",function(){return mt}),e.d(t,"G",function(){return gt}),e.d(t,"d",function(){return vt}),e.d(t,"c",function(){return bt}),e.d(t,"cc",function(){return St}),e.d(t,"fc",function(){return Ot}),e.d(t,"Sb",function(){return wt}),e.d(t,"Tb",function(){return _t}),e.d(t,"Qb",function(){return jt}),e.d(t,"Yb",function(){return Tt}),e.d(t,"ac",function(){return Et}),e.d(t,"yc",function(){return kt}),e.d(t,"Dc",function(){return At}),e.d(t,"tc",function(){return Ct}),e.d(t,"Cc",function(){return xt}),e.d(t,"wc",function(){return It}),e.d(t,"vc",function(){return Rt}),e.d(t,"xc",function(){return Pt}),e.d(t,"uc",function(){return Nt}),e.d(t,"Ac",function(){return Lt}),e.d(t,"Bc",function(){return Dt}),e.d(t,"zc",function(){return Mt}),e.d(t,"sc",function(){return Ft}),e.d(t,"Ub",function(){return Kt}),e.d(t,"M",function(){return Ut}),e.d(t,"W",function(){return Bt}),e.d(t,"J",function(){return qt}),e.d(t,"H",function(){return zt}),e.d(t,"gb",function(){return Wt}),e.d(t,"fb",function(){return Vt}),e.d(t,"eb",function(){return Ht}),e.d(t,"R",function(){return Gt}),e.d(t,"Q",function(){return Qt}),e.d(t,"N",function(){return Yt}),e.d(t,"O",function(){return Jt}),e.d(t,"ab",function(){return $t}),e.d(t,"cb",function(){return Xt}),e.d(t,"Z",function(){return Zt}),e.d(t,"I",function(){return te}),e.d(t,"bb",function(){return ee}),e.d(t,"hb",function(){return ne}),e.d(t,"U",function(){return re}),e.d(t,"S",function(){return oe}),e.d(t,"K",function(){return ie}),e.d(t,"L",function(){return ae}),e.d(t,"T",function(){return se}),e.d(t,"P",function(){return ue}),e.d(t,"V",function(){return ce}),e.d(t,"db",function(){return le}),e.d(t,"Y",function(){return fe}),e.d(t,"X",function(){return pe}),e.d(t,"ub",function(){return he}),e.d(t,"tb",function(){return de}),e.d(t,"nb",function(){return N}),e.d(t,"ob",function(){return ye}),e.d(t,"pb",function(){return me}),e.d(t,"qb",function(){return ge}),e.d(t,"vb",function(){return L}),e.d(t,"wb",function(){return ve}),e.d(t,"yb",function(){return be}),e.d(t,"Bb",function(){return Se}),e.d(t,"Ab",function(){return Oe}),e.d(t,"xb",function(){return we}),e.d(t,"zb",function(){return _e}),e.d(t,"Cb",function(){return je}),e.d(t,"sb",function(){return Te}),e.d(t,"rb",function(){return Ee}),e.d(t,"Db",function(){return ke}),e.d(t,"mb",function(){return Ae});var n=0,r=1,o=2,i=3,a=4,s=5,u=6,c=7,l=8,f=9,p=10,h=11,d=12,y=13,m=14,g=15,v=16,b=17,S=18,O=19,w=20,_=21,j=22,T=23,E=24,k=25,A=26,C=27,x=28,I=29,R=30,P=31,M=32,F=33,K=34,U=35,B=36,q=37,z=38,W=39,V=100,H=101,G=102,Q=103,Y=104,J=105,$=106,X=107,Z=108,tt=109,et=110,nt=111,rt=112,ot=113,it=114,at=115,st=116,ut=117,ct=118,lt=119,ft=120,pt=121,ht=122,dt=123,yt=124,mt=200,gt=201,vt=202,bt=203,St=204,Ot=205,wt=206,_t=207,jt=208,Tt=209,Et=210,kt=211,At=212,Ct=213,xt=214,It=215,Rt=216,Pt=217,Nt=218,Lt=219,Dt=220,Mt=221,Ft=222,Kt=223,Ut=300,Bt=301,qt=302,zt=303,Wt=304,Vt=305,Ht=306,Gt=307,Qt=308,Yt=309,Jt=310,$t=311,Xt=312,Zt=313,te=314,ee=315,ne=316,re=317,oe=318,ie=319,ae=320,se=321,ue=322,ce=323,le=324,fe=325,pe=326,he="settings",de="Factory instantiation",N="engine",ye=N+":combiner: ",me=N+":matcher: ",ge=N+":value: ",L="sync",ve=L+":sync-manager: ",be=L+":offline: ",Se=L+":streaming: ",Oe=L+":split-changes: ",we=L+":my-segments: ",_e=L+":polling-manager: ",je=L+":submitter: ",Te="impressions-tracker: ",Ee="events-tracker: ",ke="unique-keys-tracker: ",Ae="cleanup: "},function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"b",function(){return o}),n.d(e,"c",function(){return a}),n.d(e,"d",function(){return s}),n.d(e,"e",function(){return u}),n.d(e,"f",function(){return c}),n.d(e,"g",function(){return l}),n.d(e,"h",function(){return f}),n.d(e,"i",function(){return p}),n.d(e,"j",function(){return h}),n.d(e,"k",function(){return d}),n.d(e,"n",function(){return y}),n.d(e,"l",function(){return m}),n.d(e,"m",function(){return g}),n.d(e,"o",function(){return v}),n.d(e,"p",function(){return b}),n.d(e,"q",function(){return S}),n.d(e,"r",function(){return O});var i=n(5);function r(t,e,n){return void 0===n&&(n=!1),!(!d(t)||!d(e))&&(n&&(t=t.toLowerCase(),e=e.toLowerCase()),t.slice(t.length-e.length)===e)}function o(t,e){var n;if(h(t))for(var r=Object.keys(t),o=0;o<r.length&&!n;o++){var i=r[o];e(t[i],i,t)&&(n=t[i])}else if(Array.isArray(t))for(o=0;o<t.length&&!n;o++)e(t[o],o,t)&&(n=t[o]);return n}function a(t,e){if(Array.isArray(t)&&"function"==typeof e)for(var n=0;n<t.length;n++)if(!0===e(t[n],n,t))return n;return-1}function s(e,n){return Object.keys(e).forEach(function(t){return n(e[t],t,e)}),e}function u(t,e,n){try{var r=e.split("."),o=t;r.forEach(function(t){return o=o[t]}),void 0!==o&&(n=o)}catch(t){}return n}function c(t,e){var n={};if(Array.isArray(t)&&d(e))for(var r=0;r<t.length;r++){var o=t[r][e];d(o)&&(n[o]||(n[o]=[]),n[o].push(t[r]))}return n}function l(t){return!0===t||!1===t}function f(t){return"number"==typeof(t=t instanceof Number?t.valueOf():t)&&(Number.isFinite?Number.isFinite(t):isFinite(t))}function p(t){return(t=t instanceof Number?t.valueOf():t)!=t}function h(t){return null!==t&&"object"==typeof t&&(t.constructor===Object||null!=t.constructor&&"Object"===t.constructor.name)}function d(t){return"string"==typeof t||t instanceof String}function y(t){return d(t)?t.toUpperCase():t}function m(t,n){for(var e=[],r=2;r<arguments.length;r++)e[r-2]=arguments[r];var o=t;return h(n)&&Object.keys(n).forEach(function(t){var e=n[t];void 0!==(e=h(e)?o[t]&&h(o[t])?m({},o[t],e):m({},e):e)&&(o[t]=e)}),e&&e.length&&(t=e.splice(0,1)[0],o=m.apply(void 0,Object(i.b)([o,t],e,!1))),o}function g(t,e){return!(!d(t)||!d(e))&&t.slice(0,e.length)===e}function v(t){var e;return"number"==typeof t?t:"string"!=typeof(t=h(t)&&"function"==typeof t.valueOf?h(e=t.valueOf())?e+"":e:t)?0===t?t:+t:+(t=t.replace(/^\s+|\s+$/g,""))}function b(t){var e;return null==t?"":"string"==typeof t?t:Array.isArray(t)?t.map(function(t){return d(t)?t:""})+"":"0"==(e=t+"")&&1/t===Number.NEGATIVE_INFINITY?"-0":e}function S(t){var e={};return t.filter(function(t){return!Object.prototype.hasOwnProperty.call(e,t)&&(e[t]=!0)})}function O(t,e){void 0===e&&(e=JSON.stringify);var n={};return t.filter(function(t){t=e(t);return!Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=!0)})}},function(t,e,n){"use strict";n.d(e,"a",function(){return r});
/*
Adaptation of "object-assign" library (https://www.npmjs.com/package/object-assign)
exported as an ES module instead of CommonJS, to avoid extra configuration steps when using
the ESM build of the SDK with tools that doesn't support CommonJS by default (e.g. Rollup).

object-assign
(c) Sindre Sorhus
@license MIT
*/
var u=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable;var r=function(){try{if(Object.assign){var t=new String("abc");if(t[5]="de","5"!==Object.getOwnPropertyNames(t)[0]){for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;var r,o=Object.getOwnPropertyNames(e).map(function(t){return e[t]});if("0123456789"===o.join(""))return r={},"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")?1:void 0}}}catch(t){}}()?Object.assign:function(t,e){for(var n,r=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),o=1;o<arguments.length;o++){for(var i in n=Object(arguments[o]))c.call(n,i)&&(r[i]=n[i]);if(u)for(var a=u(n),s=0;s<a.length;s++)l.call(n,a[s])&&(r[a[s]]=n[a[s]])}return r}},function(t,e,n){"use strict";var r=n(15),o=r.idTypes,i=r.experimentSources,a=r.PARAMETER_LABEL,r=r.DEFAULT_COHORT,s=n(66),u=s.validateApp,c=s.updateCohortAllocationsWithEid,l=s.generateDefaultAllocations,s=s.groupEligibleExperimentsById,f=n(67),p=f.getSubjectKey,h=f.getCohortId,d=f.getSubjectIdType,y=f.treatmentsToCohortAllocations,f=f.transformSplitToExperiment,m=n(70).settingsToExperiments,n=n(71);t.exports={hivemindConstants:{idTypes:o,experimentSources:i,PARAMETER_LABEL:a,DEFAULT_COHORT:r},MockWrapper:n,validateApp:u,updateCohortAllocationsWithEid:c,generateDefaultAllocations:l,groupEligibleExperimentsById:s,getSubjectKey:p,getCohortId:h,getSubjectIdType:d,treatmentsToCohortAllocations:y,transformSplitToExperiment:f,settingsToExperiments:m}},function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"c",function(){return u}),n.d(e,"b",function(){return f});var r=n(2),o=n(1),i=n(11),a={DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR",NONE:"NONE"},s={DEBUG:1,INFO:2,WARN:3,ERROR:4,NONE:5};function u(e){return!!Object(o.b)(a,function(t){return e===t})}function c(t,e){void 0===e&&(e=[]);var n=0;return(t=void 0===t?"":t).replace(/%s/g,function(){return e[n++]})}var l={prefix:"splitio",logLevel:a.NONE,showLevel:!0},f=(p.prototype.setLogLevel=function(t){this.options.logLevel=t,this.logLevel=s[t]},p.prototype.debug=function(t,e){this._shouldLog(s.DEBUG)&&this._log(a.DEBUG,t,e)},p.prototype.info=function(t,e){this._shouldLog(s.INFO)&&this._log(a.INFO,t,e)},p.prototype.warn=function(t,e){this._shouldLog(s.WARN)&&this._log(a.WARN,t,e)},p.prototype.error=function(t,e){this._shouldLog(s.ERROR)&&this._log(a.ERROR,t,e)},p.prototype._log=function(t,e,n){"number"==typeof e?e=(r=this.codes.get(e))?c(r,n):"Message code "+e+(n?", with args: "+n.toString():""):n&&(e=c(e,n));var r=this._generateLogMessage(t,e);console.log(r)},p.prototype._generateLogMessage=function(t,e){var n="";return this.options.showLevel&&(n+="["+t+"]"+(t===a.INFO||t===a.WARN?" ":"")+" "),this.options.prefix&&(n+=this.options.prefix+" => "),n+e},p.prototype._shouldLog=function(t){return t>=this.logLevel},p);function p(t,e){this.options=Object(r.a)({},l,t),this.codes=e||new i.a,this.logLevel=s[this.options.logLevel]}},function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"b",function(){return i});var r=function(t,e){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)};function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}Object.create;function i(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||((r=r||Array.prototype.slice.call(e,0,o))[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}Object.create},function(t,e,n){var n=n(41),r="object"==typeof self&&self&&self.Object===Object&&self,n=n||r||Function("return this")();t.exports=n},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,s=[],u=!0,c=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){var n;if(t)return"string"==typeof t?r(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(i){return function(t){for(var e=0,n=Object.entries(i);e<n.length;e++){var r=a(n[e],2),o=r[0];if(!(0,r[1])(t))return{isValid:!1,message:o}}return{isValid:!0}}}var i=new Set(["string","number","boolean"]),s=o({"Rule must have a `arrayName` property":function(t){return"arrayName"in t},"Rule's `arrayName` property must be a string":function(t){return"string"==typeof t.arrayName},"Rule must have a `elements` property":function(t){return"elements"in t},"Rule `elements` must be an Array":function(t){return Array.isArray(t.elements)},"Rule `elements` items must be strings, numbers, or booleans":function(t){return t.elements.every(function(t){return i.has(n(t))})}});t.exports={validComparableTypes:i,validator:o,setRuleValidator:s}},function(t,e,n){var r=n(92),o=n(98);t.exports=function(t,e){return t=o(t,e),r(t)?t:void 0}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function a(t,e,n){return(e=function(t){t=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===r(t)?t:String(t)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s=n(14).withNormalization,u=n(7).validator;t.exports={numericComparator:function(n){return{test:function(t){var e=t.rule,t=t.params[e.parameter];return n(t,e.value)},validate:u({"`parameter` property is required":function(t){return"parameter"in t},"`value` property is required":function(t){return"value"in t},"`parameter` must be a string":function(t){return"string"==typeof t.parameter},"`value` must be a number":function(t){return"number"==typeof t.value}})}},stringComparator:function(n,r){var t;return s({normalize:function(t){return i(i({},t),{},a({},n,!0===t.caseSensitive?String(t[n]):String(t[n]).toLocaleLowerCase()))},test:function(t){var e=t.rule,t=t.params,t=String(t[e.parameter]);return r(!0===e.caseSensitive?t:t.toLocaleLowerCase(),e[n])},validate:u((a(t={"parameter property is required":function(t){return"parameter"in t}},"".concat(n," property is required"),function(t){return n in t}),a(t,"parameter must be a string",function(t){return"string"==typeof t.parameter}),a(t,"".concat(n," must be a string"),function(t){return"string"==typeof t[n]}),a(t,"caseSensitive must be a boolean",function(t){return!("caseSensitive"in t)||"bool"==typeof t.caseSensitive}),t))})}}},function(t,e,n){"use strict";function r(){var t="__SPLITSOFTWARE__";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(t){return!1}}n.d(e,"a",function(){return r})},function(t,e,n){"use strict";n.d(e,"a",function(){return o});r.prototype.clear=function(){this.__mapKeysData__.length&&(this.__mapKeysData__.length=0,this.__mapValuesData__.length=0)},r.prototype.delete=function(t){t=this.__mapKeysData__.indexOf(t);return-1!==t&&(this.__mapKeysData__.splice(t,1),this.__mapValuesData__.splice(t,1),!0)},r.prototype.forEach=function(t,e){for(var n=0;n<this.__mapKeysData__.length;n++)t.call(e,this.__mapValuesData__[n],this.__mapKeysData__[n],this)},r.prototype.get=function(t){t=this.__mapKeysData__.indexOf(t);if(-1!==t)return this.__mapValuesData__[t]},r.prototype.has=function(t){return-1!==this.__mapKeysData__.indexOf(t)},r.prototype.set=function(t,e){var n=this.__mapKeysData__.indexOf(t);return-1===n&&(n=this.__mapKeysData__.push(t)-1),this.__mapValuesData__[n]=e,this},Object.defineProperty(r.prototype,"size",{get:function(){return this.__mapKeysData__.length},enumerable:!1,configurable:!0});n=r;function r(t){var e=this;this.__mapKeysData__=[],this.__mapValuesData__=[],Array.isArray(t)&&t.forEach(function(t){e.set(t[0],t[1])})}var o="function"==typeof Array.from&&"function"==typeof Map&&Map.prototype&&Map.prototype.values?Map:n},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e){t.exports={withNormalization:function(t){var e=t.validate,r=t.normalize,o=t.test,i=new WeakMap;return{validate:e,test:function(t){var e=t.rule,t=t.params,n=i.get(e);return n||(n=r(e),i.set(e,n)),o({rule:n,params:t})}}}}},function(t,e){t.exports={idTypes:{SHOPPER_ID:"shopperId",VISITOR_GUID:"visitorGuid"},switchboardIdTypes:{VISITOR_ID:"visitorId",CUSTOMER_ID:"customerId",SHOPPER_ID:"shopperId"},experimentSources:{SWITCHBOARD:"appConfig",SPLIT_IO:"split.io"},DEFAULT_COHORT:"ineligible",PARAMETER_LABEL:"parameter"}},function(t,e,n){var r=n(82),o=n(83),i=n(84),a=n(85),n=n(86);function s(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}s.prototype.clear=r,s.prototype.delete=o,s.prototype.get=i,s.prototype.has=a,s.prototype.set=n,t.exports=s},function(t,e,n){var r=n(39);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},function(t,e,n){var r=n(24),o=n(94),i=n(95),a=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":(a&&a in Object(t)?o:i)(t)}},function(t,e,n){n=n(8)(Object,"create");t.exports=n},function(t,e,n){var r=n(108);t.exports=function(t,e){return t=t.__data__,r(e)?t["string"==typeof e?"string":"hash"]:t.map}},function(t,e,n){var c=n(43),l=n(44);t.exports=function(t,e,n,r){for(var o=!n,i=(n=n||{},-1),a=e.length;++i<a;){var s=e[i],u=r?r(n[s],t[s],s,n,t):void 0;void 0===u&&(u=t[s]),(o?l:c)(n,s,u)}return n}},function(t,e,n){"use strict";e.__esModule=!0;function a(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=t[n];try{if(e(n,r))return t}catch(t){}}return t}function s(t){if(2===t.length)return t[1]}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c=arguments;e.cleanKeyNames=function(r,o,i){r&&o&&a(r,function(t,e){var n=(t+"").split(o).join(i||"");delete r[t],r[n]=e})},e.map=a,e.merge=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r={},o=0;o<c.length;o++){var i=e[o];"object"===(void 0===i?"undefined":u(i))&&a(i,function(t,e){r[t]=e})}return r},e.parseString=function(t,e,n){if("string"!=typeof t)return{};for(var r={},o=t.split(e),i=0;i<o.length;i++){var a=o[i].split(n);r[a[0]]=s(a)}return r},e.parseValue=s,e.stringify=function(t,e,n){var r=[];return a(t,function(t,e){r.push(""+t+n+e)}),0===r.length?"":r.join(e)},e.removeUndefined=function(t){for(var e in t)void 0===t[e]&&delete t[e]}},function(t,e,n){n=n(8)(n(6),"Map");t.exports=n},function(t,e,n){n=n(6).Symbol;t.exports=n},function(t,e,n){var r=n(45),o=n(122),i=n(49);t.exports=function(t){return(i(t)?r:o)(t)}},function(t,e){var n=Array.isArray;t.exports=n},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){t.exports=function(e){return function(t){return e(t)}}},function(t,i,a){!function(t){var e=a(41),n=i&&!i.nodeType&&i,r=n&&"object"==typeof t&&t&&!t.nodeType&&t,o=r&&r.exports===n&&e.process,n=function(){try{var t=r&&r.require&&r.require("util").types;return t?t:o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=n}.call(this,a(27)(t))},function(t,e){var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},function(t,e,n){var r=n(45),o=n(125),i=n(49);t.exports=function(t){return i(t)?r(t,!0):o(t)}},function(t,e,n){var r=n(130),n=n(50),o=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols;t.exports=i?function(e){return null==e?[]:(e=Object(e),r(i(e),function(t){return o.call(e,t)}))}:n},function(t,e,n){var r=n(134),o=n(23),i=n(135),a=n(136),s=n(137),u=n(18),c=n(42),l="[object Map]",f="[object Promise]",p="[object Set]",h="[object WeakMap]",d="[object DataView]",y=c(r),m=c(o),g=c(i),v=c(a),b=c(s),n=u;(r&&n(new r(new ArrayBuffer(1)))!=d||o&&n(new o)!=l||i&&n(i.resolve())!=f||a&&n(new a)!=p||s&&n(new s)!=h)&&(n=function(t){var e=u(t),t="[object Object]"==e?t.constructor:void 0,t=t?c(t):"";if(t)switch(t){case y:return d;case m:return l;case g:return f;case v:return p;case b:return h}return e}),t.exports=n},function(t,e,n){var r=n(140);t.exports=function(t){var e=new t.constructor(t.byteLength);return new r(e).set(new r(t)),e}},function(t,e,n){"use strict";e.__esModule=!0,e._cryptOrUndefined=e._getDelegationClaims=e._getInfoTokenClaim=e._getInfoTokenClaims=e.getUserId=e.updateAuthTokens=e.isEmployee=e.isDelegated=e.isAuthenticated=e.getShopperId=e.getUserRealm=e.getCustomerId=e.getFederationPartnerId=e.getEmployeeId=e.getDelegateEmployeeId=e.getDelegateCustomerId=e.getClaimFromInfoToken=void 0;function o(t){var e={};if(t=(0,s.findCookie)("info_"+t))try{e=JSON.parse(t)}catch(t){}return e}function r(t,e,n){if(h()&&"basic"!==c.auth)return n=d(c,n),y(e,n[t])}function i(t){return r(f.jomax,t)}function a(t,e,n){var r=t.typ;if(void 0===n||!r||r===n)return(r=t.auth)&&"basic"!==r?a(t[r],e,n):t[e]}var s=n(37),u=n(74),c={},l=["idp","jomax"],f={idp:"info_shopperId",jomax:"info_accountName"},p=function(t){return Object.keys(t).length<1},h=function(){return!p(c)},d=function t(e,n){return"del"in e?!n||e.del.typ&&e.del.typ===n?t(e.del,n):t(e[e.auth],n):e},y=function(t,e){return t?e?(0,u.sha256)(e):void 0:e};e.getClaimFromInfoToken=function(t){if(h())return a(c,t)},e.getDelegateCustomerId=function(t){return r("info_cid",t,"idp")},e.getDelegateEmployeeId=i,e.getEmployeeId=function(t){var e,n,r;if(h())return r=c.typ,e=c.auth,n=f.jomax,r&&"jomax"===r?y(t,c[n]):e&&"basic"!==e&&"e"===e.charAt(0)?i(t):(r=o("jomax"),p(r)?void 0:y(t,r[n]))},e.getFederationPartnerId=function(){var t,e;if(h())return(t=a(c,"fpid"))||void 0!==(e=c.typ)&&(t=(0,s.findCookie)("brand_"+e)),t},e.getCustomerId=function(t){if(h())return y(t,a(c,"info_cid"))},e.getUserRealm=function(){if(h())return c.typ},e.getShopperId=function(t){if(h()&&"idp"===c.typ)return y(t,a(c,"info_shopperId"))},e.isAuthenticated=h,e.isDelegated=function(){var t;return!!h()&&(t=c.auth)&&"basic"!==t},e.isEmployee=function(){var t,e;return!(!h()||(e=c.typ,t=c.auth,(!e||"jomax"!==e)&&(!t||"basic"===t||"e"!==t.charAt(0))&&(e=o("jomax"),p(e))))},e.updateAuthTokens=function(){for(var t={},e=0;e<l.length;e++){var n=o(l[e]);!p(n)&&(p(t)||t.iat<n.iat)&&(t=n)}c=t},e.getUserId=function(t){var e;if(h())return e=c.typ,y(t,a(c,f[e]))},e._getInfoTokenClaims=o,e._getInfoTokenClaim=a,e._getDelegationClaims=d,e._cryptOrUndefined=y},,function(t,e,n){"use strict";e.__esModule=!0,e._resetCookieCache=e._notifyWatchers=e.watchCookie=e.setCookie=e.getCookieValues=e.getCookieValue=e.getCookieObj=e.getCookieKeys=e.findCookie=e.checkCookiesEnabled=void 0;var a=n(38),r=n(22),n=n(72),s=(n=n)&&n.__esModule?n:{default:n};function o(t,e,n,r){var o=s.default.get("tcc.cookies.sameSite")||"",i=new Date;i.setTime(i.getTime()+60*n*1e3),(0,a.getDocument)().cookie=t+"="+encodeURI(e)+"; domain="+(0,a.getBaseHost)()+"; "+(n?"expires="+i.toGMTString()+"; ":"")+(r?"path="+r+"; ":"")+(o?"SameSite="+o+"; ":"")+("NONE"===o.toUpperCase()?" Secure;":"")}function i(t){return t=f(t),(0,r.parseString)(t,"&","=")}function u(){for(var t=0;t<d.length;t++)try{!0===d[t]()&&d.splice(t,1)}catch(t){continue}}var c=void 0,l=void 0,f=function(t){var e=(0,a.getDocument)().cookie;return c!==e&&(l=(0,a.parseCookie)(e),c=e),l[t]},p=void 0,h=void 0,d=[];e.checkCookiesEnabled=function(t){var e=!!t.cookieEnabled;return void 0!==t.cookieEnabled||e||(o((0,a.getDocument)(),"testcookie"),e=-1!==(0,a.getDocument)().cookie.indexOf("testcookie")),e},e.findCookie=f,e.getCookieKeys=function(){for(var t=[],e=(0,a.getDocument)().cookie.split(";"),n=0;n<e.length;n++){var r=e[n].split("=")[0];""!==r&&t.push(r.trim())}return t},e.getCookieObj=function(t){t=f(t);try{return JSON.parse(t)}catch(t){}},e.getCookieValue=function(t,e){t=i(t);if(t.hasOwnProperty(e))return t[e]},e.getCookieValues=i,e.setCookie=o,e.watchCookie=function(t){!0!==t()&&(d.push(t),1===d.length)&&(h=setInterval(function(){p!==(0,a.getDocument)().cookie&&(p=(0,a.getDocument)().cookie,u()),0===d.length&&clearInterval(h)},200))},e._notifyWatchers=u,e._resetCookieCache=function(){c=void 0,l=Object.create(null)}},function(t,e,n){"use strict";e.__esModule=!0,e._setWindow=e._setNavigator=e._setDocument=e._getWindowEvent=e._getEventElement=e._getClickCoordinates=e._findPosY=e._findPosX=e.parseCookie=e.getPromoEventData=e.isSupported=e.isCorporateHost=e.iterateAncestors=e.isValidHrefElement=e.getWindow=e.getNavigator=e.getHost=e.getDocument=e.getClickEventData=e.getBaseHost=e.getAttributeFromElement=e.formatPageName=void 0;function o(){return s.document}var r,i,a,u=n(22),s=(r="",n=Object.create({get cookie(){return r},set cookie(t){r=t}}),i={document:n},a={},"undefined"==typeof window?{window:i,document:n,navigator:a}:{window:window||i,document:window.document||n,navigator:navigator||a}),c=function(){return s.window};function l(){return s.navigator}function f(){var t=c().location;return t&&t.hostname?t.hostname:""}function p(){var t=f(),e=t.split(".");return t=2<=e.length?e.slice(e.length-2).join("."):t}function h(t,e,n){var r;if(n&&n.clientX&&n.clientY&&n.pageX&&n.pageY)return r={},t&&e&&-1!==e.userAgent.indexOf("MSIE")?(e="CSS1Compat"===t.compatMode?t.documentElement:t.body,r.pagex=Math.round(n.clientX+(e.scrollLeft||0)),r.pagey=Math.round(n.clientY+(e.scrollTop||0))):(r.pagex=Math.round(n.pageX),r.pagey=Math.round(n.pageY)),r.clientx=Math.round(n.clientX),r.clienty=Math.round(n.clientY),r}function d(t){var e=0;if(t.offsetParent)for(;t.offsetParent;)e+=t.offsetLeft,t=t.offsetParent;else t.x&&(e+=t.x);return e}function y(t){var e=0;if(t.offsetParent)for(;t.offsetParent;)e+=t.offsetTop,t=t.offsetParent;else t.y&&(e+=t.y);return e}function m(t,e,n){var r,n=n||1;if(e&&!(10<n))return!(r=t(e))&&e.parentNode?m(t,e.parentNode,n+1):r}function g(){var t=S();if(null!=t){t=t.target||t.srcElement;if(null!=t)return t=t.nodeType&&3===t.nodeType?t.parentNode:t}}function v(t,e){if(t&&t.attributes&&t.attributes[e]&&t.attributes[e].value)return t.attributes[e].value}function b(t){return"A"===(t=t.nodeName)||"AREA"===t}var S=function(){return c().event};e.formatPageName=function(t){return"string"!=typeof t||void 0===t||""===t?"notspecified":0!==(t=t.lastIndexOf("/")===t.length-1?t.substring(0,t.length-1):t).indexOf("/")?"/"+t:t},e.getAttributeFromElement=v,e.getBaseHost=p,e.getClickEventData=function(t,e){var n=o(),r=l(),e=e||S(),t=t||g(),s={};return t&&(s.type=t.type,s.eventid=t.id,s.eventclass=t.className,s.eventname=t.name,m(function(t){var e=v(t,"data-tcode"),n=v(t,"data-tdata"),r=v(t,"data-ci"),o=v(t,"data-tms"),i=v(t,"data-eid"),a=(i=(i=i||v(t,"data-e_id"))||v(t,"e_id"),void 0);if(b(t)&&(a=v(t,"href")),e||n||r||o||i||a)return e&&(s.tcode=e),n&&(s.usrin=n),r&&(s.ci=r),o&&(s.tms=o),i&&(s.e_id=i),a&&(s.href=a),s},t),(n=h(n,r,e))?(s.absolutex=n.pagex,s.absolutey=n.pagey,s.relativex=n.clientx,s.relativey=n.clienty):(r=d(t),e=y(t),s.absolutex=r,s.absolutey=e,s.relativex=r,s.relativey=e)),(0,u.removeUndefined)(s),s},e.getDocument=o,e.getHost=f,e.getNavigator=l,e.getWindow=c,e.isValidHrefElement=b,e.iterateAncestors=m,e.isCorporateHost=function(t){t=t||p();return 0<=t.indexOf("godaddy.com")||0<=t.indexOf("secureserver.net")},e.isSupported=function(){var t=l().userAgent.toLowerCase();return!/msie [1-8]\./.test(t)},e.getPromoEventData=function(t){var t=t||g(),r={},e={schema:"data-schema",id:"data-promo-id",name:"data-promo-name",creative_name:"data-creative-name",creative_slot:"data-creative-slot"};return t&&m(function(n){(0,u.map)(e,function(t,e){e=v(n,e);e&&!r[t]&&(r[t]=e)}),b(n)&&(r.href=v(n,"href"))},t),r},e.parseCookie=function(t){for(var e=t.split(";"),n=Object.create(null),r=0;r<e.length;r++){var o,i=/([^=]*)*=([\s\S]*)/.exec(e[r]);i&&i[2]&&(o=i[1].trim(),i=decodeURIComponent(i[2].trim()),n[o]=i)}return n},e._findPosX=d,e._findPosY=y,e._getClickCoordinates=h,e._getEventElement=g,e._getWindowEvent=S,e._setDocument=function(t){t=t||{};s.window.document=t,s.document=t},e._setNavigator=function(t){s.navigator=t||{}},e._setWindow=function(t){s.window=t||{}}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,n){var r=n(18),o=n(12);t.exports=function(t){return!!o(t)&&("[object Function]"==(t=r(t))||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t)}},function(e,t,n){!function(t){t="object"==typeof t&&t&&t.Object===Object&&t;e.exports=t}.call(this,n(93))},function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e,n){var o=n(44),i=n(39),a=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var r=t[e];a.call(t,e)&&i(r,n)&&(void 0!==n||e in t)||o(t,e,n)}},function(t,e,n){var r=n(113);t.exports=function(t,e,n){"__proto__"==e&&r?r(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},function(t,e,n){var l=n(115),f=n(116),p=n(26),h=n(46),d=n(119),y=n(120),m=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n,r=p(t),o=!r&&f(t),i=!r&&!o&&h(t),a=!r&&!o&&!i&&y(t),s=r||o||i||a,u=s?l(t.length,String):[],c=u.length;for(n in t)!e&&!m.call(t,n)||s&&("length"==n||i&&("offset"==n||"parent"==n)||a&&("buffer"==n||"byteLength"==n||"byteOffset"==n)||d(n,c))||u.push(n);return u}},function(t,i,a){!function(t){var e=a(6),n=a(118),r=i&&!i.nodeType&&i,o=r&&"object"==typeof t&&t&&!t.nodeType&&t,o=o&&o.exports===r?e.Buffer:void 0,r=o?o.isBuffer:void 0;t.exports=r||n}.call(this,a(27)(t))},function(t,e){t.exports=function(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=9007199254740991}},function(t,e){t.exports=function(e,n){return function(t){return e(n(t))}}},function(t,e,n){var r=n(40),o=n(47);t.exports=function(t){return null!=t&&o(t.length)&&!r(t)}},function(t,e){t.exports=function(){return[]}},function(t,e,n){var r=n(52),o=n(53),i=n(32),n=n(50),a=Object.getOwnPropertySymbols;t.exports=a?function(t){for(var e=[];t;)r(e,i(t)),t=o(t);return e}:n},function(t,e){t.exports=function(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}},function(t,e,n){n=n(48)(Object.getPrototypeOf,Object);t.exports=n},function(t,e,n){var r=n(52),o=n(26);t.exports=function(t,e,n){return e=e(t),o(t)?e:r(e,n(t))}},function(t,e,n){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var u=n(170),a=["gt","ge"],s=["lt","le"],c=s.concat(a),l={lt:function(t,e){return 0<t&&e()<t},le:function(t,e){return 1===t||e()<=t},gt:function(t,e){return t<1&&e()>t},ge:function(t,e){return 0===t||e()>=t}};t.exports={validate:function(n){if(!n.idType)return{isValid:!1,message:"Id percentage rules must have an idType"};for(var r=0,o=0;o<c.length;o++){var t=function(){var e,t=c[o];if(t in n)return e=n[t],isNaN(e)||e<0||1<e?{v:{isValid:!1,message:"Invalid percentage ".concat(e,"; must be a number between 0.0 and 1.0.")}}:0<r&&(0<=s.indexOf(t)&&a.some(function(t){return t in n&&n[t]>=e})||0<=a.indexOf(t)&&s.some(function(t){return t in n&&n[t]<=e}))?{v:{isValid:!1,message:"Ranges do not overlap"}}:void r++}();if("object"===i(t))return t.v}return 0===r?{isValid:!1,message:"You must provide a percentage range using lt, le, gt, and/or ge properties"}:{isValid:!0}},test:function(t){var e=t.key,n=t.rule,t=t.params,r=(void 0===t?{}:t)[n.idType];if(!r)return!1;var o=null;function i(){var t;return null===o&&(t=u("".concat(r).concat(e)),o=parseInt(t.substring(0,8),16)/4294967295),o}for(var a=0;a<c.length;a++){var s=c[a];if(s in n&&null!==n[s]&&!l[s](n[s],i))return!1}return!0}}},function(t,e){var n={utf8:{stringToBytes:function(t){return n.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(n.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e},bytesToString:function(t){for(var e=[],n=0;n<t.length;n++)e.push(String.fromCharCode(t[n]));return e.join("")}}};t.exports=n},function(t,e){var n,r,t=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(t){r=i}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return(n=setTimeout)(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}var s,u=[],c=!1,l=-1;function f(){c&&s&&(c=!1,s.length?u=s.concat(u):l=-1,u.length)&&p()}function p(){if(!c){for(var t=a(f),e=(c=!0,u.length);e;){for(s=u,u=[];++l<e;)s&&s[l].run();l=-1,e=u.length}s=null,c=!1,!function(e){if(r===clearTimeout)return clearTimeout(e);if((r===i||!r)&&clearTimeout)return(r=clearTimeout)(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function d(){}t.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new h(t,e)),1!==u.length||c||a(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=d,t.addListener=d,t.once=d,t.off=d,t.removeListener=d,t.removeAllListeners=d,t.emit=d,t.prependListener=d,t.prependOnceListener=d,t.listeners=function(t){return[]},t.binding=function(t){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(t){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},function(t,e,n){"use strict";e.__esModule=!0,e.getVisitorId=void 0;var r=n(37),o=n(75);e.getVisitorId=function(){var t=function(){var t=(0,r.getCookieValues)("visitor");if(t)return t.vid}();return t||(0,o.debug)("A user identifier was unable to be retrived"),t}},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},o=(Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n(77));Object.defineProperty(e,"default",{enumerable:!0,get:function(){return r(o).default}})},function(t,e,n){t.exports=n(153)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;n=((n=n(178))&&n.__esModule?n:{default:n}).default;e.default=n},function(t,l,f){"use strict";!function(t){f.d(l,"a",function(){return c});var n=f(4),e=f(10),r=f(63),o=f(65),i=f(11),a=f(64),s=new i.a(o.a),i=String(r.a?t.env.SPLITIO_DEBUG:Object(e.a)()?localStorage.getItem("splitio_debug"):""),u=n.a.NONE;function c(t){var t=t.debug,t=void 0!==t?Object(a.a)(t):u,e=new n.b({logLevel:t||u},s);return t||e._log(n.a.ERROR,"Invalid Log Level - No changes to the logs will be applied."),e}/^(enabled?|on)/i.test(i)?u=n.a.DEBUG:Object(n.c)(i)&&(u=i)}.call(this,f(57))},function(t,n,r){"use strict";!function(t){r.d(n,"a",function(){return e});var e=!(void 0===t||void 0===t.version||!t.version)}.call(this,r(57))},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(4);function o(t){return"boolean"==typeof t?t?r.a.DEBUG:r.a.NONE:"string"==typeof t&&Object(r.c)(t)?t:void 0}},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var e=n(0),n="Split SDK is ready",r=[[e.M,e.ob+"Invalid Split, no valid rules found"],[e.W,"logger: Invalid Log Level - No changes to the logs will be applied."],[e.H,"The SDK will not get ready. Reason: %s"],[e.R,e.sb+"Could not store impressions bulk with %s impression(s). Error: %s"],[e.Q,e.sb+"Impression listener logImpression method threw: %s."],[e.N,e.rb+"Failed to queue %s"],[e.gb,e.yb+"There was an issue loading the mock Splits data, no changes will be applied to the current cache. %s"],[e.fb,e.Bb+"Failed to connect or error on streaming connection, with error message: %s"],[e.eb,e.Bb+"Failed to authenticate for streaming. Error: %s."],[e.P,"Response status is not OK. Status: %s. URL: %s. Message: %s"],[e.J,"A listener was added for %s on the SDK, which has already fired and won't be emitted again. The callback won't be executed."],[e.I,"%s: Client has already been destroyed - no calls possible."],[e.O,'%s: you passed "%s", event_type must adhere to the regular expression /^[a-zA-Z0-9][-_.:a-zA-Z0-9]{0,79}$/g. This means an event_type must be alphanumeric, cannot be more than 80 characters long, and can only include a dash, underscore, period, or colon as separators of alphanumeric characters.'],[e.ab,"%s: %s must be a plain object."],[e.cb,"%s: the maximum size allowed for the properties is 32768 bytes, which was exceeded. Event not queued."],[e.Z,"%s: value must be a finite number."],[e.bb,"%s: you passed a null or undefined %s. It must be a non-empty string."],[e.hb,"%s: %s too long. It must have 250 characters or less."],[e.U,"%s: Key must be an object with bucketingKey and matchingKey with valid string properties."],[e.S,"%s: you passed an invalid %s. It must be a non-empty string."],[e.K,"%s: you passed an empty %s. It must be a non-empty string."],[e.L,"%s: %s must be a non-empty array."],[e.Y,"%s: provided param must be a boolean value."],[e.T,e.ub+': you passed an invalid "%s" config param. It should be one of the following values: %s. Defaulting to "%s".'],[e.V,e.ub+': an invalid value was received for "sync.localhostMode" config. A valid entity should be provided for localhost mode.'],[e.db,e.ub+": the provided storage is invalid.%s Falling back into default MEMORY storage"],[e.X,e.ub+': the provided "%s" config param is lower than allowed. Setting to the minimum value %s seconds']].concat([[e.F,e.qb+"Value %s doesn't match with expected type."],[e.G,e.qb+"Defined attribute [%s], no attributes received."],[e.cc,e.xb+"Retrying download of segments #%s. Reason: %s"],[e.fc,e.Ab+"Error while doing fetch of Splits. %s"],[e.Sb,e.Bb+"Error parsing SSE error notification: %s"],[e.Tb,e.Bb+"Error parsing SSE message notification: %s"],[e.Qb,e.Bb+"Falling back to polling mode. Reason: %s"],[e.Yb,e.Cb+"Dropping %s after retry. Reason: %s."],[e.ac,e.Cb+"Failed to push %s, keeping data to retry on next iteration. Reason: %s."],[e.c,"%s: the SDK is not ready, results may be incorrect. Make sure to wait for SDK readiness before using this method."],[e.d,"No listeners for SDK Readiness detected. Incorrect control treatments could have been logged if you called getTreatment/s while the SDK was not yet ready."],[e.yc,'%s: Property "%s" is of invalid type. Setting value to null.'],[e.Dc,"%s: Event has more than 300 properties. Some of them will be trimmed when processed."],[e.tc,'%s: %s "%s" is not of type string, converting.'],[e.Cc,'%s: %s "%s" has extra whitespace, trimming.'],[e.wc,'%s: split "%s" does not exist in this environment, please double check what splits exist in the Split web console.'],[e.vc,"%s: traffic_type_name should be all lowercase - converting string to lowercase."],[e.xc,'%s: traffic type "%s" does not have any corresponding split in this environment, make sure you\'re tracking your events to a valid traffic type defined in the Split web console.'],[e.uc,e.ub+": %s integration item(s) at settings is invalid. %s"],[e.Ac,e.ub+': split filters have been configured but will have no effect if mode is not "%s", since synchronization is being deferred to an external tool.'],[e.Bc,e.ub+': split filter at position %s is invalid. It must be an object with a valid filter type ("byName" or "byPrefix") and a list of "values".'],[e.zc,e.ub+": splitFilters configuration must be a non-empty array of filter objects."],[e.sc,e.ub+": You already have %s. We recommend keeping only one instance of the factory at all times (Singleton pattern) and reusing it throughout your application"],[e.Ub,e.Bb+"Fetching MySegments due to an error processing %s notification: %s"]]).concat([[e.f,n+" from cache"],[e.e,n],[e.jb,e.sb+"Split: %s. Key: %s. Evaluation: %s. Label: %s"],[e.lb,e.sb+"Queueing corresponding impression."],[e.Fb,"New shared client instance created."],[e.Eb,"New Split SDK instance created."],[e.ib,e.rb+"Successfully queued %s"],[e.kb,e.sb+"Successfully stored %s impression(s)."],[e.rc,"UserConsent: consent status changed from %s to %s."],[e.qc,"UserConsent: call had no effect because it was the current consent status (%s)."],[e.pc,"Starting the SDK with %s user consent. No data will be sent."],[e.Gb,e.zb+"Turning segments data polling %s."],[e.Hb,e.zb+"Starting polling"],[e.Ib,e.zb+"Stopping polling"],[e.gc,e.Ab+"Retrying download of splits #%s. Reason: %s"],[e.Zb,e.Cb+"Flushing full %s queue and reseting timer."],[e.Xb,e.Cb+"Pushing %s."],[e.Wb,e.Bb+"Refreshing streaming token in %s seconds, and connecting streaming in %s seconds."],[e.Vb,e.Bb+"Attempting to reconnect streaming in %s seconds."],[e.Nb,e.Bb+"Connecting streaming."],[e.Ob,e.Bb+"Streaming is disabled for given Api key. Switching to polling mode."],[e.Pb,e.Bb+"Disconnecting streaming."],[e.kc,e.wb+"Streaming not available. Starting polling."],[e.bc,e.wb+"Streaming couldn't connect. Continue polling."],[e.lc,e.wb+"Streaming connected. Syncing and stopping polling."]]).concat([[e.h,e.ob+"[andCombiner] evaluates to %s"],[e.i,e.ob+"Treatment found: %s"],[e.j,e.ob+"All predicates evaluated, no treatment found."],[e.g,e.nb+': using algo "murmur" bucket %s for key %s using seed %s - treatment %s'],[e.k,e.pb+"[allMatcher] is always true"],[e.l,e.pb+"[betweenMatcher] is %s between %s and %s? %s"],[e.m,e.pb+"[booleanMatcher] %s === %s"],[e.n,e.pb+"[containsAllMatcher] %s contains all elements of %s? %s"],[e.o,e.pb+"[containsAnyMatcher] %s contains at least an element of %s? %s"],[e.p,e.pb+"[containsStringMatcher] %s contains %s? %s"],[e.q,e.pb+'[dependencyMatcher] parent split "%s" evaluated to "%s" with label "%s". %s evaluated treatment is part of [%s] ? %s.'],[e.r,e.pb+'[dependencyMatcher] will evaluate parent split: "%s" with key: %s %s'],[e.t,e.pb+"[equalToMatcher] is %s equal to %s? %s"],[e.u,e.pb+"[equalToSetMatcher] is %s equal to set %s? %s"],[e.s,e.pb+"[endsWithMatcher] %s ends with %s? %s"],[e.v,e.pb+"[greaterThanEqualMatcher] is %s greater than %s? %s"],[e.w,e.pb+"[lessThanEqualMatcher] is %s less than %s? %s"],[e.x,e.pb+"[partOfMatcher] %s is part of %s? %s"],[e.y,e.pb+"[segmentMatcher] evaluated %s / %s => %s"],[e.A,e.pb+"[stringMatcher] does %s matches with %s? %s"],[e.B,e.pb+"[stringMatcher] %s is an invalid regex"],[e.z,e.pb+"[startsWithMatcher] %s starts with %s? %s"],[e.C,e.pb+"[whitelistMatcher] evaluated %s in [%s] => %s"],[e.E,e.qb+"Extracted attribute [%s], [%s] will be used for matching."],[e.D,e.nb+":sanitize: Attempted to sanitize [%s] which should be of type [%s]. Sanitized and processed value => [%s]"],[e.b,e.mb+"Registering cleanup handler %s"],[e.a,e.mb+"Deregistering cleanup handler %s"],[e.Jb,"Retrieving default SDK client."],[e.Kb,"Retrieving existing SDK client."],[e.Lb,"Retrieving manager instance."],[e.dc,e.yb+"Splits data: \n%s"],[e.ec,e.Ab+"Spin up split update using since = %s"],[e.hc,e.Ab+"New splits %s"],[e.ic,e.Ab+"Removed splits %s"],[e.jc,e.Ab+"Segment names collected %s"],[e.Rb,e.Bb+"New SSE message received, with data: %s."],[e.nc,e.vb+": Starting %s. Running each %s millis"],[e.mc,e.vb+": Running %s"],[e.oc,e.vb+": Stopping %s"],[e.Mb,e.ub+': splits filtering criteria is "%s".']])},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,s=[],u=!0,c=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){var n;if(t)return"string"==typeof t?o(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e,n){return(e=function(t){t=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===r(t)?t:String(t)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s=n(15).DEFAULT_COHORT;t.exports={validateApp:function(){if(!(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").match(/^[a-z0-9_-]+$/))throw new Error("Parameter 'app' must match regex '/^[a-z0-9_-]+$/'")},updateCohortAllocationsWithEid:function(n,r){return Object.keys(n).forEach(function(t){var e=n[t].error?"error":n[t].cohortId;n[t].eid="hivemind.".concat(r,".experiment.").concat(t,".").concat(e,".impression")}),n},generateDefaultAllocations:function(t){return t.reduce(function(t,e){return Object.assign(t,a({},e,{cohortId:s,data:{}}))},{})},groupEligibleExperimentsById:function(t){var r=t.subject,e=t.experiments,n=t.experimentsMetadata,o=e.filter(function(t){return!(t in n)});return{experimentsByIdType:Object.entries(n).reduce(function(t,e){var e=i(e,2),n=e[0],e=e[1];return(r[e.subjectIdType]?(t[e.subjectIdType]||(t[e.subjectIdType]=[]),t[e.subjectIdType]):o).push(n),t},{}),ineligibleExperiments:o}}}},function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function s(r){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach(function(t){var e,n;e=r,n=o[t=t],(t=function(t){t=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===i(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(o,t))})}return r}var u=n(68).unflatten,r=n(15),o=r.idTypes,c=r.DEFAULT_COHORT,l=n(69).sha256;function f(t){return"control"===t?c:t}function p(t){switch(t){case"shopper":return o.SHOPPER_ID;case"visitor":return o.VISITOR_GUID;default:return t}}t.exports={getCohortId:f,getSubjectKey:function(t){var e=t.id;switch(t.idType){case o.SHOPPER_ID:return l(e);case o.VISITOR_GUID:return e;default:throw new Error("Invalid subject idType")}},getSubjectIdType:p,treatmentsToCohortAllocations:function(i){var a={};return Object.keys(i).forEach(function(t){var n,r,e=i[t],o=e.treatment,e=e.config;a[t]={cohortId:f(o),error:"control"===o,data:(n=JSON.parse(e)||{},t=u(Object.keys(n).reduce(function(t,e){return e.startsWith("labels.")&&(t[e]=n[e]),t},{})),r=s(s({},n),t),Object.keys(r).reduce(function(t,e){return e.startsWith("labels.")||(t[e]=r[e]),t},{}))}}),a},transformSplitToExperiment:function(n){var t={experimentId:n.name,subjectIdType:p(n.trafficType),killed:n.killed,cohorts:n.treatments,cohortData:Object.keys(n.configs).reduce(function(t,e){return t[e]=u(JSON.parse(n.configs[e])||{}),t},{})},e=Object.values(t.cohortData).find(function(t){return t.labels});return t.labels=e?e.labels:[],t}}},function(t,e){function y(t){return t&&t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function n(t){return t}function a(t,c){const l=(c=c||{}).delimiter||".",f=c.maxDepth,p=c.transformKey||n,h={};return function i(a,s,u){u=u||1,Object.keys(a).forEach(function(t){var e=a[t],n=c.safe&&Array.isArray(e),r=Object.prototype.toString.call(e),o=y(e),r="[object Object]"===r||"[object Array]"===r,t=s?s+l+p(t):p(t);if(!n&&!o&&r&&Object.keys(e).length&&(!c.maxDepth||u<f))return i(e,t,u+1);h[t]=e})}(t),h}((t.exports=a).flatten=a).unflatten=function s(u,c){c=c||{};const l=c.delimiter||".";const f=c.overwrite||!1;const p=c.transformKey||n;const h={};const t=y(u);if(t||"[object Object]"!==Object.prototype.toString.call(u))return u;function d(t){const e=Number(t);return isNaN(e)||-1!==t.indexOf(".")||c.object?t:e}function o(n,t,r){return Object.keys(r).reduce(function(t,e){return t[n+l+e]=r[e],t},t)}function i(t){const e=Object.prototype.toString.call(t),n="[object Array]"===e,r="[object Object]"===e;return!t||(n?!t.length:r?!Object.keys(t).length:void 0)}u=Object.keys(u).reduce(function(t,e){const n=Object.prototype.toString.call(u[e]),r="[object Object]"===n||"[object Array]"===n;return!r||i(u[e])?(t[e]=u[e],t):o(e,t,a(u[e],c))},{});Object.keys(u).forEach(function(t){const e=t.split(l).map(p);let n=d(e.shift()),r=d(e[0]),o=h;for(;void 0!==r;){if("__proto__"===n)return;const i=Object.prototype.toString.call(o[n]),a="[object Object]"===i||"[object Array]"===i;if(!f&&!a&&void 0!==o[n])return;(f&&!a||!f&&null==o[n])&&(o[n]="number"!=typeof r||c.object?{}:[]),o=o[n],0<e.length&&(n=d(e.shift()),r=d(e[0]))}o[n]=s(u[t],c)});return h}},function(t,e){t.exports={sha256:function(t){function v(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}for(var b=function(t,e){return t>>>e|t<<32-e},S=function(t,e){return t>>>e},e=function(t,e){var n,r,o,i,a,s,u,c,l,f,p,h,d,y=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],m=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],g=new Array(64);for(t[e>>5]|=128<<24-e%32,t[15+(e+64>>9<<4)]=e,l=0;l<t.length;l+=16){for(n=m[0],r=m[1],o=m[2],i=m[3],a=m[4],s=m[5],u=m[6],c=m[7],f=0;f<64;f++)g[f]=f<16?t[f+l]:v(v(v((d=g[f-2],b(d,17)^b(d,19)^S(d,10)),g[f-7]),(d=g[f-15],b(d,7)^b(d,18)^S(d,3))),g[f-16]),p=v(v(v(v(c,b(d=a,6)^b(d,11)^b(d,25)),a&s^~a&u),y[f]),g[f]),h=v(b(h=n,2)^b(h,13)^b(h,22),n&r^n&o^r&o),c=u,u=s,s=a,a=v(i,p),i=o,o=r,r=n,n=v(p,h);m[0]=v(n,m[0]),m[1]=v(r,m[1]),m[2]=v(o,m[2]),m[3]=v(i,m[3]),m[4]=v(a,m[4]),m[5]=v(s,m[5]),m[6]=v(u,m[6]),m[7]=v(c,m[7])}return m}(function(t){for(var e=[],n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<24-n%32;return e}(t=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e+=String.fromCharCode(r):e=127<r&&r<2048?(e+=String.fromCharCode(r>>6|192))+String.fromCharCode(63&r|128):(e=(e+=String.fromCharCode(r>>12|224))+String.fromCharCode(r>>6&63|128))+String.fromCharCode(63&r|128)}return e}(t)),8*t.length),n="0123456789abcdef",r="",o=0;o<4*e.length;o++)r+=n.charAt(e[o>>2]>>8*(3-o%4)+4&15)+n.charAt(e[o>>2]>>8*(3-o%4)&15);return r}}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){var n,r,o,i,a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(a)return r=!(n=!0),{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){r=!0,o=t},f:function(){try{n||null==a.return||a.return()}finally{if(r)throw o}}};if(Array.isArray(t)||(a=s(t))||e&&t&&"number"==typeof t.length)return a&&(t=a),i=0,{s:e=function(){},n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t,e,n){return(e=function(t){t=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===r(t)?t:String(t)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){var n;if(t)return"string"==typeof t?u(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var n=n(15),c=n.experimentSources,l=n.switchboardIdTypes,f=new Set([l.VISITOR_ID,l.CUSTOMER_ID,l.SHOPPER_ID]);t.exports={settingsToExperiments:function(t){return Object.fromEntries(t.map(function(t){var e=t.setting,n=t.rules,t=t.metadata,r=function t(e){var n=e.value,e=e.values;if(!e)return t({values:[{value:n,isDefault:!0}]});return Object.assign.apply(Object,[{}].concat(i(e.map(function(t){var t=t.value,e=t.cohortId,t=t.data;return o({},e,t)}))))}(n);return[e,{experimentId:e,source:c.SWITCHBOARD,subjectIdType:function(t){var e,t=t.values,n=a(void 0===t?[]:t);try{for(n.s();!(e=n.n()).done;){var r=e.value.rule,o=r&&function t(e){var n=null;switch(e.type){case"idPercentage":case"idList":n=e.idType;break;case"shopperPercentage":case"shopperList":n=l.SHOPPER_ID;break;case"not":n=t(e.rule);break;case"and":case"or":var r,o=a(e.rules);try{for(o.s();!(r=o.n()).done;){var i=r.value;if(n=t(i))break}}catch(t){o.e(t)}finally{o.f()}}return f.has(n)?n:null}(r);if(o)return o}}catch(t){n.e(t)}finally{n.f()}return null}(n),killed:!1,labels:t&&t.labels||[],cohorts:Object.keys(r),cohortData:r}]}))}}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e,n){return(e=u(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,s=[],u=!0,c=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){var n;if(t)return"string"==typeof t?a(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}function u(t){t=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===r(t)?t:String(t)}var c=function(){function e(t){t=t.mockData;if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this._mockData=t}var t,n,r;return t=e,(n=[{key:"ready",get:function(){return Promise.resolve()}},{key:"getCohortAllocations",value:function(t){var o=t.experiments,t=this._mockData.cohorts;return Object.entries(t).reduce(function(t,e){var n,e=i(e,2),r=e[0],e=e[1];return o.includes(r)&&(n=e.data,e=e.cohortId,t[r]={data:n,cohortId:e}),t},{})}},{key:"getExperimentsById",value:function(n){var r=this,t=this._mockData.cohorts;return Object.keys(t).reduce(function(t,e){return n.includes(e)&&Object.assign(t,r._getExperimentById(e)),t},{})}},{key:"getExperiments",value:function(){var n=this,t=this._mockData.cohorts;return Object.keys(t).reduce(function(t,e){return Object.assign(t,n._getExperimentById(e))},{})}},{key:"_getExperimentById",value:function(t){var e=this._mockData.cohorts,n=e[t].cohortId,r=e[t].data||{};return o({},t,{experimentId:t,subjectIdType:e[t].subjectType,killed:!1,cohorts:[n],cohortData:o({},n,r),labels:r.labels||[]})}}])&&s(t.prototype,n),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.exports=c},function(t,e,n){"use strict";e.__esModule=!0;var n=n(73);n=new((n=n)&&n.__esModule?n:{default:n}).default;e.default=n},function(t,e,n){"use strict";e.__esModule=!0;var o=n(22);function r(t){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");this.properties=t||{}}r.prototype.clear=function(){this.properties={}},r.prototype.get=function(t){if(this.properties.hasOwnProperty(t))return this.properties[t]},r.prototype.set=function(t,e){this.properties[t]=e},r.prototype.isSet=function(t){if(this.properties.hasOwnProperty(t))return!0},r.prototype.delete=function(t){delete this.properties[t]},r.prototype.getProperties=function(t){var n={},r=t||"function"!=typeof t?function(){return!1}:t;return(0,o.map)(this.properties,function(t,e){r(t)||(n[t]=e)}),n},r.prototype.merge=function(t){var n=this,e=t;t instanceof r&&(e=t.getProperties()),(0,o.map)(e,function(t,e){n.set(t,e)})},e.default=r},function(t,e,n){"use strict";e.__esModule=!0;e.sha256=function(t){for(var v=function(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n},b=function(t,e){return t>>>e|t<<32-e},S=function(t,e){return t>>>e},e=function(t,e){var n,r,o,i=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],s=new Array(64),u=void 0,c=void 0,l=void 0,f=void 0,p=void 0,h=void 0,d=void 0,y=void 0,m=void 0,g=void 0;for(t[e>>5]|=128<<24-e%32,t[15+(e+64>>9<<4)]=e,m=0;m<t.length;m+=16){for(u=a[0],c=a[1],l=a[2],f=a[3],p=a[4],h=a[5],d=a[6],y=a[7],g=0;g<64;g++)s[g]=g<16?t[g+m]:v(v(v((o=s[g-2],b(o,17)^b(o,19)^S(o,10)),s[g-7]),(o=s[g-15],b(o,7)^b(o,18)^S(o,3))),s[g-16]),n=v(v(v(v(y,b(o=p,6)^b(o,11)^b(o,25)),p&h^~p&d),i[g]),s[g]),r=v(b(r=u,2)^b(r,13)^b(r,22),u&c^u&l^c&l),y=d,d=h,h=p,p=v(f,n),f=l,l=c,c=u,u=v(n,r);a[0]=v(u,a[0]),a[1]=v(c,a[1]),a[2]=v(l,a[2]),a[3]=v(f,a[3]),a[4]=v(p,a[4]),a[5]=v(h,a[5]),a[6]=v(d,a[6]),a[7]=v(y,a[7])}return a}(function(t){for(var e=[],n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<24-n%32;return e}(t=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e+=String.fromCharCode(r):e=127<r&&r<2048?(e+=String.fromCharCode(r>>6|192))+String.fromCharCode(63&r|128):(e=(e+=String.fromCharCode(r>>12|224))+String.fromCharCode(r>>6&63|128))+String.fromCharCode(63&r|128)}return e}(t)),8*t.length),n="0123456789abcdef",r="",o=0;o<4*e.length;o++)r+=n.charAt(e[o>>2]>>8*(3-o%4)+4&15)+n.charAt(e[o>>2]>>8*(3-o%4)&15);return r}},function(t,e,n){"use strict";e.__esModule=!0,e._errorInit=e._logInit=e.error=e.info=e.debug=e.log=void 0;function r(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(0,a.getWindow)().console,function(){}}function o(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(0,a.getWindow)().console,function(){}}var i=n(76),a=n(38),s=r(),n=o();e.log=s,e.debug=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];(0,i.isDebug)()&&s.apply(null,e)},e.info=s,e.error=n,e._logInit=r,e._errorInit=o},function(t,e,n){"use strict";e.__esModule=!0;function r(){return"test"===i}function o(){return"prod"===i}var i=void 0,a=!1;e.isDebug=function(){return a},e.isDevelopment=function(){return!o()&&!r()},e.isProduction=o,e.isTest=r,e.setDebug=function(t){a=!0===t||"true"===t},e.init=function(t){i=t},e.getEnvName=function(){return i},e._clearEnv=function(){i=void 0}},function(t,e,n){"use strict";function j(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */j=function(){return a};var a={},t=Object.prototype,u=t.hasOwnProperty,c=Object.defineProperty||function(t,e,n){t[e]=n.value},e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",o=e.toStringTag||"@@toStringTag";function i(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{i({},"")}catch(t){i=function(t,e,n){return t[e]=n}}function s(t,e,n,r){var o,i,a,s,e=e&&e.prototype instanceof p?e:p,e=Object.create(e.prototype),r=new O(r||[]);return c(e,"_invoke",{value:(o=t,i=n,a=r,s="suspendedStart",function(t,e){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===t)throw e;return _()}for(a.method=t,a.arg=e;;){var n=a.delegate;if(n){n=function t(e,n){var r=n.method,o=e.iterator[r];if(void 0===o)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=void 0,t(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;r=l(o,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,f;o=r.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,f):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}(n,a);if(n){if(n===f)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";n=l(o,i,a);if("normal"===n.type){if(s=a.done?"completed":"suspendedYield",n.arg===f)continue;return{value:n.arg,done:a.done}}"throw"===n.type&&(s="completed",a.method="throw",a.arg=n.arg)}})}),e}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}a.wrap=s;var f={};function p(){}function h(){}function d(){}var e={},y=(i(e,r,function(){return this}),Object.getPrototypeOf),y=y&&y(y(w([]))),m=(y&&y!==t&&u.call(y,r)&&(e=y),d.prototype=p.prototype=Object.create(e));function g(t){["next","throw","return"].forEach(function(e){i(t,e,function(t){return this._invoke(e,t)})})}function v(a,s){var e;c(this,"_invoke",{value:function(n,r){function t(){return new s(function(t,e){!function e(t,n,r,o){var i,t=l(a[t],a,n);if("throw"!==t.type)return(n=(i=t.arg).value)&&"object"==T(n)&&u.call(n,"__await")?s.resolve(n.__await).then(function(t){e("next",t,r,o)},function(t){e("throw",t,r,o)}):s.resolve(n).then(function(t){i.value=t,r(i)},function(t){return e("throw",t,r,o)});o(t.arg)}(n,r,t,e)})}return e=e?e.then(t,t):t()}})}function b(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(b,this),this.reset(!0)}function w(e){if(e){var n,t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return n=-1,(t=function t(){for(;++n<e.length;)if(u.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t}).next=t}return{next:_}}function _(){return{value:void 0,done:!0}}return c(m,"constructor",{value:h.prototype=d,configurable:!0}),c(d,"constructor",{value:h,configurable:!0}),h.displayName=i(d,o,"GeneratorFunction"),a.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},a.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,i(t,o,"GeneratorFunction")),t.prototype=Object.create(m),t},a.awrap=function(t){return{__await:t}},g(v.prototype),i(v.prototype,n,function(){return this}),a.AsyncIterator=v,a.async=function(t,e,n,r,o){void 0===o&&(o=Promise);var i=new v(s(t,e,n,r),o);return a.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},g(m),i(m,o,"Generator"),i(m,r,function(){return this}),i(m,"toString",function(){return"[object Generator]"}),a.keys=function(t){var e,n=Object(t),r=[];for(e in n)r.push(e);return r.reverse(),function t(){for(;r.length;){var e=r.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},a.values=w,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function t(t,e){return i.type="throw",i.arg=n,r.next=t,e&&(r.method="next",r.arg=void 0),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e],i=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var a=u.call(o,"catchLoc"),s=u.call(o,"finallyLoc");if(a&&s){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&u.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}var i=(o=o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc?null:o)?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n,r,o=this.tryEntries[e];if(o.tryLoc===t)return"throw"===(n=o.completion).type&&(r=n.arg,S(o)),r}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:w(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},a}function T(t){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e,n,r,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,o)}function c(s){return function(){var t=this,a=arguments;return new Promise(function(e,n){var r=s.apply(t,a);function o(t){u(r,e,n,o,i,"next",t)}function i(t){u(r,e,n,o,i,"throw",t)}o(void 0)})}}function a(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||l(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){var n;if(t)return"string"==typeof t?r(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,function(t){t=function(t,e){if("object"!==T(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===T(t)?t:String(t)}(r.key),r)}}function f(t,e){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function p(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=o(n),e=(t=r?(t=o(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===T(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&("get"in o?e.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){t[r=void 0===r?n:r]=e[n]}),h=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),d=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return h(e,t),e},y=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},m=(Object.defineProperty(e,"__esModule",{value:!0}),n(78)),g=y(n(79)),v=d(n(151)),b=y(n(152)),d=function(t){var e=i;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t);var n,r,o=p(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.plugins,t=t.immutable,n=this,r=i;if(n instanceof r)return(n=o.call(this))._ruleTypes=Object.assign.apply(Object,[{},v].concat(a((e||[]).map(function(t){return t.rules||{}})))),n._immutable=Boolean(t),n._tokenCache={},n;throw new TypeError("Cannot call a class as a function")}return e=i,(t=[{key:"testRule",value:function(t,e){var n,r,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";try{return(this.emit("testing"),t)?!!(n=this._ruleTypes[t.type])&&(r=n.test({rule:t,params:e,key:o,ruleTypes:this._ruleTypes}),this.emit("tested"),r):!1}catch(t){return this.emit("testError",t),!1}}},{key:"resolveValue",value:function(t,e){var n=t.setting,t=t.rules;return"value"in t?this.maybeClone(t.value):(t=t.values||[],this.findMatchingValue(t,e,n))}},{key:"resolveValues",value:(r=c(j().mark(function t(e,a){var r,s,n,u=this,o=arguments;return j().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=2<o.length&&void 0!==o[2]?o[2]:"",s=[],n=e.reduce(function(t,e){var i,n=e.setting;return 0!==n.indexOf(r)&&0!==r.indexOf(n)||(i=u.tokenizeKey(n)).reduce(function(n,r,t){if(t!==i.length-1)return r in n||(n[r]={}),n[r];var o;n&&"object"===T(n)?(o=u.resolveValue(e,a))instanceof Promise?s.push(new Promise(function(e){o.then(function(t){n[r]=t,e()})})):n[r]=o:u.emit("outputError",new Error("Setting ".concat(r," could not be merged into results tree")))},t),t},{}),t.next=5,Promise.all(s);case 5:return t.abrupt("return",r?this.tokenizeKey(r).reduce(function(t,e){return t&&t[e]},n):n);case 6:case"end":return t.stop()}},t,this)})),function(t,e){return r.apply(this,arguments)})},{key:"findMatchingValue",value:function(t,e,n){var r,o,i=function(t,e){var n,r,o,i,a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(a)return r=!(n=!0),{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){r=!0,o=t},f:function(){try{n||null==a.return||a.return()}finally{if(r)throw o}}};if(Array.isArray(t)||(a=l(t))||e&&t&&"number"==typeof t.length)return a&&(t=a),i=0,{s:e=function(){},n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(t);try{for(i.s();!(o=i.n()).done;){var a=o.value;if(!r||a.isDefault){var s=this.testRule(a.rule,e,n);if(s instanceof Promise)return this.findMatchingValueAsync(t,e,n);s&&(r=a)}}}catch(t){i.e(t)}finally{i.f()}return(r=r||(0,b.default)(t,function(t){return!0===t.isDefault})||t[0])&&this.maybeClone(r.value)}},{key:"findMatchingValueAsync",value:function(o,i,a){var s=this;return new Promise(function(){var e=c(j().mark(function t(e){var n,r;return j().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(o.map(function(t){return s.testRule(t.rule,i,a)}));case 2:n=t.sent,r=o.find(function(t,e){return t.isDefault&&n[e]})||o.find(function(t,e){return n[e]})||o.find(function(t){return t.isDefault})||o[0],e(r&&s.maybeClone(r.value));case 5:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}())}},{key:"tokenizeKey",value:function(t){if(!(t in this._tokenCache)){for(var e=[],n=!1,r="",o=0;o<t.length;o++){var i=t[o];n?(r+=i,n=!1):"."===i?(e.push(r),r=""):"\\"===i?n=!0:r+=i}e.push(r),this._tokenCache[t]=e}return this._tokenCache[t]}},{key:"maybeClone",value:function(t){return this._immutable?t:(0,g.default)(t)}}])&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(m.EventEmitter);e.default=d},function(t,e,n){"use strict";var r="object"==typeof Reflect?Reflect:null,u=r&&"function"==typeof r.apply?r.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};var o=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)},i=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}t.exports=a,t.exports.once=function(s,u){return new Promise(function(t,e){function n(t){s.removeListener(u,r),e(t)}function r(){"function"==typeof s.removeListener&&s.removeListener("error",n),t([].slice.call(arguments))}var o,i,a;m(s,u,r,{once:!0}),"error"!==u&&(i=n,a={once:!0},"function"==typeof(o=s).on)&&m(o,"error",i,a)})},(a.EventEmitter=a).prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var s=10;function c(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function f(t,e,n,r){var o,i;return c(n),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener||n),o=t._events),i=o[e]),void 0===i?(i=o[e]=n,++t._eventsCount):("function"==typeof i?i=o[e]=r?[n,i]:[i,n]:r?i.unshift(n):i.push(n),0<(o=l(t))&&i.length>o&&!i.warned&&(i.warned=!0,(r=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",r.emitter=t,r.type=e,r.count=i.length,n=r,console)&&console.warn&&console.warn(n)),t}function p(t,e,n){t={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},e=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}.bind(t);return e.listener=n,t.wrapFn=e}function h(t,e,n){t=t._events;if(void 0===t)return[];t=t[e];if(void 0===t)return[];if("function"==typeof t)return n?[t.listener||t]:[t];if(n){for(var r=t,o=new Array(r.length),i=0;i<o.length;++i)o[i]=r[i].listener||r[i];return o}return y(t,t.length)}function d(t){var e=this._events;if(void 0!==e){e=e[t];if("function"==typeof e)return 1;if(void 0!==e)return e.length}return 0}function y(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function m(n,r,o,i){if("function"==typeof n.on)i.once?n.once(r,o):n.on(r,o);else{if("function"!=typeof n.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n);n.addEventListener(r,function t(e){i.once&&n.removeEventListener(r,t),o(e)})}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");s=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){if((i=0<e.length?e[0]:i)instanceof Error)throw i;r=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw r.context=i,r}var i=o[t];if(void 0===i)return!1;if("function"==typeof i)u(i,this,e);else for(var a=i.length,s=y(i,a),n=0;n<a;++n)u(s[n],this,e);return!0},a.prototype.on=a.prototype.addListener=function(t,e){return f(this,t,e,!1)},a.prototype.prependListener=function(t,e){return f(this,t,e,!0)},a.prototype.once=function(t,e){return c(e),this.on(t,p(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){return c(e),this.prependListener(t,p(this,t,e)),this},a.prototype.off=a.prototype.removeListener=function(t,e){var n,r,o,i,a;if(c(e),void 0!==(r=this._events)&&void 0!==(n=r[t]))if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,i=n.length-1;0<=i;i--)if(n[i]===e||n[i].listener===e){a=n[i].listener,o=i;break}if(o<0)return this;if(0===o)n.shift();else{for(var s=n,u=o;u+1<s.length;u++)s[u]=s[u+1];s.pop()}1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,a||e)}return this},a.prototype.removeAllListeners=function(t){var e,n=this._events;if(void 0!==n)if(void 0===n.removeListener)0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]);else if(0===arguments.length){for(var r,o=Object.keys(n),i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0}else if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;0<=i;i--)this.removeListener(t,e[i]);return this},a.prototype.listeners=function(t){return h(this,t,!0)},a.prototype.rawListeners=function(t){return h(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):d.call(t,e)},a.prototype.listenerCount=d,a.prototype.eventNames=function(){return 0<this._eventsCount?o(this._events):[]}},function(t,e,n){var r=n(80);t.exports=function(t){return r(t,5)}},function(t,e,n){var d=n(81),y=n(112),m=n(43),g=n(114),v=n(124),b=n(127),S=n(128),O=n(129),w=n(131),_=n(132),j=n(133),T=n(33),E=n(138),k=n(139),A=n(145),C=n(26),x=n(46),I=n(147),R=n(12),P=n(149),N=n(25),L=n(31),D="[object Arguments]",M="[object Function]",F="[object Object]",K={};K[D]=K["[object Array]"]=K["[object ArrayBuffer]"]=K["[object DataView]"]=K["[object Boolean]"]=K["[object Date]"]=K["[object Float32Array]"]=K["[object Float64Array]"]=K["[object Int8Array]"]=K["[object Int16Array]"]=K["[object Int32Array]"]=K["[object Map]"]=K["[object Number]"]=K[F]=K["[object RegExp]"]=K["[object Set]"]=K["[object String]"]=K["[object Symbol]"]=K["[object Uint8Array]"]=K["[object Uint8ClampedArray]"]=K["[object Uint16Array]"]=K["[object Uint32Array]"]=!0,K["[object Error]"]=K[M]=K["[object WeakMap]"]=!1,t.exports=function n(r,o,i,t,e,a){var s,u=1&o,c=2&o,l=4&o;if(void 0===(s=i?e?i(r,t,e,a):i(r):s)){if(!R(r))return r;if(t=C(r)){if(s=E(r),!u)return S(r,s)}else{var f=T(r),p=f==M||"[object GeneratorFunction]"==f;if(x(r))return b(r,u);if(f==F||f==D||p&&!e){if(s=c||p?{}:A(r),!u)return c?w(r,v(s,r)):O(r,g(s,r))}else{if(!K[f])return e?r:{};s=k(r,f,u)}}if(p=(a=a||new d).get(r))return p;a.set(r,s),P(r)?r.forEach(function(t){s.add(n(t,o,i,t,r,a))}):I(r)&&r.forEach(function(t,e){s.set(e,n(t,o,i,e,r,a))});var h=t?void 0:(l?c?j:_:c?L:N)(r);y(h||r,function(t,e){h&&(t=r[e=t]),m(s,e,n(t,o,i,e,r,a))})}return s}},function(t,e,n){var r=n(16),o=n(87),i=n(88),a=n(89),s=n(90),n=n(91);function u(t){t=this.__data__=new r(t);this.size=t.size}u.prototype.clear=o,u.prototype.delete=i,u.prototype.get=a,u.prototype.has=s,u.prototype.set=n,t.exports=u},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){var r=n(17),o=Array.prototype.splice;t.exports=function(t){var e=this.__data__;return!((t=r(e,t))<0||(t==e.length-1?e.pop():o.call(e,t,1),--this.size,0))}},function(t,e,n){var r=n(17);t.exports=function(t){var e=this.__data__;return(t=r(e,t))<0?void 0:e[t][1]}},function(t,e,n){var r=n(17);t.exports=function(t){return-1<r(this.__data__,t)}},function(t,e,n){var o=n(17);t.exports=function(t,e){var n=this.__data__,r=o(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}},function(t,e,n){var r=n(16);t.exports=function(){this.__data__=new r,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,t=e.delete(t);return this.size=e.size,t}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,n){var o=n(16),i=n(23),a=n(99);t.exports=function(t,e){var n=this.__data__;if(n instanceof o){var r=n.__data__;if(!i||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new a(r)}return n.set(t,e),this.size=n.size,this}},function(t,e,n){var r=n(40),o=n(96),i=n(12),a=n(42),s=/^\[object .+?Constructor\]$/,n=Function.prototype,u=Object.prototype,n=n.toString,u=u.hasOwnProperty,c=RegExp("^"+n.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!i(t)||o(t))&&(r(t)?c:s).test(a(t))}},function(t,e){var n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var n=n(24),r=Object.prototype,i=r.hasOwnProperty,a=r.toString,s=n?n.toStringTag:void 0;t.exports=function(t){var e=i.call(t,s),n=t[s];try{var r=!(t[s]=void 0)}catch(t){}var o=a.call(t);return r&&(e?t[s]=n:delete t[s]),o}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e,n){var n=n(97),r=(n=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";t.exports=function(t){return!!r&&r in t}},function(t,e,n){n=n(6)["__core-js_shared__"];t.exports=n},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,n){var r=n(100),o=n(107),i=n(109),a=n(110),n=n(111);function s(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}s.prototype.clear=r,s.prototype.delete=o,s.prototype.get=i,s.prototype.has=a,s.prototype.set=n,t.exports=s},function(t,e,n){var r=n(101),o=n(16),i=n(23);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||o),string:new r}}},function(t,e,n){var r=n(102),o=n(103),i=n(104),a=n(105),n=n(106);function s(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}s.prototype.clear=r,s.prototype.delete=o,s.prototype.get=i,s.prototype.has=a,s.prototype.set=n,t.exports=s},function(t,e,n){var r=n(19);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(t,e){t.exports=function(t){return t=this.has(t)&&delete this.__data__[t],this.size-=t?1:0,t}},function(t,e,n){var r=n(19),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e,n=this.__data__;return r?"__lodash_hash_undefined__"===(e=n[t])?void 0:e:o.call(n,t)?n[t]:void 0}},function(t,e,n){var r=n(19),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:o.call(e,t)}},function(t,e,n){var r=n(19);t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?"__lodash_hash_undefined__":e,this}},function(t,e,n){var r=n(20);t.exports=function(t){return t=r(this,t).delete(t),this.size-=t?1:0,t}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,n){var r=n(20);t.exports=function(t){return r(this,t).get(t)}},function(t,e,n){var r=n(20);t.exports=function(t){return r(this,t).has(t)}},function(t,e,n){var o=n(20);t.exports=function(t,e){var n=o(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}},function(t,e,n){var r=n(8),n=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=n},function(t,e,n){var r=n(21),o=n(25);t.exports=function(t,e){return t&&r(e,o(e),t)}},function(t,e){t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},function(t,e,n){var r=n(117),o=n(13),n=Object.prototype,i=n.hasOwnProperty,a=n.propertyIsEnumerable,n=r(function(){return arguments}())?r:function(t){return o(t)&&i.call(t,"callee")&&!a.call(t,"callee")};t.exports=n},function(t,e,n){var r=n(18),o=n(13);t.exports=function(t){return o(t)&&"[object Arguments]"==r(t)}},function(t,e){t.exports=function(){return!1}},function(t,e){var r=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&r.test(t))&&-1<t&&t%1==0&&t<e}},function(t,e,n){var r=n(121),o=n(28),n=n(29),n=n&&n.isTypedArray,o=n?o(n):r;t.exports=o},function(t,e,n){var r=n(18),o=n(47),i=n(13),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(t){return i(t)&&o(t.length)&&!!a[r(t)]}},function(t,e,n){var r=n(30),o=n(123),i=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return o(t);var e,n=[];for(e in Object(t))i.call(t,e)&&"constructor"!=e&&n.push(e);return n}},function(t,e,n){n=n(48)(Object.keys,Object);t.exports=n},function(t,e,n){var r=n(21),o=n(31);t.exports=function(t,e){return t&&r(e,o(e),t)}},function(t,e,n){var o=n(12),i=n(30),a=n(126),s=Object.prototype.hasOwnProperty;t.exports=function(t){if(!o(t))return a(t);var e,n=i(t),r=[];for(e in t)("constructor"!=e||!n&&s.call(t,e))&&r.push(e);return r}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},function(t,i,a){!function(t){var e=a(6),n=i&&!i.nodeType&&i,r=n&&"object"==typeof t&&t&&!t.nodeType&&t,r=r&&r.exports===n?e.Buffer:void 0,o=r?r.allocUnsafe:void 0;t.exports=function(t,e){return e?t.slice():(e=t.length,e=o?o(e):new t.constructor(e),t.copy(e),e)}}.call(this,a(27)(t))},function(t,e){t.exports=function(t,e){var n=-1,r=t.length;for(e=e||Array(r);++n<r;)e[n]=t[n];return e}},function(t,e,n){var r=n(21),o=n(32);t.exports=function(t,e){return r(t,o(t),e)}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,o=0,i=[];++n<r;){var a=t[n];e(a,n,t)&&(i[o++]=a)}return i}},function(t,e,n){var r=n(21),o=n(51);t.exports=function(t,e){return r(t,o(t),e)}},function(t,e,n){var r=n(54),o=n(32),i=n(25);t.exports=function(t){return r(t,i,o)}},function(t,e,n){var r=n(54),o=n(51),i=n(31);t.exports=function(t){return r(t,i,o)}},function(t,e,n){n=n(8)(n(6),"DataView");t.exports=n},function(t,e,n){n=n(8)(n(6),"Promise");t.exports=n},function(t,e,n){n=n(8)(n(6),"Set");t.exports=n},function(t,e,n){n=n(8)(n(6),"WeakMap");t.exports=n},function(t,e){var r=Object.prototype.hasOwnProperty;t.exports=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&r.call(t,"index")&&(n.index=t.index,n.input=t.input),n}},function(t,e,n){var o=n(34),i=n(141),a=n(142),s=n(143),u=n(144);t.exports=function(t,e,n){var r=t.constructor;switch(e){case"[object ArrayBuffer]":return o(t);case"[object Boolean]":case"[object Date]":return new r(+t);case"[object DataView]":return i(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return u(t,n);case"[object Map]":return new r;case"[object Number]":case"[object String]":return new r(t);case"[object RegExp]":return a(t);case"[object Set]":return new r;case"[object Symbol]":return s(t)}}},function(t,e,n){n=n(6).Uint8Array;t.exports=n},function(t,e,n){var r=n(34);t.exports=function(t,e){return e=e?r(t.buffer):t.buffer,new t.constructor(e,t.byteOffset,t.byteLength)}},function(t,e){var n=/\w*$/;t.exports=function(t){var e=new t.constructor(t.source,n.exec(t));return e.lastIndex=t.lastIndex,e}},function(t,e,n){var n=n(24),n=n?n.prototype:void 0,r=n?n.valueOf:void 0;t.exports=function(t){return r?Object(r.call(t)):{}}},function(t,e,n){var r=n(34);t.exports=function(t,e){return e=e?r(t.buffer):t.buffer,new t.constructor(e,t.byteOffset,t.length)}},function(t,e,n){var r=n(146),o=n(53),i=n(30);t.exports=function(t){return"function"!=typeof t.constructor||i(t)?{}:r(o(t))}},function(t,e,n){var r=n(12),o=Object.create;function i(){}t.exports=function(t){if(!r(t))return{};if(o)return o(t);i.prototype=t;t=new i;return i.prototype=void 0,t}},function(t,e,n){var r=n(148),o=n(28),n=n(29),n=n&&n.isMap,o=n?o(n):r;t.exports=o},function(t,e,n){var r=n(33),o=n(13);t.exports=function(t){return o(t)&&"[object Map]"==r(t)}},function(t,e,n){var r=n(150),o=n(28),n=n(29),n=n&&n.isSet,o=n?o(n):r;t.exports=o},function(t,e,n){var r=n(33),o=n(13);t.exports=function(t){return o(t)&&"[object Set]"==r(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.not=e.or=e.and=void 0,e.and={test:function(t){var e=t.rule.rules,n=t.params,r=t.key,o=t.ruleTypes;return e.every(function(t){return o[t.type].test({rule:t,params:n,key:r,ruleTypes:o})})}},e.or={test:function(t){var e=t.rule.rules,n=t.params,r=t.key,o=t.ruleTypes;return e.some(function(t){return o[t.type].test({rule:t,params:n,key:r,ruleTypes:o})})}},e.not={test:function(t){var e=t.rule.rule,n=t.params,r=t.key,t=t.ruleTypes;return!t[e.type].test({rule:e,params:n,key:r,ruleTypes:t})}}},function(t,e,n){"use strict";function i(t,e){var n,r,o,i,a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(a)return r=!(n=!0),{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){r=!0,o=t},f:function(){try{n||null==a.return||a.return()}finally{if(r)throw o}}};if(Array.isArray(t)||(a=function(t,e){var n;if(t)return"string"==typeof t?s(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}(t))||e&&t&&"number"==typeof t.length)return a&&(t=a),i=0,{s:e=function(){},n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n,r=i(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(e(o))return o}}catch(t){r.e(t)}finally{r.f()}}},function(t,e,n){t.exports={rules:{equals:n(154),lesser:n(155),lesserOrEqual:n(156),between:n(157),greaterOrEqual:n(158),greater:n(159),has:n(160),hasAll:n(161),hasAny:n(162),hasExact:n(163),subsetOf:n(164),substring:n(165),startsWith:n(166),endsWith:n(167),regex:n(168),idList:n(169),idPercentage:n(55),locale:n(173),shopperList:n(174),shopperPercentage:n(175),threeLetter:n(176),reseller:n(177)}}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n=n(7),o=n.validator,i=n.validComparableTypes;t.exports={test:function(t){var e=t.params,t=t.rule;return!!e.hasOwnProperty(t.variableName)&&e[t.variableName]===t.value},validate:o({"Rule must have a `variableName` property":function(t){return"variableName"in t},"Rule's `variableName` property must be a string":function(t){return"string"==typeof t.variableName},"Rule must have a `value` property":function(t){return"value"in t},"Rule value must be a string, number, or boolean":function(t){return i.has(r(t.value))}})}},function(t,e,n){n=n(9).numericComparator;t.exports=n(function(t,e){return t<e})},function(t,e,n){n=n(9).numericComparator;t.exports=n(function(t,e){return t<=e})},function(t,e,n){n=n(7).validator;t.exports={test:function(t){var e=t.rule,t=t.params[e.parameter];return t>=e.atLeast&&t<=e.atMost},validate:n({"`parameter` property is required":function(t){return"parameter"in t},"`atLeast` property is required":function(t){return"atLeast"in t},"`atMost` property is required":function(t){return"atMost"in t},"`parameter` must be a string":function(t){return"string"==typeof t.parameter},"`atLeast` must be a number":function(t){return"number"==typeof t.atLeast},"`atMost` must be a number":function(t){return"number"==typeof t.atMost},"`atLeast` must not exceed `atMost`":function(t){return t.atLeast<=t.atMost}})}},function(t,e,n){n=n(9).numericComparator;t.exports=n(function(t,e){return e<=t})},function(t,e,n){n=n(9).numericComparator;t.exports=n(function(t,e){return e<t})},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n=n(7),o=n.validator,i=n.validComparableTypes;t.exports={test:function(t){var e=t.params,t=t.rule;return!!e.hasOwnProperty(t.arrayName)&&(e=e[t.arrayName],!!Array.isArray(e))&&e.includes(t.element)},validate:o({"Rule must have a `arrayName` property":function(t){return"arrayName"in t},"Rule's `arrayName` property must be a string":function(t){return"string"==typeof t.arrayName},"Rule must have a `element` property":function(t){return"element"in t},"Rule element must be a string, number, or boolean":function(t){return i.has(r(t.element))}})}},function(t,e,n){n=n(7).setRuleValidator;t.exports={test:function(t){var e,n=t.params,t=t.rule;return!!n.hasOwnProperty(t.arrayName)&&(n=n[t.arrayName],!!Array.isArray(n))&&(e=new Set(n),t.elements.every(function(t){return e.has(t)}))},validate:n}},function(t,e,n){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function r(r){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach(function(t){var e,n;e=r,n=o[t=t],(t=function(t){t=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===i(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(o,t))})}return r}var o=n(14).withNormalization,n=n(7).setRuleValidator;t.exports=o({normalize:function(t){return r(r({},t),{},{elements:new Set(t.elements)})},test:function(t){var e=t.params,n=t.rule;return!!e.hasOwnProperty(n.arrayName)&&(t=e[n.arrayName],!!Array.isArray(t))&&t.some(function(t){return n.elements.has(t)})},validate:n})},function(t,e,n){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){var n;if(t)return"string"==typeof t?o(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function s(r){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach(function(t){var e,n;e=r,n=o[t=t],(t=function(t){t=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===i(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(o,t))})}return r}var u=n(14).withNormalization,n=n(7).setRuleValidator;t.exports=u({normalize:function(t){return s(s({},t),{},{elements:new Set(t.elements)})},test:function(t){var e=t.params,n=t.rule;return!!e.hasOwnProperty(n.arrayName)&&(t=e[n.arrayName],!!Array.isArray(t))&&(e=new Set(t)).size===n.elements.size&&r(e).every(function(t){return n.elements.has(t)})},validate:n})},function(t,e,n){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function r(r){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach(function(t){var e,n;e=r,n=o[t=t],(t=function(t){t=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===i(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(o,t))})}return r}var o=n(14).withNormalization,n=n(7).setRuleValidator;t.exports=o({normalize:function(t){return r(r({},t),{},{elements:new Set(t.elements)})},test:function(t){var e=t.params,n=t.rule;return!!e.hasOwnProperty(n.arrayName)&&(t=e[n.arrayName],!!Array.isArray(t))&&t.every(function(t){return n.elements.has(t)})},validate:n})},function(t,e,n){n=n(9).stringComparator;t.exports=n("contains",function(t,e){return t.includes(e)})},function(t,e,n){n=n(9).stringComparator;t.exports=n("prefix",function(t,e){return t.startsWith(e)})},function(t,e,n){n=n(9).stringComparator;t.exports=n("suffix",function(t,e){return t.endsWith(e)})},function(t,e,n){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function r(r){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach(function(t){var e,n;e=r,n=o[t=t],(t=function(t){t=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===i(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(o,t))})}return r}var o=n(14).withNormalization,n=n(7).validator;t.exports=o({normalize:function(t){return r(r({},t),{},{pattern:new RegExp(t.pattern)})},test:function(t){var e=t.rule,t=t.params,t=String(t[e.parameter]);return e.pattern.test(t)},validate:n({"`parameter` property is required":function(t){return"parameter"in t},"`pattern` property is required":function(t){return"pattern"in t},"`parameter` must be a string":function(t){return"string"==typeof t.parameter},"`pattern` must be a string":function(t){return"string"==typeof t.pattern}})})},function(t,e){t.exports={validate:function(t){return!!t.idType&&t["".concat(t.idType,"s")]instanceof Array},test:function(t){var e=t.params,t=t.rule,e=e[t.idType],n=e&&e.toString().toLowerCase();return t["".concat(t.idType,"s")].some(function(t){return(t&&t.toString().toLowerCase())===n})}}},function(t,e,n){function m(t,e){t.constructor==String?t=(e&&"binary"===e.encoding?S:v).stringToBytes(t):b(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||t.constructor===Uint8Array||(t=t.toString());for(var n=g.bytesToWords(t),e=8*t.length,r=1732584193,o=-271733879,i=-1732584194,a=271733878,s=0;s<n.length;s++)n[s]=16711935&(n[s]<<8|n[s]>>>24)|4278255360&(n[s]<<24|n[s]>>>8);n[e>>>5]|=128<<e%32,n[14+(64+e>>>9<<4)]=e;for(var u=m._ff,c=m._gg,l=m._hh,f=m._ii,s=0;s<n.length;s+=16){var p=r,h=o,d=i,y=a,r=u(r,o,i,a,n[s+0],7,-680876936),a=u(a,r,o,i,n[s+1],12,-389564586),i=u(i,a,r,o,n[s+2],17,606105819),o=u(o,i,a,r,n[s+3],22,-1044525330);r=u(r,o,i,a,n[s+4],7,-176418897),a=u(a,r,o,i,n[s+5],12,1200080426),i=u(i,a,r,o,n[s+6],17,-1473231341),o=u(o,i,a,r,n[s+7],22,-45705983),r=u(r,o,i,a,n[s+8],7,1770035416),a=u(a,r,o,i,n[s+9],12,-1958414417),i=u(i,a,r,o,n[s+10],17,-42063),o=u(o,i,a,r,n[s+11],22,-1990404162),r=u(r,o,i,a,n[s+12],7,1804603682),a=u(a,r,o,i,n[s+13],12,-40341101),i=u(i,a,r,o,n[s+14],17,-1502002290),r=c(r,o=u(o,i,a,r,n[s+15],22,1236535329),i,a,n[s+1],5,-165796510),a=c(a,r,o,i,n[s+6],9,-1069501632),i=c(i,a,r,o,n[s+11],14,643717713),o=c(o,i,a,r,n[s+0],20,-373897302),r=c(r,o,i,a,n[s+5],5,-701558691),a=c(a,r,o,i,n[s+10],9,38016083),i=c(i,a,r,o,n[s+15],14,-660478335),o=c(o,i,a,r,n[s+4],20,-405537848),r=c(r,o,i,a,n[s+9],5,568446438),a=c(a,r,o,i,n[s+14],9,-1019803690),i=c(i,a,r,o,n[s+3],14,-187363961),o=c(o,i,a,r,n[s+8],20,1163531501),r=c(r,o,i,a,n[s+13],5,-1444681467),a=c(a,r,o,i,n[s+2],9,-51403784),i=c(i,a,r,o,n[s+7],14,1735328473),r=l(r,o=c(o,i,a,r,n[s+12],20,-1926607734),i,a,n[s+5],4,-378558),a=l(a,r,o,i,n[s+8],11,-2022574463),i=l(i,a,r,o,n[s+11],16,1839030562),o=l(o,i,a,r,n[s+14],23,-35309556),r=l(r,o,i,a,n[s+1],4,-1530992060),a=l(a,r,o,i,n[s+4],11,1272893353),i=l(i,a,r,o,n[s+7],16,-155497632),o=l(o,i,a,r,n[s+10],23,-1094730640),r=l(r,o,i,a,n[s+13],4,681279174),a=l(a,r,o,i,n[s+0],11,-358537222),i=l(i,a,r,o,n[s+3],16,-722521979),o=l(o,i,a,r,n[s+6],23,76029189),r=l(r,o,i,a,n[s+9],4,-640364487),a=l(a,r,o,i,n[s+12],11,-421815835),i=l(i,a,r,o,n[s+15],16,530742520),r=f(r,o=l(o,i,a,r,n[s+2],23,-995338651),i,a,n[s+0],6,-198630844),a=f(a,r,o,i,n[s+7],10,1126891415),i=f(i,a,r,o,n[s+14],15,-1416354905),o=f(o,i,a,r,n[s+5],21,-57434055),r=f(r,o,i,a,n[s+12],6,1700485571),a=f(a,r,o,i,n[s+3],10,-1894986606),i=f(i,a,r,o,n[s+10],15,-1051523),o=f(o,i,a,r,n[s+1],21,-2054922799),r=f(r,o,i,a,n[s+8],6,1873313359),a=f(a,r,o,i,n[s+15],10,-30611744),i=f(i,a,r,o,n[s+6],15,-1560198380),o=f(o,i,a,r,n[s+13],21,1309151649),r=f(r,o,i,a,n[s+4],6,-145523070),a=f(a,r,o,i,n[s+11],10,-1120210379),i=f(i,a,r,o,n[s+2],15,718787259),o=f(o,i,a,r,n[s+9],21,-343485551),r=r+p>>>0,o=o+h>>>0,i=i+d>>>0,a=a+y>>>0}return g.endian([r,o,i,a])}var g,v,b,S;g=n(171),v=n(56).utf8,b=n(172),S=n(56).bin,m._ff=function(t,e,n,r,o,i,a){t=t+(e&n|~e&r)+(o>>>0)+a;return(t<<i|t>>>32-i)+e},m._gg=function(t,e,n,r,o,i,a){t=t+(e&r|n&~r)+(o>>>0)+a;return(t<<i|t>>>32-i)+e},m._hh=function(t,e,n,r,o,i,a){t=t+(e^n^r)+(o>>>0)+a;return(t<<i|t>>>32-i)+e},m._ii=function(t,e,n,r,o,i,a){t=t+(n^(e|~r))+(o>>>0)+a;return(t<<i|t>>>32-i)+e},m._blocksize=16,m._digestsize=16,t.exports=function(t,e){if(null==t)throw new Error("Illegal argument "+t);t=g.wordsToBytes(m(t,e));return e&&e.asBytes?t:e&&e.asString?S.bytesToString(t):g.bytesToHex(t)}},function(t,e){var i,n;i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&n.rotl(t,8)|4278255360&n.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=n.endian(t[e]);return t},randomBytes:function(t){for(var e=[];0<t;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],n=0,r=0;n<t.length;n++,r+=8)e[r>>>5]|=t[n]<<24-r%32;return e},wordsToBytes:function(t){for(var e=[],n=0;n<32*t.length;n+=8)e.push(t[n>>>5]>>>24-n%32&255);return e},bytesToHex:function(t){for(var e=[],n=0;n<t.length;n++)e.push((t[n]>>>4).toString(16)),e.push((15&t[n]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(parseInt(t.substr(n,2),16));return e},bytesToBase64:function(t){for(var e=[],n=0;n<t.length;n+=3)for(var r=t[n]<<16|t[n+1]<<8|t[n+2],o=0;o<4;o++)8*n+6*o<=8*t.length?e.push(i.charAt(r>>>6*(3-o)&63)):e.push("=");return e.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var e=[],n=0,r=0;n<t.length;r=++n%4)0!=r&&e.push((i.indexOf(t.charAt(n-1))&Math.pow(2,-2*r+8)-1)<<2*r|i.indexOf(t.charAt(n))>>>6-2*r);return e}},t.exports=n},function(t,e){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&null!=t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}},function(t,e){var r=/^(\w{2,})[\-_](\w{2,})$/,o={};t.exports={test:function(t){var e=t.params,t=t.rule,e=function(t){if(!t)return{};{var e;t in o||(e=r.exec(t),o[t]=e?{language:e[1].toLowerCase(),region:e[2].toUpperCase()}:{})}return o[t]}((e||{}).locale),n=e.language,e=e.region;return!(t.language&&n!==t.language.toLowerCase()||t.region&&e!==t.region.toUpperCase())},validate:function(t){return"language"in t||"region"in t?"language"in t&&"string"!=typeof t.language?{isValid:!1,message:"Language property must be a language code"}:"region"in t&&"string"!=typeof t.region?{isValid:!1,message:"Region property must be a country code"}:{isValid:!0}:{isValid:!1,message:"Must have a language or region property"}}}},function(t,e){var n=/^((\d+)|([a-z0-9]{3}))$/i,r=new WeakMap;function o(t){t=t&&t.toString();return t&&t.toLowerCase()}t.exports={validate:function(t){return t.shopperIds instanceof Array&&t.shopperIds.every(function(t){return n.test(t)})},test:function(t){var e=t.params,t=t.rule,n=r.get(t);return n||(n=new Set(t.shopperIds.map(o)),r.set(t,n)),n.has(o(e&&e.shopperId))}}},function(t,e,n){var n=n(55),r=n.validate,o=n.test;t.exports={validate:function(t){return t.idType="shopperId",r(t)},test:function(t){var e=t.key,n=t.rule,t=t.params;return n.idType="shopperId",o({key:e,rule:n,params:t})}}},function(t,e){var n=/^[a-z0-9]{3}$/i;t.exports={validate:function(t){return"boolean"!=typeof t.isThreeLetter?{isValid:!1,message:"Must have a boolean isThreeLetter property"}:{isValid:!0}},test:function(t){var e=t.rule.isThreeLetter,t=t.params.shopperId;return!!t&&n.test(t)===e}}},function(t,e){t.exports={validate:function(t){return!!(this.hasValidResellerFlag(t)^this.hasValidPlidList(t))},hasValidResellerFlag:function(t){return"boolean"==typeof t.isReseller},hasValidPlidList:function(t){return Array.isArray(t.plids)},test:function(t){var e=this,n=t.rule,r=t.params.plid||1;return this.hasValidResellerFlag(n)?this.matchPlid(r,1)!==n.isReseller:!!this.hasValidPlidList(n)&&n.plids.some(function(t){return e.matchPlid(t,r)})},matchPlid:function(t,e){return t==e}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=t.serializedData,e=void 0===e?{}:e,n=t.userId,r=void 0===n?"":n,n=t.storagePrefix,t=void 0===n?"":n,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window.localStorage,i=t?"".concat(t,".").concat(c):c,n="".concat(i,".splits.till");if(0!==Object.keys(e).length){var t=e.segmentsData,a=void 0===t?{}:t,t=e.since,t=void 0===t?0:t,s=e.splitsData,u=void 0===s?{}:s,s=e.usingSegmentsCount,e=void 0===s?0:s;if(!(t<=o.getItem(n))){l({windowLocalStorage:o,localStoragePrefix:i});try{o.setItem(n,t),Object.keys(u).forEach(function(t){o.setItem("".concat(i,".split.").concat(t),u[t])}),o.setItem("".concat(i,".splits.usingSegments"),e),Object.keys(a).forEach(function(t){var e="".concat(r,".").concat(i,".segment.").concat(t);JSON.parse(a[t]).added.includes(r)&&"1"!==o.getItem(e)&&o.setItem(e,"1")})}catch(t){console.error("Error setting localstorage",t),l({windowLocalStorage:o,localStoragePrefix:i})}}}},e.cleanLocalStorage=l;var c="SPLITIO";function l(t){var e=t.windowLocalStorage,n=void 0===e?window.localStorage:e,r=t.localStoragePrefix;Object.keys(n).forEach(function(t){t.includes(r)&&n.removeItem(t)})}},function(E,k,t){"use strict";t.r(k),t.d(k,"hivemindConstants",function(){return g.hivemindConstants}),t.d(k,"getClient",function(){return mi});var g=t(3),A=t(35),C=t(58),x=t(59),I=t.n(x),x=t(60),R=t.n(x);function P(t){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function N(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,function(t){t=function(t,e){if("object"!==P(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===P(t)?t:String(t)}(r.key),r)}}var L=function(){function e(t){t=t.settings;if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this._settings=t,this._engine=new I.a({plugins:[R.a],immutable:!0})}var t,n,r;return t=e,(n=[{key:"getCohortAllocations",value:function(t){var e=this,n=t.experiments,r=t.attributes;return Object.fromEntries(this._getExperimentSettings(n).map(function(t){return[t.setting,e._engine.resolveValue(t,r)]}))}},{key:"getExperimentsById",value:function(t){t=this._getExperimentSettings(t);return Object(g.settingsToExperiments)(t)}},{key:"getExperiments",value:function(){return Object(g.settingsToExperiments)(this._settings)}},{key:"_getExperimentSettings",value:function(t){var e=new Set(t);return this._settings.filter(function(t){t=t.setting;return e.has(t)})}}])&&N(t.prototype,n),r&&N(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),x=t(61),D=t.n(x);function M(t){var e=t.app,n=t.idType,r=t.id,o=t.preloadLocation,o=void 0===o?"__splitCachePreload":o,i=t.windowOverride,i=void 0===i?window:i,t=t.loadData;return(void 0===t?D.a:t)({serializedData:i[o],userId:Object(g.getSubjectKey)({idType:n,id:r}),storagePrefix:"".concat(e)}),!!i[o]}var q=t(2),z=t(0),U="Global fetch API is not available.";var f="control",B={treatment:f,config:null},J="IMPRESSION",d="DEBUG",W="OPTIMIZED",V="NONE",$="localhost",X="standalone",Z="consumer",tt="consumer_partial",et="MEMORY",nt="LOCALSTORAGE",u="GRANTED",rt="DECLINED",x="UNKNOWN",ot=0,it=30,at=40,st=60,ut=1,ct=0,lt=1,ft=2,pt={headers:{"Cache-Control":"no-cache"}};function ht(t){return"users="+encodeURIComponent(t)}function dt(t,e,o){var n,a,r,i,s,u,c,l,f=t.urls,p=t.sync.__splitFiltersValidation&&t.sync.__splitFiltersValidation.queryString,h=t.sync.impressionsMode,d=(t=t,n=e.getFetch,e=e.getOptions,a=t.log,r=t.core.authorizationKey,i=t.version,s=(t=t.runtime).ip,t=t.hostname,u=e&&e(),(c=n&&n())||a.error(z.H,[U]),l={Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r,SplitSDKVersion:i},s&&(l.SplitSDKMachineIP=s),t&&(l.SplitSDKMachineName=t),function(r,t,o,i){void 0===t&&(t={}),void 0===o&&(o=function(){}),void 0===i&&(i=!1);t=Object(q.a)({headers:t.headers?Object(q.a)({},l,t.headers):l,method:t.method||"GET",body:t.body},u);return c?c(r,t).then(function(e){return e.ok?(o(),e):e.text().then(function(t){return Promise.reject({response:e,message:t})})}).catch(function(t){var e=t&&t.response,n="",n=e?404===e.status?"Invalid API key or resource not found.":t.message:t.message||"Network Error",t=(e&&403===e.status||a[i?"info":"error"](z.P,[e?e.status:"NO_STATUS",r,n]),new Error(n));throw t.statusCode=e&&e.status,o(t),t}):Promise.reject(new Error(U))});return{getSdkAPIHealthCheck:function(){var t=f.sdk+"/version";return d(t).then(function(){return!0}).catch(function(){return!1})},getEventsAPIHealthCheck:function(){var t=f.events+"/version";return d(t).then(function(){return!0}).catch(function(){return!1})},fetchAuth:function(t){var e=f.auth+"/v2/auth";return t&&(t=t.map(ht).join("&"))&&(e+="?"+t),d(e,void 0,o.trackHttp("to"))},fetchSplitChanges:function(t,e,n){t=f.sdk+"/splitChanges?since="+t+(n?"&till="+n:"")+(p||"");return d(t,e?pt:void 0,o.trackHttp("sp"))},fetchSegmentChanges:function(t,e,n,r){e=f.sdk+"/segmentChanges/"+e+"?since="+t+(r?"&till="+r:"");return d(e,n?pt:void 0,o.trackHttp("se"))},fetchMySegments:function(t,e){t=f.sdk+"/mySegments/"+encodeURIComponent(t);return d(t,e?pt:void 0,o.trackHttp("ms"))},postEventsBulk:function(t,e){var n=f.events+"/events/bulk";return d(n,{method:"POST",body:t,headers:e},o.trackHttp("ev"))},postTestImpressionsBulk:function(t,e){var n=f.events+"/testImpressions/bulk";return d(n,{method:"POST",body:t,headers:Object(q.a)({SplitSDKImpressionsMode:h},e)},o.trackHttp("im"))},postTestImpressionsCount:function(t,e){var n=f.events+"/testImpressions/count";return d(n,{method:"POST",body:t,headers:e},o.trackHttp("ic"))},postUniqueKeysBulkCs:function(t,e){var n=f.telemetry+"/v1/keys/cs";return d(n,{method:"POST",body:t,headers:e},o.trackHttp("te"))},postUniqueKeysBulkSs:function(t,e){var n=f.telemetry+"/v1/keys/ss";return d(n,{method:"POST",body:t,headers:e},o.trackHttp("te"))},postMetricsConfig:function(t,e){var n=f.telemetry+"/v1/metrics/config";return d(n,{method:"POST",body:t,headers:e},o.trackHttp("te"),!0)},postMetricsUsage:function(t,e){var n=f.telemetry+"/v1/metrics/usage";return d(n,{method:"POST",body:t,headers:e},o.trackHttp("te"),!0)}}}function yt(n,r,o,i){void 0===i&&(i="task");var a,s,u,c=0,l=!1,f=0;function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return c++,n.debug(z.mc,[i]),a=(a?a.then(function(){return r.apply(void 0,t)}):r.apply(void 0,t)).then(function(t){return c--,t})}function p(e){return t.apply(void 0,s).then(function(t){return l&&e===f&&(u=setTimeout(p,o,e)),t})}return{execute:t,isExecuting:function(){return 0<c},start:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!l)return l=!0,f++,s=t,n.debug(z.nc,[i,o]),p(f)},stop:function(){l=!1,u&&(n.debug(z.oc,[i]),clearTimeout(u),u=void 0)},isRunning:function(){return l}}}function mt(n,r,o,t,i,a,s,u){void 0===s&&(s=0);var c,l=0;return yt(n,function(){var e,t;return o.isEmpty()&&!c?Promise.resolve():(e="number"==typeof(c=o.pop(c)).length?c.length+" "+i:i,n[u?"debug":"info"](z.Xb,[e]),t=JSON.stringify(a?a(c):c),s||(c=void 0),r(t).then(function(){c=void(l=0)}).catch(function(t){s?l===s?(c=void(l=0),n[u?"debug":"warn"](z.Yb,[e,t])):(l++,n[u?"debug":"warn"](z.ac,[e,t])):n[u?"debug":"warn"](z.Yb,[e,t])}))},t,i+" submitter")}function gt(t,e){var n,r=!1,o=t.start,i=(t.start=function(){r=!0,n=setTimeout(o,e)},t.stop);return t.stop=function(){r=!1,clearTimeout(n),i()},t.isRunning=function(){return r},t}var vt="events";var F=t(1),bt="impressions";function St(n,t){var t=Object(F.f)(t,"feature"),r=[];return Object(F.d)(t,function(t,e){r.push({f:e,i:t.map(function(t){return{k:t.keyName,t:t.treatment,m:t.time,c:t.changeNumber,r:n?t.label:void 0,b:t.bucketingKey||void 0,pt:t.pt||void 0}})})}),r}function Ot(t){for(var e=[],n=Object.keys(t),r=0;r<n.length;r++){var o,i=n[r].split("::");2===i.length&&(o=i[0],i=i[1],o={f:o,m:Number(i),rc:t[n[r]]},e.push(o))}return{pf:e}}var wt=18e5;var H="state::splits-arrived",_t="state::splits-cache-loaded",G="state::segments-arrived",jt="init::timeout",Q="init::ready",Tt="init::cache-ready",Et="state::update";var kt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/;function At(t,e,n,r){if(void 0===r&&(r="split name"),null==e)t.error(z.bb,[n,r]);else if(Object(F.k)(e)){if(kt.test(e)&&(t.warn(z.Cc,[n,r,e]),e=e.trim()),0<e.length)return e;t.error(z.K,[n,r])}else t.error(z.S,[n,r]);return!1}function Ct(e,t,n,r,o){if(void 0===r&&(r="split_names"),void 0===o&&(o="split name"),Array.isArray(t)&&0<t.length){var i=[];if(t.forEach(function(t){t=At(e,t,n,o);t&&i.push(t)}),i.length)return Object(F.q)(i)}return e.error(z.L,[n,r]),!1}var xt=[{type:"byName",maxLength:400,queryParam:"names="},{type:"byPrefix",maxLength:50,queryParam:"prefixes="}];function It(r,t,e){var n,o,i={validFilters:[],queryString:null,groupedFilters:{byName:[],byPrefix:[]}};return t&&(e!==X?r.warn(z.Ac,[X]):Array.isArray(t)&&0!==t.length?(i.validFilters=t.filter(function(t,e){var n;return t&&(n=t.type,xt.some(function(t){return t.type===n}))&&Array.isArray(t.values)?(i.groupedFilters[t.type]=i.groupedFilters[t.type].concat(t.values),!0):(r.warn(z.Bc,[e]),!1)}),xt.forEach(function(t){var e=t.type,t=t.maxLength;0<i.groupedFilters[e].length&&(i.groupedFilters[e]=function(t,e,n,r){if(t=Ct(t,n,z.ub,e+" filter",e+" filter value")){if(t.length>r)throw new Error(r+" unique values can be specified at most for '"+e+"' filter. You passed "+t.length+". Please consider reducing the amount or using other filter.");t.sort()}return t||[]}(r,e,i.groupedFilters[e],t))}),i.queryString=(n=i.groupedFilters,o=[],xt.forEach(function(t){var e=t.type,t=t.queryParam,e=n[e];0<e.length&&o.push(t+e.map(function(t){return encodeURIComponent(t)}).join(","))}),0<o.length?"&"+o.join("&"):null),r.debug(z.Mb,[i.queryString])):r.warn(z.zc)),i}function Rt(t,e,n,r){if(null==e)t.error(z.bb,[n,r]);else{if(Object(F.h)(e))return t.warn(z.tc,[n,r,e]),Object(F.p)(e);if(Object(F.k)(e)){if(0<(e=e.trim()).length&&e.length<=250)return e;0===e.length?t.error(z.K,[n,r]):250<e.length&&t.error(z.hb,[n,r])}else t.error(z.S,[n,r])}return!1}function Pt(t,e,n){var r,o;return Object(F.j)(e)?(r=Rt(t,e.matchingKey,n,"matchingKey"),o=Rt(t,e.bucketingKey,n,"bucketingKey"),r&&o?{matchingKey:r,bucketingKey:o}:(t.error(z.U,[n]),!1)):Rt(t,e,n,"key")}var Nt=/[A-Z]/,Lt="traffic_type";function Dt(t,e,n){if(null==e)t.error(z.bb,[n,Lt]);else if(Object(F.k)(e)){if(0!==e.length)return Nt.test(e)&&(t.warn(z.vc,[n]),e=e.toLowerCase()),e;t.error(z.K,[n,Lt])}else t.error(z.S,[n,Lt]);return!1}var Mt={mode:X,core:{authorizationKey:void 0,key:void 0,trafficType:void 0,labelsEnabled:!0,IPAddressesEnabled:void 0},scheduler:{featuresRefreshRate:60,segmentsRefreshRate:60,telemetryRefreshRate:3600,impressionsRefreshRate:300,offlineRefreshRate:15,eventsPushRate:60,eventsQueueSize:500,impressionsQueueSize:3e4,pushRetryBackoffBase:1},urls:{sdk:"https://sdk.split.io/api",events:"https://events.split.io/api",auth:"https://auth.split.io/api",streaming:"https://streaming.split.io",telemetry:"https://telemetry.split.io/api"},storage:void 0,debug:void 0,impressionListener:void 0,version:void 0,integrations:void 0,streamingEnabled:!0,sync:{splitFilters:void 0,impressionsMode:W,localhostMode:void 0,enabled:!0},log:void 0};function y(t){return Math.round(1e3*t)}function Ft(t,e){var n=e.defaults,r=e.runtime,o=e.storage,i=e.integrations,a=e.logger,s=e.localhost,u=e.consent,n=Object(F.l)({},Mt,n,t),a=a(n);n.log=a,n.sync.impressionsMode=(f=a,l=n.sync.impressionsMode,l=Object(F.n)(l),-1<[d,W,V].indexOf(l)?l:(f.error(z.T,["impressionsMode",[d,W,V],W]),W));var c,l=n.scheduler,f=n.startup,p=(l.featuresRefreshRate=y(l.featuresRefreshRate),l.segmentsRefreshRate=y(l.segmentsRefreshRate),l.offlineRefreshRate=y(l.offlineRefreshRate),l.eventsPushRate=y(l.eventsPushRate),l.telemetryRefreshRate=y((c="telemetryRefreshRate",p=l.telemetryRefreshRate,(h=60)<=p?p:(a.error(z.X,[c,h]),h))),void 0===Object(F.e)(t,"scheduler.impressionsRefreshRate")&&n.sync.impressionsMode===d&&(l.impressionsRefreshRate=60),l.impressionsRefreshRate=y(l.impressionsRefreshRate),l.metricsRefreshRate&&a.warn("`metricsRefreshRate` will be deprecated soon. For configuring telemetry rates, update `telemetryRefreshRate` value in configs"),f.requestTimeoutBeforeReady=y(f.requestTimeoutBeforeReady),f.readyTimeout=y(f.readyTimeout),f.eventsFirstPushWindow=y(f.eventsFirstPushWindow),n.mode=function(t,e){if("localhost"===t)return $;if(-1===[X,"producer",Z,tt].indexOf(e))throw Error("Invalid mode provided");return e}(n.core.authorizationKey,n.mode),o&&(n.storage=o(n)),n.core.key),h=(e.acceptKey?(n.mode===$&&void 0===p?n.core.key="localhost_key":n.core.key=Pt(a,p,"Client instantiation"),e.acceptTT&&void 0!==(c=n.core.trafficType)&&(n.core.trafficType=Dt(a,c,"Client instantiation"))):(void 0!==p&&a.warn("Provided `key` is ignored in server-side SDK."),n.core.key=void 0),n.runtime=r(n),i&&(n.integrations=i(n)),s&&(n.sync.localhostMode=s(n)),!1!==n.streamingEnabled&&(n.streamingEnabled=!0,l.pushRetryBackoffBase=y(l.pushRetryBackoffBase)),!1!==n.sync.enabled&&(n.sync.enabled=!0),It(a,n.sync.splitFilters,n.mode));return n.sync.splitFilters=h.validFilters,n.sync.__splitFiltersValidation=h,n.userConsent=u(n),n}var Kt="api_key";var c={};function Ut(t,e){n=t,r=!1,null==(e=e)?n.error(z.bb,[z.tb,Kt]):Object(F.k)(e)?0<e.length?r=e:n.error(z.K,[z.tb,Kt]):n.error(z.S,[z.tb,Kt]);var n,r,e=r;e&&(c[e]?(t.warn(z.sc,[c[e]+" factory/ies with this API Key"]),c[e]++):(c[e]=1)<Object.keys(c).length&&t.warn(z.sc,["an instance of the Split factory"]))}function Bt(t){var e=t();return function(){return Math.round(t()-e)}}(e={})[X]=0,e[Z]=1,e[tt]=2;var qt=e,zt=((e={})[W]=0,e[d]=1,e[V]=2,e),Wt=((e={})[x]=1,e[u]=2,e[rt]=3,e);function Vt(t,e){return{oM:qt[t],st:e.toLowerCase(),aF:Object.keys(c).length,rF:Object.keys(c).reduce(function(t,e){return t+c[e]-1},0)}}function Ht(t){var e,n,r,i,o,a,s,u=t.storage.telemetry,c=t.platform.now;if(u&&c)return e=t.settings,r=t.settings,n=r.log,r=r.scheduler.telemetryRefreshRate,i=t.splitApi,o=t.readiness,t=t.sdkReadinessManager,a=Bt(c),s=gt(mt(n,i.postMetricsUsage,u,r,"telemetry stats",void 0,0,!0),r),o.gate.once(Tt,function(){u.recordTimeUntilReadyFromCache(a())}),t.incInternalReadyCbCount(),o.gate.once(Q,function(){var r,o;u.recordTimeUntilReady(a()),s.isRunning()&&mt(n,i.postMetricsConfig,(r=u,o=e,{isEmpty:function(){return!1},clear:function(){},pop:function(){var t=o.urls,e=o.scheduler,n=void 0!==o.core.key;return Object(q.a)(Vt(o.mode,o.storage.type),{sE:o.streamingEnabled,rR:{sp:e.featuresRefreshRate/1e3,se:n?void 0:e.segmentsRefreshRate/1e3,ms:n?e.segmentsRefreshRate/1e3:void 0,im:e.impressionsRefreshRate/1e3,ev:e.eventsPushRate/1e3,te:e.telemetryRefreshRate/1e3},uO:{s:t.sdk!==Mt.urls.sdk,e:t.events!==Mt.urls.events,a:t.auth!==Mt.urls.auth,st:t.streaming!==Mt.urls.streaming,t:t.telemetry!==Mt.urls.telemetry},iQ:e.impressionsQueueSize,eQ:e.eventsQueueSize,iM:zt[o.sync.impressionsMode],iL:!!o.impressionListener,hP:!1,tR:r.getTimeUntilReady(),tC:r.getTimeUntilReadyFromCache(),nR:r.getNonReadyUsage(),t:r.popTags(),i:o.integrations&&o.integrations.map(function(t){return t.type}),uC:o.userConsent?Wt[o.userConsent]:0})}}),0,"telemetry config",void 0,0,!0).execute()}),s}var Gt="unique keys",Qt=9e5;function Yt(t){var e,n,r,o,i,a,s,u,c,l=[(r=(i=(f=t).settings).log,s=i.scheduler.impressionsRefreshRate,i=i.core.labelsEnabled,u=f.splitApi.postTestImpressionsBulk,f=f.storage.impressions,o=mt(r,u,f,s,bt,St.bind(void 0,i),1),f.setOnFullQueueCb(function(){o.isRunning()&&(r.info(z.Zb,[bt]),o.execute())}),o),(e=(s=(u=t).settings).log,i=s.scheduler.eventsPushRate,s=s.startup.eventsFirstPushWindow,f=u.splitApi.postEventsBulk,u=u.storage.events,n=mt(e,f,u,i,vt),0<s&&(n=gt(n,s)),u.setOnFullQueueCb(function(){n.isRunning()&&(e.info(z.Zb,[vt]),n.execute())}),n)],f=function(t){var e=t.settings.log,n=t.splitApi.postTestImpressionsCount;if(t=t.storage.impressionCounts)return mt(e,n,t,wt,"impression counts",Ot,1)}(t),p=(f&&l.push(f),Ht(t));return t.storage.uniqueKeys&&l.push((a=(s=(i=t).settings).log,s=s.core.key,f=(u=i.splitApi).postUniqueKeysBulkCs,u=u.postUniqueKeysBulkSs,i=i.storage.uniqueKeys,c=mt(a,void 0!==s?f:u,i,Qt,Gt),i.setOnFullQueueCb(function(){c.isRunning()&&(a.info(z.Zb,[Gt]),c.execute())}),c)),{start:function(t){t||l.forEach(function(t){return t.start()}),p&&p.start()},stop:function(t){l.forEach(function(t){return t.stop()}),!t&&p&&p.stop()},isRunning:function(){return l.some(function(t){return t.isRunning()})},execute:function(t){t=t?[]:l.map(function(t){return t.execute()});return p&&t.push(p.execute()),Promise.all(t)},isExecuting:function(){return l.some(function(t){return t.isExecuting()})}}}var K,Jt="PUSH_NONRETRYABLE_ERROR",$t="PUSH_RETRYABLE_ERROR",Xt="PUSH_SUBSYSTEM_UP",Zt="PUSH_SUBSYSTEM_DOWN",te="MY_SEGMENTS_UPDATE",ee="MY_SEGMENTS_UPDATE_V2",ne="SEGMENT_UPDATE",re="SPLIT_KILL",oe="SPLIT_UPDATE",ie="CONTROL",ae="OCCUPANCY";function se(t){t=t.userConsent;return!t||t===u}(e=K=K||{}).STREAMING_DISABLED="STREAMING_DISABLED",e.STREAMING_PAUSED="STREAMING_PAUSED",e.STREAMING_RESUMED="STREAMING_RESUMED",e.STREAMING_RESET="STREAMING_RESET";r.prototype.scheduleCall=function(){var t=this,e=Math.min(this.baseMillis*Math.pow(2,this.attempts),this.maxMillis);return this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout(function(){t.timeoutID=void 0,t.cb()},e),this.attempts++,e},r.prototype.reset=function(){this.attempts=0,this.timeoutID&&(clearTimeout(this.timeoutID),this.timeoutID=void 0)},r.DEFAULT_BASE_MILLIS=1e3,r.DEFAULT_MAX_MILLIS=18e5;var ue=r;function r(t,e,n){this.baseMillis=r.__TEST__BASE_MILLIS||e||r.DEFAULT_BASE_MILLIS,this.maxMillis=r.__TEST__MAX_MILLIS||n||r.DEFAULT_MAX_MILLIS,this.attempts=0,this.cb=t}var ce=[/control_pri$/,/control_sec$/],le=[10,20];function fe(i,a){var s=ce.map(function(t){return{regex:t,hasPublishers:!0,oTime:-1,cTime:-1}}),u=!0,c=!0;return{handleOpen:function(){a.streamingEvent(ot),i.emit(Xt)},isStreamingUp:function(){return c&&u},handleOccupancyEvent:function(t,e,n){for(var r=0;r<s.length;r++){var o=s[r];if(o.regex.test(e))return a.streamingEvent(le[r],t),void(n>o.oTime&&(o.oTime=n,o.hasPublishers=0!==t,o=s.some(function(t){return t.hasPublishers}),c&&(!o&&u?i.emit(Zt):o&&!u&&i.emit(Xt)),u=o))}},handleControlEvent:function(t,e,n){if(t===K.STREAMING_RESET)i.emit(t);else for(var r=0;r<s.length;r++){var o=s[r];if(o.regex.test(e))return void(n>o.cTime&&(o.cTime=n,t===K.STREAMING_DISABLED?(a.streamingEvent(it,ct),i.emit(Jt)):u&&(t===K.STREAMING_PAUSED&&c?(a.streamingEvent(it,ft),i.emit(Zt)):t!==K.STREAMING_RESUMED||c||(a.streamingEvent(it,lt),i.emit(Xt))),c=t===K.STREAMING_RESUMED))}}}}function pe(i,a,r){var s=fe(a,r);return{handleOpen:function(){s.handleOpen()},handleError:function(t){var e,n=t;try{e=t,Object(F.k)(e.data)&&(e.parsedData=JSON.parse(e.data)),n=e}catch(t){i.warn(z.Sb,[t])}t=n.parsedData&&n.parsedData.message||n.message;i.error(z.fb,[t]),!function(t){if(t.parsedData&&t.parsedData.code){t=t.parsedData.code;if(r.streamingEvent(st,t),40140<=t&&t<=40149)return 1;if(4e4<=t&&t<=49999)return}else r.streamingEvent(at,ut);return 1}(n)?a.emit(Jt):a.emit($t)},handleMessage:function(t){var e;try{if(!(e=function(t){if(t.data)return(t=JSON.parse(t.data)).parsedData=JSON.parse(t.data),t.name&&"[meta]occupancy"===t.name&&(t.parsedData.type=ae),t}(t)))return}catch(t){return void i.warn(z.Tb,[t])}var n=e.parsedData,t=e.data,r=e.channel,o=e.timestamp;if(i.debug(z.Rb,[t]),s.isStreamingUp()||-1!==[ae,ie].indexOf(n.type))switch(n.type){case oe:case ne:case ee:case re:a.emit(n.type,n);break;case te:a.emit(n.type,n,r);break;case ae:s.handleOccupancyEvent(n.metrics.publishers,r,o);break;case ie:s.handleControlEvent(n.controlType,r,o)}}}}var he=1e4,de=6e4,ye=10;function me(c,l,f){var p={};return{put:function(t){var e,n,r,o,i,a,s=t.changeNumber,t=t.segmentName;function u(){n=!0,o>f.getChangeNumber(e)?(i=!1,l.execute(!1,e,!0,r?o:void 0).then(function(){var t;n&&(i?u():(t=a.attempts+1,o<=f.getChangeNumber(e)?(c.debug("Refresh completed"+(r?" bypassing the CDN":"")+" in "+t+" attempts."),n=!1):t<ye?a.scheduleCall():r?(c.debug("No changes fetched after "+t+" attempts with CDN bypassed."),n=!1):(a.reset(),r=!0,u())))})):n=!1}p[t]||(p[t]=(e=t,o=0,i=!1,a=new ue(u,he,de),{put:function(t){t<=f.getChangeNumber(e)||t<=o||(o=t,r=!(i=!0),!a.timeoutID&&n||u(),a.reset())},stop:function(){n=!1,a.reset()}})),p[t].put(s)},stop:function(){Object.keys(p).forEach(function(t){return p[t].stop()})}}}var ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ve(t){var e=String(t).replace(/[=]+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r="",o=0,i=void 0,a=0;n=e.charAt(a++);~n&&(i=o%4?64*i+n:n,o++%4)&&(r+=String.fromCharCode(255&i>>(-2*o&6))))n=ge.indexOf(n);return r}function be(t,o){for(var e,n=t,r=function(t){var e=t,n=o,r=null;for("number"==typeof e&&(r=e,e=function(){return null});null!==r||null!==(r=e());)r<128?n(127&r):(r<2048?n(r>>6&31|192):(r<65536?n(r>>12&15|224):(n(r>>18&7|240),n(r>>12&63|128)),n(r>>6&63|128)),n(63&r|128)),r=null},i=null;null!==(e=null!==i?i:n());)55296<=e&&e<=57343&&null!==(i=n())&&56320<=i&&i<=57343?(r(1024*(e-55296)+i-56320+65536),i=null):r(e);null!==i&&r(i)}var Se=String.fromCharCode;function Oe(t){var e,n;return be(function(t){if("string"!=typeof t)throw TypeError("Illegal argument: "+typeof t);var e=0;return function(){return e>=t.length?null:t.charCodeAt(e++)}}(t),(e=[],n=[],t=function(){if(0===arguments.length)return n.join("")+Se.apply(String,e);1024<e.length+arguments.length&&(n.push(Se.apply(String,e)),e.length=0),Array.prototype.push.apply(e,arguments)})),t()}
/*!
 * +----------------------------------------------------------------------------------+
 * | murmurHash3.js v3.0.0 (http://github.com/karanlyons/murmurHash3.js)              |
 * | A TypeScript/JavaScript implementation of MurmurHash3's hashing algorithms.      |
 * |----------------------------------------------------------------------------------|
 * | Copyright (c) 2012-2020 Karan Lyons. Freely distributable under the MIT license. |
 * +----------------------------------------------------------------------------------+
 */function we(t,e){return(65535&t)*e+(((t>>>16)*e&65535)<<16)}function _e(t,e){return t<<e|t>>>32-e}function je(t,e){for(var n=(t=t||"").length%4,r=t.length-n,o=e=e||0,i=0,a=0;a<r;a+=4)i=we(i=255&t.charCodeAt(a)|(255&t.charCodeAt(a+1))<<8|(255&t.charCodeAt(a+2))<<16|(255&t.charCodeAt(a+3))<<24,3432918353),i=we(i=_e(i,15),461845907),o=we(o=_e(o^=i,13),5)+3864292196;switch(i=0,n){case 3:i^=(255&t.charCodeAt(a+2))<<16;case 2:i^=(255&t.charCodeAt(a+1))<<8;case 1:i=we(i^=255&t.charCodeAt(a),3432918353),o^=i=we(i=_e(i,15),461845907)}return o^=t.length,e=o,e=we(e^=e>>>16,2246822507),e=we(e^=e>>>13,3266489909),(o=e^=e>>>16)>>>0}function Te(t,e){return je(Oe(t),e>>>0)}function Ee(t,e){return Math.abs(Te(t,e)%100)+1}function ke(e){return function(t){return e(t).then(function(t){return t.json()}).then(function(t){if(t.token){n=(n=t.token).split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(ve(n).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));n=JSON.parse(n);if("number"!=typeof n.iat||"number"!=typeof n.exp)throw new Error('token properties "issuedAt" (iat) or "expiration" (exp) are missing or invalid');var e=JSON.parse(n["x-ably-capability"]);return Object(q.a)({decodedToken:n,channels:e},t)}var n;return t})}}function Ae(t){for(var e,t=Te(t,0).toString(),n=String(t),r="",o=void 0,i=0,a=ge;n.charAt(0|i)||(a="=",i%1);r+=a.charAt(63&o>>8-i%1*8)){if(255<(e=n.charCodeAt(i+=.75)))throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");o=o<<8|e}return r}var Ce=/^control_/;Re.prototype.setEventHandler=function(t){this.handler=t},Re.prototype.open=function(t){this.close();var e=Object.keys(t.channels).map(function(t){var e=Ce.test(t)?"[?occupancy=metrics.publishers]":"";return encodeURIComponent(e+t)}).join(","),e=this.streamingUrl+"?channels="+e+"&accessToken="+t.token+"&v=1.1&heartbeats=true";this.connection=new this.eventSource(this.useHeaders?e:e+"&SplitSDKVersion="+this.headers.SplitSDKVersion+"&SplitSDKClientKey="+this.headers.SplitSDKClientKey,this.useHeaders?{headers:this.headers}:void 0),this.handler&&(this.connection.addEventListener("open",this.handler.handleOpen),this.connection.addEventListener("message",this.handler.handleMessage),this.connection.addEventListener("error",this.handler.handleError))},Re.prototype.close=function(){this.connection&&this.connection.close()};var xe,Ie=Re;function Re(t,e,n){if(this.eventSource=n&&n(),!this.eventSource)throw new Error("EventSource API is not available. ");this.streamingUrl=t.urls.streaming+"/sse",this.useHeaders=e,this.headers=(n=t,e={SplitSDKClientKey:Object(F.k)(n.core.authorizationKey)?n.core.authorizationKey.slice(-4):"",SplitSDKVersion:n.version},t=(n=n.runtime).ip,n=n.hostname,t&&(e.SplitSDKMachineIP=t),n&&(e.SplitSDKMachineName=n),e)}function Pe(t){return Object(F.j)(t)?t.matchingKey:t}function Ne(t){return Object(F.j)(t)?{matchingKey:t.matchingKey,bucketingKey:t.bucketingKey}:{matchingKey:t,bucketingKey:t}}(e=xe=xe||{})[e.UnboundedFetchRequest=0]="UnboundedFetchRequest",e[e.BoundedFetchRequest=1]="BoundedFetchRequest",e[e.KeyList=2]="KeyList",e[e.SegmentRemoval=3]="SegmentRemoval";var Le=function(){if([typeof Uint8Array,typeof Uint16Array,typeof Uint32Array].some(function(t){return"function"!=t}))return"global Uint8Array object is not available for gzip/zlib decompression";function t(t,e){for(var n=new z(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var o=new W(n[30]),r=1;r<30;++r)for(var i=n[r];i<n[r+1];++i)o[i]=i-n[r]<<5|r;return[n,o]}var q=Uint8Array,z=Uint16Array,W=Uint32Array,V=new q([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),H=new q([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),G=new q([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),e=t(V,2),Q=e[0];e[1][Q[28]=258]=28;for(var Y=t(H,0)[0],h=new z(32768),n=0;n<32768;++n){var r=(43690&n)>>>1|(21845&n)<<1;h[n]=((65280&(r=(61680&(r=(52428&r)>>>2|(13107&r)<<2))>>>4|(3855&r)<<4))>>>8|(255&r)<<8)>>>1}for(var J=function(t,e,n){for(var r=t.length,o=0,i=new z(e);o<r;++o)++i[t[o]-1];var a=new z(e);for(o=0;o<e;++o)a[o]=a[o-1]+i[o-1]<<1;if(n){for(var s=new z(1<<e),u=15-e,o=0;o<r;++o)if(t[o])for(var c=o<<4|t[o],l=e-t[o],f=a[t[o]-1]++<<l,p=f|(1<<l)-1;f<=p;++f)s[h[f]>>>u]=c}else for(s=new z(r),o=0;o<r;++o)t[o]&&(s[o]=h[a[t[o]-1]++]>>>15-t[o]);return s},o=new q(288),n=0;n<144;++n)o[n]=8;for(n=144;n<256;++n)o[n]=9;for(n=256;n<280;++n)o[n]=7;for(n=280;n<288;++n)o[n]=8;for(var i=new q(32),n=0;n<32;++n)i[n]=5;function $(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e}function X(t,e,n){var r=e/8|0;return(t[r]|t[1+r]<<8)>>(7&e)&n}function Z(t,e){var n=e/8|0;return(t[n]|t[1+n]<<8|t[2+n]<<16)>>(7&e)}function a(t,n,e){var r=t.length;if(!r||e&&e.f&&!e.l)return n||new q(0);function o(t){var e=n.length;e<t&&((e=new q(Math.max(2*e,t))).set(n),n=e)}var i,a,s,u,c=!n||e,l=!e||e.i,f=(e=e||{},n=n||new q(3*r),e.f||0),p=e.p||0,h=e.b||0,d=e.l,y=e.d,m=e.m,g=e.n,v=8*r;do{if(!d){var f=X(t,p,1),b=X(t,p+1,3);if(p+=3,!b){var S=t[(k=4+((p+7)/8|0))-4]|t[k-3]<<8,O=k+S;if(r<O){l&&nt(0);break}c&&o(h+S),n.set(t.subarray(k,O),h),e.b=h+=S,e.p=p=8*O,e.f=f;continue}if(1==b)d=tt,y=et,m=9,g=5;else if(2==b){for(var S=X(t,p,31)+257,w=X(t,p+10,15)+4,_=S+X(t,p+5,31)+1,j=(p+=14,new q(_)),T=new q(19),E=0;E<w;++E)T[G[E]]=X(t,p+3*E,7);p+=3*w;for(var O=$(T),D=(1<<O)-1,M=J(T,O,1),E=0;E<_;){var k,A=M[X(t,p,D)];if(p+=15&A,(k=A>>>4)<16)j[E++]=k;else{var C=0,x=0;for(16==k?(x=3+X(t,p,3),p+=2,C=j[E-1]):17==k?(x=3+X(t,p,7),p+=3):18==k&&(x=11+X(t,p,127),p+=7);x--;)j[E++]=C}}var b=j.subarray(0,S),I=j.subarray(S),m=$(b),g=$(I),d=J(b,m,1),y=J(I,g,1)}else nt(1);if(v<p){l&&nt(0);break}}c&&o(h+131072);for(var F=(1<<m)-1,K=(1<<g)-1,R=p;;R=p){var P=(C=d[Z(t,p)&F])>>>4;if(v<(p+=15&C)){l&&nt(0);break}if(C||nt(2),P<256)n[h++]=P;else{if(256==P){R=p,d=null;break}var N,U=P-254,P=(264<P&&(N=V[E=P-257],U=X(t,p,(1<<N)-1)+Q[E],p+=N),y[Z(t,p)&K]),L=P>>>4,I=(P||nt(3),p+=15&P,Y[L]);if(3<L&&(N=H[L],I+=Z(t,p)&(1<<N)-1,p+=N),v<p){l&&nt(0);break}c&&o(h+131072);for(var B=h+U;h<B;h+=4)n[h]=n[h-I],n[h+1]=n[h+1-I],n[h+2]=n[h+2-I],n[h+3]=n[h+3-I];h=B}}e.l=d,e.p=R,e.b=h,e.f=f,d&&(f=1,e.m=m,e.d=y,e.n=g)}while(!f);return h==n.length?n:(i=n,(null==(a=0)||a<0)&&(a=0),(null==(s=h)||s>i.length)&&(s=i.length),(u=new(i instanceof z?z:i instanceof W?W:q)(s-a)).set(i.subarray(a,s)),u)}var tt=J(o,9,1),et=J(i,5,1),s=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],nt=function(t,e,n){e=new Error(e||s[t]);if(e.code=t,Error.captureStackTrace&&Error.captureStackTrace(e,nt),n)return e;throw e};return{gunzipSync:function(t,e){return a(t.subarray(function(t){31==t[0]&&139==t[1]&&8==t[2]||nt(6,"invalid gzip data");var e=t[3],n=10;4&e&&(n+=t[10]|2+(t[11]<<8));for(var r=(e>>3&1)+(e>>4&1);0<r;r-=!t[n++]);return n+(2&e)}(t),-8),e||new q((e=t.length,(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0)))},unzlibSync:function(t,e){return a(((8!=(15&(n=t)[0])||7<n[0]>>>4||(n[0]<<8|n[1])%31)&&nt(6,"invalid zlib data"),32&n[1]&&nt(6,"invalid zlib data: preset dictionaries not supported"),t.subarray(2,-4)),e);var n}}}(),De=1,Me=2;function Fe(t,e){var t=ve(t),t=(t=(t=t).split("").map(function(t){return t.charCodeAt(0)}),new Uint8Array(t));if("string"==typeof Le)throw new Error(Le);if(e===De)return Le.gunzipSync(t);if(e===Me)return Le.unzlibSync(t);throw new Error("Invalid compression algorithm #"+e)}function Ke(t,e){t=Fe(t,e),e=String.fromCharCode.apply(null,t);return JSON.parse(e.replace(/\d+/g,'"$&"'))}Be.prototype.clear=function(){this.__setData__.length&&(this.__setData__.length=0)},Be.prototype.add=function(t){return this.has(t)||this.__setData__.push(t),this},Be.prototype.delete=function(t){t=this.__setData__.indexOf(t);return-1!==t&&(this.__setData__.splice(t,1),!0)},Be.prototype.has=function(t){return-1!==this.__setData__.indexOf(t)},Be.prototype.forEach=function(t,e){if("function"!=typeof t)throw new TypeError(t+" is not a function");for(var n=0;n<this.__setData__.length;n++){var r=this.__setData__[n];t.call(e,r,r,this)}},Object.defineProperty(Be.prototype,"size",{get:function(){return this.__setData__.length},enumerable:!1,configurable:!0});var Ue=Be;function Be(t){var e=this;this.__setData__=[],Array.isArray(t)&&t.forEach(function(t){e.add(t)})}function qe(t){return t instanceof Ue?t.__setData__.slice():Array.from(t)}var ze="function"==typeof Array.from&&"function"==typeof Set&&Set.prototype&&Set.prototype.values?Set:Ue;function p(t,e){t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]],e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]];var n=[0,0,0,0];return n[3]+=t[3]+e[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=t[2]+e[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=t[1]+e[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=t[0]+e[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function h(t,e){t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]],e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]];var n=[0,0,0,0];return n[3]+=t[3]*e[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=t[2]*e[3],n[1]+=n[2]>>>16,n[2]&=65535,n[2]+=t[3]*e[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=t[1]*e[3],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=t[2]*e[2],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=t[3]*e[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=t[0]*e[3]+t[1]*e[2]+t[2]*e[1]+t[3]*e[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function We(t,e){return 32===(e%=64)?[t[1],t[0]]:e<32?[t[0]<<e|t[1]>>>32-e,t[1]<<e|t[0]>>>32-e]:[t[1]<<(e-=32)|t[0]>>>32-e,t[0]<<e|t[1]>>>32-e]}function m(t,e){return 0===(e%=64)?t:e<32?[t[0]<<e|t[1]>>>32-e,t[1]<<e]:[t[1]<<e-32,0]}function v(t,e){return[t[0]^e[0],t[1]^e[1]]}function Ve(t){return t=v(t,[0,t[0]>>>1]),t=v(t=h(t,[4283543511,3981806797]),[0,t[0]>>>1]),t=v(t=h(t,[3301882366,444984403]),[0,t[0]>>>1])}function He(t,e){for(var n=Oe(t),t=e>>>0,e=(n=n||"").length%16,r=n.length-e,o=[0,t=t||0],i=[0,t],a=[0,0],s=[0,0],u=[2277735313,289559509],c=[1291169091,658871167],l=0;l<r;l+=16)a=[255&n.charCodeAt(l+4)|(255&n.charCodeAt(l+5))<<8|(255&n.charCodeAt(l+6))<<16|(255&n.charCodeAt(l+7))<<24,255&n.charCodeAt(l)|(255&n.charCodeAt(l+1))<<8|(255&n.charCodeAt(l+2))<<16|(255&n.charCodeAt(l+3))<<24],s=[255&n.charCodeAt(l+12)|(255&n.charCodeAt(l+13))<<8|(255&n.charCodeAt(l+14))<<16|(255&n.charCodeAt(l+15))<<24,255&n.charCodeAt(l+8)|(255&n.charCodeAt(l+9))<<8|(255&n.charCodeAt(l+10))<<16|(255&n.charCodeAt(l+11))<<24],a=We(a=h(a,u),31),o=p(o=We(o=v(o,a=h(a,c)),27),i),o=p(h(o,[0,5]),[0,1390208809]),s=We(s=h(s,c),33),i=p(i=We(i=v(i,s=h(s,u)),31),o),i=p(h(i,[0,5]),[0,944331445]);switch(a=[0,0],s=[0,0],e){case 15:s=v(s,m([0,n.charCodeAt(l+14)],48));case 14:s=v(s,m([0,n.charCodeAt(l+13)],40));case 13:s=v(s,m([0,n.charCodeAt(l+12)],32));case 12:s=v(s,m([0,n.charCodeAt(l+11)],24));case 11:s=v(s,m([0,n.charCodeAt(l+10)],16));case 10:s=v(s,m([0,n.charCodeAt(l+9)],8));case 9:s=h(s=v(s,[0,n.charCodeAt(l+8)]),c),i=v(i,s=h(s=We(s,33),u));case 8:a=v(a,m([0,n.charCodeAt(l+7)],56));case 7:a=v(a,m([0,n.charCodeAt(l+6)],48));case 6:a=v(a,m([0,n.charCodeAt(l+5)],40));case 5:a=v(a,m([0,n.charCodeAt(l+4)],32));case 4:a=v(a,m([0,n.charCodeAt(l+3)],24));case 3:a=v(a,m([0,n.charCodeAt(l+2)],16));case 2:a=v(a,m([0,n.charCodeAt(l+1)],8));case 1:a=h(a=v(a,[0,n.charCodeAt(l)]),u),o=v(o,a=h(a=We(a,31),c))}return o=p(o=v(o,[0,n.length]),i=v(i,[0,n.length])),i=p(i,o),o=p(o=Ve(o),i=Ve(i)),i=p(i,o),("00000000"+(o[0]>>>0).toString(16)).slice(-8)+("00000000"+(o[1]>>>0).toString(16)).slice(-8)+("00000000"+(i[0]>>>0).toString(16)).slice(-8)+("00000000"+(i[1]>>>0).toString(16)).slice(-8)}function Ge(t){t=He(t).slice(0,16);return{hex:t,dec:function(t){for(var e,n,r=[0],o=0;o<t.length;o+=1){for(n=parseInt(t.charAt(o),16),e=r.length-1;0<=e;--e)r[e]=16*r[e]+n,n=r[e]/10|0,r[e]%=10;for(;0<n;)r.unshift(n%10),n=n/10|0}return r.join("")}(t)}}function Qe(t,o){return t<1?o:new Promise(function(e,n){var r=setTimeout(function(){n(new Error("Operation timed out because it exceeded the configured time limit of "+t+" ms."))},t);o.then(function(t){clearTimeout(r),e(t)},function(t){clearTimeout(r),n(t)})})}function Ye(o,i,r,a,s,e,u,c){var l=!0,f=!0;function p(t){return t=f?Qe(e,t):t}function h(t){var e,n;Array.isArray(t)?e=a.resetSegments(t):(n=t.name,t=t.add,a.isInSegment(n)!==t?(e=!0,t?a.addToSegment(n):a.removeFromSegment(n)):e=!1),r.usesSegments()&&(e||l)&&(l=!1,s.emit(G))}return function(t,e){return function e(n,r,t){return(r?new Promise(function(t){h(r),t(!0)}):i(c,t,p).then(function(t){return f=!1,h(t),!0})).catch(function(t){return f&&n<u?(n+=1,o.warn(z.cc,[n,t]),e(n)):f=!1})}(0,t,e)}}function Je(t){var n=new ze,t=t.reduce(function(t,e){return"ACTIVE"===e.status?(t.added.push([e.name,e]),function(t){for(var e=t.conditions,n=new ze,r=0;r<e.length;r++)e[r].matcherGroup.matchers.forEach(function(t){"IN_SEGMENT"===t.matcherType&&n.add(t.userDefinedSegmentMatcherData.segmentName)});return n}(e).forEach(function(t){n.add(t)})):t.removed.push(e.name),t},{added:[],removed:[],segments:[]});return t.segments=qe(n),t}function $e(a,s,u,c,l,e,f,p){void 0===e&&(e=0),void 0===f&&(f=0);var h=!0;function d(t){return t=h&&e?Qe(e,t):t}return function(o,i){return Promise.resolve(u.getChangeNumber()).then(function e(n,r){void 0===r&&(r=0),a.debug(z.ec,[n]);var t=s(n,o,i,d).then(function(t){h=!1;var e=Je(t.splits);return a.debug(z.hc,[e.added.length]),a.debug(z.ic,[e.removed.length]),a.debug(z.jc,[e.segments.length]),Promise.all([u.setChangeNumber(t.till),u.addSplits(e.added),u.removeSplits(e.removed),c.registerSegments(e.segments)]).then(function(){var e;return!l||Promise.resolve(!l.splitsArrived||n!==t.till&&(p||(e=c,Promise.resolve(e.getRegisteredSegments()).then(function(t){return Promise.all(t.map(function(t){return e.getChangeNumber(t)})).then(function(t){return t.every(function(t){return-1!==t})})})))).catch(function(){return!1}).then(function(t){return t&&l.emit(H),!0})})}).catch(function(t){return a.warn(z.fc,[t]),h&&r<f?(r+=1,a.info(z.gc,[r,t]),e(n,r)):h=!1});return l&&h&&Promise.resolve(u.checkCache()).then(function(t){t&&l.emit(_t)}),t})}}Ze.prototype.setOnFullQueueCb=function(t){this.onFullQueue=t},Ze.prototype.track=function(t){var e;(e=this.queue).push.apply(e,t),0<this.maxQueue&&this.queue.length>=this.maxQueue&&this.onFullQueue&&this.onFullQueue()},Ze.prototype.clear=function(){this.queue=[]},Ze.prototype.pop=function(t){var e=this.queue;return this.clear(),t?t.concat(e):e},Ze.prototype.isEmpty=function(){return 0===this.queue.length};var Xe=Ze;function Ze(t){this.maxQueue=t=void 0===t?0:t,this.queue=[]}function tn(t){return t-t%36e5}nn.prototype._makeKey=function(t,e){return t+"::"+tn(e)},nn.prototype.track=function(t,e,n){t=this._makeKey(t,e),e=this.cache[t];this.cache[t]=e?e+n:n,this.onFullQueue&&(this.cacheSize=this.cacheSize+n,this.cacheSize>=this.maxStorage)&&this.onFullQueue()},nn.prototype.pop=function(e){var n=this.cache;return this.clear(),e?(Object.keys(n).forEach(function(t){e[t]?e[t]+=n[t]:e[t]=n[t]}),e):n},nn.prototype.clear=function(){this.cache={},this.cacheSize=0},nn.prototype.isEmpty=function(){return 0===Object.keys(this.cache).length};var en=nn;function nn(t){void 0===t&&(t=3e4),this.cache={},this.cacheSize=0,this.maxStorage=t}on.prototype.setOnFullQueueCb=function(t){this.onFullQueue=t},on.prototype.track=function(t,e){return this.queueByteSize+=e=void 0===e?0:e,this.queue.push(t),this._checkForFlush(),!0},on.prototype.clear=function(){this.queue=[],this.queueByteSize=0},on.prototype.pop=function(t){var e=this.queue;return this.clear(),t?t.concat(e):e},on.prototype.isEmpty=function(){return 0===this.queue.length},on.prototype._checkForFlush=function(){(5242880<this.queueByteSize||0<this.maxQueue&&this.queue.length>=this.maxQueue)&&this.onFullQueue&&this.onFullQueue()};var rn=on;function on(t){this.maxQueue=t=void 0===t?0:t,this.queue=[],this.queueByteSize=0}var an=/[^.]+$/;n.prototype.buildTrafficTypeKey=function(t){return this.prefix+".trafficType."+t},n.prototype.buildSplitKey=function(t){return this.prefix+".split."+t},n.prototype.buildSplitsTillKey=function(){return this.prefix+".splits.till"},n.prototype.isSplitKey=function(t){return Object(F.m)(t,this.prefix+".split.")},n.prototype.buildSplitKeyPrefix=function(){return this.prefix+".split."},n.prototype.buildSplitsWithSegmentCountKey=function(){return this.prefix+".splits.usingSegments"},n.prototype.buildSegmentNameKey=function(t){return this.prefix+".segment."+t},n.prototype.buildSegmentTillKey=function(t){return this.prefix+".segment."+t+".till"},n.prototype.extractKey=function(t){t=t.match(an);if(t&&t.length)return t[0];throw new Error("Invalid latency key provided")};var e=n;function n(t){this.prefix=t=void 0===t?"SPLITIO":t}var sn,un=t(5),cn=(sn=e,Object(un.a)(o,sn),o.prototype.buildSegmentNameKey=function(t){return this.prefix+"."+this.matchingKey+".segment."+t},o.prototype.extractSegmentName=function(t){var e=this.prefix+"."+this.matchingKey+".segment.";if(Object(F.m)(t,e))return t.substr(e.length)},o.prototype.buildOldSegmentNameKey=function(t){return this.matchingKey+"."+this.prefix+".segment."+t},o.prototype.extractOldSegmentKey=function(t){var e=this.matchingKey+"."+this.prefix+".segment.";if(Object(F.m)(t,e))return t.substr(e.length)},o.prototype.buildLastUpdatedKey=function(){return this.prefix+".splits.lastUpdated"},o.prototype.isSplitsCacheKey=function(t){return this.regexSplitsCacheKey.test(t)},o.prototype.buildSplitsFilterQueryKey=function(){return this.prefix+".splits.filterQuery"},o);function o(t,e){var n=sn.call(this,t)||this;return n.matchingKey=e,n.regexSplitsCacheKey=new RegExp("^"+t+"\\.(splits?|trafficType)\\."),n}var ln=t(10),e=(fn.prototype.addSplits=function(t){var e=this;return t.map(function(t){return e.addSplit(t[0],t[1])})},fn.prototype.removeSplits=function(t){var e=this;return t.map(function(t){return e.removeSplit(t)})},fn.prototype.getSplits=function(t){var e=this,n={};return t.forEach(function(t){n[t]=e.getSplit(t)}),n},fn.prototype.getAll=function(){var e=this;return this.getSplitNames().map(function(t){return e.getSplit(t)})},fn.prototype.checkCache=function(){return!1},fn.prototype.killLocally=function(t,e,n){var r=this.getSplit(t);return!(!r||r.changeNumber&&!(r.changeNumber<n))&&((r=Object(q.a)({},r)).killed=!0,r.defaultTreatment=e,r.changeNumber=n,this.addSplit(t,r))},fn);function fn(){}function pn(t){for(var e=t.conditions||[],n=0;n<e.length;n++)for(var r=e[n].matcherGroup.matchers,o=0;o<r.length;o++)if("IN_SEGMENT"===r[o].matcherType)return 1}var hn,l="storage:localstorage: ",dn=(hn=e,Object(un.a)(i,hn),i.prototype._decrementCount=function(t){var e=Object(F.o)(localStorage.getItem(t))-1;0<e?localStorage.setItem(t,e):localStorage.removeItem(t)},i.prototype._decrementCounts=function(t){try{var e,n;t&&(t.trafficTypeName&&(e=this.keys.buildTrafficTypeKey(t.trafficTypeName),this._decrementCount(e)),pn(t))&&(n=this.keys.buildSplitsWithSegmentCountKey(),this._decrementCount(n))}catch(t){this.log.error(l+t)}},i.prototype._incrementCounts=function(t){try{var e,n;t&&(t.trafficTypeName&&(e=this.keys.buildTrafficTypeKey(t.trafficTypeName),localStorage.setItem(e,Object(F.o)(localStorage.getItem(e))+1)),pn(t))&&(n=this.keys.buildSplitsWithSegmentCountKey(),localStorage.setItem(n,Object(F.o)(localStorage.getItem(n))+1))}catch(t){this.log.error(l+t)}},i.prototype.clear=function(){this.log.info(l+"Flushing Splits data from localStorage");for(var t=localStorage.length,e=[],n=0;n<t;n++){var r=localStorage.key(n);null!=r&&this.keys.isSplitsCacheKey(r)&&e.push(r)}e.forEach(function(t){localStorage.removeItem(t)}),this.hasSync=!1},i.prototype.addSplit=function(t,e){try{var n=this.keys.buildSplitKey(t),r=localStorage.getItem(n),o=r?JSON.parse(r):null;return this._decrementCounts(o),localStorage.setItem(n,JSON.stringify(e)),this._incrementCounts(e),!0}catch(t){return this.log.error(l+t),!1}},i.prototype.removeSplit=function(t){try{var e=this.getSplit(t);return localStorage.removeItem(this.keys.buildSplitKey(t)),this._decrementCounts(e),!0}catch(t){return this.log.error(l+t),!1}},i.prototype.getSplit=function(t){t=localStorage.getItem(this.keys.buildSplitKey(t));return t&&JSON.parse(t)},i.prototype.setChangeNumber=function(t){if(this.cacheReadyButNeedsToFlush&&(this.clear(),this.cacheReadyButNeedsToFlush=!1),this.updateNewFilter){this.log.info(l+"Split filter query was modified. Updating cache.");var e=this.keys.buildSplitsFilterQueryKey(),n=this.splitFiltersValidation.queryString;try{n?localStorage.setItem(e,n):localStorage.removeItem(e)}catch(t){this.log.error(l+t)}this.updateNewFilter=!1}try{return localStorage.setItem(this.keys.buildSplitsTillKey(),t+""),localStorage.setItem(this.keys.buildLastUpdatedKey(),Date.now()+""),this.hasSync=!0}catch(t){return this.log.error(l+t),!1}},i.prototype.getChangeNumber=function(){var t=localStorage.getItem(this.keys.buildSplitsTillKey());return null===t||(t=parseInt(t,10),Object(F.i)(t))?-1:t},i.prototype.getSplitNames=function(){for(var t=localStorage.length,e=[],n=0;n<t;){var r=localStorage.key(n);null!=r&&this.keys.isSplitKey(r)&&e.push(this.keys.extractKey(r)),n++}return e},i.prototype.trafficTypeExists=function(t){t=Object(F.o)(localStorage.getItem(this.keys.buildTrafficTypeKey(t)));return Object(F.h)(t)&&0<t},i.prototype.usesSegments=function(){var t;return!this.hasSync||(t=null===(t=localStorage.getItem(this.keys.buildSplitsWithSegmentCountKey()))?0:Object(F.o)(t),!Object(F.h)(t))||0<t},i.prototype.checkCache=function(){return-1<this.getChangeNumber()||this.cacheReadyButNeedsToFlush},i.prototype._checkExpiration=function(t){var e=localStorage.getItem(this.keys.buildLastUpdatedKey());null!==e&&(e=parseInt(e,10),!Object(F.i)(e))&&t&&e<t&&this.clear()},i.prototype._checkFilterQuery=function(){var t=this,e=this.splitFiltersValidation,n=e.queryString,r=e.groupedFilters,e=this.keys.buildSplitsFilterQueryKey();if(localStorage.getItem(e)!==n)try{this.updateNewFilter=!0,this.checkCache()&&(localStorage.setItem(this.keys.buildSplitsTillKey(),"-1"),this.getSplitNames().forEach(function(e){n&&(-1<r.byName.indexOf(e)||r.byPrefix.some(function(t){return e.startsWith(t+"__")}))?t.cacheReadyButNeedsToFlush=!0:t.removeSplit(e)}))}catch(t){this.log.error(l+t)}},i);function i(t,e,n,r){void 0===r&&(r={queryString:null,groupedFilters:{byName:[],byPrefix:[]},validFilters:[]});var o=hn.call(this)||this;return o.log=t,o.cacheReadyButNeedsToFlush=!1,o.keys=e,o.splitFiltersValidation=r,o._checkExpiration(n),o._checkFilterQuery(),o}mn.prototype.registerSegments=function(t){return!1},mn.prototype.setChangeNumber=function(t,e){return!0},mn.prototype.getChangeNumber=function(t){return-1},mn.prototype.resetSegments=function(t){return!0};var yn=mn;function mn(){}gn=yn,Object(un.a)(a,gn),a.prototype.clear=function(){this.log.info(l+"Flushing MySegments data from localStorage"),this.resetSegments([])},a.prototype.addToSegment=function(t){t=this.keys.buildSegmentNameKey(t);try{return localStorage.setItem(t,"1"),!0}catch(t){return this.log.error(l+t),!1}},a.prototype.removeFromSegment=function(t){t=this.keys.buildSegmentNameKey(t);try{return localStorage.removeItem(t),!0}catch(t){return this.log.error(l+t),!1}},a.prototype.isInSegment=function(t){return"1"===localStorage.getItem(this.keys.buildSegmentNameKey(t))},a.prototype.resetSegments=function(o){var t,i=this,e=!1,n=Object.keys(localStorage).reduce(function(t,e){var n=i.keys.extractSegmentName(e);if(n)t.push(n);else if(n=i.keys.extractOldSegmentKey(e)){var r=i.keys.buildSegmentNameKey(n);try{!localStorage.getItem(r)&&-1<o.indexOf(n)&&(localStorage.setItem(r,"1"),t.push(n)),localStorage.removeItem(e)}catch(t){i.log.error(t)}}return t},[]);if(0!==o.length||n.length!==o.length)if(n.length!==o.length)e=!0,n.forEach(function(t){return i.removeFromSegment(t)}),o.forEach(function(t){return i.addToSegment(t)});else{for(t=0;t<o.length&&-1!==n.indexOf(o[t]);t++);t<o.length&&(e=!0,n.forEach(function(t){return i.removeFromSegment(t)}),o.forEach(function(t){return i.addToSegment(t)}))}return e},a.prototype.getRegisteredSegments=function(){var n=this;return Object.keys(localStorage).reduce(function(t,e){e=n.keys.extractSegmentName(e);return e&&t.push(e),t},[])},a.prototype.getKeysCount=function(){return 1};var gn,vn=a;function a(t,e){var n=gn.call(this)||this;return n.log=t,n.keys=e,n}bn=yn,Object(un.a)(s,bn),s.prototype.clear=function(){this.segmentCache={}},s.prototype.addToSegment=function(t){return this.segmentCache[t]=!0},s.prototype.removeFromSegment=function(t){return delete this.segmentCache[t],!0},s.prototype.isInSegment=function(t){return!0===this.segmentCache[t]},s.prototype.resetSegments=function(t){var e,n=this,r=!1,o=Object.keys(this.segmentCache);if(0!==t.length||o.length!==t.length)if(o.length!==t.length)r=!0,this.segmentCache={},t.forEach(function(t){n.addToSegment(t)});else{for(e=0;e<t.length&&this.isInSegment(t[e]);e++);e<t.length&&(r=!0,this.segmentCache={},t.forEach(function(t){n.addToSegment(t)}))}return r},s.prototype.getRegisteredSegments=function(){return Object.keys(this.segmentCache)},s.prototype.getKeysCount=function(){return 1};var bn,Sn=s;function s(){var t=null!==bn&&bn.apply(this,arguments)||this;return t.segmentCache={},t}On=e,Object(un.a)(b,On),b.prototype.clear=function(){this.splitsCache={},this.ttCache={},this.changeNumber=-1,this.splitsWithSegmentsCount=0},b.prototype.addSplit=function(t,e){var n,r=this.getSplit(t);return r&&(r.trafficTypeName&&(n=r.trafficTypeName,this.ttCache[n]--,this.ttCache[n]||delete this.ttCache[n]),pn(r))&&this.splitsWithSegmentsCount--,!!e&&((n=(this.splitsCache[t]=e).trafficTypeName)&&(this.ttCache[n]||(this.ttCache[n]=0),this.ttCache[n]++),pn(e)&&this.splitsWithSegmentsCount++,!0)},b.prototype.removeSplit=function(t){var e=this.getSplit(t);return!!e&&(delete this.splitsCache[t],(t=e.trafficTypeName)&&(this.ttCache[t]--,this.ttCache[t]||delete this.ttCache[t]),pn(e)&&this.splitsWithSegmentsCount--,!0)},b.prototype.getSplit=function(t){return this.splitsCache[t]||null},b.prototype.setChangeNumber=function(t){return this.changeNumber=t,!0},b.prototype.getChangeNumber=function(){return this.changeNumber},b.prototype.getSplitNames=function(){return Object.keys(this.splitsCache)},b.prototype.trafficTypeExists=function(t){return Object(F.h)(this.ttCache[t])&&0<this.ttCache[t]},b.prototype.usesSegments=function(){return-1===this.getChangeNumber()||0<this.splitsWithSegmentsCount};var On,wn=b;function b(){var t=null!==On&&On.apply(this,arguments)||this;return t.splitsCache={},t.ttCache={},t.changeNumber=-1,t.splitsWithSegmentsCount=0,t}var _n="GOOGLE_ANALYTICS_TO_SPLIT",jn="SPLIT_TO_GOOGLE_ANALYTICS";function Tn(t){t=Math.min(22,Math.max(0,Math.ceil(Math.log(t)/Math.log(1.5))));return Object(F.i)(t)?0:t}function En(){return[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}var kn=.001;function An(t){t=t.settings;return t.mode!==$&&(void 0===t.core.key||Math.random()<=kn)}S.prototype.isEmpty=function(){return this.e},S.prototype.clear=function(){},S.prototype.pop=function(){return this.e=!0,{lS:this.getLastSynchronization(),mL:this.popLatencies(),mE:this.popExceptions(),hE:this.popHttpErrors(),hL:this.popHttpLatencies(),tR:this.popTokenRefreshes(),aR:this.popAuthRejections(),iQ:this.getImpressionStats(0),iDe:this.getImpressionStats(2),iDr:this.getImpressionStats(1),spC:this.splits&&this.splits.getSplitNames().length,seC:this.segments&&this.segments.getRegisteredSegments().length,skC:this.segments&&this.segments.getKeysCount(),sL:this.getSessionLength(),eQ:this.getEventStats(0),eD:this.getEventStats(1),sE:this.popStreamingEvents(),t:this.popTags()}},S.prototype.getTimeUntilReady=function(){return this.timeUntilReady},S.prototype.recordTimeUntilReady=function(t){this.timeUntilReady=t},S.prototype.getTimeUntilReadyFromCache=function(){return this.timeUntilReadyFromCache},S.prototype.recordTimeUntilReadyFromCache=function(t){this.timeUntilReadyFromCache=t},S.prototype.getNonReadyUsage=function(){return this.notReadyUsage},S.prototype.recordNonReadyUsage=function(){this.notReadyUsage++},S.prototype.getImpressionStats=function(t){return this.impressionStats[t]},S.prototype.recordImpressionStats=function(t,e){this.impressionStats[t]+=e,this.e=!1},S.prototype.getEventStats=function(t){return this.eventStats[t]},S.prototype.recordEventStats=function(t,e){this.eventStats[t]+=e,this.e=!1},S.prototype.getLastSynchronization=function(){return this.lastSync},S.prototype.recordSuccessfulSync=function(t,e){this.lastSync[t]=e,this.e=!1},S.prototype.popHttpErrors=function(){var t=this.httpErrors;return this.httpErrors={},t},S.prototype.recordHttpError=function(t,e){t=this.httpErrors[t]=this.httpErrors[t]||{};t[e]=(t[e]||0)+1,this.e=!1},S.prototype.popHttpLatencies=function(){var t=this.httpLatencies;return this.httpLatencies={},t},S.prototype.recordHttpLatency=function(t,e){(this.httpLatencies[t]=this.httpLatencies[t]||En())[Tn(e)]++,this.e=!1},S.prototype.popAuthRejections=function(){var t=this.authRejections;return this.authRejections=0,t},S.prototype.recordAuthRejections=function(){this.authRejections++,this.e=!1},S.prototype.popTokenRefreshes=function(){var t=this.tokenRefreshes;return this.tokenRefreshes=0,t},S.prototype.recordTokenRefreshes=function(){this.tokenRefreshes++,this.e=!1},S.prototype.popStreamingEvents=function(){return this.streamingEvents.splice(0)},S.prototype.recordStreamingEvents=function(t){this.streamingEvents.length<20&&this.streamingEvents.push(t),this.e=!1},S.prototype.popTags=function(){return this.tags.splice(0)},S.prototype.addTag=function(t){this.tags.length<10&&this.tags.push(t),this.e=!1},S.prototype.getSessionLength=function(){return this.sessionLength},S.prototype.recordSessionLength=function(t){this.sessionLength=t,this.e=!1},S.prototype.popExceptions=function(){var t=this.exceptions;return this.exceptions={},t},S.prototype.recordException=function(t){this.exceptions[t]=(this.exceptions[t]||0)+1,this.e=!1},S.prototype.popLatencies=function(){var t=this.latencies;return this.latencies={},t},S.prototype.recordLatency=function(t,e){(this.latencies[t]=this.latencies[t]||En())[Tn(e)]++,this.e=!1};var Cn=S;function S(t,e){this.splits=t,this.segments=e,this.e=!0,this.notReadyUsage=0,this.impressionStats=[0,0,0],this.eventStats=[0,0],this.lastSync={},this.httpErrors={},this.httpLatencies={},this.authRejections=0,this.tokenRefreshes=0,this.streamingEvents=[],this.tags=[],this.exceptions={},this.latencies={}}In.prototype.setOnFullQueueCb=function(t){this.onFullQueue=t},In.prototype.track=function(t,e){this.uniqueKeysTracker[t]||(this.uniqueKeysTracker[t]=new ze);t=this.uniqueKeysTracker[t];t.has(e)||(t.add(e),this.uniqueTrackerSize++),this.uniqueTrackerSize>=this.maxStorage&&this.onFullQueue&&this.onFullQueue()},In.prototype.clear=function(){this.uniqueTrackerSize=0,this.uniqueKeysTracker={}},In.prototype.pop=function(){var t=this.uniqueKeysTracker;return this.clear(),this.fromUniqueKeysCollector(t)},In.prototype.isEmpty=function(){return 0===Object.keys(this.uniqueKeysTracker).length},In.prototype.fromUniqueKeysCollector=function(t){for(var e=[],n=Object.keys(t),r=0;r<n.length;r++){var o=n[r],i=qe(t[o]);e.push({k:o,fs:i})}return{keys:e}};var xn=In;function In(t){void 0===t&&(t=3e4),this.uniqueTrackerSize=0,this.uniqueKeysTracker={},this.maxStorage=t}function Rn(t){var e=t.settings,n=e.scheduler,r=n.impressionsQueueSize,n=n.eventsQueueSize,e=e.sync.impressionsMode,o=new wn,i=new Sn,r={splits:o,segments:i,impressions:new Xe(r),impressionCounts:e!==d?new en:void 0,events:new rn(n),telemetry:An(t)?new Cn(o,i):void 0,uniqueKeys:e===V?new xn:void 0,destroy:function(){this.splits.clear(),this.segments.clear(),this.impressions.clear(),this.impressionCounts&&this.impressionCounts.clear(),this.events.clear(),this.uniqueKeys&&this.uniqueKeys.clear()},shared:function(){return{splits:this.splits,segments:new Sn,impressions:this.impressions,impressionCounts:this.impressionCounts,events:this.events,telemetry:this.telemetry,destroy:function(){this.splits=new wn,this.segments.clear()}}}};return t.settings.mode===$&&(r.impressions.track=n=function(){return!0},r.events.track=n,r.impressionCounts&&(r.impressionCounts.track=n),r.uniqueKeys)&&(r.uniqueKeys.track=n),r}function Y(t){return null!=t&&"function"==typeof t.then}function Pn(t,e,n){return!e.isDestroyed()||(t.error(z.I,[n]),!1)}function Nn(t,e,n){if(e.isReady()||e.isReadyFromCache())return 1;t.warn(z.c,[n])}Rn.type=et;var Ln="definition not found",Dn="exception",Mn="not in split";function Fn(t,e,n,r,o){if(!e.isReady()||r!==Ln&&null!=r)return 1;t.warn(z.wc,[o,n])}function Kn(t){return t?{name:t.name,trafficType:t.trafficTypeName,killed:t.killed,changeNumber:t.changeNumber||0,treatments:(e=(e=t).conditions,(n=(n=Object(F.b)(e,function(t){return"ROLLOUT"===t.conditionType}))||e[0])?n.partitions.map(function(t){return t.treatment}):[]),configs:t.configurations||{}}:null;var e,n}function Un(t){var e=[];return t.forEach(function(t){t=Kn(t);t&&e.push(t)}),e}function Bn(n,r,t){var o=t.readinessManager,t=t.sdkStatus,i="split";return Object(q.a)(Object.create(t),{split:function(t){var e=At(n,t,i);return Pn(n,o,i)&&Nn(n,o,i)&&e?Y(t=r.getSplit(e))?t.catch(function(){return null}).then(function(t){return Fn(n,o,e,t,i),Kn(t)}):(Fn(n,o,e,t,i),Kn(t)):null},splits:function(){var t;return Pn(n,o,"splits")&&Nn(n,o,"splits")?Y(t=r.getAll())?t.catch(function(){return[]}).then(Un):Un(t):[]},names:function(){var t;return Pn(n,o,"names")&&Nn(n,o,"names")?Y(t=r.getSplitNames())?t.catch(function(){return[]}):t:[]}})}zn.prototype.setAttribute=function(t,e){return this.attributesCache[t]=e,!0},zn.prototype.getAttribute=function(t){return this.attributesCache[t]},zn.prototype.setAttributes=function(t){return this.attributesCache=Object(q.a)(this.attributesCache,t),!0},zn.prototype.getAll=function(){return this.attributesCache},zn.prototype.removeAttribute=function(t){return 0<=Object.keys(this.attributesCache).indexOf(t)&&(delete this.attributesCache[t],!0)},zn.prototype.clear=function(){return this.attributesCache={},!0};var qn=zn;function zn(){this.attributesCache={}}function Wn(t,e,n){return null==e||Object(F.j)(e)?e:(t.error(z.ab,[n,"attributes"]),!1)}function Vn(e,n,r){var o;if(Wn(e,n,r))return o=!0,Object.keys(n).forEach(function(t){!function(t,e,n,r){if(Object(F.k)(e)&&0!==e.length){var o=Object(F.k)(n),i=Object(F.h)(n),a=Object(F.g)(n),n=Array.isArray(n);if(o||i||a||n)return 1;t.warn(r+": you passed an invalid attribute value for "+e+". Acceptable types are: string, number, boolean and array of strings.")}else t.warn(r+": you passed an invalid attribute name, attribute name must be a non-empty string.")}(e,t,n[t],r)&&(o=!1)}),o}function Hn(r,t){var o=new qn,i=t.getTreatment,a=t.getTreatmentWithConfig,s=t.getTreatments,u=t.getTreatmentsWithConfig,c=t.track;function l(t){var e=o.getAll();return 0<Object.keys(e).length?Object(q.a)({},e,t):t}return Object(q.a)(t,{getTreatment:function(t,e,n){return i(t,e,l(n))},getTreatmentWithConfig:function(t,e,n){return a(t,e,l(n))},getTreatments:function(t,e,n){return s(t,e,l(n))},getTreatmentsWithConfig:function(t,e,n){return u(t,e,l(n))},track:function(t,e,n,r,o){return c(t,e,n,r,o)},setAttribute:function(t,e){var n={};return n[t]=e,!!Vn(r,n,"setAttribute")&&(r.debug("stored "+e+" for attribute "+t),o.setAttribute(t,e))},getAttribute:function(t){return r.debug("retrieved attribute "+t),o.getAttribute(t+"")},setAttributes:function(t){return!!Vn(r,t,"setAttributes")&&o.setAttributes(t)},getAttributes:function(){return o.getAll()},removeAttribute:function(t){return r.debug("removed attribute "+t),o.removeAttribute(t+"")},clearAttributes:function(){return o.clear()}})}function Gn(t,e,n,r){t=Hn(t,e);return Object(q.a)(t,{getTreatment:t.getTreatment.bind(t,n),getTreatmentWithConfig:t.getTreatmentWithConfig.bind(t,n),getTreatments:t.getTreatments.bind(t,n),getTreatmentsWithConfig:t.getTreatmentsWithConfig.bind(t,n),track:r?t.track.bind(t,n,r):t.track.bind(t,n),isClientSide:!0})}var O={UNDEFINED:0,ALL_KEYS:1,IN_SEGMENT:2,WHITELIST:3,EQUAL_TO:4,GREATER_THAN_OR_EQUAL_TO:5,LESS_THAN_OR_EQUAL_TO:6,BETWEEN:7,EQUAL_TO_SET:8,CONTAINS_ANY_OF_SET:9,CONTAINS_ALL_OF_SET:10,PART_OF_SET:11,ENDS_WITH:12,STARTS_WITH:13,CONTAINS_STRING:14,IN_SPLIT_TREATMENT:15,EQUAL_TO_BOOLEAN:16,MATCHES_STRING:17},w={BOOLEAN:"BOOLEAN",STRING:"STRING",NUMBER:"NUMBER",SET:"SET",DATETIME:"DATETIME",NOT_SPECIFIED:"NOT_SPECIFIED"};function Qn(t){return t.whitelist}function Yn(t){return t.value}function Jn(t){return new Date(t).setUTCHours(0,0,0,0)}function $n(t){return new Date(t).setUTCSeconds(0,0)}function Xn(t){t=t.map(function(t){var e=t.matcherType,n=t.negate,r=t.keySelector,o=t.userDefinedSegmentMatcherData,i=t.whitelistMatcherData,a=t.unaryNumericMatcherData,s=t.betweenMatcherData,u=t.dependencyMatcherData,c=t.booleanMatcherData,t=t.stringMatcherData,r=r&&r.attribute,e=O[e]||O.UNDEFINED,l=w.STRING,f=void 0;return e===O.IN_SEGMENT?f=(o=o)?o.segmentName:void 0:e===O.WHITELIST?f=new ze(i.whitelist):e===O.EQUAL_TO?(f=Yn(a),l=w.NUMBER,"DATETIME"===a.dataType&&(f=Jn(f),l=w.DATETIME)):e===O.GREATER_THAN_OR_EQUAL_TO||e===O.LESS_THAN_OR_EQUAL_TO?(f=Yn(a),l=w.NUMBER,"DATETIME"===a.dataType&&(f=$n(f),l=w.DATETIME)):e===O.BETWEEN?(l=w.NUMBER,"DATETIME"===(f=s).dataType&&(f.start=$n(f.start),f.end=$n(f.end),l=w.DATETIME)):e===O.EQUAL_TO_SET||e===O.CONTAINS_ANY_OF_SET||e===O.CONTAINS_ALL_OF_SET||e===O.PART_OF_SET?(f=Qn(i),l=w.SET):e===O.STARTS_WITH||e===O.ENDS_WITH||e===O.CONTAINS_STRING?f=Qn(i):e===O.IN_SPLIT_TREATMENT?(f=u,l=w.NOT_SPECIFIED):e===O.EQUAL_TO_BOOLEAN?(l=w.BOOLEAN,f=c):e===O.MATCHES_STRING&&(f=t),{attribute:r,negate:n,type:e,value:f,dataType:l}});return-1===Object(F.c)(t,function(t){return t.type===O.UNDEFINED})?t:[]}tr.parse=function(t){t=t.reduce(function(t,e){var n=e.size,e=e.treatment;return t.ranges.push(t.inc+=n),t.treatments.push(e),t},{inc:0,ranges:[],treatments:[]});return new tr(t.ranges,t.treatments)},tr.prototype.getTreatmentFor=function(e){if(e<0||100<e)throw new RangeError("Please provide a value between 0 and 100");var t=Object(F.c)(this._ranges,function(t){return e<=t});return this._treatments[t]};var Zn=tr;function tr(t,e){if(100!==t[t.length-1])throw new RangeError("Provided invalid dataset as input");this._ranges=t,this._treatments=e}var er=[void 0,function(e){return function(t){return e.debug(z.k),null!=t}},function(r,o,t){return function(e){var n=t.segments.isInSegment(o,e);return Y(n)?n.then(function(t){return r.debug(z.y,[o,e,n]),t}):r.debug(z.y,[o,e,n]),n}},function(n,r){return function(t){var e=r.has(t);return n.debug(z.C,[t,qe(r).join(","),e]),e}},function(n,r){return function(t){var e=t===r;return n.debug(z.t,[t,r,e]),e}},function(n,r){return function(t){var e=r<=t;return n.debug(z.v,[t,r,e]),e}},function(n,r){return function(t){var e=t<=r;return n.debug(z.w,[t,r,e]),e}},function(n,r){return function(t){var e=t>=r.start&&t<=r.end;return n.debug(z.l,[t,r.start,r.end,e]),e}},function(r,o){return function(n){for(var t=n.length===o.length,e=0;e<n.length&&t;e++)!function(e){Object(F.c)(o,function(t){return t===n[e]})<0&&(t=!1)}(e);return r.debug(z.u,[n,o,t]),t}},function(r,o){return function(t){for(var n=!1,e=0;e<o.length&&!n;e++)!function(e){0<=Object(F.c)(t,function(t){return t===o[e]})&&(n=!0)}(e);return r.debug(z.o,[t,o,n]),n}},function(r,o){return function(t){var n=!0;if(t.length<o.length)n=!1;else for(var e=0;e<o.length&&n;e++)!function(e){Object(F.c)(t,function(t){return t===o[e]})<0&&(n=!1)}(e);return r.debug(z.n,[t,o,n]),n}},function(r,o){return function(n){for(var t=n.length<=o.length,e=0;e<n.length&&t;e++)!function(e){Object(F.c)(o,function(t){return t===n[e]})<0&&(t=!1)}(e);return r.debug(z.x,[n,o,t]),t}},function(n,r){return function(e){var t=r.some(function(t){return Object(F.a)(e,t)});return n.debug(z.s,[e,r,t]),t}},function(n,r){return function(e){var t=r.some(function(t){return Object(F.m)(e,t)});return n.debug(z.z,[e,r,t]),t}},function(n,r){return function(e){var t=r.some(function(t){return Object(F.k)(e)&&-1<e.indexOf(t)});return n.debug(z.p,[e,r,t]),t}},function(o,t,r){var i=t.split,a=t.treatments;function s(t,e,n){var r=!1;return Array.isArray(e)&&(r=-1!==e.indexOf(t.treatment)),o.debug(z.q,[n,t.treatment,t.label,n,e,r]),r}return function(t,e){var n=t.key,t=t.attributes,e=(o.debug(z.r,[i,JSON.stringify(n),t?"\n attributes: "+JSON.stringify(t):""]),e(o,n,i,t,r));return Y(e)?e.then(function(t){return s(t,a,i)}):s(e,a,i)}},function(n,r){return function(t){var e=r===t;return n.debug(z.m,[r,t]),e}},function(n,r){return function(t){try{e=new RegExp(r)}catch(t){return n.debug(z.B,[r]),!1}var e=e.test(t);return n.debug(z.A,[t,r,e?"yes":"no"]),e}}];function nr(t,e){return{key:t,attributes:e}}function rr(t,e,n,r,o){var i,a,s,e=function(t,e){switch(t){case O.EQUAL_TO:return"DATETIME"===e?Jn:void 0;case O.GREATER_THAN_OR_EQUAL_TO:case O.LESS_THAN_OR_EQUAL_TO:case O.BETWEEN:return"DATETIME"===e?$n:void 0;case O.IN_SPLIT_TREATMENT:return nr;default:return}}(e,r);switch(r){case w.NUMBER:case w.DATETIME:s=n,s=Object(F.o)(s),i=isNaN(s)?void 0:s;break;case w.STRING:a=s=n,Object(F.j)(s)&&(a=s.matchingKey||void 0),i=(s=Object(F.p)(a))||void 0;break;case w.SET:a=n,i=(a=Array.isArray(a)?Object(F.q)(a.map(function(t){return t+""})):[]).length?a:void 0;break;case w.BOOLEAN:i=function(t){if(!0===t||!1===t)return t;if("string"==typeof t){t=t.toLocaleLowerCase();if("true"===t)return!0;if("false"===t)return!1}}(n);break;case w.NOT_SPECIFIED:i=n;break;default:i=void 0}return e&&(i=e(i,o)),t.debug(z.D,[n,r,i instanceof Object?JSON.stringify(i):i]),i}function or(t,e,n,r){var o,i,a=n.attribute,s=(u=t,e=e,s=r,i=void 0,(o=a)?s?(i=s[o],u.debug(z.E,[o,i])):u.warn(z.G,[o]):i=e,i),u=rr(t,n.type,s,n.dataType,r);if(void 0!==u)return u;t.warn(z.F,[s+(a?" for attribute "+a:"")])}function ir(t,e,n,r,o,i){if(e)return e=t,t=o,r=Ee(o=n,n=r),t=t.getTreatmentFor(r),e.debug(z.g,[r,o,n,t]),{treatment:t,label:i}}function ar(s,u,c,l,f){return function(e,n,t,r,o,i){var a;return"ROLLOUT"===f&&(t=t,a=e.bucketingKey,r=r,t<100)&&t<Ee(a,r)?{treatment:void 0,label:Mn}:Y(t=u(e,o,i))?t.then(function(t){return ir(s,t,e.bucketingKey,n,c,l)}):ir(s,t,e.bucketingKey,n,c,l)}}function sr(o,s){function u(t){for(var e=t.length,n=0;n<e;n++){var r=t[n];if(void 0!==r)return o.debug(z.i,[r.treatment]),r}o.debug(z.j)}return!Array.isArray(s)||Array.isArray(s)&&0===s.length?function(){return o.error(z.M),{treatment:f,label:Dn}}:function(e,n,r,o,i,a){var t=s.map(function(t){return t(e,n,r,o,i,a)});return-1!==Object(F.c)(t,Y)?Promise.all(t).then(u):u(t)}}function ur(s,t,u){for(var e=[],n=0;n<t.length;n++){var r=t[n],o=r.matcherGroup,i=r.partitions,a=r.label,r=r.conditionType,o=Xn(o.matchers).map(function(r){t=s,n=u,i=(e=r).type,e=r.value;var t,e,n,o,i,a=o=er[i]?er[i](t,e,n):o;return function(t,e,n){t=or(s,t,r,e),e=!(void 0===t||!a)&&a(t,n);return Y(e)?e.then(function(t){return Boolean(t^r.negate)}):Boolean(e^r.negate)}});if(0===o.length){e=[];break}e.push(ar(s,function(e,r){function o(t){t=t.every(function(t){return t});return e.debug(z.h,[t]),t}return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=r.map(function(t){return t.apply(void 0,e)});return-1!==Object(F.c)(n,Y)?Promise.all(n).then(o):o(n)}}(s,o),Zn.parse(i),a,r))}return sr(s,e)}function cr(t,e){return{treatment:Object(F.e)(t,"treatment",e),label:Object(F.e)(t,"label","default rule")}}fr.parse=function(t,e,n){return new fr(e,ur(t,e.conditions,n))},fr.prototype.getKey=function(){return this.baseInfo.name},fr.prototype.getTreatment=function(t,e,n){var r,o,i,a=this.baseInfo,s=a.killed,u=a.seed,c=a.defaultTreatment,l=a.trafficAllocation,a=a.trafficAllocationSeed;try{r=Ne(t)}catch(t){return{treatment:f,label:Dn}}if(this.isGarbage())o=f,i="archived";else{if(!s)return Y(t=this.evaluator(r,u,l,a,e,n))?t.then(function(t){return cr(t,c)}):cr(t,c);o=c,i="killed"}return{treatment:o,label:i}},fr.prototype.isGarbage=function(){return"ARCHIVED"===this.baseInfo.status},fr.prototype.getChangeNumber=function(){return this.baseInfo.changeNumber};var lr=fr;function fr(t,e){this.baseInfo=t,this.evaluator=e,"string"!=typeof this.baseInfo.defaultTreatment&&(this.baseInfo.defaultTreatment=f)}var pr={treatment:f,label:Dn,config:null};function hr(t){var e={};return t.forEach(function(t){e[t]=pr}),e}function dr(e,n,t,r,o){var i;try{i=o.splits.getSplit(t)}catch(t){return pr}return Y(i)?i.then(function(t){return yr(e,t,n,r,o)}).catch(function(){return pr}):yr(e,i,n,r,o)}function yr(t,e,n,r,o){var i={treatment:f,label:Ln,config:null};if(e){var a=lr.parse(t,e,o);if(Y(i=a.getTreatment(n,r,dr)))return i.then(function(t){return t.changeNumber=a.getChangeNumber(),t.config=e.configurations&&e.configurations[t.treatment]||null,t});i.changeNumber=a.getChangeNumber(),i.config=e.configurations&&e.configurations[i.treatment]||null}return i}function mr(n,t,r,o,i,a){var s={},u=[];return t.forEach(function(e){var t=yr(n,r[e],o,i,a);Y(t)?u.push(t.then(function(t){s[e]=t})):s[e]=t}),0<u.length?Promise.all(u).then(function(){return s}):s}function gr(t,e,n){t.warn(z.xc,[n,e])}function vr(t){return-1===[Z,tt].indexOf(t.mode)}var br={treatment:f,label:"not ready"};function Sr(t){var e={};return t.forEach(function(t){e[t]=br}),e}function Or(t){var f=t.sdkReadinessManager.readinessManager,l=t.storage,u=t.settings,c=t.impressionsTracker,p=t.eventTracker,h=t.telemetryTracker,d=u.log,y=u.mode;function r(n,r,o,i){void 0===i&&(i=!1);function t(t){var e=[],t=m(t,r,n,0,i,"getTreatment"+(i?"withConfig":""),e);return c.track(e,o),a(e[0]&&e[0].label),t}var a=h.trackEval(i?"tc":"t"),e=f.isReady()||f.isReadyFromCache()?dr(d,n,r,o,l):vr(u)?br:Promise.resolve(br);return Y(e)?e.then(t):t(e)}function o(o,t,i,a){void 0===a&&(a=!1);function e(e){var n=[],r={};return Object.keys(e).forEach(function(t){r[t]=m(e[t],t,o,0,a,"getTreatments"+(a?"withConfig":""),n)}),c.track(n,i),s(n[0]&&n[0].label),r}var s=h.trackEval(a?"tcs":"ts"),t=f.isReady()||f.isReadyFromCache()?function(e,n,r,o,i){var t;try{t=i.splits.getSplits(r)}catch(t){return hr(r)}return Y(t)?t.then(function(t){return mr(e,r,t,n,o,i)}).catch(function(){return hr(r)}):mr(e,r,t,n,o,i)}(d,o,t,i,l):vr(u)?Sr(t):Promise.resolve(Sr(t));return Y(t)?t.then(e):e(t)}function m(t,e,n,r,o,i,a){var s=Pe(n),n=(n=n,Object(F.j)(n)?n.bucketingKey:void 0),u=t.treatment,c=t.label,l=t.changeNumber,t=t.config,t=void 0===t?null:t;return d.info(z.jb,[e,s,u,c]),Fn(d,f,e,c,i)&&(d.info(z.lb),a.push({feature:e,keyName:s,treatment:u,time:Date.now(),bucketingKey:n,label:c,changeNumber:l})),o?{treatment:u,config:t}:u}return{getTreatment:r,getTreatmentWithConfig:function(t,e,n){return r(t,e,n,!0)},getTreatments:o,getTreatmentsWithConfig:function(t,e,n){return o(t,e,n,!0)},track:function(t,e,n,r,o,i){void 0===i&&(i=1024);var a,s,u,c=h.trackEval("tr"),t=Pe(t),n={eventTypeId:n,trafficTypeName:e,value:r,timestamp:Date.now(),key:t,properties:o},e=(a=d,r=f,t=l.splits,o=y,s=e,u="track",r.isReady()&&o!==$&&(Y(r=t.trafficTypeExists(s))?r.then(function(t){return t||gr(a,s,u),t}):r||gr(a,s,u)),p.track(n,i));return Y(e)?e.then(function(t){return c(),t}):(c(),e)},isClientSide:!1}}var wr=/^[a-zA-Z0-9][-_.:a-zA-Z0-9]{0,79}$/,_r="event_type";function jr(t,e,n){if(null==e)t.error(z.bb,[n,_r]);else if(Object(F.k)(e))if(0===e.length)t.error(z.K,[n,_r]);else{if(wr.test(e))return e;t.error(z.O,[n,e])}else t.error(z.S,[n,_r]);return!1}function Tr(t,e,n){return Object(F.h)(e)||null==e?e:(t.error(z.Z,[n]),!1)}var Er=0,kr=2,Ar=4,Cr=8;function xr(t,e,n){if(null==e)return{properties:null,size:1024};if(!Object(F.j)(e))return t.error(z.ab,[n,"properties"]),{properties:!1,size:1024};var r=Object.keys(e),o=Object(q.a)({},e),i={properties:o,size:1024};300<r.length&&t.warn(z.Dc,[n]);for(var a=0;a<r.length;a++){i.size+=r[a].length*kr;var s=o[r[a]],u=Object(F.k)(s),c=Object(F.h)(s),l=Object(F.g)(s),f=null===s;if(u||c||l||f||(f=!(s=o[r[a]]=null),t.warn(z.yc,[n,r[a]])),f?i.size+=Er:c?i.size+=Cr:l?i.size+=Ar:u&&(i.size+=s.length*kr),32768<i.size){t.error(z.cb,[n]),i.properties=!1;break}}return i}function Ir(t,a,s){var u=t.log,c=vr(t);function o(t,e,n,r){var o=Object(F.m)(r,"getTreatments"),t=Pt(u,t,r),o=(o?Ct:At)(u,e,r),e=Wn(u,n,r),n=Pn(u,s,r);return Nn(u,s,r),{valid:n&&t&&o&&!1!==e,key:t,splitOrSplits:o,attributes:e}}function i(t){return c?t:Promise.resolve(t)}return{getTreatment:function(t,e,n){return(t=o(t,e,n,"getTreatment")).valid?a.getTreatment(t.key,t.splitOrSplits,t.attributes):i(f)},getTreatmentWithConfig:function(t,e,n){return(t=o(t,e,n,"getTreatmentWithConfig")).valid?a.getTreatmentWithConfig(t.key,t.splitOrSplits,t.attributes):i(Object(q.a)({},B))},getTreatments:function(t,e,n){var r;return(t=o(t,e,n,"getTreatments")).valid?a.getTreatments(t.key,t.splitOrSplits,t.attributes):(r={},t.splitOrSplits&&t.splitOrSplits.forEach(function(t){return r[t]=f}),i(r))},getTreatmentsWithConfig:function(t,e,n){var r;return(t=o(t,e,n,"getTreatmentsWithConfig")).valid?a.getTreatmentsWithConfig(t.key,t.splitOrSplits,t.attributes):(r={},t.splitOrSplits&&t.splitOrSplits.forEach(function(t){return r[t]=Object(q.a)({},B)}),i(r))},track:function(t,e,n,r,o){var t=Pt(u,t,"track"),e=Dt(u,e,"track"),n=jr(u,n,"track"),r=Tr(u,r,"track"),i=(o=xr(u,o,"track")).properties,o=o.size;return Pn(u,s,"track")&&t&&e&&n&&!1!==r&&!1!==i?a.track(t,e,n,r,i,o):!c&&Promise.resolve(!1)}}}function Rr(t,e){var n=t.sdkReadinessManager,r=t.syncManager,o=t.storage,i=t.signalListener,a=t.settings,s=t.telemetryTracker,u=t.uniqueKeysTracker;return Object(q.a)(Object.create(n.sdkStatus),Ir(a,Or(t),n.readinessManager),{destroy:function(){return e||s.sessionLength(),r&&r.stop(),(r?r.flush():Promise.resolve()).then(function(){var t;return n.readinessManager.destroy(),i&&i.stop(),e||(t=a.core.authorizationKey,c[t]&&c[t]--,0===c[t]&&delete c[t]),u&&u.stop(),o.destroy()})}})}function Pr(t,e){return(t.matchingKey||t)+"-"+(t.bucketingKey||t)+"-"+(void 0!==e?e:"")}var Nr="Client instantiation";function Lr(a){var s=a.storage,u=a.syncManager,c=a.sdkReadinessManager,t=a.settings,e=t.core,n=e.key,e=e.trafficType,l=t.startup.readyTimeout,f=t.log,p=Gn(f,Rr(a),n,e),t=Pr(Ne(n),e),h={};return h[t]=p,function(t,e){if(void 0===t)return f.debug(z.Jb),p;var n,t=Pt(f,t,"Shared "+Nr);if(!1===t)throw new Error("Shared Client needs a valid key.");if(void 0!==e&&!1===(n=Dt(f,e,"Shared "+Nr)))throw new Error("Shared Client needs a valid traffic type or no traffic type at all.");var r,o,i,e=Pr(t,n);return h[e]?f.debug(z.Kb):(i=Pe(t),r=c.shared(l),o=s.shared&&s.shared(i,function(t){t||r.readinessManager.segments.emit(G)}),i=u&&o&&u.shared(i,r.readinessManager,o),h[e]=Gn(f,Rr(Object(q.a)({},a,{sdkReadinessManager:r,storage:o||s,syncManager:i,signalListener:void 0}),!0),t,n),i&&i.start(),f.info(z.Fb)),h[e]}}var Dr=t(11),Mr=function(t,e,n,r){this.list=r,this.value=t,e?(e.next=this).prev=e:this.prev=null,n?(n.prev=this).next=n:this.next=null},Fr=(Kr.prototype.removeNode=function(t){if(t&&t instanceof Mr){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;return e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null,e}},Kr.prototype.unshiftNode=function(t){var e;t&&t instanceof Mr&&t!==this.head&&(t.list&&t.list.removeNode(t),e=this.head,t.list=this,(t.next=e)&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++)},Kr.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)this.head=new Mr(arguments[t],null,this.head,this),this.tail||(this.tail=this.head),this.length++;return this.length},Kr);function Kr(){this.tail=null,this.head=null,this.length=0}Br.prototype.get=function(t){t=this.items.get(t);if(t&&t instanceof Mr)return this.lru.unshiftNode(t),t.value.value},Br.prototype.set=function(t,e){var n=this.items.get(t);if(n){if(!(n instanceof Mr))return!1;this.lru.unshiftNode(n),this.lru.head.value.value=e}else{if(this.lru.length===this.maxLen){n=this.lru.tail;if(!n)return!1;this.items.delete(n.value.key),this.lru.removeNode(this.lru.tail)}this.lru.unshift({key:t,value:e}),this.items.set(t,this.lru.head)}return!0};var Ur=Br;function Br(t){this.maxLen=t||1,this.items=new Dr.a,this.lru=new Fr}zr.prototype.testAndSet=function(t){var e=this.hasher(t),n=this.cache.get(e);return this.cache.set(e,t.time),n};var qr=zr;function zr(t,e){this.cache=new Ur(t),this.hasher=e}function Wr(t){return Te(t.keyName+":"+t.feature+":"+t.treatment+":"+t.label+":"+t.changeNumber)}function Vr(){return new qr(500,Wr)}var Hr="ga-to-split: ",Gr="ga-to-split:mapper";Qr={eventTypeId:{event:"eventAction",social:"socialAction"},eventValue:{event:"eventValue",timing:"timingValue"},eventProperties:{pageview:["page"],screenview:["screenName"],event:["eventCategory","eventLabel"],social:["socialNetwork","socialTarget"],timing:["timingCategory","timingVar","timingLabel"],exception:["exDescription","exFatal"]}};var Qr,Yr=function(t){var e=t.get("hitType"),n=t.get(Qr.eventTypeId[e]||"hitType"),r=t.get(Qr.eventValue[e]),o={},i=Qr.eventProperties[e];if(i)for(var a=0;a<i.length;a++){var s=t.get(i[a]);void 0!==s&&(o[i[a]]=s)}return{eventTypeId:n,value:r,properties:o,timestamp:Date.now()}};var Jr=/^[^a-zA-Z0-9]+/,$r=/[^-_.:a-zA-Z0-9]+/g;function Xr(r,t){var e,n,o,i,s=t.storage,a=t.settings,u=a.core,c=a.log,a=t.telemetryTracker,l={prefix:"ga",identities:u.key&&u.trafficType?[{key:u.key,trafficType:u.trafficType}]:void 0};e=window,t="splitTracker",u=function(t,e){var n,i,a=Object(q.a)({},l,r,e);this.tracker=t,e=a.identities,0===(e=Array.isArray(e)?Object(F.r)(e).filter(function(t){var e;return!(!t||(e=t.key,t=t.trafficType,!Object(F.k)(e)&&!Object(F.h)(e))||!Object(F.k)(t))}):[]).length?c.warn(Hr+"No valid identities were provided. Please check that you are passing a valid list of identities or providing a traffic type at the SDK configuration."):((n=e.length-a.identities.length)&&c.warn(Hr+n+" identities were discarded because they are invalid or duplicated. Identities must be an array of objects with key and trafficType."),a.identities=e,Object(F.k)(a.prefix)||(c.warn(Hr+"The provided `prefix` was ignored since it is invalid. Please check that you are passing a string object as `prefix`."),a.prefix=void 0),i=t.get("sendHitTask"),t.set("sendHitTask",function(t){if(i(t),!1!==a.hits&&!t.get("splitHit")){try{if(a.filter&&!a.filter(t))return}catch(t){return void c.warn(Hr+"custom filter threw: "+t)}var e,n,r,o=Yr(t);if(a.mapper){try{o=a.mapper(t,o)}catch(t){return void c.warn(Hr+"custom mapper threw: "+t)}if(!o)return}a.prefix&&(o.eventTypeId=a.prefix+"."+o.eventTypeId),o.eventTypeId=(t=c,e=o.eventTypeId,Object(F.k)(e)&&0!==e.length?((n=(r=e.replace(Jr,"").replace($r,"_")).slice(0,80)).length<r.length&&t.warn(Hr+"EventTypeId was truncated because it cannot be more than 80 characters long."),n):e),jr(r=c,(t=o).eventTypeId,Gr)&&!1!==Tr(r,t.value,Gr)&&!1!==xr(r,t.properties,Gr).properties&&!(t.timestamp&&!Object(F.h)(t.timestamp)||t.key&&!1===Pt(r,t.key,Gr)||t.trafficTypeName&&!1===Dt(r,t.trafficTypeName,Gr))&&(o.key&&o.trafficTypeName?s.events.track(o):a.identities.forEach(function(t){t=Object(q.a)({key:t.key,trafficTypeName:t.trafficType},o);s.events.track(t)}))}}),c.info(Hr+"integration started"))},n=c,o=!0===r.autoRequire,a=a,i=e.GoogleAnalyticsObject||"ga",e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i]("provide",t,u),t=e[i].q&&e[i].q.push!==[].push,o&&!t&&n.error(Hr+"integration is configured to autorequire the splitTracker plugin, but the necessary script does not seem to have run. Please check the docs."),a&&t&&a.addTag("integration:ga-autorequire")}var Zr="split-to-ga: ",to="`ga` command queue not found.",eo="No hit was sent.",no=(_.defaultMapper=function(t){var e=t.type,n=t.payload;switch(e){case J:return{hitType:"event",eventCategory:"split-impression",eventAction:"Evaluate "+n.impression.feature,eventLabel:"Treatment: "+n.impression.treatment+". Targeting rule: "+n.impression.label+".",nonInteraction:!0};case"EVENT":return{hitType:"event",eventCategory:"split-event",eventAction:n.eventTypeId,eventValue:n.value,nonInteraction:!0}}},_.getGa=function(){return"undefined"!=typeof window?window[window.GoogleAnalyticsObject||"ga"]:void 0},_.validateFieldsObject=function(t,e){return!(!e||!e.hitType)||(t.warn(Zr+"your custom mapper returned an invalid FieldsObject instance. It must be an object with at least a `hitType` field."),!1)},_.prototype.queue=function(t){var e,n=_.getGa();if(n){if(!(!1===this.impressions&&t.type===J||!1===this.events&&"EVENT"===t.type)){try{if(this.filter&&!this.filter(t))return;if(e=_.defaultMapper(t),this.mapper&&(!(e=this.mapper(t,e))||!_.validateFieldsObject(this.log,e)))return}catch(t){return void this.log.warn(Zr+"queue method threw: "+t+". "+eo)}this.trackerNames.forEach(function(t){t=t?t+".send":"send";e.splitHit=!0,n(t,e)})}}else this.log.warn(Zr+to+" "+eo)},_.defaultTrackerNames=[""],_);function _(t,e){this.trackerNames=_.defaultTrackerNames,this.log=t,e&&("function"==typeof e.filter&&(this.filter=e.filter),"function"==typeof e.mapper&&(this.mapper=e.mapper),Array.isArray(e.trackerNames)&&(this.trackerNames=Object(F.q)(e.trackerNames)),this.impressions=e.impressions,this.events=e.events),t.info(Zr+"integration started"),"function"!=typeof _.getGa()&&t.warn(Zr+to+" No hits will be sent until it is available.")}function ro(t,e){var t=t.map(function(t){switch(t.type){case _n:return void 0===(r=t)&&(r={}),o.type="GOOGLE_ANALYTICS_TO_SPLIT",o;case jn:return void 0===(n=t)&&(n={}),e.type="SPLIT_TO_GOOGLE_ANALYTICS",e}function e(t){return new no(t.settings.log,n)}var n,r;function o(t){return Xr(r,t)}}).filter(function(t){return t&&"function"==typeof t}),n=e,r=[];if(t.forEach(function(t){t=t(n);t&&t.queue&&r.push(t)}),0!==r.length)return{handleImpression:function(e){r.forEach(function(t){return t.queue({type:J,payload:e})})},handleEvent:function(e){r.forEach(function(t){return t.queue({type:"EVENT",payload:e})})}}}function oo(t){t=Rn(t);return t.splits.checkCache=function(){return!0},t}function io(t,a){var s=!1,u=!1;t=function r(n){var o=new Promise(function(t,e){return n.then(t,function(t){(u?e:a)(t)})}),i=o.then;return Object.defineProperty(o,"then",{value:function(t,e){var n=i.call(o,t,e);return"function"==typeof t&&(s=!0),"function"==typeof e?(u=!0,n):r(n)}}),o}(t);return t.hasOnFulfilled=function(){return s},t}function ao(e,t,n){void 0===t&&(t=0),void 0===n&&(o=e,(r=Object(q.a)(new o,{splitsArrived:!1,splitsCacheLoaded:!1})).on(H,function(t){t||(r.splitsArrived=!0)}),r.once(_t,function(){r.splitsCacheLoaded=!0}),n=r),o=e,(i=Object(q.a)(new o,{segmentsArrived:!1})).once(G,function(){i.segmentsArrived=!0});var r,o,i,a,s=i,u=new e,c=!1,l=(n.splitsCacheLoaded?c=!0:n.once(_t,function(){if(c=!0,!f)try{u.emit(Tt)}catch(t){setTimeout(function(){throw t},0)}}),!1),f=(0<t&&(a=setTimeout(function(){l=!0,u.emit(jt,"Split SDK emitted SDK_READY_TIMED_OUT event.")},t)),!1),p=(n.on(H,h),s.on(G,h),!1);function h(t){if(f)try{u.emit(Et,t)}catch(t){setTimeout(function(){throw t},0)}else if(n.splitsArrived&&s.segmentsArrived){clearTimeout(a),f=!0;try{u.emit(Q)}catch(t){setTimeout(function(){throw t},0)}}}var d=1;return{splits:n,segments:s,gate:u,shared:function(t){return d++,ao(e,t=void 0===t?0:t,n)},destroy:function(){p=!0,s.removeAllListeners(),u.removeAllListeners(),clearTimeout(a),0<d&&d--,0===d&&n.removeAllListeners()},isReady:function(){return f},hasTimedout:function(){return l},isReadyFromCache:function(){return c},isDestroyed:function(){return p},isOperational:function(){return(f||c)&&!p}}}oo.type=et;function so(u,c,l,f,p){var h=u.log,d=u.impressionListener,t=u.runtime,y=t.ip,m=t.hostname,g=u.version;return{track:function(t,n){if(u.userConsent!==rt){var e,r=t.length,t=l.process(t),o=t.impressionsToStore,i=t.impressionsToListener,t=t.deduped,a=i.length;if(0<o.length&&(Y(e=c.track(o))?e.then(function(){h.info(z.kb,[r])}).catch(function(t){h.error(z.R,[r,t])}):p&&(p.recordImpressionStats(0,o.length),p.recordImpressionStats(2,t))),d||f)for(var s=0;s<a;s++)!function(t){var e={impression:Object(q.a)({},i[t]),attributes:n,ip:y,hostname:m,sdkLanguageVersion:g};setTimeout(function(){f&&f.handleImpression(e);try{d&&d.logImpression(e)}catch(t){h.error(z.Q,[t])}},0)}(s)}}}}var uo=t(4);var co={add:function(){return!0},contains:function(){return!0},clear:function(){}};function lo(t){var r,o,e,n,i,a,s,u,c,l,f,p,h,d=t.settings,y=t.platform,m=t.storageFactory,g=t.splitApiFactory,v=t.extraProps,b=t.syncManagerFactory,S=t.SignalListener,O=t.impressionsObserverFactory,w=t.integrationsManagerFactory,D=t.sdkManagerFactory,M=t.sdkClientMethodFactory,t=t.filterAdapterFactory,_=d.log,j=d.sync.impressionsMode,T=(Ut(_,d.core.authorizationKey),function e(n,r,t,o){void 0===t&&(t=0),void 0===o&&(o=ao(r,t));var i,a=0,s=0,u=(o.gate.on("removeListener",function(t){t===Q&&s--}),o.gate.on("newListener",function(t){t!==Q&&t!==jt||(o.isReady()?n.error(z.J,[t===Q?"SDK_READY":"SDK_READY_TIMED_OUT"]):t===Q&&s++)}),i=io(new Promise(function(t,e){o.gate.once(Q,function(){n.info(z.e),s!==a||i.hasOnFulfilled()||n.warn(z.d),t()}),o.gate.once(jt,function(t){e(new Error(t))})}),c));function c(t){n.error(t&&t.message)}return o.gate.once(Tt,function(){n.info(z.f)}),{readinessManager:o,shared:function(t){return e(n,r,t=void 0===t?0:t,o.shared(t))},incInternalReadyCbCount:function(){a++},sdkStatus:Object(q.a)(Object.create(o.gate),{Event:{SDK_READY:Q,SDK_READY_FROM_CACHE:Tt,SDK_UPDATE:Et,SDK_READY_TIMED_OUT:jt},ready:function(){return o.hasTimedout()?o.isReady()?Promise.resolve():io(Promise.reject(new Error("Split SDK has emitted SDK_READY_TIMED_OUT event.")),c):u},__getStatus:function(){return{isReady:o.isReady(),isReadyFromCache:o.isReadyFromCache(),isOperational:o.isOperational(),hasTimedout:o.hasTimedout(),isDestroyed:o.isDestroyed()}}})}}(_,y.EventEmitter,d.startup.readyTimeout)),E=T.readinessManager,k=m({settings:d,onReadyCb:function(t){t||(E.splits.emit(H),E.segments.emit(G))}}),m=(r=k.telemetry,o=y.now,r&&o?(e=Bt(o),{trackEval:function(e){var n=Bt(o);return function(t){switch(t){case Dn:return void r.recordException(e);case"not ready":r.recordNonReadyUsage&&r.recordNonReadyUsage()}r.recordLatency(e,n())}},trackHttp:function(e){var n=Bt(o);return function(t){r.recordHttpLatency(e,n()),t&&t.statusCode?r.recordHttpError(e,t.statusCode):r.recordSuccessfulSync(e,Date.now())}},sessionLength:function(){r.recordSessionLength&&r.recordSessionLength(e())},streamingEvent:function(t,e){80===t?r.recordAuthRejections():(r.recordStreamingEvents({e:t,d:e,t:Date.now()}),50===t&&r.recordTokenRefreshes())},addTag:function(t){r.addTag&&r.addTag(t)}}):{trackEval:m=function(){return function(){}},trackHttp:m,sessionLength:function(){},streamingEvent:function(){},addTag:function(){}}),w=w&&w({settings:d,storage:k,telemetryTracker:m}),A=O(),C=j===V?(n=_,i=k.uniqueKeys,(a=void 0===(a=t&&t())?co:a).refreshRate&&(s=setInterval(a.clear,a.refreshRate)),{track:function(t,e){a.add(t,e)?i.track(t,e):n.debug(z.Db+"The feature "+e+" and key "+t+" exist in the filter")},stop:function(){clearInterval(s)}}):void 0;switch(j){case W:p=A,h=k.impressionCounts,u={process:function(t){var n=[];return t.forEach(function(t){t.pt=p.testAndSet(t);var e=Date.now();t.pt&&h.track(t.feature,e,1),(!t.pt||t.pt<tn(e))&&n.push(t)}),{impressionsToStore:n,impressionsToListener:t,deduped:t.length-n.length}}};break;case V:l=k.impressionCounts,f=C,u={process:function(t){return t.forEach(function(t){var e=Date.now();l.track(t.feature,e,1),f.track(t.keyName,t.feature)}),{impressionsToStore:[],impressionsToListener:t,deduped:0}}};break;default:c=A,u={process:function(t){return t.forEach(function(t){t.pt=c.testAndSet(t)}),{impressionsToStore:t,impressionsToListener:t,deduped:0}}}}var x,F,I,R,P,K,O=so(d,k.impressions,u,w,k.telemetry),t=(x=d,F=k.events,I=w,R=k.telemetry,P=x.log,K=vr(x),{track:function(t,e){return x.userConsent===rt?!K&&Promise.resolve(!1):Y(e=F.track(t,e))?e.then(U.bind(null,t)):(R&&R.recordEventStats(e?0:1,1),U(t,e))}});function U(e,t){var n='event of type "'+e.eventTypeId+'" for traffic type "'+e.trafficTypeName+'". Key: '+e.key+". Value: "+e.value+". Timestamp: "+e.timestamp+". "+(e.properties?"With properties.":"With no properties.");return t?(P.info(z.ib,[n]),I&&setTimeout(function(){var t=Object(q.a)({},e);e.properties&&(t.properties=Object(q.a)({},e.properties)),I.handleEvent(t)},0)):P.error(z.N,[n]),t}var N,j=g&&g(d,y,m),w={splitApi:j,eventTracker:t,impressionsTracker:O,telemetryTracker:m,uniqueKeysTracker:C,sdkReadinessManager:T,readiness:E,settings:d,storage:k,platform:y},g=b&&b(w),t=(w.syncManager=g,S&&new S(g,d,k,j)),O=(w.signalListener=t,M(w)),B=D(_,k.splits,T);return g&&g.start(),t&&t.start(),_.info(z.Eb),Object(q.a)({client:O,manager:function(){return _.debug(z.Lb),B},Logger:(N=_,{enable:function(){L(uo.a.DEBUG)},setLogLevel:L,disable:function(){L(uo.a.NONE)},LogLevel:uo.a}),settings:d},v&&v(w));function L(t){Object(uo.c)(t)?N.setLogLevel(t):N.error(z.W)}}var fo={GRANTED:u,DECLINED:rt,UNKNOWN:x};yn=t(62);function po(t,e,n,r){return yt(r.log,(o=t,i=n,s=(a=r).log,u=e.splits,c=!0,function(){var n=[],e=null,t={};try{t=o(a)}catch(t){s.error(z.gb,[e=t])}return!e&&t?(s.debug(z.dc,[JSON.stringify(t)]),Object(F.d)(t,function(t,e){n.push([e,{name:e,status:"ACTIVE",killed:!1,trafficAllocation:100,defaultTreatment:f,conditions:t.conditions||[],configurations:t.configurations,trafficTypeName:t.trafficTypeName}])}),Promise.all([u.clear(),u.addSplits(n)]).then(function(){return i.splits.emit(H),c&&(c=!1,Promise.resolve(u.checkCache()).then(function(t){t&&i.splits.emit(_t),i.segments.emit(G)})),!0})):Promise.resolve(!0)}),r.scheduler.offlineRefreshRate,"offlineUpdater");var o,i,a,s,u,c}function ho(){return Promise.resolve()}yo=function(){var o={emptyMock:"1"};function e(r){var t=Object.keys(r);return t.length!==Object.keys(o).length?(o=r,1):t.some(function(t){var e=!o[t],n=(n=o[t],t=r[t],typeof n!=typeof t||("string"==typeof n?n!==t:n.treatment!==t.treatment||n.config!==t.config)),t=e||n;return t&&(o=r),t})}return function(t){var o,t=t.features||{};return!!e(t)&&(o={},Object(F.d)(t,function(t,e){var n=t,r=null,t=(Object(F.j)(t)&&(n=t.treatment,r=t.config||r),{});null!==r&&(t[n]=r),o[e]={trafficTypeName:"localhost",conditions:[(e=(r={treatment:n}).treatment,r.keys?{conditionType:"WHITELIST",matcherGroup:{combiner:"AND",matchers:[{keySelector:null,matcherType:"WHITELIST",negate:!1,whitelistMatcherData:{whitelist:Object(F.k)(r.keys)?[r.keys]:r.keys}}]},partitions:[{treatment:e,size:100}],label:"whitelisted "+e}:{conditionType:"ROLLOUT",matcherGroup:{combiner:"AND",matchers:[{keySelector:null,matcherType:"ALL_KEYS",negate:!1}]},partitions:[{treatment:e,size:100}],label:"default rule"})],configurations:t}}),o)}};var yo,mo=function(t){var e=t.settings,n=t.readiness,t=t.storage;return Object(q.a)(po(yo(),t,n,e),{flush:ho,shared:function(t,e){return{start:function(){setTimeout(function(){e.segments.emit(G)},0)},stop:function(){},isRunning:function(){return!0},flush:ho}}})};mo.type="LocalhostFromObject";var go=[rt,u,x];var vo="LOCALSTORAGE";function bo(t,e){return void 0===e&&(e=[]),r=function(t){return t&&Object(F.k)(t.type)&&-1<e.indexOf(t.type)},o='Integration items must have a valid "type" value',i=(n=t).integrations,n=t.log,Array.isArray(i)&&0!==i.length?(r=i.filter(r),(i=i.length-r.length)&&n.warn(z.uc,[i,o||""]),r):[];var n,r,o,i}var So={defaults:{startup:{requestTimeoutBeforeReady:5,retriesOnFailureBeforeReady:1,readyTimeout:10,eventsFirstPushWindow:10},userConsent:u,version:"javascript-10.22.3"},acceptKey:!0,acceptTT:!0,runtime:function(){return{ip:!1,hostname:!1}},storage:function(t){function e(){n=i,i=et}var n,r=t.log,o=t.mode,i=(t=void 0===(t=t.storage)?{type:et}:t).type,a=void 0===(a=t.options)?{}:a,t=t.prefix;return o===$&&i===vo&&e(),(i!==et&&i!==vo||i===vo&&!Object(ln.a)())&&(e(),r.error("Invalid or unavailable storage. Fallbacking into MEMORY storage")),{type:i,options:a,prefix:t,__originalType:n}},integrations:function(t){return bo(t,[_n,jn])},logger:yn.a,localhost:function(){return mo},consent:function(t){var e=t.userConsent,t=t.log,e=Object(F.n)(e);return-1<go.indexOf(e)?e:(t.error(z.T,["userConsent",go,u]),u)}};var e="object"==typeof Reflect?Reflect:null,Oo=e&&"function"==typeof e.apply?e.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};var wo=e&&"function"==typeof e.ownKeys?e.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)},_o=Number.isNaN||function(t){return t!=t};function j(){j.init.call(this)}j.prototype._events=void 0,j.prototype._eventsCount=0,j.prototype._maxListeners=void 0;var jo=10;function To(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function Eo(t){return void 0===t._maxListeners?j.defaultMaxListeners:t._maxListeners}function ko(t,e,n,r){var o,i;return To(n),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener||n),o=t._events),i=o[e]),void 0===i?(i=o[e]=n,++t._eventsCount):("function"==typeof i?i=o[e]=r?[n,i]:[i,n]:r?i.unshift(n):i.push(n),0<(o=Eo(t))&&i.length>o&&!i.warned&&(i.warned=!0,(r=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",r.emitter=t,r.type=e,r.count=i.length,n=r,console)&&console.warn&&console.warn(n)),t}function Ao(t,e,n){t={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},e=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}.bind(t);return e.listener=n,t.wrapFn=e}function Co(t,e,n){t=t._events;if(void 0===t)return[];t=t[e];if(void 0===t)return[];if("function"==typeof t)return n?[t.listener||t]:[t];if(n){for(var r=t,o=new Array(r.length),i=0;i<o.length;++i)o[i]=r[i].listener||r[i];return o}return Io(t,t.length)}function xo(t){var e=this._events;if(void 0!==e){e=e[t];if("function"==typeof e)return 1;if(void 0!==e)return e.length}return 0}function Io(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}Object.defineProperty(j,"defaultMaxListeners",{enumerable:!0,get:function(){return jo},set:function(t){if("number"!=typeof t||t<0||_o(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");jo=t}}),j.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},j.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||_o(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},j.prototype.getMaxListeners=function(){return Eo(this)},j.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){if((i=0<e.length?e[0]:i)instanceof Error)throw i;r=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw r.context=i,r}var i=o[t];if(void 0===i)return!1;if("function"==typeof i)Oo(i,this,e);else for(var a=i.length,s=Io(i,a),n=0;n<a;++n)Oo(s[n],this,e);return!0},j.prototype.on=j.prototype.addListener=function(t,e){return ko(this,t,e,!1)},j.prototype.prependListener=function(t,e){return ko(this,t,e,!0)},j.prototype.once=function(t,e){return To(e),this.on(t,Ao(this,t,e)),this},j.prototype.prependOnceListener=function(t,e){return To(e),this.prependListener(t,Ao(this,t,e)),this},j.prototype.off=j.prototype.removeListener=function(t,e){var n,r,o,i,a;if(To(e),void 0!==(r=this._events)&&void 0!==(n=r[t]))if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,i=n.length-1;0<=i;i--)if(n[i]===e||n[i].listener===e){a=n[i].listener,o=i;break}if(o<0)return this;if(0===o)n.shift();else{for(var s=n,u=o;u+1<s.length;u++)s[u]=s[u+1];s.pop()}1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,a||e)}return this},j.prototype.removeAllListeners=function(t){var e,n=this._events;if(void 0!==n)if(void 0===n.removeListener)0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]);else if(0===arguments.length){for(var r,o=Object.keys(n),i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0}else if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;0<=i;i--)this.removeListener(t,e[i]);return this},j.prototype.listeners=function(t){return Co(this,t,!0)},j.prototype.rawListeners=function(t){return Co(this,t,!1)},j.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):xo.call(t,e)},j.prototype.listenerCount=xo,j.prototype.eventNames=function(){return 0<this._eventsCount?wo(this._events):[]};function Ro(u,c){return c=c||{},new Promise(function(t,e){var n,r=new XMLHttpRequest,o=[],i=[],a={},s=function(){return{ok:2==(r.status/100|0),statusText:r.statusText,status:r.status,url:r.responseURL,text:function(){return Promise.resolve(r.responseText)},json:function(){return Promise.resolve(r.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([r.response]))},clone:s,headers:{keys:function(){return o},entries:function(){return i},get:function(t){return a[t.toLowerCase()]},has:function(t){return t.toLowerCase()in a}}}};for(n in r.open(c.method||"get",u,!0),r.onload=function(){r.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(t,e,n){o.push(e=e.toLowerCase()),i.push([e,n]),a[e]=a[e]?a[e]+","+n:n}),t(s())},r.onerror=e,r.withCredentials="include"==c.credentials,c.headers)r.setRequestHeader(n,c.headers[n]);r.send(c.body||null)})}var Po="visibilitychange",No="for unload page event.",un=(Lo.prototype.start=function(){this.settings.log.debug(z.b,[No]),"undefined"!=typeof document&&document.addEventListener&&document.addEventListener(Po,this.flushDataIfHidden),"undefined"!=typeof window&&window.addEventListener&&(window.addEventListener("pagehide",this.flushData),window.addEventListener("unload",this.stopSync))},Lo.prototype.stop=function(){this.settings.log.debug(z.a,[No]),"undefined"!=typeof document&&document.removeEventListener&&document.removeEventListener(Po,this.flushDataIfHidden),"undefined"!=typeof window&&window.removeEventListener&&(window.removeEventListener("pagehide",this.flushData),window.removeEventListener("unload",this.stopSync))},Lo.prototype.stopSync=function(){this.syncManager&&this.syncManager.pushManager&&this.syncManager.pushManager.stop()},Lo.prototype.flushData=function(){var t,e,n;this.syncManager&&(t=(e=this.settings.urls).events,e=e.telemetry,se(this.settings)&&(n=this.settings.sync.impressionsMode,this._flushData(t+"/testImpressions/beacon",this.storage.impressions,this.serviceApi.postTestImpressionsBulk,this.fromImpressionsCollector,{sim:n===W?W:n===d?d:V}),this._flushData(t+"/events/beacon",this.storage.events,this.serviceApi.postEventsBulk),this.storage.impressionCounts&&this._flushData(t+"/testImpressions/count/beacon",this.storage.impressionCounts,this.serviceApi.postTestImpressionsCount,Ot),this.storage.uniqueKeys)&&this._flushData(e+"/v1/keys/cs/beacon",this.storage.uniqueKeys,this.serviceApi.postUniqueKeysBulkCs),this.storage.telemetry)&&this._flushData(e+"/v1/metrics/usage/beacon",this.storage.telemetry,this.serviceApi.postMetricsUsage)},Lo.prototype.flushDataIfHidden=function(){"hidden"===document.visibilityState&&this.flushData()},Lo.prototype._flushData=function(t,e,n,r,o){e.isEmpty()||(r=r?r(e.pop()):e.pop(),this._sendBeacon(t,r,o))||n(JSON.stringify(r)).catch(function(){})},Lo.prototype._sendBeacon=function(t,e,n){if("undefined"!=typeof navigator&&navigator.sendBeacon){e={entries:e,token:this.settings.core.authorizationKey,sdk:this.settings.version},n=(n&&Object(q.a)(e,n),JSON.stringify(e));try{return navigator.sendBeacon(t,n)}catch(t){}}return!1},Lo);function Lo(t,e,n,r){this.syncManager=t,this.settings=e,this.storage=n,this.serviceApi=r,this.flushData=this.flushData.bind(this),this.flushDataIfHidden=this.flushDataIfHidden.bind(this),this.stopSync=this.stopSync.bind(this),this.fromImpressionsCollector=St.bind(void 0,e.core.labelsEnabled)}var Do,Mo,Fo={getFetch:function(){return"function"==typeof fetch?fetch:Ro},getEventSource:function(){return"function"==typeof EventSource?EventSource:void 0},EventEmitter:j,now:"object"==typeof performance&&"function"==typeof performance.now?performance.now.bind(performance):Date.now},Ko=un,Uo=(Do=function(t){var e,o,a=t.splitApi,n=t.storage,r=t.readiness,s=t.settings,i=s.log,u=(t=a.fetchSplitChanges,e=!0,yt(s.log,$e(s.log,(o=t,function(t,e,n,r){t=o(t,e,n);return(t=r?r(t):t).then(function(t){return t.json()})}),n.splits,n.segments,r.splits,s.startup.requestTimeoutBeforeReady,s.startup.retriesOnFailureBeforeReady,e),s.scheduler.featuresRefreshRate,"splitChangesUpdater")),c={},l=h(Pe(s.core.key),r,n);function f(){Object(F.d)(c,function(t){t.start()})}function p(){Object(F.d)(c,function(t){t.isRunning()&&t.stop()})}function h(t,e,n){o=a.fetchMySegments;var r,o=yt(s.log,Ye(s.log,(r=o,function(t,e,n){t=r(t,e);return(t=n?n(t):t).then(function(t){return t.json()}).then(function(t){return t.mySegments.map(function(t){return t.name})})}),n.splits,n.segments,e.segments,s.startup.requestTimeoutBeforeReady,s.startup.retriesOnFailureBeforeReady,t),s.scheduler.segmentsRefreshRate,"mySegmentsUpdater");function i(){e.isReady()||n.splits.usesSegments()||e.segments.emit(G)}return n.splits.usesSegments()?e.splits.once(H,i):setTimeout(i,0),c[t]=o}return r.splits.on(H,function(){var t;u.isRunning()&&(t=n.splits.usesSegments())!==l.isRunning()&&(i.info(z.Gb,[t?"ON":"OFF"]),(t?f:p)())}),{splitsSyncTask:u,segmentsSyncTask:l,start:function(){i.info(z.Hb),u.start(),n.splits.usesSegments()&&f()},stop:function(){i.info(z.Ib),u.isRunning()&&u.stop(),p()},isRunning:u.isRunning,syncAll:function(){var e=[u.execute()];return Object(F.d)(c,function(t){e.push(t.execute())}),Promise.all(e)},add:h,remove:function(t){delete c[t]},get:function(t){return c[t]}}},Mo=function(t,e){var i,n=t.settings,r=t.storage,o=t.splitApi,D=t.readiness,a=t.platform,s=t.telemetryTracker,u=n.core.key?Pe(n.core.key):void 0,c=n.log;try{i=new Ie(n,!u,a.getEventSource)}catch(t){return void c.warn(z.Qb,[t])}var l,f,p,h,d,y,m,g,v,b,M=ke(o.fetchAuth),S=new a.EventEmitter,t=pe(c,S,s),O=(i.setEventHandler(t),u?void 0:me(c,e.segmentsSyncTask,r.segments)),w=(l=c,f=r.splits,p=e.splitsSyncTask,h=D.splits,d=u?void 0:e.segmentsSyncTask,g=0,v=!1,b=new ue(_,he,de),{put:j,killSplit:function(t){var e=t.changeNumber,n=t.splitName,t=t.defaultTreatment;f.killLocally(n,t,e)&&h.emit(H,!0),j({changeNumber:e})},stop:function(){y=!1,b.reset()}});function _(){y=!0,g>f.getChangeNumber()?(v=!1,p.execute(!0,m?g:void 0).then(function(){var t;y&&(v?_():(d&&d.execute(!0),t=b.attempts+1,g<=f.getChangeNumber()?(l.debug("Refresh completed"+(m?" bypassing the CDN":"")+" in "+t+" attempts."),y=!1):t<ye?b.scheduleCall():m?(l.debug("No changes fetched after "+t+" attempts with CDN bypassed."),y=!1):(b.reset(),m=!0,_())))})):y=!1}function j(t){t=t.changeNumber;t<=f.getChangeNumber()||t<=g||(g=t,m=!(v=!0),!b.timeoutID&&y||_(),b.reset())}var T,E,k,A,C={},x={},I=!1,R=new ue(P,n.scheduler.pushRetryBackoffBase);function P(){var o;T||(c.info(z.Nb),T=!1,o=u?Object.keys(x):void 0,M(o).then(function(t){var e,n,r;T||(t.pushEnabled?o&&o.length<Object.keys(x).length||(e=t,k&&clearTimeout(k),A&&clearTimeout(A),t=e.decodedToken,n=t.exp-t.iat-600,r="number"==typeof e.connDelay&&0<=e.connDelay?e.connDelay:60,c.info(z.Wb,[n,r]),k=setTimeout(P,1e3*n),A=setTimeout(function(){T||i.open(e)},1e3*r),s.streamingEvent(50,t.exp)):(c.info(z.Ob),S.emit(Jt)))}).catch(function(t){T||(c.error(z.eb,[t.message]),400<=t.statusCode&&t.statusCode<500?(s.streamingEvent(80),S.emit(Jt)):S.emit($t))}))}function N(){T||(T=!0,i.close(),c.info(z.Pb),k&&clearTimeout(k),A&&clearTimeout(A),R.reset(),L())}function L(){w.stop(),u?Object(F.d)(x,function(t){return t.worker.stop()}):O.stop()}return S.on(Zt,L),S.on(Xt,function(){R.reset()}),S.on(Jt,function(){E=!0,N(),S.emit(Zt)}),S.on($t,function(){i.close();var t=R.scheduleCall();c.info(z.Vb,[t/1e3]),S.emit(Zt)}),S.on(K.STREAMING_RESET,function(){T||(k&&clearTimeout(k),P())}),S.on(re,w.killSplit),S.on(oe,w.put),u?(S.on(te,function(t,e){e=e.split("_")[2],e=C[e];e&&x[e]&&x[e].worker.put(t.changeNumber,t.includesPayload?t.segmentList||[]:void 0)}),S.on(ee,function(r){switch(r.u){case xe.BoundedFetchRequest:var o;try{o=Fe(r.d,r.c)}catch(t){c.warn(z.Ub,["BoundedFetchRequest",t]);break}return void Object(F.d)(x,function(t){var e,n=t.hash64,t=t.worker;e=o,n=n.hex,n=parseInt(n.slice(8),16)%(8*e.length),0<(e[Math.floor(n/8)]&1<<n%8)&&t.put(r.changeNumber)});case xe.KeyList:var t,n,i;try{t=Ke(r.d,r.c),n=new ze(t.a),i=new ze(t.r)}catch(t){c.warn(z.Ub,["KeyList",t]);break}return void Object(F.d)(x,function(t){var e=t.hash64,t=t.worker,e=!!n.has(e.dec)||!i.has(e.dec)&&void 0;void 0!==e&&t.put(r.changeNumber,{name:r.segmentName,add:e})});case xe.SegmentRemoval:if(r.segmentName)return void Object(F.d)(x,function(t){return t.worker.put(r.changeNumber,{name:r.segmentName,add:!1})});c.warn(z.Ub,["SegmentRemoval","No segment name was provided"])}Object(F.d)(x,function(t){t.worker.put(r.changeNumber)})})):S.on(ne,O.put),Object(q.a)(Object.create(S),{stop:function(){N(),u&&this.remove(u)},start:function(){E||!1===T||(T=!1,u?this.add(u,e.segmentsSyncTask):setTimeout(P))},isRunning:function(){return!1===T},add:function(t,e){var n,r,o,i,a,s,u,c=Ae(t);function l(){var e;r=!0,a<i?(s=!1,e=i,n.execute(o,!0).then(function(t){r&&(!1!==t&&(a=Math.max(a,e)),s?l():u.scheduleCall())})):r=!1}C[c]||(C[c]=t,x[t]={hash64:Ge(t),worker:(n=e,i=0,s=!(a=-1),u=new ue(l),{put:function(t,e){t<=a||t<=i||(i=t,s=!0,o=e,!u.timeoutID&&r||l(),u.reset())},stop:function(){r=!1,u.reset()}})},I=!0,setTimeout(function(){I&&(I=!1,P())},0))},remove:function(t){var e=Ae(t);delete C[e],delete x[t]}})},function(t){var e=t.settings,n=t.settings,r=n.log,o=n.streamingEnabled,i=n.sync.enabled,a=t.telemetryTracker,s=Do&&Do(t),u=i&&o&&s&&Mo?Mo(t,s):void 0,c=Yt(t);u&&(u.on(Xt,function(){r.info(z.lc),s.isRunning()&&(s.stop(),a.streamingEvent(70,0)),s.syncAll()}),u.on(Zt,function(){s.isRunning()?r.info(z.bc):(r.info(z.kc),s.start(),a.streamingEvent(70,1))}));var l=!1,f=!0;return{pollingManager:s,pushManager:u,submitterManager:c,start:function(){l=!0,s&&(i?(u?(f&&(s.syncAll(),f=!1),u):s).start():f&&(s.syncAll(),f=!1)),c.start(!se(e))},stop:function(){l=!1,u&&u.stop(),s&&s.isRunning()&&s.stop(),c.stop()},isRunning:function(){return l},flush:function(){return c.execute(!se(e))},shared:function(e,t,n){var r;if(s)return{isRunning:(r=s.add(e,t,n)).isRunning,start:function(){i?u?(s.isRunning()?n.splits.usesSegments()&&r.start():r.execute(),u.add(e,r)):n.splits.usesSegments()&&r.start():t.isReady()||r.execute()},stop:function(){var t=s.get(e);t&&(u&&u.remove(e),t.isRunning()&&t.stop(),s.remove(e))},flush:function(){return Promise.resolve()}}}}});function Bo(t){return t.storage.type===nt?(n=t.storage,u=(n=(n=void 0===n?{}:n).prefix)?n+".SPLITIO":"SPLITIO",e.type=nt,e):t.storage.__originalType===nt?oo:Rn;function e(t){var e,n,r,o,i,a,s;return Object(ln.a)()?(i=t.settings,s=t.settings,e=s.log,n=(r=s.scheduler).impressionsQueueSize,r=r.eventsQueueSize,o=(s=s.sync).impressionsMode,s=s.__splitFiltersValidation,i=Pe(i.core.key),i=new cn(u,i),a=Date.now()-864e6,{splits:a=new dn(e,i,a,s),segments:s=new vn(e,i),impressions:new Xe(n),impressionCounts:o!==d?new en:void 0,events:new rn(r),telemetry:An(t)?new Cn(a,s):void 0,uniqueKeys:o===V?new xn:void 0,destroy:function(){var t;this.splits=new wn,this.segments=new Sn,this.impressions.clear(),this.impressionCounts&&this.impressionCounts.clear(),this.events.clear(),null!=(t=this.uniqueKeys)&&t.clear()},shared:function(t){t=new cn(u,t);return{splits:this.splits,segments:new vn(e,t),impressions:this.impressions,impressionCounts:this.impressionCounts,events:this.events,telemetry:this.telemetry,destroy:function(){this.splits=new wn,this.segments=new Sn}}}}):(t.settings.log.warn(l+"LocalStorage API is unavailable. Falling back to default MEMORY storage"),Rn(t))}var n,u}function qo(t){var e={settings:t,platform:Fo,storageFactory:Bo(t),splitApiFactory:dt,syncManagerFactory:Uo,sdkManagerFactory:Bn,sdkClientMethodFactory:Lr,SignalListener:Ko,integrationsManagerFactory:t.integrations&&0<t.integrations.length?ro.bind(null,t.integrations):void 0,impressionsObserverFactory:Vr,extraProps:function(t){return{UserConsent:(n=(t=t).settings,r=t.settings.log,o=t.syncManager,i=(t=t.storage).events,a=t.impressions,s=t.impressionCounts,se(n)||r.info(z.pc,[n.userConsent]),{setStatus:function(t){var e;return Object(F.g)(t)?(n.userConsent!==(e=t?u:rt)?(r.info(z.rc,[n.userConsent,e]),n.userConsent=e,t?null!=(t=null==o?void 0:o.submitterManager)&&t.start():(null!=(t=null==o?void 0:o.submitterManager)&&t.stop(!0),i.clear&&i.clear(),a.clear&&a.clear(),s&&s.clear&&s.clear())):r.info(z.qc,[e]),!0):(r.warn(z.Y,["UserConsent.setStatus"]),!1)},getStatus:function(){return n.userConsent},Status:fo})};var n,r,o,i,a,s}};return t.mode===$&&(e.splitApiFactory=void 0,e.syncManagerFactory=t.sync.localhostMode,e.SignalListener=void 0),e}function zo(t,e){t=qo(Ft(t,So));return e&&e(t),lo(t)}function Wo(t){return(Wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vo(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function Ho(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vo(Object(n),!0).forEach(function(t){Go(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vo(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Go(t,e,n){return(e=$o(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,s=[],u=!0,c=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){var n;if(t)return"string"==typeof t?Yo(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yo(t,e):void 0}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Jo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$o(r.key),r)}}function $o(t){t=function(t,e){if("object"!==Wo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==Wo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Wo(t)?t:String(t)}var Xo=function(){function f(t){var e=this,n=t.splitioOptions,r=t.app,o=t.subject,i=t.splitioClients,a=t.splitioManager,s=t.preloadExists,u=t.usePreload,u=void 0===u||u,t=t.windowOverride,t=void 0===t?window:t;if(!(this instanceof f))throw new TypeError("Cannot call a class as a function");var c,l=Object.entries(o)[0];n.core.key=Object(g.getSubjectKey)({id:l[1],idType:l[0]}),n.storage={type:u?"LOCALSTORAGE":"MEMORY",prefix:"".concat(r)},n.streamingEnabled=!1,i&&a||(c=zo(n)),i||Object.entries(o).forEach(function(t,e){var t=Qo(t,2),n=t[0],t=t[1];0===e?i=Go({},n,c.client()):i[n]=c.client(Object(g.getSubjectKey)({id:t,idType:n}))}),a=a||c.manager(),this._splitioClients=i,this._splitioManager=a,this._clientsReady=Promise.all(Object.values(this._splitioClients).map(function(e){return new Promise(function(t){return e.on(s?e.Event.SDK_READY_FROM_CACHE:e.Event.SDK_READY,t)})})),this._managerReady=new Promise(function(t){return e._splitioManager.on(s?e._splitioManager.Event.SDK_READY_FROM_CACHE:e._splitioManager.Event.SDK_READY,t)}),this._allReady=Promise.all([this._clientsReady,this._managerReady]),u||this._clearLocalStorage({app:r,windowOverride:t})}var t,e,n;return t=f,(e=[{key:"_clearLocalStorage",value:function(t){var e=this,n=t.app,r=t.windowOverride;this._splitioManager.on(this._splitioManager.Event.SDK_READY,function(){e._splitioManager.splits().forEach(function(t){return r.localStorage.removeItem("".concat(n,".SPLITIO.split.").concat(t.name))}),r.localStorage.removeItem("".concat(n,".SPLITIO.splits.lastUpdated")),r.localStorage.removeItem("".concat(n,".SPLITIO.splits.till")),r.localStorage.removeItem("".concat(n,".SPLITIO.splits.usingSegments"))})}},{key:"ready",get:function(){return this._allReady}},{key:"getCohortAllocations",value:function(t){var e=t.idType,n=t.experiments,t=t.attributes,e=this._splitioClients[e].getTreatmentsWithConfig(void 0===n?[]:n,void 0===t?{}:t);return Object(g.treatmentsToCohortAllocations)(e)}},{key:"getExperimentsById",value:function(t){var e=this,r=t.map(function(t){return e._splitioManager.split(t)});return t.reduce(function(t,e,n){n=r[n];return null!==n&&(t[e]=Ho(Ho({},Object(g.transformSplitToExperiment)(n)),{},{source:g.hivemindConstants.experimentSources.SPLIT_IO})),t},{})}},{key:"getExperiments",value:function(){return this._splitioManager.splits().reduce(function(t,e){return t[e.name]=Ho(Ho({},Object(g.transformSplitToExperiment)(e)),{},{source:g.hivemindConstants.experimentSources.SPLIT_IO}),t},{})}},{key:"destroy",value:function(){var n=this;return Promise.all(Object.entries(this._splitioClients).map(function(t){var t=Qo(t,2),e=t[0];t[1].destroy().then(function(){delete n._splitioClients[e]})}))}}])&&Jo(t.prototype,e),n&&Jo(t,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(),Zo={dev:"mbqv2tai7f3k04c7rm4dnombdfuvvddtmgku",test:"k0kgs7d57kss5jbkfsdto70ierl2tgvivl0v",prod:"pbqj1rfhsn00ukm2lv96jcg4rmbktkrdsmm0"},ti={dev:"37ca2446b1c4590486d8401bbdb8e4b0",test:"a156155642b857889a085c7f10e7319f",prod:"a9d8359a625457b7809759211fabf76b"};function ei(t){return(ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ni(t){return function(t){if(Array.isArray(t))return ai(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||ii(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ri(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function T(r){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ri(Object(o),!0).forEach(function(t){var e,n;e=r,n=o[t=t],(t=ui(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):ri(Object(o)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(o,t))})}return r}function oi(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,s=[],u=!0,c=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,e)||ii(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ii(t,e){var n;if(t)return"string"==typeof t?ai(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ai(t,e):void 0}function ai(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function si(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ui(r.key),r)}}function ui(t){t=function(t,e){if("object"!==ei(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==ei(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===ei(t)?t:String(t)}var ci=function(){function y(t){var n=this,e=t.app,r=t.cspKey,o=t.env,i=t.splitioWrapper,a=t.splitioOptions,s=t.switchboardWrapper,u=t.switchboardOptions,u=(void 0===u?{}:u).preloadLocation,u=void 0===u?"__switchboardCachePreload":u,c=t.subject,l=t.loadLocalStorage,f=void 0===l?M:l,l=t.readyTimeout,l=void 0===l?3e3:l,p=t.mockData,h=t.preloadLocation,t=t.usePreload,t=void 0===t||t;if(!(this instanceof y))throw new TypeError("Cannot call a class as a function");Object(g.validateApp)(e),this._app=e,this._readyTimeout=l,this._cspKey=null!=r?r:ti[o],this._cspKey||console.warn("Could not determine a CSP API key; experimentation events are disabled. You must provide either a cspKey or env config property.");var d=!1;t&&Object.entries(c).forEach(function(t){var t=oi(t,2),e=t[0],t=t[1];d=f({app:n._app,idType:e,id:t,preloadLocation:h})}),this._subject=c,(i=p?this._getMockWrapper(p,c):i)?this._splitioWrapper=i:0!==Object.keys(c).length&&(this._splitioWrapper=new Xo({app:this._app,subject:c,splitioOptions:T(T({},a),{},{core:T(T({},null==a?void 0:a.core),{},{authorizationKey:null!=(l=null==a||null==(e=a.core)?void 0:e.authorizationKey)?l:Zo[o]})}),preloadExists:d,usePreload:t})),this._switchboardWrapper=null!=s?s:new L({settings:null!=(r=window[u])?r:[]}),this._ready=new Promise(function(e){return Promise.race([n._splitioWrapper?n._splitioWrapper.ready:new Promise(function(t){return t()}),new Promise(function(t,e){return setTimeout(function(){return e(new Error("timeout"))},n._readyTimeout)})]).then(e).catch(function(t){console.log("Hivemind Client not ready from cache. Will return default values.",t),e("timeout")})})}var t,e,n;return t=y,(e=[{key:"ready",get:function(){return this._ready}},{key:"setMockData",value:function(t){this._splitioWrapper=this._getMockWrapper(t)}},{key:"_getMockWrapper",value:function(t){return new g.MockWrapper({mockData:t})}},{key:"getCohorts",value:function(t){var e,n=t.experiments,n=void 0===n?[]:n,r=t.labels,r=void 0===r?[]:r,o=t.attributes,o=void 0===o?{}:o,t=t.windowOverride,t=void 0===t?window:t;return n.length?e=Object.assign({},this._splitioWrapper.getExperimentsById(n),this._switchboardWrapper.getExperimentsById(n)):r.length?(e=this._getExperimentsByLabel(r),n=Object.keys(e)):(console.log("No experiments or labels provided"),e={}),this._getCohorts({experimentsMetadata:e,experiments:n,attributes:o,windowOverride:t})}},{key:"_getCohorts",value:function(t){var e,n=this,r=t.experimentsMetadata,o=void 0===r?{}:r,r=t.experiments,i=t.attributes,a=void 0===i?{}:i,i=t.windowOverride,t=void 0===i?window:i,s={},u=[],c={},l=[],f=function(t,e){var n,r,o,i,a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(a)return r=!(n=!0),{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){r=!0,o=t},f:function(){try{n||null==a.return||a.return()}finally{if(r)throw o}}};if(Array.isArray(t)||(a=ii(t))||e&&t&&"number"==typeof t.length)return a&&(t=a),i=0,{s:e=function(){},n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(void 0===r?[]:r);try{for(f.s();!(e=f.n()).done;){var p=e.value,h=o[p];(null==h?void 0:h.source)===g.hivemindConstants.experimentSources.SWITCHBOARD?(u.push(p),s[p]=h):(l.push(p),h&&(c[p]=h))}}catch(t){f.e(t)}finally{f.f()}var i=Object(g.groupEligibleExperimentsById)({subject:this._subject,experiments:l,experimentsMetadata:c}),r=i.experimentsByIdType,i=i.ineligibleExperiments,r=Object.assign.apply(Object,[{}].concat(ni(Object.entries(r).map(function(t){var t=oi(t,2),e=t[0],t=t[1];return n._splitioWrapper.getCohortAllocations({idType:e,experiments:t,attributes:a})})))),d=T(T({},this._subject),{},{visitorId:this._subject[g.hivemindConstants.idTypes.VISITOR_GUID]},a),y=this._switchboardWrapper.getCohortAllocations({experiments:u,attributes:d}),m=(this._logSwitchboardCohorts({window:t,experiments:s,cohortAllocations:y,attributes:d}),Object(g.updateCohortAllocationsWithEid)(T(T({},r),y),this._app));return function(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window;for(e in n._expDataLayer=n._expDataLayer||[],t)"ineligible"!==t[e].cohortId&&n._expDataLayer.push({schema:"add_experiment_assignment",type:"abn",version:"v1",data:{experiment_id:e,variant_id:t[e].error?"error":t[e].cohortId}})}(r,t),Object.keys(m).forEach(function(t){return delete m[t].error}),{cohorts:T(T({},m),Object(g.generateDefaultAllocations)(i))}}},{key:"_logSwitchboardCohorts",value:function(t){var r=this,e=t.window,o=t.experiments,n=t.cohortAllocations,i=t.attributes,t=Object.entries(n).filter(function(t){return"ineligible"!==oi(t,2)[1].cohortId}).map(function(t){var t=oi(t,2),e=t[0],t=t[1],n=o[e].subjectIdType;return{schemaId:"urn:shared:user:event:/appconfig/id-percentage-evaluation/v1",data:{callingService:r._app,eventCreationTimestamp:(new Date).toISOString(),fqAppId:"hivemind",setting:e,settingValue:JSON.stringify(t),percentageIdType:n,percentageId:i[n]}}});t.length&&(e._signalsDataLayer=e._signalsDataLayer||[],e._signalsDataLayer.push({schema:"add_micro_events",data:{apiKey:this._cspKey,schemaId:"urn:shared:user:events:/v1",events:t}}))}},{key:"getExperiments",value:function(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).labels,t=void 0===t?[]:t,t=t.length?this._getExperimentsByLabel(t):this._getAllExperiments();return Object.values(t)}},{key:"_getAllExperiments",value:function(){return T(T({},this._splitioWrapper.getExperiments()),this._switchboardWrapper.getExperiments())}},{key:"_getExperimentsByLabel",value:function(o){return Object.entries(this._getAllExperiments()).reduce(function(t,e){var e=oi(e,2),n=e[0],r=e[1];return o.every(function(t){return r.labels.includes(t)})&&(t[n]=r),t},{})}},{key:"getParameterValue",value:function(t){var r=t.parameter,e=t.defaultValue,n=t.attributes,n=void 0===n?{}:n,t=t.windowOverride,t=void 0===t?window:t,o=this._getExperimentsByLabel([this._app,g.hivemindConstants.PARAMETER_LABEL]),o=Object.entries(o).reduce(function(t,e){var e=oi(e,2),n=e[0],e=e[1];return Object.values(e.cohortData).some(function(t){return r in t})&&(t[n]=e),t},{}),i=Object.keys(o),a=i.length;return 1===a?(n=(o=this._getCohorts({experimentsMetadata:o,experiments:i,attributes:n,windowOverride:t}).cohorts[i[0]]).data,{parameterValue:r in n?n[r]:e,cohortId:o.cohortId,experimentId:i[0]}):(1<a&&console.log("Multiple experiments containing the same parameter definition."),{parameterValue:e,cohortId:null,experimentId:null})}}])&&si(t.prototype,e),n&&si(t,n),Object.defineProperty(t,"prototype",{writable:!1}),y}();function li(t){return(li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fi(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function pi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fi(Object(n),!0).forEach(function(t){hi(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fi(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function hi(t,e,n){return(e=function(t){t=function(t,e){if("object"!==li(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==li(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===li(t)?t:String(t)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var di={};function yi(t){var e=t.Client,n=t.app,r=t.env,o=t.shopperId,i=t.visitorGuid,a=t.readyTimeout,s=t.mockData,t=t.usePreload,u="".concat(n).concat(r).concat(o).concat(i).concat(a).concat(!!s).concat(t);return di[u]||(di[u]=new e({app:n.replace(/\./g,"-"),cspKey:ti[r],splitioOptions:{core:{authorizationKey:Zo[r]}},subject:pi(pi({},o&&hi({},g.hivemindConstants.idTypes.SHOPPER_ID,o)),i&&hi({},g.hivemindConstants.idTypes.VISITOR_GUID,i)),preloadLocation:"__hivemindPreload",readyTimeout:a,mockData:s,usePreload:t})),di[u].ready.then(function(){return di[u]})}function mi(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.readyTimeout,n=t.mockData,r=t.usePreload,o=t.Client,o=void 0===o?ci:o,t=t.initClient,i=void 0===t?yi:t,t=window.ux,t=(void 0===t?{}:t).data,t=void 0===t?{}:t,a=t.app,a=void 0===a?"default":a,t=t.env,t=void 0===t?"dev":t,s=(Object(A.updateAuthTokens)(),Object(A.getShopperId)()),u=Object(C.getVisitorId)(),c={Client:o,app:a,env:t,shopperId:s,visitorGuid:u,readyTimeout:e,mockData:n,usePreload:r};return u?i(c):new Promise(function(e){window._expDataLayer.push({schema:"get_tracking_values",version:"v1",data:{callback:function(t){t=t.vtg;c.visitorGuid=t,e(i(c))}}})})}k.default=ci}],r={},o.m=n,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=179);function o(t){var e;return(r[t]||(e=r[t]={i:t,l:!1,exports:{}},n[t].call(e.exports,e,e.exports,o),e.l=!0,e)).exports}var n,r});