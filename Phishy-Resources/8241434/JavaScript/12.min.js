webpackSbbInternetFrontendJsonp([12],{225:function(t,i,e){"use strict";function s(){this.init()}var o=e(0),n=e(6),h=e(14),r=e(5),a=e(4),d=o(document),l={stateClasses:{isExpanded:"is_expanded",isInFocus:"is_in_focus",isInitialized:"is_initialized",isAnimating:"is_animating",noTransition:"var_no_transition"},offsetSmall:12,handleResizeAndViewportChange:!1};s.prototype.init=function(){this.options=o.extend(!0,{},l,this.options),this._cacheElements(),this._setAriaClosedState({setFocus:!1}),this.options.handleResizeAndViewportChange&&(this._cacheWindowWidth(),d.on(r.resize.key+"."+this.uuid,this._handleResizeChange.bind(this)),d.on(n.event.key+"."+this.uuid,this._handleBreakpointChange.bind(this)),this.inMobileViewport=n.query({to:"tabletPortrait"}),this.inMobileViewport&&(this._removeMobilePortraitState(),this._setInitialStateMobilePortrait(),this._setClosedStateMobilePortrait())),this._registerEventListeners(),this.$element.addClass(this.options.stateClasses.isInitialized)},s.prototype._handlesClickOutsideOfElement=function(t){this.$element[0].contains(t.target)||this._closeDropDown()},s.prototype._cacheElements=function(){this.$toggleButton=this.$element.find(this.options.domSelectors.toggleButton),this.$dropDown=this.$element.find(this.options.domSelectors.dropDown),this.$links=this.$dropDown.find(this.options.domSelectors.link),this.$lightBoxLinks=this.$links.filter("[data-lightbox-trigger]"),this.$linkWithOnClickAction=this.$links.filter("[onclick]")},s.prototype._registerEventListeners=function(){this.$toggleButton.on("click."+this.uuid,function(){this._toggleDropDown()}.bind(this)),this._setupLightBoxLinks(),this.$linkWithOnClickAction.on("click."+this.uuid,function(t){t.preventDefault()})},s.prototype._setupLightBoxLinks=function(){this.$lightBoxLinks.attr({"aria-haspopup":"true",role:"button"}).on("click",function(t){t.preventDefault();var i=t.currentTarget,e=JSON.parse(i.getAttribute("data-lightbox-trigger"));d.triggerHandler("lightboxJSTrigger",{type:"url",source:e.source,elementToFocusAfterClose:i})}.bind(this))},s.prototype._handleResizeChange=function(){if(this.inMobileViewport=n.query({to:"tabletPortrait"}),this.inMobileViewport){if(this.windowWidth===parseInt(window.innerWidth,10))return void this._cacheWindowWidth();this._cacheWindowWidth(),this._removeMobilePortraitState(),this._setInitialStateMobilePortrait(),this.isExpanded?this._setExpandedStateMobilePortrait():this._setClosedStateMobilePortrait()}else this._cacheWindowWidth()},s.prototype._handleBreakpointChange=function(){this.inMobileViewport=n.query({to:"tabletPortrait"}),this.inMobileViewport||this._removeMobilePortraitState()},s.prototype._removeMobilePortraitState=function(){this.$dropDown.removeAttr("style"),this.$toggleButton.removeAttr("style").addClass(this.options.stateClasses.noTransition)},s.prototype._setExpandedStateMobilePortrait=function(){requestAnimationFrame(function(){this.$dropDown.css({left:this.options.offsetSmall+"px",right:this.options.offsetSmall+"px"}),this.$toggleButton.css({position:"fixed",width:"calc(100% - 45px)",left:"30px",right:"15px"})}.bind(this))},s.prototype._setClosedStateMobilePortrait=function(){requestAnimationFrame(function(){this.$dropDown.css({left:this.dropDownOffsetLeft+"px",right:this.dropDownOffsetRight+"px"}),this.$toggleButton.css({position:"fixed",width:this.options.iconWidth+"px",left:this.toggleButtonOffsetLeft+"px",right:this.toggleButtonOffsetRight+"px"})}.bind(this))},s.prototype._setInitialStateMobilePortrait=function(){var t=this.$toggleButton[0].getBoundingClientRect(),i=parseInt(window.innerWidth,10),e=this.$toggleButton.outerWidth(),s=t.left,o=i-(s+this.options.iconWidth),n=i-(s+e);requestAnimationFrame(function(){this.dropDownOffsetLeft=s,this.dropDownOffsetRight=o,this.toggleButtonOffsetLeft=s,this.toggleButtonOffsetRight=n}.bind(this))},s.prototype._toggleDropDown=function(){this.isExpanded?this._closeDropDown():(this.$toggleButton.removeClass(this.options.stateClasses.noTransition),this._openDropDown())},s.prototype._openDropDown=function(){this.options.closeDropdownByClickOutsideElement&&d.on("click."+this.uuid,this._handlesClickOutsideOfElement.bind(this)),this.options.handleResizeAndViewportChange&&this.inMobileViewport&&this._setExpandedStateMobilePortrait(),requestAnimationFrame(function(){this.$element.css({"z-index":"2"}),this.$element.addClass(this.options.stateClasses.isExpanded),this.isExpanded=!0}.bind(this)),this.$toggleButton.off(a+"."+this.uuid),this.$toggleButton.one(a+"."+this.uuid,function(){this._setAriaExpandedState()}.bind(this))},s.prototype._closeDropDown=function(){this.options.closeDropdownByClickOutsideElement&&d.off("click."+this.uuid),this.options.handleResizeAndViewportChange&&this.inMobileViewport&&this._setClosedStateMobilePortrait(),this._destroyKeyboardNavigation(),requestAnimationFrame(function(){this.$element.removeClass(this.options.stateClasses.isExpanded),this.isExpanded=!1}.bind(this)),this.$toggleButton.one(a+"."+this.uuid,function(){this._setAriaClosedState({setFocus:!this.options.closeDropdownByClickOutsideElement}),this.$links.removeClass(this.options.stateClasses.isInFocus)}.bind(this))},s.prototype._setAriaExpandedState=function(){requestAnimationFrame(function(){this.$toggleButton.attr({"aria-expanded":"true"}).focus(),this.$dropDown.attr({"aria-expanded":"true","aria-hidden":"false"}),this.$links.removeAttr("tabindex")}.bind(this)),this._setupKeyboardNavigation()},s.prototype._setAriaClosedState=function(t){requestAnimationFrame(function(){this.$toggleButton.attr({"aria-expanded":"false"}),this.$element.css({"z-index":"auto"}),t.setFocus&&this.$toggleButton.focus(),this.$dropDown.attr({"aria-expanded":"false","aria-hidden":"true"}),this.$links.attr("tabindex","-1")}.bind(this))},s.prototype._focusNextLink=function(t){this._setFocus(t,{delta:1})},s.prototype._focusPrevLink=function(t){this._setFocus(t,{delta:-1})},s.prototype._focusFirstLink=function(t){this._setFocus(t,{nextItemIndex:0})},s.prototype._focusLastLink=function(t){this._setFocus(t,{nextItemIndex:-1})},s.prototype._setFocus=function(t,i){var e,s=i.delta,n=i.nextItemIndex,h=this.$links.filter("."+this.options.stateClasses.isInFocus),r=this.$links.index(h),a=this.$links.length;t.preventDefault(),"number"==typeof n?n=(n+a)%a:s&&(n=(a+r+s)%a),h.removeClass(this.options.stateClasses.isInFocus),e=o(this.$links[n]),e.addClass(this.options.stateClasses.isInFocus).focus()},s.prototype._setupKeyboardNavigation=function(){this.moduleScope=this.name+"-"+this.uuid,this.$element.on("focusin."+this.uuid,function(){h.setScope(this.moduleScope)}.bind(this)).on("focusout."+this.uuid,function(){h.setScope("all")}),h("right, down, tab",this.moduleScope,this._focusNextLink.bind(this)),h("left, up, shift+tab",this.moduleScope,this._focusPrevLink.bind(this)),h("home",this.moduleScope,this._focusFirstLink.bind(this)),h("end",this.moduleScope,this._focusLastLink.bind(this)),h("esc",this.moduleScope,function(){this._closeDropDown()}.bind(this)),this.$element.trigger("focusin")},s.prototype._cacheWindowWidth=function(){this.windowWidth=parseInt(window.innerWidth,10)},s.prototype._destroyKeyboardNavigation=function(){this._focusFirstLink.bind(this),h.unbind("up, right, down, left, home, end, esc, tab, shift+tab",this.moduleScope)},t.exports=s}});