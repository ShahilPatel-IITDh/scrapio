function $survey(){}
function QuestionInfo(questionCode){this.qCode=questionCode;this.qAnswerArray=[];this.qType;this.qSubtype;this.qID;this.isMatrixTable=false;this.isImageDropDown=false;this.isQuestionRow=false;this.isDropDown=false;this.taskArray=[];this.getTask=function(taskIndex){for(var i=0;i<this.taskArray.length;i++){var task=this.taskArray[i];if(task.index==taskIndex+1){task.getNotSelectedConcepts=function(){var notSelectedConcepts=[];for(var i=0;i<this.concepts.length;i++){var concept=this.concepts[i];if(!concept.isSelected){concept.getLevelForFeature=function(featureIndex){for(var i=0;i<this.levels.length;i++){var level=this.levels[i];if(level.featureIndex==featureIndex+1){return level;}}
return null;};notSelectedConcepts.push(concept);}}
return notSelectedConcepts;};task.getSelectedConcept=function(){for(var i=0;i<this.concepts.length;i++){var concept=this.concepts[i];if(concept.isSelected){concept.getLevelForFeature=function(featureIndex){for(var i=0;i<this.levels.length;i++){var level=this.levels[i];if(level.featureIndex==featureIndex+1){return level;}}
return null;};return concept;}}
return null;};return task;}}
return null;};}
$survey.surveyResponseJson={"questionArray":[]};$survey.Init=function(questionCode){var questionInfo;try{questionInfo=$survey.populateQuestionInfo(questionCode);}catch(e){throwException(e);}
return questionInfo;};$survey.getLanguageID=function(){if($survey.surveyResponseJson&&$survey.surveyResponseJson.languageID){return $survey.surveyResponseJson.languageID;}
return 0;};$survey.getCXTransaction=function(){if($survey.surveyResponseJson&&$survey.surveyResponseJson.cxTransaction){return $survey.surveyResponseJson.cxTransaction;}
return{};};$survey.populateQuestionInfo=function(questionCode){var breakLoop=false;var questionArray=$survey.surveyResponseJson.questionArray;var questionInfo=new QuestionInfo(questionCode);try{for(var i=0;i<questionArray.length;i++){var questionObj=questionArray[i];var code=questionObj["code"];var subCode=questionObj["subCode"];if((code==questionCode)||(subCode==questionCode)){questionInfo.qType=questionObj["type"];questionInfo.qSubtype=questionObj["subType"];questionInfo.qID=questionObj["questionID"];questionInfo.isMatrixTable=questionObj["isMatrixTable"];questionInfo.isImageDropDown=questionObj["isImageDropDown"];questionInfo.isDropDown=questionObj["isDropDown"];questionInfo.isQuestionRow=questionObj["isQuestionRow"];questionInfo.qAnswerArray=questionObj["answerArray"];questionInfo.taskArray=questionObj["taskArray"];break;}}}catch(e){throwException(e);}
return questionInfo;};$survey.hideQuestion=function(questionCode){showHideQuestion(questionCode,false);};$survey.showQuestion=function(questionCode){showHideQuestion(questionCode,true);};$survey.hideOption=function(questionCode,optionIndex){showHideOption(questionCode,optionIndex,false);};$survey.showOption=function(questionCode,optionIndex){showHideOption(questionCode,optionIndex,true);};$survey.setOptionSelected=function(questionCode,optionArray){var question=$survey.Init(questionCode);var optionIndex=0;var answerArray=question.qAnswerArray;try{if(!(optionArray instanceof Array)){optionArray=optionArray.toString().split(",");}
for(var arrIndex=0;optionArray.length>arrIndex;arrIndex++){optionIndex=optionArray[arrIndex];for(var i=0;i<answerArray.length;i++){var answerObj=answerArray[i];if(answerObj.index==optionIndex){if(question.isMatrixTable){if($("#"+answerObj.answerID+"ID").length){setOptionByAnswerID(answerObj.answerID+"ID");}else{setOptionByAnswerID("batteryOption_"+answerObj.answerID);}}else if(question.isDropDown){setDropDownOptionByQuestionID(question.qID,answerObj.answerID);}else{setOptionByAnswerID(answerObj.answerID+"ID");}}}}}catch(e){throwException(e);}};$survey.getSelectedOption=function(questionCode){var question=$survey.Init(questionCode);var selectedBuff="";var answerArray=question.qAnswerArray;try{for(var i=0;i<answerArray.length;i++){var ansObj=question.qAnswerArray[i];var isSelected=question.isDropDown?$("select[name='u_"+question.qID+"'] option:selected").text():isChecked(ansObj.answerID);if(ansObj.isSelected||isSelected){if(selectedBuff.length==0){if(question.isDropDown){selectedBuff=getSelectedOptionForDropDown(isSelected,ansObj);break;}
selectedBuff+=ansObj.text;}else{selectedBuff=selectedBuff+","+ansObj.text;}}}}catch(e){throwException(e);}
return selectedBuff;};function getSelectedOptionForDropDown(isSelected,ansObj){if(isSelected){return isSelected;}
return ansObj.text;}
$survey.getSelectedOptionsIndex=function(questionCode){var question=$survey.Init(questionCode);var selectedIndex=[];var answerArray=question.qAnswerArray;try{for(var i=0;i<answerArray.length;i++){var ansObj=answerArray[i];if(ansObj.isSelected||isChecked(ansObj.answerID)){selectedIndex.push(ansObj.index);}}}catch(e){throwException(e);}
return selectedIndex;};$survey.getSelectedOptions=function(questionCode){var question=$survey.Init(questionCode);var selectedOptionArr=[];var answerArray=question.qAnswerArray;try{for(var i=0;i<answerArray.length;i++){var ansObj=answerArray[i];if(ansObj.isSelected||isChecked(ansObj.answerID)){selectedOptionArr.push(ansObj.text);}}}catch(e){throwException(e);}
return selectedOptionArr;};$survey.getSelectedOptionIndex=function(questionCode){var question=$survey.Init(questionCode);var selectedIndex=0;var answerArray=question.qAnswerArray;try{for(var i=0;i<answerArray.length;i++){var ansObj=answerArray[i];if(ansObj.isSelected||isChecked(ansObj.answerID)){return ansObj.index;}}}catch(e){throwException(e);}
return selectedIndex;};$survey.getSelectedCount=function(questionCode){var selectedOptionArr=[];try{selectedOptionArr=$survey.getSelectedOptions(questionCode);}catch(e){throwException(e);}
return selectedOptionArr.length;};$survey.updateCustomVariable=function(cvIndex,value){try{var hiddenAttr="JSCustom"+cvIndex;if($("#"+hiddenAttr).length>0){$("#"+hiddenAttr).val(value);}else{$("<input>").attr({type:"hidden",id:hiddenAttr,name:hiddenAttr,value:value}).appendTo("form");}}catch(e){throwException(e);}};$survey.setText=function(questionCode,optionIndex,value){var question=$survey.Init(questionCode);var answerTextArr=[];var answerArray=question.qAnswerArray;try{var answerObj;if(question.isMatrixTable&&optionIndex>0){for(var i=0;i<answerArray.length;i++){answerObj=answerArray[i];if(answerObj.index==optionIndex){$("#"+answerObj.answerID+"ID").val(value);break;}}}else{$("#"+answerArray[0].answerID+"ID").val(value);}}catch(e){throwException(e);}};$survey.getText=function(questionCode,optionIndex){var question=$survey.Init(questionCode);var answerTextArr=[];var answerArray=question.qAnswerArray;try{var answerObj;if(question.isMatrixTable&&optionIndex>0){for(var i=0;i<answerArray.length;i++){answerObj=answerArray[i];if(answerObj.index==optionIndex){answerTextArr.put($("#"+answerObj.answerID+"ID").val());}}}else{answerTextArr.put($("#"+answerArray[0].answerID+"ID").val());}}catch(e){throwException(e);}
return answerTextArr;};$survey.getQuestionByCode=function(questionCode){var questionInfo=$survey.Init(questionCode);if(questionInfo){return questionInfo;}else{return{};}};function showHideQuestion(questionCode,isShow){var questionId;try{var questionInfo=$survey.Init(questionCode);questionId=questionInfo.qID;if(questionInfo.isQuestionRow&&questionInfo.qCode.indexOf("_")!=-1){showHideQuestionTRByAnswerID(questionId,isShow);}else if(isShow){$("#QuestionSection_"+questionId).show();}else{$("#QuestionSection_"+questionId).hide();}}catch(e){throwException(e);}}
function showHideOption(questionCode,optionIndex,isShow){var questionInfo=$survey.Init(questionCode);var answerArray=questionInfo.qAnswerArray;try{if(answerArray.length>0){for(var i=0;i<answerArray.length;i++){var ansObj=answerArray[i];if(ansObj.index==optionIndex){if(questionInfo.isMatrixTable){showHideOptionByAnswerID(ansObj.answerID,isShow);}else if(questionInfo.isDropDown){showHideDropDownOptionByQuestionID(questionInfo.qID,ansObj.answerID,isShow);}else{showHideOptionTDByAnswerID(ansObj.answerID,isShow);}}}}}catch(e){throwException(e);}}
function showHideOptionByAnswerID(answerID,isShow){var htmlElement;try{htmlElement=getElementById(answerID+"ID");htmlElement=(((typeof(htmlElement)==='undefined')||(htmlElement===null))?getElementById("element_"+answerID):htmlElement);htmlElement.css("visibility",(isShow?"visible":"hidden"));}catch(e){throwException(e);}}
function showHideDropDownOptionByQuestionID(questionID,answerID,isShow){var select;try{select=getElementByName("u_"+questionID)[0];for(var i=0;select.length>i;i++){var option=select.options[i];if(option.value==answerID){option.hidden=!isShow;}}}catch(e){throwException(e);}}
function showHideQuestionTRByAnswerID(questionID,isShow){try{if(isShow){$("#questionRow"+questionID).show();}else{$("#questionRow"+questionID).hide();}}catch(e){throwException(e);}}
function showHideOptionTDByAnswerID(answerID,isShow){try{var element=$("#"+answerID+"ID").closest("label");if(element.parent().is("div")&&element.parent().hasClass("answer-options")){element=element.parent();}
if(isShow){element.show();}else{element.hide();}}catch(e){throwException(e);}}
function setDropDownOptionByQuestionID(questionID,answerID){try{$("select[name=u_"+questionID+"] option[value="+answerID+"]").attr('selected','selected');$("select[name=u_"+questionID+"]").selectpicker('val',$("select[name=u_"+questionID+"] option[value="+answerID+"]").val());$("select[name=u_"+questionID+"]").trigger("onchange");}catch(e){throwException(e);}}
function isChecked(answerID){try{return($("#"+answerID+"ID").is(':checked'));}catch(e){throwException(e);}
return false;}
function throwException(e){}
function getElementByName(name){return document.getElementsByName(name);}
function getElementById(id){return $("#"+id);}
function setOptionByAnswerID(answerID){$("#"+answerID).prop('checked',true);}
function addOrupdateHiddenVariable(hiddenAttr,value){if($("#"+hiddenAttr).length>0){$("#"+hiddenAttr).val(value);}else{$("<input>").attr({type:"hidden",id:hiddenAttr,name:hiddenAttr,value:value}).appendTo("form");}}
$survey.updateCustomVariableWithTransaction=function(cvIndex,value){try{addOrupdateHiddenVariable("JSCustom"+cvIndex,value);addOrupdateHiddenVariable("JSCustomTransaction"+cvIndex,"true");}catch(e){throwException(e);}};