var InteractiveMode={scrHeight:0,scrHeightCenter:0,IDs:[],nextQuestionButtonText:'Next Question',submitButtonText:"",startButtonText:"",isLastPage:"",focusAndTimerQuestionClass:'ts-sqpp-timer',focusModeClass:'ts-sqpp',focusModeMainClass:'ts-sqpp-main',canSkipProgressBarOnFirstPage:false,isFirstPage:false,isHeaderAndLogoEmpty:false,EMPTY:"",KEY_FOCUS_MODE_STATE:"focusModeState",FOCUS_MODE_STATE_STARTED:"started",FOCUS_MODE_STATE_SUBMIT:"submit",QUESTION_TRANSITION_TIME:400,initNPSPlusTransition:function(nextQuestionButtonText){var $mainElement=$('.has-autofocus-mode');var $questionElement=$mainElement.find('.survey-question-wrapper');var page=0;$(window).on('resize',function(){if($('.has-autofocus-mode .nps-plus-question').length){setTimeout(function(){scrollNPSPlus(0);},1);}})
function scrollNPSPlus(time){var isIE=navigator.userAgent.indexOf("MSIE ")>0||!!navigator.userAgent.match(/Trident.*rv\:11\./);var scroll=$('body').hasClass('language-rtl')&&!isIE?(-page*$mainElement.outerWidth()):(page*$mainElement.outerWidth());$($mainElement).animate({scrollLeft:scroll},time);}
function scrollNext(pageNumber){if(pageNumber){page=pageNumber;}
$('#SurveySubmitButtonElement').addClass('has-back');scrollNPSPlus(300);setTimeout(function(){$('#jsBackButton').siblings('.btn-back').addClass('hidden');$('#jsBackButton').removeClass('hidden');$('#jsBackButton').unbind('click');$('#jsBackButton').on('click',function(){scrollPrev();});},150);}
function scrollPrev(){page=page-1;var $colWidth=$mainElement.outerWidth()*page;if($colWidth<=0){$('#SurveySubmitButtonElement').removeClass('has-back');$('#jsBackButton').addClass('hidden');$('#jsBackButton').siblings('.btn-back').removeClass('hidden');$('#jsBackButton').unbind('click');}
scrollNPSPlus(300);}
$questionElement.find('.answer-container.nps-plus-question [class*="control-selection"]').on('change',function(){setTimeout(function(){scrollNext(1);},500);});$questionElement.find('.answer-container.word-cloud-question .word-cloud-wrapper.multiple [class*="control-selection"]').on('change',function(){showNextButton('word-cloud-question',2);});$questionElement.find('.answer-container.delight-question textarea').bind('input propertychange',function(){showNextButton('delight-question',3);});$questionElement.find('.answer-container.word-cloud-question .word-cloud-wrapper.single > [class*="control-selection"]').on('change',function(){setTimeout(function(){scrollNext(2);},500);});$questionElement.find('.answer-container.word-cloud-question .other-option [class*="control-selection"]').on('change',function(){$('.answer-container.voting-question').parents('.survey-question-wrapper').removeClass('hidden');showNextButton('word-cloud-question',2);});function showNextButton(className,pageNumber){var element=$questionElement.children('.answer-container.'+className).parents('.survey-question-wrapper');if($(element).find('.ok-wrapper').length){return;}
$('<div class="ok-wrapper show"><span class="ok-btn">'+nextQuestionButtonText+'</span></div>').appendTo(element);$('.ok-btn').unbind('click');$('.ok-btn').on('click',function(){setTimeout(function(){scrollNext(pageNumber);},500);});}},init:function(nextQuestionButtonText,canAutoSubmit,isFocusMode,goBackURL,isFirstPage,isLastPage,startButtonText,nextButtonText,submitButtonText,isBackButtonEnabled,isHeaderAndLogoEmpty,canSkipProgressBarOnFirstPage){this.nextQuestionButtonText=nextQuestionButtonText;this.isLastPage=isLastPage;this.submitButtonText=submitButtonText;this.startButtonText=startButtonText;this.setWindowResize();this.initParams($('.survey-question-wrapper:first-child'));this.moveQuestionToCenterOfScreen();this.handleQuestionSpecificEvents($('.survey-question-wrapper:first-child').attr('id'));this.increasePageHeightToHaveScrollBars();this.handleFocusEventOnIOS();this.stopEnterKeyPress();this.pushQuestionsToArray();this.addButtons(isFocusMode,nextButtonText,isBackButtonEnabled);this.highlightQuestionOnScroll();this.handleClickEvents(canAutoSubmit,goBackURL,isFirstPage,isFocusMode,isBackButtonEnabled);this.handleKeyPressEvent();this.handleNumericInputType();this.handleAlphabeticInputType();this.arrowClickEvent();this.buttonShowonFocus();this.canSkipProgressBarOnFirstPage=canSkipProgressBarOnFirstPage;this.isFirstPage=isFirstPage;this.isHeaderAndLogoEmpty=isHeaderAndLogoEmpty;if(isFocusMode){this.handleShowHideButtonForTimer();this.handleFocusModePageReload(isFirstPage);this.handleStartButtonIfHeaderAndLogoEmpty(isFirstPage,isHeaderAndLogoEmpty);this.handleNPSPlusShowHide();var self=this;setTimeout(function(){self.handleProgressBarDisplayOnSurveyStart();},200);}},isFirstQuestionInFocusMode:function(){return this.isFirstPage&&$('.survey-question-wrapper.active-question').prev().length==0;},canSkipProgressBar:function(){return(this.canSkipProgressBarOnFirstPage&&this.isFirstQuestionInFocusMode());},handleProgressBarDisplayOnSurveyStart:function(){if(this.canSkipProgressBar()){$('.survey-progressbar').hide();$('.modern-progressbar').hide();}else{$('.survey-progressbar').show();$('.modern-progressbar').show();}},handleShowHideButtonForTimer:function(){if($('.survey-question-wrapper:last-child').hasClass('hidden')){if($('.survey-question-wrapper').length!=1){$("#SurveySubmitButtonElement").addClass("hidden");}
if(this.isLastPage&&$('.survey-question-wrapper').length==2){$('.ok-wrapper .ok-btn').text(this.submitButtonText);}}},addButtons:function(isFocusMode,submitButtonText,isBackButtonEnabled){if(isFocusMode){this.addButtonsForFocusMode(submitButtonText,isBackButtonEnabled);}else{this.addButtonForInteractiveMode();}},isInteractiveMode:function(){return $('.has-interactive-mode').length>0;},handleFocusEventOnIOS:function(){var self=this;if(this.isIOS()){$('.has-interactive-mode input[type=text], textarea').on('focus',function(){self.initParams($('.survey-question-wrapper.active-question'),270);}).on('blur',function(){setTimeout(function(){self.initParams($('.survey-question-wrapper.active-question'),0);},1);});}},setFocusOnTextIfPresent:function(){$($('.active-question').find('input:not([type=hidden]):first, textarea:not([type=hidden]):first')[0]).focus();},getNumericValue:function(val){return typeof val==='undefined'?0:val;},isIOS:function(){return['iPad','iPhone','iPod'].indexOf(navigator.platform)>=0;},isWindowResized:function(){return window.innerHeight!=this.windowHeight&&this.isInteractiveMode();},setWindowResize:function(){var self=this;if(!this.isIOS()){$(window).resize(function(){if(self.isWindowResized()){var activeQuestion=$('.survey-question-wrapper.active-question');clearTimeout(window.resizedFinished);window.resizedFinished=setTimeout(function(){self.initParams(activeQuestion);self.increasePageHeightToHaveScrollBars();self.scrollQuestionToCenter(activeQuestion,0);},1);self.windowHeight=window.innerHeight;}});}},initParams:function(obj,minusHeight){this.windowHeight=window.innerHeight;this.surveyLogo=this.getNumericValue($('.take-survey-logo').outerHeight());this.surveyTitle=this.getNumericValue($('.take-survey-title').outerHeight());this.surveyTimer=this.getNumericValue($('.survey-timer-wrapper').outerHeight());this.surveyNotify=this.getNumericValue($('.notification-wrapper').outerHeight());this.surveyBodyWrapperSpaces=parseInt($('.survey-body-wrapper').css('marginTop'))
+parseInt($('.survey-body-wrapper').css('paddingTop'));this.surveyProgress=this.getNumericValue($('.has-progress-bar-top .survey-progress-wrapper').outerHeight());this.allCommonHeight=((this.surveyLogo+this.surveyTitle)+this.surveyTimer+(this.surveyNotify+this.surveyProgress))
this.scrHeight=parseInt(window.innerHeight)-(minusHeight?minusHeight:0);this.scrHeightCenter=((this.scrHeight-obj.outerHeight())/2)
-(($('html,body').scrollTop()>(this.allCommonHeight
+this.surveyBodyWrapperSpaces))?0:this.allCommonHeight
+this.surveyBodyWrapperSpaces);this.flexClass(obj);},scrollDiv:function(obj){if(this.isFocusMode()){$('.take-survey-header').addClass("hidden");}
this.scrollQuestionToCenter(obj);$('.ok-wrapper').hide();},setTargetContainerTop:function(obj){this.desired_cursor_top=(parseInt(this.scrHeight-$(obj).outerHeight())/2);this.target_container_top=$(obj).offset().top-this.desired_cursor_top;},scrollQuestionToCenter:function(obj,time){this.setTargetContainerTop(obj);if($(obj).outerHeight()>=this.scrHeight){if($(obj).find(':focus').length>0){this.setTargetContainerTop($(obj).find(':focus'));}else{this.target_container_top=$(obj).offset().top;}}
if(time==0){$('html,body').scrollTop(this.target_container_top);}else{$('html,body').animate({scrollTop:this.target_container_top},this.QUESTION_TRANSITION_TIME,'linear');}},moveQuestionToCenterOfScreen:function(){if($('.survey-question-wrapper').length>1){$('.survey-run-form').addClass('pt0');}else{$('.survey-run-form').removeClass('pt0');}
if(this.scrHeightCenter>=0){$('.survey-run-form').css('padding-top',this.scrHeightCenter);}},getBottomPadding:function(){return(parseInt(this.scrHeight)/2)
-(this.getNumericValue($('.survey-question-wrapper:last').outerHeight())/2)
-this.getNumericValue($('.survey-submit-wrapper').outerHeight())
-this.getNumericValue($('.custom-footer-wrapper').outerHeight())
-this.getNumericValue($('.survey-footer').outerHeight())
-this.getNumericValue($('.has-progress-bar-bottom .inner-progress-wrapper').outerHeight())
+(this.isIOS()?50:0);},increasePageHeightToHaveScrollBars:function(){$('.survey-run-form').css('padding-bottom',this.getBottomPadding());},stopEnterKeyPress:function(){$('#SurveySubmitButtonElement').attr('type','button');this.submitFormOnButtonClick();},submitFormOnButtonClick:function(){$('#SurveySubmitButtonElement').unbind('click');$('#SurveySubmitButtonElement').on('click',function(){$('#SurveySubmitButtonElement').attr('type','submit');if(typeof postExecuteJavaScriptLogic=='function'){postExecuteJavaScriptLogic();}
InteractiveMode.setFocusModeStateIfFocusModeEnabled();});},pushQuestionsToArray:function(){var self=this;self.IDs=[];$('div').find('.survey-question-wrapper').each(function(){self.IDs.push(this.id);});},addButtonForInteractiveMode:function(){var self=this;jQuery.each(this.IDs,function(i,val){if($('#'+self.IDs[i]).find('.ok-wrapper').length<=0&&!($('#'+self.IDs[i]).find('.answer-container').is('.sub-heading-question')||$('#'+self.IDs[i]).find('.answer-container').is('.heading-question')||$('#'+self.IDs[i]).find('.answer-container').is('.voting-question')||($('#'+self.IDs[i]).find('.answer-container').is('.radio-jump')&&($('#'+self.IDs[i]).find('.answer-container').find('textarea').length<=0&&($('#'+self.IDs[i]).find('.answer-container').find('input[type=text]').length<=0))))){$('<div class="ok-wrapper"><span class="ok-btn">'+self.nextQuestionButtonText+'</span></div>').appendTo('#'+self.IDs[i]);}});},addButtonsForFocusMode:function(submitButtonText,isBackButtonEnabled){var self=this;if(isBackButtonEnabled){jQuery.each(this.IDs,function(id){if($('#'+self.IDs[id]).find('.ok-wrapper').length<=0){$('<div class="ok-wrapper"><a class="ok-btn" href="javascript:void(0)">'+submitButtonText+
'</a> '+'<a href="javascript:void(0)" class="btn-prev" aria-label="Previous Question">'+
'<i class="qp-icomoon-icons"></i></a></div>').appendTo('#'+self.IDs[id]);}});}else{jQuery.each(this.IDs,function(id){if($('#'+self.IDs[id]).find('.ok-wrapper').length<=0){$('<div class="ok-wrapper"><a class="ok-btn" href="javascript:void(0)">'+submitButtonText+
'</a> '+'</div>').appendTo('#'+self.IDs[id]);}});}},slideToNextQuestionIfDropdown:function(canAutoSubmit){var self=this;$(document).on('change','.has-interactive-mode .dropdown-question .single-select select',function(e){var activeQuestion=$('.active-question');if($(this).parents('.active-question').length!=0&&$(this).parents('.active-question').find('input[type=text], textarea').parents('.answer-options:not(.hidden)').length==0){$(this).parents('.survey-question-wrapper').find('.ok-wrapper').hide();self.clickSubmitButton(activeQuestion,canAutoSubmit);setTimeout(function(){self.focusNextQuestion(self,false,activeQuestion.attr('id'));},500);return;}});},handleAnswerSubmitIfOnlyOneQuestion:function(){this.submitFormIfUnichoice();this.submitFormIfDropdown();this.submitFormIfMap();},submitFormIfDropdown:function(){var self=this;$(document).on('change','.dropdown-question .single-select select',function(e){var questionWrapper=$(this).parents('.survey-question-wrapper');if(questionWrapper.find('input[type=text], textarea').parents('.answer-options:not(.hidden)').length==0){self.clickSubmitButton(questionWrapper,true);return;}else{self.showSubmitWrapper();}});},submitFormIfUnichoice:function(){var self=this;$(document).on('change','.survey-question-wrapper .answer-container.radio-jump [class*="control-selection"]',function(e){var questionWrapper=$(this).parents('.survey-question-wrapper');if(questionWrapper.find('input:radio').length&&$(this).find('input').is(':checked')){if($(this).parents('.answer-container').find('.dynamic-explode').is(':not(.hidden)')||$(this).parent().is('.other-option')){self.showSubmitWrapper();return;}
self.clickSubmitButton(questionWrapper,true);return;}});},submitFormIfMap:function(){var self=this;$(document).on('change','.survey-question-wrapper .answer-container.map-question',function(e){var questionWrapper=$(this).parents('.survey-question-wrapper');var inputElement=questionWrapper.find('input:radio[id^=map_q_input_]');if(inputElement.length&&$(this).find('input').is(':checked')){self.clickSubmitButton(questionWrapper,true);return;}});},clickSubmitButton:function(questionWrapper,canAutoSubmit){if(canAutoSubmit&&$('.survey-run-form .survey-question-wrapper:last').attr('id')==$(questionWrapper).attr('id')){$('#SurveySubmitButtonElement').click();}},slideToNextQuestionWhenHideQuestionAfterAnswered:function(){var self=this;$(document).on('hideQuestion','.has-interactive-mode .active-question',function(e){var activeQuestion=$('.active-question');activeQuestion.slideUp(300);activeQuestion.find(".QuestionSectionVisibility").val('hidden');setTimeout(function(){self.focusNextQuestion(self,false,activeQuestion.attr('id'));},200);});},slideToNextQuestionIfUnichoice:function(canAutoSubmit){var self=this;$(document).on('change','.has-interactive-mode .active-question .answer-container.radio-jump [class*="control-selection"]',function(e){var activeQuestion=$('.active-question');if(activeQuestion.find('input:radio').length&&$(this).find('input').is(':checked')){if($(this).parents('.answer-container').find('.dynamic-explode').is(':not(.hidden)')||$(this).parent().is('.other-option')){return;}
$(this).parents('.survey-question-wrapper').find('.ok-wrapper').hide();self.clickSubmitButton(activeQuestion,canAutoSubmit);setTimeout(function(){self.focusNextQuestion(self,false,activeQuestion.attr('id'));},500);return;}});},slideToNextQuestionIfMap:function(canAutoSubmit){var self=this;$(document).on('change','.has-interactive-mode .active-question .answer-container.map-question',function(e){var activeQuestion=$('.active-question');var inputElement=$('.active-question').find('input:radio[id^=map_q_input_]');if(inputElement.length&&$(this).find('input').is(':checked')){$(this).parents('.survey-question-wrapper').find('.ok-wrapper').hide();self.clickSubmitButton(activeQuestion,canAutoSubmit);setTimeout(function(){self.focusNextQuestion(self,false,activeQuestion.attr('id'));},500);return;}});},handleQuestionSpecificEvents:function(id){var self=this;if($('#'+id+' .answer-container').hasClass('sub-heading-question')||$('#'+id+' .answer-container').hasClass('heading-question')){setTimeout(function(){self.focusNextQuestion(self,false,id);self.showSubmitWrapper();},1000);}else if($('#'+id+' .answer-container').hasClass('video-rating-question')&&$('#'+id+' .answer-container video.autoplay').length>0){$('#'+id+' .answer-container video')[0].play();}else if($('#'+id+' .answer-container').hasClass('video-rating-question')&&$('#'+id+' .answer-container audio.autoplay').length>0){$('#'+id+' .answer-container audio')[0].play();}else if($('#'+id+' .answer-container').hasClass('video-rating-question')&&$('#'+id+' .answer-container #ytplayer_'+id.split("_")[1]).length>0){self.initYTPlayer(id);}},initYTPlayer:function(id){var self=this;setTimeout(function(){if(typeof window.myPlayer==='undefined'||typeof window.myPlayer==='undefined'||typeof window.myPlayer.playVideo!='function'){self.initYTPlayer(id);}else{window.myPlayer.playVideo();}},50);},scrollDivAndFocusTextarea:function(obj,isRegularFocus){this.scrollDiv(obj);this.flexClass(obj);this.focusFirstElement(obj,isRegularFocus);},flexClass:function(obj){if($('body').hasClass('ts-sqpp')){var vh=window.innerHeight*0.01;document.documentElement.style.setProperty('--vh',vh+"px");if(obj[0].scrollHeight>Math.round(obj.innerHeight())){$(obj).addClass('align-content-start');}else{$(obj).removeClass('align-content-start');}}},focusFirstElement:function(obj,isRegularFocus){setTimeout(function(){if(!isRegularFocus){if(['iPad','iPhone','iPod'].indexOf(navigator.platform)<0&&!(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent))){if(!$(obj).find('.answer-container').hasClass('calendar-question')){$($(obj).find('input:not([type=hidden]):first, textarea:not([type=hidden]):first')[0]).focus();}}}},1);},highlightQuestion:function(windScroll){var self=this;$('.survey-question-wrapper').each(function(i){if(this.style.display!='none'){var questionHeight=$(this).outerHeight();var questionCurrentScroll=$(this).offset().top-(parseInt(self.scrHeight-questionHeight)/2);if(questionCurrentScroll>=windScroll-questionHeight/2&&questionCurrentScroll<=windScroll+questionHeight/2){self.addRemoveBlur(i);return;}}});},highlightQuestionOnScroll:function(){var self=this;$(window).scroll(function(){if(self.isInteractiveMode()){var windScroll=$(window).scrollTop();if(windScroll>=100){self.highlightQuestion(windScroll);}else{self.addRemoveBlur(self.getFirstScrollDivIndex(self));self.hideSubmitWrapper();}
$('#date').datepicker('hide');$('.calendar-question').find('input').blur();}}).scroll();},getFirstScrollDivIndex:function(self){for(var index=0;index<self.IDs.length;index++){var scrollDivID=self.IDs[index];if($('#'+scrollDivID).find(".QuestionSectionVisibility").val()==='visible'){return index;}}
return 0;},showSubmitWrapper:function(){$('.survey-submit-wrapper .btn-submit').removeClass('hidden').addClass('is-active');},hideSubmitWrapper:function(){$('.survey-submit-wrapper .btn-submit').removeClass('is-active');},addRemoveBlur:function(i){this.addRemoveClass(i,'active-question');},addRemoveClass:function(i,className){$('.survey-question-wrapper').removeClass(className).eq(i).addClass(className);},getNextScrollDiv:function(self,y){for(var i=y;i<self.IDs.length-1;i++){var scrollDivID=self.IDs[i+1];if($('#'+scrollDivID).find(".QuestionSectionVisibility").val()==='visible'){if(this.isFocusMode()&&$('#'+scrollDivID).hasClass("hidden")){return this.focusAndTimerQuestionClass;}
return scrollDivID;}}},getLastScrollDiv:function(self){for(var index=self.IDs.length-1;index>=0;index--){var scrollDivID=self.IDs[index];if($('#'+scrollDivID).find(".QuestionSectionVisibility").val()==='visible'){return scrollDivID;}}},focusNextQuestion:function(self,isRegularFocus,activeQuestionID){if(typeof activeQuestionID==='undefined'||(activeQuestionID===$('.active-question').attr('id'))){var x=$('.active-question').attr('id');var y=jQuery.inArray(x,self.IDs);if(y!=self.IDs.length-1){var scrollDivID=this.getNextScrollDiv(self,y);if($('.survey-question-wrapper:last-child').hasClass('hidden')){if(self.isLastPage&&$('.survey-question-wrapper').length>2&&self.isNthActiveDiv(self,activeQuestionID,3)){$('.ok-wrapper .ok-btn').text(self.submitButtonText);}}
if(this.isFocusMode()){this.handleShowHideSubmitBtnWhenLastQuestionHidden();if(self.hasNPSPlusQuestion(scrollDivID)){self.hideSubmitWrapper();$('#sqpp-btn-prev').hide();$("#SurveySubmitButtonElement").addClass("hidden");}
this.showSubmitButtonForSpecificQuestions(scrollDivID);this.handleProgressBarDisplayOnNextQuestion();}
if(!this.isPageHavingOnlyQuestion()){self.handleShowNextButtonForSpecificQuestionsWithFocusMode(self,scrollDivID);}
if(this.isLastQuestionHavingSpecificQuestionTypesWithFocusMode(scrollDivID)){$('#'+scrollDivID).find('.ok-wrapper .ok-btn').hide();this.showSubmitWrapper();}
if(scrollDivID){if(scrollDivID==this.focusAndTimerQuestionClass){$('#SurveySubmitButtonElement').click();return;}
this.scrollDivAndFocusTextarea($('#'+scrollDivID),isRegularFocus);this.handleQuestionSpecificEvents(scrollDivID);}else{if(this.isFocusMode()){$('#SurveySubmitButtonElement').click();return;}}}}},showSubmitButtonForSpecificQuestions:function(scrollDivID){if(!($('#'+scrollDivID).find('.answer-container').is('.sub-heading-question')||$('#'+scrollDivID).find('.answer-container').is('.heading-question')||$('#'+scrollDivID).find('.answer-container').is('.voting-question')||$('#'+scrollDivID).find('.answer-container').is('.dropdown-question')||($('#'+scrollDivID).find('.answer-container').is('.radio-jump')&&($('#'+scrollDivID).find('.answer-container').find('textarea').length<=0&&($('#'+scrollDivID).find('.answer-container').find('input[type=text]').length<=0))))){if(this.isLastActiveDiv(this,scrollDivID)){this.showSubmitWrapper();}else{$('#'+scrollDivID).find('.ok-wrapper .ok-btn').show();}}},handleProgressBarDisplayOnNextQuestion:function(){$('.survey-progressbar').show();$('.modern-progressbar').show();},canHideProgressBarOnPrevClick:function(){return this.isFirstPage&&this.canSkipProgressBarOnFirstPage&&$('.survey-inside-wrapper').find('.survey-question-wrapper.active-question').length>0&&$('.survey-inside-wrapper').find('.survey-question-wrapper.active-question').prevAll().length==1;},handleProgressBarDisplayOnPreviousClick:function(){if(this.canHideProgressBarOnPrevClick()){$('.survey-progressbar').hide();$('.modern-progressbar').hide();}else{$('.survey-progressbar').show();$('.modern-progressbar ').show();}},isFocusMode:function(){return $('.survey-body-wrapper').hasClass(this.focusModeMainClass);},focusPreviousQuestion:function(self,isRegularFocus,activeQuestionID){if(typeof activeQuestionID==='undefined'||(activeQuestionID===$('.active-question').attr('id'))){var x=$('.active-question').attr('id');var y=jQuery.inArray(x,self.IDs);if(y!=0){if(this.isFocusMode()){var scrollDivID=this.getPreviousScrollDivOnePageMode(self,y);this.handleProgressBarDisplayOnPreviousClick();}else{var scrollDivID=this.getPreviousScrollDiv(self,y);}
if(scrollDivID){this.scrollDivAndFocusTextarea($('#'+scrollDivID),isRegularFocus);this.handleQuestionSpecificEvents(scrollDivID);}}}
self.showOkButtonWhenFocusMode(self,scrollDivID);},getPreviousScrollDiv:function(self,y){for(var i=y;i>0;i++){var scrollDivID=self.IDs[i-1];if($('#'+scrollDivID).find(".QuestionSectionVisibility").val()==='visible'){return scrollDivID;}}},getPreviousScrollDivOnePageMode:function(self,y){for(var i=y;i>0;i--){var scrollDivID=self.IDs[i-1];if($('#'+scrollDivID).find(".QuestionSectionVisibility").val()==='visible'){return scrollDivID;}}},showNextButton:function(){var self=this;return function(event,ui){if($(this).parents('.survey-question-wrapper').is('.active-question')){if(!self.isLastActiveDiv(self,$('.active-question').attr('id'))){$(this).parents('.active-question').find('.ok-wrapper').show();if(self.isFocusMode()&&!self.isInteractiveModeSupportedSection(this)){$(this).parents('.active-question').find('.ok-wrapper .ok-btn').show();}}
if($('.survey-question-wrapper:last-child').find(".QuestionSectionVisibility").val()==='hidden'){$(this).parents('.active-question').find('.ok-wrapper').show();if(self.isFocusMode()){$(this).parents('.active-question').find('.ok-wrapper .ok-btn').show();}}
if($(this).parents('.survey-question-wrapper').is(':last-child')){if(!(self.isFocusMode()&&self.isInteractiveModeSupportedSection(this))){self.showSubmitWrapper();}}else{self.hideSubmitWrapper();}}}},isLastActiveDiv:function(self,activeQuestionId){if(activeQuestionId==this.focusAndTimerQuestionClass){return true;}
var x=activeQuestionId;var y=jQuery.inArray(x,self.IDs);for(var i=y;i<self.IDs.length-1;i++){var scrollDivID=self.IDs[i+1];if($('#'+scrollDivID).find(".QuestionSectionVisibility").val()==='visible'){return false;}}
return true;},isNthActiveDiv:function(self,activeQuestionId,index){var x=activeQuestionId;var y=jQuery.inArray(x,self.IDs);for(var i=y;i<self.IDs.length-index;i++){var scrollDivID=self.IDs[i+1];if($('#'+scrollDivID).find(".QuestionSectionVisibility").val()==='visible'){return false;}}
return true;},buttonShowonFocus:function(){$('.has-interactive-mode .survey-question-wrapper').on('change keyup slidestart sortactivate','input, select, textarea, .ui-slider, .ui-sortable',this.showNextButton()).on('click','.hot-spot-like, .hot-spot-unlike',this.showNextButton());},addScrollAndSlideEvents:function(canAutoSubmit){this.scrollOnAnswer();this.slideToNextQuestionIfDropdown(canAutoSubmit);this.slideToNextQuestionIfUnichoice(canAutoSubmit);this.slideToNextQuestionIfMap(canAutoSubmit);this.slideToNextQuestionWhenHideQuestionAfterAnswered();},handleClickEvents:function(canAutoSubmit,goBackURL,isFirstPage,isFocusMode,isBackButtonEnabled){if(isFocusMode){if(canAutoSubmit){this.addScrollAndSlideEvents(canAutoSubmit);}}else{this.addScrollAndSlideEvents(canAutoSubmit);}
this.handleClickEventsForOKButton(goBackURL,isFirstPage,isFocusMode,isBackButtonEnabled);},scrollOnAnswer:function(){var self=this;$(document).on('click','.has-interactive-mode .survey-question-wrapper:not(".active-question, .security-forms")',function(e){self.scrollDivAndFocusTextarea($(this));});},focusLastQuestionCallback:function(self){self.pushQuestionsToArray();var scrollDivID=this.getLastScrollDiv(self);$('#'+scrollDivID).addClass("active-question");this.scrollDivAndFocusTextarea($('#'+scrollDivID),false);this.handleQuestionSpecificEvents(scrollDivID);if(this.isPageHavingOnlyQuestion()){$(".take-survey-header ").hide();}
this.handleProgressBarDisplayOnSurveyStart()},isPageHavingOnlyQuestion:function(){return $('.survey-question-wrapper:first-child').attr("id")==$('.survey-question-wrapper:last-child').attr("id");},hasValidationErrorsWithFocusMode:function(isFocusMode,self,current){var currentSectionId=$(current).closest("div[id^='QuestionSection_']").attr('id').split('_')[1];var currentSection=this.getCurrentSection(currentSectionId);var currentSections=[];currentSections.push(currentSection);return qp_validateSurvey(currentSections,this.onSuccessfulValidationOfFocusMode.bind(self));},isValidCurrentSection:function(index,currentSectionId){return!(qp_sections[index]&&Object.keys(qp_sections[index]).length===0&&Object.getPrototypeOf(qp_sections[index])===Object.prototype)&&qp_sections[index].firstQuestionID==currentSectionId;},getCurrentSection:function(currentSectionId){for(var index=0;index<qp_sections.length;index++){if(this.isValidCurrentSection(index,currentSectionId)){return qp_sections[index];}}
return this.EMPTY;},onSuccessfulValidationOfFocusMode:function(){var self=this;var activeQuestion=$('.active-question');setTimeout(function(){self.focusNextQuestion(self,false,activeQuestion.attr('id'));},500);},handleClickEventsForOKButton:function(goBackURL,isFirstPage,isFocusMode,isBackButtonEnabled){var self=this;if(isFocusMode&&isBackButtonEnabled){var firstQuestionElement=$('.survey-question-wrapper:first-child .ok-wrapper .btn-prev');if(!isFirstPage){if(!this.isPageHavingOnlyQuestion()){firstQuestionElement.attr('style','display:inline-block! important');firstQuestionElement.unbind('click');firstQuestionElement.on('click',function(){qp_sectionDisplayScript.goBackToSurveyPreviousPage(goBackURL,self.focusLastQuestionCallback.bind(self,self));});}else{$('#okWrapper').show();$('#sqpp-btn-prev').unbind('click');$('#sqpp-btn-prev').on('click',function(){qp_sectionDisplayScript.goBackToSurveyPreviousPage(goBackURL,self.focusLastQuestionCallback.bind(self,self));});}}else{if(this.isPageHavingOnlyQuestion()){$('#sqpp-btn-prev').hide();}}}
$('.has-interactive-mode .ok-btn').on('click',function(){if(isFocusMode&&self.hasValidationErrorsWithFocusMode(isFocusMode,self,this)){return;}
var activeQuestion=$('.active-question');setTimeout(function(){self.focusNextQuestion(self,false,activeQuestion.attr('id'));if(self.isFocusMode()&&self.hasNPSPlusQuestion(activeQuestion.attr('id'))){self.hideSubmitWrapper();$('#sqpp-btn-prev').hide();$("#SurveySubmitButtonElement").addClass("hidden");}
if(self.isLastQuestionHavingSpecificQuestionTypesWithFocusMode(activeQuestion.attr('id'))){$('#'+activeQuestion.attr('id')).find('.ok-wrapper .ok-btn').hide();self.showSubmitWrapper();}},500);});$('.has-interactive-mode .btn-prev').on('click',function(){var activeQuestion=$('.active-question');setTimeout(function(){self.focusPreviousQuestion(self,false,activeQuestion.attr('id'));},500);});if(isFocusMode&&isBackButtonEnabled&&$('.survey-question-wrapper:first-child').attr("id")!=$('.survey-question-wrapper:last-child').attr("id")){$('#sqpp-btn-prev').on('click',function(){var activeQuestion=$('.active-question');setTimeout(function(){self.focusPreviousQuestion(self,false,activeQuestion.attr('id'));},500);});}},handleNumericInputType:function(){$('.has-interactive-mode .star-rating-question').on('keypress','input[type="radio"]',function(e){var totalInputs=$(this).parents('.star-rating').find('input').length;var $input=$(this).parents('.star-rating').find('input:eq('+(totalInputs-e.key)+')');if($input.length>0){$input.prop('checked',true);}})},handleAlphabeticInputType:function(){var self=this;$('.has-interactive-mode .thumbs-updown-question,.has-interactive-mode .smiley-question,.has-interactive-mode .image-chooser-question').on('keypress','input[type="radio"]',function(e){var activeQuestion=$('.active-question');var $input=$(this).parents('.answer-container').find('input:eq('+(e.key.charCodeAt(0)-97)+')');if($input.length>0){$input.prop('checked',true);if($(this).parents('.survey-question-wrapper .answer-container').is('.radio-jump')){setTimeout(function(){self.focusNextQuestion(self,false,activeQuestion.attr('id'));},500);}}})},handleKeyPressEvent:function(){var self=this;$(window).unbind('keydown');$(window).keydown(function(event){if(self.isInteractiveMode()){if(event.keyCode===40){event.preventDefault();event.stopPropagation();self.focusNextQuestion(self);return false;}
if(event.keyCode===38){event.preventDefault();event.stopPropagation();self.focusPreviousQuestion(self);return false;}
if(event.keyCode===9){setTimeout(function(){if(!$(document.activeElement).parents('.survey-question-wrapper').hasClass('active-question')){if(event.shiftKey){self.focusPreviousQuestion(self,true);}else{self.focusNextQuestion(self,true);}}},2);}}});$('.has-interactive-mode input[type=text]').keydown(function(event){if(event.keyCode===13){event.preventDefault();event.stopPropagation();return false;}});},arrowClickEvent:function(){var self=this;$('#PrvBtn').on('click',function(){if(self.isInteractiveMode()){self.focusPreviousQuestion(self);return false;}});$('#NextBtn').on('click',function(){if(self.isInteractiveMode()){self.focusNextQuestion(self);return false;}});},showHideSubmitButtonBasedOnQuestionAnswered:function(isAnyQuestionAnsweredOnPage,isFocusMode){if(isAnyQuestionAnsweredOnPage){$("#SurveySubmitButtonElement").removeClass("hidden");if(isFocusMode){$('.ok-wrapper .ok-btn').show();var lastQuestionId=InteractiveMode.IDs[InteractiveMode.IDs.length-1];$('#'+lastQuestionId+" .ok-wrapper .ok-btn").hide();this.handleShowHideSubmitBtnWhenLastQuestionHidden();}}else{if(isFocusMode){if($('.survey-question-wrapper:last-child').hasClass('hidden')&&$('.survey-question-wrapper').length==1){}else{$("#SurveySubmitButtonElement").addClass("hidden");}
$('.ok-wrapper .ok-btn').hide();var activeQuestion=$('.active-question');var scrollDivID=activeQuestion.attr('id');this.showSubmitButtonForSpecificQuestions(scrollDivID);if(!this.isPageHavingOnlyQuestion()){this.handleOkButtonForSpecificQuestions();}
if(this.isLastQuestionHavingSpecificQuestionTypesWithFocusMode($('.active-question')[0].getAttribute("id"))){this.showSubmitWrapper();}}}},handleShowHideSubmitBtnWhenLastQuestionHidden:function(){if($('.survey-question-wrapper:last-child').find(".QuestionSectionVisibility").val()==='hidden'){$('#sqpp-btn-prev').hide();$("#SurveySubmitButtonElement").addClass("hidden");}},handleOkButtonForSpecificQuestions:function(){if($('.active-question .answer-container').hasClass('live-cast-question')){var questionId=$('.active-question')[0].getAttribute("id");$('#'+questionId+' .ok-wrapper .ok-btn').show();}
this.showQuestionSpecificOkButtonBasedOnQuestion('presentation-text-question');this.showQuestionSpecificOkButtonBasedOnQuestion('upload-file-question');this.showQuestionSpecificOkButtonBasedOnQuestion('qr-code-like-dislike-question');},showQuestionSpecificOkButtonBasedOnQuestion:function(questionClass){if($('.answer-container').hasClass(questionClass)){$('.answer-container.'+questionClass).each(function(){$(this).parent().find('.ok-wrapper .ok-btn').show()});}},isLastQuestionHavingSpecificQuestionTypesWithFocusMode:function(scrollDivID){return this.isFocusMode()&&this.isLastActiveDiv(this,scrollDivID)&&($('#'+scrollDivID+' .answer-container').hasClass('presentation-text-question')||$('#'+scrollDivID+' .answer-container').hasClass('qr-code-like-dislike-question')||$('#'+scrollDivID+' .answer-container').hasClass('upload-file-question')||$('#'+scrollDivID+' .answer-container').hasClass('comments-suggestions-question')||$('#'+scrollDivID+' .answer-container').hasClass('voting-question')||$('#'+scrollDivID+' .answer-container').hasClass('live-cast-question'));},isInteractiveModeSupportedSection:function(self){if($(self).parents('.active-question').find('.answer-container').is('.sub-heading-question')||$(self).parents('.active-question').find('.answer-container').is('.heading-question')||$(self).parents('.active-question').find('.answer-container').is('.voting-question')||(this.isDropDownMenuQuestionWithoutLiveSearch(self))||($(self).parents('.active-question').find('.answer-container').is('.radio-jump')&&($(self).parents('.active-question').find('.answer-container').find('textarea').length<=0&&($(self).parents('.active-question').find('.answer-container').find('input[type=text]').length<=0)))){return true;}},isDropDownMenuQuestionWithoutLiveSearch:function(self){return $(self).parents('.active-question').find('.answer-container').is('.dropdown-question')&&!$(self).parents('.active-question').find('.form-select')[1].hasAttribute('data-live-search');},showOkButtonWhenFocusMode:function(self,scrollDivID){if(self.isFocusMode()){$('#'+scrollDivID).find('.ok-wrapper .ok-btn').show();self.handleShowHideSubmitBtnWhenLastQuestionHidden();}},handleShowNextButtonForSpecificQuestionsWithFocusMode:function(self,scrollDivID){if(self.isFocusMode()&&($('#'+scrollDivID+' .answer-container').hasClass('qr-code-like-dislike-question')||$('#'+scrollDivID+' .answer-container').hasClass('upload-file-question')||$('#'+scrollDivID+' .answer-container').hasClass('live-cast-question')||$('#'+scrollDivID+' .answer-container').hasClass('qr-code-like-dislike-question'))){if(!self.isLastActiveDiv(this,scrollDivID)){$('#'+scrollDivID).find('.ok-wrapper .ok-btn').show();}}},handleFocusModePageReload:function(isFirstPage){if(isFirstPage&&window.sessionStorage.getItem(this.KEY_FOCUS_MODE_STATE)==this.FOCUS_MODE_STATE_STARTED){$('html, body').animate({scrollTop:$("#SurveyBodyWrapper").offset().top},500);}
if(isFirstPage&&window.sessionStorage.getItem(this.KEY_FOCUS_MODE_STATE)==this.FOCUS_MODE_STATE_SUBMIT){window.sessionStorage.setItem(this.KEY_FOCUS_MODE_STATE,this.FOCUS_MODE_STATE_STARTED);}
var self=this;setTimeout(function(){self.showSubmitButtonForSpecificQuestions(self.getFirstScrollDivId(self));},200);},setFocusModeStateIfFocusModeEnabled:function(){if(InteractiveMode.isFocusMode()){window.sessionStorage.setItem(InteractiveMode.KEY_FOCUS_MODE_STATE,InteractiveMode.FOCUS_MODE_STATE_SUBMIT);}},getFirstScrollDivId:function(self){for(var index=0;index<self.IDs.length;index++){var scrollDivID=self.IDs[index];if($('#'+scrollDivID).find(".QuestionSectionVisibility").val()==='visible'){return scrollDivID;}}},handleStartButtonIfHeaderAndLogoEmpty:function(isFirstPage,isHeaderAndLogoEmpty){if(isFirstPage&&isHeaderAndLogoEmpty){$('#'+this.getFirstScrollDivId(this)+' .ok-wrapper .ok-btn').text(this.startButtonText)}},hasNPSPlusQuestion:function(scrollDivID){return $('#'+scrollDivID+" .answer-container").hasClass("nps-plus-question");},handleNPSPlusShowHide:function(){var activeQuestion=$('.active-question');if(this.isLastQuestionHavingSpecificQuestionTypesWithFocusMode(activeQuestion.attr('id'))){$('#'+activeQuestion.attr('id')).find('.ok-wrapper .ok-btn').hide();}
if(this.hasNPSPlusQuestion(activeQuestion.attr('id'))){this.hideSubmitWrapper();$('#sqpp-btn-prev').hide();$("#SurveySubmitButtonElement").addClass("hidden");}}}